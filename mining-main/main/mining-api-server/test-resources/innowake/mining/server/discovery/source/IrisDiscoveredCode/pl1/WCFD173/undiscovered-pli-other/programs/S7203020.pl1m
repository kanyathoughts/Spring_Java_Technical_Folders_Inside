                                                                        
 /********************************************************************/ 
 /********************************************************************/ 
 /*                                                                  */ 
 /*                                                                  */ 
 /*                     INSPECTION SYSTEM                            */ 
 /*                                                                  */ 
 /*               ===>   LOG DUMP PROGRAM  <===                      */ 
 /*                                                                  */ 
 /*                                                                  */ 
 /*  A.  S7203020  -  MAIN MODULE PROGRAM (DLITPLI)                  */ 
 /*                                                                  */ 
 /*   =======>  TO COMPILE & LINK:                                   */ 
 /*                USE MEMBER:  S7203020                             */ 
 /*                LEL MEMBER:  PLIOTDLI                             */ 
 /*                PSB MEMBER:  U7203172                             */ 
 /*               LOAD MODULE:  U7203020                             */ 
 /*               PRODUCTION :  P7203020                             */ 
 /*                                                                  */ 
 /********************************************************************/ 
 /*  CHANGES FOR INSPECTION STICKER ASSIGNMENT AND                   */ 
 /*              INVENTORY CONTROL SYSTEM                            */ 
 /*              PRODUCTION COMPILE  01-02-84                        */ 
 /*                                          JOE ALWINE  SEPT 83     */ 
 /********************************************************************/ 
 /********************************************************************/ 
 /*  CHANGES FOR STATION SIGNATURE (302 # 3163G)                     */ 
 /*                                          JOE ALWINE  APRIL 84    */ 
 /*  RENAME:  (05/01/84)                                             */ 
 /********************************************************************/ 
 /********************************************************************/ 
 /*  CHANGES FOR MECHANIC RENEWALS (302 # 4272)                      */ 
 /*                                                                  */ 
 /*  RENAME:  (  /  /  )                     JOE ALWINE  SEPT  84    */ 
 /********************************************************************/ 
 /********************************************************************/ 
 /*  CHANGES FOR EMISSION MECHANIC RENEWALS  (302# 17396 & 12144)    */ 
 /*                                                                  */ 
 /*  RENAME:  (  /  /  )                     HODGENS     JAN   90    */ 
 /********************************************************************/ 
                                                                        
 DLITPLI:           /* INSPECTION LOG DUMP PROGRAM --  */               
   PROCEDURE (LOG_PCB_PTR) OPTIONS (MAIN) REORDER;                      
    DCL                                                                 
        SYSPRINT                   FILE  STREAM  OUTPUT  PRINT,         
        TPLALI                     FILE  RECORD  OUTPUT,                
        TPINSM                     FILE  RECORD  OUTPUT;                
    DCL                                                                 
      ( NO_01_IN,                                                       
        NO_02_IN,                                                       
        NO_03_IN,                                                       
        NO_04_IN,                                                       
        NO_05_IN,                                                       
        NO_06_IN,                                                       
        NO_07_IN,                                                       
        NO_08_IN,                                                       
        NO_09_IN,                                                       
        NO_10_IN,                                                       
        NO_11_IN,                                                       
        NO_12_IN,                                                       
        NO_13_IN,                                                       
        NO_14_IN,                                                       
        NO_15_IN,                                                       
        NO_16_IN,                                                       
        NO_17_IN,                                                       
        NO_18_IN,                                                       
        NO_19_IN,                                                       
        NO_20_IN,                                                       
        NO_23_IN,                                                       
        NO_IA_IN,                                                       
        NO_IB_IN,                                                       
        NO_IC_IN,                                                       
        NO_ID_IN,                                                       
        NO_I1_IN,                                                       
        NO_I3_IN )                 FIXED BINARY(31);                    
    DCL                                                                 
      ( NO_01_OUT,                                                      
        NO_02_OUT,                                                      
        NO_03_OUT,                                                      
        NO_04_OUT,                                                      
        NO_05_OUT,                                                      
        NO_06_OUT,                                                      
        NO_07_OUT,                                                      
        NO_08_OUT,                                                      
        NO_09_OUT,                                                      
        NO_10_OUT,                                                      
        NO_11_OUT,                                                      
        NO_12_OUT,                                                      
        NO_13_OUT,                                                      
        NO_14_OUT,                                                      
        NO_15_OUT,                                                      
        NO_16_OUT,                                                      
        NO_17_OUT,                                                      
        NO_18_OUT,                                                      
        NO_19_OUT,                                                      
        NO_20_OUT,                                                      
        NO_23_OUT,                                                      
        NO_IA_OUT,                                                      
        NO_IB_OUT,                                                      
        NO_IC_OUT,                                                      
        NO_ID_OUT,                                                      
        NO_I1_OUT,                                                      
        NO_I3_OUT )                FIXED BINARY(31);                    
    DCL                                                                 
      ( NO_17_LAB,                                                      
        NO_18_LAB )                FIXED BINARY(31);                    
    DCL                                                                 
      ( TOTAL_IN,                                                       
        TOTAL_TPINSM,                                                   
        TOTAL_TPLALI )             FIXED BINARY(31);                    
    DCL                                                                 
      ( GU                         INIT ('GU  '),                       
        GN                         INIT ('GN  '),                       
        GNP                        INIT ('GNP '),                       
        GHU                        INIT ('GHU '),                       
        GHN                        INIT ('GHN '),                       
        GHNP                       INIT ('GHNP'),                       
        ISRT                       INIT ('ISRT'),                       
        DLET                       INIT ('DLET'),                       
        REPL                       INIT ('REPL'),                       
        PURG                       INIT ('PURG'),                       
        CHNG                       INIT ('CHNG') )                      
                                   CHAR(  4)  STATIC;                   
    DCL                                                                 
      ( PARMCOUNT_2                INIT (2),                            
        PARMCOUNT_3                INIT (3),                            
        PARMCOUNT_4                INIT (4),                            
        PARMCOUNT_5                INIT (5),                            
        THREE                      INIT (3),                            
        FOUR                       INIT (4),                            
        FIVE                       INIT (5) )                           
                                   FIXED BINARY (31);                   
    DCL                                                                 
        PLITDLI                    ENTRY  EXTERNAL,                     
        EDPDTMOD                   ENTRY  OPTIONS (ASSEMBLER,INTER);    
    DCL                                                                 
      ( TERM_PCB_PTR,                                                   
        ALTER_PCB_PTR,                                                  
        TOWN__PCB_PTR,                                                  
        LOG_PCB_PTR,                                                    
        STA_PCB_PTR,                                                    
        MCH_PCB_PTR,                                                    
        MECH_PCB_PTR,                                                   
        P,                                                              
        AN )                       POINTER;                             
    DCL                                                                 
      ( ADDR,                                                           
        DATE,                                                           
        SUBSTR,                                                         
        VERIFY )                   BUILTIN;                             
    DCL                                                                 
        1 EDP_DATE_AREA,                                                
            2 JUL_EDP_DATE       CHAR(  5),                             
            2 EDP_FILLER         CHAR( 75);                             
    DCL                                                                 
        INPUT_AREA                    CHAR(223),                        
        1 IN_AREA                  DEFINED(INPUT_AREA),                 
           2 RECORD_AREA_IN,                                            
              3 TRANS_IN                CHAR  (02),                     
              3 TRANS                   CHAR  (02),                     
              3 DATA_IN                 CHAR (219);                     
                                                                        
 /******************************************************************    
                                                                        
           !!!!!   DATA_IN  (219 CHARACTERS) !!!!!                      
                                                                        
                4 LIST_STATION_NO,                                      
                  5 LIST_STA1           CHAR (01),       * --001-- *    
                  5 LIST_STA2           CHAR (01),       * --002-- *    
                  5 LIST_STA3           CHAR (01),       * --003-- *    
                  5 LIST_STA4           CHAR (01),       * --004-- *    
                4 LIST_LABEL_IND        CHAR (01),       * --005-- *    
                4 LIST_LISTING_IND      CHAR (01),       * --006-- *    
                4 LIST_ALL_STATIONS     CHAR (01),       * --007-- *    
                4 LIST_ALL_MECHANICS    CHAR (01),       * --008-- *    
                4 LIST_TYPE_STATION     CHAR (01),       * --009-- *    
                4 LIST_COUNTY           CHAR (02),       * 010-011 *    
                4 LIST_AUDIT_SUMMARY    CHAR (01),       * --012-- *    
                4 LIST_TERM_OPER_CDE    CHAR (01),       * --013-- *    
                4 LIST_FILLER          CHAR (206);       * 014-219 *    
                                                                        
                                                                        
           !!!!!   RECORD_AREA_IN  (223  CHARACTERS)  !!!               
                                                                        
   1  STICKER_LOG,                                                      
     2  STICKER_TRAN_CODE                      CHAR (04),  * 001-004 *  
     2  STICKER_STATION_NUMBER                 CHAR (04),  * 005-008 *  
     2  LOG_STICKER_#_LOW                      CHAR (10),  * 009-018 *  
     2  LOG_STICKER_#_HI                       CHAR (10),  * 019-028 *  
     2  LOG_#_FREE_STICKERS                    CHAR (03),  * 029-031 *  
     2  LOG_DATE_OF_PURCHASE                   CHAR (06),  * 032-037 *  
     2  LOG_FEE_TENDERED                       CHAR (06),  * 038-043 *  
     2  LOG_TRANSMITTAL_NUMBER                 CHAR (09),  * 044-052 *  
     2  LOG_MAIL_LABEL                         CHAR (01),  * --053-- *  
     2  LOG_OLD_STATION_#                      CHAR (04),  * 054-057 *  
     2  LOG_OLD_STKR_#_HIGH                    CHAR (10),  * 058-067 *  
     2  LOG_STICKER_TYP                        CHAR (01),  * --068-- *  
     2  LOG_ISSUING_LOCATION                   CHAR (01),  * --069-- *  
     2  LOG_MESSENGER_NUMBER                   CHAR (05),  * 070-074 *  
     2  LOG_TOTAL_STICKERS                     CHAR (04),  * 075-078 *  
     2  LOG_IN18_PROCESS_CODE                  CHAR (01),  * --079-- *  
     2  FILLER1                                CHAR (94),  * 080-173 *  
     2  LOG_TERMINAL                           CHAR (08),  * 174-181 *  
     2  FILLER2                                CHAR (01),  * --182-- *  
     2  LOG_OPER_CDE                           CHAR (01),  * --183-- *  
     2  FILLER3                                CHAR (40);  * 184-223 *  
                                                                        
  ******************************************************************/   
                                                                        
    DCL                                                                 
        1 TPINSM_AREA,                                                  
           2 TPINSM_DATE           CHAR (5),                            
           2 TPINSM_OUT,                                                
              3 TRANS_OUT          CHAR (2),                            
              3 TRANS_NO_OUT       CHAR (2),                            
              3 DATA_OUT           CHAR (219);                          
    DCL                                                                 
        1 TPLALI_AREA,                                                  
           2 TPLALI_DATE           CHAR (5),                            
           2 TPLALI_OUT,                                                
              3 TRANS_OUT_20       CHAR(  2),                           
              3 TRANS_NO_OUT_20    CHAR(  2),                           
              3 DATA_OUT_20        CHAR( 13),                           
              3 TRANSMITTAL        CHAR(  9),                           
              3 STATION_#          CHAR(  4),                           
              3 TPLALI_OUT_FILLER  CHAR(  5);                           
    DCL                                                                 
        MASTER_ROOT_IN             CHAR( 10),                           
        1 MASTER_ROOT_AREA         DEFINED(MASTER_ROOT_IN),             
           2 JUL_DATE_MR           CHAR(  5),                           
           2 IN_MR                 CHAR(  2),                           
           2 FILLER_MR             CHAR(  3);                           
    DCL                                                                 
        1 DAILY_LOG_PCB            BASED   (LOG_PCB_PTR),               
           2 DBD_NAME_LOG          CHAR (8),                            
           2 SEG_LEVEL_LOG         CHAR (2),                            
           2 STATUS_CODE_LOG       CHAR (2);                            
    DCL                                                                 
      ( UPDATE_SW,                                                      
        MESSAGE,                                                        
        LABELS )                   BIT(1)     INIT('0'B);               
    DCL                                                                 
        1 DAILY_LOG_SSA,                                                
           2 ROOT_NAME_LOG         CHAR (9)    INIT ('INDLOG   ');      
    DCL                                                                 
        1 DAILY_LOG_TRANS_SSA,                                          
           2 ROOT_NAME_TRANS       CHAR (9)    INIT ('INTRAN   ');      
    DCL                                                                 
        1 DATE_IN               CHAR (6);                               
       DATE_IN = DATE;                                                  
       CALL EDPDTMOD (EDP_DATE_AREA);                                   
       TPLALI_DATE = JUL_EDP_DATE;                                      
       TPINSM_DATE = JUL_EDP_DATE;                                      
                                                                        
   OPEN_FILES:                                                          
       OPEN FILE  (TPLALI)  OUTPUT;                                     
       OPEN FILE  (TPINSM)  OUTPUT;                                     
                                                                        
   SET_DATES_AND_RESET_TOTALS:                                          
       TOTAL_IN     = 0;                                                
       TOTAL_TPINSM = 0;                                                
       TOTAL_TPLALI = 0;                                                
       NO_01_IN     = 0;                                                
       NO_02_IN     = 0;                                                
       NO_03_IN     = 0;                                                
       NO_04_IN     = 0;                                                
       NO_05_IN     = 0;                                                
       NO_06_IN     = 0;                                                
       NO_07_IN     = 0;                                                
       NO_08_IN     = 0;                                                
       NO_09_IN     = 0;                                                
       NO_10_IN     = 0;                                                
       NO_11_IN     = 0;                                                
       NO_12_IN     = 0;                                                
       NO_13_IN     = 0;                                                
       NO_14_IN     = 0;                                                
       NO_15_IN     = 0;                                                
       NO_16_IN     = 0;                                                
       NO_17_IN     = 0;                                                
       NO_18_IN     = 0;                                                
       NO_19_IN     = 0;                                                
       NO_20_IN     = 0;                                                
       NO_23_IN     = 0;                                                
       NO_IA_IN     = 0;                                                
       NO_IB_IN     = 0;                                                
       NO_IC_IN     = 0;                                                
       NO_ID_IN     = 0;                                                
       NO_I1_IN     = 0;                                                
       NO_I3_IN     = 0;                                                
                                                                        
       NO_01_OUT    = 0;                                                
       NO_02_OUT    = 0;                                                
       NO_03_OUT    = 0;                                                
       NO_04_OUT    = 0;                                                
       NO_05_OUT    = 0;                                                
       NO_06_OUT    = 0;                                                
       NO_07_OUT    = 0;                                                
       NO_08_OUT    = 0;                                                
       NO_09_OUT    = 0;                                                
       NO_10_OUT    = 0;                                                
       NO_11_OUT    = 0;                                                
       NO_12_OUT    = 0;                                                
       NO_13_OUT    = 0;                                                
       NO_14_OUT    = 0;                                                
       NO_15_OUT    = 0;                                                
       NO_16_OUT    = 0;                                                
       NO_17_OUT    = 0;                                                
       NO_18_OUT    = 0;                                                
       NO_19_OUT    = 0;                                                
       NO_17_LAB    = 0;                                                
       NO_18_LAB    = 0;                                                
       NO_20_OUT    = 0;                                                
       NO_23_OUT    = 0;                                                
       NO_IA_OUT    = 0;                                                
       NO_IB_OUT    = 0;                                                
       NO_IC_OUT    = 0;                                                
       NO_ID_OUT    = 0;                                                
       NO_I1_OUT    = 0;                                                
       NO_I3_OUT    = 0;                                                
                                                                        
  GET_A_TRANS:                                                          
    CALL PLITDLI (PARMCOUNT_4,GN,LOG_PCB_PTR,INPUT_AREA,                
                  DAILY_LOG_TRANS_SSA);                                 
    IF STATUS_CODE_LOG = 'GB'  ³  STATUS_CODE_LOG = 'GA'                
    THEN                                                                
       DO;                                                              
          IF STATUS_CODE_LOG = 'GA'                                     
          THEN                                                          
             DO;                                                        
                MASTER_ROOT_IN = SUBSTR (INPUT_AREA,1,10);              
                GO TO GET_A_TRANS;                                      
             END;                                                       
          IF STATUS_CODE_LOG = 'GB'                                     
          THEN                                                          
            DO;                                                         
          PUT EDIT ('P7203020 ','INSPECTION DAILY LOG DUMP','DATE: ',   
                     SUBSTR(DATE_IN,3,2),'-',SUBSTR(DATE_IN,5,2),'-',   
                     SUBSTR(DATE_IN,1,2))                               
                    (PAGE,A(9),X(42),A(25),X(30),A,A(2),A,A(2),A,A(2)); 
          PUT EDIT ('CONTROL REPORT') (SKIP(2),X(57),A);                
          PUT EDIT ('PRODUCTION KEY') (SKIP(3),X(9),A);                 
          PUT EDIT (MASTER_ROOT_IN,'SEGMENTS IN','SEGMENTS OUT')        
                    (SKIP(2),X(10),A,X(25),A,X(14),A);                  
          PUT EDIT ('----------','TRANSACTION  NUMBER','TPINSM  TPLALI' 
                                ) (SKIP,X(9),A,X(21),A,X(9),A);         
          PUT EDIT ('IN01',NO_01_IN,NO_01_OUT)                          
                    (SKIP(2),X(44),A,X(6),F(5),X(10),F(5));             
          PUT EDIT ('IN02',NO_02_IN,NO_02_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN03',NO_03_IN,NO_03_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN04',NO_04_IN,NO_04_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN05',NO_05_IN,NO_05_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN06',NO_06_IN,NO_06_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN07',NO_07_IN,NO_07_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN08',NO_08_IN,NO_08_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN09',NO_09_IN,NO_09_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN10',NO_10_IN,NO_10_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN11',NO_11_IN,NO_11_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN12',NO_12_IN,NO_12_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN13',NO_13_IN,NO_13_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN14',NO_14_IN,NO_14_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN15',NO_15_IN,NO_15_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN16',NO_16_IN,NO_16_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN17',NO_17_IN,NO_17_OUT,NO_17_LAB)                
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5),X(3),F(5));      
          PUT EDIT ('IN18',NO_18_IN,NO_18_OUT,NO_18_LAB)                
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5),X(3),F(5));      
          PUT EDIT ('IN19',NO_19_IN,NO_19_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('IN20',NO_20_IN,NO_20_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(18),F(5));                
          PUT EDIT ('IN23',NO_23_IN,NO_23_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('INIA',NO_IA_IN,NO_IA_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('INIB',NO_IB_IN,NO_IB_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('INIC',NO_IC_IN,NO_IC_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('INID',NO_ID_IN,NO_ID_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('INI1',NO_I1_IN,NO_I1_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('INI3',NO_I3_IN,NO_I3_OUT)                          
                    (SKIP,X(44),A,X(6),F(5),X(10),F(5));                
          PUT EDIT ('-----','-----','-----')                            
                    (SKIP,X(54),A,X(10),A,X(3),A);                      
          PUT EDIT ('TOTALS ',TOTAL_IN,TOTAL_TPINSM,TOTAL_TPLALI)       
                        (SKIP,X(46),A,F(6),X(9),F(6),X(2),F(6));        
             GO TO END_JOB;                                             
           END;                                                         
       END;                                                             
    ELSE                                                                
       DO;                                                              
          IF STATUS_CODE_LOG = '  ' &                                   
             SUBSTR(INPUT_AREA,1,5) = 'DUMMY'                           
                  THEN GO TO GET_A_TRANS;                               
                                                                        
          IF STATUS_CODE_LOG = '  '                                     
          THEN DO;                                                      
                IF TRANS = '01' ³ TRANS = '02' ³ TRANS = '03' ³         
                   TRANS = '04' ³ TRANS = '05' ³ TRANS = '06' ³         
                   TRANS = '07' ³ TRANS = '08' ³ TRANS = '09' ³         
                   TRANS = '10' ³ TRANS = '11' ³ TRANS = '14' ³         
                   TRANS = '12' ³ TRANS = '13' ³ TRANS = '17' ³         
                   TRANS = '15' ³ TRANS = '16' ³ TRANS = 'IA' ³         
                   TRANS = '18' ³ TRANS = '19' ³ TRANS = 'ID' ³         
                   TRANS = 'IB' ³ TRANS = 'IC' ³ TRANS = '23' ³         
                   TRANS = 'I1' ³ TRANS = 'I3'                          
                THEN                                                    
                   UPDATE_SW = '1'B;                                    
                IF (TRANS = '17' &  SUBSTR(INPUT_AREA,53,1) = 'Y') ³    
                   (TRANS = '18' &  SUBSTR(INPUT_AREA,53,1) = 'Y')      
                THEN                                                    
                   LABELS = '1'B;                                       
                TOTAL_IN = TOTAL_IN + 1;                                
                IF TRANS = '01'                                         
                THEN                                                    
                   NO_01_IN  = NO_01_IN  + 1;                           
                IF TRANS = '02'                                         
                THEN                                                    
                   NO_02_IN  = NO_02_IN  + 1;                           
                IF TRANS = '03'                                         
                THEN                                                    
                   NO_03_IN  = NO_03_IN  + 1;                           
                IF TRANS = '04'                                         
                THEN                                                    
                   NO_04_IN  = NO_04_IN  + 1;                           
                IF TRANS = '05'                                         
                THEN                                                    
                   NO_05_IN  = NO_05_IN  + 1;                           
                IF TRANS = '06'                                         
                THEN                                                    
                   NO_06_IN  = NO_06_IN  + 1;                           
                IF TRANS = '07'                                         
                THEN                                                    
                   NO_07_IN  = NO_07_IN  + 1;                           
                IF TRANS = '08'                                         
                THEN                                                    
                   NO_08_IN  = NO_08_IN  + 1;                           
                IF TRANS = '09'                                         
                THEN                                                    
                   NO_09_IN  = NO_09_IN  + 1;                           
                IF TRANS = '10'                                         
                THEN                                                    
                   NO_10_IN  = NO_10_IN  + 1;                           
                IF TRANS = '11'                                         
                THEN                                                    
                   NO_11_IN  = NO_11_IN  + 1;                           
                IF TRANS = '12'                                         
                THEN                                                    
                   NO_12_IN  = NO_12_IN  + 1;                           
                IF TRANS = '13'                                         
                THEN                                                    
                   NO_13_IN  = NO_13_IN  + 1;                           
                IF TRANS = '14'                                         
                THEN                                                    
                   NO_14_IN  = NO_14_IN  + 1;                           
                IF TRANS = '15'                                         
                THEN                                                    
                   NO_15_IN  = NO_15_IN  + 1;                           
                IF TRANS = '16'                                         
                THEN                                                    
                   NO_16_IN  = NO_16_IN  + 1;                           
                IF TRANS = '17'                                         
                THEN                                                    
                   NO_17_IN  = NO_17_IN  + 1;                           
                IF TRANS = '18'                                         
                THEN                                                    
                   NO_18_IN  = NO_18_IN  + 1;                           
                IF TRANS = '19'                                         
                THEN                                                    
                   NO_19_IN  = NO_19_IN  + 1;                           
                IF TRANS = '20'                                         
                THEN                                                    
                   NO_20_IN  = NO_20_IN  + 1;                           
                IF TRANS = '23'                                         
                THEN                                                    
                   NO_23_IN  = NO_23_IN  + 1;                           
                IF TRANS = 'IA'                                         
                THEN                                                    
                   NO_IA_IN  = NO_IA_IN  + 1;                           
                IF TRANS = 'IB'                                         
                THEN                                                    
                   NO_IB_IN  = NO_IB_IN  + 1;                           
                IF TRANS = 'IC'                                         
                THEN                                                    
                   NO_IC_IN  = NO_IC_IN  + 1;                           
                IF TRANS = 'ID'                                         
                THEN                                                    
                   NO_ID_IN  = NO_ID_IN  + 1;                           
                IF TRANS = 'I1'                                         
                THEN                                                    
                   NO_I1_IN  = NO_I1_IN  + 1;                           
                IF TRANS = 'I3'                                         
                THEN                                                    
                   NO_I3_IN  = NO_I3_IN  + 1;                           
                IF (TRANS > '00'  &  TRANS < '17') ³                    
                    TRANS = '19' ³                                      
                    TRANS = '23' ³                                      
                    TRANS = 'IA' ³                                      
                    TRANS = 'IB' ³                                      
                    TRANS = 'IC' ³                                      
                    TRANS = 'ID' ³                                      
                    TRANS = 'I1' ³                                      
                    TRANS = 'I3'                                        
                THEN                                                    
                   DO;                                                  
                      TPINSM_OUT = RECORD_AREA_IN;                      
                      WRITE FILE (TPINSM) FROM (TPINSM_AREA);           
                      TOTAL_TPINSM = TOTAL_TPINSM + 1;                  
                   END;                                                 
                IF TRANS = '17'  ³  TRANS = '18'                        
                THEN                                                    
                   DO;                                                  
                      TPINSM_OUT = RECORD_AREA_IN;                      
                      WRITE FILE (TPINSM) FROM (TPINSM_AREA);           
                      TOTAL_TPINSM = TOTAL_TPINSM + 1;                  
                      IF SUBSTR (INPUT_AREA,53,1) = 'Y'                 
                      THEN                                              
                         DO;                                            
                            TRANS_OUT_20 = TRANS_IN;                    
                            TRANS_NO_OUT_20 = TRANS;                    
                            DATA_OUT_20  =  SUBSTR(DATA_IN,1,13);       
                            TRANSMITTAL =  SUBSTR(DATA_IN,40,9);        
                            STATION_#   =  SUBSTR(DATA_IN,10,4);        
                            SUBSTR(DATA_OUT_20,5,9) =' ';               
                            WRITE FILE (TPLALI) FROM (TPLALI_AREA);     
                            TOTAL_TPLALI = TOTAL_TPLALI + 1;            
                            IF TRANS = '17'                             
                            THEN                                        
                               NO_17_LAB  =  NO_17_LAB + 1;             
                            ELSE                                        
                               NO_18_LAB  =  NO_18_LAB + 1;             
                         END;                                           
                   END;                                                 
     IF TRANS = '20'                                                    
     THEN DO;                                                           
          TRANS_OUT_20 = TRANS_IN;                                      
          TRANS_NO_OUT_20 = TRANS;                                      
          DATA_OUT_20  =  SUBSTR(DATA_IN,1,13);                         
          TRANSMITTAL =  ' ';                                           
          STATION_#   =  ' ';                                           
                                                                        
          IF SUBSTR(DATA_IN,12,1) = ' '                                 
          THEN DO;                                                      
             IF SUBSTR(DATA_IN,1,4) > ' ' ³                             
                SUBSTR(DATA_IN,5,1) > ' '                               
             THEN                                                       
                LABELS = '1'B;                                          
             WRITE FILE (TPLALI) FROM (TPLALI_AREA);                    
          END;                                                          
                                                                        
          IF SUBSTR(DATA_IN,12,1) = 'Y'                                 
          THEN                                                          
              MESSAGE = '1'B;                                           
      TOTAL_TPLALI = TOTAL_TPLALI + 1;                                  
      END;                                                              
                                                                        
                IF TRANS = '01'                                         
                THEN                                                    
                   NO_01_OUT = NO_01_OUT + 1;                           
                IF TRANS = '02'                                         
                THEN                                                    
                   NO_02_OUT = NO_02_OUT + 1;                           
                IF TRANS = '03'                                         
                THEN                                                    
                   NO_03_OUT = NO_03_OUT + 1;                           
                IF TRANS = '04'                                         
                THEN                                                    
                   NO_04_OUT = NO_04_OUT + 1;                           
                IF TRANS = '05'                                         
                THEN                                                    
                   NO_05_OUT = NO_05_OUT + 1;                           
                IF TRANS = '06'                                         
                THEN                                                    
                   NO_06_OUT = NO_06_OUT + 1;                           
                IF TRANS = '07'                                         
                THEN                                                    
                   NO_07_OUT = NO_07_OUT + 1;                           
                IF TRANS = '08'                                         
                THEN                                                    
                   NO_08_OUT = NO_08_OUT + 1;                           
                IF TRANS = '09'                                         
                THEN                                                    
                   NO_09_OUT = NO_09_OUT + 1;                           
                IF TRANS = '10'                                         
                THEN                                                    
                   NO_10_OUT = NO_10_OUT + 1;                           
                IF TRANS = '11'                                         
                THEN                                                    
                   NO_11_OUT = NO_11_OUT + 1;                           
                IF TRANS = '12'                                         
                THEN                                                    
                   NO_12_OUT = NO_12_OUT + 1;                           
                IF TRANS = '13'                                         
                THEN                                                    
                   NO_13_OUT = NO_13_OUT + 1;                           
                IF TRANS = '14'                                         
                THEN                                                    
                   NO_14_OUT = NO_14_OUT + 1;                           
                IF TRANS = '15'                                         
                THEN                                                    
                   NO_15_OUT = NO_15_OUT + 1;                           
                IF TRANS = '16'                                         
                THEN                                                    
                   NO_16_OUT = NO_16_OUT + 1;                           
                IF TRANS = '17'                                         
                THEN                                                    
                   NO_17_OUT = NO_17_OUT + 1;                           
                IF TRANS = '18'                                         
                THEN                                                    
                   NO_18_OUT = NO_18_OUT + 1;                           
                IF TRANS = '19'                                         
                THEN                                                    
                   NO_19_OUT = NO_19_OUT + 1;                           
                IF TRANS = '20'                                         
                THEN                                                    
                   NO_20_OUT = NO_20_OUT + 1;                           
                IF TRANS = '23'                                         
                THEN                                                    
                   NO_23_OUT = NO_23_OUT + 1;                           
                IF TRANS = 'IA'                                         
                THEN                                                    
                   NO_IA_OUT = NO_IA_OUT + 1;                           
                IF TRANS = 'IB'                                         
                THEN                                                    
                   NO_IB_OUT = NO_IB_OUT + 1;                           
                IF TRANS = 'IC'                                         
                THEN                                                    
                   NO_IC_OUT = NO_IC_OUT + 1;                           
                IF TRANS = 'ID'                                         
                THEN                                                    
                   NO_ID_OUT = NO_ID_OUT + 1;                           
                IF TRANS = 'I1'                                         
                THEN                                                    
                   NO_I1_OUT = NO_I1_OUT + 1;                           
                IF TRANS = 'I3'                                         
                THEN                                                    
                   NO_I3_OUT = NO_I3_OUT + 1;                           
                GO TO GET_A_TRANS;                                      
             END;                                                       
          ELSE                                                          
             DO;                                                        
                 DISPLAY ('PROGRAM 7203020: TERMINATED ABNORMALLY BY '  
                  ³³STATUS_CODE_LOG³³' STATUS CODE.');                  
                 PUT EDIT ('PROGRAM ABNORMALLY TERMINATED BY ',         
                  STATUS_CODE_LOG,' STATUS CODE.')                      
                       (SKIP(2),A,A(2),A);                              
                 STOP;                                                  
             END;                                                       
       END;                                                             
 END_JOB:                                                               
    IF ª UPDATE_SW                                                      
    THEN                                                                
       DO;                                                              
          TRANS_OUT = 'IN';                                             
          TRANS_NO_OUT = '00';                                          
          DATA_IN = (' ');                                              
          WRITE FILE (TPINSM) FROM (TPINSM_AREA);                       
       END;                                                             
                                                                        
 IF MESSAGE                                                             
 THEN DO;                                                               
       DISPLAY ('***********************************************');     
       DISPLAY ('***********************************************');     
       DISPLAY ('***********************************************');     
       DISPLAY ('***                                         ***');     
       DISPLAY ('***   ATTENTION OPERATIONS:                 ***');     
       DISPLAY ('***      INSPECTION STATISTICS REQUESTED    ***');     
       DISPLAY ('***      RUN JOB "AUDITSUM" TONITE          ***');     
       DISPLAY ('!!!      WHEN STINSPEC ENDS ! ! ! ! !       !!!');     
       DISPLAY ('***                                         ***');     
       DISPLAY ('***********************************************');     
       DISPLAY ('***********************************************');     
       DISPLAY ('***********************************************');     
     END;                                                               
                                                                        
    IF LABELS                                                           
    THEN DO;                                                            
       DISPLAY ('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');     
       DISPLAY ('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');     
       DISPLAY ('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');     
       DISPLAY ('!!!                                         !!!');     
       DISPLAY ('!!!   ATTENTION OPERATIONS:                 !!!');     
       DISPLAY ('!!!      INSPECTION  LABELS  REQUESTED      !!!');     
       DISPLAY ('!!!      RUN JOB "INSPLABL" TONITE          !!!');     
       DISPLAY ('!!!      WHEN STINSPEC ENDS ! ! ! ! !       !!!');     
       DISPLAY ('!!!                                         !!!');     
       DISPLAY ('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');     
       DISPLAY ('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');     
       DISPLAY ('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');     
    END;                                                                
 CLOSE FILE(TPLALI),FILE(TPINSM);                                       
 END DLITPLI;                                                           
 