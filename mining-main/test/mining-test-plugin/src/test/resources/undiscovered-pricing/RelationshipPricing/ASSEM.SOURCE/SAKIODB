* REL=SAKIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SAKIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAK FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL303                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST1    DS    CL4                                                      00038000
PRDCDE1  DS    CL6                                                      00039000
ACCTNBR1 DS    CL18                                                     00040000
MODEL1   DS    CL10                                                     00041000
INST2    DS    CL4                                                      00042000
PRDCDE2  DS    CL6                                                      00043000
ACCTNBR2 DS    CL18                                                     00044000
AUDDATE  DS    PL5'0.'                                                  00045000
AUDTIME  DS    PL5'0.'                                                  00046000
AUDUSER  DS    CL8                                                      00047000
AUDORG   DS    CL6                                                      00048000
IDNBR    DS    CL18                                                     00049000
BALOPT   DS    CL1                                                      00050000
PCTUSED  DS    PL5'0.000000000'                                         00051000
LCMBUSED DS    PL8'0.00'                                                00052000
FREQ     DS    CL1                                                      00053000
TERM     DS    PL2'0.'                                                  00054000
DAYMTH   DS    CL2                                                      00055000
NEXTDATE DS    PL5'0.'                                                  00056000
LASTDATE DS    PL5'0.'                                                  00057000
AMT      DS    PL6'0.00'                                                00058000
LASTAMT  DS    PL6'0.00'                                                00059000
AMTYTD   DS    PL8'0.00'                                                00060000
CMBBAL01 DS    PL8'0.00'                                                00061000
CMBBAL02 DS    PL8'0.00'                                                00062000
CMBBAL03 DS    PL8'0.00'                                                00063000
CMBBAL04 DS    PL8'0.00'                                                00064000
CMBBAL05 DS    PL8'0.00'                                                00065000
CMBBAL06 DS    PL8'0.00'                                                00066000
CMBBAL07 DS    PL8'0.00'                                                00067000
CMBBAL08 DS    PL8'0.00'                                                00068000
CMBBAL09 DS    PL8'0.00'                                                00069000
CMBBAL10 DS    PL8'0.00'                                                00070000
CMBBAL11 DS    PL8'0.00'                                                00071000
CMBBAL12 DS    PL8'0.00'                                                00072000
DATEOPN  DS    PL5'0.'                                                  00073000
RAREA    DS    CL45                                                     00074000
*                                                                       00075000
*                                                                       00076000
**********************************************************************  00077000
* PROGRAM TABLE HEADER SECTION:                                         00078000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00079000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00080000
**********************************************************************  00081000
*                                                                       00082000
SAKIODB  CSECT                         PROGRAM TABLE SECTION            00083000
SAKIODB  AMODE ANY                                                      00084000
SAKIODB  RMODE ANY                                                      00085000
         DC    CL9'SAKIODB'            PROGRAM ID                       00086000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00087000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00088000
         DC    A(0)                    RESERVED                         00089000
         DC    A(0)                    RESERVED                         00090000
         DC    24CL1' '                RESERVED                         00091000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00092000
*                                                                       00093000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00094000
         DC    CL29'WWW.INFOR.COM                '                      00094001
*                                                                       00095000
*                                                                       00096000
**********************************************************************  00097000
* STATEMENT TABLE SECTION:                                              00098000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00099000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00100000
*   SHOULD NOT BE MODIFIED.                                             00101000
**********************************************************************  00102000
*                                                                       00103000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00104000
STM#TAB  AMODE ANY                                                      00105000
STM#TAB  RMODE ANY                                                      00106000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00107000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00108000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00109000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00110000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00111000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00112000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00113000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00114000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00115000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00116000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00117000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00118000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00119000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00120000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00121000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00122000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00123000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00124000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00125000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00126000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00127000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00128000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00129000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00130000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00131000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00132000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00133000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00134000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00135000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00136000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00137000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00138000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00139000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00140000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00141000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00142000
         DC    A(SQL#0036)             INSERT STATEMENT                 00143000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00144000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00145000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00146000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00147000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00148000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00149000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00150000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00151000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00152000
         DC    4X'FF'                                                   00153000
*                                                                       00154000
*                                                                       00155000
**********************************************************************  00156000
* SQL STATEMENT SECTION:                                                00157000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00158000
*     TO SUPPORT THIS TABLE.                                            00159000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00160000
*     ARE EQUIVALENT.                                                   00161000
**********************************************************************  00162000
*                                                                       00163000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00164000
SQL#STMT AMODE ANY                                                      00165000
SQL#STMT RMODE ANY                                                      00166000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00167000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00168000
         USING COM#AREA,11             ADDRESS COMMAREA                 00169000
*                                                                       00170000
*                                                                       00171000
**********************************************************************  00172000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00173000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00174000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00175000
**********************************************************************  00176000
*                                                                       00177000
SQL#0000 DS    0H                                                       00178000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00179000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00180000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00181000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00182000
         EXEC  SQL                                                     *00183000
               SELECT AUDIT_DATE,                                      *00184000
                   AUDIT_TIME,                                         *00185000
                   AUDIT_USER,                                         *00186000
                   AUDIT_ORG,                                          *00187000
                   IDENT_NBR,                                          *00188000
                   BAL_OPT,                                            *00189000
                   PCT_USED,                                           *00190000
                   LST_CMB_BAL_USE,                                    *00191000
                   FREQUENCY,                                          *00192000
                   TERM,                                               *00193000
                   DAY_MONTH,                                          *00194000
                   NEXT_DATE,                                          *00195000
                   LAST_DATE,                                          *00196000
                   AMOUNT,                                             *00197000
                   LAST_AMT,                                           *00198000
                   AMOUNT_YTD,                                         *00199000
                   MTH_CMB_BAL_01,                                     *00200000
                   MTH_CMB_BAL_02,                                     *00201000
                   MTH_CMB_BAL_03,                                     *00202000
                   MTH_CMB_BAL_04,                                     *00203000
                   MTH_CMB_BAL_05,                                     *00204000
                   MTH_CMB_BAL_06,                                     *00205000
                   MTH_CMB_BAL_07,                                     *00206000
                   MTH_CMB_BAL_08,                                     *00207000
                   MTH_CMB_BAL_09,                                     *00208000
                   MTH_CMB_BAL_10,                                     *00209000
                   MTH_CMB_BAL_11,                                     *00210000
                   MTH_CMB_BAL_12,                                     *00211000
                   DATE_OPEN,                                          *00212000
                   RSV_AREA                                            *00213000
                 INTO :AUDDATE,                                        *00214000
                   :AUDTIME,                                           *00215000
                   :AUDUSER,                                           *00216000
                   :AUDORG,                                            *00217000
                   :IDNBR,                                             *00218000
                   :BALOPT,                                            *00219000
                   :PCTUSED,                                           *00220000
                   :LCMBUSED,                                          *00221000
                   :FREQ,                                              *00222000
                   :TERM,                                              *00223000
                   :DAYMTH,                                            *00224000
                   :NEXTDATE,                                          *00225000
                   :LASTDATE,                                          *00226000
                   :AMT,                                               *00227000
                   :LASTAMT,                                           *00228000
                   :AMTYTD,                                            *00229000
                   :CMBBAL01,                                          *00230000
                   :CMBBAL02,                                          *00231000
                   :CMBBAL03,                                          *00232000
                   :CMBBAL04,                                          *00233000
                   :CMBBAL05,                                          *00234000
                   :CMBBAL06,                                          *00235000
                   :CMBBAL07,                                          *00236000
                   :CMBBAL08,                                          *00237000
                   :CMBBAL09,                                          *00238000
                   :CMBBAL10,                                          *00239000
                   :CMBBAL11,                                          *00240000
                   :CMBBAL12,                                          *00241000
                   :DATEOPN,                                           *00242000
                   :RAREA                                              *00243000
                 FROM SAK                                              *00244000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00245000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00246000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00247000
                   MODEL_1 = :MODEL1 AND                               *00248000
                   ACCT_INST_2 = :INST2 AND                            *00249000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00250000
                   ACCT_NBR_2 = :ACCTNBR2                              *00251000
                 FETCH FIRST 1 ROW ONLY                                 00252000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00253000
         BALR  4,5                     MOVE INTO RECORD AREA            00254000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00255000
         BR    14                      RETURN TO CALLER                 00256000
         LTORG                                                          00257000
*                                                                       00258000
*                                                                       00259000
**********************************************************************  00260000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00261000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00262000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00263000
**********************************************************************  00264000
*                                                                       00265000
SQL#0001 DS    0H                                                       00266000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00267000
         LA    3,X'40'                 LOAD MASK FOR KEY 1              00268000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00269000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00270000
         EXEC  SQL                                                     *00271000
               SELECT ACCT_INST_1,                                     *00272000
                   PROD_CODE_1,                                        *00273000
                   ACCT_NBR_1,                                         *00274000
                   MODEL_1,                                            *00275000
                   AUDIT_DATE,                                         *00276000
                   AUDIT_TIME,                                         *00277000
                   AUDIT_USER,                                         *00278000
                   AUDIT_ORG,                                          *00279000
                   IDENT_NBR,                                          *00280000
                   BAL_OPT,                                            *00281000
                   PCT_USED,                                           *00282000
                   LST_CMB_BAL_USE,                                    *00283000
                   FREQUENCY,                                          *00284000
                   TERM,                                               *00285000
                   DAY_MONTH,                                          *00286000
                   NEXT_DATE,                                          *00287000
                   LAST_DATE,                                          *00288000
                   AMOUNT,                                             *00289000
                   LAST_AMT,                                           *00290000
                   AMOUNT_YTD,                                         *00291000
                   MTH_CMB_BAL_01,                                     *00292000
                   MTH_CMB_BAL_02,                                     *00293000
                   MTH_CMB_BAL_03,                                     *00294000
                   MTH_CMB_BAL_04,                                     *00295000
                   MTH_CMB_BAL_05,                                     *00296000
                   MTH_CMB_BAL_06,                                     *00297000
                   MTH_CMB_BAL_07,                                     *00298000
                   MTH_CMB_BAL_08,                                     *00299000
                   MTH_CMB_BAL_09,                                     *00300000
                   MTH_CMB_BAL_10,                                     *00301000
                   MTH_CMB_BAL_11,                                     *00302000
                   MTH_CMB_BAL_12,                                     *00303000
                   DATE_OPEN,                                          *00304000
                   RSV_AREA                                            *00305000
                 INTO :INST1,                                          *00306000
                   :PRDCDE1,                                           *00307000
                   :ACCTNBR1,                                          *00308000
                   :MODEL1,                                            *00309000
                   :AUDDATE,                                           *00310000
                   :AUDTIME,                                           *00311000
                   :AUDUSER,                                           *00312000
                   :AUDORG,                                            *00313000
                   :IDNBR,                                             *00314000
                   :BALOPT,                                            *00315000
                   :PCTUSED,                                           *00316000
                   :LCMBUSED,                                          *00317000
                   :FREQ,                                              *00318000
                   :TERM,                                              *00319000
                   :DAYMTH,                                            *00320000
                   :NEXTDATE,                                          *00321000
                   :LASTDATE,                                          *00322000
                   :AMT,                                               *00323000
                   :LASTAMT,                                           *00324000
                   :AMTYTD,                                            *00325000
                   :CMBBAL01,                                          *00326000
                   :CMBBAL02,                                          *00327000
                   :CMBBAL03,                                          *00328000
                   :CMBBAL04,                                          *00329000
                   :CMBBAL05,                                          *00330000
                   :CMBBAL06,                                          *00331000
                   :CMBBAL07,                                          *00332000
                   :CMBBAL08,                                          *00333000
                   :CMBBAL09,                                          *00334000
                   :CMBBAL10,                                          *00335000
                   :CMBBAL11,                                          *00336000
                   :CMBBAL12,                                          *00337000
                   :DATEOPN,                                           *00338000
                   :RAREA                                              *00339000
                 FROM SAK                                              *00340000
                 WHERE ACCT_INST_2 = :INST2 AND                        *00341000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00342000
                   ACCT_NBR_2 = :ACCTNBR2                               00343000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00344000
         BALR  4,5                     MOVE INTO RECORD AREA            00345000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00346000
         BR    14                      RETURN TO CALLER                 00347000
         LTORG                                                          00348000
*                                                                       00349000
*                                                                       00350000
**********************************************************************  00351000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00352000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00353000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00354000
**********************************************************************  00355000
*                                                                       00356000
SQL#0002 DS    0H                                                       00357000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00358000
         LA    15,255                  SET RETURN CODE                  00359000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00360000
         BR    14                      RETURN TO CALLER                 00361000
         LTORG                                                          00362000
*                                                                       00363000
*                                                                       00364000
**********************************************************************  00365000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00366000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00367000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00368000
**********************************************************************  00369000
*                                                                       00370000
SQL#0003 DS    0H                                                       00371000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00372000
         LA    15,255                  SET RETURN CODE                  00373000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00374000
         BR    14                      RETURN TO CALLER                 00375000
         LTORG                                                          00376000
*                                                                       00377000
*                                                                       00378000
**********************************************************************  00379000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00380000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00381000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00382000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00383000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00384000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00385000
*     UPDATE STATEMENT TO MATCH.                                        00386000
**********************************************************************  00387000
*                                                                       00388000
SQL#0004 DS    0H                                                       00389000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00390000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00391000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00392000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00393000
         EXEC  SQL                                                     *00394000
               DECLARE SAKUPD0 CURSOR FOR                              *00395000
               SELECT AUDIT_DATE,                                      *00396000
                   AUDIT_TIME,                                         *00397000
                   AUDIT_USER,                                         *00398000
                   AUDIT_ORG,                                          *00399000
                   IDENT_NBR,                                          *00400000
                   BAL_OPT,                                            *00401000
                   PCT_USED,                                           *00402000
                   LST_CMB_BAL_USE,                                    *00403000
                   FREQUENCY,                                          *00404000
                   TERM,                                               *00405000
                   DAY_MONTH,                                          *00406000
                   NEXT_DATE,                                          *00407000
                   LAST_DATE,                                          *00408000
                   AMOUNT,                                             *00409000
                   LAST_AMT,                                           *00410000
                   AMOUNT_YTD,                                         *00411000
                   MTH_CMB_BAL_01,                                     *00412000
                   MTH_CMB_BAL_02,                                     *00413000
                   MTH_CMB_BAL_03,                                     *00414000
                   MTH_CMB_BAL_04,                                     *00415000
                   MTH_CMB_BAL_05,                                     *00416000
                   MTH_CMB_BAL_06,                                     *00417000
                   MTH_CMB_BAL_07,                                     *00418000
                   MTH_CMB_BAL_08,                                     *00419000
                   MTH_CMB_BAL_09,                                     *00420000
                   MTH_CMB_BAL_10,                                     *00421000
                   MTH_CMB_BAL_11,                                     *00422000
                   MTH_CMB_BAL_12,                                     *00423000
                   DATE_OPEN,                                          *00424000
                   RSV_AREA                                            *00425000
                 FROM SAK                                              *00426000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00427000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00428000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00429000
                   MODEL_1 = :MODEL1 AND                               *00430000
                   ACCT_INST_2 = :INST2 AND                            *00431000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00432000
                   ACCT_NBR_2 = :ACCTNBR2                              *00433000
                 FOR UPDATE OF AUDIT_DATE,                             *00434000
                   AUDIT_TIME,                                         *00435000
                   AUDIT_USER,                                         *00436000
                   AUDIT_ORG,                                          *00437000
                   IDENT_NBR,                                          *00438000
                   BAL_OPT,                                            *00439000
                   PCT_USED,                                           *00440000
                   LST_CMB_BAL_USE,                                    *00441000
                   FREQUENCY,                                          *00442000
                   TERM,                                               *00443000
                   DAY_MONTH,                                          *00444000
                   NEXT_DATE,                                          *00445000
                   LAST_DATE,                                          *00446000
                   AMOUNT,                                             *00447000
                   LAST_AMT,                                           *00448000
                   AMOUNT_YTD,                                         *00449000
                   MTH_CMB_BAL_01,                                     *00450000
                   MTH_CMB_BAL_02,                                     *00451000
                   MTH_CMB_BAL_03,                                     *00452000
                   MTH_CMB_BAL_04,                                     *00453000
                   MTH_CMB_BAL_05,                                     *00454000
                   MTH_CMB_BAL_06,                                     *00455000
                   MTH_CMB_BAL_07,                                     *00456000
                   MTH_CMB_BAL_08,                                     *00457000
                   MTH_CMB_BAL_09,                                     *00458000
                   MTH_CMB_BAL_10,                                     *00459000
                   MTH_CMB_BAL_11,                                     *00460000
                   MTH_CMB_BAL_12,                                     *00461000
                   DATE_OPEN,                                          *00462000
                   RSV_AREA                                            *00463000
                 FETCH FIRST 1 ROW ONLY                                 00464000
         EXEC  SQL                                                     *00465000
               OPEN SAKUPD0                                             00466000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00467000
         BR    14                      RETURN TO CALLER                 00468000
         LTORG                                                          00469000
*                                                                       00470000
*                                                                       00471000
**********************************************************************  00472000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00473000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00474000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00475000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00476000
*     UPDATE STATEMENT TO MATCH.                                        00477000
**********************************************************************  00478000
*                                                                       00479000
SQL#0005 DS    0H                                                       00480000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00481000
         LA    3,X'40'                 LOAD MASK FOR KEY 1              00482000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00483000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00484000
         EXEC  SQL                                                     *00485000
               DECLARE SAKUPD1 CURSOR FOR                              *00486000
               SELECT AUDIT_DATE,                                      *00487000
                   AUDIT_TIME,                                         *00488000
                   AUDIT_USER,                                         *00489000
                   AUDIT_ORG,                                          *00490000
                   IDENT_NBR,                                          *00491000
                   BAL_OPT,                                            *00492000
                   PCT_USED,                                           *00493000
                   LST_CMB_BAL_USE,                                    *00494000
                   FREQUENCY,                                          *00495000
                   TERM,                                               *00496000
                   DAY_MONTH,                                          *00497000
                   NEXT_DATE,                                          *00498000
                   LAST_DATE,                                          *00499000
                   AMOUNT,                                             *00500000
                   LAST_AMT,                                           *00501000
                   AMOUNT_YTD,                                         *00502000
                   MTH_CMB_BAL_01,                                     *00503000
                   MTH_CMB_BAL_02,                                     *00504000
                   MTH_CMB_BAL_03,                                     *00505000
                   MTH_CMB_BAL_04,                                     *00506000
                   MTH_CMB_BAL_05,                                     *00507000
                   MTH_CMB_BAL_06,                                     *00508000
                   MTH_CMB_BAL_07,                                     *00509000
                   MTH_CMB_BAL_08,                                     *00510000
                   MTH_CMB_BAL_09,                                     *00511000
                   MTH_CMB_BAL_10,                                     *00512000
                   MTH_CMB_BAL_11,                                     *00513000
                   MTH_CMB_BAL_12,                                     *00514000
                   DATE_OPEN,                                          *00515000
                   RSV_AREA                                            *00516000
                 FROM SAK                                              *00517000
                 WHERE ACCT_INST_2 = :INST2 AND                        *00518000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00519000
                   ACCT_NBR_2 = :ACCTNBR2                              *00520000
                 FOR UPDATE OF AUDIT_DATE,                             *00521000
                   AUDIT_TIME,                                         *00522000
                   AUDIT_USER,                                         *00523000
                   AUDIT_ORG,                                          *00524000
                   IDENT_NBR,                                          *00525000
                   BAL_OPT,                                            *00526000
                   PCT_USED,                                           *00527000
                   LST_CMB_BAL_USE,                                    *00528000
                   FREQUENCY,                                          *00529000
                   TERM,                                               *00530000
                   DAY_MONTH,                                          *00531000
                   NEXT_DATE,                                          *00532000
                   LAST_DATE,                                          *00533000
                   AMOUNT,                                             *00534000
                   LAST_AMT,                                           *00535000
                   AMOUNT_YTD,                                         *00536000
                   MTH_CMB_BAL_01,                                     *00537000
                   MTH_CMB_BAL_02,                                     *00538000
                   MTH_CMB_BAL_03,                                     *00539000
                   MTH_CMB_BAL_04,                                     *00540000
                   MTH_CMB_BAL_05,                                     *00541000
                   MTH_CMB_BAL_06,                                     *00542000
                   MTH_CMB_BAL_07,                                     *00543000
                   MTH_CMB_BAL_08,                                     *00544000
                   MTH_CMB_BAL_09,                                     *00545000
                   MTH_CMB_BAL_10,                                     *00546000
                   MTH_CMB_BAL_11,                                     *00547000
                   MTH_CMB_BAL_12,                                     *00548000
                   DATE_OPEN,                                          *00549000
                   RSV_AREA                                             00550000
         EXEC  SQL                                                     *00551000
               OPEN SAKUPD1                                             00552000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00553000
         BR    14                      RETURN TO CALLER                 00554000
         LTORG                                                          00555000
*                                                                       00556000
*                                                                       00557000
**********************************************************************  00558000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00559000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00560000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00561000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00562000
*     UPDATE STATEMENT TO MATCH.                                        00563000
**********************************************************************  00564000
*                                                                       00565000
SQL#0006 DS    0H                                                       00566000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00567000
         LA    15,255                  SET RETURN CODE                  00568000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00569000
         BR    14                      RETURN TO CALLER                 00570000
         LTORG                                                          00571000
*                                                                       00572000
*                                                                       00573000
**********************************************************************  00574000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00575000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00576000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00577000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00578000
*     UPDATE STATEMENT TO MATCH.                                        00579000
**********************************************************************  00580000
*                                                                       00581000
SQL#0007 DS    0H                                                       00582000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00583000
         LA    15,255                  SET RETURN CODE                  00584000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00585000
         BR    14                      RETURN TO CALLER                 00586000
         LTORG                                                          00587000
*                                                                       00588000
*                                                                       00589000
**********************************************************************  00590000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00591000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00592000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00593000
*     THE ACTUAL ROW.                                                   00594000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00595000
**********************************************************************  00596000
*                                                                       00597000
SQL#0008 DS    0H                                                       00598000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00599000
         EXEC  SQL                                                     *00600000
               FETCH SAKUPD0                                           *00601000
                 INTO :AUDDATE,                                        *00602000
                   :AUDTIME,                                           *00603000
                   :AUDUSER,                                           *00604000
                   :AUDORG,                                            *00605000
                   :IDNBR,                                             *00606000
                   :BALOPT,                                            *00607000
                   :PCTUSED,                                           *00608000
                   :LCMBUSED,                                          *00609000
                   :FREQ,                                              *00610000
                   :TERM,                                              *00611000
                   :DAYMTH,                                            *00612000
                   :NEXTDATE,                                          *00613000
                   :LASTDATE,                                          *00614000
                   :AMT,                                               *00615000
                   :LASTAMT,                                           *00616000
                   :AMTYTD,                                            *00617000
                   :CMBBAL01,                                          *00618000
                   :CMBBAL02,                                          *00619000
                   :CMBBAL03,                                          *00620000
                   :CMBBAL04,                                          *00621000
                   :CMBBAL05,                                          *00622000
                   :CMBBAL06,                                          *00623000
                   :CMBBAL07,                                          *00624000
                   :CMBBAL08,                                          *00625000
                   :CMBBAL09,                                          *00626000
                   :CMBBAL10,                                          *00627000
                   :CMBBAL11,                                          *00628000
                   :CMBBAL12,                                          *00629000
                   :DATEOPN,                                           *00630000
                   :RAREA                                               00631000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00632000
         BALR  4,5                     MOVE INTO RECORD AREA            00633000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00634000
         BR    14                      RETURN TO CALLER                 00635000
         LTORG                                                          00636000
*                                                                       00637000
*                                                                       00638000
**********************************************************************  00639000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00640000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00641000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00642000
*     THE ACTUAL ROW.                                                   00643000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00644000
**********************************************************************  00645000
*                                                                       00646000
SQL#0009 DS    0H                                                       00647000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00648000
         EXEC  SQL                                                     *00649000
               FETCH SAKUPD1                                           *00650000
                 INTO :AUDDATE,                                        *00651000
                   :AUDTIME,                                           *00652000
                   :AUDUSER,                                           *00653000
                   :AUDORG,                                            *00654000
                   :IDNBR,                                             *00655000
                   :BALOPT,                                            *00656000
                   :PCTUSED,                                           *00657000
                   :LCMBUSED,                                          *00658000
                   :FREQ,                                              *00659000
                   :TERM,                                              *00660000
                   :DAYMTH,                                            *00661000
                   :NEXTDATE,                                          *00662000
                   :LASTDATE,                                          *00663000
                   :AMT,                                               *00664000
                   :LASTAMT,                                           *00665000
                   :AMTYTD,                                            *00666000
                   :CMBBAL01,                                          *00667000
                   :CMBBAL02,                                          *00668000
                   :CMBBAL03,                                          *00669000
                   :CMBBAL04,                                          *00670000
                   :CMBBAL05,                                          *00671000
                   :CMBBAL06,                                          *00672000
                   :CMBBAL07,                                          *00673000
                   :CMBBAL08,                                          *00674000
                   :CMBBAL09,                                          *00675000
                   :CMBBAL10,                                          *00676000
                   :CMBBAL11,                                          *00677000
                   :CMBBAL12,                                          *00678000
                   :DATEOPN,                                           *00679000
                   :RAREA                                               00680000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00681000
         BALR  4,5                     MOVE INTO RECORD AREA            00682000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00683000
         BR    14                      RETURN TO CALLER                 00684000
         LTORG                                                          00685000
*                                                                       00686000
*                                                                       00687000
**********************************************************************  00688000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00689000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00690000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00691000
*     THE ACTUAL ROW.                                                   00692000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00693000
**********************************************************************  00694000
*                                                                       00695000
SQL#0010 DS    0H                                                       00696000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00697000
         LA    15,255                  SET RETURN CODE                  00698000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00699000
         BR    14                      RETURN TO CALLER                 00700000
         LTORG                                                          00701000
*                                                                       00702000
*                                                                       00703000
**********************************************************************  00704000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00705000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00706000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00707000
*     THE ACTUAL ROW.                                                   00708000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00709000
**********************************************************************  00710000
*                                                                       00711000
SQL#0011 DS    0H                                                       00712000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00713000
         LA    15,255                  SET RETURN CODE                  00714000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00715000
         BR    14                      RETURN TO CALLER                 00716000
         LTORG                                                          00717000
*                                                                       00718000
*                                                                       00719000
**********************************************************************  00720000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00721000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00722000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00723000
*     TO CLOSE THE UPDATE CURSOR.                                       00724000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00725000
**********************************************************************  00726000
*                                                                       00727000
SQL#0012 DS    0H                                                       00728000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00729000
         EXEC  SQL                                                     *00730000
               CLOSE SAKUPD0                                            00731000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00732000
         BR    14                      RETURN TO CALLER                 00733000
         LTORG                                                          00734000
*                                                                       00735000
*                                                                       00736000
**********************************************************************  00737000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00738000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00739000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00740000
*     TO CLOSE THE UPDATE CURSOR.                                       00741000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00742000
**********************************************************************  00743000
*                                                                       00744000
SQL#0013 DS    0H                                                       00745000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00746000
         EXEC  SQL                                                     *00747000
               CLOSE SAKUPD1                                            00748000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00749000
         BR    14                      RETURN TO CALLER                 00750000
         LTORG                                                          00751000
*                                                                       00752000
*                                                                       00753000
**********************************************************************  00754000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00755000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00756000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00757000
*     TO CLOSE THE UPDATE CURSOR.                                       00758000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00759000
**********************************************************************  00760000
*                                                                       00761000
SQL#0014 DS    0H                                                       00762000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00763000
         LA    15,255                  SET RETURN CODE                  00764000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00765000
         BR    14                      RETURN TO CALLER                 00766000
         LTORG                                                          00767000
*                                                                       00768000
*                                                                       00769000
**********************************************************************  00770000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00771000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00772000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00773000
*     TO CLOSE THE UPDATE CURSOR.                                       00774000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00775000
**********************************************************************  00776000
*                                                                       00777000
SQL#0015 DS    0H                                                       00778000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00779000
         LA    15,255                  SET RETURN CODE                  00780000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00781000
         BR    14                      RETURN TO CALLER                 00782000
         LTORG                                                          00783000
*                                                                       00784000
*                                                                       00785000
**********************************************************************  00786000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00787000
* KEY:                                                                  00788000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00789000
*     AND GET-NEXT-LOCK VERBS.                                          00790000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00791000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00792000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00793000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00794000
*     ORDER BY CLAUSE.                                                  00795000
**********************************************************************  00796000
*                                                                       00797000
SQL#0016 DS    0H                                                       00798000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00799000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00800000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00801000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00802000
         EXEC  SQL                                                     *00803000
               DECLARE SAKSQ001 CURSOR FOR                             *00804000
               SELECT ACCT_INST_1,                                     *00805000
                   PROD_CODE_1,                                        *00806000
                   ACCT_NBR_1,                                         *00807000
                   MODEL_1,                                            *00808000
                   ACCT_INST_2,                                        *00809000
                   PROD_CODE_2,                                        *00810000
                   ACCT_NBR_2,                                         *00811000
                   AUDIT_DATE,                                         *00812000
                   AUDIT_TIME,                                         *00813000
                   AUDIT_USER,                                         *00814000
                   AUDIT_ORG,                                          *00815000
                   IDENT_NBR,                                          *00816000
                   BAL_OPT,                                            *00817000
                   PCT_USED,                                           *00818000
                   LST_CMB_BAL_USE,                                    *00819000
                   FREQUENCY,                                          *00820000
                   TERM,                                               *00821000
                   DAY_MONTH,                                          *00822000
                   NEXT_DATE,                                          *00823000
                   LAST_DATE,                                          *00824000
                   AMOUNT,                                             *00825000
                   LAST_AMT,                                           *00826000
                   AMOUNT_YTD,                                         *00827000
                   MTH_CMB_BAL_01,                                     *00828000
                   MTH_CMB_BAL_02,                                     *00829000
                   MTH_CMB_BAL_03,                                     *00830000
                   MTH_CMB_BAL_04,                                     *00831000
                   MTH_CMB_BAL_05,                                     *00832000
                   MTH_CMB_BAL_06,                                     *00833000
                   MTH_CMB_BAL_07,                                     *00834000
                   MTH_CMB_BAL_08,                                     *00835000
                   MTH_CMB_BAL_09,                                     *00836000
                   MTH_CMB_BAL_10,                                     *00837000
                   MTH_CMB_BAL_11,                                     *00838000
                   MTH_CMB_BAL_12,                                     *00839000
                   DATE_OPEN,                                          *00840000
                   RSV_AREA                                            *00841000
                 FROM SAK                                              *00842000
                 WHERE                                                 *00843000
                    ACCT_INST_1 = :INST1 AND                           *00844000
                    PROD_CODE_1 = :PRDCDE1 AND                         *00845000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *00846000
                    MODEL_1 = :MODEL1 AND                              *00847000
                    ACCT_INST_2 = :INST2 AND                           *00848000
                    PROD_CODE_2 = :PRDCDE2 AND                         *00849000
                    ACCT_NBR_2 >= :ACCTNBR2                            *00850000
                 ORDER BY ACCT_NBR_2                                   *00851000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00852000
         EXEC  SQL                                                     *00853000
               OPEN SAKSQ001                                            00854000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00855000
         BR    14                      RETURN TO CALLER                 00856000
         LTORG                                                          00857000
*                                                                       00858000
*                                                                       00859000
**********************************************************************  00860000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00861000
* KEY 1:                                                                00862000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00863000
*     AND GET-NEXT-LOCK VERBS.                                          00864000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00865000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00866000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00867000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00868000
*     ORDER BY CLAUSE.                                                  00869000
**********************************************************************  00870000
*                                                                       00871000
SQL#0017 DS    0H                                                       00872000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00873000
         LA    3,X'40'                 LOAD MASK FOR KEY 1              00874000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00875000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00876000
         EXEC  SQL                                                     *00877000
               DECLARE SAKSQ101 CURSOR FOR                             *00878000
               SELECT ACCT_INST_1,                                     *00879000
                   PROD_CODE_1,                                        *00880000
                   ACCT_NBR_1,                                         *00881000
                   MODEL_1,                                            *00882000
                   ACCT_INST_2,                                        *00883000
                   PROD_CODE_2,                                        *00884000
                   ACCT_NBR_2,                                         *00885000
                   AUDIT_DATE,                                         *00886000
                   AUDIT_TIME,                                         *00887000
                   AUDIT_USER,                                         *00888000
                   AUDIT_ORG,                                          *00889000
                   IDENT_NBR,                                          *00890000
                   BAL_OPT,                                            *00891000
                   PCT_USED,                                           *00892000
                   LST_CMB_BAL_USE,                                    *00893000
                   FREQUENCY,                                          *00894000
                   TERM,                                               *00895000
                   DAY_MONTH,                                          *00896000
                   NEXT_DATE,                                          *00897000
                   LAST_DATE,                                          *00898000
                   AMOUNT,                                             *00899000
                   LAST_AMT,                                           *00900000
                   AMOUNT_YTD,                                         *00901000
                   MTH_CMB_BAL_01,                                     *00902000
                   MTH_CMB_BAL_02,                                     *00903000
                   MTH_CMB_BAL_03,                                     *00904000
                   MTH_CMB_BAL_04,                                     *00905000
                   MTH_CMB_BAL_05,                                     *00906000
                   MTH_CMB_BAL_06,                                     *00907000
                   MTH_CMB_BAL_07,                                     *00908000
                   MTH_CMB_BAL_08,                                     *00909000
                   MTH_CMB_BAL_09,                                     *00910000
                   MTH_CMB_BAL_10,                                     *00911000
                   MTH_CMB_BAL_11,                                     *00912000
                   MTH_CMB_BAL_12,                                     *00913000
                   DATE_OPEN,                                          *00914000
                   RSV_AREA                                            *00915000
                 FROM SAK                                              *00916000
                 WHERE                                                 *00917000
                    ACCT_INST_2 = :INST2 AND                           *00918000
                    PROD_CODE_2 = :PRDCDE2 AND                         *00919000
                    ACCT_NBR_2 >= :ACCTNBR2                            *00920000
                 ORDER BY ACCT_NBR_2                                   *00921000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00922000
         EXEC  SQL                                                     *00923000
               OPEN SAKSQ101                                            00924000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00925000
         BR    14                      RETURN TO CALLER                 00926000
         LTORG                                                          00927000
*                                                                       00928000
*                                                                       00929000
**********************************************************************  00930000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00931000
* KEY 2:                                                                00932000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00933000
*     AND GET-NEXT-LOCK VERBS.                                          00934000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00935000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00936000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00937000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00938000
*     ORDER BY CLAUSE.                                                  00939000
**********************************************************************  00940000
*                                                                       00941000
SQL#0018 DS    0H                                                       00942000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00943000
         LA    15,255                  SET RETURN CODE                  00944000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00945000
         BR    14                      RETURN TO CALLER                 00946000
         LTORG                                                          00947000
*                                                                       00948000
*                                                                       00949000
**********************************************************************  00950000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00951000
* KEY 3:                                                                00952000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00953000
*     AND GET-NEXT-LOCK VERBS.                                          00954000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00955000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00956000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00957000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00958000
*     ORDER BY CLAUSE.                                                  00959000
**********************************************************************  00960000
*                                                                       00961000
SQL#0019 DS    0H                                                       00962000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00963000
         LA    15,255                  SET RETURN CODE                  00964000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00965000
         BR    14                      RETURN TO CALLER                 00966000
         LTORG                                                          00967000
*                                                                       00968000
*                                                                       00969000
**********************************************************************  00970000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00971000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00972000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00973000
*     RETRIEVE THE ACTUAL ROW.                                          00974000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00975000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00976000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00977000
**********************************************************************  00978000
*                                                                       00979000
SQL#0020 DS    0H                                                       00980000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00981000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00982000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00983000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00984000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00985000
VECT0020 DC    A(SQL#0120)                                              00986000
         DC    A(SQL#0220)                                              00987000
         DC    A(SQL#0320)                                              00988000
         DC    A(SQL#0420)                                              00989000
         DC    A(SQL#0520)                                              00990000
         DC    A(SQL#0620)                                              00991000
         DC    A(SQL#0720)                                              00992000
         LTORG                                                          00993000
*                                                                       00994000
SQL#0120 DS    0H                                                       00995000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00996000
         EXEC  SQL                                                     *00997000
               FETCH SAKSQ001                                          *00998000
                 INTO :INST1,                                          *00999000
                      :PRDCDE1,                                        *01000000
                      :ACCTNBR1,                                       *01001000
                      :MODEL1,                                         *01002000
                      :INST2,                                          *01003000
                      :PRDCDE2,                                        *01004000
                      :ACCTNBR2,                                       *01005000
                      :AUDDATE,                                        *01006000
                      :AUDTIME,                                        *01007000
                      :AUDUSER,                                        *01008000
                      :AUDORG,                                         *01009000
                      :IDNBR,                                          *01010000
                      :BALOPT,                                         *01011000
                      :PCTUSED,                                        *01012000
                      :LCMBUSED,                                       *01013000
                      :FREQ,                                           *01014000
                      :TERM,                                           *01015000
                      :DAYMTH,                                         *01016000
                      :NEXTDATE,                                       *01017000
                      :LASTDATE,                                       *01018000
                      :AMT,                                            *01019000
                      :LASTAMT,                                        *01020000
                      :AMTYTD,                                         *01021000
                      :CMBBAL01,                                       *01022000
                      :CMBBAL02,                                       *01023000
                      :CMBBAL03,                                       *01024000
                      :CMBBAL04,                                       *01025000
                      :CMBBAL05,                                       *01026000
                      :CMBBAL06,                                       *01027000
                      :CMBBAL07,                                       *01028000
                      :CMBBAL08,                                       *01029000
                      :CMBBAL09,                                       *01030000
                      :CMBBAL10,                                       *01031000
                      :CMBBAL11,                                       *01032000
                      :CMBBAL12,                                       *01033000
                      :DATEOPN,                                        *01034000
                      :RAREA                                            01035000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01036000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01037000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01038000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01039000
         BR    12                      OPEN NEXT CURSOR                 01040000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01041000
         BALR  4,5                     MOVE INTO RECORD AREA            01042000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01043000
         BR    14                      RETURN TO CALLER                 01044000
         LTORG                                                          01045000
*                                                                       01046000
SQL#0220 DS    0H                                                       01047000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          01048000
         EXEC  SQL                                                     *01049000
               FETCH SAKSQ002                                          *01050000
                 INTO :INST1,                                          *01051000
                      :PRDCDE1,                                        *01052000
                      :ACCTNBR1,                                       *01053000
                      :MODEL1,                                         *01054000
                      :INST2,                                          *01055000
                      :PRDCDE2,                                        *01056000
                      :ACCTNBR2,                                       *01057000
                      :AUDDATE,                                        *01058000
                      :AUDTIME,                                        *01059000
                      :AUDUSER,                                        *01060000
                      :AUDORG,                                         *01061000
                      :IDNBR,                                          *01062000
                      :BALOPT,                                         *01063000
                      :PCTUSED,                                        *01064000
                      :LCMBUSED,                                       *01065000
                      :FREQ,                                           *01066000
                      :TERM,                                           *01067000
                      :DAYMTH,                                         *01068000
                      :NEXTDATE,                                       *01069000
                      :LASTDATE,                                       *01070000
                      :AMT,                                            *01071000
                      :LASTAMT,                                        *01072000
                      :AMTYTD,                                         *01073000
                      :CMBBAL01,                                       *01074000
                      :CMBBAL02,                                       *01075000
                      :CMBBAL03,                                       *01076000
                      :CMBBAL04,                                       *01077000
                      :CMBBAL05,                                       *01078000
                      :CMBBAL06,                                       *01079000
                      :CMBBAL07,                                       *01080000
                      :CMBBAL08,                                       *01081000
                      :CMBBAL09,                                       *01082000
                      :CMBBAL10,                                       *01083000
                      :CMBBAL11,                                       *01084000
                      :CMBBAL12,                                       *01085000
                      :DATEOPN,                                        *01086000
                      :RAREA                                            01087000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01088000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01089000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01090000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01091000
         BR    12                      OPEN NEXT CURSOR                 01092000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01093000
         BALR  4,5                     MOVE INTO RECORD AREA            01094000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01095000
         BR    14                      RETURN TO CALLER                 01096000
         LTORG                                                          01097000
*                                                                       01098000
SQL#0320 DS    0H                                                       01099000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          01100000
         EXEC  SQL                                                     *01101000
               FETCH SAKSQ003                                          *01102000
                 INTO :INST1,                                          *01103000
                      :PRDCDE1,                                        *01104000
                      :ACCTNBR1,                                       *01105000
                      :MODEL1,                                         *01106000
                      :INST2,                                          *01107000
                      :PRDCDE2,                                        *01108000
                      :ACCTNBR2,                                       *01109000
                      :AUDDATE,                                        *01110000
                      :AUDTIME,                                        *01111000
                      :AUDUSER,                                        *01112000
                      :AUDORG,                                         *01113000
                      :IDNBR,                                          *01114000
                      :BALOPT,                                         *01115000
                      :PCTUSED,                                        *01116000
                      :LCMBUSED,                                       *01117000
                      :FREQ,                                           *01118000
                      :TERM,                                           *01119000
                      :DAYMTH,                                         *01120000
                      :NEXTDATE,                                       *01121000
                      :LASTDATE,                                       *01122000
                      :AMT,                                            *01123000
                      :LASTAMT,                                        *01124000
                      :AMTYTD,                                         *01125000
                      :CMBBAL01,                                       *01126000
                      :CMBBAL02,                                       *01127000
                      :CMBBAL03,                                       *01128000
                      :CMBBAL04,                                       *01129000
                      :CMBBAL05,                                       *01130000
                      :CMBBAL06,                                       *01131000
                      :CMBBAL07,                                       *01132000
                      :CMBBAL08,                                       *01133000
                      :CMBBAL09,                                       *01134000
                      :CMBBAL10,                                       *01135000
                      :CMBBAL11,                                       *01136000
                      :CMBBAL12,                                       *01137000
                      :DATEOPN,                                        *01138000
                      :RAREA                                            01139000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01140000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01141000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01142000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01143000
         BR    12                      OPEN NEXT CURSOR                 01144000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01145000
         BALR  4,5                     MOVE INTO RECORD AREA            01146000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01147000
         BR    14                      RETURN TO CALLER                 01148000
         LTORG                                                          01149000
*                                                                       01150000
SQL#0420 DS    0H                                                       01151000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          01152000
         EXEC  SQL                                                     *01153000
               FETCH SAKSQ004                                          *01154000
                 INTO :INST1,                                          *01155000
                      :PRDCDE1,                                        *01156000
                      :ACCTNBR1,                                       *01157000
                      :MODEL1,                                         *01158000
                      :INST2,                                          *01159000
                      :PRDCDE2,                                        *01160000
                      :ACCTNBR2,                                       *01161000
                      :AUDDATE,                                        *01162000
                      :AUDTIME,                                        *01163000
                      :AUDUSER,                                        *01164000
                      :AUDORG,                                         *01165000
                      :IDNBR,                                          *01166000
                      :BALOPT,                                         *01167000
                      :PCTUSED,                                        *01168000
                      :LCMBUSED,                                       *01169000
                      :FREQ,                                           *01170000
                      :TERM,                                           *01171000
                      :DAYMTH,                                         *01172000
                      :NEXTDATE,                                       *01173000
                      :LASTDATE,                                       *01174000
                      :AMT,                                            *01175000
                      :LASTAMT,                                        *01176000
                      :AMTYTD,                                         *01177000
                      :CMBBAL01,                                       *01178000
                      :CMBBAL02,                                       *01179000
                      :CMBBAL03,                                       *01180000
                      :CMBBAL04,                                       *01181000
                      :CMBBAL05,                                       *01182000
                      :CMBBAL06,                                       *01183000
                      :CMBBAL07,                                       *01184000
                      :CMBBAL08,                                       *01185000
                      :CMBBAL09,                                       *01186000
                      :CMBBAL10,                                       *01187000
                      :CMBBAL11,                                       *01188000
                      :CMBBAL12,                                       *01189000
                      :DATEOPN,                                        *01190000
                      :RAREA                                            01191000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01192000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01193000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01194000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01195000
         BR    12                      OPEN NEXT CURSOR                 01196000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01197000
         BALR  4,5                     MOVE INTO RECORD AREA            01198000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01199000
         BR    14                      RETURN TO CALLER                 01200000
         LTORG                                                          01201000
*                                                                       01202000
SQL#0520 DS    0H                                                       01203000
         USING SQL#0520,12             ESTABLISH BASE REGISTER          01204000
         EXEC  SQL                                                     *01205000
               FETCH SAKSQ005                                          *01206000
                 INTO :INST1,                                          *01207000
                      :PRDCDE1,                                        *01208000
                      :ACCTNBR1,                                       *01209000
                      :MODEL1,                                         *01210000
                      :INST2,                                          *01211000
                      :PRDCDE2,                                        *01212000
                      :ACCTNBR2,                                       *01213000
                      :AUDDATE,                                        *01214000
                      :AUDTIME,                                        *01215000
                      :AUDUSER,                                        *01216000
                      :AUDORG,                                         *01217000
                      :IDNBR,                                          *01218000
                      :BALOPT,                                         *01219000
                      :PCTUSED,                                        *01220000
                      :LCMBUSED,                                       *01221000
                      :FREQ,                                           *01222000
                      :TERM,                                           *01223000
                      :DAYMTH,                                         *01224000
                      :NEXTDATE,                                       *01225000
                      :LASTDATE,                                       *01226000
                      :AMT,                                            *01227000
                      :LASTAMT,                                        *01228000
                      :AMTYTD,                                         *01229000
                      :CMBBAL01,                                       *01230000
                      :CMBBAL02,                                       *01231000
                      :CMBBAL03,                                       *01232000
                      :CMBBAL04,                                       *01233000
                      :CMBBAL05,                                       *01234000
                      :CMBBAL06,                                       *01235000
                      :CMBBAL07,                                       *01236000
                      :CMBBAL08,                                       *01237000
                      :CMBBAL09,                                       *01238000
                      :CMBBAL10,                                       *01239000
                      :CMBBAL11,                                       *01240000
                      :CMBBAL12,                                       *01241000
                      :DATEOPN,                                        *01242000
                      :RAREA                                            01243000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01244000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01245000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01246000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01247000
         BR    12                      OPEN NEXT CURSOR                 01248000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01249000
         BALR  4,5                     MOVE INTO RECORD AREA            01250000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01251000
         BR    14                      RETURN TO CALLER                 01252000
         LTORG                                                          01253000
*                                                                       01254000
SQL#0620 DS    0H                                                       01255000
         USING SQL#0620,12             ESTABLISH BASE REGISTER          01256000
         EXEC  SQL                                                     *01257000
               FETCH SAKSQ006                                          *01258000
                 INTO :INST1,                                          *01259000
                      :PRDCDE1,                                        *01260000
                      :ACCTNBR1,                                       *01261000
                      :MODEL1,                                         *01262000
                      :INST2,                                          *01263000
                      :PRDCDE2,                                        *01264000
                      :ACCTNBR2,                                       *01265000
                      :AUDDATE,                                        *01266000
                      :AUDTIME,                                        *01267000
                      :AUDUSER,                                        *01268000
                      :AUDORG,                                         *01269000
                      :IDNBR,                                          *01270000
                      :BALOPT,                                         *01271000
                      :PCTUSED,                                        *01272000
                      :LCMBUSED,                                       *01273000
                      :FREQ,                                           *01274000
                      :TERM,                                           *01275000
                      :DAYMTH,                                         *01276000
                      :NEXTDATE,                                       *01277000
                      :LASTDATE,                                       *01278000
                      :AMT,                                            *01279000
                      :LASTAMT,                                        *01280000
                      :AMTYTD,                                         *01281000
                      :CMBBAL01,                                       *01282000
                      :CMBBAL02,                                       *01283000
                      :CMBBAL03,                                       *01284000
                      :CMBBAL04,                                       *01285000
                      :CMBBAL05,                                       *01286000
                      :CMBBAL06,                                       *01287000
                      :CMBBAL07,                                       *01288000
                      :CMBBAL08,                                       *01289000
                      :CMBBAL09,                                       *01290000
                      :CMBBAL10,                                       *01291000
                      :CMBBAL11,                                       *01292000
                      :CMBBAL12,                                       *01293000
                      :DATEOPN,                                        *01294000
                      :RAREA                                            01295000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01296000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01297000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01298000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01299000
         BR    12                      OPEN NEXT CURSOR                 01300000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01301000
         BALR  4,5                     MOVE INTO RECORD AREA            01302000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01303000
         BR    14                      RETURN TO CALLER                 01304000
         LTORG                                                          01305000
*                                                                       01306000
SQL#0720 DS    0H                                                       01307000
         USING SQL#0720,12             ESTABLISH BASE REGISTER          01308000
         EXEC  SQL                                                     *01309000
               FETCH SAKSQ007                                          *01310000
                 INTO :INST1,                                          *01311000
                      :PRDCDE1,                                        *01312000
                      :ACCTNBR1,                                       *01313000
                      :MODEL1,                                         *01314000
                      :INST2,                                          *01315000
                      :PRDCDE2,                                        *01316000
                      :ACCTNBR2,                                       *01317000
                      :AUDDATE,                                        *01318000
                      :AUDTIME,                                        *01319000
                      :AUDUSER,                                        *01320000
                      :AUDORG,                                         *01321000
                      :IDNBR,                                          *01322000
                      :BALOPT,                                         *01323000
                      :PCTUSED,                                        *01324000
                      :LCMBUSED,                                       *01325000
                      :FREQ,                                           *01326000
                      :TERM,                                           *01327000
                      :DAYMTH,                                         *01328000
                      :NEXTDATE,                                       *01329000
                      :LASTDATE,                                       *01330000
                      :AMT,                                            *01331000
                      :LASTAMT,                                        *01332000
                      :AMTYTD,                                         *01333000
                      :CMBBAL01,                                       *01334000
                      :CMBBAL02,                                       *01335000
                      :CMBBAL03,                                       *01336000
                      :CMBBAL04,                                       *01337000
                      :CMBBAL05,                                       *01338000
                      :CMBBAL06,                                       *01339000
                      :CMBBAL07,                                       *01340000
                      :CMBBAL08,                                       *01341000
                      :CMBBAL09,                                       *01342000
                      :CMBBAL10,                                       *01343000
                      :CMBBAL11,                                       *01344000
                      :CMBBAL12,                                       *01345000
                      :DATEOPN,                                        *01346000
                      :RAREA                                            01347000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01348000
         BALR  4,5                     MOVE INTO RECORD AREA            01349000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01350000
         BR    14                      RETURN TO CALLER                 01351000
         LTORG                                                          01352000
*                                                                       01353000
*                                                                       01354000
**********************************************************************  01355000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01356000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01357000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01358000
*     RETRIEVE THE ACTUAL ROW.                                          01359000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01360000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01361000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01362000
**********************************************************************  01363000
*                                                                       01364000
SQL#0021 DS    0H                                                       01365000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01366000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01367000
         LA    12,VECT0021(1)          LOAD POINTER TO FETCH ROUTINE    01368000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01369000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01370000
VECT0021 DC    A(SQL#0121)                                              01371000
         DC    A(SQL#0221)                                              01372000
         DC    A(SQL#0321)                                              01373000
         LTORG                                                          01374000
*                                                                       01375000
SQL#0121 DS    0H                                                       01376000
         USING SQL#0121,12             ESTABLISH BASE REGISTER          01377000
         EXEC  SQL                                                     *01378000
               FETCH SAKSQ101                                          *01379000
                 INTO :INST1,                                          *01380000
                      :PRDCDE1,                                        *01381000
                      :ACCTNBR1,                                       *01382000
                      :MODEL1,                                         *01383000
                      :INST2,                                          *01384000
                      :PRDCDE2,                                        *01385000
                      :ACCTNBR2,                                       *01386000
                      :AUDDATE,                                        *01387000
                      :AUDTIME,                                        *01388000
                      :AUDUSER,                                        *01389000
                      :AUDORG,                                         *01390000
                      :IDNBR,                                          *01391000
                      :BALOPT,                                         *01392000
                      :PCTUSED,                                        *01393000
                      :LCMBUSED,                                       *01394000
                      :FREQ,                                           *01395000
                      :TERM,                                           *01396000
                      :DAYMTH,                                         *01397000
                      :NEXTDATE,                                       *01398000
                      :LASTDATE,                                       *01399000
                      :AMT,                                            *01400000
                      :LASTAMT,                                        *01401000
                      :AMTYTD,                                         *01402000
                      :CMBBAL01,                                       *01403000
                      :CMBBAL02,                                       *01404000
                      :CMBBAL03,                                       *01405000
                      :CMBBAL04,                                       *01406000
                      :CMBBAL05,                                       *01407000
                      :CMBBAL06,                                       *01408000
                      :CMBBAL07,                                       *01409000
                      :CMBBAL08,                                       *01410000
                      :CMBBAL09,                                       *01411000
                      :CMBBAL10,                                       *01412000
                      :CMBBAL11,                                       *01413000
                      :CMBBAL12,                                       *01414000
                      :DATEOPN,                                        *01415000
                      :RAREA                                            01416000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01417000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01418000
         L     9,=A(SQL#0021)          LOAD RETURN ROUTINE ADDRESS      01419000
         L     12,=A(SQL#0047)         LOAD CURSOR ROUTINE BASE REG     01420000
         BR    12                      OPEN NEXT CURSOR                 01421000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01422000
         BALR  4,5                     MOVE INTO RECORD AREA            01423000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01424000
         BR    14                      RETURN TO CALLER                 01425000
         LTORG                                                          01426000
*                                                                       01427000
SQL#0221 DS    0H                                                       01428000
         USING SQL#0221,12             ESTABLISH BASE REGISTER          01429000
         EXEC  SQL                                                     *01430000
               FETCH SAKSQ102                                          *01431000
                 INTO :INST1,                                          *01432000
                      :PRDCDE1,                                        *01433000
                      :ACCTNBR1,                                       *01434000
                      :MODEL1,                                         *01435000
                      :INST2,                                          *01436000
                      :PRDCDE2,                                        *01437000
                      :ACCTNBR2,                                       *01438000
                      :AUDDATE,                                        *01439000
                      :AUDTIME,                                        *01440000
                      :AUDUSER,                                        *01441000
                      :AUDORG,                                         *01442000
                      :IDNBR,                                          *01443000
                      :BALOPT,                                         *01444000
                      :PCTUSED,                                        *01445000
                      :LCMBUSED,                                       *01446000
                      :FREQ,                                           *01447000
                      :TERM,                                           *01448000
                      :DAYMTH,                                         *01449000
                      :NEXTDATE,                                       *01450000
                      :LASTDATE,                                       *01451000
                      :AMT,                                            *01452000
                      :LASTAMT,                                        *01453000
                      :AMTYTD,                                         *01454000
                      :CMBBAL01,                                       *01455000
                      :CMBBAL02,                                       *01456000
                      :CMBBAL03,                                       *01457000
                      :CMBBAL04,                                       *01458000
                      :CMBBAL05,                                       *01459000
                      :CMBBAL06,                                       *01460000
                      :CMBBAL07,                                       *01461000
                      :CMBBAL08,                                       *01462000
                      :CMBBAL09,                                       *01463000
                      :CMBBAL10,                                       *01464000
                      :CMBBAL11,                                       *01465000
                      :CMBBAL12,                                       *01466000
                      :DATEOPN,                                        *01467000
                      :RAREA                                            01468000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01469000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01470000
         L     9,=A(SQL#0021)          LOAD RETURN ROUTINE ADDRESS      01471000
         L     12,=A(SQL#0047)         LOAD CURSOR ROUTINE BASE REG     01472000
         BR    12                      OPEN NEXT CURSOR                 01473000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01474000
         BALR  4,5                     MOVE INTO RECORD AREA            01475000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01476000
         BR    14                      RETURN TO CALLER                 01477000
         LTORG                                                          01478000
*                                                                       01479000
SQL#0321 DS    0H                                                       01480000
         USING SQL#0321,12             ESTABLISH BASE REGISTER          01481000
         EXEC  SQL                                                     *01482000
               FETCH SAKSQ103                                          *01483000
                 INTO :INST1,                                          *01484000
                      :PRDCDE1,                                        *01485000
                      :ACCTNBR1,                                       *01486000
                      :MODEL1,                                         *01487000
                      :INST2,                                          *01488000
                      :PRDCDE2,                                        *01489000
                      :ACCTNBR2,                                       *01490000
                      :AUDDATE,                                        *01491000
                      :AUDTIME,                                        *01492000
                      :AUDUSER,                                        *01493000
                      :AUDORG,                                         *01494000
                      :IDNBR,                                          *01495000
                      :BALOPT,                                         *01496000
                      :PCTUSED,                                        *01497000
                      :LCMBUSED,                                       *01498000
                      :FREQ,                                           *01499000
                      :TERM,                                           *01500000
                      :DAYMTH,                                         *01501000
                      :NEXTDATE,                                       *01502000
                      :LASTDATE,                                       *01503000
                      :AMT,                                            *01504000
                      :LASTAMT,                                        *01505000
                      :AMTYTD,                                         *01506000
                      :CMBBAL01,                                       *01507000
                      :CMBBAL02,                                       *01508000
                      :CMBBAL03,                                       *01509000
                      :CMBBAL04,                                       *01510000
                      :CMBBAL05,                                       *01511000
                      :CMBBAL06,                                       *01512000
                      :CMBBAL07,                                       *01513000
                      :CMBBAL08,                                       *01514000
                      :CMBBAL09,                                       *01515000
                      :CMBBAL10,                                       *01516000
                      :CMBBAL11,                                       *01517000
                      :CMBBAL12,                                       *01518000
                      :DATEOPN,                                        *01519000
                      :RAREA                                            01520000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01521000
         BALR  4,5                     MOVE INTO RECORD AREA            01522000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01523000
         BR    14                      RETURN TO CALLER                 01524000
         LTORG                                                          01525000
*                                                                       01526000
*                                                                       01527000
**********************************************************************  01528000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01529000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01530000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01531000
*     RETRIEVE THE ACTUAL ROW.                                          01532000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01533000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01534000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01535000
**********************************************************************  01536000
*                                                                       01537000
SQL#0022 DS    0H                                                       01538000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01539000
         LA    15,255                  SET RETURN CODE                  01540000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01541000
         BR    14                      RETURN TO CALLER                 01542000
         LTORG                                                          01543000
*                                                                       01544000
*                                                                       01545000
**********************************************************************  01546000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01547000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01548000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01549000
*     RETRIEVE THE ACTUAL ROW.                                          01550000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01551000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01552000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01553000
**********************************************************************  01554000
*                                                                       01555000
SQL#0023 DS    0H                                                       01556000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01557000
         LA    15,255                  SET RETURN CODE                  01558000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01559000
         BR    14                      RETURN TO CALLER                 01560000
         LTORG                                                          01561000
*                                                                       01562000
*                                                                       01563000
**********************************************************************  01564000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01565000
* THE PRIMARY KEY:                                                      01566000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01567000
*     VERBS.                                                            01568000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01569000
*     RETRIEVE THE ACTUAL ROW.                                          01570000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01571000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01572000
*     WILL BE THRU THE UPDATE CURSOR.                                   01573000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01574000
**********************************************************************  01575000
*                                                                       01576000
SQL#0024 DS    0H                                                       01577000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01578000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01579000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01580000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01581000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01582000
VECT0024 DC    A(SQL#0124)                                              01583000
         DC    A(SQL#0224)                                              01584000
         DC    A(SQL#0324)                                              01585000
         DC    A(SQL#0424)                                              01586000
         DC    A(SQL#0524)                                              01587000
         DC    A(SQL#0624)                                              01588000
         DC    A(SQL#0724)                                              01589000
         LTORG                                                          01590000
*                                                                       01591000
SQL#0124 DS    0H                                                       01592000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01593000
         EXEC  SQL                                                     *01594000
               FETCH SAKSQ001                                          *01595000
                 INTO :INST1,                                          *01596000
                      :PRDCDE1,                                        *01597000
                      :ACCTNBR1,                                       *01598000
                      :MODEL1,                                         *01599000
                      :INST2,                                          *01600000
                      :PRDCDE2,                                        *01601000
                      :ACCTNBR2                                         01602000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01603000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01604000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01605000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01606000
         BR    12                      OPEN NEXT CURSOR                 01607000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01608000
         BALR  4,5                     MOVE INTO RECORD AREA            01609000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01610000
         BR    14                      RETURN TO CALLER                 01611000
         LTORG                                                          01612000
*                                                                       01613000
SQL#0224 DS    0H                                                       01614000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01615000
         EXEC  SQL                                                     *01616000
               FETCH SAKSQ002                                          *01617000
                 INTO :INST1,                                          *01618000
                      :PRDCDE1,                                        *01619000
                      :ACCTNBR1,                                       *01620000
                      :MODEL1,                                         *01621000
                      :INST2,                                          *01622000
                      :PRDCDE2,                                        *01623000
                      :ACCTNBR2                                         01624000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01625000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01626000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01627000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01628000
         BR    12                      OPEN NEXT CURSOR                 01629000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01630000
         BALR  4,5                     MOVE INTO RECORD AREA            01631000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01632000
         BR    14                      RETURN TO CALLER                 01633000
         LTORG                                                          01634000
*                                                                       01635000
SQL#0324 DS    0H                                                       01636000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01637000
         EXEC  SQL                                                     *01638000
               FETCH SAKSQ003                                          *01639000
                 INTO :INST1,                                          *01640000
                      :PRDCDE1,                                        *01641000
                      :ACCTNBR1,                                       *01642000
                      :MODEL1,                                         *01643000
                      :INST2,                                          *01644000
                      :PRDCDE2,                                        *01645000
                      :ACCTNBR2                                         01646000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01647000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01648000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01649000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01650000
         BR    12                      OPEN NEXT CURSOR                 01651000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01652000
         BALR  4,5                     MOVE INTO RECORD AREA            01653000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01654000
         BR    14                      RETURN TO CALLER                 01655000
         LTORG                                                          01656000
*                                                                       01657000
SQL#0424 DS    0H                                                       01658000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          01659000
         EXEC  SQL                                                     *01660000
               FETCH SAKSQ004                                          *01661000
                 INTO :INST1,                                          *01662000
                      :PRDCDE1,                                        *01663000
                      :ACCTNBR1,                                       *01664000
                      :MODEL1,                                         *01665000
                      :INST2,                                          *01666000
                      :PRDCDE2,                                        *01667000
                      :ACCTNBR2                                         01668000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01669000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01670000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01671000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01672000
         BR    12                      OPEN NEXT CURSOR                 01673000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01674000
         BALR  4,5                     MOVE INTO RECORD AREA            01675000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01676000
         BR    14                      RETURN TO CALLER                 01677000
         LTORG                                                          01678000
*                                                                       01679000
SQL#0524 DS    0H                                                       01680000
         USING SQL#0524,12             ESTABLISH BASE REGISTER          01681000
         EXEC  SQL                                                     *01682000
               FETCH SAKSQ005                                          *01683000
                 INTO :INST1,                                          *01684000
                      :PRDCDE1,                                        *01685000
                      :ACCTNBR1,                                       *01686000
                      :MODEL1,                                         *01687000
                      :INST2,                                          *01688000
                      :PRDCDE2,                                        *01689000
                      :ACCTNBR2                                         01690000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01691000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01692000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01693000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01694000
         BR    12                      OPEN NEXT CURSOR                 01695000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01696000
         BALR  4,5                     MOVE INTO RECORD AREA            01697000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01698000
         BR    14                      RETURN TO CALLER                 01699000
         LTORG                                                          01700000
*                                                                       01701000
SQL#0624 DS    0H                                                       01702000
         USING SQL#0624,12             ESTABLISH BASE REGISTER          01703000
         EXEC  SQL                                                     *01704000
               FETCH SAKSQ006                                          *01705000
                 INTO :INST1,                                          *01706000
                      :PRDCDE1,                                        *01707000
                      :ACCTNBR1,                                       *01708000
                      :MODEL1,                                         *01709000
                      :INST2,                                          *01710000
                      :PRDCDE2,                                        *01711000
                      :ACCTNBR2                                         01712000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01713000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01714000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01715000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01716000
         BR    12                      OPEN NEXT CURSOR                 01717000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01718000
         BALR  4,5                     MOVE INTO RECORD AREA            01719000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01720000
         BR    14                      RETURN TO CALLER                 01721000
         LTORG                                                          01722000
*                                                                       01723000
SQL#0724 DS    0H                                                       01724000
         USING SQL#0724,12             ESTABLISH BASE REGISTER          01725000
         EXEC  SQL                                                     *01726000
               FETCH SAKSQ007                                          *01727000
                 INTO :INST1,                                          *01728000
                      :PRDCDE1,                                        *01729000
                      :ACCTNBR1,                                       *01730000
                      :MODEL1,                                         *01731000
                      :INST2,                                          *01732000
                      :PRDCDE2,                                        *01733000
                      :ACCTNBR2                                         01734000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01735000
         BALR  4,5                     MOVE INTO RECORD AREA            01736000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01737000
         BR    14                      RETURN TO CALLER                 01738000
         LTORG                                                          01739000
*                                                                       01740000
*                                                                       01741000
**********************************************************************  01742000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01743000
* ALTERNATE KEY 1:                                                      01744000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01745000
*     VERBS.                                                            01746000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01747000
*     RETRIEVE THE ACTUAL ROW.                                          01748000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01749000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01750000
*     WILL BE THRU THE UPDATE CURSOR.                                   01751000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01752000
**********************************************************************  01753000
*                                                                       01754000
SQL#0025 DS    0H                                                       01755000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01756000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01757000
         LA    12,VECT0025(1)          LOAD POINTER TO FETCH ROUTINE    01758000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01759000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01760000
VECT0025 DC    A(SQL#0125)                                              01761000
         DC    A(SQL#0225)                                              01762000
         DC    A(SQL#0325)                                              01763000
         LTORG                                                          01764000
*                                                                       01765000
SQL#0125 DS    0H                                                       01766000
         USING SQL#0125,12             ESTABLISH BASE REGISTER          01767000
         EXEC  SQL                                                     *01768000
               FETCH SAKSQ101                                          *01769000
                 INTO :INST1,                                          *01770000
                      :PRDCDE1,                                        *01771000
                      :ACCTNBR1,                                       *01772000
                      :MODEL1,                                         *01773000
                      :INST2,                                          *01774000
                      :PRDCDE2,                                        *01775000
                      :ACCTNBR2                                         01776000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01777000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01778000
         L     9,=A(SQL#0025)          LOAD RETURN ROUTINE ADDRESS      01779000
         L     12,=A(SQL#0047)         LOAD CURSOR ROUTINE BASE REG     01780000
         BR    12                      OPEN NEXT CURSOR                 01781000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01782000
         BALR  4,5                     MOVE INTO RECORD AREA            01783000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01784000
         BR    14                      RETURN TO CALLER                 01785000
         LTORG                                                          01786000
*                                                                       01787000
SQL#0225 DS    0H                                                       01788000
         USING SQL#0225,12             ESTABLISH BASE REGISTER          01789000
         EXEC  SQL                                                     *01790000
               FETCH SAKSQ102                                          *01791000
                 INTO :INST1,                                          *01792000
                      :PRDCDE1,                                        *01793000
                      :ACCTNBR1,                                       *01794000
                      :MODEL1,                                         *01795000
                      :INST2,                                          *01796000
                      :PRDCDE2,                                        *01797000
                      :ACCTNBR2                                         01798000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01799000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01800000
         L     9,=A(SQL#0025)          LOAD RETURN ROUTINE ADDRESS      01801000
         L     12,=A(SQL#0047)         LOAD CURSOR ROUTINE BASE REG     01802000
         BR    12                      OPEN NEXT CURSOR                 01803000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01804000
         BALR  4,5                     MOVE INTO RECORD AREA            01805000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01806000
         BR    14                      RETURN TO CALLER                 01807000
         LTORG                                                          01808000
*                                                                       01809000
SQL#0325 DS    0H                                                       01810000
         USING SQL#0325,12             ESTABLISH BASE REGISTER          01811000
         EXEC  SQL                                                     *01812000
               FETCH SAKSQ103                                          *01813000
                 INTO :INST1,                                          *01814000
                      :PRDCDE1,                                        *01815000
                      :ACCTNBR1,                                       *01816000
                      :MODEL1,                                         *01817000
                      :INST2,                                          *01818000
                      :PRDCDE2,                                        *01819000
                      :ACCTNBR2                                         01820000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01821000
         BALR  4,5                     MOVE INTO RECORD AREA            01822000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01823000
         BR    14                      RETURN TO CALLER                 01824000
         LTORG                                                          01825000
*                                                                       01826000
*                                                                       01827000
**********************************************************************  01828000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01829000
* ALTERNATE KEY 2:                                                      01830000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01831000
*     VERBS.                                                            01832000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01833000
*     RETRIEVE THE ACTUAL ROW.                                          01834000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01835000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01836000
*     WILL BE THRU THE UPDATE CURSOR.                                   01837000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01838000
**********************************************************************  01839000
*                                                                       01840000
SQL#0026 DS    0H                                                       01841000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01842000
         LA    15,255                  SET RETURN CODE                  01843000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01844000
         BR    14                      RETURN TO CALLER                 01845000
         LTORG                                                          01846000
*                                                                       01847000
*                                                                       01848000
**********************************************************************  01849000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01850000
* ALTERNATE KEY 3:                                                      01851000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01852000
*     VERBS.                                                            01853000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01854000
*     RETRIEVE THE ACTUAL ROW.                                          01855000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01856000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01857000
*     WILL BE THRU THE UPDATE CURSOR.                                   01858000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01859000
**********************************************************************  01860000
*                                                                       01861000
SQL#0027 DS    0H                                                       01862000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01863000
         LA    15,255                  SET RETURN CODE                  01864000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01865000
         BR    14                      RETURN TO CALLER                 01866000
         LTORG                                                          01867000
*                                                                       01868000
*                                                                       01869000
**********************************************************************  01870000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01871000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01872000
*     AND GET-NEXT-LOCK VERBS.                                          01873000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01874000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01875000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01876000
**********************************************************************  01877000
*                                                                       01878000
SQL#0028 DS    0H                                                       01879000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01880000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01881000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01882000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01883000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01884000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01885000
VECT0028 DC    A(SQL#0128)                                              01886000
         DC    A(SQL#0228)                                              01887000
         DC    A(SQL#0328)                                              01888000
         DC    A(SQL#0428)                                              01889000
         DC    A(SQL#0528)                                              01890000
         DC    A(SQL#0628)                                              01891000
         DC    A(SQL#0728)                                              01892000
         LTORG                                                          01893000
*                                                                       01894000
SQL#0128 DS    0H                                                       01895000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01896000
         EXEC  SQL                                                     *01897000
               CLOSE SAKSQ001                                           01898000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01899000
         BR    14                      RETURN TO CALLER                 01900000
         LTORG                                                          01901000
*                                                                       01902000
SQL#0228 DS    0H                                                       01903000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01904000
         EXEC  SQL                                                     *01905000
               CLOSE SAKSQ002                                           01906000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01907000
         BR    14                      RETURN TO CALLER                 01908000
         LTORG                                                          01909000
*                                                                       01910000
SQL#0328 DS    0H                                                       01911000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01912000
         EXEC  SQL                                                     *01913000
               CLOSE SAKSQ003                                           01914000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01915000
         BR    14                      RETURN TO CALLER                 01916000
         LTORG                                                          01917000
*                                                                       01918000
SQL#0428 DS    0H                                                       01919000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01920000
         EXEC  SQL                                                     *01921000
               CLOSE SAKSQ004                                           01922000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01923000
         BR    14                      RETURN TO CALLER                 01924000
         LTORG                                                          01925000
*                                                                       01926000
SQL#0528 DS    0H                                                       01927000
         USING SQL#0528,12             ESTABLISH BASE REGISTER          01928000
         EXEC  SQL                                                     *01929000
               CLOSE SAKSQ005                                           01930000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01931000
         BR    14                      RETURN TO CALLER                 01932000
         LTORG                                                          01933000
*                                                                       01934000
SQL#0628 DS    0H                                                       01935000
         USING SQL#0628,12             ESTABLISH BASE REGISTER          01936000
         EXEC  SQL                                                     *01937000
               CLOSE SAKSQ006                                           01938000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01939000
         BR    14                      RETURN TO CALLER                 01940000
         LTORG                                                          01941000
*                                                                       01942000
SQL#0728 DS    0H                                                       01943000
         USING SQL#0728,12             ESTABLISH BASE REGISTER          01944000
         EXEC  SQL                                                     *01945000
               CLOSE SAKSQ007                                           01946000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01947000
         BR    14                      RETURN TO CALLER                 01948000
         LTORG                                                          01949000
*                                                                       01950000
*                                                                       01951000
**********************************************************************  01952000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01953000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01954000
*     AND GET-NEXT-LOCK VERBS.                                          01955000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01956000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01957000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01958000
**********************************************************************  01959000
*                                                                       01960000
SQL#0029 DS    0H                                                       01961000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01962000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01963000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01964000
         LA    12,VECT0029(1)          LOAD POINTER TO CLOSE ROUTINE    01965000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01966000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01967000
VECT0029 DC    A(SQL#0129)                                              01968000
         DC    A(SQL#0229)                                              01969000
         DC    A(SQL#0329)                                              01970000
         LTORG                                                          01971000
*                                                                       01972000
SQL#0129 DS    0H                                                       01973000
         USING SQL#0129,12             ESTABLISH BASE REGISTER          01974000
         EXEC  SQL                                                     *01975000
               CLOSE SAKSQ101                                           01976000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01977000
         BR    14                      RETURN TO CALLER                 01978000
         LTORG                                                          01979000
*                                                                       01980000
SQL#0229 DS    0H                                                       01981000
         USING SQL#0229,12             ESTABLISH BASE REGISTER          01982000
         EXEC  SQL                                                     *01983000
               CLOSE SAKSQ102                                           01984000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01985000
         BR    14                      RETURN TO CALLER                 01986000
         LTORG                                                          01987000
*                                                                       01988000
SQL#0329 DS    0H                                                       01989000
         USING SQL#0329,12             ESTABLISH BASE REGISTER          01990000
         EXEC  SQL                                                     *01991000
               CLOSE SAKSQ103                                           01992000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01993000
         BR    14                      RETURN TO CALLER                 01994000
         LTORG                                                          01995000
*                                                                       01996000
*                                                                       01997000
**********************************************************************  01998000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01999000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          02000000
*     AND GET-NEXT-LOCK VERBS.                                          02001000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      02002000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   02003000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02004000
**********************************************************************  02005000
*                                                                       02006000
SQL#0030 DS    0H                                                       02007000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          02008000
         LA    15,255                  SET RETURN CODE                  02009000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02010000
         BR    14                      RETURN TO CALLER                 02011000
         LTORG                                                          02012000
*                                                                       02013000
*                                                                       02014000
**********************************************************************  02015000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                02016000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          02017000
*     AND GET-NEXT-LOCK VERBS.                                          02018000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      02019000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   02020000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02021000
**********************************************************************  02022000
*                                                                       02023000
SQL#0031 DS    0H                                                       02024000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          02025000
         LA    15,255                  SET RETURN CODE                  02026000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02027000
         BR    14                      RETURN TO CALLER                 02028000
         LTORG                                                          02029000
*                                                                       02030000
*                                                                       02031000
**********************************************************************  02032000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  02033000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            02034000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02035000
**********************************************************************  02036000
*                                                                       02037000
SQL#0032 DS    0H                                                       02038000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          02039000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              02040000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02041000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02042000
         EXEC  SQL                                                     *02043000
               SELECT ACCT_INST_1,                                     *02044000
                   PROD_CODE_1,                                        *02045000
                   ACCT_NBR_1,                                         *02046000
                   MODEL_1,                                            *02047000
                   ACCT_INST_2,                                        *02048000
                   PROD_CODE_2,                                        *02049000
                   ACCT_NBR_2                                          *02050000
                 INTO :INST1,                                          *02051000
                   :PRDCDE1,                                           *02052000
                   :ACCTNBR1,                                          *02053000
                   :MODEL1,                                            *02054000
                   :INST2,                                             *02055000
                   :PRDCDE2,                                           *02056000
                   :ACCTNBR2                                           *02057000
                 FROM SAK                                              *02058000
                 WHERE ACCT_INST_1 = :INST1 AND                        *02059000
                   PROD_CODE_1 = :PRDCDE1 AND                          *02060000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *02061000
                   MODEL_1 = :MODEL1 AND                               *02062000
                   ACCT_INST_2 = :INST2 AND                            *02063000
                   PROD_CODE_2 = :PRDCDE2 AND                          *02064000
                   ACCT_NBR_2 = :ACCTNBR2                              *02065000
                 FETCH FIRST 1 ROW ONLY                                 02066000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02067000
         BR    14                      RETURN TO CALLER                 02068000
         LTORG                                                          02069000
*                                                                       02070000
*                                                                       02071000
**********************************************************************  02072000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              02073000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            02074000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02075000
**********************************************************************  02076000
*                                                                       02077000
SQL#0033 DS    0H                                                       02078000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          02079000
         LA    3,X'40'                 LOAD MASK FOR KEY 1              02080000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02081000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02082000
         EXEC  SQL                                                     *02083000
               SELECT ACCT_INST_1,                                     *02084000
                   PROD_CODE_1,                                        *02085000
                   ACCT_NBR_1,                                         *02086000
                   MODEL_1,                                            *02087000
                   ACCT_INST_2,                                        *02088000
                   PROD_CODE_2,                                        *02089000
                   ACCT_NBR_2                                          *02090000
                 INTO :INST1,                                          *02091000
                   :PRDCDE1,                                           *02092000
                   :ACCTNBR1,                                          *02093000
                   :MODEL1,                                            *02094000
                   :INST2,                                             *02095000
                   :PRDCDE2,                                           *02096000
                   :ACCTNBR2                                           *02097000
                 FROM SAK                                              *02098000
                 WHERE ACCT_INST_2 = :INST2 AND                        *02099000
                   PROD_CODE_2 = :PRDCDE2 AND                          *02100000
                   ACCT_NBR_2 = :ACCTNBR2                               02101000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   02102000
         BALR  4,5                     MOVE INTO RECORD AREA            02103000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02104000
         BR    14                      RETURN TO CALLER                 02105000
         LTORG                                                          02106000
*                                                                       02107000
*                                                                       02108000
**********************************************************************  02109000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              02110000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            02111000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02112000
**********************************************************************  02113000
*                                                                       02114000
SQL#0034 DS    0H                                                       02115000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          02116000
         LA    15,255                  SET RETURN CODE                  02117000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02118000
         BR    14                      RETURN TO CALLER                 02119000
         LTORG                                                          02120000
*                                                                       02121000
*                                                                       02122000
**********************************************************************  02123000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              02124000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            02125000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02126000
**********************************************************************  02127000
*                                                                       02128000
SQL#0035 DS    0H                                                       02129000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          02130000
         LA    15,255                  SET RETURN CODE                  02131000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02132000
         BR    14                      RETURN TO CALLER                 02133000
         LTORG                                                          02134000
*                                                                       02135000
*                                                                       02136000
**********************************************************************  02137000
* INSERT STATEMENT:                                                     02138000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               02139000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02140000
**********************************************************************  02141000
*                                                                       02142000
SQL#0036 DS    0H                                                       02143000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          02144000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    02145000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02146000
         EXEC  SQL                                                     *02147000
               INSERT INTO SAK                                         *02148000
                   (ACCT_INST_1,                                       *02149000
                    PROD_CODE_1,                                       *02150000
                    ACCT_NBR_1,                                        *02151000
                    MODEL_1,                                           *02152000
                    ACCT_INST_2,                                       *02153000
                    PROD_CODE_2,                                       *02154000
                    ACCT_NBR_2,                                        *02155000
                    AUDIT_DATE,                                        *02156000
                    AUDIT_TIME,                                        *02157000
                    AUDIT_USER,                                        *02158000
                    AUDIT_ORG,                                         *02159000
                    IDENT_NBR,                                         *02160000
                    BAL_OPT,                                           *02161000
                    PCT_USED,                                          *02162000
                    LST_CMB_BAL_USE,                                   *02163000
                    FREQUENCY,                                         *02164000
                    TERM,                                              *02165000
                    DAY_MONTH,                                         *02166000
                    NEXT_DATE,                                         *02167000
                    LAST_DATE,                                         *02168000
                    AMOUNT,                                            *02169000
                    LAST_AMT,                                          *02170000
                    AMOUNT_YTD,                                        *02171000
                    MTH_CMB_BAL_01,                                    *02172000
                    MTH_CMB_BAL_02,                                    *02173000
                    MTH_CMB_BAL_03,                                    *02174000
                    MTH_CMB_BAL_04,                                    *02175000
                    MTH_CMB_BAL_05,                                    *02176000
                    MTH_CMB_BAL_06,                                    *02177000
                    MTH_CMB_BAL_07,                                    *02178000
                    MTH_CMB_BAL_08,                                    *02179000
                    MTH_CMB_BAL_09,                                    *02180000
                    MTH_CMB_BAL_10,                                    *02181000
                    MTH_CMB_BAL_11,                                    *02182000
                    MTH_CMB_BAL_12,                                    *02183000
                    DATE_OPEN,                                         *02184000
                    RSV_AREA)                                          *02185000
                  VALUES (:INST1,                                      *02186000
                   :PRDCDE1,                                           *02187000
                   :ACCTNBR1,                                          *02188000
                   :MODEL1,                                            *02189000
                   :INST2,                                             *02190000
                   :PRDCDE2,                                           *02191000
                   :ACCTNBR2,                                          *02192000
                   :AUDDATE,                                           *02193000
                   :AUDTIME,                                           *02194000
                   :AUDUSER,                                           *02195000
                   :AUDORG,                                            *02196000
                   :IDNBR,                                             *02197000
                   :BALOPT,                                            *02198000
                   :PCTUSED,                                           *02199000
                   :LCMBUSED,                                          *02200000
                   :FREQ,                                              *02201000
                   :TERM,                                              *02202000
                   :DAYMTH,                                            *02203000
                   :NEXTDATE,                                          *02204000
                   :LASTDATE,                                          *02205000
                   :AMT,                                               *02206000
                   :LASTAMT,                                           *02207000
                   :AMTYTD,                                            *02208000
                   :CMBBAL01,                                          *02209000
                   :CMBBAL02,                                          *02210000
                   :CMBBAL03,                                          *02211000
                   :CMBBAL04,                                          *02212000
                   :CMBBAL05,                                          *02213000
                   :CMBBAL06,                                          *02214000
                   :CMBBAL07,                                          *02215000
                   :CMBBAL08,                                          *02216000
                   :CMBBAL09,                                          *02217000
                   :CMBBAL10,                                          *02218000
                   :CMBBAL11,                                          *02219000
                   :CMBBAL12,                                          *02220000
                   :DATEOPN,                                           *02221000
                   :RAREA)                                              02222000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02223000
         BR    14                      RETURN TO CALLER                 02224000
         LTORG                                                          02225000
*                                                                       02226000
*                                                                       02227000
**********************************************************************  02228000
* UPDATE STATEMENT BY PRIMARY KEY:                                      02229000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02230000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02231000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02232000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02233000
*     STATEMENT.                                                        02234000
**********************************************************************  02235000
*                                                                       02236000
SQL#0037 DS    0H                                                       02237000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          02238000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    02239000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02240000
         EXEC  SQL                                                     *02241000
               UPDATE SAK                                              *02242000
                   SET AUDIT_DATE = :AUDDATE,                          *02243000
                     AUDIT_TIME = :AUDTIME,                            *02244000
                     AUDIT_USER = :AUDUSER,                            *02245000
                     AUDIT_ORG = :AUDORG,                              *02246000
                     IDENT_NBR = :IDNBR,                               *02247000
                     BAL_OPT = :BALOPT,                                *02248000
                     PCT_USED = :PCTUSED,                              *02249000
                     LST_CMB_BAL_USE = :LCMBUSED,                      *02250000
                     FREQUENCY = :FREQ,                                *02251000
                     TERM = :TERM,                                     *02252000
                     DAY_MONTH = :DAYMTH,                              *02253000
                     NEXT_DATE = :NEXTDATE,                            *02254000
                     LAST_DATE = :LASTDATE,                            *02255000
                     AMOUNT = :AMT,                                    *02256000
                     LAST_AMT = :LASTAMT,                              *02257000
                     AMOUNT_YTD = :AMTYTD,                             *02258000
                     MTH_CMB_BAL_01 = :CMBBAL01,                       *02259000
                     MTH_CMB_BAL_02 = :CMBBAL02,                       *02260000
                     MTH_CMB_BAL_03 = :CMBBAL03,                       *02261000
                     MTH_CMB_BAL_04 = :CMBBAL04,                       *02262000
                     MTH_CMB_BAL_05 = :CMBBAL05,                       *02263000
                     MTH_CMB_BAL_06 = :CMBBAL06,                       *02264000
                     MTH_CMB_BAL_07 = :CMBBAL07,                       *02265000
                     MTH_CMB_BAL_08 = :CMBBAL08,                       *02266000
                     MTH_CMB_BAL_09 = :CMBBAL09,                       *02267000
                     MTH_CMB_BAL_10 = :CMBBAL10,                       *02268000
                     MTH_CMB_BAL_11 = :CMBBAL11,                       *02269000
                     MTH_CMB_BAL_12 = :CMBBAL12,                       *02270000
                     DATE_OPEN = :DATEOPN,                             *02271000
                     RSV_AREA = :RAREA                                 *02272000
                 WHERE CURRENT OF SAKUPD0                               02273000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02274000
         BR    14                      RETURN TO CALLER                 02275000
         LTORG                                                          02276000
*                                                                       02277000
*                                                                       02278000
**********************************************************************  02279000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  02280000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02281000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02282000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02283000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02284000
*     STATEMENT.                                                        02285000
**********************************************************************  02286000
*                                                                       02287000
SQL#0038 DS    0H                                                       02288000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          02289000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    02290000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02291000
         EXEC  SQL                                                     *02292000
               UPDATE SAK                                              *02293000
                   SET AUDIT_DATE = :AUDDATE,                          *02294000
                     AUDIT_TIME = :AUDTIME,                            *02295000
                     AUDIT_USER = :AUDUSER,                            *02296000
                     AUDIT_ORG = :AUDORG,                              *02297000
                     IDENT_NBR = :IDNBR,                               *02298000
                     BAL_OPT = :BALOPT,                                *02299000
                     PCT_USED = :PCTUSED,                              *02300000
                     LST_CMB_BAL_USE = :LCMBUSED,                      *02301000
                     FREQUENCY = :FREQ,                                *02302000
                     TERM = :TERM,                                     *02303000
                     DAY_MONTH = :DAYMTH,                              *02304000
                     NEXT_DATE = :NEXTDATE,                            *02305000
                     LAST_DATE = :LASTDATE,                            *02306000
                     AMOUNT = :AMT,                                    *02307000
                     LAST_AMT = :LASTAMT,                              *02308000
                     AMOUNT_YTD = :AMTYTD,                             *02309000
                     MTH_CMB_BAL_01 = :CMBBAL01,                       *02310000
                     MTH_CMB_BAL_02 = :CMBBAL02,                       *02311000
                     MTH_CMB_BAL_03 = :CMBBAL03,                       *02312000
                     MTH_CMB_BAL_04 = :CMBBAL04,                       *02313000
                     MTH_CMB_BAL_05 = :CMBBAL05,                       *02314000
                     MTH_CMB_BAL_06 = :CMBBAL06,                       *02315000
                     MTH_CMB_BAL_07 = :CMBBAL07,                       *02316000
                     MTH_CMB_BAL_08 = :CMBBAL08,                       *02317000
                     MTH_CMB_BAL_09 = :CMBBAL09,                       *02318000
                     MTH_CMB_BAL_10 = :CMBBAL10,                       *02319000
                     MTH_CMB_BAL_11 = :CMBBAL11,                       *02320000
                     MTH_CMB_BAL_12 = :CMBBAL12,                       *02321000
                     DATE_OPEN = :DATEOPN,                             *02322000
                     RSV_AREA = :RAREA                                 *02323000
                 WHERE CURRENT OF SAKUPD1                               02324000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02325000
         BR    14                      RETURN TO CALLER                 02326000
         LTORG                                                          02327000
*                                                                       02328000
*                                                                       02329000
**********************************************************************  02330000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  02331000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02332000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02333000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02334000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02335000
*     STATEMENT.                                                        02336000
**********************************************************************  02337000
*                                                                       02338000
SQL#0039 DS    0H                                                       02339000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          02340000
         LA    15,255                  SET RETURN CODE                  02341000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02342000
         BR    14                      RETURN TO CALLER                 02343000
         LTORG                                                          02344000
*                                                                       02345000
*                                                                       02346000
**********************************************************************  02347000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  02348000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02349000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02350000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02351000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02352000
*     STATEMENT.                                                        02353000
**********************************************************************  02354000
*                                                                       02355000
SQL#0040 DS    0H                                                       02356000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          02357000
         LA    15,255                  SET RETURN CODE                  02358000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02359000
         BR    14                      RETURN TO CALLER                 02360000
         LTORG                                                          02361000
*                                                                       02362000
*                                                                       02363000
**********************************************************************  02364000
* DELETE STATEMENT BY PRIMARY KEY:                                      02365000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02366000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02367000
**********************************************************************  02368000
*                                                                       02369000
SQL#0041 DS    0H                                                       02370000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          02371000
         EXEC  SQL                                                     *02372000
               DELETE FROM SAK                                         *02373000
                 WHERE CURRENT OF SAKUPD0                               02374000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02375000
         BR    14                      RETURN TO CALLER                 02376000
         LTORG                                                          02377000
*                                                                       02378000
*                                                                       02379000
**********************************************************************  02380000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  02381000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02382000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02383000
**********************************************************************  02384000
*                                                                       02385000
SQL#0042 DS    0H                                                       02386000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          02387000
         EXEC  SQL                                                     *02388000
               DELETE FROM SAK                                         *02389000
                 WHERE CURRENT OF SAKUPD1                               02390000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02391000
         BR    14                      RETURN TO CALLER                 02392000
         LTORG                                                          02393000
*                                                                       02394000
*                                                                       02395000
**********************************************************************  02396000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  02397000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02398000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02399000
**********************************************************************  02400000
*                                                                       02401000
SQL#0043 DS    0H                                                       02402000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          02403000
         LA    15,255                  SET RETURN CODE                  02404000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02405000
         BR    14                      RETURN TO CALLER                 02406000
         LTORG                                                          02407000
*                                                                       02408000
*                                                                       02409000
**********************************************************************  02410000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  02411000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02412000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02413000
**********************************************************************  02414000
*                                                                       02415000
SQL#0044 DS    0H                                                       02416000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          02417000
         LA    15,255                  SET RETURN CODE                  02418000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02419000
         BR    14                      RETURN TO CALLER                 02420000
         LTORG                                                          02421000
*                                                                       02422000
*                                                                       02423000
**********************************************************************  02424000
* DELETE ALL STATEMENT:                                                 02425000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       02426000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02427000
**********************************************************************  02428000
*                                                                       02429000
SQL#0045 DS    0H                                                       02430000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          02431000
         EXEC  SQL                                                     *02432000
               DELETE FROM SAK                                          02433000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02434000
         BR    14                      RETURN TO CALLER                 02435000
         LTORG                                                          02436000
*                                                                       02437000
*                                                                       02438000
**********************************************************************  02439000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          02440000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                02441000
**********************************************************************  02442000
*                                                                       02443000
SQL#0046 DS    0H                                                       02444000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          02445000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              02446000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02447000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02448000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      02449000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         02450000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               02451000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      02452000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      02453000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     02454000
VECT0046 DC    A(0)                                                     02455000
         DC    A(SQL#0246)                                              02456000
         DC    A(SQL#0346)                                              02457000
         DC    A(SQL#0446)                                              02458000
         DC    A(SQL#0546)                                              02459000
         DC    A(SQL#0646)                                              02460000
         DC    A(SQL#0746)                                              02461000
         LTORG                                                          02462000
*                                                                       02463000
SQL#0246 DS    0H                                                       02464000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          02465000
         EXEC  SQL                                                     *02466000
               CLOSE SAKSQ001                                           02467000
         EXEC  SQL                                                     *02468000
               DECLARE SAKSQ002 CURSOR FOR                             *02469000
               SELECT ACCT_INST_1,                                     *02470000
                   PROD_CODE_1,                                        *02471000
                   ACCT_NBR_1,                                         *02472000
                   MODEL_1,                                            *02473000
                   ACCT_INST_2,                                        *02474000
                   PROD_CODE_2,                                        *02475000
                   ACCT_NBR_2,                                         *02476000
                   AUDIT_DATE,                                         *02477000
                   AUDIT_TIME,                                         *02478000
                   AUDIT_USER,                                         *02479000
                   AUDIT_ORG,                                          *02480000
                   IDENT_NBR,                                          *02481000
                   BAL_OPT,                                            *02482000
                   PCT_USED,                                           *02483000
                   LST_CMB_BAL_USE,                                    *02484000
                   FREQUENCY,                                          *02485000
                   TERM,                                               *02486000
                   DAY_MONTH,                                          *02487000
                   NEXT_DATE,                                          *02488000
                   LAST_DATE,                                          *02489000
                   AMOUNT,                                             *02490000
                   LAST_AMT,                                           *02491000
                   AMOUNT_YTD,                                         *02492000
                   MTH_CMB_BAL_01,                                     *02493000
                   MTH_CMB_BAL_02,                                     *02494000
                   MTH_CMB_BAL_03,                                     *02495000
                   MTH_CMB_BAL_04,                                     *02496000
                   MTH_CMB_BAL_05,                                     *02497000
                   MTH_CMB_BAL_06,                                     *02498000
                   MTH_CMB_BAL_07,                                     *02499000
                   MTH_CMB_BAL_08,                                     *02500000
                   MTH_CMB_BAL_09,                                     *02501000
                   MTH_CMB_BAL_10,                                     *02502000
                   MTH_CMB_BAL_11,                                     *02503000
                   MTH_CMB_BAL_12,                                     *02504000
                   DATE_OPEN,                                          *02505000
                   RSV_AREA                                            *02506000
                 FROM SAK                                              *02507000
                 WHERE                                                 *02508000
                    ACCT_INST_1 = :INST1 AND                           *02509000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02510000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02511000
                    MODEL_1 = :MODEL1 AND                              *02512000
                    ACCT_INST_2 = :INST2 AND                           *02513000
                    PROD_CODE_2 > :PRDCDE2                             *02514000
                 ORDER BY PROD_CODE_2,                                 *02515000
                   ACCT_NBR_2                                          *02516000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02517000
         EXEC  SQL                                                     *02518000
               OPEN SAKSQ002                                            02519000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02520000
         BNZ   *+8                     NO - RETURN ERROR                02521000
         LR    12,9                    LOAD RETURN ADDRESS              02522000
         BR    12                      RETURN TO FETCH ROUTINE          02523000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02524000
         BR    14                      RETURN TO CALLER                 02525000
         LTORG                                                          02526000
*                                                                       02527000
SQL#0346 DS    0H                                                       02528000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          02529000
         EXEC  SQL                                                     *02530000
               CLOSE SAKSQ002                                           02531000
         EXEC  SQL                                                     *02532000
               DECLARE SAKSQ003 CURSOR FOR                             *02533000
               SELECT ACCT_INST_1,                                     *02534000
                   PROD_CODE_1,                                        *02535000
                   ACCT_NBR_1,                                         *02536000
                   MODEL_1,                                            *02537000
                   ACCT_INST_2,                                        *02538000
                   PROD_CODE_2,                                        *02539000
                   ACCT_NBR_2,                                         *02540000
                   AUDIT_DATE,                                         *02541000
                   AUDIT_TIME,                                         *02542000
                   AUDIT_USER,                                         *02543000
                   AUDIT_ORG,                                          *02544000
                   IDENT_NBR,                                          *02545000
                   BAL_OPT,                                            *02546000
                   PCT_USED,                                           *02547000
                   LST_CMB_BAL_USE,                                    *02548000
                   FREQUENCY,                                          *02549000
                   TERM,                                               *02550000
                   DAY_MONTH,                                          *02551000
                   NEXT_DATE,                                          *02552000
                   LAST_DATE,                                          *02553000
                   AMOUNT,                                             *02554000
                   LAST_AMT,                                           *02555000
                   AMOUNT_YTD,                                         *02556000
                   MTH_CMB_BAL_01,                                     *02557000
                   MTH_CMB_BAL_02,                                     *02558000
                   MTH_CMB_BAL_03,                                     *02559000
                   MTH_CMB_BAL_04,                                     *02560000
                   MTH_CMB_BAL_05,                                     *02561000
                   MTH_CMB_BAL_06,                                     *02562000
                   MTH_CMB_BAL_07,                                     *02563000
                   MTH_CMB_BAL_08,                                     *02564000
                   MTH_CMB_BAL_09,                                     *02565000
                   MTH_CMB_BAL_10,                                     *02566000
                   MTH_CMB_BAL_11,                                     *02567000
                   MTH_CMB_BAL_12,                                     *02568000
                   DATE_OPEN,                                          *02569000
                   RSV_AREA                                            *02570000
                 FROM SAK                                              *02571000
                 WHERE                                                 *02572000
                    ACCT_INST_1 = :INST1 AND                           *02573000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02574000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02575000
                    MODEL_1 = :MODEL1 AND                              *02576000
                    ACCT_INST_2 > :INST2                               *02577000
                 ORDER BY ACCT_INST_2,                                 *02578000
                   PROD_CODE_2,                                        *02579000
                   ACCT_NBR_2                                          *02580000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02581000
         EXEC  SQL                                                     *02582000
               OPEN SAKSQ003                                            02583000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02584000
         BNZ   *+8                     NO - RETURN ERROR                02585000
         LR    12,9                    LOAD RETURN ADDRESS              02586000
         BR    12                      RETURN TO FETCH ROUTINE          02587000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02588000
         BR    14                      RETURN TO CALLER                 02589000
         LTORG                                                          02590000
*                                                                       02591000
SQL#0446 DS    0H                                                       02592000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          02593000
         EXEC  SQL                                                     *02594000
               CLOSE SAKSQ003                                           02595000
         EXEC  SQL                                                     *02596000
               DECLARE SAKSQ004 CURSOR FOR                             *02597000
               SELECT ACCT_INST_1,                                     *02598000
                   PROD_CODE_1,                                        *02599000
                   ACCT_NBR_1,                                         *02600000
                   MODEL_1,                                            *02601000
                   ACCT_INST_2,                                        *02602000
                   PROD_CODE_2,                                        *02603000
                   ACCT_NBR_2,                                         *02604000
                   AUDIT_DATE,                                         *02605000
                   AUDIT_TIME,                                         *02606000
                   AUDIT_USER,                                         *02607000
                   AUDIT_ORG,                                          *02608000
                   IDENT_NBR,                                          *02609000
                   BAL_OPT,                                            *02610000
                   PCT_USED,                                           *02611000
                   LST_CMB_BAL_USE,                                    *02612000
                   FREQUENCY,                                          *02613000
                   TERM,                                               *02614000
                   DAY_MONTH,                                          *02615000
                   NEXT_DATE,                                          *02616000
                   LAST_DATE,                                          *02617000
                   AMOUNT,                                             *02618000
                   LAST_AMT,                                           *02619000
                   AMOUNT_YTD,                                         *02620000
                   MTH_CMB_BAL_01,                                     *02621000
                   MTH_CMB_BAL_02,                                     *02622000
                   MTH_CMB_BAL_03,                                     *02623000
                   MTH_CMB_BAL_04,                                     *02624000
                   MTH_CMB_BAL_05,                                     *02625000
                   MTH_CMB_BAL_06,                                     *02626000
                   MTH_CMB_BAL_07,                                     *02627000
                   MTH_CMB_BAL_08,                                     *02628000
                   MTH_CMB_BAL_09,                                     *02629000
                   MTH_CMB_BAL_10,                                     *02630000
                   MTH_CMB_BAL_11,                                     *02631000
                   MTH_CMB_BAL_12,                                     *02632000
                   DATE_OPEN,                                          *02633000
                   RSV_AREA                                            *02634000
                 FROM SAK                                              *02635000
                 WHERE                                                 *02636000
                    ACCT_INST_1 = :INST1 AND                           *02637000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02638000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02639000
                    MODEL_1 > :MODEL1                                  *02640000
                 ORDER BY MODEL_1,                                     *02641000
                   ACCT_INST_2,                                        *02642000
                   PROD_CODE_2,                                        *02643000
                   ACCT_NBR_2                                          *02644000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02645000
         EXEC  SQL                                                     *02646000
               OPEN SAKSQ004                                            02647000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02648000
         BNZ   *+8                     NO - RETURN ERROR                02649000
         LR    12,9                    LOAD RETURN ADDRESS              02650000
         BR    12                      RETURN TO FETCH ROUTINE          02651000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02652000
         BR    14                      RETURN TO CALLER                 02653000
         LTORG                                                          02654000
*                                                                       02655000
SQL#0546 DS    0H                                                       02656000
         USING SQL#0546,12             ESTABLISH BASE REGISTER          02657000
         EXEC  SQL                                                     *02658000
               CLOSE SAKSQ004                                           02659000
         EXEC  SQL                                                     *02660000
               DECLARE SAKSQ005 CURSOR FOR                             *02661000
               SELECT ACCT_INST_1,                                     *02662000
                   PROD_CODE_1,                                        *02663000
                   ACCT_NBR_1,                                         *02664000
                   MODEL_1,                                            *02665000
                   ACCT_INST_2,                                        *02666000
                   PROD_CODE_2,                                        *02667000
                   ACCT_NBR_2,                                         *02668000
                   AUDIT_DATE,                                         *02669000
                   AUDIT_TIME,                                         *02670000
                   AUDIT_USER,                                         *02671000
                   AUDIT_ORG,                                          *02672000
                   IDENT_NBR,                                          *02673000
                   BAL_OPT,                                            *02674000
                   PCT_USED,                                           *02675000
                   LST_CMB_BAL_USE,                                    *02676000
                   FREQUENCY,                                          *02677000
                   TERM,                                               *02678000
                   DAY_MONTH,                                          *02679000
                   NEXT_DATE,                                          *02680000
                   LAST_DATE,                                          *02681000
                   AMOUNT,                                             *02682000
                   LAST_AMT,                                           *02683000
                   AMOUNT_YTD,                                         *02684000
                   MTH_CMB_BAL_01,                                     *02685000
                   MTH_CMB_BAL_02,                                     *02686000
                   MTH_CMB_BAL_03,                                     *02687000
                   MTH_CMB_BAL_04,                                     *02688000
                   MTH_CMB_BAL_05,                                     *02689000
                   MTH_CMB_BAL_06,                                     *02690000
                   MTH_CMB_BAL_07,                                     *02691000
                   MTH_CMB_BAL_08,                                     *02692000
                   MTH_CMB_BAL_09,                                     *02693000
                   MTH_CMB_BAL_10,                                     *02694000
                   MTH_CMB_BAL_11,                                     *02695000
                   MTH_CMB_BAL_12,                                     *02696000
                   DATE_OPEN,                                          *02697000
                   RSV_AREA                                            *02698000
                 FROM SAK                                              *02699000
                 WHERE                                                 *02700000
                    ACCT_INST_1 = :INST1 AND                           *02701000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02702000
                    ACCT_NBR_1 > :ACCTNBR1                             *02703000
                 ORDER BY ACCT_NBR_1,                                  *02704000
                   MODEL_1,                                            *02705000
                   ACCT_INST_2,                                        *02706000
                   PROD_CODE_2,                                        *02707000
                   ACCT_NBR_2                                          *02708000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02709000
         EXEC  SQL                                                     *02710000
               OPEN SAKSQ005                                            02711000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02712000
         BNZ   *+8                     NO - RETURN ERROR                02713000
         LR    12,9                    LOAD RETURN ADDRESS              02714000
         BR    12                      RETURN TO FETCH ROUTINE          02715000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02716000
         BR    14                      RETURN TO CALLER                 02717000
         LTORG                                                          02718000
*                                                                       02719000
SQL#0646 DS    0H                                                       02720000
         USING SQL#0646,12             ESTABLISH BASE REGISTER          02721000
         EXEC  SQL                                                     *02722000
               CLOSE SAKSQ005                                           02723000
         EXEC  SQL                                                     *02724000
               DECLARE SAKSQ006 CURSOR FOR                             *02725000
               SELECT ACCT_INST_1,                                     *02726000
                   PROD_CODE_1,                                        *02727000
                   ACCT_NBR_1,                                         *02728000
                   MODEL_1,                                            *02729000
                   ACCT_INST_2,                                        *02730000
                   PROD_CODE_2,                                        *02731000
                   ACCT_NBR_2,                                         *02732000
                   AUDIT_DATE,                                         *02733000
                   AUDIT_TIME,                                         *02734000
                   AUDIT_USER,                                         *02735000
                   AUDIT_ORG,                                          *02736000
                   IDENT_NBR,                                          *02737000
                   BAL_OPT,                                            *02738000
                   PCT_USED,                                           *02739000
                   LST_CMB_BAL_USE,                                    *02740000
                   FREQUENCY,                                          *02741000
                   TERM,                                               *02742000
                   DAY_MONTH,                                          *02743000
                   NEXT_DATE,                                          *02744000
                   LAST_DATE,                                          *02745000
                   AMOUNT,                                             *02746000
                   LAST_AMT,                                           *02747000
                   AMOUNT_YTD,                                         *02748000
                   MTH_CMB_BAL_01,                                     *02749000
                   MTH_CMB_BAL_02,                                     *02750000
                   MTH_CMB_BAL_03,                                     *02751000
                   MTH_CMB_BAL_04,                                     *02752000
                   MTH_CMB_BAL_05,                                     *02753000
                   MTH_CMB_BAL_06,                                     *02754000
                   MTH_CMB_BAL_07,                                     *02755000
                   MTH_CMB_BAL_08,                                     *02756000
                   MTH_CMB_BAL_09,                                     *02757000
                   MTH_CMB_BAL_10,                                     *02758000
                   MTH_CMB_BAL_11,                                     *02759000
                   MTH_CMB_BAL_12,                                     *02760000
                   DATE_OPEN,                                          *02761000
                   RSV_AREA                                            *02762000
                 FROM SAK                                              *02763000
                 WHERE                                                 *02764000
                    ACCT_INST_1 = :INST1 AND                           *02765000
                    PROD_CODE_1 > :PRDCDE1                             *02766000
                 ORDER BY PROD_CODE_1,                                 *02767000
                   ACCT_NBR_1,                                         *02768000
                   MODEL_1,                                            *02769000
                   ACCT_INST_2,                                        *02770000
                   PROD_CODE_2,                                        *02771000
                   ACCT_NBR_2                                          *02772000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02773000
         EXEC  SQL                                                     *02774000
               OPEN SAKSQ006                                            02775000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02776000
         BNZ   *+8                     NO - RETURN ERROR                02777000
         LR    12,9                    LOAD RETURN ADDRESS              02778000
         BR    12                      RETURN TO FETCH ROUTINE          02779000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02780000
         BR    14                      RETURN TO CALLER                 02781000
         LTORG                                                          02782000
*                                                                       02783000
SQL#0746 DS    0H                                                       02784000
         USING SQL#0746,12             ESTABLISH BASE REGISTER          02785000
         EXEC  SQL                                                     *02786000
               CLOSE SAKSQ006                                           02787000
         EXEC  SQL                                                     *02788000
               DECLARE SAKSQ007 CURSOR FOR                             *02789000
               SELECT ACCT_INST_1,                                     *02790000
                   PROD_CODE_1,                                        *02791000
                   ACCT_NBR_1,                                         *02792000
                   MODEL_1,                                            *02793000
                   ACCT_INST_2,                                        *02794000
                   PROD_CODE_2,                                        *02795000
                   ACCT_NBR_2,                                         *02796000
                   AUDIT_DATE,                                         *02797000
                   AUDIT_TIME,                                         *02798000
                   AUDIT_USER,                                         *02799000
                   AUDIT_ORG,                                          *02800000
                   IDENT_NBR,                                          *02801000
                   BAL_OPT,                                            *02802000
                   PCT_USED,                                           *02803000
                   LST_CMB_BAL_USE,                                    *02804000
                   FREQUENCY,                                          *02805000
                   TERM,                                               *02806000
                   DAY_MONTH,                                          *02807000
                   NEXT_DATE,                                          *02808000
                   LAST_DATE,                                          *02809000
                   AMOUNT,                                             *02810000
                   LAST_AMT,                                           *02811000
                   AMOUNT_YTD,                                         *02812000
                   MTH_CMB_BAL_01,                                     *02813000
                   MTH_CMB_BAL_02,                                     *02814000
                   MTH_CMB_BAL_03,                                     *02815000
                   MTH_CMB_BAL_04,                                     *02816000
                   MTH_CMB_BAL_05,                                     *02817000
                   MTH_CMB_BAL_06,                                     *02818000
                   MTH_CMB_BAL_07,                                     *02819000
                   MTH_CMB_BAL_08,                                     *02820000
                   MTH_CMB_BAL_09,                                     *02821000
                   MTH_CMB_BAL_10,                                     *02822000
                   MTH_CMB_BAL_11,                                     *02823000
                   MTH_CMB_BAL_12,                                     *02824000
                   DATE_OPEN,                                          *02825000
                   RSV_AREA                                            *02826000
                 FROM SAK                                              *02827000
                 WHERE                                                 *02828000
                    ACCT_INST_1 > :INST1                               *02829000
                 ORDER BY ACCT_INST_1,                                 *02830000
                   PROD_CODE_1,                                        *02831000
                   ACCT_NBR_1,                                         *02832000
                   MODEL_1,                                            *02833000
                   ACCT_INST_2,                                        *02834000
                   PROD_CODE_2,                                        *02835000
                   ACCT_NBR_2                                          *02836000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02837000
         EXEC  SQL                                                     *02838000
               OPEN SAKSQ007                                            02839000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02840000
         BNZ   *+8                     NO - RETURN ERROR                02841000
         LR    12,9                    LOAD RETURN ADDRESS              02842000
         BR    12                      RETURN TO FETCH ROUTINE          02843000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02844000
         BR    14                      RETURN TO CALLER                 02845000
         LTORG                                                          02846000
*                                                                       02847000
*                                                                       02848000
**********************************************************************  02849000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02850000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02851000
**********************************************************************  02852000
*                                                                       02853000
SQL#0047 DS    0H                                                       02854000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02855000
         LA    3,X'40'                 LOAD MASK FOR KEY 1              02856000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02857000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02858000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      02859000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         02860000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               02861000
         LA    12,VECT0047(1)          LOAD POINTER TO NEXT CURSOR      02862000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      02863000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     02864000
VECT0047 DC    A(0)                                                     02865000
         DC    A(SQL#0247)                                              02866000
         DC    A(SQL#0347)                                              02867000
         LTORG                                                          02868000
*                                                                       02869000
SQL#0247 DS    0H                                                       02870000
         USING SQL#0247,12             ESTABLISH BASE REGISTER          02871000
         EXEC  SQL                                                     *02872000
               CLOSE SAKSQ101                                           02873000
         EXEC  SQL                                                     *02874000
               DECLARE SAKSQ102 CURSOR FOR                             *02875000
               SELECT ACCT_INST_1,                                     *02876000
                   PROD_CODE_1,                                        *02877000
                   ACCT_NBR_1,                                         *02878000
                   MODEL_1,                                            *02879000
                   ACCT_INST_2,                                        *02880000
                   PROD_CODE_2,                                        *02881000
                   ACCT_NBR_2,                                         *02882000
                   AUDIT_DATE,                                         *02883000
                   AUDIT_TIME,                                         *02884000
                   AUDIT_USER,                                         *02885000
                   AUDIT_ORG,                                          *02886000
                   IDENT_NBR,                                          *02887000
                   BAL_OPT,                                            *02888000
                   PCT_USED,                                           *02889000
                   LST_CMB_BAL_USE,                                    *02890000
                   FREQUENCY,                                          *02891000
                   TERM,                                               *02892000
                   DAY_MONTH,                                          *02893000
                   NEXT_DATE,                                          *02894000
                   LAST_DATE,                                          *02895000
                   AMOUNT,                                             *02896000
                   LAST_AMT,                                           *02897000
                   AMOUNT_YTD,                                         *02898000
                   MTH_CMB_BAL_01,                                     *02899000
                   MTH_CMB_BAL_02,                                     *02900000
                   MTH_CMB_BAL_03,                                     *02901000
                   MTH_CMB_BAL_04,                                     *02902000
                   MTH_CMB_BAL_05,                                     *02903000
                   MTH_CMB_BAL_06,                                     *02904000
                   MTH_CMB_BAL_07,                                     *02905000
                   MTH_CMB_BAL_08,                                     *02906000
                   MTH_CMB_BAL_09,                                     *02907000
                   MTH_CMB_BAL_10,                                     *02908000
                   MTH_CMB_BAL_11,                                     *02909000
                   MTH_CMB_BAL_12,                                     *02910000
                   DATE_OPEN,                                          *02911000
                   RSV_AREA                                            *02912000
                 FROM SAK                                              *02913000
                 WHERE                                                 *02914000
                    ACCT_INST_2 = :INST2 AND                           *02915000
                    PROD_CODE_2 > :PRDCDE2                             *02916000
                 ORDER BY PROD_CODE_2,                                 *02917000
                   ACCT_NBR_2                                          *02918000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02919000
         EXEC  SQL                                                     *02920000
               OPEN SAKSQ102                                            02921000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02922000
         BNZ   *+8                     NO - RETURN ERROR                02923000
         LR    12,9                    LOAD RETURN ADDRESS              02924000
         BR    12                      RETURN TO FETCH ROUTINE          02925000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02926000
         BR    14                      RETURN TO CALLER                 02927000
         LTORG                                                          02928000
*                                                                       02929000
SQL#0347 DS    0H                                                       02930000
         USING SQL#0347,12             ESTABLISH BASE REGISTER          02931000
         EXEC  SQL                                                     *02932000
               CLOSE SAKSQ102                                           02933000
         EXEC  SQL                                                     *02934000
               DECLARE SAKSQ103 CURSOR FOR                             *02935000
               SELECT ACCT_INST_1,                                     *02936000
                   PROD_CODE_1,                                        *02937000
                   ACCT_NBR_1,                                         *02938000
                   MODEL_1,                                            *02939000
                   ACCT_INST_2,                                        *02940000
                   PROD_CODE_2,                                        *02941000
                   ACCT_NBR_2,                                         *02942000
                   AUDIT_DATE,                                         *02943000
                   AUDIT_TIME,                                         *02944000
                   AUDIT_USER,                                         *02945000
                   AUDIT_ORG,                                          *02946000
                   IDENT_NBR,                                          *02947000
                   BAL_OPT,                                            *02948000
                   PCT_USED,                                           *02949000
                   LST_CMB_BAL_USE,                                    *02950000
                   FREQUENCY,                                          *02951000
                   TERM,                                               *02952000
                   DAY_MONTH,                                          *02953000
                   NEXT_DATE,                                          *02954000
                   LAST_DATE,                                          *02955000
                   AMOUNT,                                             *02956000
                   LAST_AMT,                                           *02957000
                   AMOUNT_YTD,                                         *02958000
                   MTH_CMB_BAL_01,                                     *02959000
                   MTH_CMB_BAL_02,                                     *02960000
                   MTH_CMB_BAL_03,                                     *02961000
                   MTH_CMB_BAL_04,                                     *02962000
                   MTH_CMB_BAL_05,                                     *02963000
                   MTH_CMB_BAL_06,                                     *02964000
                   MTH_CMB_BAL_07,                                     *02965000
                   MTH_CMB_BAL_08,                                     *02966000
                   MTH_CMB_BAL_09,                                     *02967000
                   MTH_CMB_BAL_10,                                     *02968000
                   MTH_CMB_BAL_11,                                     *02969000
                   MTH_CMB_BAL_12,                                     *02970000
                   DATE_OPEN,                                          *02971000
                   RSV_AREA                                            *02972000
                 FROM SAK                                              *02973000
                 WHERE                                                 *02974000
                    ACCT_INST_2 > :INST2                               *02975000
                 ORDER BY ACCT_INST_2,                                 *02976000
                   PROD_CODE_2,                                        *02977000
                   ACCT_NBR_2                                          *02978000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02979000
         EXEC  SQL                                                     *02980000
               OPEN SAKSQ103                                            02981000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02982000
         BNZ   *+8                     NO - RETURN ERROR                02983000
         LR    12,9                    LOAD RETURN ADDRESS              02984000
         BR    12                      RETURN TO FETCH ROUTINE          02985000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02986000
         BR    14                      RETURN TO CALLER                 02987000
         LTORG                                                          02988000
*                                                                       02989000
*                                                                       02990000
**********************************************************************  02991000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02992000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02993000
**********************************************************************  02994000
*                                                                       02995000
SQL#0048 DS    0H                                                       02996000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02997000
         LA    15,255                  SET RETURN CODE                  02998000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02999000
         BR    14                      RETURN TO CALLER                 03000000
         LTORG                                                          03001000
*                                                                       03002000
*                                                                       03003000
**********************************************************************  03004000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      03005000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            03006000
**********************************************************************  03007000
*                                                                       03008000
SQL#0049 DS    0H                                                       03009000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          03010000
         LA    15,255                  SET RETURN CODE                  03011000
         L     14,SQW@RET              LOAD RETURN ADDRESS              03012000
         BR    14                      RETURN TO CALLER                 03013000
         LTORG                                                          03014000
*                                                                       03015000
         DS    0H                      END OF SQL STATEMENTS            03016000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   03017000
*                                                                       03018000
*                                                                       03019000
**********************************************************************  03020000
* DUMMY ENTRY POINT DSNHLI                                              03021000
*   MUST NOT BE MODIFIED.                                               03022000
**********************************************************************  03023000
*                                                                       03024000
         ENTRY DSNHLI                                                   03025000
DSNHLI   DS    0H                                                       03026000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       03027000
         BR    15                      BRANCH TO ATTACH FACILITY        03028000
*                                                                       03029000
*                                                                       03030000
**********************************************************************  03031000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          03032000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              03033000
*   MUST NOT BE MODIFIED.                                               03034000
**********************************************************************  03035000
*                                                                       03036000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      03037000
CONV#RTN AMODE ANY                                                      03038000
CONV#RTN RMODE ANY                                                      03039000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         03040000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          03041000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    03042000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    03043000
         BER   4                         YES - RETURN TO SQL            03044000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         03045000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    03046000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  03047000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 03048000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              03049000
         LR    15,1                    SET BOTH LENGTHS EQUAL           03050000
         MVCL  14,0                    MOVE TO HOST VARIABLES           03051000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          03052000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          03053000
*                                                                       03054000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    03055000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          03056000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    03057000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    03058000
         BER   4                         YES - RETURN TO SQL            03059000
         SLR   0,0                     CLEAR FOR INSERT                 03060000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           03061000
         NR    0,3                     FOR THE CURRENT KEY?             03062000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         03063000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         03064000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    03065000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  03066000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 03067000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              03068000
         LR    15,1                    SET BOTH LENGTHS EQUAL           03069000
         MVCL  14,0                    MOVE TO HOST VARIABLES           03070000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            03071000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         03072000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           03073000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 03074000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        03075000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 03076000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        03077000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            03078000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          03079000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          03080000
*                                                                       03081000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  03082000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          03083000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    03084000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    03085000
         BER   4                         YES - RETURN TO SQL            03086000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         03087000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    03088000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  03089000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 03090000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              03091000
         LR    15,1                    SET BOTH LENGTHS EQUAL           03092000
         MVCL  0,14                    MOVE TO RECORD AREA              03093000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          03094000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          03095000
*                                                                       03096000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            03097000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          03098000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    03099000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    03100000
         BER   4                         YES - RETURN TO SQL            03101000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             03102000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         03103000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         03104000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    03105000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  03106000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 03107000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              03108000
         LR    15,1                    SET BOTH LENGTHS EQUAL           03109000
         MVCL  0,14                    MOVE TO RECORD AREA              03110000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          03111000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          03112000
*                                                                       03113000
*                                                                       03114000
**********************************************************************  03115000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  03116000
*   MUST NOT BE MODIFIED.                                               03117000
**********************************************************************  03118000
*                                                                       03119000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         03120000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        03121000
         DC    H'0038'                 LENGTH TO MOVE                   03122000
         DC    X'80'                   80 = KEY 0 FIELD                 03123000
*                                      40 = KEY 1 FIELD                 03124000
*                                      20 = KEY 2 FIELD                 03125000
*                                      10 = KEY 3 FIELD                 03126000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        03127000
*                                                                       03128000
*                                      REST OF FIELD ENTRIES            03129000
         DC    H'0038',H'0038',H'0028',X'C0',X'00'                      03130000
         DC    H'0066',H'0066',H'0237',X'00',X'00'                      03131000
         DC    8X'FF'                  END OF FIELD ENTRIES             03132000
         LTORG                                                          03133000
         END                                                            03134000
