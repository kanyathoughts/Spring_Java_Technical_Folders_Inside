**********************************************************************  00001000
*                                                                       00002000
*  S09RDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S09 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
SVCTABLE DS    CL6                                                      00052000
AUDDATE  DS    PL5'0.'                                                  00053000
AUDTIME  DS    PL5'0.'                                                  00054000
AUDUSER  DS    CL8                                                      00055000
AUDORG   DS    CL6                                                      00056000
BALOPT   DS    CL1                                                      00057000
AMTREQ1  DS    PL6'0.00'                                                00058000
DISCPCT1 DS    PL3'0.00000'                                             00059000
DISCAMT1 DS    PL3'0.00'                                                00060000
AMTREQ2  DS    PL6'0.00'                                                00061000
DISCPCT2 DS    PL3'0.00000'                                             00062000
DISCAMT2 DS    PL3'0.00'                                                00063000
AMTREQ3  DS    PL6'0.00'                                                00064000
DISCPCT3 DS    PL3'0.00000'                                             00065000
DISCAMT3 DS    PL3'0.00'                                                00066000
AMTREQ4  DS    PL6'0.00'                                                00067000
DISCPCT4 DS    PL3'0.00000'                                             00068000
DISCAMT4 DS    PL3'0.00'                                                00069000
AMTREQ5  DS    PL6'0.00'                                                00070000
DISCPCT5 DS    PL3'0.00000'                                             00071000
DISCAMT5 DS    PL3'0.00'                                                00072000
AMTREQ6  DS    PL6'0.00'                                                00073000
DISCPCT6 DS    PL3'0.00000'                                             00074000
DISCAMT6 DS    PL3'0.00'                                                00075000
AMTREQ7  DS    PL6'0.00'                                                00076000
DISCPCT7 DS    PL3'0.00000'                                             00077000
DISCAMT7 DS    PL3'0.00'                                                00078000
AMTREQ8  DS    PL6'0.00'                                                00079000
DISCPCT8 DS    PL3'0.00000'                                             00080000
DISCAMT8 DS    PL3'0.00'                                                00081000
AMTREQ9  DS    PL6'0.00'                                                00082000
DISCPCT9 DS    PL3'0.00000'                                             00083000
DISCAMT9 DS    PL3'0.00'                                                00084000
AMTREQ10 DS    PL6'0.00'                                                00085000
RATEPT10 DS    PL3'0.00000'                                             00086000
DISCAM10 DS    PL3'0.00'                                                00087000
*                                                                       00088000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00089000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00090000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00091000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00092000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00093000
         DS    CL97                    RESERVED                         00094000
*                                                                       00095000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00096000
INDVARX  DS    0H                                                       00097000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00098000
*                                                                       00099000
*                                                                       00100000
**********************************************************************  00101000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00102000
**********************************************************************  00103000
*                                                                       00104000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00105000
*                                                                       00106000
**********************************************************************  00107000
* PROGRAM TABLE HEADER SECTION:                                         00108000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00109000
**********************************************************************  00110000
*                                                                       00111000
S09RDB   CSECT                         PROGRAM TABLE SECTION            00112000
S09RDB   AMODE ANY                                                      00113000
S09RDB   RMODE ANY                                                      00114000
         DC    CL8'S09RDB  '           PROGRAM ID                       00115000
         DC    CL1' '                                                   00116000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00117000
         DC    CL1' '                                                   00118000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00119000
         DC    CL1' '                                                   00120000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00121000
         DC    5A(0)                   RESERVED                         00122000
         DC    AL2(0)                  RESERVED                         00123000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00124000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00125000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00126000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00127000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00128000
         DC    CL29'WWW.INFOR.COM                '                      00128001
*                                                                       00129000
**********************************************************************  00130000
* STATEMENT TABLE SECTION:                                              00131000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00132000
**********************************************************************  00133000
*                                                                       00134000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00135000
STM#TAB  AMODE ANY                                                      00136000
STM#TAB  RMODE ANY                                                      00137000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00138000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00139000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00140000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00141000
         DC    12A(0)                  UDB MODULE VECTORS               00142000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00143000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00144000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00145000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00146000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00147000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00148000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00149000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00150000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00151000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00152000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00153000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00154000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00155000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00156000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00157000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00158000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00159000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00160000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00161000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00162000
         DC    10A(0)                  UDB MODULE VECTORS               00163000
         DC    4X'FF'                                                   00164000
*                                                                       00165000
**********************************************************************  00166000
* SQL STATEMENT SECTION:                                                00167000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00168000
*     TO SUPPORT THIS TABLE.                                            00169000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00170000
*     ARE EQUIVALENT.                                                   00171000
**********************************************************************  00172000
*                                                                       00173000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00174000
SQL#STMT AMODE ANY                                                      00175000
SQL#STMT RMODE ANY                                                      00176000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00177000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00178000
         USING COM#AREA,11             ADDRESS COMMAREA                 00179000
*                                                                       00180000
**********************************************************************  00181000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00182000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00183000
**********************************************************************  00184000
*                                                                       00185000
SELIN0   DS    0H                                                       00186000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00187000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00188000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00189000
         BALR  14,15                   MOVE REQUESTED DATA              00190000
         EXEC  SQL SELECT                                              *00191000
                   AUDIT_DATE,                                         *00192000
                   AUDIT_TIME,                                         *00193000
                   AUDIT_USER,                                         *00194000
                   AUDIT_ORG,                                          *00195000
                   BAL_OPT,                                            *00196000
                   AMOUNT_REQ_01,                                      *00197000
                   DISC_PCT_1,                                         *00198000
                   DISC_AMT_1,                                         *00199000
                   AMOUNT_REQ_02,                                      *00200000
                   DISC_PCT_2,                                         *00201000
                   DISC_AMT_2,                                         *00202000
                   AMOUNT_REQ_03,                                      *00203000
                   DISC_PCT_3,                                         *00204000
                   DISC_AMT_3,                                         *00205000
                   AMOUNT_REQ_04,                                      *00206000
                   DISC_PCT_4,                                         *00207000
                   DISC_AMT_4,                                         *00208000
                   AMOUNT_REQ_05,                                      *00209000
                   DISC_PCT_5,                                         *00210000
                   DISC_AMT_5,                                         *00211000
                   AMOUNT_REQ_06,                                      *00212000
                   DISC_PCT_6,                                         *00213000
                   DISC_AMT_6,                                         *00214000
                   AMOUNT_REQ_07,                                      *00215000
                   DISC_PCT_7,                                         *00216000
                   DISC_AMT_7,                                         *00217000
                   AMOUNT_REQ_08,                                      *00218000
                   DISC_PCT_8,                                         *00219000
                   DISC_AMT_8,                                         *00220000
                   AMOUNT_REQ_09,                                      *00221000
                   DISC_PCT_9,                                         *00222000
                   DISC_AMT_9,                                         *00223000
                   AMOUNT_REQ_10,                                      *00224000
                   DISC_PCT_10,                                        *00225000
                   DISC_AMT_10                                         *00226000
                 INTO                                                  *00227000
                   :AUDDATE,                                           *00228000
                   :AUDTIME,                                           *00229000
                   :AUDUSER,                                           *00230000
                   :AUDORG,                                            *00231000
                   :BALOPT,                                            *00232000
                   :AMTREQ1,                                           *00233000
                   :DISCPCT1,                                          *00234000
                   :DISCAMT1,                                          *00235000
                   :AMTREQ2,                                           *00236000
                   :DISCPCT2,                                          *00237000
                   :DISCAMT2,                                          *00238000
                   :AMTREQ3,                                           *00239000
                   :DISCPCT3,                                          *00240000
                   :DISCAMT3,                                          *00241000
                   :AMTREQ4,                                           *00242000
                   :DISCPCT4,                                          *00243000
                   :DISCAMT4,                                          *00244000
                   :AMTREQ5,                                           *00245000
                   :DISCPCT5,                                          *00246000
                   :DISCAMT5,                                          *00247000
                   :AMTREQ6,                                           *00248000
                   :DISCPCT6,                                          *00249000
                   :DISCAMT6,                                          *00250000
                   :AMTREQ7,                                           *00251000
                   :DISCPCT7,                                          *00252000
                   :DISCAMT7,                                          *00253000
                   :AMTREQ8,                                           *00254000
                   :DISCPCT8,                                          *00255000
                   :DISCAMT8,                                          *00256000
                   :AMTREQ9,                                           *00257000
                   :DISCPCT9,                                          *00258000
                   :DISCAMT9,                                          *00259000
                   :AMTREQ10,                                          *00260000
                   :RATEPT10,                                          *00261000
                   :DISCAM10                                           *00262000
                 FROM S09                                              *00263000
                 WHERE                                                 *00264000
                   INST_NBR = :INST AND                                *00265000
                   RECORD_NBR = :RECNBR AND                            *00266000
                   SVC_CHG_TABLE = :SVCTABLE                           *00267000
                 FETCH FIRST 1 ROW ONLY                                 00268000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00269000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00270000
         BALR  14,15                   MOVE REQUESTED DATA              00271000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00272000
         BR    14                      RETURN TO CALLER                 00273000
         LTORG                                                          00274000
*                                                                       00275000
**********************************************************************  00276000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00277000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00278000
**********************************************************************  00279000
*                                                                       00280000
SELKY0   DS    0H                                                       00281000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00282000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00283000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00284000
         BALR  14,15                   MOVE REQUESTED DATA              00285000
         EXEC  SQL SELECT                                              *00286000
                   COUNT(*)                                            *00287000
                 INTO                                                  *00288000
                   :SQWINTHV                                           *00289000
                 FROM S09                                              *00290000
                 WHERE                                                 *00291000
                   INST_NBR = :INST AND                                *00292000
                   RECORD_NBR = :RECNBR AND                            *00293000
                   SVC_CHG_TABLE = :SVCTABLE                           *00294000
                 FETCH FIRST 1 ROW ONLY                                 00295000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00296000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00297000
         BNER  14                      NO - RETURN TO CALLER            00298000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00299000
         BNER  14                      YES - RETURN ZERO SQLCODE        00300000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00301000
         BR    14                      RETURN TO CALLER                 00302000
         LTORG                                                          00303000
*                                                                       00304000
**********************************************************************  00305000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00306000
* KEY:                                                                  00307000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00308000
*     AND GET-NEXT-LOCK VERBS.                                          00309000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00310000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00311000
**********************************************************************  00312000
*                                                                       00313000
SELXC0   DS    0H                                                       00314000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00315000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00316000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00317000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00318000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00319000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00320000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00321000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00322000
SELXC0P  DC    A(SELGE001)                                              00323000
         DC    (KY0COLMS-01)A(0)                                        00324000
         DC    A(SELGE002)                                              00325000
         DC    (KY0COLMS-02)A(0)                                        00326000
         DC    A(SELGE003)                                              00327000
         LTORG                                                          00328000
*                                                                       00329000
SELGE001 DS    0H                                                       00330000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00331000
         EXEC  SQL DECLARE S09GE001 CURSOR                             *00332000
               WITH ROWSET POSITIONING                                 *00333000
               FOR SELECT                                              *00334000
                   INST_NBR,                                           *00335000
                   RECORD_NBR,                                         *00336000
                   SVC_CHG_TABLE,                                      *00337000
                   AUDIT_DATE,                                         *00338000
                   AUDIT_TIME,                                         *00339000
                   AUDIT_USER,                                         *00340000
                   AUDIT_ORG,                                          *00341000
                   BAL_OPT,                                            *00342000
                   AMOUNT_REQ_01,                                      *00343000
                   DISC_PCT_1,                                         *00344000
                   DISC_AMT_1,                                         *00345000
                   AMOUNT_REQ_02,                                      *00346000
                   DISC_PCT_2,                                         *00347000
                   DISC_AMT_2,                                         *00348000
                   AMOUNT_REQ_03,                                      *00349000
                   DISC_PCT_3,                                         *00350000
                   DISC_AMT_3,                                         *00351000
                   AMOUNT_REQ_04,                                      *00352000
                   DISC_PCT_4,                                         *00353000
                   DISC_AMT_4,                                         *00354000
                   AMOUNT_REQ_05,                                      *00355000
                   DISC_PCT_5,                                         *00356000
                   DISC_AMT_5,                                         *00357000
                   AMOUNT_REQ_06,                                      *00358000
                   DISC_PCT_6,                                         *00359000
                   DISC_AMT_6,                                         *00360000
                   AMOUNT_REQ_07,                                      *00361000
                   DISC_PCT_7,                                         *00362000
                   DISC_AMT_7,                                         *00363000
                   AMOUNT_REQ_08,                                      *00364000
                   DISC_PCT_8,                                         *00365000
                   DISC_AMT_8,                                         *00366000
                   AMOUNT_REQ_09,                                      *00367000
                   DISC_PCT_9,                                         *00368000
                   DISC_AMT_9,                                         *00369000
                   AMOUNT_REQ_10,                                      *00370000
                   DISC_PCT_10,                                        *00371000
                   DISC_AMT_10                                         *00372000
                 FROM S09                                              *00373000
                 WHERE                                                 *00374000
                   INST_NBR = :INST AND                                *00375000
                   RECORD_NBR = :RECNBR AND                            *00376000
                   SVC_CHG_TABLE >=                                    *00377000
                     :SVCTABLE                                         *00378000
                 ORDER BY SVC_CHG_TABLE ASC                            *00379000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00380000
         EXEC  SQL OPEN S09GE001                                        00381000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00382000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00383000
         BR    14                      RETURN TO CALLER                 00384000
         LTORG                                                          00385000
*                                                                       00386000
SELGE002 DS    0H                                                       00387000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00388000
         EXEC  SQL DECLARE S09GE002 CURSOR                             *00389000
               WITH ROWSET POSITIONING                                 *00390000
               FOR SELECT                                              *00391000
                   INST_NBR,                                           *00392000
                   RECORD_NBR,                                         *00393000
                   SVC_CHG_TABLE,                                      *00394000
                   AUDIT_DATE,                                         *00395000
                   AUDIT_TIME,                                         *00396000
                   AUDIT_USER,                                         *00397000
                   AUDIT_ORG,                                          *00398000
                   BAL_OPT,                                            *00399000
                   AMOUNT_REQ_01,                                      *00400000
                   DISC_PCT_1,                                         *00401000
                   DISC_AMT_1,                                         *00402000
                   AMOUNT_REQ_02,                                      *00403000
                   DISC_PCT_2,                                         *00404000
                   DISC_AMT_2,                                         *00405000
                   AMOUNT_REQ_03,                                      *00406000
                   DISC_PCT_3,                                         *00407000
                   DISC_AMT_3,                                         *00408000
                   AMOUNT_REQ_04,                                      *00409000
                   DISC_PCT_4,                                         *00410000
                   DISC_AMT_4,                                         *00411000
                   AMOUNT_REQ_05,                                      *00412000
                   DISC_PCT_5,                                         *00413000
                   DISC_AMT_5,                                         *00414000
                   AMOUNT_REQ_06,                                      *00415000
                   DISC_PCT_6,                                         *00416000
                   DISC_AMT_6,                                         *00417000
                   AMOUNT_REQ_07,                                      *00418000
                   DISC_PCT_7,                                         *00419000
                   DISC_AMT_7,                                         *00420000
                   AMOUNT_REQ_08,                                      *00421000
                   DISC_PCT_8,                                         *00422000
                   DISC_AMT_8,                                         *00423000
                   AMOUNT_REQ_09,                                      *00424000
                   DISC_PCT_9,                                         *00425000
                   DISC_AMT_9,                                         *00426000
                   AMOUNT_REQ_10,                                      *00427000
                   DISC_PCT_10,                                        *00428000
                   DISC_AMT_10                                         *00429000
                 FROM S09                                              *00430000
                 WHERE                                                 *00431000
                   INST_NBR = :INST AND                                *00432000
                   RECORD_NBR >=                                       *00433000
                     :RECNBR                                           *00434000
                 ORDER BY RECORD_NBR ASC,                              *00435000
                   SVC_CHG_TABLE ASC                                   *00436000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00437000
         EXEC  SQL OPEN S09GE002                                        00438000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00439000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00440000
         BR    14                      RETURN TO CALLER                 00441000
         LTORG                                                          00442000
*                                                                       00443000
SELGE003 DS    0H                                                       00444000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00445000
         EXEC  SQL DECLARE S09GE003 CURSOR                             *00446000
               WITH ROWSET POSITIONING                                 *00447000
               FOR SELECT                                              *00448000
                   INST_NBR,                                           *00449000
                   RECORD_NBR,                                         *00450000
                   SVC_CHG_TABLE,                                      *00451000
                   AUDIT_DATE,                                         *00452000
                   AUDIT_TIME,                                         *00453000
                   AUDIT_USER,                                         *00454000
                   AUDIT_ORG,                                          *00455000
                   BAL_OPT,                                            *00456000
                   AMOUNT_REQ_01,                                      *00457000
                   DISC_PCT_1,                                         *00458000
                   DISC_AMT_1,                                         *00459000
                   AMOUNT_REQ_02,                                      *00460000
                   DISC_PCT_2,                                         *00461000
                   DISC_AMT_2,                                         *00462000
                   AMOUNT_REQ_03,                                      *00463000
                   DISC_PCT_3,                                         *00464000
                   DISC_AMT_3,                                         *00465000
                   AMOUNT_REQ_04,                                      *00466000
                   DISC_PCT_4,                                         *00467000
                   DISC_AMT_4,                                         *00468000
                   AMOUNT_REQ_05,                                      *00469000
                   DISC_PCT_5,                                         *00470000
                   DISC_AMT_5,                                         *00471000
                   AMOUNT_REQ_06,                                      *00472000
                   DISC_PCT_6,                                         *00473000
                   DISC_AMT_6,                                         *00474000
                   AMOUNT_REQ_07,                                      *00475000
                   DISC_PCT_7,                                         *00476000
                   DISC_AMT_7,                                         *00477000
                   AMOUNT_REQ_08,                                      *00478000
                   DISC_PCT_8,                                         *00479000
                   DISC_AMT_8,                                         *00480000
                   AMOUNT_REQ_09,                                      *00481000
                   DISC_PCT_9,                                         *00482000
                   DISC_AMT_9,                                         *00483000
                   AMOUNT_REQ_10,                                      *00484000
                   DISC_PCT_10,                                        *00485000
                   DISC_AMT_10                                         *00486000
                 FROM S09                                              *00487000
                 WHERE                                                 *00488000
                   INST_NBR >=                                         *00489000
                     :INST                                             *00490000
                 ORDER BY INST_NBR ASC,                                *00491000
                   RECORD_NBR ASC,                                     *00492000
                   SVC_CHG_TABLE ASC                                   *00493000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00494000
         EXEC  SQL OPEN S09GE003                                        00495000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00496000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00497000
         BR    14                      RETURN TO CALLER                 00498000
         LTORG                                                          00499000
*                                                                       00500000
**********************************************************************  00501000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00502000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00503000
**********************************************************************  00504000
*                                                                       00505000
NXTXC0   DS    0H                                                       00506000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00507000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00508000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00509000
         BALR  14,15                   MOVE REQUESTED DATA              00510000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00511000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00512000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00513000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00514000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00515000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00516000
NXTXC0P  DC    A(0)                                                     00517000
         DC    A(NXTGT002)                                              00518000
         DC    A(NXTGT003)                                              00519000
         DC    A(NXTGT099)                                              00520000
         DC    A(NXTGT003)                                              00521000
         DC    A(NXTGT099)                                              00522000
         DC    A(NXTGT099)                                              00523000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00524000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00525000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00526000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00527000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00528000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00529000
         BR    14                      RETURN TO SQI                    00530000
         LTORG                                                          00531000
*                                                                       00532000
NXTGT002 DS    0H                                                       00533000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00534000
         EXEC  SQL DECLARE S09GT002 CURSOR                             *00535000
               WITH ROWSET POSITIONING                                 *00536000
               FOR SELECT                                              *00537000
                   INST_NBR,                                           *00538000
                   RECORD_NBR,                                         *00539000
                   SVC_CHG_TABLE,                                      *00540000
                   AUDIT_DATE,                                         *00541000
                   AUDIT_TIME,                                         *00542000
                   AUDIT_USER,                                         *00543000
                   AUDIT_ORG,                                          *00544000
                   BAL_OPT,                                            *00545000
                   AMOUNT_REQ_01,                                      *00546000
                   DISC_PCT_1,                                         *00547000
                   DISC_AMT_1,                                         *00548000
                   AMOUNT_REQ_02,                                      *00549000
                   DISC_PCT_2,                                         *00550000
                   DISC_AMT_2,                                         *00551000
                   AMOUNT_REQ_03,                                      *00552000
                   DISC_PCT_3,                                         *00553000
                   DISC_AMT_3,                                         *00554000
                   AMOUNT_REQ_04,                                      *00555000
                   DISC_PCT_4,                                         *00556000
                   DISC_AMT_4,                                         *00557000
                   AMOUNT_REQ_05,                                      *00558000
                   DISC_PCT_5,                                         *00559000
                   DISC_AMT_5,                                         *00560000
                   AMOUNT_REQ_06,                                      *00561000
                   DISC_PCT_6,                                         *00562000
                   DISC_AMT_6,                                         *00563000
                   AMOUNT_REQ_07,                                      *00564000
                   DISC_PCT_7,                                         *00565000
                   DISC_AMT_7,                                         *00566000
                   AMOUNT_REQ_08,                                      *00567000
                   DISC_PCT_8,                                         *00568000
                   DISC_AMT_8,                                         *00569000
                   AMOUNT_REQ_09,                                      *00570000
                   DISC_PCT_9,                                         *00571000
                   DISC_AMT_9,                                         *00572000
                   AMOUNT_REQ_10,                                      *00573000
                   DISC_PCT_10,                                        *00574000
                   DISC_AMT_10                                         *00575000
                 FROM S09                                              *00576000
                 WHERE                                                 *00577000
                   INST_NBR = :INST AND                                *00578000
                   RECORD_NBR >                                        *00579000
                     :RECNBR                                           *00580000
                 ORDER BY RECORD_NBR ASC,                              *00581000
                   SVC_CHG_TABLE ASC                                   *00582000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00583000
         EXEC  SQL OPEN S09GT002                                        00584000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00585000
         BNZ   *+14                    NO - RETURN ERROR                00586000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00587000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00588000
         BR    12                      RETURN TO FETCH ROUTINE          00589000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00590000
         BR    14                      RETURN TO CALLER                 00591000
         LTORG                                                          00592000
*                                                                       00593000
NXTGT003 DS    0H                                                       00594000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00595000
         EXEC  SQL DECLARE S09GT003 CURSOR                             *00596000
               WITH ROWSET POSITIONING                                 *00597000
               FOR SELECT                                              *00598000
                   INST_NBR,                                           *00599000
                   RECORD_NBR,                                         *00600000
                   SVC_CHG_TABLE,                                      *00601000
                   AUDIT_DATE,                                         *00602000
                   AUDIT_TIME,                                         *00603000
                   AUDIT_USER,                                         *00604000
                   AUDIT_ORG,                                          *00605000
                   BAL_OPT,                                            *00606000
                   AMOUNT_REQ_01,                                      *00607000
                   DISC_PCT_1,                                         *00608000
                   DISC_AMT_1,                                         *00609000
                   AMOUNT_REQ_02,                                      *00610000
                   DISC_PCT_2,                                         *00611000
                   DISC_AMT_2,                                         *00612000
                   AMOUNT_REQ_03,                                      *00613000
                   DISC_PCT_3,                                         *00614000
                   DISC_AMT_3,                                         *00615000
                   AMOUNT_REQ_04,                                      *00616000
                   DISC_PCT_4,                                         *00617000
                   DISC_AMT_4,                                         *00618000
                   AMOUNT_REQ_05,                                      *00619000
                   DISC_PCT_5,                                         *00620000
                   DISC_AMT_5,                                         *00621000
                   AMOUNT_REQ_06,                                      *00622000
                   DISC_PCT_6,                                         *00623000
                   DISC_AMT_6,                                         *00624000
                   AMOUNT_REQ_07,                                      *00625000
                   DISC_PCT_7,                                         *00626000
                   DISC_AMT_7,                                         *00627000
                   AMOUNT_REQ_08,                                      *00628000
                   DISC_PCT_8,                                         *00629000
                   DISC_AMT_8,                                         *00630000
                   AMOUNT_REQ_09,                                      *00631000
                   DISC_PCT_9,                                         *00632000
                   DISC_AMT_9,                                         *00633000
                   AMOUNT_REQ_10,                                      *00634000
                   DISC_PCT_10,                                        *00635000
                   DISC_AMT_10                                         *00636000
                 FROM S09                                              *00637000
                 WHERE                                                 *00638000
                   INST_NBR >                                          *00639000
                     :INST                                             *00640000
                 ORDER BY INST_NBR ASC,                                *00641000
                   RECORD_NBR ASC,                                     *00642000
                   SVC_CHG_TABLE ASC                                   *00643000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00644000
         EXEC  SQL OPEN S09GT003                                        00645000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00646000
         BNZ   *+14                    NO - RETURN ERROR                00647000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00648000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00649000
         BR    12                      RETURN TO FETCH ROUTINE          00650000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00651000
         BR    14                      RETURN TO CALLER                 00652000
         LTORG                                                          00653000
*                                                                       00654000
**********************************************************************  00655000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00656000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00657000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00658000
*     RETRIEVE THE ACTUAL ROW.                                          00659000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00660000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00661000
**********************************************************************  00662000
*                                                                       00663000
FETDC0   DS    0H                                                       00664000
         USING FETDC0,12               ESTABLISH BASE REGISTER          00665000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       00666000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00667000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       00668000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00669000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    00670000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00671000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00672000
FETDC0P  DC    A(FETGE001)                                              00673000
         DC    A(FETGT002)                                              00674000
         DC    A(FETGT003)                                              00675000
         DC    A(FETGE002)                                              00676000
         DC    A(FETGT003)                                              00677000
         DC    A(FETGE003)                                              00678000
         DC    A(0)                                                     00679000
         LTORG                                                          00680000
*                                                                       00681000
**********************************************************************  00682000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00683000
* THE PRIMARY KEY:                                                      00684000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00685000
*     VERBS.                                                            00686000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00687000
*     RETRIEVE THE ACTUAL ROW.                                          00688000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00689000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00690000
*     WILL BE THRU THE UPDATE CURSOR.                                   00691000
**********************************************************************  00692000
*                                                                       00693000
FETKC0   DS    0H                                                       00694000
         USING FETKC0,12               ESTABLISH BASE REGISTER          00695000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       00696000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00697000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           00698000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00699000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    00700000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00701000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00702000
FETKC0P  DC    A(FETGE001)                                              00703000
         DC    A(FETGT002)                                              00704000
         DC    A(FETGT003)                                              00705000
         DC    A(FETGE002)                                              00706000
         DC    A(FETGT003)                                              00707000
         DC    A(FETGE003)                                              00708000
         DC    A(0)                                                     00709000
         LTORG                                                          00710000
*                                                                       00711000
FETGE001 DS    0H                                                       00712000
         USING FETGE001,12             ESTABLISH BASE REGISTER          00713000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00714000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00715000
         BALR  14,15                   MOVE REQUESTED DATA              00716000
         EXEC  SQL FETCH NEXT ROWSET FROM S09GE001                     *00717000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00718000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00719000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00720000
         BALR  14,15                   MOVE REQUESTED DATA              00721000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00722000
         BR    14                      RETURN TO CALLER                 00723000
         LTORG                                                          00724000
*                                                                       00725000
FETGE002 DS    0H                                                       00726000
         USING FETGE002,12             ESTABLISH BASE REGISTER          00727000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00728000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00729000
         BALR  14,15                   MOVE REQUESTED DATA              00730000
         EXEC  SQL FETCH NEXT ROWSET FROM S09GE002                     *00731000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00732000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00733000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00734000
         BALR  14,15                   MOVE REQUESTED DATA              00735000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00736000
         BR    14                      RETURN TO CALLER                 00737000
         LTORG                                                          00738000
*                                                                       00739000
FETGE003 DS    0H                                                       00740000
         USING FETGE003,12             ESTABLISH BASE REGISTER          00741000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00742000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00743000
         BALR  14,15                   MOVE REQUESTED DATA              00744000
         EXEC  SQL FETCH NEXT ROWSET FROM S09GE003                     *00745000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00746000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00747000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00748000
         BALR  14,15                   MOVE REQUESTED DATA              00749000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00750000
         BR    14                      RETURN TO CALLER                 00751000
         LTORG                                                          00752000
*                                                                       00753000
FETGT002 DS    0H                                                       00754000
         USING FETGT002,12             ESTABLISH BASE REGISTER          00755000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00756000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00757000
         BALR  14,15                   MOVE REQUESTED DATA              00758000
         EXEC  SQL FETCH NEXT ROWSET FROM S09GT002                     *00759000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00760000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00761000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00762000
         BALR  14,15                   MOVE REQUESTED DATA              00763000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00764000
         BR    14                      RETURN TO CALLER                 00765000
         LTORG                                                          00766000
*                                                                       00767000
FETGT003 DS    0H                                                       00768000
         USING FETGT003,12             ESTABLISH BASE REGISTER          00769000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00770000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00771000
         BALR  14,15                   MOVE REQUESTED DATA              00772000
         EXEC  SQL FETCH NEXT ROWSET FROM S09GT003                     *00773000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00774000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00775000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00776000
         BALR  14,15                   MOVE REQUESTED DATA              00777000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00778000
         BR    14                      RETURN TO CALLER                 00779000
         LTORG                                                          00780000
*                                                                       00781000
**********************************************************************  00782000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    00783000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00784000
*     AND GET-NEXT-LOCK VERBS.                                          00785000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00786000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00787000
**********************************************************************  00788000
*                                                                       00789000
CLSXC0   DS    0H                                                       00790000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          00791000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 00792000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00793000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       00794000
         LTORG                                                          00795000
*                                                                       00796000
CLSGE001 DS    0H                                                       00797000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          00798000
         EXEC  SQL CLOSE S09GE001                                       00799000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00800000
         BR    14                      RETURN TO CALLER                 00801000
         LTORG                                                          00802000
*                                                                       00803000
CLSGE002 DS    0H                                                       00804000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          00805000
         EXEC  SQL CLOSE S09GE002                                       00806000
         L     14,SQW@RET                                               00807000
         BR    14                                                       00808000
         LTORG                                                          00809000
*                                                                       00810000
CLSGE003 DS    0H                                                       00811000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          00812000
         EXEC  SQL CLOSE S09GE003                                       00813000
         L     14,SQW@RET                                               00814000
         BR    14                                                       00815000
         LTORG                                                          00816000
*                                                                       00817000
CLSGT002 DS    0H                                                       00818000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          00819000
         EXEC  SQL CLOSE S09GT002                                       00820000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00821000
         BR    14                      RETURN TO CALLER                 00822000
         LTORG                                                          00823000
*                                                                       00824000
CLSGT003 DS    0H                                                       00825000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          00826000
         EXEC  SQL CLOSE S09GT003                                       00827000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00828000
         BR    14                      RETURN TO CALLER                 00829000
         LTORG                                                          00830000
*                                                                       00831000
**********************************************************************  00832000
* ALTERNATE KEY 1 NOT DEFINED                                           00833000
**********************************************************************  00834000
*                                                                       00835000
SELIN1   DS    0H                                                       00836000
SELKY1   DS    0H                                                       00837000
SELXC1   DS    0H                                                       00838000
FETDC1   DS    0H                                                       00839000
FETKC1   DS    0H                                                       00840000
CLSXC1   DS    0H                                                       00841000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00842000
*                                                                       00843000
**********************************************************************  00844000
* ALTERNATE KEY 2 NOT DEFINED                                           00845000
**********************************************************************  00846000
*                                                                       00847000
SELIN2   DS    0H                                                       00848000
SELKY2   DS    0H                                                       00849000
SELXC2   DS    0H                                                       00850000
FETDC2   DS    0H                                                       00851000
FETKC2   DS    0H                                                       00852000
CLSXC2   DS    0H                                                       00853000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00854000
*                                                                       00855000
**********************************************************************  00856000
* ALTERNATE KEY 3 NOT DEFINED                                           00857000
**********************************************************************  00858000
*                                                                       00859000
SELIN3   DS    0H                                                       00860000
SELKY3   DS    0H                                                       00861000
SELXC3   DS    0H                                                       00862000
FETDC3   DS    0H                                                       00863000
FETKC3   DS    0H                                                       00864000
CLSXC3   DS    0H                                                       00865000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00866000
*                                                                       00867000
         DS    0H                      END OF SQL STATEMENTS            00868000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00869000
*                                                                       00870000
**********************************************************************  00871000
* DUMMY ENTRY POINT DSNHLI                                              00872000
**********************************************************************  00873000
*                                                                       00874000
         ENTRY DSNHLI                                                   00875000
DSNHLI   DS    0H                                                       00876000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00877000
         BR    15                      BRANCH TO ATTACH FACILITY        00878000
*                                                                       00879000
**********************************************************************  00880000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00881000
**********************************************************************  00882000
*                                                                       00883000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00884000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00885000
* OR:                                                                   00886000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00887000
* WHERE:                                                                00888000
*   RRRR = RECORD AREA OFFSET                                           00889000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00890000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00891000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00892000
*   KK   = KEY FIELD MASK:                                              00893000
*            80 = KEY 0 FIELD                                           00894000
*            40 = KEY 1 FIELD                                           00895000
*            20 = KEY 2 FIELD                                           00896000
*            10 = KEY 3 FIELD                                           00897000
*   DD   = DATA FIELD MASK:                                             00898000
*            80 = RECORD FIELD IS PACKED                                00899000
*            40 = HOST VARIABLE IS PACKED                               00900000
*            20 = NULLABLE FIELD                                        00901000
*            01 = DATE FIELD                                            00902000
*            02 = TIME FIELD                                            00903000
*                                                                       00904000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00905000
         DC    H'0000',H'0000',H'0014',X'80',X'00'                      00906000
         DC    H'0014',H'0014',H'0145',X'00',X'00'                      00907000
         DC    8X'FF'                                                   00908000
*                                                                       00909000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               00910000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  00911000
* OR:                                                                   00912000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  00913000
* WHERE:                                                                00914000
*   RRRR = RECORD AREA OFFSET                                           00915000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     00916000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      00917000
*   TTTT = SQLDA DATA TYPE:                                             00918000
*            452 = CHAR       453 = CHAR NULLABLE                       00919000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    00920000
*            496 = INTEGER    497 = INTEGER NULLABLE                    00921000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   00922000
*                                                                       00923000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      00924000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 00925000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       00926000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    00927000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       00928000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       00929000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       00930000
         DC    AL2(00159)              SUMMATION OF ALL COLUMN LENGTHS  00931000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     00932000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       00933000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       00934000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       00935000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      00936000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        00937000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        00938000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        00939000
CONVDATA DS    0H                                                       00940000
         DC    H'0000',H'0004',H'452'  INST_NBR                         00941000
         DC    H'0004',H'0004',H'452'  RECORD_NBR                       00942000
         DC    H'0008',H'0006',H'452'  SVC_CHG_TABLE                    00943000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   00944000
         DC    H'0014',X'0900',H'484'  AUDIT_DATE                       00945000
         DC    H'0019',X'0900',H'484'  AUDIT_TIME                       00946000
         DC    H'0024',H'0008',H'452'  AUDIT_USER                       00947000
         DC    H'0032',H'0006',H'452'  AUDIT_ORG                        00948000
         DC    H'0038',H'0001',H'452'  BAL_OPT                          00949000
         DC    H'0039',X'0B02',H'484'  AMOUNT_REQ_01                    00950000
         DC    H'0045',X'0505',H'484'  DISC_PCT_1                       00951000
         DC    H'0048',X'0502',H'484'  DISC_AMT_1                       00952000
         DC    H'0051',X'0B02',H'484'  AMOUNT_REQ_02                    00953000
         DC    H'0057',X'0505',H'484'  DISC_PCT_2                       00954000
         DC    H'0060',X'0502',H'484'  DISC_AMT_2                       00955000
         DC    H'0063',X'0B02',H'484'  AMOUNT_REQ_03                    00956000
         DC    H'0069',X'0505',H'484'  DISC_PCT_3                       00957000
         DC    H'0072',X'0502',H'484'  DISC_AMT_3                       00958000
         DC    H'0075',X'0B02',H'484'  AMOUNT_REQ_04                    00959000
         DC    H'0081',X'0505',H'484'  DISC_PCT_4                       00960000
         DC    H'0084',X'0502',H'484'  DISC_AMT_4                       00961000
         DC    H'0087',X'0B02',H'484'  AMOUNT_REQ_05                    00962000
         DC    H'0093',X'0505',H'484'  DISC_PCT_5                       00963000
         DC    H'0096',X'0502',H'484'  DISC_AMT_5                       00964000
         DC    H'0099',X'0B02',H'484'  AMOUNT_REQ_06                    00965000
         DC    H'0105',X'0505',H'484'  DISC_PCT_6                       00966000
         DC    H'0108',X'0502',H'484'  DISC_AMT_6                       00967000
         DC    H'0111',X'0B02',H'484'  AMOUNT_REQ_07                    00968000
         DC    H'0117',X'0505',H'484'  DISC_PCT_7                       00969000
         DC    H'0120',X'0502',H'484'  DISC_AMT_7                       00970000
         DC    H'0123',X'0B02',H'484'  AMOUNT_REQ_08                    00971000
         DC    H'0129',X'0505',H'484'  DISC_PCT_8                       00972000
         DC    H'0132',X'0502',H'484'  DISC_AMT_8                       00973000
         DC    H'0135',X'0B02',H'484'  AMOUNT_REQ_09                    00974000
         DC    H'0141',X'0505',H'484'  DISC_PCT_9                       00975000
         DC    H'0144',X'0502',H'484'  DISC_AMT_9                       00976000
         DC    H'0147',X'0B02',H'484'  AMOUNT_REQ_10                    00977000
         DC    H'0153',X'0505',H'484'  DISC_PCT_10                      00978000
         DC    H'0156',X'0502',H'484'  DISC_AMT_10                      00979000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       00980000
KY0COLMS EQU   00003                   NUMBER OF PRIMARY KEY COLUMNS    00981000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      00982000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      00983000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      00984000
*                                                                       00985000
         LTORG                                                          00986000
         END                                                            00987000
