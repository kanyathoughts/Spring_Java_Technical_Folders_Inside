**********************************************************************  00001000
*                                                                       00002000
*  SAHUDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAH TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST1    DS    CL4                                                      00050000
PRDCDE1  DS    CL6                                                      00051000
ACCTNBR1 DS    CL18                                                     00052000
MODEL    DS    CL10                                                     00053000
INST2    DS    CL4                                                      00054000
PRDCDE2  DS    CL6                                                      00055000
ACCTNBR2 DS    CL18                                                     00056000
AUDDATE  DS    PL5'0.'                                                  00057000
AUDTIME  DS    PL5'0.'                                                  00058000
AUDUSER  DS    CL8                                                      00059000
AUDORG   DS    CL6                                                      00060000
ACCTST   DS    CL1                                                      00061000
BRCH     DS    PL3'0.'                                                  00062000
ACCTTYPE DS    PL2'0.'                                                  00063000
SCINCENO DS    CL1                                                      00064000
RINCENO  DS    CL1                                                      00065000
APPLNBR  DS    CL2                                                      00066000
ACCTBAL1 DS    PL8'0.00'                                                00067000
ACCTBAL2 DS    PL8'0.00'                                                00068000
PRIMEBAL DS    PL8'0.00'                                                00069000
ACMBBAL1 DS    PL8'0.00'                                                00070000
ACMBBAL2 DS    PL8'0.00'                                                00071000
ACMBBAL3 DS    PL8'0.00'                                                00072000
ACMBBAL4 DS    PL8'0.00'                                                00073000
CASHBAL  DS    PL8'0.00'                                                00074000
ACCTRATE DS    PL8'0.00'                                                00075000
SCBAL    DS    PL8'0.00'                                                00076000
SECSVBAL DS    PL8'0.00'                                                00077000
DAMTFLAG DS    CL1                                                      00078000
DPCTFLAG DS    CL1                                                      00079000
RPCTFLAG DS    CL1                                                      00080000
DAMTOVRD DS    PL6'0.00'                                                00081000
DPCTOVRD DS    PL3'0.00000'                                             00082000
RPCTOVRD DS    PL3'0.00000'                                             00083000
RAREA    DS    CL43                                                     00084000
*                                                                       00085000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00086000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00087000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00088000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00089000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00090000
         DS    CL97                    RESERVED                         00091000
*                                                                       00092000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00093000
INDVARX  DS    0H                                                       00094000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00095000
*                                                                       00096000
*                                                                       00097000
**********************************************************************  00098000
* PROGRAM TABLE HEADER SECTION:                                         00099000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00100000
**********************************************************************  00101000
*                                                                       00102000
SAHUDB   CSECT                         PROGRAM TABLE SECTION            00103000
SAHUDB   AMODE ANY                                                      00104000
SAHUDB   RMODE ANY                                                      00105000
         DC    CL8'SAHUDB  '           PROGRAM ID                       00106000
         DC    CL1' '                                                   00107000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00108000
         DC    CL1' '                                                   00109000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00110000
         DC    CL1' '                                                   00111000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00112000
         DC    5A(0)                   RESERVED                         00113000
         DC    AL2(0)                  RESERVED                         00114000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00115000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00116000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00117000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00118000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00119000
         DC    CL29'WWW.INFOR.COM                '                      00119001
*                                                                       00120000
**********************************************************************  00121000
* STATEMENT TABLE SECTION:                                              00122000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00123000
**********************************************************************  00124000
*                                                                       00125000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00126000
STM#TAB  AMODE ANY                                                      00127000
STM#TAB  RMODE ANY                                                      00128000
         DC    4A(0)                   RDB MODULE VECTORS               00129000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00130000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00131000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00132000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00133000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00134000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00135000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00136000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00137000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00138000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00139000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00140000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00141000
         DC    20A(0)                  RDB MODULE VECTORS               00142000
         DC    A(INSROW)               INSERT STATEMENT                 00143000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00144000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00145000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00146000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00147000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00148000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00149000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00150000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00151000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00152000
         DC    4X'FF'                                                   00153000
*                                                                       00154000
**********************************************************************  00155000
* SQL STATEMENT SECTION:                                                00156000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00157000
*     TO SUPPORT THIS TABLE.                                            00158000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00159000
*     ARE EQUIVALENT.                                                   00160000
**********************************************************************  00161000
*                                                                       00162000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00163000
SQL#STMT AMODE ANY                                                      00164000
SQL#STMT RMODE ANY                                                      00165000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00166000
         USING COM#AREA,11             ADDRESS COMMAREA                 00167000
*                                                                       00168000
**********************************************************************  00169000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00170000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00171000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00172000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00173000
**********************************************************************  00174000
*                                                                       00175000
SELUC0   DS    0H                                                       00176000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00177000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00178000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00179000
         BALR  14,15                   MOVE REQUESTED DATA              00180000
         EXEC  SQL DECLARE SAHUPD0 CURSOR                              *00181000
               FOR SELECT                                              *00182000
                   AUDIT_DATE,                                         *00183000
                   AUDIT_TIME,                                         *00184000
                   AUDIT_USER,                                         *00185000
                   AUDIT_ORG,                                          *00186000
                   ACCT_STATUS,                                        *00187000
                   BRANCH,                                             *00188000
                   ACCT_TYPE,                                          *00189000
                   SVC_INCEN_OPT,                                      *00190000
                   RATE_INCEN_OPT,                                     *00191000
                   APPL_NBR,                                           *00192000
                   ACCT_BAL_1,                                         *00193000
                   ACCT_BAL_2,                                         *00194000
                   PRIMARY_BAL,                                        *00195000
                   ACCT_CMB_BAL_1,                                     *00196000
                   ACCT_CMB_BAL_2,                                     *00197000
                   ACCT_CMB_BAL_3,                                     *00198000
                   ACCT_CMB_BAL_4,                                     *00199000
                   CASH_BALANCE,                                       *00200000
                   ACCT_RATE_BAL,                                      *00201000
                   SVC_CHG_BAL,                                        *00202000
                   SEC_SVC_BAL,                                        *00203000
                   DISC_AMT_FLAG,                                      *00204000
                   DISC_PCT_FLAG,                                      *00205000
                   RATE_PCT_FLAG,                                      *00206000
                   DISC_AMT_OVRD,                                      *00207000
                   DISC_PCT_OVRD,                                      *00208000
                   RATE_PCT_OVRD,                                      *00209000
                   RSV_AREA                                            *00210000
                 FROM SAH                                              *00211000
                 WHERE                                                 *00212000
                   ACCT_INST_1 = :INST1 AND                            *00213000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00214000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00215000
                   MODEL = :MODEL AND                                  *00216000
                   ACCT_INST_2 = :INST2 AND                            *00217000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00218000
                   ACCT_NBR_2 = :ACCTNBR2                              *00219000
                 FOR UPDATE OF                                         *00220000
                   AUDIT_DATE,                                         *00221000
                   AUDIT_TIME,                                         *00222000
                   AUDIT_USER,                                         *00223000
                   AUDIT_ORG,                                          *00224000
                   ACCT_STATUS,                                        *00225000
                   BRANCH,                                             *00226000
                   ACCT_TYPE,                                          *00227000
                   SVC_INCEN_OPT,                                      *00228000
                   RATE_INCEN_OPT,                                     *00229000
                   APPL_NBR,                                           *00230000
                   ACCT_BAL_1,                                         *00231000
                   ACCT_BAL_2,                                         *00232000
                   PRIMARY_BAL,                                        *00233000
                   ACCT_CMB_BAL_1,                                     *00234000
                   ACCT_CMB_BAL_2,                                     *00235000
                   ACCT_CMB_BAL_3,                                     *00236000
                   ACCT_CMB_BAL_4,                                     *00237000
                   CASH_BALANCE,                                       *00238000
                   ACCT_RATE_BAL,                                      *00239000
                   SVC_CHG_BAL,                                        *00240000
                   SEC_SVC_BAL,                                        *00241000
                   DISC_AMT_FLAG,                                      *00242000
                   DISC_PCT_FLAG,                                      *00243000
                   RATE_PCT_FLAG,                                      *00244000
                   DISC_AMT_OVRD,                                      *00245000
                   DISC_PCT_OVRD,                                      *00246000
                   RATE_PCT_OVRD,                                      *00247000
                   RSV_AREA                                            *00248000
                 FETCH FIRST 1 ROW ONLY                                 00249000
         EXEC  SQL OPEN SAHUPD0                                         00250000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00251000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00252000
         BR    14                      RETURN TO CALLER                 00253000
         LTORG                                                          00254000
*                                                                       00255000
**********************************************************************  00256000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00257000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00258000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00259000
*     THE ACTUAL ROW.                                                   00260000
**********************************************************************  00261000
*                                                                       00262000
FETUC0   DS    0H                                                       00263000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00264000
         EXEC  SQL FETCH SAHUPD0                                       *00265000
                 INTO                                                  *00266000
                   :AUDDATE,                                           *00267000
                   :AUDTIME,                                           *00268000
                   :AUDUSER,                                           *00269000
                   :AUDORG,                                            *00270000
                   :ACCTST,                                            *00271000
                   :BRCH,                                              *00272000
                   :ACCTTYPE,                                          *00273000
                   :SCINCENO,                                          *00274000
                   :RINCENO,                                           *00275000
                   :APPLNBR,                                           *00276000
                   :ACCTBAL1,                                          *00277000
                   :ACCTBAL2,                                          *00278000
                   :PRIMEBAL,                                          *00279000
                   :ACMBBAL1,                                          *00280000
                   :ACMBBAL2,                                          *00281000
                   :ACMBBAL3,                                          *00282000
                   :ACMBBAL4,                                          *00283000
                   :CASHBAL,                                           *00284000
                   :ACCTRATE,                                          *00285000
                   :SCBAL,                                             *00286000
                   :SECSVBAL,                                          *00287000
                   :DAMTFLAG,                                          *00288000
                   :DPCTFLAG,                                          *00289000
                   :RPCTFLAG,                                          *00290000
                   :DAMTOVRD,                                          *00291000
                   :DPCTOVRD,                                          *00292000
                   :RPCTOVRD,                                          *00293000
                   :RAREA                                               00294000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00295000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00296000
         BALR  14,15                   MOVE REQUESTED DATA              00297000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00298000
         BR    14                      RETURN TO CALLER                 00299000
         LTORG                                                          00300000
*                                                                       00301000
**********************************************************************  00302000
* INSERT STATEMENT:                                                     00303000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00304000
**********************************************************************  00305000
*                                                                       00306000
INSROW   DS    0H                                                       00307000
         USING INSROW,12               ESTABLISH BASE REGISTER          00308000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00309000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00310000
         BALR  14,15                   MOVE REQUESTED DATA              00311000
         EXEC  SQL INSERT INTO SAH                                     *00312000
                   (                                                   *00313000
                   ACCT_INST_1,                                        *00314000
                   PROD_CODE_1,                                        *00315000
                   ACCT_NBR_1,                                         *00316000
                   MODEL,                                              *00317000
                   ACCT_INST_2,                                        *00318000
                   PROD_CODE_2,                                        *00319000
                   ACCT_NBR_2,                                         *00320000
                   AUDIT_DATE,                                         *00321000
                   AUDIT_TIME,                                         *00322000
                   AUDIT_USER,                                         *00323000
                   AUDIT_ORG,                                          *00324000
                   ACCT_STATUS,                                        *00325000
                   BRANCH,                                             *00326000
                   ACCT_TYPE,                                          *00327000
                   SVC_INCEN_OPT,                                      *00328000
                   RATE_INCEN_OPT,                                     *00329000
                   APPL_NBR,                                           *00330000
                   ACCT_BAL_1,                                         *00331000
                   ACCT_BAL_2,                                         *00332000
                   PRIMARY_BAL,                                        *00333000
                   ACCT_CMB_BAL_1,                                     *00334000
                   ACCT_CMB_BAL_2,                                     *00335000
                   ACCT_CMB_BAL_3,                                     *00336000
                   ACCT_CMB_BAL_4,                                     *00337000
                   CASH_BALANCE,                                       *00338000
                   ACCT_RATE_BAL,                                      *00339000
                   SVC_CHG_BAL,                                        *00340000
                   SEC_SVC_BAL,                                        *00341000
                   DISC_AMT_FLAG,                                      *00342000
                   DISC_PCT_FLAG,                                      *00343000
                   RATE_PCT_FLAG,                                      *00344000
                   DISC_AMT_OVRD,                                      *00345000
                   DISC_PCT_OVRD,                                      *00346000
                   RATE_PCT_OVRD,                                      *00347000
                   RSV_AREA                                            *00348000
                   )                                                   *00349000
                  VALUES                                               *00350000
                   (                                                   *00351000
                   :INST1,                                             *00352000
                   :PRDCDE1,                                           *00353000
                   :ACCTNBR1,                                          *00354000
                   :MODEL,                                             *00355000
                   :INST2,                                             *00356000
                   :PRDCDE2,                                           *00357000
                   :ACCTNBR2,                                          *00358000
                   :AUDDATE,                                           *00359000
                   :AUDTIME,                                           *00360000
                   :AUDUSER,                                           *00361000
                   :AUDORG,                                            *00362000
                   :ACCTST,                                            *00363000
                   :BRCH,                                              *00364000
                   :ACCTTYPE,                                          *00365000
                   :SCINCENO,                                          *00366000
                   :RINCENO,                                           *00367000
                   :APPLNBR,                                           *00368000
                   :ACCTBAL1,                                          *00369000
                   :ACCTBAL2,                                          *00370000
                   :PRIMEBAL,                                          *00371000
                   :ACMBBAL1,                                          *00372000
                   :ACMBBAL2,                                          *00373000
                   :ACMBBAL3,                                          *00374000
                   :ACMBBAL4,                                          *00375000
                   :CASHBAL,                                           *00376000
                   :ACCTRATE,                                          *00377000
                   :SCBAL,                                             *00378000
                   :SECSVBAL,                                          *00379000
                   :DAMTFLAG,                                          *00380000
                   :DPCTFLAG,                                          *00381000
                   :RPCTFLAG,                                          *00382000
                   :DAMTOVRD,                                          *00383000
                   :DPCTOVRD,                                          *00384000
                   :RPCTOVRD,                                          *00385000
                   :RAREA                                              *00386000
                   )                                                    00387000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00388000
         BR    14                      RETURN TO CALLER                 00389000
         LTORG                                                          00390000
*                                                                       00391000
**********************************************************************  00392000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00393000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00394000
**********************************************************************  00395000
*                                                                       00396000
UPDUC0   DS    0H                                                       00397000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00398000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00399000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00400000
         BALR  14,15                   MOVE REQUESTED DATA              00401000
         EXEC  SQL UPDATE SAH                                          *00402000
                   SET                                                 *00403000
                     AUDIT_DATE = :AUDDATE,                            *00404000
                     AUDIT_TIME = :AUDTIME,                            *00405000
                     AUDIT_USER = :AUDUSER,                            *00406000
                     AUDIT_ORG = :AUDORG,                              *00407000
                     ACCT_STATUS = :ACCTST,                            *00408000
                     BRANCH = :BRCH,                                   *00409000
                     ACCT_TYPE = :ACCTTYPE,                            *00410000
                     SVC_INCEN_OPT = :SCINCENO,                        *00411000
                     RATE_INCEN_OPT = :RINCENO,                        *00412000
                     APPL_NBR = :APPLNBR,                              *00413000
                     ACCT_BAL_1 = :ACCTBAL1,                           *00414000
                     ACCT_BAL_2 = :ACCTBAL2,                           *00415000
                     PRIMARY_BAL = :PRIMEBAL,                          *00416000
                     ACCT_CMB_BAL_1 = :ACMBBAL1,                       *00417000
                     ACCT_CMB_BAL_2 = :ACMBBAL2,                       *00418000
                     ACCT_CMB_BAL_3 = :ACMBBAL3,                       *00419000
                     ACCT_CMB_BAL_4 = :ACMBBAL4,                       *00420000
                     CASH_BALANCE = :CASHBAL,                          *00421000
                     ACCT_RATE_BAL = :ACCTRATE,                        *00422000
                     SVC_CHG_BAL = :SCBAL,                             *00423000
                     SEC_SVC_BAL = :SECSVBAL,                          *00424000
                     DISC_AMT_FLAG = :DAMTFLAG,                        *00425000
                     DISC_PCT_FLAG = :DPCTFLAG,                        *00426000
                     RATE_PCT_FLAG = :RPCTFLAG,                        *00427000
                     DISC_AMT_OVRD = :DAMTOVRD,                        *00428000
                     DISC_PCT_OVRD = :DPCTOVRD,                        *00429000
                     RATE_PCT_OVRD = :RPCTOVRD,                        *00430000
                     RSV_AREA = :RAREA                                 *00431000
                 WHERE CURRENT OF SAHUPD0                               00432000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00433000
         BR    14                      RETURN TO CALLER                 00434000
         LTORG                                                          00435000
*                                                                       00436000
**********************************************************************  00437000
* DELETE STATEMENT BY PRIMARY KEY:                                      00438000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00439000
**********************************************************************  00440000
*                                                                       00441000
DELUC0   DS    0H                                                       00442000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00443000
         EXEC  SQL DELETE FROM SAH                                     *00444000
                 WHERE CURRENT OF SAHUPD0                               00445000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00446000
         BR    14                      RETURN TO CALLER                 00447000
         LTORG                                                          00448000
*                                                                       00449000
**********************************************************************  00450000
* DELETE ALL STATEMENT:                                                 00451000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00452000
**********************************************************************  00453000
*                                                                       00454000
DELTBL   DS    0H                                                       00455000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00456000
         EXEC  SQL DELETE FROM SAH                                      00457000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00458000
         BR    14                      RETURN TO CALLER                 00459000
         LTORG                                                          00460000
*                                                                       00461000
**********************************************************************  00462000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00463000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00464000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00465000
*     TO CLOSE THE UPDATE CURSOR.                                       00466000
**********************************************************************  00467000
*                                                                       00468000
CLSUC0   DS    0H                                                       00469000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00470000
         EXEC  SQL CLOSE SAHUPD0                                        00471000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00472000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00473000
         BR    14                      RETURN TO CALLER                 00474000
         LTORG                                                          00475000
*                                                                       00476000
**********************************************************************  00477000
* ALTERNATE KEY 1 NOT DEFINED                                           00478000
**********************************************************************  00479000
*                                                                       00480000
SELUC1   DS    0H                                                       00481000
FETUC1   DS    0H                                                       00482000
UPDUC1   DS    0H                                                       00483000
DELUC1   DS    0H                                                       00484000
CLSUC1   DS    0H                                                       00485000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00486000
*                                                                       00487000
**********************************************************************  00488000
* ALTERNATE KEY 2 NOT DEFINED                                           00489000
**********************************************************************  00490000
*                                                                       00491000
SELUC2   DS    0H                                                       00492000
FETUC2   DS    0H                                                       00493000
UPDUC2   DS    0H                                                       00494000
DELUC2   DS    0H                                                       00495000
CLSUC2   DS    0H                                                       00496000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00497000
*                                                                       00498000
**********************************************************************  00499000
* ALTERNATE KEY 3 NOT DEFINED                                           00500000
**********************************************************************  00501000
*                                                                       00502000
SELUC3   DS    0H                                                       00503000
FETUC3   DS    0H                                                       00504000
UPDUC3   DS    0H                                                       00505000
DELUC3   DS    0H                                                       00506000
CLSUC3   DS    0H                                                       00507000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00508000
*                                                                       00509000
         DS    0H                      END OF SQL STATEMENTS            00510000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00511000
*                                                                       00512000
**********************************************************************  00513000
* DUMMY ENTRY POINT DSNHLI                                              00514000
**********************************************************************  00515000
*                                                                       00516000
         ENTRY DSNHLI                                                   00517000
DSNHLI   DS    0H                                                       00518000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00519000
         BR    15                      BRANCH TO ATTACH FACILITY        00520000
*                                                                       00521000
**********************************************************************  00522000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00523000
**********************************************************************  00524000
*                                                                       00525000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00526000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00527000
* OR:                                                                   00528000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00529000
* WHERE:                                                                00530000
*   RRRR = RECORD AREA OFFSET                                           00531000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00532000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00533000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00534000
*   KK   = KEY FIELD MASK:                                              00535000
*            80 = KEY 0 FIELD                                           00536000
*            40 = KEY 1 FIELD                                           00537000
*            20 = KEY 2 FIELD                                           00538000
*            10 = KEY 3 FIELD                                           00539000
*   DD   = DATA FIELD MASK:                                             00540000
*            80 = RECORD FIELD IS PACKED                                00541000
*            40 = HOST VARIABLE IS PACKED                               00542000
*            20 = NULLABLE FIELD                                        00543000
*            01 = DATE FIELD                                            00544000
*            02 = TIME FIELD                                            00545000
*                                                                       00546000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00547000
         DC    H'0000',H'0000',H'0066',X'80',X'00'                      00548000
         DC    H'0066',H'0066',H'0180',X'00',X'00'                      00549000
         DC    8X'FF'                                                   00550000
*                                                                       00551000
         LTORG                                                          00552000
         END                                                            00553000
