* REL=S14IODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  S14IODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S14 FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL193                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
RECNBR   DS    CL4                                                      00039000
RATETABL DS    CL6                                                      00040000
TERM     DS    CL5                                                      00041000
AUDDATE  DS    PL5'0.'                                                  00042000
AUDTIME  DS    PL5'0.'                                                  00043000
AUDUSER  DS    CL8                                                      00044000
AUDORG   DS    CL6                                                      00045000
RATEAMT1 DS    PL5'0.'                                                  00046000
RATEPCT1 DS    PL5'0.000000000'                                         00047000
RATEAMT2 DS    PL5'0.'                                                  00048000
RATEPCT2 DS    PL5'0.000000000'                                         00049000
RATEAMT3 DS    PL5'0.'                                                  00050000
RATEPCT3 DS    PL5'0.000000000'                                         00051000
RATEAMT4 DS    PL5'0.'                                                  00052000
RATEPCT4 DS    PL5'0.000000000'                                         00053000
RATEAMT5 DS    PL5'0.'                                                  00054000
RATEPCT5 DS    PL5'0.000000000'                                         00055000
RATEAMT6 DS    PL5'0.'                                                  00056000
RATEPCT6 DS    PL5'0.000000000'                                         00057000
RATEAMT7 DS    PL5'0.'                                                  00058000
RATEPCT7 DS    PL5'0.000000000'                                         00059000
RATEAMT8 DS    PL5'0.'                                                  00060000
RATEPCT8 DS    PL5'0.000000000'                                         00061000
RATEAMT9 DS    PL5'0.'                                                  00062000
RATEPCT9 DS    PL5'0.000000000'                                         00063000
RATEAT10 DS    PL5'0.'                                                  00064000
RATEPT10 DS    PL5'0.000000000'                                         00065000
RATEAT11 DS    PL5'0.'                                                  00066000
RATEPT11 DS    PL5'0.000000000'                                         00067000
RATEAT12 DS    PL5'0.'                                                  00068000
RATEPT12 DS    PL5'0.000000000'                                         00069000
RATEAT13 DS    PL5'0.'                                                  00070000
RATEPT13 DS    PL5'0.000000000'                                         00071000
RATEAT14 DS    PL5'0.'                                                  00072000
RATEPT14 DS    PL5'0.000000000'                                         00073000
RATEAT15 DS    PL5'0.'                                                  00074000
RATEPT15 DS    PL5'0.000000000'                                         00075000
*                                                                       00076000
*                                                                       00077000
**********************************************************************  00078000
* PROGRAM TABLE HEADER SECTION:                                         00079000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00080000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00081000
**********************************************************************  00082000
*                                                                       00083000
S14IODB  CSECT                         PROGRAM TABLE SECTION            00084000
S14IODB  AMODE ANY                                                      00085000
S14IODB  RMODE ANY                                                      00086000
         DC    CL9'S14IODB'            PROGRAM ID                       00087000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00088000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00089000
         DC    A(0)                    RESERVED                         00090000
         DC    A(0)                    RESERVED                         00091000
         DC    24CL1' '                RESERVED                         00092000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00093000
*                                                                       00094000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00095000
         DC    CL29'WWW.INFOR.COM                '                      00095001
*                                                                       00096000
*                                                                       00097000
**********************************************************************  00098000
* STATEMENT TABLE SECTION:                                              00099000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00100000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00101000
*   SHOULD NOT BE MODIFIED.                                             00102000
**********************************************************************  00103000
*                                                                       00104000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00105000
STM#TAB  AMODE ANY                                                      00106000
STM#TAB  RMODE ANY                                                      00107000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00108000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00109000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00110000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00111000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00112000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00113000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00114000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00115000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00116000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00117000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00118000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00119000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00120000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00121000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00122000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00123000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00124000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00125000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00126000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00127000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00128000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00129000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00130000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00131000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00132000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00133000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00134000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00135000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00136000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00137000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00138000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00139000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00140000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00141000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00142000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00143000
         DC    A(SQL#0036)             INSERT STATEMENT                 00144000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00145000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00146000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00147000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00148000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00149000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00150000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00151000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00152000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00153000
         DC    4X'FF'                                                   00154000
*                                                                       00155000
*                                                                       00156000
**********************************************************************  00157000
* SQL STATEMENT SECTION:                                                00158000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00159000
*     TO SUPPORT THIS TABLE.                                            00160000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00161000
*     ARE EQUIVALENT.                                                   00162000
**********************************************************************  00163000
*                                                                       00164000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00165000
SQL#STMT AMODE ANY                                                      00166000
SQL#STMT RMODE ANY                                                      00167000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00168000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00169000
         USING COM#AREA,11             ADDRESS COMMAREA                 00170000
*                                                                       00171000
*                                                                       00172000
**********************************************************************  00173000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00174000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00175000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00176000
**********************************************************************  00177000
*                                                                       00178000
SQL#0000 DS    0H                                                       00179000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00180000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00181000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00182000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00183000
         EXEC  SQL                                                     *00184000
               SELECT AUDIT_DATE,                                      *00185000
                   AUDIT_TIME,                                         *00186000
                   AUDIT_USER,                                         *00187000
                   AUDIT_ORG,                                          *00188000
                   RATE_AMT_1,                                         *00189000
                   RATE_PCT_1,                                         *00190000
                   RATE_AMT_2,                                         *00191000
                   RATE_PCT_2,                                         *00192000
                   RATE_AMT_3,                                         *00193000
                   RATE_PCT_3,                                         *00194000
                   RATE_AMT_4,                                         *00195000
                   RATE_PCT_4,                                         *00196000
                   RATE_AMT_5,                                         *00197000
                   RATE_PCT_5,                                         *00198000
                   RATE_AMT_6,                                         *00199000
                   RATE_PCT_6,                                         *00200000
                   RATE_AMT_7,                                         *00201000
                   RATE_PCT_7,                                         *00202000
                   RATE_AMT_8,                                         *00203000
                   RATE_PCT_8,                                         *00204000
                   RATE_AMT_9,                                         *00205000
                   RATE_PCT_9,                                         *00206000
                   RATE_AMT_10,                                        *00207000
                   RATE_PCT_10,                                        *00208000
                   RATE_AMT_11,                                        *00209000
                   RATE_PCT_11,                                        *00210000
                   RATE_AMT_12,                                        *00211000
                   RATE_PCT_12,                                        *00212000
                   RATE_AMT_13,                                        *00213000
                   RATE_PCT_13,                                        *00214000
                   RATE_AMT_14,                                        *00215000
                   RATE_PCT_14,                                        *00216000
                   RATE_AMT_15,                                        *00217000
                   RATE_PCT_15                                         *00218000
                 INTO :AUDDATE,                                        *00219000
                   :AUDTIME,                                           *00220000
                   :AUDUSER,                                           *00221000
                   :AUDORG,                                            *00222000
                   :RATEAMT1,                                          *00223000
                   :RATEPCT1,                                          *00224000
                   :RATEAMT2,                                          *00225000
                   :RATEPCT2,                                          *00226000
                   :RATEAMT3,                                          *00227000
                   :RATEPCT3,                                          *00228000
                   :RATEAMT4,                                          *00229000
                   :RATEPCT4,                                          *00230000
                   :RATEAMT5,                                          *00231000
                   :RATEPCT5,                                          *00232000
                   :RATEAMT6,                                          *00233000
                   :RATEPCT6,                                          *00234000
                   :RATEAMT7,                                          *00235000
                   :RATEPCT7,                                          *00236000
                   :RATEAMT8,                                          *00237000
                   :RATEPCT8,                                          *00238000
                   :RATEAMT9,                                          *00239000
                   :RATEPCT9,                                          *00240000
                   :RATEAT10,                                          *00241000
                   :RATEPT10,                                          *00242000
                   :RATEAT11,                                          *00243000
                   :RATEPT11,                                          *00244000
                   :RATEAT12,                                          *00245000
                   :RATEPT12,                                          *00246000
                   :RATEAT13,                                          *00247000
                   :RATEPT13,                                          *00248000
                   :RATEAT14,                                          *00249000
                   :RATEPT14,                                          *00250000
                   :RATEAT15,                                          *00251000
                   :RATEPT15                                           *00252000
                 FROM S14                                              *00253000
                 WHERE INST_NBR = :INST AND                            *00254000
                   RECORD_NBR = :RECNBR AND                            *00255000
                   RATE_TABLE = :RATETABL AND                          *00256000
                   TERM = :TERM                                        *00257000
                 FETCH FIRST 1 ROW ONLY                                 00258000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00259000
         BALR  4,5                     MOVE INTO RECORD AREA            00260000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00261000
         BR    14                      RETURN TO CALLER                 00262000
         LTORG                                                          00263000
*                                                                       00264000
*                                                                       00265000
**********************************************************************  00266000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00267000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00268000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00269000
**********************************************************************  00270000
*                                                                       00271000
SQL#0001 DS    0H                                                       00272000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00273000
         LA    15,255                  SET RETURN CODE                  00274000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00275000
         BR    14                      RETURN TO CALLER                 00276000
         LTORG                                                          00277000
*                                                                       00278000
*                                                                       00279000
**********************************************************************  00280000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00281000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00282000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00283000
**********************************************************************  00284000
*                                                                       00285000
SQL#0002 DS    0H                                                       00286000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00287000
         LA    15,255                  SET RETURN CODE                  00288000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00289000
         BR    14                      RETURN TO CALLER                 00290000
         LTORG                                                          00291000
*                                                                       00292000
*                                                                       00293000
**********************************************************************  00294000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00295000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00296000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00297000
**********************************************************************  00298000
*                                                                       00299000
SQL#0003 DS    0H                                                       00300000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00301000
         LA    15,255                  SET RETURN CODE                  00302000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00303000
         BR    14                      RETURN TO CALLER                 00304000
         LTORG                                                          00305000
*                                                                       00306000
*                                                                       00307000
**********************************************************************  00308000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00309000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00310000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00311000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00312000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00313000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00314000
*     UPDATE STATEMENT TO MATCH.                                        00315000
**********************************************************************  00316000
*                                                                       00317000
SQL#0004 DS    0H                                                       00318000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00319000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00320000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00321000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00322000
         EXEC  SQL                                                     *00323000
               DECLARE S14UPD0 CURSOR FOR                              *00324000
               SELECT AUDIT_DATE,                                      *00325000
                   AUDIT_TIME,                                         *00326000
                   AUDIT_USER,                                         *00327000
                   AUDIT_ORG,                                          *00328000
                   RATE_AMT_1,                                         *00329000
                   RATE_PCT_1,                                         *00330000
                   RATE_AMT_2,                                         *00331000
                   RATE_PCT_2,                                         *00332000
                   RATE_AMT_3,                                         *00333000
                   RATE_PCT_3,                                         *00334000
                   RATE_AMT_4,                                         *00335000
                   RATE_PCT_4,                                         *00336000
                   RATE_AMT_5,                                         *00337000
                   RATE_PCT_5,                                         *00338000
                   RATE_AMT_6,                                         *00339000
                   RATE_PCT_6,                                         *00340000
                   RATE_AMT_7,                                         *00341000
                   RATE_PCT_7,                                         *00342000
                   RATE_AMT_8,                                         *00343000
                   RATE_PCT_8,                                         *00344000
                   RATE_AMT_9,                                         *00345000
                   RATE_PCT_9,                                         *00346000
                   RATE_AMT_10,                                        *00347000
                   RATE_PCT_10,                                        *00348000
                   RATE_AMT_11,                                        *00349000
                   RATE_PCT_11,                                        *00350000
                   RATE_AMT_12,                                        *00351000
                   RATE_PCT_12,                                        *00352000
                   RATE_AMT_13,                                        *00353000
                   RATE_PCT_13,                                        *00354000
                   RATE_AMT_14,                                        *00355000
                   RATE_PCT_14,                                        *00356000
                   RATE_AMT_15,                                        *00357000
                   RATE_PCT_15                                         *00358000
                 FROM S14                                              *00359000
                 WHERE INST_NBR = :INST AND                            *00360000
                   RECORD_NBR = :RECNBR AND                            *00361000
                   RATE_TABLE = :RATETABL AND                          *00362000
                   TERM = :TERM                                        *00363000
                 FOR UPDATE OF AUDIT_DATE,                             *00364000
                   AUDIT_TIME,                                         *00365000
                   AUDIT_USER,                                         *00366000
                   AUDIT_ORG,                                          *00367000
                   RATE_AMT_1,                                         *00368000
                   RATE_PCT_1,                                         *00369000
                   RATE_AMT_2,                                         *00370000
                   RATE_PCT_2,                                         *00371000
                   RATE_AMT_3,                                         *00372000
                   RATE_PCT_3,                                         *00373000
                   RATE_AMT_4,                                         *00374000
                   RATE_PCT_4,                                         *00375000
                   RATE_AMT_5,                                         *00376000
                   RATE_PCT_5,                                         *00377000
                   RATE_AMT_6,                                         *00378000
                   RATE_PCT_6,                                         *00379000
                   RATE_AMT_7,                                         *00380000
                   RATE_PCT_7,                                         *00381000
                   RATE_AMT_8,                                         *00382000
                   RATE_PCT_8,                                         *00383000
                   RATE_AMT_9,                                         *00384000
                   RATE_PCT_9,                                         *00385000
                   RATE_AMT_10,                                        *00386000
                   RATE_PCT_10,                                        *00387000
                   RATE_AMT_11,                                        *00388000
                   RATE_PCT_11,                                        *00389000
                   RATE_AMT_12,                                        *00390000
                   RATE_PCT_12,                                        *00391000
                   RATE_AMT_13,                                        *00392000
                   RATE_PCT_13,                                        *00393000
                   RATE_AMT_14,                                        *00394000
                   RATE_PCT_14,                                        *00395000
                   RATE_AMT_15,                                        *00396000
                   RATE_PCT_15                                         *00397000
                 FETCH FIRST 1 ROW ONLY                                 00398000
         EXEC  SQL                                                     *00399000
               OPEN S14UPD0                                             00400000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00401000
         BR    14                      RETURN TO CALLER                 00402000
         LTORG                                                          00403000
*                                                                       00404000
*                                                                       00405000
**********************************************************************  00406000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00407000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00408000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00409000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00410000
*     UPDATE STATEMENT TO MATCH.                                        00411000
**********************************************************************  00412000
*                                                                       00413000
SQL#0005 DS    0H                                                       00414000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00415000
         LA    15,255                  SET RETURN CODE                  00416000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00417000
         BR    14                      RETURN TO CALLER                 00418000
         LTORG                                                          00419000
*                                                                       00420000
*                                                                       00421000
**********************************************************************  00422000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00423000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00424000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00425000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00426000
*     UPDATE STATEMENT TO MATCH.                                        00427000
**********************************************************************  00428000
*                                                                       00429000
SQL#0006 DS    0H                                                       00430000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00431000
         LA    15,255                  SET RETURN CODE                  00432000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00433000
         BR    14                      RETURN TO CALLER                 00434000
         LTORG                                                          00435000
*                                                                       00436000
*                                                                       00437000
**********************************************************************  00438000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00439000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00440000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00441000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00442000
*     UPDATE STATEMENT TO MATCH.                                        00443000
**********************************************************************  00444000
*                                                                       00445000
SQL#0007 DS    0H                                                       00446000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00447000
         LA    15,255                  SET RETURN CODE                  00448000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00449000
         BR    14                      RETURN TO CALLER                 00450000
         LTORG                                                          00451000
*                                                                       00452000
*                                                                       00453000
**********************************************************************  00454000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00455000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00456000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00457000
*     THE ACTUAL ROW.                                                   00458000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00459000
**********************************************************************  00460000
*                                                                       00461000
SQL#0008 DS    0H                                                       00462000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00463000
         EXEC  SQL                                                     *00464000
               FETCH S14UPD0                                           *00465000
                 INTO :AUDDATE,                                        *00466000
                   :AUDTIME,                                           *00467000
                   :AUDUSER,                                           *00468000
                   :AUDORG,                                            *00469000
                   :RATEAMT1,                                          *00470000
                   :RATEPCT1,                                          *00471000
                   :RATEAMT2,                                          *00472000
                   :RATEPCT2,                                          *00473000
                   :RATEAMT3,                                          *00474000
                   :RATEPCT3,                                          *00475000
                   :RATEAMT4,                                          *00476000
                   :RATEPCT4,                                          *00477000
                   :RATEAMT5,                                          *00478000
                   :RATEPCT5,                                          *00479000
                   :RATEAMT6,                                          *00480000
                   :RATEPCT6,                                          *00481000
                   :RATEAMT7,                                          *00482000
                   :RATEPCT7,                                          *00483000
                   :RATEAMT8,                                          *00484000
                   :RATEPCT8,                                          *00485000
                   :RATEAMT9,                                          *00486000
                   :RATEPCT9,                                          *00487000
                   :RATEAT10,                                          *00488000
                   :RATEPT10,                                          *00489000
                   :RATEAT11,                                          *00490000
                   :RATEPT11,                                          *00491000
                   :RATEAT12,                                          *00492000
                   :RATEPT12,                                          *00493000
                   :RATEAT13,                                          *00494000
                   :RATEPT13,                                          *00495000
                   :RATEAT14,                                          *00496000
                   :RATEPT14,                                          *00497000
                   :RATEAT15,                                          *00498000
                   :RATEPT15                                            00499000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00500000
         BALR  4,5                     MOVE INTO RECORD AREA            00501000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00502000
         BR    14                      RETURN TO CALLER                 00503000
         LTORG                                                          00504000
*                                                                       00505000
*                                                                       00506000
**********************************************************************  00507000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00508000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00509000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00510000
*     THE ACTUAL ROW.                                                   00511000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00512000
**********************************************************************  00513000
*                                                                       00514000
SQL#0009 DS    0H                                                       00515000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00516000
         LA    15,255                  SET RETURN CODE                  00517000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00518000
         BR    14                      RETURN TO CALLER                 00519000
         LTORG                                                          00520000
*                                                                       00521000
*                                                                       00522000
**********************************************************************  00523000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00524000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00525000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00526000
*     THE ACTUAL ROW.                                                   00527000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00528000
**********************************************************************  00529000
*                                                                       00530000
SQL#0010 DS    0H                                                       00531000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00532000
         LA    15,255                  SET RETURN CODE                  00533000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00534000
         BR    14                      RETURN TO CALLER                 00535000
         LTORG                                                          00536000
*                                                                       00537000
*                                                                       00538000
**********************************************************************  00539000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00540000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00541000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00542000
*     THE ACTUAL ROW.                                                   00543000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00544000
**********************************************************************  00545000
*                                                                       00546000
SQL#0011 DS    0H                                                       00547000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00548000
         LA    15,255                  SET RETURN CODE                  00549000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00550000
         BR    14                      RETURN TO CALLER                 00551000
         LTORG                                                          00552000
*                                                                       00553000
*                                                                       00554000
**********************************************************************  00555000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00556000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00557000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00558000
*     TO CLOSE THE UPDATE CURSOR.                                       00559000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00560000
**********************************************************************  00561000
*                                                                       00562000
SQL#0012 DS    0H                                                       00563000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00564000
         EXEC  SQL                                                     *00565000
               CLOSE S14UPD0                                            00566000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00567000
         BR    14                      RETURN TO CALLER                 00568000
         LTORG                                                          00569000
*                                                                       00570000
*                                                                       00571000
**********************************************************************  00572000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00573000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00574000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00575000
*     TO CLOSE THE UPDATE CURSOR.                                       00576000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00577000
**********************************************************************  00578000
*                                                                       00579000
SQL#0013 DS    0H                                                       00580000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00581000
         LA    15,255                  SET RETURN CODE                  00582000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00583000
         BR    14                      RETURN TO CALLER                 00584000
         LTORG                                                          00585000
*                                                                       00586000
*                                                                       00587000
**********************************************************************  00588000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00589000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00590000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00591000
*     TO CLOSE THE UPDATE CURSOR.                                       00592000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00593000
**********************************************************************  00594000
*                                                                       00595000
SQL#0014 DS    0H                                                       00596000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00597000
         LA    15,255                  SET RETURN CODE                  00598000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00599000
         BR    14                      RETURN TO CALLER                 00600000
         LTORG                                                          00601000
*                                                                       00602000
*                                                                       00603000
**********************************************************************  00604000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00605000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00606000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00607000
*     TO CLOSE THE UPDATE CURSOR.                                       00608000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00609000
**********************************************************************  00610000
*                                                                       00611000
SQL#0015 DS    0H                                                       00612000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00613000
         LA    15,255                  SET RETURN CODE                  00614000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00615000
         BR    14                      RETURN TO CALLER                 00616000
         LTORG                                                          00617000
*                                                                       00618000
*                                                                       00619000
**********************************************************************  00620000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00621000
* KEY:                                                                  00622000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00623000
*     AND GET-NEXT-LOCK VERBS.                                          00624000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00625000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00626000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00627000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00628000
*     ORDER BY CLAUSE.                                                  00629000
**********************************************************************  00630000
*                                                                       00631000
SQL#0016 DS    0H                                                       00632000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00633000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00634000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00635000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00636000
         EXEC  SQL                                                     *00637000
               DECLARE S14SQ001 CURSOR FOR                             *00638000
               SELECT INST_NBR,                                        *00639000
                   RECORD_NBR,                                         *00640000
                   RATE_TABLE,                                         *00641000
                   TERM,                                               *00642000
                   AUDIT_DATE,                                         *00643000
                   AUDIT_TIME,                                         *00644000
                   AUDIT_USER,                                         *00645000
                   AUDIT_ORG,                                          *00646000
                   RATE_AMT_1,                                         *00647000
                   RATE_PCT_1,                                         *00648000
                   RATE_AMT_2,                                         *00649000
                   RATE_PCT_2,                                         *00650000
                   RATE_AMT_3,                                         *00651000
                   RATE_PCT_3,                                         *00652000
                   RATE_AMT_4,                                         *00653000
                   RATE_PCT_4,                                         *00654000
                   RATE_AMT_5,                                         *00655000
                   RATE_PCT_5,                                         *00656000
                   RATE_AMT_6,                                         *00657000
                   RATE_PCT_6,                                         *00658000
                   RATE_AMT_7,                                         *00659000
                   RATE_PCT_7,                                         *00660000
                   RATE_AMT_8,                                         *00661000
                   RATE_PCT_8,                                         *00662000
                   RATE_AMT_9,                                         *00663000
                   RATE_PCT_9,                                         *00664000
                   RATE_AMT_10,                                        *00665000
                   RATE_PCT_10,                                        *00666000
                   RATE_AMT_11,                                        *00667000
                   RATE_PCT_11,                                        *00668000
                   RATE_AMT_12,                                        *00669000
                   RATE_PCT_12,                                        *00670000
                   RATE_AMT_13,                                        *00671000
                   RATE_PCT_13,                                        *00672000
                   RATE_AMT_14,                                        *00673000
                   RATE_PCT_14,                                        *00674000
                   RATE_AMT_15,                                        *00675000
                   RATE_PCT_15                                         *00676000
                 FROM S14                                              *00677000
                 WHERE                                                 *00678000
                    INST_NBR = :INST AND                               *00679000
                    RECORD_NBR = :RECNBR AND                           *00680000
                    RATE_TABLE = :RATETABL AND                         *00681000
                    TERM >= :TERM                                      *00682000
                 ORDER BY TERM                                         *00683000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00684000
         EXEC  SQL                                                     *00685000
               OPEN S14SQ001                                            00686000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00687000
         BR    14                      RETURN TO CALLER                 00688000
         LTORG                                                          00689000
*                                                                       00690000
*                                                                       00691000
**********************************************************************  00692000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00693000
* KEY 1:                                                                00694000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00695000
*     AND GET-NEXT-LOCK VERBS.                                          00696000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00697000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00698000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00699000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00700000
*     ORDER BY CLAUSE.                                                  00701000
**********************************************************************  00702000
*                                                                       00703000
SQL#0017 DS    0H                                                       00704000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00705000
         LA    15,255                  SET RETURN CODE                  00706000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00707000
         BR    14                      RETURN TO CALLER                 00708000
         LTORG                                                          00709000
*                                                                       00710000
*                                                                       00711000
**********************************************************************  00712000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00713000
* KEY 2:                                                                00714000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00715000
*     AND GET-NEXT-LOCK VERBS.                                          00716000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00717000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00718000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00719000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00720000
*     ORDER BY CLAUSE.                                                  00721000
**********************************************************************  00722000
*                                                                       00723000
SQL#0018 DS    0H                                                       00724000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00725000
         LA    15,255                  SET RETURN CODE                  00726000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00727000
         BR    14                      RETURN TO CALLER                 00728000
         LTORG                                                          00729000
*                                                                       00730000
*                                                                       00731000
**********************************************************************  00732000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00733000
* KEY 3:                                                                00734000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00735000
*     AND GET-NEXT-LOCK VERBS.                                          00736000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00737000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00738000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00739000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00740000
*     ORDER BY CLAUSE.                                                  00741000
**********************************************************************  00742000
*                                                                       00743000
SQL#0019 DS    0H                                                       00744000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00745000
         LA    15,255                  SET RETURN CODE                  00746000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00747000
         BR    14                      RETURN TO CALLER                 00748000
         LTORG                                                          00749000
*                                                                       00750000
*                                                                       00751000
**********************************************************************  00752000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00753000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00754000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00755000
*     RETRIEVE THE ACTUAL ROW.                                          00756000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00757000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00758000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00759000
**********************************************************************  00760000
*                                                                       00761000
SQL#0020 DS    0H                                                       00762000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00763000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00764000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00765000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00766000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00767000
VECT0020 DC    A(SQL#0120)                                              00768000
         DC    A(SQL#0220)                                              00769000
         DC    A(SQL#0320)                                              00770000
         DC    A(SQL#0420)                                              00771000
         LTORG                                                          00772000
*                                                                       00773000
SQL#0120 DS    0H                                                       00774000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00775000
         EXEC  SQL                                                     *00776000
               FETCH S14SQ001                                          *00777000
                 INTO :INST,                                           *00778000
                      :RECNBR,                                         *00779000
                      :RATETABL,                                       *00780000
                      :TERM,                                           *00781000
                      :AUDDATE,                                        *00782000
                      :AUDTIME,                                        *00783000
                      :AUDUSER,                                        *00784000
                      :AUDORG,                                         *00785000
                      :RATEAMT1,                                       *00786000
                      :RATEPCT1,                                       *00787000
                      :RATEAMT2,                                       *00788000
                      :RATEPCT2,                                       *00789000
                      :RATEAMT3,                                       *00790000
                      :RATEPCT3,                                       *00791000
                      :RATEAMT4,                                       *00792000
                      :RATEPCT4,                                       *00793000
                      :RATEAMT5,                                       *00794000
                      :RATEPCT5,                                       *00795000
                      :RATEAMT6,                                       *00796000
                      :RATEPCT6,                                       *00797000
                      :RATEAMT7,                                       *00798000
                      :RATEPCT7,                                       *00799000
                      :RATEAMT8,                                       *00800000
                      :RATEPCT8,                                       *00801000
                      :RATEAMT9,                                       *00802000
                      :RATEPCT9,                                       *00803000
                      :RATEAT10,                                       *00804000
                      :RATEPT10,                                       *00805000
                      :RATEAT11,                                       *00806000
                      :RATEPT11,                                       *00807000
                      :RATEAT12,                                       *00808000
                      :RATEPT12,                                       *00809000
                      :RATEAT13,                                       *00810000
                      :RATEPT13,                                       *00811000
                      :RATEAT14,                                       *00812000
                      :RATEPT14,                                       *00813000
                      :RATEAT15,                                       *00814000
                      :RATEPT15                                         00815000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00816000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00817000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00818000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00819000
         BR    12                      OPEN NEXT CURSOR                 00820000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00821000
         BALR  4,5                     MOVE INTO RECORD AREA            00822000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00823000
         BR    14                      RETURN TO CALLER                 00824000
         LTORG                                                          00825000
*                                                                       00826000
SQL#0220 DS    0H                                                       00827000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00828000
         EXEC  SQL                                                     *00829000
               FETCH S14SQ002                                          *00830000
                 INTO :INST,                                           *00831000
                      :RECNBR,                                         *00832000
                      :RATETABL,                                       *00833000
                      :TERM,                                           *00834000
                      :AUDDATE,                                        *00835000
                      :AUDTIME,                                        *00836000
                      :AUDUSER,                                        *00837000
                      :AUDORG,                                         *00838000
                      :RATEAMT1,                                       *00839000
                      :RATEPCT1,                                       *00840000
                      :RATEAMT2,                                       *00841000
                      :RATEPCT2,                                       *00842000
                      :RATEAMT3,                                       *00843000
                      :RATEPCT3,                                       *00844000
                      :RATEAMT4,                                       *00845000
                      :RATEPCT4,                                       *00846000
                      :RATEAMT5,                                       *00847000
                      :RATEPCT5,                                       *00848000
                      :RATEAMT6,                                       *00849000
                      :RATEPCT6,                                       *00850000
                      :RATEAMT7,                                       *00851000
                      :RATEPCT7,                                       *00852000
                      :RATEAMT8,                                       *00853000
                      :RATEPCT8,                                       *00854000
                      :RATEAMT9,                                       *00855000
                      :RATEPCT9,                                       *00856000
                      :RATEAT10,                                       *00857000
                      :RATEPT10,                                       *00858000
                      :RATEAT11,                                       *00859000
                      :RATEPT11,                                       *00860000
                      :RATEAT12,                                       *00861000
                      :RATEPT12,                                       *00862000
                      :RATEAT13,                                       *00863000
                      :RATEPT13,                                       *00864000
                      :RATEAT14,                                       *00865000
                      :RATEPT14,                                       *00866000
                      :RATEAT15,                                       *00867000
                      :RATEPT15                                         00868000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00869000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00870000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00871000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00872000
         BR    12                      OPEN NEXT CURSOR                 00873000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00874000
         BALR  4,5                     MOVE INTO RECORD AREA            00875000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00876000
         BR    14                      RETURN TO CALLER                 00877000
         LTORG                                                          00878000
*                                                                       00879000
SQL#0320 DS    0H                                                       00880000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00881000
         EXEC  SQL                                                     *00882000
               FETCH S14SQ003                                          *00883000
                 INTO :INST,                                           *00884000
                      :RECNBR,                                         *00885000
                      :RATETABL,                                       *00886000
                      :TERM,                                           *00887000
                      :AUDDATE,                                        *00888000
                      :AUDTIME,                                        *00889000
                      :AUDUSER,                                        *00890000
                      :AUDORG,                                         *00891000
                      :RATEAMT1,                                       *00892000
                      :RATEPCT1,                                       *00893000
                      :RATEAMT2,                                       *00894000
                      :RATEPCT2,                                       *00895000
                      :RATEAMT3,                                       *00896000
                      :RATEPCT3,                                       *00897000
                      :RATEAMT4,                                       *00898000
                      :RATEPCT4,                                       *00899000
                      :RATEAMT5,                                       *00900000
                      :RATEPCT5,                                       *00901000
                      :RATEAMT6,                                       *00902000
                      :RATEPCT6,                                       *00903000
                      :RATEAMT7,                                       *00904000
                      :RATEPCT7,                                       *00905000
                      :RATEAMT8,                                       *00906000
                      :RATEPCT8,                                       *00907000
                      :RATEAMT9,                                       *00908000
                      :RATEPCT9,                                       *00909000
                      :RATEAT10,                                       *00910000
                      :RATEPT10,                                       *00911000
                      :RATEAT11,                                       *00912000
                      :RATEPT11,                                       *00913000
                      :RATEAT12,                                       *00914000
                      :RATEPT12,                                       *00915000
                      :RATEAT13,                                       *00916000
                      :RATEPT13,                                       *00917000
                      :RATEAT14,                                       *00918000
                      :RATEPT14,                                       *00919000
                      :RATEAT15,                                       *00920000
                      :RATEPT15                                         00921000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00922000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00923000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00924000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00925000
         BR    12                      OPEN NEXT CURSOR                 00926000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00927000
         BALR  4,5                     MOVE INTO RECORD AREA            00928000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00929000
         BR    14                      RETURN TO CALLER                 00930000
         LTORG                                                          00931000
*                                                                       00932000
SQL#0420 DS    0H                                                       00933000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          00934000
         EXEC  SQL                                                     *00935000
               FETCH S14SQ004                                          *00936000
                 INTO :INST,                                           *00937000
                      :RECNBR,                                         *00938000
                      :RATETABL,                                       *00939000
                      :TERM,                                           *00940000
                      :AUDDATE,                                        *00941000
                      :AUDTIME,                                        *00942000
                      :AUDUSER,                                        *00943000
                      :AUDORG,                                         *00944000
                      :RATEAMT1,                                       *00945000
                      :RATEPCT1,                                       *00946000
                      :RATEAMT2,                                       *00947000
                      :RATEPCT2,                                       *00948000
                      :RATEAMT3,                                       *00949000
                      :RATEPCT3,                                       *00950000
                      :RATEAMT4,                                       *00951000
                      :RATEPCT4,                                       *00952000
                      :RATEAMT5,                                       *00953000
                      :RATEPCT5,                                       *00954000
                      :RATEAMT6,                                       *00955000
                      :RATEPCT6,                                       *00956000
                      :RATEAMT7,                                       *00957000
                      :RATEPCT7,                                       *00958000
                      :RATEAMT8,                                       *00959000
                      :RATEPCT8,                                       *00960000
                      :RATEAMT9,                                       *00961000
                      :RATEPCT9,                                       *00962000
                      :RATEAT10,                                       *00963000
                      :RATEPT10,                                       *00964000
                      :RATEAT11,                                       *00965000
                      :RATEPT11,                                       *00966000
                      :RATEAT12,                                       *00967000
                      :RATEPT12,                                       *00968000
                      :RATEAT13,                                       *00969000
                      :RATEPT13,                                       *00970000
                      :RATEAT14,                                       *00971000
                      :RATEPT14,                                       *00972000
                      :RATEAT15,                                       *00973000
                      :RATEPT15                                         00974000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00975000
         BALR  4,5                     MOVE INTO RECORD AREA            00976000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00977000
         BR    14                      RETURN TO CALLER                 00978000
         LTORG                                                          00979000
*                                                                       00980000
*                                                                       00981000
**********************************************************************  00982000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00983000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00984000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00985000
*     RETRIEVE THE ACTUAL ROW.                                          00986000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00987000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00988000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00989000
**********************************************************************  00990000
*                                                                       00991000
SQL#0021 DS    0H                                                       00992000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00993000
         LA    15,255                  SET RETURN CODE                  00994000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00995000
         BR    14                      RETURN TO CALLER                 00996000
         LTORG                                                          00997000
*                                                                       00998000
*                                                                       00999000
**********************************************************************  01000000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01001000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01002000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01003000
*     RETRIEVE THE ACTUAL ROW.                                          01004000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01005000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01006000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01007000
**********************************************************************  01008000
*                                                                       01009000
SQL#0022 DS    0H                                                       01010000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01011000
         LA    15,255                  SET RETURN CODE                  01012000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01013000
         BR    14                      RETURN TO CALLER                 01014000
         LTORG                                                          01015000
*                                                                       01016000
*                                                                       01017000
**********************************************************************  01018000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01019000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01020000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01021000
*     RETRIEVE THE ACTUAL ROW.                                          01022000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01023000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01024000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01025000
**********************************************************************  01026000
*                                                                       01027000
SQL#0023 DS    0H                                                       01028000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01029000
         LA    15,255                  SET RETURN CODE                  01030000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01031000
         BR    14                      RETURN TO CALLER                 01032000
         LTORG                                                          01033000
*                                                                       01034000
*                                                                       01035000
**********************************************************************  01036000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01037000
* THE PRIMARY KEY:                                                      01038000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01039000
*     VERBS.                                                            01040000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01041000
*     RETRIEVE THE ACTUAL ROW.                                          01042000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01043000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01044000
*     WILL BE THRU THE UPDATE CURSOR.                                   01045000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01046000
**********************************************************************  01047000
*                                                                       01048000
SQL#0024 DS    0H                                                       01049000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01050000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01051000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01052000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01053000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01054000
VECT0024 DC    A(SQL#0124)                                              01055000
         DC    A(SQL#0224)                                              01056000
         DC    A(SQL#0324)                                              01057000
         DC    A(SQL#0424)                                              01058000
         LTORG                                                          01059000
*                                                                       01060000
SQL#0124 DS    0H                                                       01061000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01062000
         EXEC  SQL                                                     *01063000
               FETCH S14SQ001                                          *01064000
                 INTO :INST,                                           *01065000
                      :RECNBR,                                         *01066000
                      :RATETABL,                                       *01067000
                      :TERM                                             01068000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01069000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01070000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01071000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01072000
         BR    12                      OPEN NEXT CURSOR                 01073000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01074000
         BALR  4,5                     MOVE INTO RECORD AREA            01075000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01076000
         BR    14                      RETURN TO CALLER                 01077000
         LTORG                                                          01078000
*                                                                       01079000
SQL#0224 DS    0H                                                       01080000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01081000
         EXEC  SQL                                                     *01082000
               FETCH S14SQ002                                          *01083000
                 INTO :INST,                                           *01084000
                      :RECNBR,                                         *01085000
                      :RATETABL,                                       *01086000
                      :TERM                                             01087000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01088000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01089000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01090000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01091000
         BR    12                      OPEN NEXT CURSOR                 01092000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01093000
         BALR  4,5                     MOVE INTO RECORD AREA            01094000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01095000
         BR    14                      RETURN TO CALLER                 01096000
         LTORG                                                          01097000
*                                                                       01098000
SQL#0324 DS    0H                                                       01099000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01100000
         EXEC  SQL                                                     *01101000
               FETCH S14SQ003                                          *01102000
                 INTO :INST,                                           *01103000
                      :RECNBR,                                         *01104000
                      :RATETABL,                                       *01105000
                      :TERM                                             01106000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01107000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01108000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01109000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01110000
         BR    12                      OPEN NEXT CURSOR                 01111000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01112000
         BALR  4,5                     MOVE INTO RECORD AREA            01113000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01114000
         BR    14                      RETURN TO CALLER                 01115000
         LTORG                                                          01116000
*                                                                       01117000
SQL#0424 DS    0H                                                       01118000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          01119000
         EXEC  SQL                                                     *01120000
               FETCH S14SQ004                                          *01121000
                 INTO :INST,                                           *01122000
                      :RECNBR,                                         *01123000
                      :RATETABL,                                       *01124000
                      :TERM                                             01125000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01126000
         BALR  4,5                     MOVE INTO RECORD AREA            01127000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01128000
         BR    14                      RETURN TO CALLER                 01129000
         LTORG                                                          01130000
*                                                                       01131000
*                                                                       01132000
**********************************************************************  01133000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01134000
* ALTERNATE KEY 1:                                                      01135000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01136000
*     VERBS.                                                            01137000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01138000
*     RETRIEVE THE ACTUAL ROW.                                          01139000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01140000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01141000
*     WILL BE THRU THE UPDATE CURSOR.                                   01142000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01143000
**********************************************************************  01144000
*                                                                       01145000
SQL#0025 DS    0H                                                       01146000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01147000
         LA    15,255                  SET RETURN CODE                  01148000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01149000
         BR    14                      RETURN TO CALLER                 01150000
         LTORG                                                          01151000
*                                                                       01152000
*                                                                       01153000
**********************************************************************  01154000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01155000
* ALTERNATE KEY 2:                                                      01156000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01157000
*     VERBS.                                                            01158000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01159000
*     RETRIEVE THE ACTUAL ROW.                                          01160000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01161000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01162000
*     WILL BE THRU THE UPDATE CURSOR.                                   01163000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01164000
**********************************************************************  01165000
*                                                                       01166000
SQL#0026 DS    0H                                                       01167000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01168000
         LA    15,255                  SET RETURN CODE                  01169000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01170000
         BR    14                      RETURN TO CALLER                 01171000
         LTORG                                                          01172000
*                                                                       01173000
*                                                                       01174000
**********************************************************************  01175000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01176000
* ALTERNATE KEY 3:                                                      01177000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01178000
*     VERBS.                                                            01179000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01180000
*     RETRIEVE THE ACTUAL ROW.                                          01181000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01182000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01183000
*     WILL BE THRU THE UPDATE CURSOR.                                   01184000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01185000
**********************************************************************  01186000
*                                                                       01187000
SQL#0027 DS    0H                                                       01188000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01189000
         LA    15,255                  SET RETURN CODE                  01190000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01191000
         BR    14                      RETURN TO CALLER                 01192000
         LTORG                                                          01193000
*                                                                       01194000
*                                                                       01195000
**********************************************************************  01196000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01197000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01198000
*     AND GET-NEXT-LOCK VERBS.                                          01199000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01200000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01201000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01202000
**********************************************************************  01203000
*                                                                       01204000
SQL#0028 DS    0H                                                       01205000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01206000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01207000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01208000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01209000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01210000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01211000
VECT0028 DC    A(SQL#0128)                                              01212000
         DC    A(SQL#0228)                                              01213000
         DC    A(SQL#0328)                                              01214000
         DC    A(SQL#0428)                                              01215000
         LTORG                                                          01216000
*                                                                       01217000
SQL#0128 DS    0H                                                       01218000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01219000
         EXEC  SQL                                                     *01220000
               CLOSE S14SQ001                                           01221000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01222000
         BR    14                      RETURN TO CALLER                 01223000
         LTORG                                                          01224000
*                                                                       01225000
SQL#0228 DS    0H                                                       01226000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01227000
         EXEC  SQL                                                     *01228000
               CLOSE S14SQ002                                           01229000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01230000
         BR    14                      RETURN TO CALLER                 01231000
         LTORG                                                          01232000
*                                                                       01233000
SQL#0328 DS    0H                                                       01234000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01235000
         EXEC  SQL                                                     *01236000
               CLOSE S14SQ003                                           01237000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01238000
         BR    14                      RETURN TO CALLER                 01239000
         LTORG                                                          01240000
*                                                                       01241000
SQL#0428 DS    0H                                                       01242000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01243000
         EXEC  SQL                                                     *01244000
               CLOSE S14SQ004                                           01245000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01246000
         BR    14                      RETURN TO CALLER                 01247000
         LTORG                                                          01248000
*                                                                       01249000
*                                                                       01250000
**********************************************************************  01251000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01252000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01253000
*     AND GET-NEXT-LOCK VERBS.                                          01254000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01255000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01256000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01257000
**********************************************************************  01258000
*                                                                       01259000
SQL#0029 DS    0H                                                       01260000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01261000
         LA    15,255                  SET RETURN CODE                  01262000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01263000
         BR    14                      RETURN TO CALLER                 01264000
         LTORG                                                          01265000
*                                                                       01266000
*                                                                       01267000
**********************************************************************  01268000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01269000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01270000
*     AND GET-NEXT-LOCK VERBS.                                          01271000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01272000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01273000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01274000
**********************************************************************  01275000
*                                                                       01276000
SQL#0030 DS    0H                                                       01277000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01278000
         LA    15,255                  SET RETURN CODE                  01279000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01280000
         BR    14                      RETURN TO CALLER                 01281000
         LTORG                                                          01282000
*                                                                       01283000
*                                                                       01284000
**********************************************************************  01285000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01286000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01287000
*     AND GET-NEXT-LOCK VERBS.                                          01288000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01289000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01290000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01291000
**********************************************************************  01292000
*                                                                       01293000
SQL#0031 DS    0H                                                       01294000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01295000
         LA    15,255                  SET RETURN CODE                  01296000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01297000
         BR    14                      RETURN TO CALLER                 01298000
         LTORG                                                          01299000
*                                                                       01300000
*                                                                       01301000
**********************************************************************  01302000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01303000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01304000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01305000
**********************************************************************  01306000
*                                                                       01307000
SQL#0032 DS    0H                                                       01308000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01309000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01310000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01311000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01312000
         EXEC  SQL                                                     *01313000
               SELECT INST_NBR,                                        *01314000
                   RECORD_NBR,                                         *01315000
                   RATE_TABLE,                                         *01316000
                   TERM                                                *01317000
                 INTO :INST,                                           *01318000
                   :RECNBR,                                            *01319000
                   :RATETABL,                                          *01320000
                   :TERM                                               *01321000
                 FROM S14                                              *01322000
                 WHERE INST_NBR = :INST AND                            *01323000
                   RECORD_NBR = :RECNBR AND                            *01324000
                   RATE_TABLE = :RATETABL AND                          *01325000
                   TERM = :TERM                                        *01326000
                 FETCH FIRST 1 ROW ONLY                                 01327000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01328000
         BR    14                      RETURN TO CALLER                 01329000
         LTORG                                                          01330000
*                                                                       01331000
*                                                                       01332000
**********************************************************************  01333000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01334000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01335000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01336000
**********************************************************************  01337000
*                                                                       01338000
SQL#0033 DS    0H                                                       01339000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01340000
         LA    15,255                  SET RETURN CODE                  01341000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01342000
         BR    14                      RETURN TO CALLER                 01343000
         LTORG                                                          01344000
*                                                                       01345000
*                                                                       01346000
**********************************************************************  01347000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01348000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01349000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01350000
**********************************************************************  01351000
*                                                                       01352000
SQL#0034 DS    0H                                                       01353000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01354000
         LA    15,255                  SET RETURN CODE                  01355000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01356000
         BR    14                      RETURN TO CALLER                 01357000
         LTORG                                                          01358000
*                                                                       01359000
*                                                                       01360000
**********************************************************************  01361000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01362000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01363000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01364000
**********************************************************************  01365000
*                                                                       01366000
SQL#0035 DS    0H                                                       01367000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01368000
         LA    15,255                  SET RETURN CODE                  01369000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01370000
         BR    14                      RETURN TO CALLER                 01371000
         LTORG                                                          01372000
*                                                                       01373000
*                                                                       01374000
**********************************************************************  01375000
* INSERT STATEMENT:                                                     01376000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01377000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01378000
**********************************************************************  01379000
*                                                                       01380000
SQL#0036 DS    0H                                                       01381000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01382000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01383000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01384000
         EXEC  SQL                                                     *01385000
               INSERT INTO S14                                         *01386000
                   (INST_NBR,                                          *01387000
                    RECORD_NBR,                                        *01388000
                    RATE_TABLE,                                        *01389000
                    TERM,                                              *01390000
                    AUDIT_DATE,                                        *01391000
                    AUDIT_TIME,                                        *01392000
                    AUDIT_USER,                                        *01393000
                    AUDIT_ORG,                                         *01394000
                    RATE_AMT_1,                                        *01395000
                    RATE_PCT_1,                                        *01396000
                    RATE_AMT_2,                                        *01397000
                    RATE_PCT_2,                                        *01398000
                    RATE_AMT_3,                                        *01399000
                    RATE_PCT_3,                                        *01400000
                    RATE_AMT_4,                                        *01401000
                    RATE_PCT_4,                                        *01402000
                    RATE_AMT_5,                                        *01403000
                    RATE_PCT_5,                                        *01404000
                    RATE_AMT_6,                                        *01405000
                    RATE_PCT_6,                                        *01406000
                    RATE_AMT_7,                                        *01407000
                    RATE_PCT_7,                                        *01408000
                    RATE_AMT_8,                                        *01409000
                    RATE_PCT_8,                                        *01410000
                    RATE_AMT_9,                                        *01411000
                    RATE_PCT_9,                                        *01412000
                    RATE_AMT_10,                                       *01413000
                    RATE_PCT_10,                                       *01414000
                    RATE_AMT_11,                                       *01415000
                    RATE_PCT_11,                                       *01416000
                    RATE_AMT_12,                                       *01417000
                    RATE_PCT_12,                                       *01418000
                    RATE_AMT_13,                                       *01419000
                    RATE_PCT_13,                                       *01420000
                    RATE_AMT_14,                                       *01421000
                    RATE_PCT_14,                                       *01422000
                    RATE_AMT_15,                                       *01423000
                    RATE_PCT_15)                                       *01424000
                  VALUES (:INST,                                       *01425000
                   :RECNBR,                                            *01426000
                   :RATETABL,                                          *01427000
                   :TERM,                                              *01428000
                   :AUDDATE,                                           *01429000
                   :AUDTIME,                                           *01430000
                   :AUDUSER,                                           *01431000
                   :AUDORG,                                            *01432000
                   :RATEAMT1,                                          *01433000
                   :RATEPCT1,                                          *01434000
                   :RATEAMT2,                                          *01435000
                   :RATEPCT2,                                          *01436000
                   :RATEAMT3,                                          *01437000
                   :RATEPCT3,                                          *01438000
                   :RATEAMT4,                                          *01439000
                   :RATEPCT4,                                          *01440000
                   :RATEAMT5,                                          *01441000
                   :RATEPCT5,                                          *01442000
                   :RATEAMT6,                                          *01443000
                   :RATEPCT6,                                          *01444000
                   :RATEAMT7,                                          *01445000
                   :RATEPCT7,                                          *01446000
                   :RATEAMT8,                                          *01447000
                   :RATEPCT8,                                          *01448000
                   :RATEAMT9,                                          *01449000
                   :RATEPCT9,                                          *01450000
                   :RATEAT10,                                          *01451000
                   :RATEPT10,                                          *01452000
                   :RATEAT11,                                          *01453000
                   :RATEPT11,                                          *01454000
                   :RATEAT12,                                          *01455000
                   :RATEPT12,                                          *01456000
                   :RATEAT13,                                          *01457000
                   :RATEPT13,                                          *01458000
                   :RATEAT14,                                          *01459000
                   :RATEPT14,                                          *01460000
                   :RATEAT15,                                          *01461000
                   :RATEPT15)                                           01462000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01463000
         BR    14                      RETURN TO CALLER                 01464000
         LTORG                                                          01465000
*                                                                       01466000
*                                                                       01467000
**********************************************************************  01468000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01469000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01470000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01471000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01472000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01473000
*     STATEMENT.                                                        01474000
**********************************************************************  01475000
*                                                                       01476000
SQL#0037 DS    0H                                                       01477000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01478000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01479000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01480000
         EXEC  SQL                                                     *01481000
               UPDATE S14                                              *01482000
                   SET AUDIT_DATE = :AUDDATE,                          *01483000
                     AUDIT_TIME = :AUDTIME,                            *01484000
                     AUDIT_USER = :AUDUSER,                            *01485000
                     AUDIT_ORG = :AUDORG,                              *01486000
                     RATE_AMT_1 = :RATEAMT1,                           *01487000
                     RATE_PCT_1 = :RATEPCT1,                           *01488000
                     RATE_AMT_2 = :RATEAMT2,                           *01489000
                     RATE_PCT_2 = :RATEPCT2,                           *01490000
                     RATE_AMT_3 = :RATEAMT3,                           *01491000
                     RATE_PCT_3 = :RATEPCT3,                           *01492000
                     RATE_AMT_4 = :RATEAMT4,                           *01493000
                     RATE_PCT_4 = :RATEPCT4,                           *01494000
                     RATE_AMT_5 = :RATEAMT5,                           *01495000
                     RATE_PCT_5 = :RATEPCT5,                           *01496000
                     RATE_AMT_6 = :RATEAMT6,                           *01497000
                     RATE_PCT_6 = :RATEPCT6,                           *01498000
                     RATE_AMT_7 = :RATEAMT7,                           *01499000
                     RATE_PCT_7 = :RATEPCT7,                           *01500000
                     RATE_AMT_8 = :RATEAMT8,                           *01501000
                     RATE_PCT_8 = :RATEPCT8,                           *01502000
                     RATE_AMT_9 = :RATEAMT9,                           *01503000
                     RATE_PCT_9 = :RATEPCT9,                           *01504000
                     RATE_AMT_10 = :RATEAT10,                          *01505000
                     RATE_PCT_10 = :RATEPT10,                          *01506000
                     RATE_AMT_11 = :RATEAT11,                          *01507000
                     RATE_PCT_11 = :RATEPT11,                          *01508000
                     RATE_AMT_12 = :RATEAT12,                          *01509000
                     RATE_PCT_12 = :RATEPT12,                          *01510000
                     RATE_AMT_13 = :RATEAT13,                          *01511000
                     RATE_PCT_13 = :RATEPT13,                          *01512000
                     RATE_AMT_14 = :RATEAT14,                          *01513000
                     RATE_PCT_14 = :RATEPT14,                          *01514000
                     RATE_AMT_15 = :RATEAT15,                          *01515000
                     RATE_PCT_15 = :RATEPT15                           *01516000
                 WHERE CURRENT OF S14UPD0                               01517000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01518000
         BR    14                      RETURN TO CALLER                 01519000
         LTORG                                                          01520000
*                                                                       01521000
*                                                                       01522000
**********************************************************************  01523000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01524000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01525000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01526000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01527000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01528000
*     STATEMENT.                                                        01529000
**********************************************************************  01530000
*                                                                       01531000
SQL#0038 DS    0H                                                       01532000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01533000
         LA    15,255                  SET RETURN CODE                  01534000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01535000
         BR    14                      RETURN TO CALLER                 01536000
         LTORG                                                          01537000
*                                                                       01538000
*                                                                       01539000
**********************************************************************  01540000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01541000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01542000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01543000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01544000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01545000
*     STATEMENT.                                                        01546000
**********************************************************************  01547000
*                                                                       01548000
SQL#0039 DS    0H                                                       01549000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01550000
         LA    15,255                  SET RETURN CODE                  01551000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01552000
         BR    14                      RETURN TO CALLER                 01553000
         LTORG                                                          01554000
*                                                                       01555000
*                                                                       01556000
**********************************************************************  01557000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01558000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01559000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01560000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01561000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01562000
*     STATEMENT.                                                        01563000
**********************************************************************  01564000
*                                                                       01565000
SQL#0040 DS    0H                                                       01566000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01567000
         LA    15,255                  SET RETURN CODE                  01568000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01569000
         BR    14                      RETURN TO CALLER                 01570000
         LTORG                                                          01571000
*                                                                       01572000
*                                                                       01573000
**********************************************************************  01574000
* DELETE STATEMENT BY PRIMARY KEY:                                      01575000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01576000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01577000
**********************************************************************  01578000
*                                                                       01579000
SQL#0041 DS    0H                                                       01580000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01581000
         EXEC  SQL                                                     *01582000
               DELETE FROM S14                                         *01583000
                 WHERE CURRENT OF S14UPD0                               01584000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01585000
         BR    14                      RETURN TO CALLER                 01586000
         LTORG                                                          01587000
*                                                                       01588000
*                                                                       01589000
**********************************************************************  01590000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01591000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01592000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01593000
**********************************************************************  01594000
*                                                                       01595000
SQL#0042 DS    0H                                                       01596000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01597000
         LA    15,255                  SET RETURN CODE                  01598000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01599000
         BR    14                      RETURN TO CALLER                 01600000
         LTORG                                                          01601000
*                                                                       01602000
*                                                                       01603000
**********************************************************************  01604000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01605000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01606000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01607000
**********************************************************************  01608000
*                                                                       01609000
SQL#0043 DS    0H                                                       01610000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01611000
         LA    15,255                  SET RETURN CODE                  01612000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01613000
         BR    14                      RETURN TO CALLER                 01614000
         LTORG                                                          01615000
*                                                                       01616000
*                                                                       01617000
**********************************************************************  01618000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01619000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01620000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01621000
**********************************************************************  01622000
*                                                                       01623000
SQL#0044 DS    0H                                                       01624000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01625000
         LA    15,255                  SET RETURN CODE                  01626000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01627000
         BR    14                      RETURN TO CALLER                 01628000
         LTORG                                                          01629000
*                                                                       01630000
*                                                                       01631000
**********************************************************************  01632000
* DELETE ALL STATEMENT:                                                 01633000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01634000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01635000
**********************************************************************  01636000
*                                                                       01637000
SQL#0045 DS    0H                                                       01638000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01639000
         EXEC  SQL                                                     *01640000
               DELETE FROM S14                                          01641000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01642000
         BR    14                      RETURN TO CALLER                 01643000
         LTORG                                                          01644000
*                                                                       01645000
*                                                                       01646000
**********************************************************************  01647000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01648000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01649000
**********************************************************************  01650000
*                                                                       01651000
SQL#0046 DS    0H                                                       01652000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01653000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01654000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01655000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01656000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01657000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01658000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01659000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01660000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01661000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01662000
VECT0046 DC    A(0)                                                     01663000
         DC    A(SQL#0246)                                              01664000
         DC    A(SQL#0346)                                              01665000
         DC    A(SQL#0446)                                              01666000
         LTORG                                                          01667000
*                                                                       01668000
SQL#0246 DS    0H                                                       01669000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01670000
         EXEC  SQL                                                     *01671000
               CLOSE S14SQ001                                           01672000
         EXEC  SQL                                                     *01673000
               DECLARE S14SQ002 CURSOR FOR                             *01674000
               SELECT INST_NBR,                                        *01675000
                   RECORD_NBR,                                         *01676000
                   RATE_TABLE,                                         *01677000
                   TERM,                                               *01678000
                   AUDIT_DATE,                                         *01679000
                   AUDIT_TIME,                                         *01680000
                   AUDIT_USER,                                         *01681000
                   AUDIT_ORG,                                          *01682000
                   RATE_AMT_1,                                         *01683000
                   RATE_PCT_1,                                         *01684000
                   RATE_AMT_2,                                         *01685000
                   RATE_PCT_2,                                         *01686000
                   RATE_AMT_3,                                         *01687000
                   RATE_PCT_3,                                         *01688000
                   RATE_AMT_4,                                         *01689000
                   RATE_PCT_4,                                         *01690000
                   RATE_AMT_5,                                         *01691000
                   RATE_PCT_5,                                         *01692000
                   RATE_AMT_6,                                         *01693000
                   RATE_PCT_6,                                         *01694000
                   RATE_AMT_7,                                         *01695000
                   RATE_PCT_7,                                         *01696000
                   RATE_AMT_8,                                         *01697000
                   RATE_PCT_8,                                         *01698000
                   RATE_AMT_9,                                         *01699000
                   RATE_PCT_9,                                         *01700000
                   RATE_AMT_10,                                        *01701000
                   RATE_PCT_10,                                        *01702000
                   RATE_AMT_11,                                        *01703000
                   RATE_PCT_11,                                        *01704000
                   RATE_AMT_12,                                        *01705000
                   RATE_PCT_12,                                        *01706000
                   RATE_AMT_13,                                        *01707000
                   RATE_PCT_13,                                        *01708000
                   RATE_AMT_14,                                        *01709000
                   RATE_PCT_14,                                        *01710000
                   RATE_AMT_15,                                        *01711000
                   RATE_PCT_15                                         *01712000
                 FROM S14                                              *01713000
                 WHERE                                                 *01714000
                    INST_NBR = :INST AND                               *01715000
                    RECORD_NBR = :RECNBR AND                           *01716000
                    RATE_TABLE > :RATETABL                             *01717000
                 ORDER BY RATE_TABLE,                                  *01718000
                   TERM                                                *01719000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01720000
         EXEC  SQL                                                     *01721000
               OPEN S14SQ002                                            01722000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01723000
         BNZ   *+8                     NO - RETURN ERROR                01724000
         LR    12,9                    LOAD RETURN ADDRESS              01725000
         BR    12                      RETURN TO FETCH ROUTINE          01726000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01727000
         BR    14                      RETURN TO CALLER                 01728000
         LTORG                                                          01729000
*                                                                       01730000
SQL#0346 DS    0H                                                       01731000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01732000
         EXEC  SQL                                                     *01733000
               CLOSE S14SQ002                                           01734000
         EXEC  SQL                                                     *01735000
               DECLARE S14SQ003 CURSOR FOR                             *01736000
               SELECT INST_NBR,                                        *01737000
                   RECORD_NBR,                                         *01738000
                   RATE_TABLE,                                         *01739000
                   TERM,                                               *01740000
                   AUDIT_DATE,                                         *01741000
                   AUDIT_TIME,                                         *01742000
                   AUDIT_USER,                                         *01743000
                   AUDIT_ORG,                                          *01744000
                   RATE_AMT_1,                                         *01745000
                   RATE_PCT_1,                                         *01746000
                   RATE_AMT_2,                                         *01747000
                   RATE_PCT_2,                                         *01748000
                   RATE_AMT_3,                                         *01749000
                   RATE_PCT_3,                                         *01750000
                   RATE_AMT_4,                                         *01751000
                   RATE_PCT_4,                                         *01752000
                   RATE_AMT_5,                                         *01753000
                   RATE_PCT_5,                                         *01754000
                   RATE_AMT_6,                                         *01755000
                   RATE_PCT_6,                                         *01756000
                   RATE_AMT_7,                                         *01757000
                   RATE_PCT_7,                                         *01758000
                   RATE_AMT_8,                                         *01759000
                   RATE_PCT_8,                                         *01760000
                   RATE_AMT_9,                                         *01761000
                   RATE_PCT_9,                                         *01762000
                   RATE_AMT_10,                                        *01763000
                   RATE_PCT_10,                                        *01764000
                   RATE_AMT_11,                                        *01765000
                   RATE_PCT_11,                                        *01766000
                   RATE_AMT_12,                                        *01767000
                   RATE_PCT_12,                                        *01768000
                   RATE_AMT_13,                                        *01769000
                   RATE_PCT_13,                                        *01770000
                   RATE_AMT_14,                                        *01771000
                   RATE_PCT_14,                                        *01772000
                   RATE_AMT_15,                                        *01773000
                   RATE_PCT_15                                         *01774000
                 FROM S14                                              *01775000
                 WHERE                                                 *01776000
                    INST_NBR = :INST AND                               *01777000
                    RECORD_NBR > :RECNBR                               *01778000
                 ORDER BY RECORD_NBR,                                  *01779000
                   RATE_TABLE,                                         *01780000
                   TERM                                                *01781000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01782000
         EXEC  SQL                                                     *01783000
               OPEN S14SQ003                                            01784000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01785000
         BNZ   *+8                     NO - RETURN ERROR                01786000
         LR    12,9                    LOAD RETURN ADDRESS              01787000
         BR    12                      RETURN TO FETCH ROUTINE          01788000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01789000
         BR    14                      RETURN TO CALLER                 01790000
         LTORG                                                          01791000
*                                                                       01792000
SQL#0446 DS    0H                                                       01793000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          01794000
         EXEC  SQL                                                     *01795000
               CLOSE S14SQ003                                           01796000
         EXEC  SQL                                                     *01797000
               DECLARE S14SQ004 CURSOR FOR                             *01798000
               SELECT INST_NBR,                                        *01799000
                   RECORD_NBR,                                         *01800000
                   RATE_TABLE,                                         *01801000
                   TERM,                                               *01802000
                   AUDIT_DATE,                                         *01803000
                   AUDIT_TIME,                                         *01804000
                   AUDIT_USER,                                         *01805000
                   AUDIT_ORG,                                          *01806000
                   RATE_AMT_1,                                         *01807000
                   RATE_PCT_1,                                         *01808000
                   RATE_AMT_2,                                         *01809000
                   RATE_PCT_2,                                         *01810000
                   RATE_AMT_3,                                         *01811000
                   RATE_PCT_3,                                         *01812000
                   RATE_AMT_4,                                         *01813000
                   RATE_PCT_4,                                         *01814000
                   RATE_AMT_5,                                         *01815000
                   RATE_PCT_5,                                         *01816000
                   RATE_AMT_6,                                         *01817000
                   RATE_PCT_6,                                         *01818000
                   RATE_AMT_7,                                         *01819000
                   RATE_PCT_7,                                         *01820000
                   RATE_AMT_8,                                         *01821000
                   RATE_PCT_8,                                         *01822000
                   RATE_AMT_9,                                         *01823000
                   RATE_PCT_9,                                         *01824000
                   RATE_AMT_10,                                        *01825000
                   RATE_PCT_10,                                        *01826000
                   RATE_AMT_11,                                        *01827000
                   RATE_PCT_11,                                        *01828000
                   RATE_AMT_12,                                        *01829000
                   RATE_PCT_12,                                        *01830000
                   RATE_AMT_13,                                        *01831000
                   RATE_PCT_13,                                        *01832000
                   RATE_AMT_14,                                        *01833000
                   RATE_PCT_14,                                        *01834000
                   RATE_AMT_15,                                        *01835000
                   RATE_PCT_15                                         *01836000
                 FROM S14                                              *01837000
                 WHERE                                                 *01838000
                    INST_NBR > :INST                                   *01839000
                 ORDER BY INST_NBR,                                    *01840000
                   RECORD_NBR,                                         *01841000
                   RATE_TABLE,                                         *01842000
                   TERM                                                *01843000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01844000
         EXEC  SQL                                                     *01845000
               OPEN S14SQ004                                            01846000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01847000
         BNZ   *+8                     NO - RETURN ERROR                01848000
         LR    12,9                    LOAD RETURN ADDRESS              01849000
         BR    12                      RETURN TO FETCH ROUTINE          01850000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01851000
         BR    14                      RETURN TO CALLER                 01852000
         LTORG                                                          01853000
*                                                                       01854000
*                                                                       01855000
**********************************************************************  01856000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01857000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01858000
**********************************************************************  01859000
*                                                                       01860000
SQL#0047 DS    0H                                                       01861000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01862000
         LA    15,255                  SET RETURN CODE                  01863000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01864000
         BR    14                      RETURN TO CALLER                 01865000
         LTORG                                                          01866000
*                                                                       01867000
*                                                                       01868000
**********************************************************************  01869000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01870000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01871000
**********************************************************************  01872000
*                                                                       01873000
SQL#0048 DS    0H                                                       01874000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01875000
         LA    15,255                  SET RETURN CODE                  01876000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01877000
         BR    14                      RETURN TO CALLER                 01878000
         LTORG                                                          01879000
*                                                                       01880000
*                                                                       01881000
**********************************************************************  01882000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01883000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01884000
**********************************************************************  01885000
*                                                                       01886000
SQL#0049 DS    0H                                                       01887000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01888000
         LA    15,255                  SET RETURN CODE                  01889000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01890000
         BR    14                      RETURN TO CALLER                 01891000
         LTORG                                                          01892000
*                                                                       01893000
         DS    0H                      END OF SQL STATEMENTS            01894000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01895000
*                                                                       01896000
*                                                                       01897000
**********************************************************************  01898000
* DUMMY ENTRY POINT DSNHLI                                              01899000
*   MUST NOT BE MODIFIED.                                               01900000
**********************************************************************  01901000
*                                                                       01902000
         ENTRY DSNHLI                                                   01903000
DSNHLI   DS    0H                                                       01904000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01905000
         BR    15                      BRANCH TO ATTACH FACILITY        01906000
*                                                                       01907000
*                                                                       01908000
**********************************************************************  01909000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01910000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01911000
*   MUST NOT BE MODIFIED.                                               01912000
**********************************************************************  01913000
*                                                                       01914000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01915000
CONV#RTN AMODE ANY                                                      01916000
CONV#RTN RMODE ANY                                                      01917000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01918000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01919000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01920000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01921000
         BER   4                         YES - RETURN TO SQL            01922000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01923000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01924000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01925000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01926000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01927000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01928000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01929000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01930000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01931000
*                                                                       01932000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01933000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01934000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01935000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01936000
         BER   4                         YES - RETURN TO SQL            01937000
         SLR   0,0                     CLEAR FOR INSERT                 01938000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01939000
         NR    0,3                     FOR THE CURRENT KEY?             01940000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01941000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01942000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01943000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01944000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01945000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01946000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01947000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01948000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01949000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01950000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01951000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01952000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01953000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01954000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01955000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01956000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01957000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01958000
*                                                                       01959000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01960000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01961000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01962000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01963000
         BER   4                         YES - RETURN TO SQL            01964000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01965000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01966000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01967000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01968000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01969000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01970000
         MVCL  0,14                    MOVE TO RECORD AREA              01971000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01972000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01973000
*                                                                       01974000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01975000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01976000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01977000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01978000
         BER   4                         YES - RETURN TO SQL            01979000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01980000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01981000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01982000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01983000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01984000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01985000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01986000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01987000
         MVCL  0,14                    MOVE TO RECORD AREA              01988000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01989000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01990000
*                                                                       01991000
*                                                                       01992000
**********************************************************************  01993000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01994000
*   MUST NOT BE MODIFIED.                                               01995000
**********************************************************************  01996000
*                                                                       01997000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01998000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01999000
         DC    H'0019'                 LENGTH TO MOVE                   02000000
         DC    X'80'                   80 = KEY 0 FIELD                 02001000
*                                      40 = KEY 1 FIELD                 02002000
*                                      20 = KEY 2 FIELD                 02003000
*                                      10 = KEY 3 FIELD                 02004000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02005000
*                                                                       02006000
*                                      REST OF FIELD ENTRIES            02007000
         DC    H'0019',H'0019',H'0174',X'00',X'00'                      02008000
         DC    8X'FF'                  END OF FIELD ENTRIES             02009000
         LTORG                                                          02010000
         END                                                            02011000
