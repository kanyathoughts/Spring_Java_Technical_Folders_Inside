**********************************************************************  00001000
*                                                                       00002000
*  SAMRDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/27/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAM TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST1    DS    CL4                                                      00050000
PRDCDE1  DS    CL6                                                      00051000
ACCTNBR1 DS    CL18                                                     00052000
EVNTDATE DS    CL8                                                      00053000
INST2    DS    CL4                                                      00054000
PRDCDE2  DS    CL6                                                      00055000
ACCTNBR2 DS    CL18                                                     00056000
MODEL2   DS    CL10                                                     00057000
RECSEQ   DS    CL3                                                      00058000
AUDDATE  DS    PL5'0.'                                                  00059000
AUDTIME  DS    PL5'0.'                                                  00060000
AUDUSER  DS    CL8                                                      00061000
AUDORG   DS    CL6                                                      00062000
EVTCODE  DS    CL2                                                      00063000
SCINCENO DS    CL1                                                      00064000
INCENQ   DS    CL1                                                      00065000
DISCAMT  DS    PL6'0.00'                                                00066000
DISCPCT  DS    PL3'0.00000'                                             00067000
RINCENO  DS    CL1                                                      00068000
RINCENQ  DS    CL1                                                      00069000
RATOPT   DS    CL1                                                      00070000
RATTYP   DS    CL1                                                      00071000
RATEPCT  DS    PL5'0.000000000'                                         00072000
MSGNBR   DS    CL4                                                      00073000
IDNBR    DS    CL18                                                     00074000
MODULE   DS    CL8                                                      00075000
RAREA    DS    CL11                                                     00076000
*                                                                       00077000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00078000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00079000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00080000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00081000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00082000
         DS    CL97                    RESERVED                         00083000
*                                                                       00084000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00085000
INDVARX  DS    0H                                                       00086000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00087000
*                                                                       00088000
*                                                                       00089000
**********************************************************************  00090000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00091000
**********************************************************************  00092000
*                                                                       00093000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00094000
*                                                                       00095000
**********************************************************************  00096000
* PROGRAM TABLE HEADER SECTION:                                         00097000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00098000
**********************************************************************  00099000
*                                                                       00100000
SAMRDB   CSECT                         PROGRAM TABLE SECTION            00101000
SAMRDB   AMODE ANY                                                      00102000
SAMRDB   RMODE ANY                                                      00103000
         DC    CL8'SAMRDB  '           PROGRAM ID                       00104000
         DC    CL1' '                                                   00105000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00106000
         DC    CL1' '                                                   00107000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00108000
         DC    CL1' '                                                   00109000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00110000
         DC    5A(0)                   RESERVED                         00111000
         DC    AL2(0)                  RESERVED                         00112000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00113000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00114000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00115000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00116000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00117000
         DC    CL29'WWW.INFOR.COM                '                      00117001
*                                                                       00118000
**********************************************************************  00119000
* STATEMENT TABLE SECTION:                                              00120000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00121000
**********************************************************************  00122000
*                                                                       00123000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00124000
STM#TAB  AMODE ANY                                                      00125000
STM#TAB  RMODE ANY                                                      00126000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00127000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00128000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00129000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00130000
         DC    12A(0)                  UDB MODULE VECTORS               00131000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00132000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00133000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00134000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00135000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00136000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00137000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00138000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00139000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00140000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00141000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00142000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00143000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00144000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00145000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00146000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00147000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00148000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00149000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00150000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00151000
         DC    10A(0)                  UDB MODULE VECTORS               00152000
         DC    4X'FF'                                                   00153000
*                                                                       00154000
**********************************************************************  00155000
* SQL STATEMENT SECTION:                                                00156000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00157000
*     TO SUPPORT THIS TABLE.                                            00158000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00159000
*     ARE EQUIVALENT.                                                   00160000
**********************************************************************  00161000
*                                                                       00162000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00163000
SQL#STMT AMODE ANY                                                      00164000
SQL#STMT RMODE ANY                                                      00165000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00166000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00167000
         USING COM#AREA,11             ADDRESS COMMAREA                 00168000
*                                                                       00169000
**********************************************************************  00170000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00171000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00172000
**********************************************************************  00173000
*                                                                       00174000
SELIN0   DS    0H                                                       00175000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00176000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00177000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00178000
         BALR  14,15                   MOVE REQUESTED DATA              00179000
         EXEC  SQL SELECT                                              *00180000
                   AUDIT_DATE,                                         *00181000
                   AUDIT_TIME,                                         *00182000
                   AUDIT_USER,                                         *00183000
                   AUDIT_ORG,                                          *00184000
                   EVENT_CODE,                                         *00185000
                   SVC_INCEN_OPT,                                      *00186000
                   SVC_INCEN_QLFY,                                     *00187000
                   DISC_AMT,                                           *00188000
                   DISC_PERCENT,                                       *00189000
                   RATE_INCEN_OPT,                                     *00190000
                   RATE_INCEN_QLFY,                                    *00191000
                   RATE_OPTION,                                        *00192000
                   RATE_TYPE,                                          *00193000
                   RATE_PCT,                                           *00194000
                   MESSAGE_NBR,                                        *00195000
                   IDENT_NBR,                                          *00196000
                   MODULE,                                             *00197000
                   RSV_AREA                                            *00198000
                 INTO                                                  *00199000
                   :AUDDATE,                                           *00200000
                   :AUDTIME,                                           *00201000
                   :AUDUSER,                                           *00202000
                   :AUDORG,                                            *00203000
                   :EVTCODE,                                           *00204000
                   :SCINCENO,                                          *00205000
                   :INCENQ,                                            *00206000
                   :DISCAMT,                                           *00207000
                   :DISCPCT,                                           *00208000
                   :RINCENO,                                           *00209000
                   :RINCENQ,                                           *00210000
                   :RATOPT,                                            *00211000
                   :RATTYP,                                            *00212000
                   :RATEPCT,                                           *00213000
                   :MSGNBR,                                            *00214000
                   :IDNBR,                                             *00215000
                   :MODULE,                                            *00216000
                   :RAREA                                              *00217000
                 FROM SAM                                              *00218000
                 WHERE                                                 *00219000
                   ACCT_INST_1 = :INST1 AND                            *00220000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00221000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00222000
                   EVENT_DATE = :EVNTDATE AND                          *00223000
                   ACCT_INST_2 = :INST2 AND                            *00224000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00225000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00226000
                   MODEL_2 = :MODEL2 AND                               *00227000
                   RECORD_SEQ = :RECSEQ                                *00228000
                 FETCH FIRST 1 ROW ONLY                                 00229000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00230000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00231000
         BALR  14,15                   MOVE REQUESTED DATA              00232000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00233000
         BR    14                      RETURN TO CALLER                 00234000
         LTORG                                                          00235000
*                                                                       00236000
**********************************************************************  00237000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00238000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00239000
**********************************************************************  00240000
*                                                                       00241000
SELKY0   DS    0H                                                       00242000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00243000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00244000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00245000
         BALR  14,15                   MOVE REQUESTED DATA              00246000
         EXEC  SQL SELECT                                              *00247000
                   COUNT(*)                                            *00248000
                 INTO                                                  *00249000
                   :SQWINTHV                                           *00250000
                 FROM SAM                                              *00251000
                 WHERE                                                 *00252000
                   ACCT_INST_1 = :INST1 AND                            *00253000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00254000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00255000
                   EVENT_DATE = :EVNTDATE AND                          *00256000
                   ACCT_INST_2 = :INST2 AND                            *00257000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00258000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00259000
                   MODEL_2 = :MODEL2 AND                               *00260000
                   RECORD_SEQ = :RECSEQ                                *00261000
                 FETCH FIRST 1 ROW ONLY                                 00262000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00263000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00264000
         BNER  14                      NO - RETURN TO CALLER            00265000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00266000
         BNER  14                      YES - RETURN ZERO SQLCODE        00267000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00268000
         BR    14                      RETURN TO CALLER                 00269000
         LTORG                                                          00270000
*                                                                       00271000
**********************************************************************  00272000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00273000
* KEY:                                                                  00274000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00275000
*     AND GET-NEXT-LOCK VERBS.                                          00276000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00277000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00278000
**********************************************************************  00279000
*                                                                       00280000
SELXC0   DS    0H                                                       00281000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00282000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00283000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00284000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00285000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00286000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00287000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00288000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00289000
SELXC0P  DC    A(SELGE001)                                              00290000
         DC    (KY0COLMS-01)A(0)                                        00291000
         DC    A(SELGE002)                                              00292000
         DC    (KY0COLMS-02)A(0)                                        00293000
         DC    A(SELGE003)                                              00294000
         DC    (KY0COLMS-03)A(0)                                        00295000
         DC    A(SELGE004)                                              00296000
         DC    (KY0COLMS-04)A(0)                                        00297000
         DC    A(SELGE005)                                              00298000
         DC    (KY0COLMS-05)A(0)                                        00299000
         DC    A(SELGE006)                                              00300000
         DC    (KY0COLMS-06)A(0)                                        00301000
         DC    A(SELGE007)                                              00302000
         DC    (KY0COLMS-07)A(0)                                        00303000
         DC    A(SELGE008)                                              00304000
         DC    (KY0COLMS-08)A(0)                                        00305000
         DC    A(SELGE009)                                              00306000
         LTORG                                                          00307000
*                                                                       00308000
SELGE001 DS    0H                                                       00309000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00310000
         EXEC  SQL DECLARE SAMGE001 CURSOR                             *00311000
               WITH ROWSET POSITIONING                                 *00312000
               FOR SELECT                                              *00313000
                   ACCT_INST_1,                                        *00314000
                   PROD_CODE_1,                                        *00315000
                   ACCT_NBR_1,                                         *00316000
                   EVENT_DATE,                                         *00317000
                   ACCT_INST_2,                                        *00318000
                   PROD_CODE_2,                                        *00319000
                   ACCT_NBR_2,                                         *00320000
                   MODEL_2,                                            *00321000
                   RECORD_SEQ,                                         *00322000
                   AUDIT_DATE,                                         *00323000
                   AUDIT_TIME,                                         *00324000
                   AUDIT_USER,                                         *00325000
                   AUDIT_ORG,                                          *00326000
                   EVENT_CODE,                                         *00327000
                   SVC_INCEN_OPT,                                      *00328000
                   SVC_INCEN_QLFY,                                     *00329000
                   DISC_AMT,                                           *00330000
                   DISC_PERCENT,                                       *00331000
                   RATE_INCEN_OPT,                                     *00332000
                   RATE_INCEN_QLFY,                                    *00333000
                   RATE_OPTION,                                        *00334000
                   RATE_TYPE,                                          *00335000
                   RATE_PCT,                                           *00336000
                   MESSAGE_NBR,                                        *00337000
                   IDENT_NBR,                                          *00338000
                   MODULE,                                             *00339000
                   RSV_AREA                                            *00340000
                 FROM SAM                                              *00341000
                 WHERE                                                 *00342000
                   ACCT_INST_1 = :INST1 AND                            *00343000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00344000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00345000
                   EVENT_DATE = :EVNTDATE AND                          *00346000
                   ACCT_INST_2 = :INST2 AND                            *00347000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00348000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00349000
                   MODEL_2 = :MODEL2 AND                               *00350000
                   RECORD_SEQ >=                                       *00351000
                     :RECSEQ                                           *00352000
                 ORDER BY RECORD_SEQ ASC                               *00353000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00354000
         EXEC  SQL OPEN SAMGE001                                        00355000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00356000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00357000
         BR    14                      RETURN TO CALLER                 00358000
         LTORG                                                          00359000
*                                                                       00360000
SELGE002 DS    0H                                                       00361000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00362000
         EXEC  SQL DECLARE SAMGE002 CURSOR                             *00363000
               WITH ROWSET POSITIONING                                 *00364000
               FOR SELECT                                              *00365000
                   ACCT_INST_1,                                        *00366000
                   PROD_CODE_1,                                        *00367000
                   ACCT_NBR_1,                                         *00368000
                   EVENT_DATE,                                         *00369000
                   ACCT_INST_2,                                        *00370000
                   PROD_CODE_2,                                        *00371000
                   ACCT_NBR_2,                                         *00372000
                   MODEL_2,                                            *00373000
                   RECORD_SEQ,                                         *00374000
                   AUDIT_DATE,                                         *00375000
                   AUDIT_TIME,                                         *00376000
                   AUDIT_USER,                                         *00377000
                   AUDIT_ORG,                                          *00378000
                   EVENT_CODE,                                         *00379000
                   SVC_INCEN_OPT,                                      *00380000
                   SVC_INCEN_QLFY,                                     *00381000
                   DISC_AMT,                                           *00382000
                   DISC_PERCENT,                                       *00383000
                   RATE_INCEN_OPT,                                     *00384000
                   RATE_INCEN_QLFY,                                    *00385000
                   RATE_OPTION,                                        *00386000
                   RATE_TYPE,                                          *00387000
                   RATE_PCT,                                           *00388000
                   MESSAGE_NBR,                                        *00389000
                   IDENT_NBR,                                          *00390000
                   MODULE,                                             *00391000
                   RSV_AREA                                            *00392000
                 FROM SAM                                              *00393000
                 WHERE                                                 *00394000
                   ACCT_INST_1 = :INST1 AND                            *00395000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00396000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00397000
                   EVENT_DATE = :EVNTDATE AND                          *00398000
                   ACCT_INST_2 = :INST2 AND                            *00399000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00400000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00401000
                   MODEL_2 >=                                          *00402000
                     :MODEL2                                           *00403000
                 ORDER BY MODEL_2 ASC,                                 *00404000
                   RECORD_SEQ ASC                                      *00405000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00406000
         EXEC  SQL OPEN SAMGE002                                        00407000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00408000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00409000
         BR    14                      RETURN TO CALLER                 00410000
         LTORG                                                          00411000
*                                                                       00412000
SELGE003 DS    0H                                                       00413000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00414000
         EXEC  SQL DECLARE SAMGE003 CURSOR                             *00415000
               WITH ROWSET POSITIONING                                 *00416000
               FOR SELECT                                              *00417000
                   ACCT_INST_1,                                        *00418000
                   PROD_CODE_1,                                        *00419000
                   ACCT_NBR_1,                                         *00420000
                   EVENT_DATE,                                         *00421000
                   ACCT_INST_2,                                        *00422000
                   PROD_CODE_2,                                        *00423000
                   ACCT_NBR_2,                                         *00424000
                   MODEL_2,                                            *00425000
                   RECORD_SEQ,                                         *00426000
                   AUDIT_DATE,                                         *00427000
                   AUDIT_TIME,                                         *00428000
                   AUDIT_USER,                                         *00429000
                   AUDIT_ORG,                                          *00430000
                   EVENT_CODE,                                         *00431000
                   SVC_INCEN_OPT,                                      *00432000
                   SVC_INCEN_QLFY,                                     *00433000
                   DISC_AMT,                                           *00434000
                   DISC_PERCENT,                                       *00435000
                   RATE_INCEN_OPT,                                     *00436000
                   RATE_INCEN_QLFY,                                    *00437000
                   RATE_OPTION,                                        *00438000
                   RATE_TYPE,                                          *00439000
                   RATE_PCT,                                           *00440000
                   MESSAGE_NBR,                                        *00441000
                   IDENT_NBR,                                          *00442000
                   MODULE,                                             *00443000
                   RSV_AREA                                            *00444000
                 FROM SAM                                              *00445000
                 WHERE                                                 *00446000
                   ACCT_INST_1 = :INST1 AND                            *00447000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00448000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00449000
                   EVENT_DATE = :EVNTDATE AND                          *00450000
                   ACCT_INST_2 = :INST2 AND                            *00451000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00452000
                   ACCT_NBR_2 >=                                       *00453000
                     :ACCTNBR2                                         *00454000
                 ORDER BY ACCT_NBR_2 ASC,                              *00455000
                   MODEL_2 ASC,                                        *00456000
                   RECORD_SEQ ASC                                      *00457000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00458000
         EXEC  SQL OPEN SAMGE003                                        00459000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00460000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00461000
         BR    14                      RETURN TO CALLER                 00462000
         LTORG                                                          00463000
*                                                                       00464000
SELGE004 DS    0H                                                       00465000
         USING SELGE004,12             ESTABLISH BASE REGISTER          00466000
         EXEC  SQL DECLARE SAMGE004 CURSOR                             *00467000
               WITH ROWSET POSITIONING                                 *00468000
               FOR SELECT                                              *00469000
                   ACCT_INST_1,                                        *00470000
                   PROD_CODE_1,                                        *00471000
                   ACCT_NBR_1,                                         *00472000
                   EVENT_DATE,                                         *00473000
                   ACCT_INST_2,                                        *00474000
                   PROD_CODE_2,                                        *00475000
                   ACCT_NBR_2,                                         *00476000
                   MODEL_2,                                            *00477000
                   RECORD_SEQ,                                         *00478000
                   AUDIT_DATE,                                         *00479000
                   AUDIT_TIME,                                         *00480000
                   AUDIT_USER,                                         *00481000
                   AUDIT_ORG,                                          *00482000
                   EVENT_CODE,                                         *00483000
                   SVC_INCEN_OPT,                                      *00484000
                   SVC_INCEN_QLFY,                                     *00485000
                   DISC_AMT,                                           *00486000
                   DISC_PERCENT,                                       *00487000
                   RATE_INCEN_OPT,                                     *00488000
                   RATE_INCEN_QLFY,                                    *00489000
                   RATE_OPTION,                                        *00490000
                   RATE_TYPE,                                          *00491000
                   RATE_PCT,                                           *00492000
                   MESSAGE_NBR,                                        *00493000
                   IDENT_NBR,                                          *00494000
                   MODULE,                                             *00495000
                   RSV_AREA                                            *00496000
                 FROM SAM                                              *00497000
                 WHERE                                                 *00498000
                   ACCT_INST_1 = :INST1 AND                            *00499000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00500000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00501000
                   EVENT_DATE = :EVNTDATE AND                          *00502000
                   ACCT_INST_2 = :INST2 AND                            *00503000
                   PROD_CODE_2 >=                                      *00504000
                     :PRDCDE2                                          *00505000
                 ORDER BY PROD_CODE_2 ASC,                             *00506000
                   ACCT_NBR_2 ASC,                                     *00507000
                   MODEL_2 ASC,                                        *00508000
                   RECORD_SEQ ASC                                      *00509000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00510000
         EXEC  SQL OPEN SAMGE004                                        00511000
         MVC   SQWCSRCA,=A(CLSGE004)   SET CURSOR CLOSE ROUTINE ADDRESS 00512000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00513000
         BR    14                      RETURN TO CALLER                 00514000
         LTORG                                                          00515000
*                                                                       00516000
SELGE005 DS    0H                                                       00517000
         USING SELGE005,12             ESTABLISH BASE REGISTER          00518000
         EXEC  SQL DECLARE SAMGE005 CURSOR                             *00519000
               WITH ROWSET POSITIONING                                 *00520000
               FOR SELECT                                              *00521000
                   ACCT_INST_1,                                        *00522000
                   PROD_CODE_1,                                        *00523000
                   ACCT_NBR_1,                                         *00524000
                   EVENT_DATE,                                         *00525000
                   ACCT_INST_2,                                        *00526000
                   PROD_CODE_2,                                        *00527000
                   ACCT_NBR_2,                                         *00528000
                   MODEL_2,                                            *00529000
                   RECORD_SEQ,                                         *00530000
                   AUDIT_DATE,                                         *00531000
                   AUDIT_TIME,                                         *00532000
                   AUDIT_USER,                                         *00533000
                   AUDIT_ORG,                                          *00534000
                   EVENT_CODE,                                         *00535000
                   SVC_INCEN_OPT,                                      *00536000
                   SVC_INCEN_QLFY,                                     *00537000
                   DISC_AMT,                                           *00538000
                   DISC_PERCENT,                                       *00539000
                   RATE_INCEN_OPT,                                     *00540000
                   RATE_INCEN_QLFY,                                    *00541000
                   RATE_OPTION,                                        *00542000
                   RATE_TYPE,                                          *00543000
                   RATE_PCT,                                           *00544000
                   MESSAGE_NBR,                                        *00545000
                   IDENT_NBR,                                          *00546000
                   MODULE,                                             *00547000
                   RSV_AREA                                            *00548000
                 FROM SAM                                              *00549000
                 WHERE                                                 *00550000
                   ACCT_INST_1 = :INST1 AND                            *00551000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00552000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00553000
                   EVENT_DATE = :EVNTDATE AND                          *00554000
                   ACCT_INST_2 >=                                      *00555000
                     :INST2                                            *00556000
                 ORDER BY ACCT_INST_2 ASC,                             *00557000
                   PROD_CODE_2 ASC,                                    *00558000
                   ACCT_NBR_2 ASC,                                     *00559000
                   MODEL_2 ASC,                                        *00560000
                   RECORD_SEQ ASC                                      *00561000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00562000
         EXEC  SQL OPEN SAMGE005                                        00563000
         MVC   SQWCSRCA,=A(CLSGE005)   SET CURSOR CLOSE ROUTINE ADDRESS 00564000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00565000
         BR    14                      RETURN TO CALLER                 00566000
         LTORG                                                          00567000
*                                                                       00568000
SELGE006 DS    0H                                                       00569000
         USING SELGE006,12             ESTABLISH BASE REGISTER          00570000
         EXEC  SQL DECLARE SAMGE006 CURSOR                             *00571000
               WITH ROWSET POSITIONING                                 *00572000
               FOR SELECT                                              *00573000
                   ACCT_INST_1,                                        *00574000
                   PROD_CODE_1,                                        *00575000
                   ACCT_NBR_1,                                         *00576000
                   EVENT_DATE,                                         *00577000
                   ACCT_INST_2,                                        *00578000
                   PROD_CODE_2,                                        *00579000
                   ACCT_NBR_2,                                         *00580000
                   MODEL_2,                                            *00581000
                   RECORD_SEQ,                                         *00582000
                   AUDIT_DATE,                                         *00583000
                   AUDIT_TIME,                                         *00584000
                   AUDIT_USER,                                         *00585000
                   AUDIT_ORG,                                          *00586000
                   EVENT_CODE,                                         *00587000
                   SVC_INCEN_OPT,                                      *00588000
                   SVC_INCEN_QLFY,                                     *00589000
                   DISC_AMT,                                           *00590000
                   DISC_PERCENT,                                       *00591000
                   RATE_INCEN_OPT,                                     *00592000
                   RATE_INCEN_QLFY,                                    *00593000
                   RATE_OPTION,                                        *00594000
                   RATE_TYPE,                                          *00595000
                   RATE_PCT,                                           *00596000
                   MESSAGE_NBR,                                        *00597000
                   IDENT_NBR,                                          *00598000
                   MODULE,                                             *00599000
                   RSV_AREA                                            *00600000
                 FROM SAM                                              *00601000
                 WHERE                                                 *00602000
                   ACCT_INST_1 = :INST1 AND                            *00603000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00604000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00605000
                   EVENT_DATE >=                                       *00606000
                     :EVNTDATE                                         *00607000
                 ORDER BY EVENT_DATE ASC,                              *00608000
                   ACCT_INST_2 ASC,                                    *00609000
                   PROD_CODE_2 ASC,                                    *00610000
                   ACCT_NBR_2 ASC,                                     *00611000
                   MODEL_2 ASC,                                        *00612000
                   RECORD_SEQ ASC                                      *00613000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00614000
         EXEC  SQL OPEN SAMGE006                                        00615000
         MVC   SQWCSRCA,=A(CLSGE006)   SET CURSOR CLOSE ROUTINE ADDRESS 00616000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00617000
         BR    14                      RETURN TO CALLER                 00618000
         LTORG                                                          00619000
*                                                                       00620000
SELGE007 DS    0H                                                       00621000
         USING SELGE007,12             ESTABLISH BASE REGISTER          00622000
         EXEC  SQL DECLARE SAMGE007 CURSOR                             *00623000
               WITH ROWSET POSITIONING                                 *00624000
               FOR SELECT                                              *00625000
                   ACCT_INST_1,                                        *00626000
                   PROD_CODE_1,                                        *00627000
                   ACCT_NBR_1,                                         *00628000
                   EVENT_DATE,                                         *00629000
                   ACCT_INST_2,                                        *00630000
                   PROD_CODE_2,                                        *00631000
                   ACCT_NBR_2,                                         *00632000
                   MODEL_2,                                            *00633000
                   RECORD_SEQ,                                         *00634000
                   AUDIT_DATE,                                         *00635000
                   AUDIT_TIME,                                         *00636000
                   AUDIT_USER,                                         *00637000
                   AUDIT_ORG,                                          *00638000
                   EVENT_CODE,                                         *00639000
                   SVC_INCEN_OPT,                                      *00640000
                   SVC_INCEN_QLFY,                                     *00641000
                   DISC_AMT,                                           *00642000
                   DISC_PERCENT,                                       *00643000
                   RATE_INCEN_OPT,                                     *00644000
                   RATE_INCEN_QLFY,                                    *00645000
                   RATE_OPTION,                                        *00646000
                   RATE_TYPE,                                          *00647000
                   RATE_PCT,                                           *00648000
                   MESSAGE_NBR,                                        *00649000
                   IDENT_NBR,                                          *00650000
                   MODULE,                                             *00651000
                   RSV_AREA                                            *00652000
                 FROM SAM                                              *00653000
                 WHERE                                                 *00654000
                   ACCT_INST_1 = :INST1 AND                            *00655000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00656000
                   ACCT_NBR_1 >=                                       *00657000
                     :ACCTNBR1                                         *00658000
                 ORDER BY ACCT_NBR_1 ASC,                              *00659000
                   EVENT_DATE ASC,                                     *00660000
                   ACCT_INST_2 ASC,                                    *00661000
                   PROD_CODE_2 ASC,                                    *00662000
                   ACCT_NBR_2 ASC,                                     *00663000
                   MODEL_2 ASC,                                        *00664000
                   RECORD_SEQ ASC                                      *00665000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00666000
         EXEC  SQL OPEN SAMGE007                                        00667000
         MVC   SQWCSRCA,=A(CLSGE007)   SET CURSOR CLOSE ROUTINE ADDRESS 00668000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00669000
         BR    14                      RETURN TO CALLER                 00670000
         LTORG                                                          00671000
*                                                                       00672000
SELGE008 DS    0H                                                       00673000
         USING SELGE008,12             ESTABLISH BASE REGISTER          00674000
         EXEC  SQL DECLARE SAMGE008 CURSOR                             *00675000
               WITH ROWSET POSITIONING                                 *00676000
               FOR SELECT                                              *00677000
                   ACCT_INST_1,                                        *00678000
                   PROD_CODE_1,                                        *00679000
                   ACCT_NBR_1,                                         *00680000
                   EVENT_DATE,                                         *00681000
                   ACCT_INST_2,                                        *00682000
                   PROD_CODE_2,                                        *00683000
                   ACCT_NBR_2,                                         *00684000
                   MODEL_2,                                            *00685000
                   RECORD_SEQ,                                         *00686000
                   AUDIT_DATE,                                         *00687000
                   AUDIT_TIME,                                         *00688000
                   AUDIT_USER,                                         *00689000
                   AUDIT_ORG,                                          *00690000
                   EVENT_CODE,                                         *00691000
                   SVC_INCEN_OPT,                                      *00692000
                   SVC_INCEN_QLFY,                                     *00693000
                   DISC_AMT,                                           *00694000
                   DISC_PERCENT,                                       *00695000
                   RATE_INCEN_OPT,                                     *00696000
                   RATE_INCEN_QLFY,                                    *00697000
                   RATE_OPTION,                                        *00698000
                   RATE_TYPE,                                          *00699000
                   RATE_PCT,                                           *00700000
                   MESSAGE_NBR,                                        *00701000
                   IDENT_NBR,                                          *00702000
                   MODULE,                                             *00703000
                   RSV_AREA                                            *00704000
                 FROM SAM                                              *00705000
                 WHERE                                                 *00706000
                   ACCT_INST_1 = :INST1 AND                            *00707000
                   PROD_CODE_1 >=                                      *00708000
                     :PRDCDE1                                          *00709000
                 ORDER BY PROD_CODE_1 ASC,                             *00710000
                   ACCT_NBR_1 ASC,                                     *00711000
                   EVENT_DATE ASC,                                     *00712000
                   ACCT_INST_2 ASC,                                    *00713000
                   PROD_CODE_2 ASC,                                    *00714000
                   ACCT_NBR_2 ASC,                                     *00715000
                   MODEL_2 ASC,                                        *00716000
                   RECORD_SEQ ASC                                      *00717000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00718000
         EXEC  SQL OPEN SAMGE008                                        00719000
         MVC   SQWCSRCA,=A(CLSGE008)   SET CURSOR CLOSE ROUTINE ADDRESS 00720000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00721000
         BR    14                      RETURN TO CALLER                 00722000
         LTORG                                                          00723000
*                                                                       00724000
SELGE009 DS    0H                                                       00725000
         USING SELGE009,12             ESTABLISH BASE REGISTER          00726000
         EXEC  SQL DECLARE SAMGE009 CURSOR                             *00727000
               WITH ROWSET POSITIONING                                 *00728000
               FOR SELECT                                              *00729000
                   ACCT_INST_1,                                        *00730000
                   PROD_CODE_1,                                        *00731000
                   ACCT_NBR_1,                                         *00732000
                   EVENT_DATE,                                         *00733000
                   ACCT_INST_2,                                        *00734000
                   PROD_CODE_2,                                        *00735000
                   ACCT_NBR_2,                                         *00736000
                   MODEL_2,                                            *00737000
                   RECORD_SEQ,                                         *00738000
                   AUDIT_DATE,                                         *00739000
                   AUDIT_TIME,                                         *00740000
                   AUDIT_USER,                                         *00741000
                   AUDIT_ORG,                                          *00742000
                   EVENT_CODE,                                         *00743000
                   SVC_INCEN_OPT,                                      *00744000
                   SVC_INCEN_QLFY,                                     *00745000
                   DISC_AMT,                                           *00746000
                   DISC_PERCENT,                                       *00747000
                   RATE_INCEN_OPT,                                     *00748000
                   RATE_INCEN_QLFY,                                    *00749000
                   RATE_OPTION,                                        *00750000
                   RATE_TYPE,                                          *00751000
                   RATE_PCT,                                           *00752000
                   MESSAGE_NBR,                                        *00753000
                   IDENT_NBR,                                          *00754000
                   MODULE,                                             *00755000
                   RSV_AREA                                            *00756000
                 FROM SAM                                              *00757000
                 WHERE                                                 *00758000
                   ACCT_INST_1 >=                                      *00759000
                     :INST1                                            *00760000
                 ORDER BY ACCT_INST_1 ASC,                             *00761000
                   PROD_CODE_1 ASC,                                    *00762000
                   ACCT_NBR_1 ASC,                                     *00763000
                   EVENT_DATE ASC,                                     *00764000
                   ACCT_INST_2 ASC,                                    *00765000
                   PROD_CODE_2 ASC,                                    *00766000
                   ACCT_NBR_2 ASC,                                     *00767000
                   MODEL_2 ASC,                                        *00768000
                   RECORD_SEQ ASC                                      *00769000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00770000
         EXEC  SQL OPEN SAMGE009                                        00771000
         MVC   SQWCSRCA,=A(CLSGE009)   SET CURSOR CLOSE ROUTINE ADDRESS 00772000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00773000
         BR    14                      RETURN TO CALLER                 00774000
         LTORG                                                          00775000
*                                                                       00776000
**********************************************************************  00777000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00778000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00779000
**********************************************************************  00780000
*                                                                       00781000
NXTXC0   DS    0H                                                       00782000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00783000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00784000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00785000
         BALR  14,15                   MOVE REQUESTED DATA              00786000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00787000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00788000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00789000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00790000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00791000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00792000
NXTXC0P  DC    A(0)                                                     00793000
         DC    A(NXTGT002)                                              00794000
         DC    A(NXTGT003)                                              00795000
         DC    A(NXTGT004)                                              00796000
         DC    A(NXTGT005)                                              00797000
         DC    A(NXTGT006)                                              00798000
         DC    A(NXTGT007)                                              00799000
         DC    A(NXTGT008)                                              00800000
         DC    A(NXTGT009)                                              00801000
         DC    A(NXTGT099)                                              00802000
         DC    A(NXTGT003)                                              00803000
         DC    A(NXTGT004)                                              00804000
         DC    A(NXTGT005)                                              00805000
         DC    A(NXTGT006)                                              00806000
         DC    A(NXTGT007)                                              00807000
         DC    A(NXTGT008)                                              00808000
         DC    A(NXTGT009)                                              00809000
         DC    A(NXTGT099)                                              00810000
         DC    A(NXTGT004)                                              00811000
         DC    A(NXTGT005)                                              00812000
         DC    A(NXTGT006)                                              00813000
         DC    A(NXTGT007)                                              00814000
         DC    A(NXTGT008)                                              00815000
         DC    A(NXTGT009)                                              00816000
         DC    A(NXTGT099)                                              00817000
         DC    A(NXTGT005)                                              00818000
         DC    A(NXTGT006)                                              00819000
         DC    A(NXTGT007)                                              00820000
         DC    A(NXTGT008)                                              00821000
         DC    A(NXTGT009)                                              00822000
         DC    A(NXTGT099)                                              00823000
         DC    A(NXTGT006)                                              00824000
         DC    A(NXTGT007)                                              00825000
         DC    A(NXTGT008)                                              00826000
         DC    A(NXTGT009)                                              00827000
         DC    A(NXTGT099)                                              00828000
         DC    A(NXTGT007)                                              00829000
         DC    A(NXTGT008)                                              00830000
         DC    A(NXTGT009)                                              00831000
         DC    A(NXTGT099)                                              00832000
         DC    A(NXTGT008)                                              00833000
         DC    A(NXTGT009)                                              00834000
         DC    A(NXTGT099)                                              00835000
         DC    A(NXTGT009)                                              00836000
         DC    A(NXTGT099)                                              00837000
         DC    A(NXTGT099)                                              00838000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00839000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00840000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00841000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00842000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00843000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00844000
         BR    14                      RETURN TO SQI                    00845000
         LTORG                                                          00846000
*                                                                       00847000
NXTGT002 DS    0H                                                       00848000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00849000
         EXEC  SQL DECLARE SAMGT002 CURSOR                             *00850000
               WITH ROWSET POSITIONING                                 *00851000
               FOR SELECT                                              *00852000
                   ACCT_INST_1,                                        *00853000
                   PROD_CODE_1,                                        *00854000
                   ACCT_NBR_1,                                         *00855000
                   EVENT_DATE,                                         *00856000
                   ACCT_INST_2,                                        *00857000
                   PROD_CODE_2,                                        *00858000
                   ACCT_NBR_2,                                         *00859000
                   MODEL_2,                                            *00860000
                   RECORD_SEQ,                                         *00861000
                   AUDIT_DATE,                                         *00862000
                   AUDIT_TIME,                                         *00863000
                   AUDIT_USER,                                         *00864000
                   AUDIT_ORG,                                          *00865000
                   EVENT_CODE,                                         *00866000
                   SVC_INCEN_OPT,                                      *00867000
                   SVC_INCEN_QLFY,                                     *00868000
                   DISC_AMT,                                           *00869000
                   DISC_PERCENT,                                       *00870000
                   RATE_INCEN_OPT,                                     *00871000
                   RATE_INCEN_QLFY,                                    *00872000
                   RATE_OPTION,                                        *00873000
                   RATE_TYPE,                                          *00874000
                   RATE_PCT,                                           *00875000
                   MESSAGE_NBR,                                        *00876000
                   IDENT_NBR,                                          *00877000
                   MODULE,                                             *00878000
                   RSV_AREA                                            *00879000
                 FROM SAM                                              *00880000
                 WHERE                                                 *00881000
                   ACCT_INST_1 = :INST1 AND                            *00882000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00883000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00884000
                   EVENT_DATE = :EVNTDATE AND                          *00885000
                   ACCT_INST_2 = :INST2 AND                            *00886000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00887000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00888000
                   MODEL_2 >                                           *00889000
                     :MODEL2                                           *00890000
                 ORDER BY MODEL_2 ASC,                                 *00891000
                   RECORD_SEQ ASC                                      *00892000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00893000
         EXEC  SQL OPEN SAMGT002                                        00894000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00895000
         BNZ   *+14                    NO - RETURN ERROR                00896000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00897000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00898000
         BR    12                      RETURN TO FETCH ROUTINE          00899000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00900000
         BR    14                      RETURN TO CALLER                 00901000
         LTORG                                                          00902000
*                                                                       00903000
NXTGT003 DS    0H                                                       00904000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00905000
         EXEC  SQL DECLARE SAMGT003 CURSOR                             *00906000
               WITH ROWSET POSITIONING                                 *00907000
               FOR SELECT                                              *00908000
                   ACCT_INST_1,                                        *00909000
                   PROD_CODE_1,                                        *00910000
                   ACCT_NBR_1,                                         *00911000
                   EVENT_DATE,                                         *00912000
                   ACCT_INST_2,                                        *00913000
                   PROD_CODE_2,                                        *00914000
                   ACCT_NBR_2,                                         *00915000
                   MODEL_2,                                            *00916000
                   RECORD_SEQ,                                         *00917000
                   AUDIT_DATE,                                         *00918000
                   AUDIT_TIME,                                         *00919000
                   AUDIT_USER,                                         *00920000
                   AUDIT_ORG,                                          *00921000
                   EVENT_CODE,                                         *00922000
                   SVC_INCEN_OPT,                                      *00923000
                   SVC_INCEN_QLFY,                                     *00924000
                   DISC_AMT,                                           *00925000
                   DISC_PERCENT,                                       *00926000
                   RATE_INCEN_OPT,                                     *00927000
                   RATE_INCEN_QLFY,                                    *00928000
                   RATE_OPTION,                                        *00929000
                   RATE_TYPE,                                          *00930000
                   RATE_PCT,                                           *00931000
                   MESSAGE_NBR,                                        *00932000
                   IDENT_NBR,                                          *00933000
                   MODULE,                                             *00934000
                   RSV_AREA                                            *00935000
                 FROM SAM                                              *00936000
                 WHERE                                                 *00937000
                   ACCT_INST_1 = :INST1 AND                            *00938000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00939000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00940000
                   EVENT_DATE = :EVNTDATE AND                          *00941000
                   ACCT_INST_2 = :INST2 AND                            *00942000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00943000
                   ACCT_NBR_2 >                                        *00944000
                     :ACCTNBR2                                         *00945000
                 ORDER BY ACCT_NBR_2 ASC,                              *00946000
                   MODEL_2 ASC,                                        *00947000
                   RECORD_SEQ ASC                                      *00948000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00949000
         EXEC  SQL OPEN SAMGT003                                        00950000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00951000
         BNZ   *+14                    NO - RETURN ERROR                00952000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00953000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00954000
         BR    12                      RETURN TO FETCH ROUTINE          00955000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00956000
         BR    14                      RETURN TO CALLER                 00957000
         LTORG                                                          00958000
*                                                                       00959000
NXTGT004 DS    0H                                                       00960000
         USING NXTGT004,12             ESTABLISH BASE REGISTER          00961000
         EXEC  SQL DECLARE SAMGT004 CURSOR                             *00962000
               WITH ROWSET POSITIONING                                 *00963000
               FOR SELECT                                              *00964000
                   ACCT_INST_1,                                        *00965000
                   PROD_CODE_1,                                        *00966000
                   ACCT_NBR_1,                                         *00967000
                   EVENT_DATE,                                         *00968000
                   ACCT_INST_2,                                        *00969000
                   PROD_CODE_2,                                        *00970000
                   ACCT_NBR_2,                                         *00971000
                   MODEL_2,                                            *00972000
                   RECORD_SEQ,                                         *00973000
                   AUDIT_DATE,                                         *00974000
                   AUDIT_TIME,                                         *00975000
                   AUDIT_USER,                                         *00976000
                   AUDIT_ORG,                                          *00977000
                   EVENT_CODE,                                         *00978000
                   SVC_INCEN_OPT,                                      *00979000
                   SVC_INCEN_QLFY,                                     *00980000
                   DISC_AMT,                                           *00981000
                   DISC_PERCENT,                                       *00982000
                   RATE_INCEN_OPT,                                     *00983000
                   RATE_INCEN_QLFY,                                    *00984000
                   RATE_OPTION,                                        *00985000
                   RATE_TYPE,                                          *00986000
                   RATE_PCT,                                           *00987000
                   MESSAGE_NBR,                                        *00988000
                   IDENT_NBR,                                          *00989000
                   MODULE,                                             *00990000
                   RSV_AREA                                            *00991000
                 FROM SAM                                              *00992000
                 WHERE                                                 *00993000
                   ACCT_INST_1 = :INST1 AND                            *00994000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00995000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00996000
                   EVENT_DATE = :EVNTDATE AND                          *00997000
                   ACCT_INST_2 = :INST2 AND                            *00998000
                   PROD_CODE_2 >                                       *00999000
                     :PRDCDE2                                          *01000000
                 ORDER BY PROD_CODE_2 ASC,                             *01001000
                   ACCT_NBR_2 ASC,                                     *01002000
                   MODEL_2 ASC,                                        *01003000
                   RECORD_SEQ ASC                                      *01004000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01005000
         EXEC  SQL OPEN SAMGT004                                        01006000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01007000
         BNZ   *+14                    NO - RETURN ERROR                01008000
         MVC   SQWCSRCA,=A(CLSGT004)   SET CURSOR CLOSE ROUTINE ADDRESS 01009000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01010000
         BR    12                      RETURN TO FETCH ROUTINE          01011000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01012000
         BR    14                      RETURN TO CALLER                 01013000
         LTORG                                                          01014000
*                                                                       01015000
NXTGT005 DS    0H                                                       01016000
         USING NXTGT005,12             ESTABLISH BASE REGISTER          01017000
         EXEC  SQL DECLARE SAMGT005 CURSOR                             *01018000
               WITH ROWSET POSITIONING                                 *01019000
               FOR SELECT                                              *01020000
                   ACCT_INST_1,                                        *01021000
                   PROD_CODE_1,                                        *01022000
                   ACCT_NBR_1,                                         *01023000
                   EVENT_DATE,                                         *01024000
                   ACCT_INST_2,                                        *01025000
                   PROD_CODE_2,                                        *01026000
                   ACCT_NBR_2,                                         *01027000
                   MODEL_2,                                            *01028000
                   RECORD_SEQ,                                         *01029000
                   AUDIT_DATE,                                         *01030000
                   AUDIT_TIME,                                         *01031000
                   AUDIT_USER,                                         *01032000
                   AUDIT_ORG,                                          *01033000
                   EVENT_CODE,                                         *01034000
                   SVC_INCEN_OPT,                                      *01035000
                   SVC_INCEN_QLFY,                                     *01036000
                   DISC_AMT,                                           *01037000
                   DISC_PERCENT,                                       *01038000
                   RATE_INCEN_OPT,                                     *01039000
                   RATE_INCEN_QLFY,                                    *01040000
                   RATE_OPTION,                                        *01041000
                   RATE_TYPE,                                          *01042000
                   RATE_PCT,                                           *01043000
                   MESSAGE_NBR,                                        *01044000
                   IDENT_NBR,                                          *01045000
                   MODULE,                                             *01046000
                   RSV_AREA                                            *01047000
                 FROM SAM                                              *01048000
                 WHERE                                                 *01049000
                   ACCT_INST_1 = :INST1 AND                            *01050000
                   PROD_CODE_1 = :PRDCDE1 AND                          *01051000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *01052000
                   EVENT_DATE = :EVNTDATE AND                          *01053000
                   ACCT_INST_2 >                                       *01054000
                     :INST2                                            *01055000
                 ORDER BY ACCT_INST_2 ASC,                             *01056000
                   PROD_CODE_2 ASC,                                    *01057000
                   ACCT_NBR_2 ASC,                                     *01058000
                   MODEL_2 ASC,                                        *01059000
                   RECORD_SEQ ASC                                      *01060000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01061000
         EXEC  SQL OPEN SAMGT005                                        01062000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01063000
         BNZ   *+14                    NO - RETURN ERROR                01064000
         MVC   SQWCSRCA,=A(CLSGT005)   SET CURSOR CLOSE ROUTINE ADDRESS 01065000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01066000
         BR    12                      RETURN TO FETCH ROUTINE          01067000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01068000
         BR    14                      RETURN TO CALLER                 01069000
         LTORG                                                          01070000
*                                                                       01071000
NXTGT006 DS    0H                                                       01072000
         USING NXTGT006,12             ESTABLISH BASE REGISTER          01073000
         EXEC  SQL DECLARE SAMGT006 CURSOR                             *01074000
               WITH ROWSET POSITIONING                                 *01075000
               FOR SELECT                                              *01076000
                   ACCT_INST_1,                                        *01077000
                   PROD_CODE_1,                                        *01078000
                   ACCT_NBR_1,                                         *01079000
                   EVENT_DATE,                                         *01080000
                   ACCT_INST_2,                                        *01081000
                   PROD_CODE_2,                                        *01082000
                   ACCT_NBR_2,                                         *01083000
                   MODEL_2,                                            *01084000
                   RECORD_SEQ,                                         *01085000
                   AUDIT_DATE,                                         *01086000
                   AUDIT_TIME,                                         *01087000
                   AUDIT_USER,                                         *01088000
                   AUDIT_ORG,                                          *01089000
                   EVENT_CODE,                                         *01090000
                   SVC_INCEN_OPT,                                      *01091000
                   SVC_INCEN_QLFY,                                     *01092000
                   DISC_AMT,                                           *01093000
                   DISC_PERCENT,                                       *01094000
                   RATE_INCEN_OPT,                                     *01095000
                   RATE_INCEN_QLFY,                                    *01096000
                   RATE_OPTION,                                        *01097000
                   RATE_TYPE,                                          *01098000
                   RATE_PCT,                                           *01099000
                   MESSAGE_NBR,                                        *01100000
                   IDENT_NBR,                                          *01101000
                   MODULE,                                             *01102000
                   RSV_AREA                                            *01103000
                 FROM SAM                                              *01104000
                 WHERE                                                 *01105000
                   ACCT_INST_1 = :INST1 AND                            *01106000
                   PROD_CODE_1 = :PRDCDE1 AND                          *01107000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *01108000
                   EVENT_DATE >                                        *01109000
                     :EVNTDATE                                         *01110000
                 ORDER BY EVENT_DATE ASC,                              *01111000
                   ACCT_INST_2 ASC,                                    *01112000
                   PROD_CODE_2 ASC,                                    *01113000
                   ACCT_NBR_2 ASC,                                     *01114000
                   MODEL_2 ASC,                                        *01115000
                   RECORD_SEQ ASC                                      *01116000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01117000
         EXEC  SQL OPEN SAMGT006                                        01118000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01119000
         BNZ   *+14                    NO - RETURN ERROR                01120000
         MVC   SQWCSRCA,=A(CLSGT006)   SET CURSOR CLOSE ROUTINE ADDRESS 01121000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01122000
         BR    12                      RETURN TO FETCH ROUTINE          01123000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01124000
         BR    14                      RETURN TO CALLER                 01125000
         LTORG                                                          01126000
*                                                                       01127000
NXTGT007 DS    0H                                                       01128000
         USING NXTGT007,12             ESTABLISH BASE REGISTER          01129000
         EXEC  SQL DECLARE SAMGT007 CURSOR                             *01130000
               WITH ROWSET POSITIONING                                 *01131000
               FOR SELECT                                              *01132000
                   ACCT_INST_1,                                        *01133000
                   PROD_CODE_1,                                        *01134000
                   ACCT_NBR_1,                                         *01135000
                   EVENT_DATE,                                         *01136000
                   ACCT_INST_2,                                        *01137000
                   PROD_CODE_2,                                        *01138000
                   ACCT_NBR_2,                                         *01139000
                   MODEL_2,                                            *01140000
                   RECORD_SEQ,                                         *01141000
                   AUDIT_DATE,                                         *01142000
                   AUDIT_TIME,                                         *01143000
                   AUDIT_USER,                                         *01144000
                   AUDIT_ORG,                                          *01145000
                   EVENT_CODE,                                         *01146000
                   SVC_INCEN_OPT,                                      *01147000
                   SVC_INCEN_QLFY,                                     *01148000
                   DISC_AMT,                                           *01149000
                   DISC_PERCENT,                                       *01150000
                   RATE_INCEN_OPT,                                     *01151000
                   RATE_INCEN_QLFY,                                    *01152000
                   RATE_OPTION,                                        *01153000
                   RATE_TYPE,                                          *01154000
                   RATE_PCT,                                           *01155000
                   MESSAGE_NBR,                                        *01156000
                   IDENT_NBR,                                          *01157000
                   MODULE,                                             *01158000
                   RSV_AREA                                            *01159000
                 FROM SAM                                              *01160000
                 WHERE                                                 *01161000
                   ACCT_INST_1 = :INST1 AND                            *01162000
                   PROD_CODE_1 = :PRDCDE1 AND                          *01163000
                   ACCT_NBR_1 >                                        *01164000
                     :ACCTNBR1                                         *01165000
                 ORDER BY ACCT_NBR_1 ASC,                              *01166000
                   EVENT_DATE ASC,                                     *01167000
                   ACCT_INST_2 ASC,                                    *01168000
                   PROD_CODE_2 ASC,                                    *01169000
                   ACCT_NBR_2 ASC,                                     *01170000
                   MODEL_2 ASC,                                        *01171000
                   RECORD_SEQ ASC                                      *01172000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01173000
         EXEC  SQL OPEN SAMGT007                                        01174000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01175000
         BNZ   *+14                    NO - RETURN ERROR                01176000
         MVC   SQWCSRCA,=A(CLSGT007)   SET CURSOR CLOSE ROUTINE ADDRESS 01177000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01178000
         BR    12                      RETURN TO FETCH ROUTINE          01179000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01180000
         BR    14                      RETURN TO CALLER                 01181000
         LTORG                                                          01182000
*                                                                       01183000
NXTGT008 DS    0H                                                       01184000
         USING NXTGT008,12             ESTABLISH BASE REGISTER          01185000
         EXEC  SQL DECLARE SAMGT008 CURSOR                             *01186000
               WITH ROWSET POSITIONING                                 *01187000
               FOR SELECT                                              *01188000
                   ACCT_INST_1,                                        *01189000
                   PROD_CODE_1,                                        *01190000
                   ACCT_NBR_1,                                         *01191000
                   EVENT_DATE,                                         *01192000
                   ACCT_INST_2,                                        *01193000
                   PROD_CODE_2,                                        *01194000
                   ACCT_NBR_2,                                         *01195000
                   MODEL_2,                                            *01196000
                   RECORD_SEQ,                                         *01197000
                   AUDIT_DATE,                                         *01198000
                   AUDIT_TIME,                                         *01199000
                   AUDIT_USER,                                         *01200000
                   AUDIT_ORG,                                          *01201000
                   EVENT_CODE,                                         *01202000
                   SVC_INCEN_OPT,                                      *01203000
                   SVC_INCEN_QLFY,                                     *01204000
                   DISC_AMT,                                           *01205000
                   DISC_PERCENT,                                       *01206000
                   RATE_INCEN_OPT,                                     *01207000
                   RATE_INCEN_QLFY,                                    *01208000
                   RATE_OPTION,                                        *01209000
                   RATE_TYPE,                                          *01210000
                   RATE_PCT,                                           *01211000
                   MESSAGE_NBR,                                        *01212000
                   IDENT_NBR,                                          *01213000
                   MODULE,                                             *01214000
                   RSV_AREA                                            *01215000
                 FROM SAM                                              *01216000
                 WHERE                                                 *01217000
                   ACCT_INST_1 = :INST1 AND                            *01218000
                   PROD_CODE_1 >                                       *01219000
                     :PRDCDE1                                          *01220000
                 ORDER BY PROD_CODE_1 ASC,                             *01221000
                   ACCT_NBR_1 ASC,                                     *01222000
                   EVENT_DATE ASC,                                     *01223000
                   ACCT_INST_2 ASC,                                    *01224000
                   PROD_CODE_2 ASC,                                    *01225000
                   ACCT_NBR_2 ASC,                                     *01226000
                   MODEL_2 ASC,                                        *01227000
                   RECORD_SEQ ASC                                      *01228000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01229000
         EXEC  SQL OPEN SAMGT008                                        01230000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01231000
         BNZ   *+14                    NO - RETURN ERROR                01232000
         MVC   SQWCSRCA,=A(CLSGT008)   SET CURSOR CLOSE ROUTINE ADDRESS 01233000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01234000
         BR    12                      RETURN TO FETCH ROUTINE          01235000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01236000
         BR    14                      RETURN TO CALLER                 01237000
         LTORG                                                          01238000
*                                                                       01239000
NXTGT009 DS    0H                                                       01240000
         USING NXTGT009,12             ESTABLISH BASE REGISTER          01241000
         EXEC  SQL DECLARE SAMGT009 CURSOR                             *01242000
               WITH ROWSET POSITIONING                                 *01243000
               FOR SELECT                                              *01244000
                   ACCT_INST_1,                                        *01245000
                   PROD_CODE_1,                                        *01246000
                   ACCT_NBR_1,                                         *01247000
                   EVENT_DATE,                                         *01248000
                   ACCT_INST_2,                                        *01249000
                   PROD_CODE_2,                                        *01250000
                   ACCT_NBR_2,                                         *01251000
                   MODEL_2,                                            *01252000
                   RECORD_SEQ,                                         *01253000
                   AUDIT_DATE,                                         *01254000
                   AUDIT_TIME,                                         *01255000
                   AUDIT_USER,                                         *01256000
                   AUDIT_ORG,                                          *01257000
                   EVENT_CODE,                                         *01258000
                   SVC_INCEN_OPT,                                      *01259000
                   SVC_INCEN_QLFY,                                     *01260000
                   DISC_AMT,                                           *01261000
                   DISC_PERCENT,                                       *01262000
                   RATE_INCEN_OPT,                                     *01263000
                   RATE_INCEN_QLFY,                                    *01264000
                   RATE_OPTION,                                        *01265000
                   RATE_TYPE,                                          *01266000
                   RATE_PCT,                                           *01267000
                   MESSAGE_NBR,                                        *01268000
                   IDENT_NBR,                                          *01269000
                   MODULE,                                             *01270000
                   RSV_AREA                                            *01271000
                 FROM SAM                                              *01272000
                 WHERE                                                 *01273000
                   ACCT_INST_1 >                                       *01274000
                     :INST1                                            *01275000
                 ORDER BY ACCT_INST_1 ASC,                             *01276000
                   PROD_CODE_1 ASC,                                    *01277000
                   ACCT_NBR_1 ASC,                                     *01278000
                   EVENT_DATE ASC,                                     *01279000
                   ACCT_INST_2 ASC,                                    *01280000
                   PROD_CODE_2 ASC,                                    *01281000
                   ACCT_NBR_2 ASC,                                     *01282000
                   MODEL_2 ASC,                                        *01283000
                   RECORD_SEQ ASC                                      *01284000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01285000
         EXEC  SQL OPEN SAMGT009                                        01286000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01287000
         BNZ   *+14                    NO - RETURN ERROR                01288000
         MVC   SQWCSRCA,=A(CLSGT009)   SET CURSOR CLOSE ROUTINE ADDRESS 01289000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01290000
         BR    12                      RETURN TO FETCH ROUTINE          01291000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01292000
         BR    14                      RETURN TO CALLER                 01293000
         LTORG                                                          01294000
*                                                                       01295000
**********************************************************************  01296000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               01297000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01298000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01299000
*     RETRIEVE THE ACTUAL ROW.                                          01300000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01301000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01302000
**********************************************************************  01303000
*                                                                       01304000
FETDC0   DS    0H                                                       01305000
         USING FETDC0,12               ESTABLISH BASE REGISTER          01306000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       01307000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01308000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       01309000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01310000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    01311000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01312000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01313000
FETDC0P  DC    A(FETGE001)                                              01314000
         DC    A(FETGT002)                                              01315000
         DC    A(FETGT003)                                              01316000
         DC    A(FETGT004)                                              01317000
         DC    A(FETGT005)                                              01318000
         DC    A(FETGT006)                                              01319000
         DC    A(FETGT007)                                              01320000
         DC    A(FETGT008)                                              01321000
         DC    A(FETGT009)                                              01322000
         DC    A(FETGE002)                                              01323000
         DC    A(FETGT003)                                              01324000
         DC    A(FETGT004)                                              01325000
         DC    A(FETGT005)                                              01326000
         DC    A(FETGT006)                                              01327000
         DC    A(FETGT007)                                              01328000
         DC    A(FETGT008)                                              01329000
         DC    A(FETGT009)                                              01330000
         DC    A(FETGE003)                                              01331000
         DC    A(FETGT004)                                              01332000
         DC    A(FETGT005)                                              01333000
         DC    A(FETGT006)                                              01334000
         DC    A(FETGT007)                                              01335000
         DC    A(FETGT008)                                              01336000
         DC    A(FETGT009)                                              01337000
         DC    A(FETGE004)                                              01338000
         DC    A(FETGT005)                                              01339000
         DC    A(FETGT006)                                              01340000
         DC    A(FETGT007)                                              01341000
         DC    A(FETGT008)                                              01342000
         DC    A(FETGT009)                                              01343000
         DC    A(FETGE005)                                              01344000
         DC    A(FETGT006)                                              01345000
         DC    A(FETGT007)                                              01346000
         DC    A(FETGT008)                                              01347000
         DC    A(FETGT009)                                              01348000
         DC    A(FETGE006)                                              01349000
         DC    A(FETGT007)                                              01350000
         DC    A(FETGT008)                                              01351000
         DC    A(FETGT009)                                              01352000
         DC    A(FETGE007)                                              01353000
         DC    A(FETGT008)                                              01354000
         DC    A(FETGT009)                                              01355000
         DC    A(FETGE008)                                              01356000
         DC    A(FETGT009)                                              01357000
         DC    A(FETGE009)                                              01358000
         DC    A(0)                                                     01359000
         LTORG                                                          01360000
*                                                                       01361000
**********************************************************************  01362000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01363000
* THE PRIMARY KEY:                                                      01364000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01365000
*     VERBS.                                                            01366000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01367000
*     RETRIEVE THE ACTUAL ROW.                                          01368000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01369000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01370000
*     WILL BE THRU THE UPDATE CURSOR.                                   01371000
**********************************************************************  01372000
*                                                                       01373000
FETKC0   DS    0H                                                       01374000
         USING FETKC0,12               ESTABLISH BASE REGISTER          01375000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       01376000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01377000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           01378000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01379000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    01380000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01381000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01382000
FETKC0P  DC    A(FETGE001)                                              01383000
         DC    A(FETGT002)                                              01384000
         DC    A(FETGT003)                                              01385000
         DC    A(FETGT004)                                              01386000
         DC    A(FETGT005)                                              01387000
         DC    A(FETGT006)                                              01388000
         DC    A(FETGT007)                                              01389000
         DC    A(FETGT008)                                              01390000
         DC    A(FETGT009)                                              01391000
         DC    A(FETGE002)                                              01392000
         DC    A(FETGT003)                                              01393000
         DC    A(FETGT004)                                              01394000
         DC    A(FETGT005)                                              01395000
         DC    A(FETGT006)                                              01396000
         DC    A(FETGT007)                                              01397000
         DC    A(FETGT008)                                              01398000
         DC    A(FETGT009)                                              01399000
         DC    A(FETGE003)                                              01400000
         DC    A(FETGT004)                                              01401000
         DC    A(FETGT005)                                              01402000
         DC    A(FETGT006)                                              01403000
         DC    A(FETGT007)                                              01404000
         DC    A(FETGT008)                                              01405000
         DC    A(FETGT009)                                              01406000
         DC    A(FETGE004)                                              01407000
         DC    A(FETGT005)                                              01408000
         DC    A(FETGT006)                                              01409000
         DC    A(FETGT007)                                              01410000
         DC    A(FETGT008)                                              01411000
         DC    A(FETGT009)                                              01412000
         DC    A(FETGE005)                                              01413000
         DC    A(FETGT006)                                              01414000
         DC    A(FETGT007)                                              01415000
         DC    A(FETGT008)                                              01416000
         DC    A(FETGT009)                                              01417000
         DC    A(FETGE006)                                              01418000
         DC    A(FETGT007)                                              01419000
         DC    A(FETGT008)                                              01420000
         DC    A(FETGT009)                                              01421000
         DC    A(FETGE007)                                              01422000
         DC    A(FETGT008)                                              01423000
         DC    A(FETGT009)                                              01424000
         DC    A(FETGE008)                                              01425000
         DC    A(FETGT009)                                              01426000
         DC    A(FETGE009)                                              01427000
         DC    A(0)                                                     01428000
         LTORG                                                          01429000
*                                                                       01430000
FETGE001 DS    0H                                                       01431000
         USING FETGE001,12             ESTABLISH BASE REGISTER          01432000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01433000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01434000
         BALR  14,15                   MOVE REQUESTED DATA              01435000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE001                     *01436000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01437000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01438000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01439000
         BALR  14,15                   MOVE REQUESTED DATA              01440000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01441000
         BR    14                      RETURN TO CALLER                 01442000
         LTORG                                                          01443000
*                                                                       01444000
FETGE002 DS    0H                                                       01445000
         USING FETGE002,12             ESTABLISH BASE REGISTER          01446000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01447000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01448000
         BALR  14,15                   MOVE REQUESTED DATA              01449000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE002                     *01450000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01451000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01452000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01453000
         BALR  14,15                   MOVE REQUESTED DATA              01454000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01455000
         BR    14                      RETURN TO CALLER                 01456000
         LTORG                                                          01457000
*                                                                       01458000
FETGE003 DS    0H                                                       01459000
         USING FETGE003,12             ESTABLISH BASE REGISTER          01460000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01461000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01462000
         BALR  14,15                   MOVE REQUESTED DATA              01463000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE003                     *01464000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01465000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01466000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01467000
         BALR  14,15                   MOVE REQUESTED DATA              01468000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01469000
         BR    14                      RETURN TO CALLER                 01470000
         LTORG                                                          01471000
*                                                                       01472000
FETGE004 DS    0H                                                       01473000
         USING FETGE004,12             ESTABLISH BASE REGISTER          01474000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01475000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01476000
         BALR  14,15                   MOVE REQUESTED DATA              01477000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE004                     *01478000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01479000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01480000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01481000
         BALR  14,15                   MOVE REQUESTED DATA              01482000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01483000
         BR    14                      RETURN TO CALLER                 01484000
         LTORG                                                          01485000
*                                                                       01486000
FETGE005 DS    0H                                                       01487000
         USING FETGE005,12             ESTABLISH BASE REGISTER          01488000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01489000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01490000
         BALR  14,15                   MOVE REQUESTED DATA              01491000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE005                     *01492000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01493000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01494000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01495000
         BALR  14,15                   MOVE REQUESTED DATA              01496000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01497000
         BR    14                      RETURN TO CALLER                 01498000
         LTORG                                                          01499000
*                                                                       01500000
FETGE006 DS    0H                                                       01501000
         USING FETGE006,12             ESTABLISH BASE REGISTER          01502000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01503000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01504000
         BALR  14,15                   MOVE REQUESTED DATA              01505000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE006                     *01506000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01507000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01508000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01509000
         BALR  14,15                   MOVE REQUESTED DATA              01510000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01511000
         BR    14                      RETURN TO CALLER                 01512000
         LTORG                                                          01513000
*                                                                       01514000
FETGE007 DS    0H                                                       01515000
         USING FETGE007,12             ESTABLISH BASE REGISTER          01516000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01517000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01518000
         BALR  14,15                   MOVE REQUESTED DATA              01519000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE007                     *01520000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01521000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01522000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01523000
         BALR  14,15                   MOVE REQUESTED DATA              01524000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01525000
         BR    14                      RETURN TO CALLER                 01526000
         LTORG                                                          01527000
*                                                                       01528000
FETGE008 DS    0H                                                       01529000
         USING FETGE008,12             ESTABLISH BASE REGISTER          01530000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01531000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01532000
         BALR  14,15                   MOVE REQUESTED DATA              01533000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE008                     *01534000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01535000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01536000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01537000
         BALR  14,15                   MOVE REQUESTED DATA              01538000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01539000
         BR    14                      RETURN TO CALLER                 01540000
         LTORG                                                          01541000
*                                                                       01542000
FETGE009 DS    0H                                                       01543000
         USING FETGE009,12             ESTABLISH BASE REGISTER          01544000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01545000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01546000
         BALR  14,15                   MOVE REQUESTED DATA              01547000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGE009                     *01548000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01549000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01550000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01551000
         BALR  14,15                   MOVE REQUESTED DATA              01552000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01553000
         BR    14                      RETURN TO CALLER                 01554000
         LTORG                                                          01555000
*                                                                       01556000
FETGT002 DS    0H                                                       01557000
         USING FETGT002,12             ESTABLISH BASE REGISTER          01558000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01559000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01560000
         BALR  14,15                   MOVE REQUESTED DATA              01561000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT002                     *01562000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01563000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01564000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01565000
         BALR  14,15                   MOVE REQUESTED DATA              01566000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01567000
         BR    14                      RETURN TO CALLER                 01568000
         LTORG                                                          01569000
*                                                                       01570000
FETGT003 DS    0H                                                       01571000
         USING FETGT003,12             ESTABLISH BASE REGISTER          01572000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01573000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01574000
         BALR  14,15                   MOVE REQUESTED DATA              01575000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT003                     *01576000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01577000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01578000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01579000
         BALR  14,15                   MOVE REQUESTED DATA              01580000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01581000
         BR    14                      RETURN TO CALLER                 01582000
         LTORG                                                          01583000
*                                                                       01584000
FETGT004 DS    0H                                                       01585000
         USING FETGT004,12             ESTABLISH BASE REGISTER          01586000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01587000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01588000
         BALR  14,15                   MOVE REQUESTED DATA              01589000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT004                     *01590000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01591000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01592000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01593000
         BALR  14,15                   MOVE REQUESTED DATA              01594000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01595000
         BR    14                      RETURN TO CALLER                 01596000
         LTORG                                                          01597000
*                                                                       01598000
FETGT005 DS    0H                                                       01599000
         USING FETGT005,12             ESTABLISH BASE REGISTER          01600000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01601000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01602000
         BALR  14,15                   MOVE REQUESTED DATA              01603000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT005                     *01604000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01605000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01606000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01607000
         BALR  14,15                   MOVE REQUESTED DATA              01608000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01609000
         BR    14                      RETURN TO CALLER                 01610000
         LTORG                                                          01611000
*                                                                       01612000
FETGT006 DS    0H                                                       01613000
         USING FETGT006,12             ESTABLISH BASE REGISTER          01614000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01615000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01616000
         BALR  14,15                   MOVE REQUESTED DATA              01617000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT006                     *01618000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01619000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01620000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01621000
         BALR  14,15                   MOVE REQUESTED DATA              01622000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01623000
         BR    14                      RETURN TO CALLER                 01624000
         LTORG                                                          01625000
*                                                                       01626000
FETGT007 DS    0H                                                       01627000
         USING FETGT007,12             ESTABLISH BASE REGISTER          01628000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01629000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01630000
         BALR  14,15                   MOVE REQUESTED DATA              01631000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT007                     *01632000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01633000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01634000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01635000
         BALR  14,15                   MOVE REQUESTED DATA              01636000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01637000
         BR    14                      RETURN TO CALLER                 01638000
         LTORG                                                          01639000
*                                                                       01640000
FETGT008 DS    0H                                                       01641000
         USING FETGT008,12             ESTABLISH BASE REGISTER          01642000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01643000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01644000
         BALR  14,15                   MOVE REQUESTED DATA              01645000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT008                     *01646000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01647000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01648000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01649000
         BALR  14,15                   MOVE REQUESTED DATA              01650000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01651000
         BR    14                      RETURN TO CALLER                 01652000
         LTORG                                                          01653000
*                                                                       01654000
FETGT009 DS    0H                                                       01655000
         USING FETGT009,12             ESTABLISH BASE REGISTER          01656000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01657000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01658000
         BALR  14,15                   MOVE REQUESTED DATA              01659000
         EXEC  SQL FETCH NEXT ROWSET FROM SAMGT009                     *01660000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01661000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01662000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01663000
         BALR  14,15                   MOVE REQUESTED DATA              01664000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01665000
         BR    14                      RETURN TO CALLER                 01666000
         LTORG                                                          01667000
*                                                                       01668000
**********************************************************************  01669000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01670000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01671000
*     AND GET-NEXT-LOCK VERBS.                                          01672000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01673000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01674000
**********************************************************************  01675000
*                                                                       01676000
CLSXC0   DS    0H                                                       01677000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          01678000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 01679000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  01680000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       01681000
         LTORG                                                          01682000
*                                                                       01683000
CLSGE001 DS    0H                                                       01684000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          01685000
         EXEC  SQL CLOSE SAMGE001                                       01686000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01687000
         BR    14                      RETURN TO CALLER                 01688000
         LTORG                                                          01689000
*                                                                       01690000
CLSGE002 DS    0H                                                       01691000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          01692000
         EXEC  SQL CLOSE SAMGE002                                       01693000
         L     14,SQW@RET                                               01694000
         BR    14                                                       01695000
         LTORG                                                          01696000
*                                                                       01697000
CLSGE003 DS    0H                                                       01698000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          01699000
         EXEC  SQL CLOSE SAMGE003                                       01700000
         L     14,SQW@RET                                               01701000
         BR    14                                                       01702000
         LTORG                                                          01703000
*                                                                       01704000
CLSGE004 DS    0H                                                       01705000
         USING CLSGE004,12             ESTABLISH BASE REGISTER          01706000
         EXEC  SQL CLOSE SAMGE004                                       01707000
         L     14,SQW@RET                                               01708000
         BR    14                                                       01709000
         LTORG                                                          01710000
*                                                                       01711000
CLSGE005 DS    0H                                                       01712000
         USING CLSGE005,12             ESTABLISH BASE REGISTER          01713000
         EXEC  SQL CLOSE SAMGE005                                       01714000
         L     14,SQW@RET                                               01715000
         BR    14                                                       01716000
         LTORG                                                          01717000
*                                                                       01718000
CLSGE006 DS    0H                                                       01719000
         USING CLSGE006,12             ESTABLISH BASE REGISTER          01720000
         EXEC  SQL CLOSE SAMGE006                                       01721000
         L     14,SQW@RET                                               01722000
         BR    14                                                       01723000
         LTORG                                                          01724000
*                                                                       01725000
CLSGE007 DS    0H                                                       01726000
         USING CLSGE007,12             ESTABLISH BASE REGISTER          01727000
         EXEC  SQL CLOSE SAMGE007                                       01728000
         L     14,SQW@RET                                               01729000
         BR    14                                                       01730000
         LTORG                                                          01731000
*                                                                       01732000
CLSGE008 DS    0H                                                       01733000
         USING CLSGE008,12             ESTABLISH BASE REGISTER          01734000
         EXEC  SQL CLOSE SAMGE008                                       01735000
         L     14,SQW@RET                                               01736000
         BR    14                                                       01737000
         LTORG                                                          01738000
*                                                                       01739000
CLSGE009 DS    0H                                                       01740000
         USING CLSGE009,12             ESTABLISH BASE REGISTER          01741000
         EXEC  SQL CLOSE SAMGE009                                       01742000
         L     14,SQW@RET                                               01743000
         BR    14                                                       01744000
         LTORG                                                          01745000
*                                                                       01746000
CLSGT002 DS    0H                                                       01747000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          01748000
         EXEC  SQL CLOSE SAMGT002                                       01749000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01750000
         BR    14                      RETURN TO CALLER                 01751000
         LTORG                                                          01752000
*                                                                       01753000
CLSGT003 DS    0H                                                       01754000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          01755000
         EXEC  SQL CLOSE SAMGT003                                       01756000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01757000
         BR    14                      RETURN TO CALLER                 01758000
         LTORG                                                          01759000
*                                                                       01760000
CLSGT004 DS    0H                                                       01761000
         USING CLSGT004,12             ESTABLISH BASE REGISTER          01762000
         EXEC  SQL CLOSE SAMGT004                                       01763000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01764000
         BR    14                      RETURN TO CALLER                 01765000
         LTORG                                                          01766000
*                                                                       01767000
CLSGT005 DS    0H                                                       01768000
         USING CLSGT005,12             ESTABLISH BASE REGISTER          01769000
         EXEC  SQL CLOSE SAMGT005                                       01770000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01771000
         BR    14                      RETURN TO CALLER                 01772000
         LTORG                                                          01773000
*                                                                       01774000
CLSGT006 DS    0H                                                       01775000
         USING CLSGT006,12             ESTABLISH BASE REGISTER          01776000
         EXEC  SQL CLOSE SAMGT006                                       01777000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01778000
         BR    14                      RETURN TO CALLER                 01779000
         LTORG                                                          01780000
*                                                                       01781000
CLSGT007 DS    0H                                                       01782000
         USING CLSGT007,12             ESTABLISH BASE REGISTER          01783000
         EXEC  SQL CLOSE SAMGT007                                       01784000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01785000
         BR    14                      RETURN TO CALLER                 01786000
         LTORG                                                          01787000
*                                                                       01788000
CLSGT008 DS    0H                                                       01789000
         USING CLSGT008,12             ESTABLISH BASE REGISTER          01790000
         EXEC  SQL CLOSE SAMGT008                                       01791000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01792000
         BR    14                      RETURN TO CALLER                 01793000
         LTORG                                                          01794000
*                                                                       01795000
CLSGT009 DS    0H                                                       01796000
         USING CLSGT009,12             ESTABLISH BASE REGISTER          01797000
         EXEC  SQL CLOSE SAMGT009                                       01798000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01799000
         BR    14                      RETURN TO CALLER                 01800000
         LTORG                                                          01801000
*                                                                       01802000
**********************************************************************  01803000
* ALTERNATE KEY 1 NOT DEFINED                                           01804000
**********************************************************************  01805000
*                                                                       01806000
SELIN1   DS    0H                                                       01807000
SELKY1   DS    0H                                                       01808000
SELXC1   DS    0H                                                       01809000
FETDC1   DS    0H                                                       01810000
FETKC1   DS    0H                                                       01811000
CLSXC1   DS    0H                                                       01812000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 01813000
*                                                                       01814000
**********************************************************************  01815000
* ALTERNATE KEY 2 NOT DEFINED                                           01816000
**********************************************************************  01817000
*                                                                       01818000
SELIN2   DS    0H                                                       01819000
SELKY2   DS    0H                                                       01820000
SELXC2   DS    0H                                                       01821000
FETDC2   DS    0H                                                       01822000
FETKC2   DS    0H                                                       01823000
CLSXC2   DS    0H                                                       01824000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 01825000
*                                                                       01826000
**********************************************************************  01827000
* ALTERNATE KEY 3 NOT DEFINED                                           01828000
**********************************************************************  01829000
*                                                                       01830000
SELIN3   DS    0H                                                       01831000
SELKY3   DS    0H                                                       01832000
SELXC3   DS    0H                                                       01833000
FETDC3   DS    0H                                                       01834000
FETKC3   DS    0H                                                       01835000
CLSXC3   DS    0H                                                       01836000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 01837000
*                                                                       01838000
         DS    0H                      END OF SQL STATEMENTS            01839000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01840000
*                                                                       01841000
**********************************************************************  01842000
* DUMMY ENTRY POINT DSNHLI                                              01843000
**********************************************************************  01844000
*                                                                       01845000
         ENTRY DSNHLI                                                   01846000
DSNHLI   DS    0H                                                       01847000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01848000
         BR    15                      BRANCH TO ATTACH FACILITY        01849000
*                                                                       01850000
**********************************************************************  01851000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01852000
**********************************************************************  01853000
*                                                                       01854000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       01855000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      01856000
* OR:                                                                   01857000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      01858000
* WHERE:                                                                01859000
*   RRRR = RECORD AREA OFFSET                                           01860000
*   VVVV = HOST VARIABLE AREA OFFSET                                    01861000
*   LLLL = HALFWORD LENGTH TO MOVE                                      01862000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       01863000
*   KK   = KEY FIELD MASK:                                              01864000
*            80 = KEY 0 FIELD                                           01865000
*            40 = KEY 1 FIELD                                           01866000
*            20 = KEY 2 FIELD                                           01867000
*            10 = KEY 3 FIELD                                           01868000
*   DD   = DATA FIELD MASK:                                             01869000
*            80 = RECORD FIELD IS PACKED                                01870000
*            40 = HOST VARIABLE IS PACKED                               01871000
*            20 = NULLABLE FIELD                                        01872000
*            01 = DATE FIELD                                            01873000
*            02 = TIME FIELD                                            01874000
*                                                                       01875000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 01876000
         DC    H'0000',H'0000',H'0077',X'80',X'00'                      01877000
         DC    H'0077',H'0077',H'0087',X'00',X'00'                      01878000
         DC    8X'FF'                                                   01879000
*                                                                       01880000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               01881000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  01882000
* OR:                                                                   01883000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  01884000
* WHERE:                                                                01885000
*   RRRR = RECORD AREA OFFSET                                           01886000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     01887000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      01888000
*   TTTT = SQLDA DATA TYPE:                                             01889000
*            452 = CHAR       453 = CHAR NULLABLE                       01890000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    01891000
*            496 = INTEGER    497 = INTEGER NULLABLE                    01892000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   01893000
*                                                                       01894000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      01895000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 01896000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       01897000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    01898000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       01899000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       01900000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       01901000
         DC    AL2(00164)              SUMMATION OF ALL COLUMN LENGTHS  01902000
         DC    AL2(00010)              PRIMARY MULTIROW FETCH ARRAY     01903000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       01904000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       01905000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       01906000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      01907000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        01908000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        01909000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        01910000
CONVDATA DS    0H                                                       01911000
         DC    H'0000',H'0004',H'452'  ACCT_INST_1                      01912000
         DC    H'0004',H'0006',H'452'  PROD_CODE_1                      01913000
         DC    H'0010',H'0018',H'452'  ACCT_NBR_1                       01914000
         DC    H'0028',H'0008',H'452'  EVENT_DATE                       01915000
         DC    H'0036',H'0004',H'452'  ACCT_INST_2                      01916000
         DC    H'0040',H'0006',H'452'  PROD_CODE_2                      01917000
         DC    H'0046',H'0018',H'452'  ACCT_NBR_2                       01918000
         DC    H'0064',H'0010',H'452'  MODEL_2                          01919000
         DC    H'0074',H'0003',H'452'  RECORD_SEQ                       01920000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   01921000
         DC    H'0077',X'0900',H'484'  AUDIT_DATE                       01922000
         DC    H'0082',X'0900',H'484'  AUDIT_TIME                       01923000
         DC    H'0087',H'0008',H'452'  AUDIT_USER                       01924000
         DC    H'0095',H'0006',H'452'  AUDIT_ORG                        01925000
         DC    H'0101',H'0002',H'452'  EVENT_CODE                       01926000
         DC    H'0103',H'0001',H'452'  SVC_INCEN_OPT                    01927000
         DC    H'0104',H'0001',H'452'  SVC_INCEN_QLFY                   01928000
         DC    H'0105',X'0B02',H'484'  DISC_AMT                         01929000
         DC    H'0111',X'0505',H'484'  DISC_PERCENT                     01930000
         DC    H'0114',H'0001',H'452'  RATE_INCEN_OPT                   01931000
         DC    H'0115',H'0001',H'452'  RATE_INCEN_QLFY                  01932000
         DC    H'0116',H'0001',H'452'  RATE_OPTION                      01933000
         DC    H'0117',H'0001',H'452'  RATE_TYPE                        01934000
         DC    H'0118',X'0909',H'484'  RATE_PCT                         01935000
         DC    H'0123',H'0004',H'452'  MESSAGE_NBR                      01936000
         DC    H'0127',H'0018',H'452'  IDENT_NBR                        01937000
         DC    H'0145',H'0008',H'452'  MODULE                           01938000
         DC    H'0153',H'0011',H'452'  RSV_AREA                         01939000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       01940000
KY0COLMS EQU   00009                   NUMBER OF PRIMARY KEY COLUMNS    01941000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      01942000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      01943000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      01944000
*                                                                       01945000
         LTORG                                                          01946000
         END                                                            01947000
