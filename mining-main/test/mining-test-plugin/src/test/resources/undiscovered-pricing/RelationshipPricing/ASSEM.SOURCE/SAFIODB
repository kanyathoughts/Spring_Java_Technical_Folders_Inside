* REL=SAFIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SAFIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAF FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL238                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
PRDCDE   DS    CL6                                                      00039000
ACCTNBR  DS    CL18                                                     00040000
MODEL    DS    CL10                                                     00041000
AUDDATE  DS    PL5'0.'                                                  00042000
AUDTIME  DS    PL5'0.'                                                  00043000
AUDUSER  DS    CL8                                                      00044000
AUDORG   DS    CL6                                                      00045000
RELATST  DS    CL1                                                      00046000
QLFYST   DS    CL1                                                      00047000
LASTMNTD DS    PL5'0.'                                                  00048000
INCQDTE  DS    PL5'0.'                                                  00049000
VALQDATE DS    PL5'0.'                                                  00050000
SVCNDATE DS    PL5'0.'                                                  00051000
DATEOPEN DS    PL5'0.'                                                  00052000
DATEEXPR DS    PL5'0.'                                                  00053000
SVCTDYF  DS    CL1                                                      00054000
IDNBR    DS    CL18                                                     00055000
CMBBAL1  DS    PL8'0.00'                                                00056000
CMBBAL2  DS    PL8'0.00'                                                00057000
CMBBAL3  DS    PL8'0.00'                                                00058000
CMBBAL4  DS    PL8'0.00'                                                00059000
RSVBAL2  DS    PL8'0.00'                                                00060000
RSVBAL3  DS    PL8'0.00'                                                00061000
OUTFLAG  DS    CL1                                                      00062000
VFEXPDAT DS    PL5'0.'                                                  00063000
EXTENSN  DS    CL2                                                      00064000
RETDAYS  DS    PL2'0.'                                                  00065000
VFMSGNBR DS    CL4                                                      00066000
INCMSGNR DS    CL4                                                      00067000
CUSTNBR  DS    CL13                                                     00068000
RAREA    DS    CL46                                                     00069000
*                                                                       00070000
*                                                                       00071000
**********************************************************************  00072000
* PROGRAM TABLE HEADER SECTION:                                         00073000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00074000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00075000
**********************************************************************  00076000
*                                                                       00077000
SAFIODB  CSECT                         PROGRAM TABLE SECTION            00078000
SAFIODB  AMODE ANY                                                      00079000
SAFIODB  RMODE ANY                                                      00080000
         DC    CL9'SAFIODB'            PROGRAM ID                       00081000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00082000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00083000
         DC    A(0)                    RESERVED                         00084000
         DC    A(0)                    RESERVED                         00085000
         DC    24CL1' '                RESERVED                         00086000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00087000
*                                                                       00088000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00089000
         DC    CL29'WWW.INFOR.COM                '                      00089001
*                                                                       00090000
*                                                                       00091000
**********************************************************************  00092000
* STATEMENT TABLE SECTION:                                              00093000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00094000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00095000
*   SHOULD NOT BE MODIFIED.                                             00096000
**********************************************************************  00097000
*                                                                       00098000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00099000
STM#TAB  AMODE ANY                                                      00100000
STM#TAB  RMODE ANY                                                      00101000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00102000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00103000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00104000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00105000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00106000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00107000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00108000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00109000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00110000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00111000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00112000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00113000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00114000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00115000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00116000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00117000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00118000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00119000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00120000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00121000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00122000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00123000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00124000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00125000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00126000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00127000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00128000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00129000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00130000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00131000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00132000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00133000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00134000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00135000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00136000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00137000
         DC    A(SQL#0036)             INSERT STATEMENT                 00138000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00139000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00140000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00141000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00142000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00143000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00144000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00145000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00146000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00147000
         DC    4X'FF'                                                   00148000
*                                                                       00149000
*                                                                       00150000
**********************************************************************  00151000
* SQL STATEMENT SECTION:                                                00152000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00153000
*     TO SUPPORT THIS TABLE.                                            00154000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00155000
*     ARE EQUIVALENT.                                                   00156000
**********************************************************************  00157000
*                                                                       00158000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00159000
SQL#STMT AMODE ANY                                                      00160000
SQL#STMT RMODE ANY                                                      00161000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00162000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00163000
         USING COM#AREA,11             ADDRESS COMMAREA                 00164000
*                                                                       00165000
*                                                                       00166000
**********************************************************************  00167000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00168000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00169000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00170000
**********************************************************************  00171000
*                                                                       00172000
SQL#0000 DS    0H                                                       00173000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00174000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00175000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00176000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00177000
         EXEC  SQL                                                     *00178000
               SELECT AUDIT_DATE,                                      *00179000
                   AUDIT_TIME,                                         *00180000
                   AUDIT_USER,                                         *00181000
                   AUDIT_ORG,                                          *00182000
                   RELATION_STATUS,                                    *00183000
                   QLFY_STATUS,                                        *00184000
                   LAST_MAINT_DATE,                                    *00185000
                   INCEN_DATE,                                         *00186000
                   VALID_DATE,                                         *00187000
                   SVC_NEXT_DATE,                                      *00188000
                   DATE_OPEN,                                          *00189000
                   DATE_EXPIRE,                                        *00190000
                   SVC_TODAY_FLAG,                                     *00191000
                   IDENT_NBR,                                          *00192000
                   CMB_BAL_1,                                          *00193000
                   CMB_BAL_2,                                          *00194000
                   CMB_BAL_3,                                          *00195000
                   CMB_BAL_4,                                          *00196000
                   RSV_BAL_2,                                          *00197000
                   RSV_BAL_3,                                          *00198000
                   OUT_FLAG,                                           *00199000
                   VALD_FAIL_EXPR,                                     *00200000
                   EXTENSION,                                          *00201000
                   RETENTION_DAYS,                                     *00202000
                   VALD_FAIL_NBR,                                      *00203000
                   INCEN_FAIL_NBR,                                     *00204000
                   CUST_NBR,                                           *00205000
                   RSV_AREA                                            *00206000
                 INTO :AUDDATE,                                        *00207000
                   :AUDTIME,                                           *00208000
                   :AUDUSER,                                           *00209000
                   :AUDORG,                                            *00210000
                   :RELATST,                                           *00211000
                   :QLFYST,                                            *00212000
                   :LASTMNTD,                                          *00213000
                   :INCQDTE,                                           *00214000
                   :VALQDATE,                                          *00215000
                   :SVCNDATE,                                          *00216000
                   :DATEOPEN,                                          *00217000
                   :DATEEXPR,                                          *00218000
                   :SVCTDYF,                                           *00219000
                   :IDNBR,                                             *00220000
                   :CMBBAL1,                                           *00221000
                   :CMBBAL2,                                           *00222000
                   :CMBBAL3,                                           *00223000
                   :CMBBAL4,                                           *00224000
                   :RSVBAL2,                                           *00225000
                   :RSVBAL3,                                           *00226000
                   :OUTFLAG,                                           *00227000
                   :VFEXPDAT,                                          *00228000
                   :EXTENSN,                                           *00229000
                   :RETDAYS,                                           *00230000
                   :VFMSGNBR,                                          *00231000
                   :INCMSGNR,                                          *00232000
                   :CUSTNBR,                                           *00233000
                   :RAREA                                              *00234000
                 FROM SAF                                              *00235000
                 WHERE INST_NBR = :INST AND                            *00236000
                   PROD_CODE = :PRDCDE AND                             *00237000
                   ACCT_NBR = :ACCTNBR AND                             *00238000
                   MODEL = :MODEL                                      *00239000
                 FETCH FIRST 1 ROW ONLY                                 00240000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00241000
         BALR  4,5                     MOVE INTO RECORD AREA            00242000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00243000
         BR    14                      RETURN TO CALLER                 00244000
         LTORG                                                          00245000
*                                                                       00246000
*                                                                       00247000
**********************************************************************  00248000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00249000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00250000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00251000
**********************************************************************  00252000
*                                                                       00253000
SQL#0001 DS    0H                                                       00254000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00255000
         LA    15,255                  SET RETURN CODE                  00256000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00257000
         BR    14                      RETURN TO CALLER                 00258000
         LTORG                                                          00259000
*                                                                       00260000
*                                                                       00261000
**********************************************************************  00262000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00263000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00264000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00265000
**********************************************************************  00266000
*                                                                       00267000
SQL#0002 DS    0H                                                       00268000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00269000
         LA    15,255                  SET RETURN CODE                  00270000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00271000
         BR    14                      RETURN TO CALLER                 00272000
         LTORG                                                          00273000
*                                                                       00274000
*                                                                       00275000
**********************************************************************  00276000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00277000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00278000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00279000
**********************************************************************  00280000
*                                                                       00281000
SQL#0003 DS    0H                                                       00282000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00283000
         LA    15,255                  SET RETURN CODE                  00284000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00285000
         BR    14                      RETURN TO CALLER                 00286000
         LTORG                                                          00287000
*                                                                       00288000
*                                                                       00289000
**********************************************************************  00290000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00291000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00292000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00293000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00294000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00295000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00296000
*     UPDATE STATEMENT TO MATCH.                                        00297000
**********************************************************************  00298000
*                                                                       00299000
SQL#0004 DS    0H                                                       00300000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00301000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00302000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00303000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00304000
         EXEC  SQL                                                     *00305000
               DECLARE SAFUPD0 CURSOR FOR                              *00306000
               SELECT AUDIT_DATE,                                      *00307000
                   AUDIT_TIME,                                         *00308000
                   AUDIT_USER,                                         *00309000
                   AUDIT_ORG,                                          *00310000
                   RELATION_STATUS,                                    *00311000
                   QLFY_STATUS,                                        *00312000
                   LAST_MAINT_DATE,                                    *00313000
                   INCEN_DATE,                                         *00314000
                   VALID_DATE,                                         *00315000
                   SVC_NEXT_DATE,                                      *00316000
                   DATE_OPEN,                                          *00317000
                   DATE_EXPIRE,                                        *00318000
                   SVC_TODAY_FLAG,                                     *00319000
                   IDENT_NBR,                                          *00320000
                   CMB_BAL_1,                                          *00321000
                   CMB_BAL_2,                                          *00322000
                   CMB_BAL_3,                                          *00323000
                   CMB_BAL_4,                                          *00324000
                   RSV_BAL_2,                                          *00325000
                   RSV_BAL_3,                                          *00326000
                   OUT_FLAG,                                           *00327000
                   VALD_FAIL_EXPR,                                     *00328000
                   EXTENSION,                                          *00329000
                   RETENTION_DAYS,                                     *00330000
                   VALD_FAIL_NBR,                                      *00331000
                   INCEN_FAIL_NBR,                                     *00332000
                   CUST_NBR,                                           *00333000
                   RSV_AREA                                            *00334000
                 FROM SAF                                              *00335000
                 WHERE INST_NBR = :INST AND                            *00336000
                   PROD_CODE = :PRDCDE AND                             *00337000
                   ACCT_NBR = :ACCTNBR AND                             *00338000
                   MODEL = :MODEL                                      *00339000
                 FOR UPDATE OF AUDIT_DATE,                             *00340000
                   AUDIT_TIME,                                         *00341000
                   AUDIT_USER,                                         *00342000
                   AUDIT_ORG,                                          *00343000
                   RELATION_STATUS,                                    *00344000
                   QLFY_STATUS,                                        *00345000
                   LAST_MAINT_DATE,                                    *00346000
                   INCEN_DATE,                                         *00347000
                   VALID_DATE,                                         *00348000
                   SVC_NEXT_DATE,                                      *00349000
                   DATE_OPEN,                                          *00350000
                   DATE_EXPIRE,                                        *00351000
                   SVC_TODAY_FLAG,                                     *00352000
                   IDENT_NBR,                                          *00353000
                   CMB_BAL_1,                                          *00354000
                   CMB_BAL_2,                                          *00355000
                   CMB_BAL_3,                                          *00356000
                   CMB_BAL_4,                                          *00357000
                   RSV_BAL_2,                                          *00358000
                   RSV_BAL_3,                                          *00359000
                   OUT_FLAG,                                           *00360000
                   VALD_FAIL_EXPR,                                     *00361000
                   EXTENSION,                                          *00362000
                   RETENTION_DAYS,                                     *00363000
                   VALD_FAIL_NBR,                                      *00364000
                   INCEN_FAIL_NBR,                                     *00365000
                   CUST_NBR,                                           *00366000
                   RSV_AREA                                            *00367000
                 FETCH FIRST 1 ROW ONLY                                 00368000
         EXEC  SQL                                                     *00369000
               OPEN SAFUPD0                                             00370000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00371000
         BR    14                      RETURN TO CALLER                 00372000
         LTORG                                                          00373000
*                                                                       00374000
*                                                                       00375000
**********************************************************************  00376000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00377000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00378000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00379000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00380000
*     UPDATE STATEMENT TO MATCH.                                        00381000
**********************************************************************  00382000
*                                                                       00383000
SQL#0005 DS    0H                                                       00384000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00385000
         LA    15,255                  SET RETURN CODE                  00386000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00387000
         BR    14                      RETURN TO CALLER                 00388000
         LTORG                                                          00389000
*                                                                       00390000
*                                                                       00391000
**********************************************************************  00392000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00393000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00394000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00395000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00396000
*     UPDATE STATEMENT TO MATCH.                                        00397000
**********************************************************************  00398000
*                                                                       00399000
SQL#0006 DS    0H                                                       00400000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00401000
         LA    15,255                  SET RETURN CODE                  00402000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00403000
         BR    14                      RETURN TO CALLER                 00404000
         LTORG                                                          00405000
*                                                                       00406000
*                                                                       00407000
**********************************************************************  00408000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00409000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00410000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00411000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00412000
*     UPDATE STATEMENT TO MATCH.                                        00413000
**********************************************************************  00414000
*                                                                       00415000
SQL#0007 DS    0H                                                       00416000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00417000
         LA    15,255                  SET RETURN CODE                  00418000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00419000
         BR    14                      RETURN TO CALLER                 00420000
         LTORG                                                          00421000
*                                                                       00422000
*                                                                       00423000
**********************************************************************  00424000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00425000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00426000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00427000
*     THE ACTUAL ROW.                                                   00428000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00429000
**********************************************************************  00430000
*                                                                       00431000
SQL#0008 DS    0H                                                       00432000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00433000
         EXEC  SQL                                                     *00434000
               FETCH SAFUPD0                                           *00435000
                 INTO :AUDDATE,                                        *00436000
                   :AUDTIME,                                           *00437000
                   :AUDUSER,                                           *00438000
                   :AUDORG,                                            *00439000
                   :RELATST,                                           *00440000
                   :QLFYST,                                            *00441000
                   :LASTMNTD,                                          *00442000
                   :INCQDTE,                                           *00443000
                   :VALQDATE,                                          *00444000
                   :SVCNDATE,                                          *00445000
                   :DATEOPEN,                                          *00446000
                   :DATEEXPR,                                          *00447000
                   :SVCTDYF,                                           *00448000
                   :IDNBR,                                             *00449000
                   :CMBBAL1,                                           *00450000
                   :CMBBAL2,                                           *00451000
                   :CMBBAL3,                                           *00452000
                   :CMBBAL4,                                           *00453000
                   :RSVBAL2,                                           *00454000
                   :RSVBAL3,                                           *00455000
                   :OUTFLAG,                                           *00456000
                   :VFEXPDAT,                                          *00457000
                   :EXTENSN,                                           *00458000
                   :RETDAYS,                                           *00459000
                   :VFMSGNBR,                                          *00460000
                   :INCMSGNR,                                          *00461000
                   :CUSTNBR,                                           *00462000
                   :RAREA                                               00463000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00464000
         BALR  4,5                     MOVE INTO RECORD AREA            00465000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00466000
         BR    14                      RETURN TO CALLER                 00467000
         LTORG                                                          00468000
*                                                                       00469000
*                                                                       00470000
**********************************************************************  00471000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00472000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00473000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00474000
*     THE ACTUAL ROW.                                                   00475000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00476000
**********************************************************************  00477000
*                                                                       00478000
SQL#0009 DS    0H                                                       00479000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00480000
         LA    15,255                  SET RETURN CODE                  00481000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00482000
         BR    14                      RETURN TO CALLER                 00483000
         LTORG                                                          00484000
*                                                                       00485000
*                                                                       00486000
**********************************************************************  00487000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00488000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00489000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00490000
*     THE ACTUAL ROW.                                                   00491000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00492000
**********************************************************************  00493000
*                                                                       00494000
SQL#0010 DS    0H                                                       00495000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00496000
         LA    15,255                  SET RETURN CODE                  00497000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00498000
         BR    14                      RETURN TO CALLER                 00499000
         LTORG                                                          00500000
*                                                                       00501000
*                                                                       00502000
**********************************************************************  00503000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00504000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00505000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00506000
*     THE ACTUAL ROW.                                                   00507000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00508000
**********************************************************************  00509000
*                                                                       00510000
SQL#0011 DS    0H                                                       00511000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00512000
         LA    15,255                  SET RETURN CODE                  00513000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00514000
         BR    14                      RETURN TO CALLER                 00515000
         LTORG                                                          00516000
*                                                                       00517000
*                                                                       00518000
**********************************************************************  00519000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00520000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00521000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00522000
*     TO CLOSE THE UPDATE CURSOR.                                       00523000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00524000
**********************************************************************  00525000
*                                                                       00526000
SQL#0012 DS    0H                                                       00527000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00528000
         EXEC  SQL                                                     *00529000
               CLOSE SAFUPD0                                            00530000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00531000
         BR    14                      RETURN TO CALLER                 00532000
         LTORG                                                          00533000
*                                                                       00534000
*                                                                       00535000
**********************************************************************  00536000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00537000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00538000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00539000
*     TO CLOSE THE UPDATE CURSOR.                                       00540000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00541000
**********************************************************************  00542000
*                                                                       00543000
SQL#0013 DS    0H                                                       00544000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00545000
         LA    15,255                  SET RETURN CODE                  00546000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00547000
         BR    14                      RETURN TO CALLER                 00548000
         LTORG                                                          00549000
*                                                                       00550000
*                                                                       00551000
**********************************************************************  00552000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00553000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00554000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00555000
*     TO CLOSE THE UPDATE CURSOR.                                       00556000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00557000
**********************************************************************  00558000
*                                                                       00559000
SQL#0014 DS    0H                                                       00560000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00561000
         LA    15,255                  SET RETURN CODE                  00562000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00563000
         BR    14                      RETURN TO CALLER                 00564000
         LTORG                                                          00565000
*                                                                       00566000
*                                                                       00567000
**********************************************************************  00568000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00569000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00570000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00571000
*     TO CLOSE THE UPDATE CURSOR.                                       00572000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00573000
**********************************************************************  00574000
*                                                                       00575000
SQL#0015 DS    0H                                                       00576000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00577000
         LA    15,255                  SET RETURN CODE                  00578000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00579000
         BR    14                      RETURN TO CALLER                 00580000
         LTORG                                                          00581000
*                                                                       00582000
*                                                                       00583000
**********************************************************************  00584000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00585000
* KEY:                                                                  00586000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00587000
*     AND GET-NEXT-LOCK VERBS.                                          00588000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00589000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00590000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00591000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00592000
*     ORDER BY CLAUSE.                                                  00593000
**********************************************************************  00594000
*                                                                       00595000
SQL#0016 DS    0H                                                       00596000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00597000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00598000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00599000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00600000
         EXEC  SQL                                                     *00601000
               DECLARE SAFSQ001 CURSOR FOR                             *00602000
               SELECT INST_NBR,                                        *00603000
                   PROD_CODE,                                          *00604000
                   ACCT_NBR,                                           *00605000
                   MODEL,                                              *00606000
                   AUDIT_DATE,                                         *00607000
                   AUDIT_TIME,                                         *00608000
                   AUDIT_USER,                                         *00609000
                   AUDIT_ORG,                                          *00610000
                   RELATION_STATUS,                                    *00611000
                   QLFY_STATUS,                                        *00612000
                   LAST_MAINT_DATE,                                    *00613000
                   INCEN_DATE,                                         *00614000
                   VALID_DATE,                                         *00615000
                   SVC_NEXT_DATE,                                      *00616000
                   DATE_OPEN,                                          *00617000
                   DATE_EXPIRE,                                        *00618000
                   SVC_TODAY_FLAG,                                     *00619000
                   IDENT_NBR,                                          *00620000
                   CMB_BAL_1,                                          *00621000
                   CMB_BAL_2,                                          *00622000
                   CMB_BAL_3,                                          *00623000
                   CMB_BAL_4,                                          *00624000
                   RSV_BAL_2,                                          *00625000
                   RSV_BAL_3,                                          *00626000
                   OUT_FLAG,                                           *00627000
                   VALD_FAIL_EXPR,                                     *00628000
                   EXTENSION,                                          *00629000
                   RETENTION_DAYS,                                     *00630000
                   VALD_FAIL_NBR,                                      *00631000
                   INCEN_FAIL_NBR,                                     *00632000
                   CUST_NBR,                                           *00633000
                   RSV_AREA                                            *00634000
                 FROM SAF                                              *00635000
                 WHERE                                                 *00636000
                    INST_NBR = :INST AND                               *00637000
                    PROD_CODE = :PRDCDE AND                            *00638000
                    ACCT_NBR = :ACCTNBR AND                            *00639000
                    MODEL >= :MODEL                                    *00640000
                 ORDER BY MODEL                                        *00641000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00642000
         EXEC  SQL                                                     *00643000
               OPEN SAFSQ001                                            00644000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00645000
         BR    14                      RETURN TO CALLER                 00646000
         LTORG                                                          00647000
*                                                                       00648000
*                                                                       00649000
**********************************************************************  00650000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00651000
* KEY 1:                                                                00652000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00653000
*     AND GET-NEXT-LOCK VERBS.                                          00654000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00655000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00656000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00657000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00658000
*     ORDER BY CLAUSE.                                                  00659000
**********************************************************************  00660000
*                                                                       00661000
SQL#0017 DS    0H                                                       00662000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00663000
         LA    15,255                  SET RETURN CODE                  00664000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00665000
         BR    14                      RETURN TO CALLER                 00666000
         LTORG                                                          00667000
*                                                                       00668000
*                                                                       00669000
**********************************************************************  00670000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00671000
* KEY 2:                                                                00672000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00673000
*     AND GET-NEXT-LOCK VERBS.                                          00674000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00675000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00676000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00677000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00678000
*     ORDER BY CLAUSE.                                                  00679000
**********************************************************************  00680000
*                                                                       00681000
SQL#0018 DS    0H                                                       00682000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00683000
         LA    15,255                  SET RETURN CODE                  00684000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00685000
         BR    14                      RETURN TO CALLER                 00686000
         LTORG                                                          00687000
*                                                                       00688000
*                                                                       00689000
**********************************************************************  00690000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00691000
* KEY 3:                                                                00692000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00693000
*     AND GET-NEXT-LOCK VERBS.                                          00694000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00695000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00696000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00697000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00698000
*     ORDER BY CLAUSE.                                                  00699000
**********************************************************************  00700000
*                                                                       00701000
SQL#0019 DS    0H                                                       00702000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00703000
         LA    15,255                  SET RETURN CODE                  00704000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00705000
         BR    14                      RETURN TO CALLER                 00706000
         LTORG                                                          00707000
*                                                                       00708000
*                                                                       00709000
**********************************************************************  00710000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00711000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00712000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00713000
*     RETRIEVE THE ACTUAL ROW.                                          00714000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00715000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00716000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00717000
**********************************************************************  00718000
*                                                                       00719000
SQL#0020 DS    0H                                                       00720000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00721000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00722000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00723000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00724000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00725000
VECT0020 DC    A(SQL#0120)                                              00726000
         DC    A(SQL#0220)                                              00727000
         DC    A(SQL#0320)                                              00728000
         DC    A(SQL#0420)                                              00729000
         LTORG                                                          00730000
*                                                                       00731000
SQL#0120 DS    0H                                                       00732000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00733000
         EXEC  SQL                                                     *00734000
               FETCH SAFSQ001                                          *00735000
                 INTO :INST,                                           *00736000
                      :PRDCDE,                                         *00737000
                      :ACCTNBR,                                        *00738000
                      :MODEL,                                          *00739000
                      :AUDDATE,                                        *00740000
                      :AUDTIME,                                        *00741000
                      :AUDUSER,                                        *00742000
                      :AUDORG,                                         *00743000
                      :RELATST,                                        *00744000
                      :QLFYST,                                         *00745000
                      :LASTMNTD,                                       *00746000
                      :INCQDTE,                                        *00747000
                      :VALQDATE,                                       *00748000
                      :SVCNDATE,                                       *00749000
                      :DATEOPEN,                                       *00750000
                      :DATEEXPR,                                       *00751000
                      :SVCTDYF,                                        *00752000
                      :IDNBR,                                          *00753000
                      :CMBBAL1,                                        *00754000
                      :CMBBAL2,                                        *00755000
                      :CMBBAL3,                                        *00756000
                      :CMBBAL4,                                        *00757000
                      :RSVBAL2,                                        *00758000
                      :RSVBAL3,                                        *00759000
                      :OUTFLAG,                                        *00760000
                      :VFEXPDAT,                                       *00761000
                      :EXTENSN,                                        *00762000
                      :RETDAYS,                                        *00763000
                      :VFMSGNBR,                                       *00764000
                      :INCMSGNR,                                       *00765000
                      :CUSTNBR,                                        *00766000
                      :RAREA                                            00767000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00768000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00769000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00770000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00771000
         BR    12                      OPEN NEXT CURSOR                 00772000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00773000
         BALR  4,5                     MOVE INTO RECORD AREA            00774000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00775000
         BR    14                      RETURN TO CALLER                 00776000
         LTORG                                                          00777000
*                                                                       00778000
SQL#0220 DS    0H                                                       00779000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00780000
         EXEC  SQL                                                     *00781000
               FETCH SAFSQ002                                          *00782000
                 INTO :INST,                                           *00783000
                      :PRDCDE,                                         *00784000
                      :ACCTNBR,                                        *00785000
                      :MODEL,                                          *00786000
                      :AUDDATE,                                        *00787000
                      :AUDTIME,                                        *00788000
                      :AUDUSER,                                        *00789000
                      :AUDORG,                                         *00790000
                      :RELATST,                                        *00791000
                      :QLFYST,                                         *00792000
                      :LASTMNTD,                                       *00793000
                      :INCQDTE,                                        *00794000
                      :VALQDATE,                                       *00795000
                      :SVCNDATE,                                       *00796000
                      :DATEOPEN,                                       *00797000
                      :DATEEXPR,                                       *00798000
                      :SVCTDYF,                                        *00799000
                      :IDNBR,                                          *00800000
                      :CMBBAL1,                                        *00801000
                      :CMBBAL2,                                        *00802000
                      :CMBBAL3,                                        *00803000
                      :CMBBAL4,                                        *00804000
                      :RSVBAL2,                                        *00805000
                      :RSVBAL3,                                        *00806000
                      :OUTFLAG,                                        *00807000
                      :VFEXPDAT,                                       *00808000
                      :EXTENSN,                                        *00809000
                      :RETDAYS,                                        *00810000
                      :VFMSGNBR,                                       *00811000
                      :INCMSGNR,                                       *00812000
                      :CUSTNBR,                                        *00813000
                      :RAREA                                            00814000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00815000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00816000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00817000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00818000
         BR    12                      OPEN NEXT CURSOR                 00819000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00820000
         BALR  4,5                     MOVE INTO RECORD AREA            00821000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00822000
         BR    14                      RETURN TO CALLER                 00823000
         LTORG                                                          00824000
*                                                                       00825000
SQL#0320 DS    0H                                                       00826000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00827000
         EXEC  SQL                                                     *00828000
               FETCH SAFSQ003                                          *00829000
                 INTO :INST,                                           *00830000
                      :PRDCDE,                                         *00831000
                      :ACCTNBR,                                        *00832000
                      :MODEL,                                          *00833000
                      :AUDDATE,                                        *00834000
                      :AUDTIME,                                        *00835000
                      :AUDUSER,                                        *00836000
                      :AUDORG,                                         *00837000
                      :RELATST,                                        *00838000
                      :QLFYST,                                         *00839000
                      :LASTMNTD,                                       *00840000
                      :INCQDTE,                                        *00841000
                      :VALQDATE,                                       *00842000
                      :SVCNDATE,                                       *00843000
                      :DATEOPEN,                                       *00844000
                      :DATEEXPR,                                       *00845000
                      :SVCTDYF,                                        *00846000
                      :IDNBR,                                          *00847000
                      :CMBBAL1,                                        *00848000
                      :CMBBAL2,                                        *00849000
                      :CMBBAL3,                                        *00850000
                      :CMBBAL4,                                        *00851000
                      :RSVBAL2,                                        *00852000
                      :RSVBAL3,                                        *00853000
                      :OUTFLAG,                                        *00854000
                      :VFEXPDAT,                                       *00855000
                      :EXTENSN,                                        *00856000
                      :RETDAYS,                                        *00857000
                      :VFMSGNBR,                                       *00858000
                      :INCMSGNR,                                       *00859000
                      :CUSTNBR,                                        *00860000
                      :RAREA                                            00861000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00862000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00863000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00864000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00865000
         BR    12                      OPEN NEXT CURSOR                 00866000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00867000
         BALR  4,5                     MOVE INTO RECORD AREA            00868000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00869000
         BR    14                      RETURN TO CALLER                 00870000
         LTORG                                                          00871000
*                                                                       00872000
SQL#0420 DS    0H                                                       00873000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          00874000
         EXEC  SQL                                                     *00875000
               FETCH SAFSQ004                                          *00876000
                 INTO :INST,                                           *00877000
                      :PRDCDE,                                         *00878000
                      :ACCTNBR,                                        *00879000
                      :MODEL,                                          *00880000
                      :AUDDATE,                                        *00881000
                      :AUDTIME,                                        *00882000
                      :AUDUSER,                                        *00883000
                      :AUDORG,                                         *00884000
                      :RELATST,                                        *00885000
                      :QLFYST,                                         *00886000
                      :LASTMNTD,                                       *00887000
                      :INCQDTE,                                        *00888000
                      :VALQDATE,                                       *00889000
                      :SVCNDATE,                                       *00890000
                      :DATEOPEN,                                       *00891000
                      :DATEEXPR,                                       *00892000
                      :SVCTDYF,                                        *00893000
                      :IDNBR,                                          *00894000
                      :CMBBAL1,                                        *00895000
                      :CMBBAL2,                                        *00896000
                      :CMBBAL3,                                        *00897000
                      :CMBBAL4,                                        *00898000
                      :RSVBAL2,                                        *00899000
                      :RSVBAL3,                                        *00900000
                      :OUTFLAG,                                        *00901000
                      :VFEXPDAT,                                       *00902000
                      :EXTENSN,                                        *00903000
                      :RETDAYS,                                        *00904000
                      :VFMSGNBR,                                       *00905000
                      :INCMSGNR,                                       *00906000
                      :CUSTNBR,                                        *00907000
                      :RAREA                                            00908000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00909000
         BALR  4,5                     MOVE INTO RECORD AREA            00910000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00911000
         BR    14                      RETURN TO CALLER                 00912000
         LTORG                                                          00913000
*                                                                       00914000
*                                                                       00915000
**********************************************************************  00916000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00917000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00918000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00919000
*     RETRIEVE THE ACTUAL ROW.                                          00920000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00921000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00922000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00923000
**********************************************************************  00924000
*                                                                       00925000
SQL#0021 DS    0H                                                       00926000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00927000
         LA    15,255                  SET RETURN CODE                  00928000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00929000
         BR    14                      RETURN TO CALLER                 00930000
         LTORG                                                          00931000
*                                                                       00932000
*                                                                       00933000
**********************************************************************  00934000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           00935000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00936000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00937000
*     RETRIEVE THE ACTUAL ROW.                                          00938000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00939000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00940000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00941000
**********************************************************************  00942000
*                                                                       00943000
SQL#0022 DS    0H                                                       00944000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          00945000
         LA    15,255                  SET RETURN CODE                  00946000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00947000
         BR    14                      RETURN TO CALLER                 00948000
         LTORG                                                          00949000
*                                                                       00950000
*                                                                       00951000
**********************************************************************  00952000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           00953000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00954000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00955000
*     RETRIEVE THE ACTUAL ROW.                                          00956000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00957000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00958000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00959000
**********************************************************************  00960000
*                                                                       00961000
SQL#0023 DS    0H                                                       00962000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          00963000
         LA    15,255                  SET RETURN CODE                  00964000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00965000
         BR    14                      RETURN TO CALLER                 00966000
         LTORG                                                          00967000
*                                                                       00968000
*                                                                       00969000
**********************************************************************  00970000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00971000
* THE PRIMARY KEY:                                                      00972000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00973000
*     VERBS.                                                            00974000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00975000
*     RETRIEVE THE ACTUAL ROW.                                          00976000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00977000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00978000
*     WILL BE THRU THE UPDATE CURSOR.                                   00979000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00980000
**********************************************************************  00981000
*                                                                       00982000
SQL#0024 DS    0H                                                       00983000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          00984000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00985000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    00986000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00987000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00988000
VECT0024 DC    A(SQL#0124)                                              00989000
         DC    A(SQL#0224)                                              00990000
         DC    A(SQL#0324)                                              00991000
         DC    A(SQL#0424)                                              00992000
         LTORG                                                          00993000
*                                                                       00994000
SQL#0124 DS    0H                                                       00995000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          00996000
         EXEC  SQL                                                     *00997000
               FETCH SAFSQ001                                          *00998000
                 INTO :INST,                                           *00999000
                      :PRDCDE,                                         *01000000
                      :ACCTNBR,                                        *01001000
                      :MODEL                                            01002000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01003000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01004000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01005000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01006000
         BR    12                      OPEN NEXT CURSOR                 01007000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01008000
         BALR  4,5                     MOVE INTO RECORD AREA            01009000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01010000
         BR    14                      RETURN TO CALLER                 01011000
         LTORG                                                          01012000
*                                                                       01013000
SQL#0224 DS    0H                                                       01014000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01015000
         EXEC  SQL                                                     *01016000
               FETCH SAFSQ002                                          *01017000
                 INTO :INST,                                           *01018000
                      :PRDCDE,                                         *01019000
                      :ACCTNBR,                                        *01020000
                      :MODEL                                            01021000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01022000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01023000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01024000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01025000
         BR    12                      OPEN NEXT CURSOR                 01026000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01027000
         BALR  4,5                     MOVE INTO RECORD AREA            01028000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01029000
         BR    14                      RETURN TO CALLER                 01030000
         LTORG                                                          01031000
*                                                                       01032000
SQL#0324 DS    0H                                                       01033000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01034000
         EXEC  SQL                                                     *01035000
               FETCH SAFSQ003                                          *01036000
                 INTO :INST,                                           *01037000
                      :PRDCDE,                                         *01038000
                      :ACCTNBR,                                        *01039000
                      :MODEL                                            01040000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01041000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01042000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01043000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01044000
         BR    12                      OPEN NEXT CURSOR                 01045000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01046000
         BALR  4,5                     MOVE INTO RECORD AREA            01047000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01048000
         BR    14                      RETURN TO CALLER                 01049000
         LTORG                                                          01050000
*                                                                       01051000
SQL#0424 DS    0H                                                       01052000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          01053000
         EXEC  SQL                                                     *01054000
               FETCH SAFSQ004                                          *01055000
                 INTO :INST,                                           *01056000
                      :PRDCDE,                                         *01057000
                      :ACCTNBR,                                        *01058000
                      :MODEL                                            01059000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01060000
         BALR  4,5                     MOVE INTO RECORD AREA            01061000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01062000
         BR    14                      RETURN TO CALLER                 01063000
         LTORG                                                          01064000
*                                                                       01065000
*                                                                       01066000
**********************************************************************  01067000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01068000
* ALTERNATE KEY 1:                                                      01069000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01070000
*     VERBS.                                                            01071000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01072000
*     RETRIEVE THE ACTUAL ROW.                                          01073000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01074000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01075000
*     WILL BE THRU THE UPDATE CURSOR.                                   01076000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01077000
**********************************************************************  01078000
*                                                                       01079000
SQL#0025 DS    0H                                                       01080000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01081000
         LA    15,255                  SET RETURN CODE                  01082000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01083000
         BR    14                      RETURN TO CALLER                 01084000
         LTORG                                                          01085000
*                                                                       01086000
*                                                                       01087000
**********************************************************************  01088000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01089000
* ALTERNATE KEY 2:                                                      01090000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01091000
*     VERBS.                                                            01092000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01093000
*     RETRIEVE THE ACTUAL ROW.                                          01094000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01095000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01096000
*     WILL BE THRU THE UPDATE CURSOR.                                   01097000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01098000
**********************************************************************  01099000
*                                                                       01100000
SQL#0026 DS    0H                                                       01101000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01102000
         LA    15,255                  SET RETURN CODE                  01103000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01104000
         BR    14                      RETURN TO CALLER                 01105000
         LTORG                                                          01106000
*                                                                       01107000
*                                                                       01108000
**********************************************************************  01109000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01110000
* ALTERNATE KEY 3:                                                      01111000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01112000
*     VERBS.                                                            01113000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01114000
*     RETRIEVE THE ACTUAL ROW.                                          01115000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01116000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01117000
*     WILL BE THRU THE UPDATE CURSOR.                                   01118000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01119000
**********************************************************************  01120000
*                                                                       01121000
SQL#0027 DS    0H                                                       01122000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01123000
         LA    15,255                  SET RETURN CODE                  01124000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01125000
         BR    14                      RETURN TO CALLER                 01126000
         LTORG                                                          01127000
*                                                                       01128000
*                                                                       01129000
**********************************************************************  01130000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01131000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01132000
*     AND GET-NEXT-LOCK VERBS.                                          01133000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01134000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01135000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01136000
**********************************************************************  01137000
*                                                                       01138000
SQL#0028 DS    0H                                                       01139000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01140000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01141000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01142000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01143000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01144000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01145000
VECT0028 DC    A(SQL#0128)                                              01146000
         DC    A(SQL#0228)                                              01147000
         DC    A(SQL#0328)                                              01148000
         DC    A(SQL#0428)                                              01149000
         LTORG                                                          01150000
*                                                                       01151000
SQL#0128 DS    0H                                                       01152000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01153000
         EXEC  SQL                                                     *01154000
               CLOSE SAFSQ001                                           01155000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01156000
         BR    14                      RETURN TO CALLER                 01157000
         LTORG                                                          01158000
*                                                                       01159000
SQL#0228 DS    0H                                                       01160000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01161000
         EXEC  SQL                                                     *01162000
               CLOSE SAFSQ002                                           01163000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01164000
         BR    14                      RETURN TO CALLER                 01165000
         LTORG                                                          01166000
*                                                                       01167000
SQL#0328 DS    0H                                                       01168000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01169000
         EXEC  SQL                                                     *01170000
               CLOSE SAFSQ003                                           01171000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01172000
         BR    14                      RETURN TO CALLER                 01173000
         LTORG                                                          01174000
*                                                                       01175000
SQL#0428 DS    0H                                                       01176000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01177000
         EXEC  SQL                                                     *01178000
               CLOSE SAFSQ004                                           01179000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01180000
         BR    14                      RETURN TO CALLER                 01181000
         LTORG                                                          01182000
*                                                                       01183000
*                                                                       01184000
**********************************************************************  01185000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01186000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01187000
*     AND GET-NEXT-LOCK VERBS.                                          01188000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01189000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01190000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01191000
**********************************************************************  01192000
*                                                                       01193000
SQL#0029 DS    0H                                                       01194000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01195000
         LA    15,255                  SET RETURN CODE                  01196000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01197000
         BR    14                      RETURN TO CALLER                 01198000
         LTORG                                                          01199000
*                                                                       01200000
*                                                                       01201000
**********************************************************************  01202000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01203000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01204000
*     AND GET-NEXT-LOCK VERBS.                                          01205000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01206000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01207000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01208000
**********************************************************************  01209000
*                                                                       01210000
SQL#0030 DS    0H                                                       01211000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01212000
         LA    15,255                  SET RETURN CODE                  01213000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01214000
         BR    14                      RETURN TO CALLER                 01215000
         LTORG                                                          01216000
*                                                                       01217000
*                                                                       01218000
**********************************************************************  01219000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01220000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01221000
*     AND GET-NEXT-LOCK VERBS.                                          01222000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01223000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01224000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01225000
**********************************************************************  01226000
*                                                                       01227000
SQL#0031 DS    0H                                                       01228000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01229000
         LA    15,255                  SET RETURN CODE                  01230000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01231000
         BR    14                      RETURN TO CALLER                 01232000
         LTORG                                                          01233000
*                                                                       01234000
*                                                                       01235000
**********************************************************************  01236000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01237000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01238000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01239000
**********************************************************************  01240000
*                                                                       01241000
SQL#0032 DS    0H                                                       01242000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01243000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01244000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01245000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01246000
         EXEC  SQL                                                     *01247000
               SELECT INST_NBR,                                        *01248000
                   PROD_CODE,                                          *01249000
                   ACCT_NBR,                                           *01250000
                   MODEL                                               *01251000
                 INTO :INST,                                           *01252000
                   :PRDCDE,                                            *01253000
                   :ACCTNBR,                                           *01254000
                   :MODEL                                              *01255000
                 FROM SAF                                              *01256000
                 WHERE INST_NBR = :INST AND                            *01257000
                   PROD_CODE = :PRDCDE AND                             *01258000
                   ACCT_NBR = :ACCTNBR AND                             *01259000
                   MODEL = :MODEL                                      *01260000
                 FETCH FIRST 1 ROW ONLY                                 01261000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01262000
         BR    14                      RETURN TO CALLER                 01263000
         LTORG                                                          01264000
*                                                                       01265000
*                                                                       01266000
**********************************************************************  01267000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01268000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01269000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01270000
**********************************************************************  01271000
*                                                                       01272000
SQL#0033 DS    0H                                                       01273000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01274000
         LA    15,255                  SET RETURN CODE                  01275000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01276000
         BR    14                      RETURN TO CALLER                 01277000
         LTORG                                                          01278000
*                                                                       01279000
*                                                                       01280000
**********************************************************************  01281000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01282000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01283000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01284000
**********************************************************************  01285000
*                                                                       01286000
SQL#0034 DS    0H                                                       01287000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01288000
         LA    15,255                  SET RETURN CODE                  01289000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01290000
         BR    14                      RETURN TO CALLER                 01291000
         LTORG                                                          01292000
*                                                                       01293000
*                                                                       01294000
**********************************************************************  01295000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01296000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01297000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01298000
**********************************************************************  01299000
*                                                                       01300000
SQL#0035 DS    0H                                                       01301000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01302000
         LA    15,255                  SET RETURN CODE                  01303000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01304000
         BR    14                      RETURN TO CALLER                 01305000
         LTORG                                                          01306000
*                                                                       01307000
*                                                                       01308000
**********************************************************************  01309000
* INSERT STATEMENT:                                                     01310000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01311000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01312000
**********************************************************************  01313000
*                                                                       01314000
SQL#0036 DS    0H                                                       01315000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01316000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01317000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01318000
         EXEC  SQL                                                     *01319000
               INSERT INTO SAF                                         *01320000
                   (INST_NBR,                                          *01321000
                    PROD_CODE,                                         *01322000
                    ACCT_NBR,                                          *01323000
                    MODEL,                                             *01324000
                    AUDIT_DATE,                                        *01325000
                    AUDIT_TIME,                                        *01326000
                    AUDIT_USER,                                        *01327000
                    AUDIT_ORG,                                         *01328000
                    RELATION_STATUS,                                   *01329000
                    QLFY_STATUS,                                       *01330000
                    LAST_MAINT_DATE,                                   *01331000
                    INCEN_DATE,                                        *01332000
                    VALID_DATE,                                        *01333000
                    SVC_NEXT_DATE,                                     *01334000
                    DATE_OPEN,                                         *01335000
                    DATE_EXPIRE,                                       *01336000
                    SVC_TODAY_FLAG,                                    *01337000
                    IDENT_NBR,                                         *01338000
                    CMB_BAL_1,                                         *01339000
                    CMB_BAL_2,                                         *01340000
                    CMB_BAL_3,                                         *01341000
                    CMB_BAL_4,                                         *01342000
                    RSV_BAL_2,                                         *01343000
                    RSV_BAL_3,                                         *01344000
                    OUT_FLAG,                                          *01345000
                    VALD_FAIL_EXPR,                                    *01346000
                    EXTENSION,                                         *01347000
                    RETENTION_DAYS,                                    *01348000
                    VALD_FAIL_NBR,                                     *01349000
                    INCEN_FAIL_NBR,                                    *01350000
                    CUST_NBR,                                          *01351000
                    RSV_AREA)                                          *01352000
                  VALUES (:INST,                                       *01353000
                   :PRDCDE,                                            *01354000
                   :ACCTNBR,                                           *01355000
                   :MODEL,                                             *01356000
                   :AUDDATE,                                           *01357000
                   :AUDTIME,                                           *01358000
                   :AUDUSER,                                           *01359000
                   :AUDORG,                                            *01360000
                   :RELATST,                                           *01361000
                   :QLFYST,                                            *01362000
                   :LASTMNTD,                                          *01363000
                   :INCQDTE,                                           *01364000
                   :VALQDATE,                                          *01365000
                   :SVCNDATE,                                          *01366000
                   :DATEOPEN,                                          *01367000
                   :DATEEXPR,                                          *01368000
                   :SVCTDYF,                                           *01369000
                   :IDNBR,                                             *01370000
                   :CMBBAL1,                                           *01371000
                   :CMBBAL2,                                           *01372000
                   :CMBBAL3,                                           *01373000
                   :CMBBAL4,                                           *01374000
                   :RSVBAL2,                                           *01375000
                   :RSVBAL3,                                           *01376000
                   :OUTFLAG,                                           *01377000
                   :VFEXPDAT,                                          *01378000
                   :EXTENSN,                                           *01379000
                   :RETDAYS,                                           *01380000
                   :VFMSGNBR,                                          *01381000
                   :INCMSGNR,                                          *01382000
                   :CUSTNBR,                                           *01383000
                   :RAREA)                                              01384000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01385000
         BR    14                      RETURN TO CALLER                 01386000
         LTORG                                                          01387000
*                                                                       01388000
*                                                                       01389000
**********************************************************************  01390000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01391000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01392000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01393000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01394000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01395000
*     STATEMENT.                                                        01396000
**********************************************************************  01397000
*                                                                       01398000
SQL#0037 DS    0H                                                       01399000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01400000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01401000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01402000
         EXEC  SQL                                                     *01403000
               UPDATE SAF                                              *01404000
                   SET AUDIT_DATE = :AUDDATE,                          *01405000
                     AUDIT_TIME = :AUDTIME,                            *01406000
                     AUDIT_USER = :AUDUSER,                            *01407000
                     AUDIT_ORG = :AUDORG,                              *01408000
                     RELATION_STATUS = :RELATST,                       *01409000
                     QLFY_STATUS = :QLFYST,                            *01410000
                     LAST_MAINT_DATE = :LASTMNTD,                      *01411000
                     INCEN_DATE = :INCQDTE,                            *01412000
                     VALID_DATE = :VALQDATE,                           *01413000
                     SVC_NEXT_DATE = :SVCNDATE,                        *01414000
                     DATE_OPEN = :DATEOPEN,                            *01415000
                     DATE_EXPIRE = :DATEEXPR,                          *01416000
                     SVC_TODAY_FLAG = :SVCTDYF,                        *01417000
                     IDENT_NBR = :IDNBR,                               *01418000
                     CMB_BAL_1 = :CMBBAL1,                             *01419000
                     CMB_BAL_2 = :CMBBAL2,                             *01420000
                     CMB_BAL_3 = :CMBBAL3,                             *01421000
                     CMB_BAL_4 = :CMBBAL4,                             *01422000
                     RSV_BAL_2 = :RSVBAL2,                             *01423000
                     RSV_BAL_3 = :RSVBAL3,                             *01424000
                     OUT_FLAG = :OUTFLAG,                              *01425000
                     VALD_FAIL_EXPR = :VFEXPDAT,                       *01426000
                     EXTENSION = :EXTENSN,                             *01427000
                     RETENTION_DAYS = :RETDAYS,                        *01428000
                     VALD_FAIL_NBR = :VFMSGNBR,                        *01429000
                     INCEN_FAIL_NBR = :INCMSGNR,                       *01430000
                     CUST_NBR = :CUSTNBR,                              *01431000
                     RSV_AREA = :RAREA                                 *01432000
                 WHERE CURRENT OF SAFUPD0                               01433000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01434000
         BR    14                      RETURN TO CALLER                 01435000
         LTORG                                                          01436000
*                                                                       01437000
*                                                                       01438000
**********************************************************************  01439000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01440000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01441000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01442000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01443000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01444000
*     STATEMENT.                                                        01445000
**********************************************************************  01446000
*                                                                       01447000
SQL#0038 DS    0H                                                       01448000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01449000
         LA    15,255                  SET RETURN CODE                  01450000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01451000
         BR    14                      RETURN TO CALLER                 01452000
         LTORG                                                          01453000
*                                                                       01454000
*                                                                       01455000
**********************************************************************  01456000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01457000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01458000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01459000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01460000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01461000
*     STATEMENT.                                                        01462000
**********************************************************************  01463000
*                                                                       01464000
SQL#0039 DS    0H                                                       01465000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01466000
         LA    15,255                  SET RETURN CODE                  01467000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01468000
         BR    14                      RETURN TO CALLER                 01469000
         LTORG                                                          01470000
*                                                                       01471000
*                                                                       01472000
**********************************************************************  01473000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01474000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01475000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01476000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01477000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01478000
*     STATEMENT.                                                        01479000
**********************************************************************  01480000
*                                                                       01481000
SQL#0040 DS    0H                                                       01482000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01483000
         LA    15,255                  SET RETURN CODE                  01484000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01485000
         BR    14                      RETURN TO CALLER                 01486000
         LTORG                                                          01487000
*                                                                       01488000
*                                                                       01489000
**********************************************************************  01490000
* DELETE STATEMENT BY PRIMARY KEY:                                      01491000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01492000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01493000
**********************************************************************  01494000
*                                                                       01495000
SQL#0041 DS    0H                                                       01496000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01497000
         EXEC  SQL                                                     *01498000
               DELETE FROM SAF                                         *01499000
                 WHERE CURRENT OF SAFUPD0                               01500000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01501000
         BR    14                      RETURN TO CALLER                 01502000
         LTORG                                                          01503000
*                                                                       01504000
*                                                                       01505000
**********************************************************************  01506000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01507000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01508000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01509000
**********************************************************************  01510000
*                                                                       01511000
SQL#0042 DS    0H                                                       01512000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01513000
         LA    15,255                  SET RETURN CODE                  01514000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01515000
         BR    14                      RETURN TO CALLER                 01516000
         LTORG                                                          01517000
*                                                                       01518000
*                                                                       01519000
**********************************************************************  01520000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01521000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01522000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01523000
**********************************************************************  01524000
*                                                                       01525000
SQL#0043 DS    0H                                                       01526000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01527000
         LA    15,255                  SET RETURN CODE                  01528000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01529000
         BR    14                      RETURN TO CALLER                 01530000
         LTORG                                                          01531000
*                                                                       01532000
*                                                                       01533000
**********************************************************************  01534000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01535000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01536000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01537000
**********************************************************************  01538000
*                                                                       01539000
SQL#0044 DS    0H                                                       01540000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01541000
         LA    15,255                  SET RETURN CODE                  01542000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01543000
         BR    14                      RETURN TO CALLER                 01544000
         LTORG                                                          01545000
*                                                                       01546000
*                                                                       01547000
**********************************************************************  01548000
* DELETE ALL STATEMENT:                                                 01549000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01550000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01551000
**********************************************************************  01552000
*                                                                       01553000
SQL#0045 DS    0H                                                       01554000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01555000
         EXEC  SQL                                                     *01556000
               DELETE FROM SAF                                          01557000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01558000
         BR    14                      RETURN TO CALLER                 01559000
         LTORG                                                          01560000
*                                                                       01561000
*                                                                       01562000
**********************************************************************  01563000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01564000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01565000
**********************************************************************  01566000
*                                                                       01567000
SQL#0046 DS    0H                                                       01568000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01569000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01570000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01571000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01572000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01573000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01574000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01575000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01576000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01577000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01578000
VECT0046 DC    A(0)                                                     01579000
         DC    A(SQL#0246)                                              01580000
         DC    A(SQL#0346)                                              01581000
         DC    A(SQL#0446)                                              01582000
         LTORG                                                          01583000
*                                                                       01584000
SQL#0246 DS    0H                                                       01585000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01586000
         EXEC  SQL                                                     *01587000
               CLOSE SAFSQ001                                           01588000
         EXEC  SQL                                                     *01589000
               DECLARE SAFSQ002 CURSOR FOR                             *01590000
               SELECT INST_NBR,                                        *01591000
                   PROD_CODE,                                          *01592000
                   ACCT_NBR,                                           *01593000
                   MODEL,                                              *01594000
                   AUDIT_DATE,                                         *01595000
                   AUDIT_TIME,                                         *01596000
                   AUDIT_USER,                                         *01597000
                   AUDIT_ORG,                                          *01598000
                   RELATION_STATUS,                                    *01599000
                   QLFY_STATUS,                                        *01600000
                   LAST_MAINT_DATE,                                    *01601000
                   INCEN_DATE,                                         *01602000
                   VALID_DATE,                                         *01603000
                   SVC_NEXT_DATE,                                      *01604000
                   DATE_OPEN,                                          *01605000
                   DATE_EXPIRE,                                        *01606000
                   SVC_TODAY_FLAG,                                     *01607000
                   IDENT_NBR,                                          *01608000
                   CMB_BAL_1,                                          *01609000
                   CMB_BAL_2,                                          *01610000
                   CMB_BAL_3,                                          *01611000
                   CMB_BAL_4,                                          *01612000
                   RSV_BAL_2,                                          *01613000
                   RSV_BAL_3,                                          *01614000
                   OUT_FLAG,                                           *01615000
                   VALD_FAIL_EXPR,                                     *01616000
                   EXTENSION,                                          *01617000
                   RETENTION_DAYS,                                     *01618000
                   VALD_FAIL_NBR,                                      *01619000
                   INCEN_FAIL_NBR,                                     *01620000
                   CUST_NBR,                                           *01621000
                   RSV_AREA                                            *01622000
                 FROM SAF                                              *01623000
                 WHERE                                                 *01624000
                    INST_NBR = :INST AND                               *01625000
                    PROD_CODE = :PRDCDE AND                            *01626000
                    ACCT_NBR > :ACCTNBR                                *01627000
                 ORDER BY ACCT_NBR,                                    *01628000
                   MODEL                                               *01629000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01630000
         EXEC  SQL                                                     *01631000
               OPEN SAFSQ002                                            01632000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01633000
         BNZ   *+8                     NO - RETURN ERROR                01634000
         LR    12,9                    LOAD RETURN ADDRESS              01635000
         BR    12                      RETURN TO FETCH ROUTINE          01636000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01637000
         BR    14                      RETURN TO CALLER                 01638000
         LTORG                                                          01639000
*                                                                       01640000
SQL#0346 DS    0H                                                       01641000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01642000
         EXEC  SQL                                                     *01643000
               CLOSE SAFSQ002                                           01644000
         EXEC  SQL                                                     *01645000
               DECLARE SAFSQ003 CURSOR FOR                             *01646000
               SELECT INST_NBR,                                        *01647000
                   PROD_CODE,                                          *01648000
                   ACCT_NBR,                                           *01649000
                   MODEL,                                              *01650000
                   AUDIT_DATE,                                         *01651000
                   AUDIT_TIME,                                         *01652000
                   AUDIT_USER,                                         *01653000
                   AUDIT_ORG,                                          *01654000
                   RELATION_STATUS,                                    *01655000
                   QLFY_STATUS,                                        *01656000
                   LAST_MAINT_DATE,                                    *01657000
                   INCEN_DATE,                                         *01658000
                   VALID_DATE,                                         *01659000
                   SVC_NEXT_DATE,                                      *01660000
                   DATE_OPEN,                                          *01661000
                   DATE_EXPIRE,                                        *01662000
                   SVC_TODAY_FLAG,                                     *01663000
                   IDENT_NBR,                                          *01664000
                   CMB_BAL_1,                                          *01665000
                   CMB_BAL_2,                                          *01666000
                   CMB_BAL_3,                                          *01667000
                   CMB_BAL_4,                                          *01668000
                   RSV_BAL_2,                                          *01669000
                   RSV_BAL_3,                                          *01670000
                   OUT_FLAG,                                           *01671000
                   VALD_FAIL_EXPR,                                     *01672000
                   EXTENSION,                                          *01673000
                   RETENTION_DAYS,                                     *01674000
                   VALD_FAIL_NBR,                                      *01675000
                   INCEN_FAIL_NBR,                                     *01676000
                   CUST_NBR,                                           *01677000
                   RSV_AREA                                            *01678000
                 FROM SAF                                              *01679000
                 WHERE                                                 *01680000
                    INST_NBR = :INST AND                               *01681000
                    PROD_CODE > :PRDCDE                                *01682000
                 ORDER BY PROD_CODE,                                   *01683000
                   ACCT_NBR,                                           *01684000
                   MODEL                                               *01685000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01686000
         EXEC  SQL                                                     *01687000
               OPEN SAFSQ003                                            01688000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01689000
         BNZ   *+8                     NO - RETURN ERROR                01690000
         LR    12,9                    LOAD RETURN ADDRESS              01691000
         BR    12                      RETURN TO FETCH ROUTINE          01692000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01693000
         BR    14                      RETURN TO CALLER                 01694000
         LTORG                                                          01695000
*                                                                       01696000
SQL#0446 DS    0H                                                       01697000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          01698000
         EXEC  SQL                                                     *01699000
               CLOSE SAFSQ003                                           01700000
         EXEC  SQL                                                     *01701000
               DECLARE SAFSQ004 CURSOR FOR                             *01702000
               SELECT INST_NBR,                                        *01703000
                   PROD_CODE,                                          *01704000
                   ACCT_NBR,                                           *01705000
                   MODEL,                                              *01706000
                   AUDIT_DATE,                                         *01707000
                   AUDIT_TIME,                                         *01708000
                   AUDIT_USER,                                         *01709000
                   AUDIT_ORG,                                          *01710000
                   RELATION_STATUS,                                    *01711000
                   QLFY_STATUS,                                        *01712000
                   LAST_MAINT_DATE,                                    *01713000
                   INCEN_DATE,                                         *01714000
                   VALID_DATE,                                         *01715000
                   SVC_NEXT_DATE,                                      *01716000
                   DATE_OPEN,                                          *01717000
                   DATE_EXPIRE,                                        *01718000
                   SVC_TODAY_FLAG,                                     *01719000
                   IDENT_NBR,                                          *01720000
                   CMB_BAL_1,                                          *01721000
                   CMB_BAL_2,                                          *01722000
                   CMB_BAL_3,                                          *01723000
                   CMB_BAL_4,                                          *01724000
                   RSV_BAL_2,                                          *01725000
                   RSV_BAL_3,                                          *01726000
                   OUT_FLAG,                                           *01727000
                   VALD_FAIL_EXPR,                                     *01728000
                   EXTENSION,                                          *01729000
                   RETENTION_DAYS,                                     *01730000
                   VALD_FAIL_NBR,                                      *01731000
                   INCEN_FAIL_NBR,                                     *01732000
                   CUST_NBR,                                           *01733000
                   RSV_AREA                                            *01734000
                 FROM SAF                                              *01735000
                 WHERE                                                 *01736000
                    INST_NBR > :INST                                   *01737000
                 ORDER BY INST_NBR,                                    *01738000
                   PROD_CODE,                                          *01739000
                   ACCT_NBR,                                           *01740000
                   MODEL                                               *01741000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01742000
         EXEC  SQL                                                     *01743000
               OPEN SAFSQ004                                            01744000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01745000
         BNZ   *+8                     NO - RETURN ERROR                01746000
         LR    12,9                    LOAD RETURN ADDRESS              01747000
         BR    12                      RETURN TO FETCH ROUTINE          01748000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01749000
         BR    14                      RETURN TO CALLER                 01750000
         LTORG                                                          01751000
*                                                                       01752000
*                                                                       01753000
**********************************************************************  01754000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01755000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01756000
**********************************************************************  01757000
*                                                                       01758000
SQL#0047 DS    0H                                                       01759000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01760000
         LA    15,255                  SET RETURN CODE                  01761000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01762000
         BR    14                      RETURN TO CALLER                 01763000
         LTORG                                                          01764000
*                                                                       01765000
*                                                                       01766000
**********************************************************************  01767000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01768000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01769000
**********************************************************************  01770000
*                                                                       01771000
SQL#0048 DS    0H                                                       01772000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01773000
         LA    15,255                  SET RETURN CODE                  01774000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01775000
         BR    14                      RETURN TO CALLER                 01776000
         LTORG                                                          01777000
*                                                                       01778000
*                                                                       01779000
**********************************************************************  01780000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01781000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01782000
**********************************************************************  01783000
*                                                                       01784000
SQL#0049 DS    0H                                                       01785000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01786000
         LA    15,255                  SET RETURN CODE                  01787000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01788000
         BR    14                      RETURN TO CALLER                 01789000
         LTORG                                                          01790000
*                                                                       01791000
         DS    0H                      END OF SQL STATEMENTS            01792000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01793000
*                                                                       01794000
*                                                                       01795000
**********************************************************************  01796000
* DUMMY ENTRY POINT DSNHLI                                              01797000
*   MUST NOT BE MODIFIED.                                               01798000
**********************************************************************  01799000
*                                                                       01800000
         ENTRY DSNHLI                                                   01801000
DSNHLI   DS    0H                                                       01802000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01803000
         BR    15                      BRANCH TO ATTACH FACILITY        01804000
*                                                                       01805000
*                                                                       01806000
**********************************************************************  01807000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01808000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01809000
*   MUST NOT BE MODIFIED.                                               01810000
**********************************************************************  01811000
*                                                                       01812000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01813000
CONV#RTN AMODE ANY                                                      01814000
CONV#RTN RMODE ANY                                                      01815000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01816000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01817000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01818000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01819000
         BER   4                         YES - RETURN TO SQL            01820000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01821000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01822000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01823000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01824000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01825000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01826000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01827000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01828000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01829000
*                                                                       01830000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01831000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01832000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01833000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01834000
         BER   4                         YES - RETURN TO SQL            01835000
         SLR   0,0                     CLEAR FOR INSERT                 01836000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01837000
         NR    0,3                     FOR THE CURRENT KEY?             01838000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01839000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01840000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01841000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01842000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01843000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01844000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01845000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01846000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01847000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01848000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01849000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01850000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01851000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01852000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01853000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01854000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01855000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01856000
*                                                                       01857000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01858000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01859000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01860000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01861000
         BER   4                         YES - RETURN TO SQL            01862000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01863000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01864000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01865000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01866000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01867000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01868000
         MVCL  0,14                    MOVE TO RECORD AREA              01869000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01870000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01871000
*                                                                       01872000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01873000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01874000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01875000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01876000
         BER   4                         YES - RETURN TO SQL            01877000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01878000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01879000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01880000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01881000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01882000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01883000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01884000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01885000
         MVCL  0,14                    MOVE TO RECORD AREA              01886000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01887000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01888000
*                                                                       01889000
*                                                                       01890000
**********************************************************************  01891000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01892000
*   MUST NOT BE MODIFIED.                                               01893000
**********************************************************************  01894000
*                                                                       01895000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01896000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01897000
         DC    H'0038'                 LENGTH TO MOVE                   01898000
         DC    X'80'                   80 = KEY 0 FIELD                 01899000
*                                      40 = KEY 1 FIELD                 01900000
*                                      20 = KEY 2 FIELD                 01901000
*                                      10 = KEY 3 FIELD                 01902000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        01903000
*                                                                       01904000
*                                      REST OF FIELD ENTRIES            01905000
         DC    H'0038',H'0038',H'0200',X'00',X'00'                      01906000
         DC    8X'FF'                  END OF FIELD ENTRIES             01907000
         LTORG                                                          01908000
         END                                                            01909000
