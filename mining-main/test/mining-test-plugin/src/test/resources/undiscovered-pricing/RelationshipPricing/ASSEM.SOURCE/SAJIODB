* REL=SAJIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SAJIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAJ FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL111                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
APPLNBR  DS    CL2                                                      00039000
ACCTNBR  DS    CL18                                                     00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
PRODCODE DS    CL6                                                      00045000
SCINCENO DS    CL1                                                      00046000
INCENQ   DS    CL1                                                      00047000
RINCENO  DS    CL1                                                      00048000
RINCENQ  DS    CL1                                                      00049000
PROCOPT  DS    CL1                                                      00050000
INCENU1  DS    CL1                                                      00051000
INCENU2  DS    CL1                                                      00052000
INCENU3  DS    CL1                                                      00053000
INCENU4  DS    CL1                                                      00054000
INCENU5  DS    CL1                                                      00055000
RAREA    DS    CL47                                                     00056000
*                                                                       00057000
*                                                                       00058000
**********************************************************************  00059000
* PROGRAM TABLE HEADER SECTION:                                         00060000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00061000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00062000
**********************************************************************  00063000
*                                                                       00064000
SAJIODB  CSECT                         PROGRAM TABLE SECTION            00065000
SAJIODB  AMODE ANY                                                      00066000
SAJIODB  RMODE ANY                                                      00067000
         DC    CL9'SAJIODB'            PROGRAM ID                       00068000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00069000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00070000
         DC    A(0)                    RESERVED                         00071000
         DC    A(0)                    RESERVED                         00072000
         DC    24CL1' '                RESERVED                         00073000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00074000
*                                                                       00075000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00076000
         DC    CL29'WWW.INFOR.COM                '                      00076001
*                                                                       00077000
*                                                                       00078000
**********************************************************************  00079000
* STATEMENT TABLE SECTION:                                              00080000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00081000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00082000
*   SHOULD NOT BE MODIFIED.                                             00083000
**********************************************************************  00084000
*                                                                       00085000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00086000
STM#TAB  AMODE ANY                                                      00087000
STM#TAB  RMODE ANY                                                      00088000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00089000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00090000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00091000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00092000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00093000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00094000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00095000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00096000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00097000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00098000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00099000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00100000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00101000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00102000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00103000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00104000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00105000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00106000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00107000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00108000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00109000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00110000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00111000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00112000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00113000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00114000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00115000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00116000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00117000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00118000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00119000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00120000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00121000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00122000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00123000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00124000
         DC    A(SQL#0036)             INSERT STATEMENT                 00125000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00126000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00127000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00128000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00129000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00130000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00131000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00132000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00133000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00134000
         DC    4X'FF'                                                   00135000
*                                                                       00136000
*                                                                       00137000
**********************************************************************  00138000
* SQL STATEMENT SECTION:                                                00139000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00140000
*     TO SUPPORT THIS TABLE.                                            00141000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00142000
*     ARE EQUIVALENT.                                                   00143000
**********************************************************************  00144000
*                                                                       00145000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00146000
SQL#STMT AMODE ANY                                                      00147000
SQL#STMT RMODE ANY                                                      00148000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00149000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00150000
         USING COM#AREA,11             ADDRESS COMMAREA                 00151000
*                                                                       00152000
*                                                                       00153000
**********************************************************************  00154000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00155000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00156000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00157000
**********************************************************************  00158000
*                                                                       00159000
SQL#0000 DS    0H                                                       00160000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00161000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00162000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00163000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00164000
         EXEC  SQL                                                     *00165000
               SELECT AUDIT_DATE,                                      *00166000
                   AUDIT_TIME,                                         *00167000
                   AUDIT_USER,                                         *00168000
                   AUDIT_ORG,                                          *00169000
                   PROD_CODE,                                          *00170000
                   SVC_INCEN_OPT,                                      *00171000
                   SVC_INCEN_QLFY,                                     *00172000
                   RATE_INCEN_OPT,                                     *00173000
                   RATE_INCEN_QLFY,                                    *00174000
                   PROCESS_OPTION,                                     *00175000
                   INCTIVE_USER_1,                                     *00176000
                   INCTIVE_USER_2,                                     *00177000
                   INCTIVE_USER_3,                                     *00178000
                   INCTIVE_USER_4,                                     *00179000
                   INCTIVE_USER_5,                                     *00180000
                   RSV_AREA                                            *00181000
                 INTO :AUDDATE,                                        *00182000
                   :AUDTIME,                                           *00183000
                   :AUDUSER,                                           *00184000
                   :AUDORG,                                            *00185000
                   :PRODCODE,                                          *00186000
                   :SCINCENO,                                          *00187000
                   :INCENQ,                                            *00188000
                   :RINCENO,                                           *00189000
                   :RINCENQ,                                           *00190000
                   :PROCOPT,                                           *00191000
                   :INCENU1,                                           *00192000
                   :INCENU2,                                           *00193000
                   :INCENU3,                                           *00194000
                   :INCENU4,                                           *00195000
                   :INCENU5,                                           *00196000
                   :RAREA                                              *00197000
                 FROM SAJ                                              *00198000
                 WHERE INST_NBR = :INST AND                            *00199000
                   APPL_NBR = :APPLNBR AND                             *00200000
                   ACCT_NBR = :ACCTNBR                                 *00201000
                 FETCH FIRST 1 ROW ONLY                                 00202000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00203000
         BALR  4,5                     MOVE INTO RECORD AREA            00204000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00205000
         BR    14                      RETURN TO CALLER                 00206000
         LTORG                                                          00207000
*                                                                       00208000
*                                                                       00209000
**********************************************************************  00210000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00211000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00212000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00213000
**********************************************************************  00214000
*                                                                       00215000
SQL#0001 DS    0H                                                       00216000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00217000
         LA    15,255                  SET RETURN CODE                  00218000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00219000
         BR    14                      RETURN TO CALLER                 00220000
         LTORG                                                          00221000
*                                                                       00222000
*                                                                       00223000
**********************************************************************  00224000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00225000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00226000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00227000
**********************************************************************  00228000
*                                                                       00229000
SQL#0002 DS    0H                                                       00230000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00231000
         LA    15,255                  SET RETURN CODE                  00232000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00233000
         BR    14                      RETURN TO CALLER                 00234000
         LTORG                                                          00235000
*                                                                       00236000
*                                                                       00237000
**********************************************************************  00238000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00239000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00240000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00241000
**********************************************************************  00242000
*                                                                       00243000
SQL#0003 DS    0H                                                       00244000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00245000
         LA    15,255                  SET RETURN CODE                  00246000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00247000
         BR    14                      RETURN TO CALLER                 00248000
         LTORG                                                          00249000
*                                                                       00250000
*                                                                       00251000
**********************************************************************  00252000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00253000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00254000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00255000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00256000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00257000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00258000
*     UPDATE STATEMENT TO MATCH.                                        00259000
**********************************************************************  00260000
*                                                                       00261000
SQL#0004 DS    0H                                                       00262000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00263000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00264000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00265000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00266000
         EXEC  SQL                                                     *00267000
               DECLARE SAJUPD0 CURSOR FOR                              *00268000
               SELECT AUDIT_DATE,                                      *00269000
                   AUDIT_TIME,                                         *00270000
                   AUDIT_USER,                                         *00271000
                   AUDIT_ORG,                                          *00272000
                   PROD_CODE,                                          *00273000
                   SVC_INCEN_OPT,                                      *00274000
                   SVC_INCEN_QLFY,                                     *00275000
                   RATE_INCEN_OPT,                                     *00276000
                   RATE_INCEN_QLFY,                                    *00277000
                   PROCESS_OPTION,                                     *00278000
                   INCTIVE_USER_1,                                     *00279000
                   INCTIVE_USER_2,                                     *00280000
                   INCTIVE_USER_3,                                     *00281000
                   INCTIVE_USER_4,                                     *00282000
                   INCTIVE_USER_5,                                     *00283000
                   RSV_AREA                                            *00284000
                 FROM SAJ                                              *00285000
                 WHERE INST_NBR = :INST AND                            *00286000
                   APPL_NBR = :APPLNBR AND                             *00287000
                   ACCT_NBR = :ACCTNBR                                 *00288000
                 FOR UPDATE OF AUDIT_DATE,                             *00289000
                   AUDIT_TIME,                                         *00290000
                   AUDIT_USER,                                         *00291000
                   AUDIT_ORG,                                          *00292000
                   PROD_CODE,                                          *00293000
                   SVC_INCEN_OPT,                                      *00294000
                   SVC_INCEN_QLFY,                                     *00295000
                   RATE_INCEN_OPT,                                     *00296000
                   RATE_INCEN_QLFY,                                    *00297000
                   PROCESS_OPTION,                                     *00298000
                   INCTIVE_USER_1,                                     *00299000
                   INCTIVE_USER_2,                                     *00300000
                   INCTIVE_USER_3,                                     *00301000
                   INCTIVE_USER_4,                                     *00302000
                   INCTIVE_USER_5,                                     *00303000
                   RSV_AREA                                            *00304000
                 FETCH FIRST 1 ROW ONLY                                 00305000
         EXEC  SQL                                                     *00306000
               OPEN SAJUPD0                                             00307000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00308000
         BR    14                      RETURN TO CALLER                 00309000
         LTORG                                                          00310000
*                                                                       00311000
*                                                                       00312000
**********************************************************************  00313000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00314000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00315000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00316000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00317000
*     UPDATE STATEMENT TO MATCH.                                        00318000
**********************************************************************  00319000
*                                                                       00320000
SQL#0005 DS    0H                                                       00321000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00322000
         LA    15,255                  SET RETURN CODE                  00323000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00324000
         BR    14                      RETURN TO CALLER                 00325000
         LTORG                                                          00326000
*                                                                       00327000
*                                                                       00328000
**********************************************************************  00329000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00330000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00331000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00332000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00333000
*     UPDATE STATEMENT TO MATCH.                                        00334000
**********************************************************************  00335000
*                                                                       00336000
SQL#0006 DS    0H                                                       00337000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00338000
         LA    15,255                  SET RETURN CODE                  00339000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00340000
         BR    14                      RETURN TO CALLER                 00341000
         LTORG                                                          00342000
*                                                                       00343000
*                                                                       00344000
**********************************************************************  00345000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00346000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00347000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00348000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00349000
*     UPDATE STATEMENT TO MATCH.                                        00350000
**********************************************************************  00351000
*                                                                       00352000
SQL#0007 DS    0H                                                       00353000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00354000
         LA    15,255                  SET RETURN CODE                  00355000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00356000
         BR    14                      RETURN TO CALLER                 00357000
         LTORG                                                          00358000
*                                                                       00359000
*                                                                       00360000
**********************************************************************  00361000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00362000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00363000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00364000
*     THE ACTUAL ROW.                                                   00365000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00366000
**********************************************************************  00367000
*                                                                       00368000
SQL#0008 DS    0H                                                       00369000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00370000
         EXEC  SQL                                                     *00371000
               FETCH SAJUPD0                                           *00372000
                 INTO :AUDDATE,                                        *00373000
                   :AUDTIME,                                           *00374000
                   :AUDUSER,                                           *00375000
                   :AUDORG,                                            *00376000
                   :PRODCODE,                                          *00377000
                   :SCINCENO,                                          *00378000
                   :INCENQ,                                            *00379000
                   :RINCENO,                                           *00380000
                   :RINCENQ,                                           *00381000
                   :PROCOPT,                                           *00382000
                   :INCENU1,                                           *00383000
                   :INCENU2,                                           *00384000
                   :INCENU3,                                           *00385000
                   :INCENU4,                                           *00386000
                   :INCENU5,                                           *00387000
                   :RAREA                                               00388000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00389000
         BALR  4,5                     MOVE INTO RECORD AREA            00390000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00391000
         BR    14                      RETURN TO CALLER                 00392000
         LTORG                                                          00393000
*                                                                       00394000
*                                                                       00395000
**********************************************************************  00396000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00397000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00398000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00399000
*     THE ACTUAL ROW.                                                   00400000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00401000
**********************************************************************  00402000
*                                                                       00403000
SQL#0009 DS    0H                                                       00404000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00405000
         LA    15,255                  SET RETURN CODE                  00406000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00407000
         BR    14                      RETURN TO CALLER                 00408000
         LTORG                                                          00409000
*                                                                       00410000
*                                                                       00411000
**********************************************************************  00412000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00413000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00414000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00415000
*     THE ACTUAL ROW.                                                   00416000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00417000
**********************************************************************  00418000
*                                                                       00419000
SQL#0010 DS    0H                                                       00420000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00421000
         LA    15,255                  SET RETURN CODE                  00422000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00423000
         BR    14                      RETURN TO CALLER                 00424000
         LTORG                                                          00425000
*                                                                       00426000
*                                                                       00427000
**********************************************************************  00428000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00429000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00430000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00431000
*     THE ACTUAL ROW.                                                   00432000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00433000
**********************************************************************  00434000
*                                                                       00435000
SQL#0011 DS    0H                                                       00436000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00437000
         LA    15,255                  SET RETURN CODE                  00438000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00439000
         BR    14                      RETURN TO CALLER                 00440000
         LTORG                                                          00441000
*                                                                       00442000
*                                                                       00443000
**********************************************************************  00444000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00445000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00446000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00447000
*     TO CLOSE THE UPDATE CURSOR.                                       00448000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00449000
**********************************************************************  00450000
*                                                                       00451000
SQL#0012 DS    0H                                                       00452000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00453000
         EXEC  SQL                                                     *00454000
               CLOSE SAJUPD0                                            00455000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00456000
         BR    14                      RETURN TO CALLER                 00457000
         LTORG                                                          00458000
*                                                                       00459000
*                                                                       00460000
**********************************************************************  00461000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00462000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00463000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00464000
*     TO CLOSE THE UPDATE CURSOR.                                       00465000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00466000
**********************************************************************  00467000
*                                                                       00468000
SQL#0013 DS    0H                                                       00469000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00470000
         LA    15,255                  SET RETURN CODE                  00471000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00472000
         BR    14                      RETURN TO CALLER                 00473000
         LTORG                                                          00474000
*                                                                       00475000
*                                                                       00476000
**********************************************************************  00477000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00478000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00479000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00480000
*     TO CLOSE THE UPDATE CURSOR.                                       00481000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00482000
**********************************************************************  00483000
*                                                                       00484000
SQL#0014 DS    0H                                                       00485000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00486000
         LA    15,255                  SET RETURN CODE                  00487000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00488000
         BR    14                      RETURN TO CALLER                 00489000
         LTORG                                                          00490000
*                                                                       00491000
*                                                                       00492000
**********************************************************************  00493000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00494000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00495000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00496000
*     TO CLOSE THE UPDATE CURSOR.                                       00497000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00498000
**********************************************************************  00499000
*                                                                       00500000
SQL#0015 DS    0H                                                       00501000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00502000
         LA    15,255                  SET RETURN CODE                  00503000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00504000
         BR    14                      RETURN TO CALLER                 00505000
         LTORG                                                          00506000
*                                                                       00507000
*                                                                       00508000
**********************************************************************  00509000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00510000
* KEY:                                                                  00511000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00512000
*     AND GET-NEXT-LOCK VERBS.                                          00513000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00514000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00515000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00516000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00517000
*     ORDER BY CLAUSE.                                                  00518000
**********************************************************************  00519000
*                                                                       00520000
SQL#0016 DS    0H                                                       00521000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00522000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00523000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00524000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00525000
         EXEC  SQL                                                     *00526000
               DECLARE SAJSQ001 CURSOR FOR                             *00527000
               SELECT INST_NBR,                                        *00528000
                   APPL_NBR,                                           *00529000
                   ACCT_NBR,                                           *00530000
                   AUDIT_DATE,                                         *00531000
                   AUDIT_TIME,                                         *00532000
                   AUDIT_USER,                                         *00533000
                   AUDIT_ORG,                                          *00534000
                   PROD_CODE,                                          *00535000
                   SVC_INCEN_OPT,                                      *00536000
                   SVC_INCEN_QLFY,                                     *00537000
                   RATE_INCEN_OPT,                                     *00538000
                   RATE_INCEN_QLFY,                                    *00539000
                   PROCESS_OPTION,                                     *00540000
                   INCTIVE_USER_1,                                     *00541000
                   INCTIVE_USER_2,                                     *00542000
                   INCTIVE_USER_3,                                     *00543000
                   INCTIVE_USER_4,                                     *00544000
                   INCTIVE_USER_5,                                     *00545000
                   RSV_AREA                                            *00546000
                 FROM SAJ                                              *00547000
                 WHERE                                                 *00548000
                    INST_NBR = :INST AND                               *00549000
                    APPL_NBR = :APPLNBR AND                            *00550000
                    ACCT_NBR >= :ACCTNBR                               *00551000
                 ORDER BY ACCT_NBR                                     *00552000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00553000
         EXEC  SQL                                                     *00554000
               OPEN SAJSQ001                                            00555000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00556000
         BR    14                      RETURN TO CALLER                 00557000
         LTORG                                                          00558000
*                                                                       00559000
*                                                                       00560000
**********************************************************************  00561000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00562000
* KEY 1:                                                                00563000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00564000
*     AND GET-NEXT-LOCK VERBS.                                          00565000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00566000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00567000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00568000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00569000
*     ORDER BY CLAUSE.                                                  00570000
**********************************************************************  00571000
*                                                                       00572000
SQL#0017 DS    0H                                                       00573000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00574000
         LA    15,255                  SET RETURN CODE                  00575000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00576000
         BR    14                      RETURN TO CALLER                 00577000
         LTORG                                                          00578000
*                                                                       00579000
*                                                                       00580000
**********************************************************************  00581000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00582000
* KEY 2:                                                                00583000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00584000
*     AND GET-NEXT-LOCK VERBS.                                          00585000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00586000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00587000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00588000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00589000
*     ORDER BY CLAUSE.                                                  00590000
**********************************************************************  00591000
*                                                                       00592000
SQL#0018 DS    0H                                                       00593000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00594000
         LA    15,255                  SET RETURN CODE                  00595000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00596000
         BR    14                      RETURN TO CALLER                 00597000
         LTORG                                                          00598000
*                                                                       00599000
*                                                                       00600000
**********************************************************************  00601000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00602000
* KEY 3:                                                                00603000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00604000
*     AND GET-NEXT-LOCK VERBS.                                          00605000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00606000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00607000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00608000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00609000
*     ORDER BY CLAUSE.                                                  00610000
**********************************************************************  00611000
*                                                                       00612000
SQL#0019 DS    0H                                                       00613000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00614000
         LA    15,255                  SET RETURN CODE                  00615000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00616000
         BR    14                      RETURN TO CALLER                 00617000
         LTORG                                                          00618000
*                                                                       00619000
*                                                                       00620000
**********************************************************************  00621000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00622000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00623000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00624000
*     RETRIEVE THE ACTUAL ROW.                                          00625000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00626000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00627000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00628000
**********************************************************************  00629000
*                                                                       00630000
SQL#0020 DS    0H                                                       00631000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00632000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00633000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00634000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00635000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00636000
VECT0020 DC    A(SQL#0120)                                              00637000
         DC    A(SQL#0220)                                              00638000
         DC    A(SQL#0320)                                              00639000
         LTORG                                                          00640000
*                                                                       00641000
SQL#0120 DS    0H                                                       00642000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00643000
         EXEC  SQL                                                     *00644000
               FETCH SAJSQ001                                          *00645000
                 INTO :INST,                                           *00646000
                      :APPLNBR,                                        *00647000
                      :ACCTNBR,                                        *00648000
                      :AUDDATE,                                        *00649000
                      :AUDTIME,                                        *00650000
                      :AUDUSER,                                        *00651000
                      :AUDORG,                                         *00652000
                      :PRODCODE,                                       *00653000
                      :SCINCENO,                                       *00654000
                      :INCENQ,                                         *00655000
                      :RINCENO,                                        *00656000
                      :RINCENQ,                                        *00657000
                      :PROCOPT,                                        *00658000
                      :INCENU1,                                        *00659000
                      :INCENU2,                                        *00660000
                      :INCENU3,                                        *00661000
                      :INCENU4,                                        *00662000
                      :INCENU5,                                        *00663000
                      :RAREA                                            00664000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00665000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00666000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00667000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00668000
         BR    12                      OPEN NEXT CURSOR                 00669000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00670000
         BALR  4,5                     MOVE INTO RECORD AREA            00671000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00672000
         BR    14                      RETURN TO CALLER                 00673000
         LTORG                                                          00674000
*                                                                       00675000
SQL#0220 DS    0H                                                       00676000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00677000
         EXEC  SQL                                                     *00678000
               FETCH SAJSQ002                                          *00679000
                 INTO :INST,                                           *00680000
                      :APPLNBR,                                        *00681000
                      :ACCTNBR,                                        *00682000
                      :AUDDATE,                                        *00683000
                      :AUDTIME,                                        *00684000
                      :AUDUSER,                                        *00685000
                      :AUDORG,                                         *00686000
                      :PRODCODE,                                       *00687000
                      :SCINCENO,                                       *00688000
                      :INCENQ,                                         *00689000
                      :RINCENO,                                        *00690000
                      :RINCENQ,                                        *00691000
                      :PROCOPT,                                        *00692000
                      :INCENU1,                                        *00693000
                      :INCENU2,                                        *00694000
                      :INCENU3,                                        *00695000
                      :INCENU4,                                        *00696000
                      :INCENU5,                                        *00697000
                      :RAREA                                            00698000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00699000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00700000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00701000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00702000
         BR    12                      OPEN NEXT CURSOR                 00703000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00704000
         BALR  4,5                     MOVE INTO RECORD AREA            00705000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00706000
         BR    14                      RETURN TO CALLER                 00707000
         LTORG                                                          00708000
*                                                                       00709000
SQL#0320 DS    0H                                                       00710000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00711000
         EXEC  SQL                                                     *00712000
               FETCH SAJSQ003                                          *00713000
                 INTO :INST,                                           *00714000
                      :APPLNBR,                                        *00715000
                      :ACCTNBR,                                        *00716000
                      :AUDDATE,                                        *00717000
                      :AUDTIME,                                        *00718000
                      :AUDUSER,                                        *00719000
                      :AUDORG,                                         *00720000
                      :PRODCODE,                                       *00721000
                      :SCINCENO,                                       *00722000
                      :INCENQ,                                         *00723000
                      :RINCENO,                                        *00724000
                      :RINCENQ,                                        *00725000
                      :PROCOPT,                                        *00726000
                      :INCENU1,                                        *00727000
                      :INCENU2,                                        *00728000
                      :INCENU3,                                        *00729000
                      :INCENU4,                                        *00730000
                      :INCENU5,                                        *00731000
                      :RAREA                                            00732000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00733000
         BALR  4,5                     MOVE INTO RECORD AREA            00734000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00735000
         BR    14                      RETURN TO CALLER                 00736000
         LTORG                                                          00737000
*                                                                       00738000
*                                                                       00739000
**********************************************************************  00740000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00741000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00742000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00743000
*     RETRIEVE THE ACTUAL ROW.                                          00744000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00745000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00746000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00747000
**********************************************************************  00748000
*                                                                       00749000
SQL#0021 DS    0H                                                       00750000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00751000
         LA    15,255                  SET RETURN CODE                  00752000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00753000
         BR    14                      RETURN TO CALLER                 00754000
         LTORG                                                          00755000
*                                                                       00756000
*                                                                       00757000
**********************************************************************  00758000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           00759000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00760000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00761000
*     RETRIEVE THE ACTUAL ROW.                                          00762000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00763000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00764000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00765000
**********************************************************************  00766000
*                                                                       00767000
SQL#0022 DS    0H                                                       00768000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          00769000
         LA    15,255                  SET RETURN CODE                  00770000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00771000
         BR    14                      RETURN TO CALLER                 00772000
         LTORG                                                          00773000
*                                                                       00774000
*                                                                       00775000
**********************************************************************  00776000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           00777000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00778000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00779000
*     RETRIEVE THE ACTUAL ROW.                                          00780000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00781000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00782000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00783000
**********************************************************************  00784000
*                                                                       00785000
SQL#0023 DS    0H                                                       00786000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          00787000
         LA    15,255                  SET RETURN CODE                  00788000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00789000
         BR    14                      RETURN TO CALLER                 00790000
         LTORG                                                          00791000
*                                                                       00792000
*                                                                       00793000
**********************************************************************  00794000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00795000
* THE PRIMARY KEY:                                                      00796000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00797000
*     VERBS.                                                            00798000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00799000
*     RETRIEVE THE ACTUAL ROW.                                          00800000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00801000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00802000
*     WILL BE THRU THE UPDATE CURSOR.                                   00803000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00804000
**********************************************************************  00805000
*                                                                       00806000
SQL#0024 DS    0H                                                       00807000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          00808000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00809000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    00810000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00811000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00812000
VECT0024 DC    A(SQL#0124)                                              00813000
         DC    A(SQL#0224)                                              00814000
         DC    A(SQL#0324)                                              00815000
         LTORG                                                          00816000
*                                                                       00817000
SQL#0124 DS    0H                                                       00818000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          00819000
         EXEC  SQL                                                     *00820000
               FETCH SAJSQ001                                          *00821000
                 INTO :INST,                                           *00822000
                      :APPLNBR,                                        *00823000
                      :ACCTNBR                                          00824000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00825000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00826000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00827000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00828000
         BR    12                      OPEN NEXT CURSOR                 00829000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00830000
         BALR  4,5                     MOVE INTO RECORD AREA            00831000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00832000
         BR    14                      RETURN TO CALLER                 00833000
         LTORG                                                          00834000
*                                                                       00835000
SQL#0224 DS    0H                                                       00836000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          00837000
         EXEC  SQL                                                     *00838000
               FETCH SAJSQ002                                          *00839000
                 INTO :INST,                                           *00840000
                      :APPLNBR,                                        *00841000
                      :ACCTNBR                                          00842000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00843000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00844000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00845000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00846000
         BR    12                      OPEN NEXT CURSOR                 00847000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00848000
         BALR  4,5                     MOVE INTO RECORD AREA            00849000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00850000
         BR    14                      RETURN TO CALLER                 00851000
         LTORG                                                          00852000
*                                                                       00853000
SQL#0324 DS    0H                                                       00854000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          00855000
         EXEC  SQL                                                     *00856000
               FETCH SAJSQ003                                          *00857000
                 INTO :INST,                                           *00858000
                      :APPLNBR,                                        *00859000
                      :ACCTNBR                                          00860000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00861000
         BALR  4,5                     MOVE INTO RECORD AREA            00862000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00863000
         BR    14                      RETURN TO CALLER                 00864000
         LTORG                                                          00865000
*                                                                       00866000
*                                                                       00867000
**********************************************************************  00868000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00869000
* ALTERNATE KEY 1:                                                      00870000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00871000
*     VERBS.                                                            00872000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00873000
*     RETRIEVE THE ACTUAL ROW.                                          00874000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00875000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00876000
*     WILL BE THRU THE UPDATE CURSOR.                                   00877000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00878000
**********************************************************************  00879000
*                                                                       00880000
SQL#0025 DS    0H                                                       00881000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          00882000
         LA    15,255                  SET RETURN CODE                  00883000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00884000
         BR    14                      RETURN TO CALLER                 00885000
         LTORG                                                          00886000
*                                                                       00887000
*                                                                       00888000
**********************************************************************  00889000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00890000
* ALTERNATE KEY 2:                                                      00891000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00892000
*     VERBS.                                                            00893000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00894000
*     RETRIEVE THE ACTUAL ROW.                                          00895000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00896000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00897000
*     WILL BE THRU THE UPDATE CURSOR.                                   00898000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00899000
**********************************************************************  00900000
*                                                                       00901000
SQL#0026 DS    0H                                                       00902000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          00903000
         LA    15,255                  SET RETURN CODE                  00904000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00905000
         BR    14                      RETURN TO CALLER                 00906000
         LTORG                                                          00907000
*                                                                       00908000
*                                                                       00909000
**********************************************************************  00910000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00911000
* ALTERNATE KEY 3:                                                      00912000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00913000
*     VERBS.                                                            00914000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00915000
*     RETRIEVE THE ACTUAL ROW.                                          00916000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00917000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00918000
*     WILL BE THRU THE UPDATE CURSOR.                                   00919000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00920000
**********************************************************************  00921000
*                                                                       00922000
SQL#0027 DS    0H                                                       00923000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          00924000
         LA    15,255                  SET RETURN CODE                  00925000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00926000
         BR    14                      RETURN TO CALLER                 00927000
         LTORG                                                          00928000
*                                                                       00929000
*                                                                       00930000
**********************************************************************  00931000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    00932000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00933000
*     AND GET-NEXT-LOCK VERBS.                                          00934000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00935000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00936000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00937000
**********************************************************************  00938000
*                                                                       00939000
SQL#0028 DS    0H                                                       00940000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          00941000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00942000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     00943000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    00944000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       00945000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      00946000
VECT0028 DC    A(SQL#0128)                                              00947000
         DC    A(SQL#0228)                                              00948000
         DC    A(SQL#0328)                                              00949000
         LTORG                                                          00950000
*                                                                       00951000
SQL#0128 DS    0H                                                       00952000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          00953000
         EXEC  SQL                                                     *00954000
               CLOSE SAJSQ001                                           00955000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00956000
         BR    14                      RETURN TO CALLER                 00957000
         LTORG                                                          00958000
*                                                                       00959000
SQL#0228 DS    0H                                                       00960000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          00961000
         EXEC  SQL                                                     *00962000
               CLOSE SAJSQ002                                           00963000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00964000
         BR    14                      RETURN TO CALLER                 00965000
         LTORG                                                          00966000
*                                                                       00967000
SQL#0328 DS    0H                                                       00968000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          00969000
         EXEC  SQL                                                     *00970000
               CLOSE SAJSQ003                                           00971000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00972000
         BR    14                      RETURN TO CALLER                 00973000
         LTORG                                                          00974000
*                                                                       00975000
*                                                                       00976000
**********************************************************************  00977000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                00978000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00979000
*     AND GET-NEXT-LOCK VERBS.                                          00980000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00981000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00982000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00983000
**********************************************************************  00984000
*                                                                       00985000
SQL#0029 DS    0H                                                       00986000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          00987000
         LA    15,255                  SET RETURN CODE                  00988000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00989000
         BR    14                      RETURN TO CALLER                 00990000
         LTORG                                                          00991000
*                                                                       00992000
*                                                                       00993000
**********************************************************************  00994000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                00995000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00996000
*     AND GET-NEXT-LOCK VERBS.                                          00997000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00998000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00999000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01000000
**********************************************************************  01001000
*                                                                       01002000
SQL#0030 DS    0H                                                       01003000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01004000
         LA    15,255                  SET RETURN CODE                  01005000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01006000
         BR    14                      RETURN TO CALLER                 01007000
         LTORG                                                          01008000
*                                                                       01009000
*                                                                       01010000
**********************************************************************  01011000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01012000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01013000
*     AND GET-NEXT-LOCK VERBS.                                          01014000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01015000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01016000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01017000
**********************************************************************  01018000
*                                                                       01019000
SQL#0031 DS    0H                                                       01020000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01021000
         LA    15,255                  SET RETURN CODE                  01022000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01023000
         BR    14                      RETURN TO CALLER                 01024000
         LTORG                                                          01025000
*                                                                       01026000
*                                                                       01027000
**********************************************************************  01028000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01029000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01030000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01031000
**********************************************************************  01032000
*                                                                       01033000
SQL#0032 DS    0H                                                       01034000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01035000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01036000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01037000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01038000
         EXEC  SQL                                                     *01039000
               SELECT INST_NBR,                                        *01040000
                   APPL_NBR,                                           *01041000
                   ACCT_NBR                                            *01042000
                 INTO :INST,                                           *01043000
                   :APPLNBR,                                           *01044000
                   :ACCTNBR                                            *01045000
                 FROM SAJ                                              *01046000
                 WHERE INST_NBR = :INST AND                            *01047000
                   APPL_NBR = :APPLNBR AND                             *01048000
                   ACCT_NBR = :ACCTNBR                                 *01049000
                 FETCH FIRST 1 ROW ONLY                                 01050000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01051000
         BR    14                      RETURN TO CALLER                 01052000
         LTORG                                                          01053000
*                                                                       01054000
*                                                                       01055000
**********************************************************************  01056000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01057000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01058000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01059000
**********************************************************************  01060000
*                                                                       01061000
SQL#0033 DS    0H                                                       01062000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01063000
         LA    15,255                  SET RETURN CODE                  01064000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01065000
         BR    14                      RETURN TO CALLER                 01066000
         LTORG                                                          01067000
*                                                                       01068000
*                                                                       01069000
**********************************************************************  01070000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01071000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01072000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01073000
**********************************************************************  01074000
*                                                                       01075000
SQL#0034 DS    0H                                                       01076000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01077000
         LA    15,255                  SET RETURN CODE                  01078000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01079000
         BR    14                      RETURN TO CALLER                 01080000
         LTORG                                                          01081000
*                                                                       01082000
*                                                                       01083000
**********************************************************************  01084000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01085000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01086000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01087000
**********************************************************************  01088000
*                                                                       01089000
SQL#0035 DS    0H                                                       01090000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01091000
         LA    15,255                  SET RETURN CODE                  01092000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01093000
         BR    14                      RETURN TO CALLER                 01094000
         LTORG                                                          01095000
*                                                                       01096000
*                                                                       01097000
**********************************************************************  01098000
* INSERT STATEMENT:                                                     01099000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01100000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01101000
**********************************************************************  01102000
*                                                                       01103000
SQL#0036 DS    0H                                                       01104000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01105000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01106000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01107000
         EXEC  SQL                                                     *01108000
               INSERT INTO SAJ                                         *01109000
                   (INST_NBR,                                          *01110000
                    APPL_NBR,                                          *01111000
                    ACCT_NBR,                                          *01112000
                    AUDIT_DATE,                                        *01113000
                    AUDIT_TIME,                                        *01114000
                    AUDIT_USER,                                        *01115000
                    AUDIT_ORG,                                         *01116000
                    PROD_CODE,                                         *01117000
                    SVC_INCEN_OPT,                                     *01118000
                    SVC_INCEN_QLFY,                                    *01119000
                    RATE_INCEN_OPT,                                    *01120000
                    RATE_INCEN_QLFY,                                   *01121000
                    PROCESS_OPTION,                                    *01122000
                    INCTIVE_USER_1,                                    *01123000
                    INCTIVE_USER_2,                                    *01124000
                    INCTIVE_USER_3,                                    *01125000
                    INCTIVE_USER_4,                                    *01126000
                    INCTIVE_USER_5,                                    *01127000
                    RSV_AREA)                                          *01128000
                  VALUES (:INST,                                       *01129000
                   :APPLNBR,                                           *01130000
                   :ACCTNBR,                                           *01131000
                   :AUDDATE,                                           *01132000
                   :AUDTIME,                                           *01133000
                   :AUDUSER,                                           *01134000
                   :AUDORG,                                            *01135000
                   :PRODCODE,                                          *01136000
                   :SCINCENO,                                          *01137000
                   :INCENQ,                                            *01138000
                   :RINCENO,                                           *01139000
                   :RINCENQ,                                           *01140000
                   :PROCOPT,                                           *01141000
                   :INCENU1,                                           *01142000
                   :INCENU2,                                           *01143000
                   :INCENU3,                                           *01144000
                   :INCENU4,                                           *01145000
                   :INCENU5,                                           *01146000
                   :RAREA)                                              01147000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01148000
         BR    14                      RETURN TO CALLER                 01149000
         LTORG                                                          01150000
*                                                                       01151000
*                                                                       01152000
**********************************************************************  01153000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01154000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01155000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01156000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01157000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01158000
*     STATEMENT.                                                        01159000
**********************************************************************  01160000
*                                                                       01161000
SQL#0037 DS    0H                                                       01162000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01163000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01164000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01165000
         EXEC  SQL                                                     *01166000
               UPDATE SAJ                                              *01167000
                   SET AUDIT_DATE = :AUDDATE,                          *01168000
                     AUDIT_TIME = :AUDTIME,                            *01169000
                     AUDIT_USER = :AUDUSER,                            *01170000
                     AUDIT_ORG = :AUDORG,                              *01171000
                     PROD_CODE = :PRODCODE,                            *01172000
                     SVC_INCEN_OPT = :SCINCENO,                        *01173000
                     SVC_INCEN_QLFY = :INCENQ,                         *01174000
                     RATE_INCEN_OPT = :RINCENO,                        *01175000
                     RATE_INCEN_QLFY = :RINCENQ,                       *01176000
                     PROCESS_OPTION = :PROCOPT,                        *01177000
                     INCTIVE_USER_1 = :INCENU1,                        *01178000
                     INCTIVE_USER_2 = :INCENU2,                        *01179000
                     INCTIVE_USER_3 = :INCENU3,                        *01180000
                     INCTIVE_USER_4 = :INCENU4,                        *01181000
                     INCTIVE_USER_5 = :INCENU5,                        *01182000
                     RSV_AREA = :RAREA                                 *01183000
                 WHERE CURRENT OF SAJUPD0                               01184000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01185000
         BR    14                      RETURN TO CALLER                 01186000
         LTORG                                                          01187000
*                                                                       01188000
*                                                                       01189000
**********************************************************************  01190000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01191000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01192000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01193000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01194000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01195000
*     STATEMENT.                                                        01196000
**********************************************************************  01197000
*                                                                       01198000
SQL#0038 DS    0H                                                       01199000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01200000
         LA    15,255                  SET RETURN CODE                  01201000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01202000
         BR    14                      RETURN TO CALLER                 01203000
         LTORG                                                          01204000
*                                                                       01205000
*                                                                       01206000
**********************************************************************  01207000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01208000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01209000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01210000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01211000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01212000
*     STATEMENT.                                                        01213000
**********************************************************************  01214000
*                                                                       01215000
SQL#0039 DS    0H                                                       01216000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01217000
         LA    15,255                  SET RETURN CODE                  01218000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01219000
         BR    14                      RETURN TO CALLER                 01220000
         LTORG                                                          01221000
*                                                                       01222000
*                                                                       01223000
**********************************************************************  01224000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01225000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01226000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01227000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01228000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01229000
*     STATEMENT.                                                        01230000
**********************************************************************  01231000
*                                                                       01232000
SQL#0040 DS    0H                                                       01233000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01234000
         LA    15,255                  SET RETURN CODE                  01235000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01236000
         BR    14                      RETURN TO CALLER                 01237000
         LTORG                                                          01238000
*                                                                       01239000
*                                                                       01240000
**********************************************************************  01241000
* DELETE STATEMENT BY PRIMARY KEY:                                      01242000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01243000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01244000
**********************************************************************  01245000
*                                                                       01246000
SQL#0041 DS    0H                                                       01247000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01248000
         EXEC  SQL                                                     *01249000
               DELETE FROM SAJ                                         *01250000
                 WHERE CURRENT OF SAJUPD0                               01251000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01252000
         BR    14                      RETURN TO CALLER                 01253000
         LTORG                                                          01254000
*                                                                       01255000
*                                                                       01256000
**********************************************************************  01257000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01258000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01259000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01260000
**********************************************************************  01261000
*                                                                       01262000
SQL#0042 DS    0H                                                       01263000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01264000
         LA    15,255                  SET RETURN CODE                  01265000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01266000
         BR    14                      RETURN TO CALLER                 01267000
         LTORG                                                          01268000
*                                                                       01269000
*                                                                       01270000
**********************************************************************  01271000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01272000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01273000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01274000
**********************************************************************  01275000
*                                                                       01276000
SQL#0043 DS    0H                                                       01277000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01278000
         LA    15,255                  SET RETURN CODE                  01279000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01280000
         BR    14                      RETURN TO CALLER                 01281000
         LTORG                                                          01282000
*                                                                       01283000
*                                                                       01284000
**********************************************************************  01285000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01286000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01287000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01288000
**********************************************************************  01289000
*                                                                       01290000
SQL#0044 DS    0H                                                       01291000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01292000
         LA    15,255                  SET RETURN CODE                  01293000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01294000
         BR    14                      RETURN TO CALLER                 01295000
         LTORG                                                          01296000
*                                                                       01297000
*                                                                       01298000
**********************************************************************  01299000
* DELETE ALL STATEMENT:                                                 01300000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01301000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01302000
**********************************************************************  01303000
*                                                                       01304000
SQL#0045 DS    0H                                                       01305000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01306000
         EXEC  SQL                                                     *01307000
               DELETE FROM SAJ                                          01308000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01309000
         BR    14                      RETURN TO CALLER                 01310000
         LTORG                                                          01311000
*                                                                       01312000
*                                                                       01313000
**********************************************************************  01314000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01315000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01316000
**********************************************************************  01317000
*                                                                       01318000
SQL#0046 DS    0H                                                       01319000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01320000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01321000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01322000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01323000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01324000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01325000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01326000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01327000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01328000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01329000
VECT0046 DC    A(0)                                                     01330000
         DC    A(SQL#0246)                                              01331000
         DC    A(SQL#0346)                                              01332000
         LTORG                                                          01333000
*                                                                       01334000
SQL#0246 DS    0H                                                       01335000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01336000
         EXEC  SQL                                                     *01337000
               CLOSE SAJSQ001                                           01338000
         EXEC  SQL                                                     *01339000
               DECLARE SAJSQ002 CURSOR FOR                             *01340000
               SELECT INST_NBR,                                        *01341000
                   APPL_NBR,                                           *01342000
                   ACCT_NBR,                                           *01343000
                   AUDIT_DATE,                                         *01344000
                   AUDIT_TIME,                                         *01345000
                   AUDIT_USER,                                         *01346000
                   AUDIT_ORG,                                          *01347000
                   PROD_CODE,                                          *01348000
                   SVC_INCEN_OPT,                                      *01349000
                   SVC_INCEN_QLFY,                                     *01350000
                   RATE_INCEN_OPT,                                     *01351000
                   RATE_INCEN_QLFY,                                    *01352000
                   PROCESS_OPTION,                                     *01353000
                   INCTIVE_USER_1,                                     *01354000
                   INCTIVE_USER_2,                                     *01355000
                   INCTIVE_USER_3,                                     *01356000
                   INCTIVE_USER_4,                                     *01357000
                   INCTIVE_USER_5,                                     *01358000
                   RSV_AREA                                            *01359000
                 FROM SAJ                                              *01360000
                 WHERE                                                 *01361000
                    INST_NBR = :INST AND                               *01362000
                    APPL_NBR > :APPLNBR                                *01363000
                 ORDER BY APPL_NBR,                                    *01364000
                   ACCT_NBR                                            *01365000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01366000
         EXEC  SQL                                                     *01367000
               OPEN SAJSQ002                                            01368000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01369000
         BNZ   *+8                     NO - RETURN ERROR                01370000
         LR    12,9                    LOAD RETURN ADDRESS              01371000
         BR    12                      RETURN TO FETCH ROUTINE          01372000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01373000
         BR    14                      RETURN TO CALLER                 01374000
         LTORG                                                          01375000
*                                                                       01376000
SQL#0346 DS    0H                                                       01377000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01378000
         EXEC  SQL                                                     *01379000
               CLOSE SAJSQ002                                           01380000
         EXEC  SQL                                                     *01381000
               DECLARE SAJSQ003 CURSOR FOR                             *01382000
               SELECT INST_NBR,                                        *01383000
                   APPL_NBR,                                           *01384000
                   ACCT_NBR,                                           *01385000
                   AUDIT_DATE,                                         *01386000
                   AUDIT_TIME,                                         *01387000
                   AUDIT_USER,                                         *01388000
                   AUDIT_ORG,                                          *01389000
                   PROD_CODE,                                          *01390000
                   SVC_INCEN_OPT,                                      *01391000
                   SVC_INCEN_QLFY,                                     *01392000
                   RATE_INCEN_OPT,                                     *01393000
                   RATE_INCEN_QLFY,                                    *01394000
                   PROCESS_OPTION,                                     *01395000
                   INCTIVE_USER_1,                                     *01396000
                   INCTIVE_USER_2,                                     *01397000
                   INCTIVE_USER_3,                                     *01398000
                   INCTIVE_USER_4,                                     *01399000
                   INCTIVE_USER_5,                                     *01400000
                   RSV_AREA                                            *01401000
                 FROM SAJ                                              *01402000
                 WHERE                                                 *01403000
                    INST_NBR > :INST                                   *01404000
                 ORDER BY INST_NBR,                                    *01405000
                   APPL_NBR,                                           *01406000
                   ACCT_NBR                                            *01407000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01408000
         EXEC  SQL                                                     *01409000
               OPEN SAJSQ003                                            01410000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01411000
         BNZ   *+8                     NO - RETURN ERROR                01412000
         LR    12,9                    LOAD RETURN ADDRESS              01413000
         BR    12                      RETURN TO FETCH ROUTINE          01414000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01415000
         BR    14                      RETURN TO CALLER                 01416000
         LTORG                                                          01417000
*                                                                       01418000
*                                                                       01419000
**********************************************************************  01420000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01421000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01422000
**********************************************************************  01423000
*                                                                       01424000
SQL#0047 DS    0H                                                       01425000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01426000
         LA    15,255                  SET RETURN CODE                  01427000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01428000
         BR    14                      RETURN TO CALLER                 01429000
         LTORG                                                          01430000
*                                                                       01431000
*                                                                       01432000
**********************************************************************  01433000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01434000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01435000
**********************************************************************  01436000
*                                                                       01437000
SQL#0048 DS    0H                                                       01438000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01439000
         LA    15,255                  SET RETURN CODE                  01440000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01441000
         BR    14                      RETURN TO CALLER                 01442000
         LTORG                                                          01443000
*                                                                       01444000
*                                                                       01445000
**********************************************************************  01446000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01447000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01448000
**********************************************************************  01449000
*                                                                       01450000
SQL#0049 DS    0H                                                       01451000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01452000
         LA    15,255                  SET RETURN CODE                  01453000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01454000
         BR    14                      RETURN TO CALLER                 01455000
         LTORG                                                          01456000
*                                                                       01457000
         DS    0H                      END OF SQL STATEMENTS            01458000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01459000
*                                                                       01460000
*                                                                       01461000
**********************************************************************  01462000
* DUMMY ENTRY POINT DSNHLI                                              01463000
*   MUST NOT BE MODIFIED.                                               01464000
**********************************************************************  01465000
*                                                                       01466000
         ENTRY DSNHLI                                                   01467000
DSNHLI   DS    0H                                                       01468000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01469000
         BR    15                      BRANCH TO ATTACH FACILITY        01470000
*                                                                       01471000
*                                                                       01472000
**********************************************************************  01473000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01474000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01475000
*   MUST NOT BE MODIFIED.                                               01476000
**********************************************************************  01477000
*                                                                       01478000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01479000
CONV#RTN AMODE ANY                                                      01480000
CONV#RTN RMODE ANY                                                      01481000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01482000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01483000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01484000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01485000
         BER   4                         YES - RETURN TO SQL            01486000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01487000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01488000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01489000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01490000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01491000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01492000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01493000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01494000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01495000
*                                                                       01496000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01497000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01498000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01499000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01500000
         BER   4                         YES - RETURN TO SQL            01501000
         SLR   0,0                     CLEAR FOR INSERT                 01502000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01503000
         NR    0,3                     FOR THE CURRENT KEY?             01504000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01505000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01506000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01507000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01508000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01509000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01510000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01511000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01512000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01513000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01514000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01515000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01516000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01517000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01518000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01519000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01520000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01521000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01522000
*                                                                       01523000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01524000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01525000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01526000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01527000
         BER   4                         YES - RETURN TO SQL            01528000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01529000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01530000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01531000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01532000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01533000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01534000
         MVCL  0,14                    MOVE TO RECORD AREA              01535000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01536000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01537000
*                                                                       01538000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01539000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01540000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01541000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01542000
         BER   4                         YES - RETURN TO SQL            01543000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01544000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01545000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01546000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01547000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01548000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01549000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01550000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01551000
         MVCL  0,14                    MOVE TO RECORD AREA              01552000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01553000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01554000
*                                                                       01555000
*                                                                       01556000
**********************************************************************  01557000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01558000
*   MUST NOT BE MODIFIED.                                               01559000
**********************************************************************  01560000
*                                                                       01561000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01562000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01563000
         DC    H'0024'                 LENGTH TO MOVE                   01564000
         DC    X'80'                   80 = KEY 0 FIELD                 01565000
*                                      40 = KEY 1 FIELD                 01566000
*                                      20 = KEY 2 FIELD                 01567000
*                                      10 = KEY 3 FIELD                 01568000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        01569000
*                                                                       01570000
*                                      REST OF FIELD ENTRIES            01571000
         DC    H'0024',H'0024',H'0087',X'00',X'00'                      01572000
         DC    8X'FF'                  END OF FIELD ENTRIES             01573000
         LTORG                                                          01574000
         END                                                            01575000
