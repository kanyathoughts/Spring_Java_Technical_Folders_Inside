* REL=S13IODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  S13IODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S13 FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL158                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
RECNBR   DS    CL4                                                      00039000
SS_PLAN  DS    CL6                                                      00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
SSCD1    DS    CL6                                                      00045000
SSCD2    DS    CL6                                                      00046000
SSCD3    DS    CL6                                                      00047000
SSCD4    DS    CL6                                                      00048000
SSCD5    DS    CL6                                                      00049000
SSCD6    DS    CL6                                                      00050000
SSCD7    DS    CL6                                                      00051000
SSCD8    DS    CL6                                                      00052000
SSCD9    DS    CL6                                                      00053000
SSCD10   DS    CL6                                                      00054000
SSCD11   DS    CL6                                                      00055000
SSCD12   DS    CL6                                                      00056000
SSCD13   DS    CL6                                                      00057000
SSCD14   DS    CL6                                                      00058000
SSCD15   DS    CL6                                                      00059000
SSCD16   DS    CL6                                                      00060000
SSCD17   DS    CL6                                                      00061000
SSCD18   DS    CL6                                                      00062000
SSCD19   DS    CL6                                                      00063000
SSCD20   DS    CL6                                                      00064000
*                                                                       00065000
*                                                                       00066000
**********************************************************************  00067000
* PROGRAM TABLE HEADER SECTION:                                         00068000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00069000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00070000
**********************************************************************  00071000
*                                                                       00072000
S13IODB  CSECT                         PROGRAM TABLE SECTION            00073000
S13IODB  AMODE ANY                                                      00074000
S13IODB  RMODE ANY                                                      00075000
         DC    CL9'S13IODB'            PROGRAM ID                       00076000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00077000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00078000
         DC    A(0)                    RESERVED                         00079000
         DC    A(0)                    RESERVED                         00080000
         DC    24CL1' '                RESERVED                         00081000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00082000
*                                                                       00083000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00084000
         DC    CL29'WWW.INFOR.COM                '                      00084001
*                                                                       00085000
*                                                                       00086000
**********************************************************************  00087000
* STATEMENT TABLE SECTION:                                              00088000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00089000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00090000
*   SHOULD NOT BE MODIFIED.                                             00091000
**********************************************************************  00092000
*                                                                       00093000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00094000
STM#TAB  AMODE ANY                                                      00095000
STM#TAB  RMODE ANY                                                      00096000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00097000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00098000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00099000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00100000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00101000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00102000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00103000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00104000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00105000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00106000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00107000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00108000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00109000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00110000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00111000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00112000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00113000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00114000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00115000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00116000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00117000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00118000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00119000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00120000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00121000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00122000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00123000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00124000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00125000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00126000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00127000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00128000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00129000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00130000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00131000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00132000
         DC    A(SQL#0036)             INSERT STATEMENT                 00133000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00134000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00135000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00136000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00137000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00138000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00139000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00140000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00141000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00142000
         DC    4X'FF'                                                   00143000
*                                                                       00144000
*                                                                       00145000
**********************************************************************  00146000
* SQL STATEMENT SECTION:                                                00147000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00148000
*     TO SUPPORT THIS TABLE.                                            00149000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00150000
*     ARE EQUIVALENT.                                                   00151000
**********************************************************************  00152000
*                                                                       00153000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00154000
SQL#STMT AMODE ANY                                                      00155000
SQL#STMT RMODE ANY                                                      00156000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00157000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00158000
         USING COM#AREA,11             ADDRESS COMMAREA                 00159000
*                                                                       00160000
*                                                                       00161000
**********************************************************************  00162000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00163000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00164000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00165000
**********************************************************************  00166000
*                                                                       00167000
SQL#0000 DS    0H                                                       00168000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00169000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00170000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00171000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00172000
         EXEC  SQL                                                     *00173000
               SELECT AUDIT_DATE,                                      *00174000
                   AUDIT_TIME,                                         *00175000
                   AUDIT_USER,                                         *00176000
                   AUDIT_ORG,                                          *00177000
                   SEC_SVC_CD_01,                                      *00178000
                   SEC_SVC_CD_02,                                      *00179000
                   SEC_SVC_CD_03,                                      *00180000
                   SEC_SVC_CD_04,                                      *00181000
                   SEC_SVC_CD_05,                                      *00182000
                   SEC_SVC_CD_06,                                      *00183000
                   SEC_SVC_CD_07,                                      *00184000
                   SEC_SVC_CD_08,                                      *00185000
                   SEC_SVC_CD_09,                                      *00186000
                   SEC_SVC_CD_10,                                      *00187000
                   SEC_SVC_CD_11,                                      *00188000
                   SEC_SVC_CD_12,                                      *00189000
                   SEC_SVC_CD_13,                                      *00190000
                   SEC_SVC_CD_14,                                      *00191000
                   SEC_SVC_CD_15,                                      *00192000
                   SEC_SVC_CD_16,                                      *00193000
                   SEC_SVC_CD_17,                                      *00194000
                   SEC_SVC_CD_18,                                      *00195000
                   SEC_SVC_CD_19,                                      *00196000
                   SEC_SVC_CD_20                                       *00197000
                 INTO :AUDDATE,                                        *00198000
                   :AUDTIME,                                           *00199000
                   :AUDUSER,                                           *00200000
                   :AUDORG,                                            *00201000
                   :SSCD1,                                             *00202000
                   :SSCD2,                                             *00203000
                   :SSCD3,                                             *00204000
                   :SSCD4,                                             *00205000
                   :SSCD5,                                             *00206000
                   :SSCD6,                                             *00207000
                   :SSCD7,                                             *00208000
                   :SSCD8,                                             *00209000
                   :SSCD9,                                             *00210000
                   :SSCD10,                                            *00211000
                   :SSCD11,                                            *00212000
                   :SSCD12,                                            *00213000
                   :SSCD13,                                            *00214000
                   :SSCD14,                                            *00215000
                   :SSCD15,                                            *00216000
                   :SSCD16,                                            *00217000
                   :SSCD17,                                            *00218000
                   :SSCD18,                                            *00219000
                   :SSCD19,                                            *00220000
                   :SSCD20                                             *00221000
                 FROM S13                                              *00222000
                 WHERE INST_NBR = :INST AND                            *00223000
                   RECORD_NBR = :RECNBR AND                            *00224000
                   SEC_SVC_PLAN = :SS_PLAN                             *00225000
                 FETCH FIRST 1 ROW ONLY                                 00226000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00227000
         BALR  4,5                     MOVE INTO RECORD AREA            00228000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00229000
         BR    14                      RETURN TO CALLER                 00230000
         LTORG                                                          00231000
*                                                                       00232000
*                                                                       00233000
**********************************************************************  00234000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00235000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00236000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00237000
**********************************************************************  00238000
*                                                                       00239000
SQL#0001 DS    0H                                                       00240000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00241000
         LA    15,255                  SET RETURN CODE                  00242000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00243000
         BR    14                      RETURN TO CALLER                 00244000
         LTORG                                                          00245000
*                                                                       00246000
*                                                                       00247000
**********************************************************************  00248000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00249000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00250000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00251000
**********************************************************************  00252000
*                                                                       00253000
SQL#0002 DS    0H                                                       00254000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00255000
         LA    15,255                  SET RETURN CODE                  00256000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00257000
         BR    14                      RETURN TO CALLER                 00258000
         LTORG                                                          00259000
*                                                                       00260000
*                                                                       00261000
**********************************************************************  00262000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00263000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00264000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00265000
**********************************************************************  00266000
*                                                                       00267000
SQL#0003 DS    0H                                                       00268000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00269000
         LA    15,255                  SET RETURN CODE                  00270000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00271000
         BR    14                      RETURN TO CALLER                 00272000
         LTORG                                                          00273000
*                                                                       00274000
*                                                                       00275000
**********************************************************************  00276000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00277000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00278000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00279000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00280000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00281000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00282000
*     UPDATE STATEMENT TO MATCH.                                        00283000
**********************************************************************  00284000
*                                                                       00285000
SQL#0004 DS    0H                                                       00286000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00287000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00288000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00289000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00290000
         EXEC  SQL                                                     *00291000
               DECLARE S13UPD0 CURSOR FOR                              *00292000
               SELECT AUDIT_DATE,                                      *00293000
                   AUDIT_TIME,                                         *00294000
                   AUDIT_USER,                                         *00295000
                   AUDIT_ORG,                                          *00296000
                   SEC_SVC_CD_01,                                      *00297000
                   SEC_SVC_CD_02,                                      *00298000
                   SEC_SVC_CD_03,                                      *00299000
                   SEC_SVC_CD_04,                                      *00300000
                   SEC_SVC_CD_05,                                      *00301000
                   SEC_SVC_CD_06,                                      *00302000
                   SEC_SVC_CD_07,                                      *00303000
                   SEC_SVC_CD_08,                                      *00304000
                   SEC_SVC_CD_09,                                      *00305000
                   SEC_SVC_CD_10,                                      *00306000
                   SEC_SVC_CD_11,                                      *00307000
                   SEC_SVC_CD_12,                                      *00308000
                   SEC_SVC_CD_13,                                      *00309000
                   SEC_SVC_CD_14,                                      *00310000
                   SEC_SVC_CD_15,                                      *00311000
                   SEC_SVC_CD_16,                                      *00312000
                   SEC_SVC_CD_17,                                      *00313000
                   SEC_SVC_CD_18,                                      *00314000
                   SEC_SVC_CD_19,                                      *00315000
                   SEC_SVC_CD_20                                       *00316000
                 FROM S13                                              *00317000
                 WHERE INST_NBR = :INST AND                            *00318000
                   RECORD_NBR = :RECNBR AND                            *00319000
                   SEC_SVC_PLAN = :SS_PLAN                             *00320000
                 FOR UPDATE OF AUDIT_DATE,                             *00321000
                   AUDIT_TIME,                                         *00322000
                   AUDIT_USER,                                         *00323000
                   AUDIT_ORG,                                          *00324000
                   SEC_SVC_CD_01,                                      *00325000
                   SEC_SVC_CD_02,                                      *00326000
                   SEC_SVC_CD_03,                                      *00327000
                   SEC_SVC_CD_04,                                      *00328000
                   SEC_SVC_CD_05,                                      *00329000
                   SEC_SVC_CD_06,                                      *00330000
                   SEC_SVC_CD_07,                                      *00331000
                   SEC_SVC_CD_08,                                      *00332000
                   SEC_SVC_CD_09,                                      *00333000
                   SEC_SVC_CD_10,                                      *00334000
                   SEC_SVC_CD_11,                                      *00335000
                   SEC_SVC_CD_12,                                      *00336000
                   SEC_SVC_CD_13,                                      *00337000
                   SEC_SVC_CD_14,                                      *00338000
                   SEC_SVC_CD_15,                                      *00339000
                   SEC_SVC_CD_16,                                      *00340000
                   SEC_SVC_CD_17,                                      *00341000
                   SEC_SVC_CD_18,                                      *00342000
                   SEC_SVC_CD_19,                                      *00343000
                   SEC_SVC_CD_20                                       *00344000
                 FETCH FIRST 1 ROW ONLY                                 00345000
         EXEC  SQL                                                     *00346000
               OPEN S13UPD0                                             00347000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00348000
         BR    14                      RETURN TO CALLER                 00349000
         LTORG                                                          00350000
*                                                                       00351000
*                                                                       00352000
**********************************************************************  00353000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00354000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00355000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00356000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00357000
*     UPDATE STATEMENT TO MATCH.                                        00358000
**********************************************************************  00359000
*                                                                       00360000
SQL#0005 DS    0H                                                       00361000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00362000
         LA    15,255                  SET RETURN CODE                  00363000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00364000
         BR    14                      RETURN TO CALLER                 00365000
         LTORG                                                          00366000
*                                                                       00367000
*                                                                       00368000
**********************************************************************  00369000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00370000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00371000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00372000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00373000
*     UPDATE STATEMENT TO MATCH.                                        00374000
**********************************************************************  00375000
*                                                                       00376000
SQL#0006 DS    0H                                                       00377000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00378000
         LA    15,255                  SET RETURN CODE                  00379000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00380000
         BR    14                      RETURN TO CALLER                 00381000
         LTORG                                                          00382000
*                                                                       00383000
*                                                                       00384000
**********************************************************************  00385000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00386000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00387000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00388000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00389000
*     UPDATE STATEMENT TO MATCH.                                        00390000
**********************************************************************  00391000
*                                                                       00392000
SQL#0007 DS    0H                                                       00393000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00394000
         LA    15,255                  SET RETURN CODE                  00395000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00396000
         BR    14                      RETURN TO CALLER                 00397000
         LTORG                                                          00398000
*                                                                       00399000
*                                                                       00400000
**********************************************************************  00401000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00402000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00403000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00404000
*     THE ACTUAL ROW.                                                   00405000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00406000
**********************************************************************  00407000
*                                                                       00408000
SQL#0008 DS    0H                                                       00409000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00410000
         EXEC  SQL                                                     *00411000
               FETCH S13UPD0                                           *00412000
                 INTO :AUDDATE,                                        *00413000
                   :AUDTIME,                                           *00414000
                   :AUDUSER,                                           *00415000
                   :AUDORG,                                            *00416000
                   :SSCD1,                                             *00417000
                   :SSCD2,                                             *00418000
                   :SSCD3,                                             *00419000
                   :SSCD4,                                             *00420000
                   :SSCD5,                                             *00421000
                   :SSCD6,                                             *00422000
                   :SSCD7,                                             *00423000
                   :SSCD8,                                             *00424000
                   :SSCD9,                                             *00425000
                   :SSCD10,                                            *00426000
                   :SSCD11,                                            *00427000
                   :SSCD12,                                            *00428000
                   :SSCD13,                                            *00429000
                   :SSCD14,                                            *00430000
                   :SSCD15,                                            *00431000
                   :SSCD16,                                            *00432000
                   :SSCD17,                                            *00433000
                   :SSCD18,                                            *00434000
                   :SSCD19,                                            *00435000
                   :SSCD20                                              00436000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00437000
         BALR  4,5                     MOVE INTO RECORD AREA            00438000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00439000
         BR    14                      RETURN TO CALLER                 00440000
         LTORG                                                          00441000
*                                                                       00442000
*                                                                       00443000
**********************************************************************  00444000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00445000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00446000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00447000
*     THE ACTUAL ROW.                                                   00448000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00449000
**********************************************************************  00450000
*                                                                       00451000
SQL#0009 DS    0H                                                       00452000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00453000
         LA    15,255                  SET RETURN CODE                  00454000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00455000
         BR    14                      RETURN TO CALLER                 00456000
         LTORG                                                          00457000
*                                                                       00458000
*                                                                       00459000
**********************************************************************  00460000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00461000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00462000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00463000
*     THE ACTUAL ROW.                                                   00464000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00465000
**********************************************************************  00466000
*                                                                       00467000
SQL#0010 DS    0H                                                       00468000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00469000
         LA    15,255                  SET RETURN CODE                  00470000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00471000
         BR    14                      RETURN TO CALLER                 00472000
         LTORG                                                          00473000
*                                                                       00474000
*                                                                       00475000
**********************************************************************  00476000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00477000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00478000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00479000
*     THE ACTUAL ROW.                                                   00480000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00481000
**********************************************************************  00482000
*                                                                       00483000
SQL#0011 DS    0H                                                       00484000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00485000
         LA    15,255                  SET RETURN CODE                  00486000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00487000
         BR    14                      RETURN TO CALLER                 00488000
         LTORG                                                          00489000
*                                                                       00490000
*                                                                       00491000
**********************************************************************  00492000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00493000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00494000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00495000
*     TO CLOSE THE UPDATE CURSOR.                                       00496000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00497000
**********************************************************************  00498000
*                                                                       00499000
SQL#0012 DS    0H                                                       00500000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00501000
         EXEC  SQL                                                     *00502000
               CLOSE S13UPD0                                            00503000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00504000
         BR    14                      RETURN TO CALLER                 00505000
         LTORG                                                          00506000
*                                                                       00507000
*                                                                       00508000
**********************************************************************  00509000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00510000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00511000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00512000
*     TO CLOSE THE UPDATE CURSOR.                                       00513000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00514000
**********************************************************************  00515000
*                                                                       00516000
SQL#0013 DS    0H                                                       00517000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00518000
         LA    15,255                  SET RETURN CODE                  00519000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00520000
         BR    14                      RETURN TO CALLER                 00521000
         LTORG                                                          00522000
*                                                                       00523000
*                                                                       00524000
**********************************************************************  00525000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00526000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00527000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00528000
*     TO CLOSE THE UPDATE CURSOR.                                       00529000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00530000
**********************************************************************  00531000
*                                                                       00532000
SQL#0014 DS    0H                                                       00533000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00534000
         LA    15,255                  SET RETURN CODE                  00535000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00536000
         BR    14                      RETURN TO CALLER                 00537000
         LTORG                                                          00538000
*                                                                       00539000
*                                                                       00540000
**********************************************************************  00541000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00542000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00543000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00544000
*     TO CLOSE THE UPDATE CURSOR.                                       00545000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00546000
**********************************************************************  00547000
*                                                                       00548000
SQL#0015 DS    0H                                                       00549000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00550000
         LA    15,255                  SET RETURN CODE                  00551000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00552000
         BR    14                      RETURN TO CALLER                 00553000
         LTORG                                                          00554000
*                                                                       00555000
*                                                                       00556000
**********************************************************************  00557000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00558000
* KEY:                                                                  00559000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00560000
*     AND GET-NEXT-LOCK VERBS.                                          00561000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00562000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00563000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00564000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00565000
*     ORDER BY CLAUSE.                                                  00566000
**********************************************************************  00567000
*                                                                       00568000
SQL#0016 DS    0H                                                       00569000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00570000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00571000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00572000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00573000
         EXEC  SQL                                                     *00574000
               DECLARE S13SQ001 CURSOR FOR                             *00575000
               SELECT INST_NBR,                                        *00576000
                   RECORD_NBR,                                         *00577000
                   SEC_SVC_PLAN,                                       *00578000
                   AUDIT_DATE,                                         *00579000
                   AUDIT_TIME,                                         *00580000
                   AUDIT_USER,                                         *00581000
                   AUDIT_ORG,                                          *00582000
                   SEC_SVC_CD_01,                                      *00583000
                   SEC_SVC_CD_02,                                      *00584000
                   SEC_SVC_CD_03,                                      *00585000
                   SEC_SVC_CD_04,                                      *00586000
                   SEC_SVC_CD_05,                                      *00587000
                   SEC_SVC_CD_06,                                      *00588000
                   SEC_SVC_CD_07,                                      *00589000
                   SEC_SVC_CD_08,                                      *00590000
                   SEC_SVC_CD_09,                                      *00591000
                   SEC_SVC_CD_10,                                      *00592000
                   SEC_SVC_CD_11,                                      *00593000
                   SEC_SVC_CD_12,                                      *00594000
                   SEC_SVC_CD_13,                                      *00595000
                   SEC_SVC_CD_14,                                      *00596000
                   SEC_SVC_CD_15,                                      *00597000
                   SEC_SVC_CD_16,                                      *00598000
                   SEC_SVC_CD_17,                                      *00599000
                   SEC_SVC_CD_18,                                      *00600000
                   SEC_SVC_CD_19,                                      *00601000
                   SEC_SVC_CD_20                                       *00602000
                 FROM S13                                              *00603000
                 WHERE                                                 *00604000
                    INST_NBR = :INST AND                               *00605000
                    RECORD_NBR = :RECNBR AND                           *00606000
                    SEC_SVC_PLAN >= :SS_PLAN                           *00607000
                 ORDER BY SEC_SVC_PLAN                                 *00608000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00609000
         EXEC  SQL                                                     *00610000
               OPEN S13SQ001                                            00611000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00612000
         BR    14                      RETURN TO CALLER                 00613000
         LTORG                                                          00614000
*                                                                       00615000
*                                                                       00616000
**********************************************************************  00617000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00618000
* KEY 1:                                                                00619000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00620000
*     AND GET-NEXT-LOCK VERBS.                                          00621000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00622000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00623000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00624000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00625000
*     ORDER BY CLAUSE.                                                  00626000
**********************************************************************  00627000
*                                                                       00628000
SQL#0017 DS    0H                                                       00629000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00630000
         LA    15,255                  SET RETURN CODE                  00631000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00632000
         BR    14                      RETURN TO CALLER                 00633000
         LTORG                                                          00634000
*                                                                       00635000
*                                                                       00636000
**********************************************************************  00637000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00638000
* KEY 2:                                                                00639000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00640000
*     AND GET-NEXT-LOCK VERBS.                                          00641000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00642000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00643000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00644000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00645000
*     ORDER BY CLAUSE.                                                  00646000
**********************************************************************  00647000
*                                                                       00648000
SQL#0018 DS    0H                                                       00649000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00650000
         LA    15,255                  SET RETURN CODE                  00651000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00652000
         BR    14                      RETURN TO CALLER                 00653000
         LTORG                                                          00654000
*                                                                       00655000
*                                                                       00656000
**********************************************************************  00657000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00658000
* KEY 3:                                                                00659000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00660000
*     AND GET-NEXT-LOCK VERBS.                                          00661000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00662000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00663000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00664000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00665000
*     ORDER BY CLAUSE.                                                  00666000
**********************************************************************  00667000
*                                                                       00668000
SQL#0019 DS    0H                                                       00669000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00670000
         LA    15,255                  SET RETURN CODE                  00671000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00672000
         BR    14                      RETURN TO CALLER                 00673000
         LTORG                                                          00674000
*                                                                       00675000
*                                                                       00676000
**********************************************************************  00677000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00678000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00679000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00680000
*     RETRIEVE THE ACTUAL ROW.                                          00681000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00682000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00683000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00684000
**********************************************************************  00685000
*                                                                       00686000
SQL#0020 DS    0H                                                       00687000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00688000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00689000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00690000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00691000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00692000
VECT0020 DC    A(SQL#0120)                                              00693000
         DC    A(SQL#0220)                                              00694000
         DC    A(SQL#0320)                                              00695000
         LTORG                                                          00696000
*                                                                       00697000
SQL#0120 DS    0H                                                       00698000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00699000
         EXEC  SQL                                                     *00700000
               FETCH S13SQ001                                          *00701000
                 INTO :INST,                                           *00702000
                      :RECNBR,                                         *00703000
                      :SS_PLAN,                                        *00704000
                      :AUDDATE,                                        *00705000
                      :AUDTIME,                                        *00706000
                      :AUDUSER,                                        *00707000
                      :AUDORG,                                         *00708000
                      :SSCD1,                                          *00709000
                      :SSCD2,                                          *00710000
                      :SSCD3,                                          *00711000
                      :SSCD4,                                          *00712000
                      :SSCD5,                                          *00713000
                      :SSCD6,                                          *00714000
                      :SSCD7,                                          *00715000
                      :SSCD8,                                          *00716000
                      :SSCD9,                                          *00717000
                      :SSCD10,                                         *00718000
                      :SSCD11,                                         *00719000
                      :SSCD12,                                         *00720000
                      :SSCD13,                                         *00721000
                      :SSCD14,                                         *00722000
                      :SSCD15,                                         *00723000
                      :SSCD16,                                         *00724000
                      :SSCD17,                                         *00725000
                      :SSCD18,                                         *00726000
                      :SSCD19,                                         *00727000
                      :SSCD20                                           00728000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00729000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00730000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00731000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00732000
         BR    12                      OPEN NEXT CURSOR                 00733000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00734000
         BALR  4,5                     MOVE INTO RECORD AREA            00735000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00736000
         BR    14                      RETURN TO CALLER                 00737000
         LTORG                                                          00738000
*                                                                       00739000
SQL#0220 DS    0H                                                       00740000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00741000
         EXEC  SQL                                                     *00742000
               FETCH S13SQ002                                          *00743000
                 INTO :INST,                                           *00744000
                      :RECNBR,                                         *00745000
                      :SS_PLAN,                                        *00746000
                      :AUDDATE,                                        *00747000
                      :AUDTIME,                                        *00748000
                      :AUDUSER,                                        *00749000
                      :AUDORG,                                         *00750000
                      :SSCD1,                                          *00751000
                      :SSCD2,                                          *00752000
                      :SSCD3,                                          *00753000
                      :SSCD4,                                          *00754000
                      :SSCD5,                                          *00755000
                      :SSCD6,                                          *00756000
                      :SSCD7,                                          *00757000
                      :SSCD8,                                          *00758000
                      :SSCD9,                                          *00759000
                      :SSCD10,                                         *00760000
                      :SSCD11,                                         *00761000
                      :SSCD12,                                         *00762000
                      :SSCD13,                                         *00763000
                      :SSCD14,                                         *00764000
                      :SSCD15,                                         *00765000
                      :SSCD16,                                         *00766000
                      :SSCD17,                                         *00767000
                      :SSCD18,                                         *00768000
                      :SSCD19,                                         *00769000
                      :SSCD20                                           00770000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00771000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00772000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00773000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00774000
         BR    12                      OPEN NEXT CURSOR                 00775000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00776000
         BALR  4,5                     MOVE INTO RECORD AREA            00777000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00778000
         BR    14                      RETURN TO CALLER                 00779000
         LTORG                                                          00780000
*                                                                       00781000
SQL#0320 DS    0H                                                       00782000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00783000
         EXEC  SQL                                                     *00784000
               FETCH S13SQ003                                          *00785000
                 INTO :INST,                                           *00786000
                      :RECNBR,                                         *00787000
                      :SS_PLAN,                                        *00788000
                      :AUDDATE,                                        *00789000
                      :AUDTIME,                                        *00790000
                      :AUDUSER,                                        *00791000
                      :AUDORG,                                         *00792000
                      :SSCD1,                                          *00793000
                      :SSCD2,                                          *00794000
                      :SSCD3,                                          *00795000
                      :SSCD4,                                          *00796000
                      :SSCD5,                                          *00797000
                      :SSCD6,                                          *00798000
                      :SSCD7,                                          *00799000
                      :SSCD8,                                          *00800000
                      :SSCD9,                                          *00801000
                      :SSCD10,                                         *00802000
                      :SSCD11,                                         *00803000
                      :SSCD12,                                         *00804000
                      :SSCD13,                                         *00805000
                      :SSCD14,                                         *00806000
                      :SSCD15,                                         *00807000
                      :SSCD16,                                         *00808000
                      :SSCD17,                                         *00809000
                      :SSCD18,                                         *00810000
                      :SSCD19,                                         *00811000
                      :SSCD20                                           00812000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00813000
         BALR  4,5                     MOVE INTO RECORD AREA            00814000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00815000
         BR    14                      RETURN TO CALLER                 00816000
         LTORG                                                          00817000
*                                                                       00818000
*                                                                       00819000
**********************************************************************  00820000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00821000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00822000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00823000
*     RETRIEVE THE ACTUAL ROW.                                          00824000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00825000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00826000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00827000
**********************************************************************  00828000
*                                                                       00829000
SQL#0021 DS    0H                                                       00830000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00831000
         LA    15,255                  SET RETURN CODE                  00832000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00833000
         BR    14                      RETURN TO CALLER                 00834000
         LTORG                                                          00835000
*                                                                       00836000
*                                                                       00837000
**********************************************************************  00838000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           00839000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00840000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00841000
*     RETRIEVE THE ACTUAL ROW.                                          00842000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00843000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00844000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00845000
**********************************************************************  00846000
*                                                                       00847000
SQL#0022 DS    0H                                                       00848000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          00849000
         LA    15,255                  SET RETURN CODE                  00850000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00851000
         BR    14                      RETURN TO CALLER                 00852000
         LTORG                                                          00853000
*                                                                       00854000
*                                                                       00855000
**********************************************************************  00856000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           00857000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00858000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00859000
*     RETRIEVE THE ACTUAL ROW.                                          00860000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00861000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00862000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00863000
**********************************************************************  00864000
*                                                                       00865000
SQL#0023 DS    0H                                                       00866000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          00867000
         LA    15,255                  SET RETURN CODE                  00868000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00869000
         BR    14                      RETURN TO CALLER                 00870000
         LTORG                                                          00871000
*                                                                       00872000
*                                                                       00873000
**********************************************************************  00874000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00875000
* THE PRIMARY KEY:                                                      00876000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00877000
*     VERBS.                                                            00878000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00879000
*     RETRIEVE THE ACTUAL ROW.                                          00880000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00881000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00882000
*     WILL BE THRU THE UPDATE CURSOR.                                   00883000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00884000
**********************************************************************  00885000
*                                                                       00886000
SQL#0024 DS    0H                                                       00887000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          00888000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00889000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    00890000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00891000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00892000
VECT0024 DC    A(SQL#0124)                                              00893000
         DC    A(SQL#0224)                                              00894000
         DC    A(SQL#0324)                                              00895000
         LTORG                                                          00896000
*                                                                       00897000
SQL#0124 DS    0H                                                       00898000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          00899000
         EXEC  SQL                                                     *00900000
               FETCH S13SQ001                                          *00901000
                 INTO :INST,                                           *00902000
                      :RECNBR,                                         *00903000
                      :SS_PLAN                                          00904000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00905000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00906000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00907000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00908000
         BR    12                      OPEN NEXT CURSOR                 00909000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00910000
         BALR  4,5                     MOVE INTO RECORD AREA            00911000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00912000
         BR    14                      RETURN TO CALLER                 00913000
         LTORG                                                          00914000
*                                                                       00915000
SQL#0224 DS    0H                                                       00916000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          00917000
         EXEC  SQL                                                     *00918000
               FETCH S13SQ002                                          *00919000
                 INTO :INST,                                           *00920000
                      :RECNBR,                                         *00921000
                      :SS_PLAN                                          00922000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00923000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00924000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00925000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00926000
         BR    12                      OPEN NEXT CURSOR                 00927000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00928000
         BALR  4,5                     MOVE INTO RECORD AREA            00929000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00930000
         BR    14                      RETURN TO CALLER                 00931000
         LTORG                                                          00932000
*                                                                       00933000
SQL#0324 DS    0H                                                       00934000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          00935000
         EXEC  SQL                                                     *00936000
               FETCH S13SQ003                                          *00937000
                 INTO :INST,                                           *00938000
                      :RECNBR,                                         *00939000
                      :SS_PLAN                                          00940000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00941000
         BALR  4,5                     MOVE INTO RECORD AREA            00942000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00943000
         BR    14                      RETURN TO CALLER                 00944000
         LTORG                                                          00945000
*                                                                       00946000
*                                                                       00947000
**********************************************************************  00948000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00949000
* ALTERNATE KEY 1:                                                      00950000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00951000
*     VERBS.                                                            00952000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00953000
*     RETRIEVE THE ACTUAL ROW.                                          00954000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00955000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00956000
*     WILL BE THRU THE UPDATE CURSOR.                                   00957000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00958000
**********************************************************************  00959000
*                                                                       00960000
SQL#0025 DS    0H                                                       00961000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          00962000
         LA    15,255                  SET RETURN CODE                  00963000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00964000
         BR    14                      RETURN TO CALLER                 00965000
         LTORG                                                          00966000
*                                                                       00967000
*                                                                       00968000
**********************************************************************  00969000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00970000
* ALTERNATE KEY 2:                                                      00971000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00972000
*     VERBS.                                                            00973000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00974000
*     RETRIEVE THE ACTUAL ROW.                                          00975000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00976000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00977000
*     WILL BE THRU THE UPDATE CURSOR.                                   00978000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00979000
**********************************************************************  00980000
*                                                                       00981000
SQL#0026 DS    0H                                                       00982000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          00983000
         LA    15,255                  SET RETURN CODE                  00984000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00985000
         BR    14                      RETURN TO CALLER                 00986000
         LTORG                                                          00987000
*                                                                       00988000
*                                                                       00989000
**********************************************************************  00990000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00991000
* ALTERNATE KEY 3:                                                      00992000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00993000
*     VERBS.                                                            00994000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00995000
*     RETRIEVE THE ACTUAL ROW.                                          00996000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00997000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00998000
*     WILL BE THRU THE UPDATE CURSOR.                                   00999000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01000000
**********************************************************************  01001000
*                                                                       01002000
SQL#0027 DS    0H                                                       01003000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01004000
         LA    15,255                  SET RETURN CODE                  01005000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01006000
         BR    14                      RETURN TO CALLER                 01007000
         LTORG                                                          01008000
*                                                                       01009000
*                                                                       01010000
**********************************************************************  01011000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01012000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01013000
*     AND GET-NEXT-LOCK VERBS.                                          01014000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01015000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01016000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01017000
**********************************************************************  01018000
*                                                                       01019000
SQL#0028 DS    0H                                                       01020000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01021000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01022000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01023000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01024000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01025000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01026000
VECT0028 DC    A(SQL#0128)                                              01027000
         DC    A(SQL#0228)                                              01028000
         DC    A(SQL#0328)                                              01029000
         LTORG                                                          01030000
*                                                                       01031000
SQL#0128 DS    0H                                                       01032000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01033000
         EXEC  SQL                                                     *01034000
               CLOSE S13SQ001                                           01035000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01036000
         BR    14                      RETURN TO CALLER                 01037000
         LTORG                                                          01038000
*                                                                       01039000
SQL#0228 DS    0H                                                       01040000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01041000
         EXEC  SQL                                                     *01042000
               CLOSE S13SQ002                                           01043000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01044000
         BR    14                      RETURN TO CALLER                 01045000
         LTORG                                                          01046000
*                                                                       01047000
SQL#0328 DS    0H                                                       01048000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01049000
         EXEC  SQL                                                     *01050000
               CLOSE S13SQ003                                           01051000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01052000
         BR    14                      RETURN TO CALLER                 01053000
         LTORG                                                          01054000
*                                                                       01055000
*                                                                       01056000
**********************************************************************  01057000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01058000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01059000
*     AND GET-NEXT-LOCK VERBS.                                          01060000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01061000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01062000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01063000
**********************************************************************  01064000
*                                                                       01065000
SQL#0029 DS    0H                                                       01066000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01067000
         LA    15,255                  SET RETURN CODE                  01068000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01069000
         BR    14                      RETURN TO CALLER                 01070000
         LTORG                                                          01071000
*                                                                       01072000
*                                                                       01073000
**********************************************************************  01074000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01075000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01076000
*     AND GET-NEXT-LOCK VERBS.                                          01077000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01078000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01079000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01080000
**********************************************************************  01081000
*                                                                       01082000
SQL#0030 DS    0H                                                       01083000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01084000
         LA    15,255                  SET RETURN CODE                  01085000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01086000
         BR    14                      RETURN TO CALLER                 01087000
         LTORG                                                          01088000
*                                                                       01089000
*                                                                       01090000
**********************************************************************  01091000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01092000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01093000
*     AND GET-NEXT-LOCK VERBS.                                          01094000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01095000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01096000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01097000
**********************************************************************  01098000
*                                                                       01099000
SQL#0031 DS    0H                                                       01100000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01101000
         LA    15,255                  SET RETURN CODE                  01102000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01103000
         BR    14                      RETURN TO CALLER                 01104000
         LTORG                                                          01105000
*                                                                       01106000
*                                                                       01107000
**********************************************************************  01108000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01109000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01110000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01111000
**********************************************************************  01112000
*                                                                       01113000
SQL#0032 DS    0H                                                       01114000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01115000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01116000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01117000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01118000
         EXEC  SQL                                                     *01119000
               SELECT INST_NBR,                                        *01120000
                   RECORD_NBR,                                         *01121000
                   SEC_SVC_PLAN                                        *01122000
                 INTO :INST,                                           *01123000
                   :RECNBR,                                            *01124000
                   :SS_PLAN                                            *01125000
                 FROM S13                                              *01126000
                 WHERE INST_NBR = :INST AND                            *01127000
                   RECORD_NBR = :RECNBR AND                            *01128000
                   SEC_SVC_PLAN = :SS_PLAN                             *01129000
                 FETCH FIRST 1 ROW ONLY                                 01130000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01131000
         BR    14                      RETURN TO CALLER                 01132000
         LTORG                                                          01133000
*                                                                       01134000
*                                                                       01135000
**********************************************************************  01136000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01137000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01138000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01139000
**********************************************************************  01140000
*                                                                       01141000
SQL#0033 DS    0H                                                       01142000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01143000
         LA    15,255                  SET RETURN CODE                  01144000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01145000
         BR    14                      RETURN TO CALLER                 01146000
         LTORG                                                          01147000
*                                                                       01148000
*                                                                       01149000
**********************************************************************  01150000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01151000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01152000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01153000
**********************************************************************  01154000
*                                                                       01155000
SQL#0034 DS    0H                                                       01156000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01157000
         LA    15,255                  SET RETURN CODE                  01158000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01159000
         BR    14                      RETURN TO CALLER                 01160000
         LTORG                                                          01161000
*                                                                       01162000
*                                                                       01163000
**********************************************************************  01164000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01165000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01166000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01167000
**********************************************************************  01168000
*                                                                       01169000
SQL#0035 DS    0H                                                       01170000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01171000
         LA    15,255                  SET RETURN CODE                  01172000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01173000
         BR    14                      RETURN TO CALLER                 01174000
         LTORG                                                          01175000
*                                                                       01176000
*                                                                       01177000
**********************************************************************  01178000
* INSERT STATEMENT:                                                     01179000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01180000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01181000
**********************************************************************  01182000
*                                                                       01183000
SQL#0036 DS    0H                                                       01184000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01185000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01186000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01187000
         EXEC  SQL                                                     *01188000
               INSERT INTO S13                                         *01189000
                   (INST_NBR,                                          *01190000
                    RECORD_NBR,                                        *01191000
                    SEC_SVC_PLAN,                                      *01192000
                    AUDIT_DATE,                                        *01193000
                    AUDIT_TIME,                                        *01194000
                    AUDIT_USER,                                        *01195000
                    AUDIT_ORG,                                         *01196000
                    SEC_SVC_CD_01,                                     *01197000
                    SEC_SVC_CD_02,                                     *01198000
                    SEC_SVC_CD_03,                                     *01199000
                    SEC_SVC_CD_04,                                     *01200000
                    SEC_SVC_CD_05,                                     *01201000
                    SEC_SVC_CD_06,                                     *01202000
                    SEC_SVC_CD_07,                                     *01203000
                    SEC_SVC_CD_08,                                     *01204000
                    SEC_SVC_CD_09,                                     *01205000
                    SEC_SVC_CD_10,                                     *01206000
                    SEC_SVC_CD_11,                                     *01207000
                    SEC_SVC_CD_12,                                     *01208000
                    SEC_SVC_CD_13,                                     *01209000
                    SEC_SVC_CD_14,                                     *01210000
                    SEC_SVC_CD_15,                                     *01211000
                    SEC_SVC_CD_16,                                     *01212000
                    SEC_SVC_CD_17,                                     *01213000
                    SEC_SVC_CD_18,                                     *01214000
                    SEC_SVC_CD_19,                                     *01215000
                    SEC_SVC_CD_20)                                     *01216000
                  VALUES (:INST,                                       *01217000
                   :RECNBR,                                            *01218000
                   :SS_PLAN,                                           *01219000
                   :AUDDATE,                                           *01220000
                   :AUDTIME,                                           *01221000
                   :AUDUSER,                                           *01222000
                   :AUDORG,                                            *01223000
                   :SSCD1,                                             *01224000
                   :SSCD2,                                             *01225000
                   :SSCD3,                                             *01226000
                   :SSCD4,                                             *01227000
                   :SSCD5,                                             *01228000
                   :SSCD6,                                             *01229000
                   :SSCD7,                                             *01230000
                   :SSCD8,                                             *01231000
                   :SSCD9,                                             *01232000
                   :SSCD10,                                            *01233000
                   :SSCD11,                                            *01234000
                   :SSCD12,                                            *01235000
                   :SSCD13,                                            *01236000
                   :SSCD14,                                            *01237000
                   :SSCD15,                                            *01238000
                   :SSCD16,                                            *01239000
                   :SSCD17,                                            *01240000
                   :SSCD18,                                            *01241000
                   :SSCD19,                                            *01242000
                   :SSCD20)                                             01243000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01244000
         BR    14                      RETURN TO CALLER                 01245000
         LTORG                                                          01246000
*                                                                       01247000
*                                                                       01248000
**********************************************************************  01249000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01250000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01251000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01252000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01253000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01254000
*     STATEMENT.                                                        01255000
**********************************************************************  01256000
*                                                                       01257000
SQL#0037 DS    0H                                                       01258000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01259000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01260000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01261000
         EXEC  SQL                                                     *01262000
               UPDATE S13                                              *01263000
                   SET AUDIT_DATE = :AUDDATE,                          *01264000
                     AUDIT_TIME = :AUDTIME,                            *01265000
                     AUDIT_USER = :AUDUSER,                            *01266000
                     AUDIT_ORG = :AUDORG,                              *01267000
                     SEC_SVC_CD_01 = :SSCD1,                           *01268000
                     SEC_SVC_CD_02 = :SSCD2,                           *01269000
                     SEC_SVC_CD_03 = :SSCD3,                           *01270000
                     SEC_SVC_CD_04 = :SSCD4,                           *01271000
                     SEC_SVC_CD_05 = :SSCD5,                           *01272000
                     SEC_SVC_CD_06 = :SSCD6,                           *01273000
                     SEC_SVC_CD_07 = :SSCD7,                           *01274000
                     SEC_SVC_CD_08 = :SSCD8,                           *01275000
                     SEC_SVC_CD_09 = :SSCD9,                           *01276000
                     SEC_SVC_CD_10 = :SSCD10,                          *01277000
                     SEC_SVC_CD_11 = :SSCD11,                          *01278000
                     SEC_SVC_CD_12 = :SSCD12,                          *01279000
                     SEC_SVC_CD_13 = :SSCD13,                          *01280000
                     SEC_SVC_CD_14 = :SSCD14,                          *01281000
                     SEC_SVC_CD_15 = :SSCD15,                          *01282000
                     SEC_SVC_CD_16 = :SSCD16,                          *01283000
                     SEC_SVC_CD_17 = :SSCD17,                          *01284000
                     SEC_SVC_CD_18 = :SSCD18,                          *01285000
                     SEC_SVC_CD_19 = :SSCD19,                          *01286000
                     SEC_SVC_CD_20 = :SSCD20                           *01287000
                 WHERE CURRENT OF S13UPD0                               01288000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01289000
         BR    14                      RETURN TO CALLER                 01290000
         LTORG                                                          01291000
*                                                                       01292000
*                                                                       01293000
**********************************************************************  01294000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01295000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01296000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01297000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01298000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01299000
*     STATEMENT.                                                        01300000
**********************************************************************  01301000
*                                                                       01302000
SQL#0038 DS    0H                                                       01303000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01304000
         LA    15,255                  SET RETURN CODE                  01305000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01306000
         BR    14                      RETURN TO CALLER                 01307000
         LTORG                                                          01308000
*                                                                       01309000
*                                                                       01310000
**********************************************************************  01311000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01312000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01313000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01314000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01315000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01316000
*     STATEMENT.                                                        01317000
**********************************************************************  01318000
*                                                                       01319000
SQL#0039 DS    0H                                                       01320000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01321000
         LA    15,255                  SET RETURN CODE                  01322000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01323000
         BR    14                      RETURN TO CALLER                 01324000
         LTORG                                                          01325000
*                                                                       01326000
*                                                                       01327000
**********************************************************************  01328000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01329000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01330000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01331000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01332000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01333000
*     STATEMENT.                                                        01334000
**********************************************************************  01335000
*                                                                       01336000
SQL#0040 DS    0H                                                       01337000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01338000
         LA    15,255                  SET RETURN CODE                  01339000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01340000
         BR    14                      RETURN TO CALLER                 01341000
         LTORG                                                          01342000
*                                                                       01343000
*                                                                       01344000
**********************************************************************  01345000
* DELETE STATEMENT BY PRIMARY KEY:                                      01346000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01347000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01348000
**********************************************************************  01349000
*                                                                       01350000
SQL#0041 DS    0H                                                       01351000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01352000
         EXEC  SQL                                                     *01353000
               DELETE FROM S13                                         *01354000
                 WHERE CURRENT OF S13UPD0                               01355000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01356000
         BR    14                      RETURN TO CALLER                 01357000
         LTORG                                                          01358000
*                                                                       01359000
*                                                                       01360000
**********************************************************************  01361000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01362000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01363000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01364000
**********************************************************************  01365000
*                                                                       01366000
SQL#0042 DS    0H                                                       01367000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01368000
         LA    15,255                  SET RETURN CODE                  01369000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01370000
         BR    14                      RETURN TO CALLER                 01371000
         LTORG                                                          01372000
*                                                                       01373000
*                                                                       01374000
**********************************************************************  01375000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01376000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01377000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01378000
**********************************************************************  01379000
*                                                                       01380000
SQL#0043 DS    0H                                                       01381000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01382000
         LA    15,255                  SET RETURN CODE                  01383000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01384000
         BR    14                      RETURN TO CALLER                 01385000
         LTORG                                                          01386000
*                                                                       01387000
*                                                                       01388000
**********************************************************************  01389000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01390000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01391000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01392000
**********************************************************************  01393000
*                                                                       01394000
SQL#0044 DS    0H                                                       01395000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01396000
         LA    15,255                  SET RETURN CODE                  01397000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01398000
         BR    14                      RETURN TO CALLER                 01399000
         LTORG                                                          01400000
*                                                                       01401000
*                                                                       01402000
**********************************************************************  01403000
* DELETE ALL STATEMENT:                                                 01404000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01405000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01406000
**********************************************************************  01407000
*                                                                       01408000
SQL#0045 DS    0H                                                       01409000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01410000
         EXEC  SQL                                                     *01411000
               DELETE FROM S13                                          01412000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01413000
         BR    14                      RETURN TO CALLER                 01414000
         LTORG                                                          01415000
*                                                                       01416000
*                                                                       01417000
**********************************************************************  01418000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01419000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01420000
**********************************************************************  01421000
*                                                                       01422000
SQL#0046 DS    0H                                                       01423000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01424000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01425000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01426000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01427000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01428000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01429000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01430000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01431000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01432000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01433000
VECT0046 DC    A(0)                                                     01434000
         DC    A(SQL#0246)                                              01435000
         DC    A(SQL#0346)                                              01436000
         LTORG                                                          01437000
*                                                                       01438000
SQL#0246 DS    0H                                                       01439000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01440000
         EXEC  SQL                                                     *01441000
               CLOSE S13SQ001                                           01442000
         EXEC  SQL                                                     *01443000
               DECLARE S13SQ002 CURSOR FOR                             *01444000
               SELECT INST_NBR,                                        *01445000
                   RECORD_NBR,                                         *01446000
                   SEC_SVC_PLAN,                                       *01447000
                   AUDIT_DATE,                                         *01448000
                   AUDIT_TIME,                                         *01449000
                   AUDIT_USER,                                         *01450000
                   AUDIT_ORG,                                          *01451000
                   SEC_SVC_CD_01,                                      *01452000
                   SEC_SVC_CD_02,                                      *01453000
                   SEC_SVC_CD_03,                                      *01454000
                   SEC_SVC_CD_04,                                      *01455000
                   SEC_SVC_CD_05,                                      *01456000
                   SEC_SVC_CD_06,                                      *01457000
                   SEC_SVC_CD_07,                                      *01458000
                   SEC_SVC_CD_08,                                      *01459000
                   SEC_SVC_CD_09,                                      *01460000
                   SEC_SVC_CD_10,                                      *01461000
                   SEC_SVC_CD_11,                                      *01462000
                   SEC_SVC_CD_12,                                      *01463000
                   SEC_SVC_CD_13,                                      *01464000
                   SEC_SVC_CD_14,                                      *01465000
                   SEC_SVC_CD_15,                                      *01466000
                   SEC_SVC_CD_16,                                      *01467000
                   SEC_SVC_CD_17,                                      *01468000
                   SEC_SVC_CD_18,                                      *01469000
                   SEC_SVC_CD_19,                                      *01470000
                   SEC_SVC_CD_20                                       *01471000
                 FROM S13                                              *01472000
                 WHERE                                                 *01473000
                    INST_NBR = :INST AND                               *01474000
                    RECORD_NBR > :RECNBR                               *01475000
                 ORDER BY RECORD_NBR,                                  *01476000
                   SEC_SVC_PLAN                                        *01477000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01478000
         EXEC  SQL                                                     *01479000
               OPEN S13SQ002                                            01480000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01481000
         BNZ   *+8                     NO - RETURN ERROR                01482000
         LR    12,9                    LOAD RETURN ADDRESS              01483000
         BR    12                      RETURN TO FETCH ROUTINE          01484000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01485000
         BR    14                      RETURN TO CALLER                 01486000
         LTORG                                                          01487000
*                                                                       01488000
SQL#0346 DS    0H                                                       01489000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01490000
         EXEC  SQL                                                     *01491000
               CLOSE S13SQ002                                           01492000
         EXEC  SQL                                                     *01493000
               DECLARE S13SQ003 CURSOR FOR                             *01494000
               SELECT INST_NBR,                                        *01495000
                   RECORD_NBR,                                         *01496000
                   SEC_SVC_PLAN,                                       *01497000
                   AUDIT_DATE,                                         *01498000
                   AUDIT_TIME,                                         *01499000
                   AUDIT_USER,                                         *01500000
                   AUDIT_ORG,                                          *01501000
                   SEC_SVC_CD_01,                                      *01502000
                   SEC_SVC_CD_02,                                      *01503000
                   SEC_SVC_CD_03,                                      *01504000
                   SEC_SVC_CD_04,                                      *01505000
                   SEC_SVC_CD_05,                                      *01506000
                   SEC_SVC_CD_06,                                      *01507000
                   SEC_SVC_CD_07,                                      *01508000
                   SEC_SVC_CD_08,                                      *01509000
                   SEC_SVC_CD_09,                                      *01510000
                   SEC_SVC_CD_10,                                      *01511000
                   SEC_SVC_CD_11,                                      *01512000
                   SEC_SVC_CD_12,                                      *01513000
                   SEC_SVC_CD_13,                                      *01514000
                   SEC_SVC_CD_14,                                      *01515000
                   SEC_SVC_CD_15,                                      *01516000
                   SEC_SVC_CD_16,                                      *01517000
                   SEC_SVC_CD_17,                                      *01518000
                   SEC_SVC_CD_18,                                      *01519000
                   SEC_SVC_CD_19,                                      *01520000
                   SEC_SVC_CD_20                                       *01521000
                 FROM S13                                              *01522000
                 WHERE                                                 *01523000
                    INST_NBR > :INST                                   *01524000
                 ORDER BY INST_NBR,                                    *01525000
                   RECORD_NBR,                                         *01526000
                   SEC_SVC_PLAN                                        *01527000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01528000
         EXEC  SQL                                                     *01529000
               OPEN S13SQ003                                            01530000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01531000
         BNZ   *+8                     NO - RETURN ERROR                01532000
         LR    12,9                    LOAD RETURN ADDRESS              01533000
         BR    12                      RETURN TO FETCH ROUTINE          01534000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01535000
         BR    14                      RETURN TO CALLER                 01536000
         LTORG                                                          01537000
*                                                                       01538000
*                                                                       01539000
**********************************************************************  01540000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01541000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01542000
**********************************************************************  01543000
*                                                                       01544000
SQL#0047 DS    0H                                                       01545000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01546000
         LA    15,255                  SET RETURN CODE                  01547000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01548000
         BR    14                      RETURN TO CALLER                 01549000
         LTORG                                                          01550000
*                                                                       01551000
*                                                                       01552000
**********************************************************************  01553000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01554000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01555000
**********************************************************************  01556000
*                                                                       01557000
SQL#0048 DS    0H                                                       01558000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01559000
         LA    15,255                  SET RETURN CODE                  01560000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01561000
         BR    14                      RETURN TO CALLER                 01562000
         LTORG                                                          01563000
*                                                                       01564000
*                                                                       01565000
**********************************************************************  01566000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01567000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01568000
**********************************************************************  01569000
*                                                                       01570000
SQL#0049 DS    0H                                                       01571000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01572000
         LA    15,255                  SET RETURN CODE                  01573000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01574000
         BR    14                      RETURN TO CALLER                 01575000
         LTORG                                                          01576000
*                                                                       01577000
         DS    0H                      END OF SQL STATEMENTS            01578000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01579000
*                                                                       01580000
*                                                                       01581000
**********************************************************************  01582000
* DUMMY ENTRY POINT DSNHLI                                              01583000
*   MUST NOT BE MODIFIED.                                               01584000
**********************************************************************  01585000
*                                                                       01586000
         ENTRY DSNHLI                                                   01587000
DSNHLI   DS    0H                                                       01588000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01589000
         BR    15                      BRANCH TO ATTACH FACILITY        01590000
*                                                                       01591000
*                                                                       01592000
**********************************************************************  01593000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01594000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01595000
*   MUST NOT BE MODIFIED.                                               01596000
**********************************************************************  01597000
*                                                                       01598000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01599000
CONV#RTN AMODE ANY                                                      01600000
CONV#RTN RMODE ANY                                                      01601000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01602000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01603000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01604000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01605000
         BER   4                         YES - RETURN TO SQL            01606000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01607000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01608000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01609000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01610000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01611000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01612000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01613000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01614000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01615000
*                                                                       01616000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01617000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01618000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01619000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01620000
         BER   4                         YES - RETURN TO SQL            01621000
         SLR   0,0                     CLEAR FOR INSERT                 01622000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01623000
         NR    0,3                     FOR THE CURRENT KEY?             01624000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01625000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01626000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01627000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01628000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01629000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01630000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01631000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01632000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01633000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01634000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01635000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01636000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01637000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01638000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01639000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01640000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01641000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01642000
*                                                                       01643000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01644000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01645000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01646000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01647000
         BER   4                         YES - RETURN TO SQL            01648000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01649000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01650000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01651000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01652000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01653000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01654000
         MVCL  0,14                    MOVE TO RECORD AREA              01655000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01656000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01657000
*                                                                       01658000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01659000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01660000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01661000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01662000
         BER   4                         YES - RETURN TO SQL            01663000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01664000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01665000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01666000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01667000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01668000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01669000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01670000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01671000
         MVCL  0,14                    MOVE TO RECORD AREA              01672000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01673000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01674000
*                                                                       01675000
*                                                                       01676000
**********************************************************************  01677000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01678000
*   MUST NOT BE MODIFIED.                                               01679000
**********************************************************************  01680000
*                                                                       01681000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01682000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01683000
         DC    H'0014'                 LENGTH TO MOVE                   01684000
         DC    X'80'                   80 = KEY 0 FIELD                 01685000
*                                      40 = KEY 1 FIELD                 01686000
*                                      20 = KEY 2 FIELD                 01687000
*                                      10 = KEY 3 FIELD                 01688000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        01689000
*                                                                       01690000
*                                      REST OF FIELD ENTRIES            01691000
         DC    H'0014',H'0014',H'0144',X'00',X'00'                      01692000
         DC    8X'FF'                  END OF FIELD ENTRIES             01693000
         LTORG                                                          01694000
         END                                                            01695000
