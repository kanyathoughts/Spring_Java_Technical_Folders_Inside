**********************************************************************  00001000
*                                                                       00002000
*  S11UDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S11 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
TRANPROF DS    CL6                                                      00052000
TRANPLAN DS    CL3                                                      00053000
TRANEXTL DS    CL4                                                      00054000
INTLTCD  DS    CL4                                                      00055000
AUDDATE  DS    PL5'0.'                                                  00056000
AUDTIME  DS    PL5'0.'                                                  00057000
AUDUSER  DS    CL8                                                      00058000
AUDORG   DS    CL6                                                      00059000
TRANDESC DS    CL30                                                     00060000
TRANSIGN DS    CL1                                                      00061000
ACCOPT01 DS    CL1                                                      00062000
MINAMT01 DS    PL5'0.'                                                  00063000
ACCOPT02 DS    CL1                                                      00064000
MINAMT02 DS    PL5'0.'                                                  00065000
ACCOPT03 DS    CL1                                                      00066000
MINAMT03 DS    PL5'0.'                                                  00067000
ACCOPT04 DS    CL1                                                      00068000
MINAMT04 DS    PL5'0.'                                                  00069000
ACCOPT05 DS    CL1                                                      00070000
MINAMT05 DS    PL5'0.'                                                  00071000
ACCOPT06 DS    CL1                                                      00072000
MINAMT06 DS    PL5'0.'                                                  00073000
ACCOPT07 DS    CL1                                                      00074000
MINAMT07 DS    PL5'0.'                                                  00075000
ACCOPT08 DS    CL1                                                      00076000
MINAMT08 DS    PL5'0.'                                                  00077000
ACCOPT09 DS    CL1                                                      00078000
MINAMT09 DS    PL5'0.'                                                  00079000
ACCOPT10 DS    CL1                                                      00080000
MINAMT10 DS    PL5'0.'                                                  00081000
ACCOPT11 DS    CL1                                                      00082000
MINAMT11 DS    PL5'0.'                                                  00083000
ACCOPT12 DS    CL1                                                      00084000
MINAMT12 DS    PL5'0.'                                                  00085000
*                                                                       00086000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00087000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00088000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00089000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00090000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00091000
         DS    CL97                    RESERVED                         00092000
*                                                                       00093000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00094000
INDVARX  DS    0H                                                       00095000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00096000
*                                                                       00097000
*                                                                       00098000
**********************************************************************  00099000
* PROGRAM TABLE HEADER SECTION:                                         00100000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00101000
**********************************************************************  00102000
*                                                                       00103000
S11UDB   CSECT                         PROGRAM TABLE SECTION            00104000
S11UDB   AMODE ANY                                                      00105000
S11UDB   RMODE ANY                                                      00106000
         DC    CL8'S11UDB  '           PROGRAM ID                       00107000
         DC    CL1' '                                                   00108000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00109000
         DC    CL1' '                                                   00110000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00111000
         DC    CL1' '                                                   00112000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00113000
         DC    5A(0)                   RESERVED                         00114000
         DC    AL2(0)                  RESERVED                         00115000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00116000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00117000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00118000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00119000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00120000
         DC    CL29'WWW.INFOR.COM                '                      00120001
*                                                                       00121000
**********************************************************************  00122000
* STATEMENT TABLE SECTION:                                              00123000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00124000
**********************************************************************  00125000
*                                                                       00126000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00127000
STM#TAB  AMODE ANY                                                      00128000
STM#TAB  RMODE ANY                                                      00129000
         DC    4A(0)                   RDB MODULE VECTORS               00130000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00131000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00132000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00133000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00134000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00135000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00136000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00137000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00138000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00139000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00140000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00141000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00142000
         DC    20A(0)                  RDB MODULE VECTORS               00143000
         DC    A(INSROW)               INSERT STATEMENT                 00144000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00145000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00146000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00147000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00148000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00149000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00150000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00151000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00152000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00153000
         DC    4X'FF'                                                   00154000
*                                                                       00155000
**********************************************************************  00156000
* SQL STATEMENT SECTION:                                                00157000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00158000
*     TO SUPPORT THIS TABLE.                                            00159000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00160000
*     ARE EQUIVALENT.                                                   00161000
**********************************************************************  00162000
*                                                                       00163000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00164000
SQL#STMT AMODE ANY                                                      00165000
SQL#STMT RMODE ANY                                                      00166000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00167000
         USING COM#AREA,11             ADDRESS COMMAREA                 00168000
*                                                                       00169000
**********************************************************************  00170000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00171000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00172000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00173000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00174000
**********************************************************************  00175000
*                                                                       00176000
SELUC0   DS    0H                                                       00177000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00178000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00179000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00180000
         BALR  14,15                   MOVE REQUESTED DATA              00181000
         EXEC  SQL DECLARE S11UPD0 CURSOR                              *00182000
               FOR SELECT                                              *00183000
                   AUDIT_DATE,                                         *00184000
                   AUDIT_TIME,                                         *00185000
                   AUDIT_USER,                                         *00186000
                   AUDIT_ORG,                                          *00187000
                   TRAN_DESC,                                          *00188000
                   TRAN_SIGN,                                          *00189000
                   ACCUM_OPTION_01,                                    *00190000
                   MIN_AMOUNT_01,                                      *00191000
                   ACCUM_OPTION_02,                                    *00192000
                   MIN_AMOUNT_02,                                      *00193000
                   ACCUM_OPTION_03,                                    *00194000
                   MIN_AMOUNT_03,                                      *00195000
                   ACCUM_OPTION_04,                                    *00196000
                   MIN_AMOUNT_04,                                      *00197000
                   ACCUM_OPTION_05,                                    *00198000
                   MIN_AMOUNT_05,                                      *00199000
                   ACCUM_OPTION_06,                                    *00200000
                   MIN_AMOUNT_06,                                      *00201000
                   ACCUM_OPTION_07,                                    *00202000
                   MIN_AMOUNT_07,                                      *00203000
                   ACCUM_OPTION_08,                                    *00204000
                   MIN_AMOUNT_08,                                      *00205000
                   ACCUM_OPTION_09,                                    *00206000
                   MIN_AMOUNT_09,                                      *00207000
                   ACCUM_OPTION_10,                                    *00208000
                   MIN_AMOUNT_10,                                      *00209000
                   ACCUM_OPTION_11,                                    *00210000
                   MIN_AMOUNT_11,                                      *00211000
                   ACCUM_OPTION_12,                                    *00212000
                   MIN_AMOUNT_12                                       *00213000
                 FROM S11                                              *00214000
                 WHERE                                                 *00215000
                   INST_NBR = :INST AND                                *00216000
                   RECORD_NBR = :RECNBR AND                            *00217000
                   TRAN_PROFILE = :TRANPROF AND                        *00218000
                   TRAN_PLAN = :TRANPLAN AND                           *00219000
                   EXTL_TRAN_CODE = :TRANEXTL AND                      *00220000
                   INTL_TRAN_CODE = :INTLTCD                           *00221000
                 FOR UPDATE OF                                         *00222000
                   AUDIT_DATE,                                         *00223000
                   AUDIT_TIME,                                         *00224000
                   AUDIT_USER,                                         *00225000
                   AUDIT_ORG,                                          *00226000
                   TRAN_DESC,                                          *00227000
                   TRAN_SIGN,                                          *00228000
                   ACCUM_OPTION_01,                                    *00229000
                   MIN_AMOUNT_01,                                      *00230000
                   ACCUM_OPTION_02,                                    *00231000
                   MIN_AMOUNT_02,                                      *00232000
                   ACCUM_OPTION_03,                                    *00233000
                   MIN_AMOUNT_03,                                      *00234000
                   ACCUM_OPTION_04,                                    *00235000
                   MIN_AMOUNT_04,                                      *00236000
                   ACCUM_OPTION_05,                                    *00237000
                   MIN_AMOUNT_05,                                      *00238000
                   ACCUM_OPTION_06,                                    *00239000
                   MIN_AMOUNT_06,                                      *00240000
                   ACCUM_OPTION_07,                                    *00241000
                   MIN_AMOUNT_07,                                      *00242000
                   ACCUM_OPTION_08,                                    *00243000
                   MIN_AMOUNT_08,                                      *00244000
                   ACCUM_OPTION_09,                                    *00245000
                   MIN_AMOUNT_09,                                      *00246000
                   ACCUM_OPTION_10,                                    *00247000
                   MIN_AMOUNT_10,                                      *00248000
                   ACCUM_OPTION_11,                                    *00249000
                   MIN_AMOUNT_11,                                      *00250000
                   ACCUM_OPTION_12,                                    *00251000
                   MIN_AMOUNT_12                                       *00252000
                 FETCH FIRST 1 ROW ONLY                                 00253000
         EXEC  SQL OPEN S11UPD0                                         00254000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00255000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00256000
         BR    14                      RETURN TO CALLER                 00257000
         LTORG                                                          00258000
*                                                                       00259000
**********************************************************************  00260000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00261000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00262000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00263000
*     THE ACTUAL ROW.                                                   00264000
**********************************************************************  00265000
*                                                                       00266000
FETUC0   DS    0H                                                       00267000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00268000
         EXEC  SQL FETCH S11UPD0                                       *00269000
                 INTO                                                  *00270000
                   :AUDDATE,                                           *00271000
                   :AUDTIME,                                           *00272000
                   :AUDUSER,                                           *00273000
                   :AUDORG,                                            *00274000
                   :TRANDESC,                                          *00275000
                   :TRANSIGN,                                          *00276000
                   :ACCOPT01,                                          *00277000
                   :MINAMT01,                                          *00278000
                   :ACCOPT02,                                          *00279000
                   :MINAMT02,                                          *00280000
                   :ACCOPT03,                                          *00281000
                   :MINAMT03,                                          *00282000
                   :ACCOPT04,                                          *00283000
                   :MINAMT04,                                          *00284000
                   :ACCOPT05,                                          *00285000
                   :MINAMT05,                                          *00286000
                   :ACCOPT06,                                          *00287000
                   :MINAMT06,                                          *00288000
                   :ACCOPT07,                                          *00289000
                   :MINAMT07,                                          *00290000
                   :ACCOPT08,                                          *00291000
                   :MINAMT08,                                          *00292000
                   :ACCOPT09,                                          *00293000
                   :MINAMT09,                                          *00294000
                   :ACCOPT10,                                          *00295000
                   :MINAMT10,                                          *00296000
                   :ACCOPT11,                                          *00297000
                   :MINAMT11,                                          *00298000
                   :ACCOPT12,                                          *00299000
                   :MINAMT12                                            00300000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00301000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00302000
         BALR  14,15                   MOVE REQUESTED DATA              00303000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00304000
         BR    14                      RETURN TO CALLER                 00305000
         LTORG                                                          00306000
*                                                                       00307000
**********************************************************************  00308000
* INSERT STATEMENT:                                                     00309000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00310000
**********************************************************************  00311000
*                                                                       00312000
INSROW   DS    0H                                                       00313000
         USING INSROW,12               ESTABLISH BASE REGISTER          00314000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00315000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00316000
         BALR  14,15                   MOVE REQUESTED DATA              00317000
         EXEC  SQL INSERT INTO S11                                     *00318000
                   (                                                   *00319000
                   INST_NBR,                                           *00320000
                   RECORD_NBR,                                         *00321000
                   TRAN_PROFILE,                                       *00322000
                   TRAN_PLAN,                                          *00323000
                   EXTL_TRAN_CODE,                                     *00324000
                   INTL_TRAN_CODE,                                     *00325000
                   AUDIT_DATE,                                         *00326000
                   AUDIT_TIME,                                         *00327000
                   AUDIT_USER,                                         *00328000
                   AUDIT_ORG,                                          *00329000
                   TRAN_DESC,                                          *00330000
                   TRAN_SIGN,                                          *00331000
                   ACCUM_OPTION_01,                                    *00332000
                   MIN_AMOUNT_01,                                      *00333000
                   ACCUM_OPTION_02,                                    *00334000
                   MIN_AMOUNT_02,                                      *00335000
                   ACCUM_OPTION_03,                                    *00336000
                   MIN_AMOUNT_03,                                      *00337000
                   ACCUM_OPTION_04,                                    *00338000
                   MIN_AMOUNT_04,                                      *00339000
                   ACCUM_OPTION_05,                                    *00340000
                   MIN_AMOUNT_05,                                      *00341000
                   ACCUM_OPTION_06,                                    *00342000
                   MIN_AMOUNT_06,                                      *00343000
                   ACCUM_OPTION_07,                                    *00344000
                   MIN_AMOUNT_07,                                      *00345000
                   ACCUM_OPTION_08,                                    *00346000
                   MIN_AMOUNT_08,                                      *00347000
                   ACCUM_OPTION_09,                                    *00348000
                   MIN_AMOUNT_09,                                      *00349000
                   ACCUM_OPTION_10,                                    *00350000
                   MIN_AMOUNT_10,                                      *00351000
                   ACCUM_OPTION_11,                                    *00352000
                   MIN_AMOUNT_11,                                      *00353000
                   ACCUM_OPTION_12,                                    *00354000
                   MIN_AMOUNT_12                                       *00355000
                   )                                                   *00356000
                  VALUES                                               *00357000
                   (                                                   *00358000
                   :INST,                                              *00359000
                   :RECNBR,                                            *00360000
                   :TRANPROF,                                          *00361000
                   :TRANPLAN,                                          *00362000
                   :TRANEXTL,                                          *00363000
                   :INTLTCD,                                           *00364000
                   :AUDDATE,                                           *00365000
                   :AUDTIME,                                           *00366000
                   :AUDUSER,                                           *00367000
                   :AUDORG,                                            *00368000
                   :TRANDESC,                                          *00369000
                   :TRANSIGN,                                          *00370000
                   :ACCOPT01,                                          *00371000
                   :MINAMT01,                                          *00372000
                   :ACCOPT02,                                          *00373000
                   :MINAMT02,                                          *00374000
                   :ACCOPT03,                                          *00375000
                   :MINAMT03,                                          *00376000
                   :ACCOPT04,                                          *00377000
                   :MINAMT04,                                          *00378000
                   :ACCOPT05,                                          *00379000
                   :MINAMT05,                                          *00380000
                   :ACCOPT06,                                          *00381000
                   :MINAMT06,                                          *00382000
                   :ACCOPT07,                                          *00383000
                   :MINAMT07,                                          *00384000
                   :ACCOPT08,                                          *00385000
                   :MINAMT08,                                          *00386000
                   :ACCOPT09,                                          *00387000
                   :MINAMT09,                                          *00388000
                   :ACCOPT10,                                          *00389000
                   :MINAMT10,                                          *00390000
                   :ACCOPT11,                                          *00391000
                   :MINAMT11,                                          *00392000
                   :ACCOPT12,                                          *00393000
                   :MINAMT12                                           *00394000
                   )                                                    00395000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00396000
         BR    14                      RETURN TO CALLER                 00397000
         LTORG                                                          00398000
*                                                                       00399000
**********************************************************************  00400000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00401000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00402000
**********************************************************************  00403000
*                                                                       00404000
UPDUC0   DS    0H                                                       00405000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00406000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00407000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00408000
         BALR  14,15                   MOVE REQUESTED DATA              00409000
         EXEC  SQL UPDATE S11                                          *00410000
                   SET                                                 *00411000
                     AUDIT_DATE = :AUDDATE,                            *00412000
                     AUDIT_TIME = :AUDTIME,                            *00413000
                     AUDIT_USER = :AUDUSER,                            *00414000
                     AUDIT_ORG = :AUDORG,                              *00415000
                     TRAN_DESC = :TRANDESC,                            *00416000
                     TRAN_SIGN = :TRANSIGN,                            *00417000
                     ACCUM_OPTION_01 = :ACCOPT01,                      *00418000
                     MIN_AMOUNT_01 = :MINAMT01,                        *00419000
                     ACCUM_OPTION_02 = :ACCOPT02,                      *00420000
                     MIN_AMOUNT_02 = :MINAMT02,                        *00421000
                     ACCUM_OPTION_03 = :ACCOPT03,                      *00422000
                     MIN_AMOUNT_03 = :MINAMT03,                        *00423000
                     ACCUM_OPTION_04 = :ACCOPT04,                      *00424000
                     MIN_AMOUNT_04 = :MINAMT04,                        *00425000
                     ACCUM_OPTION_05 = :ACCOPT05,                      *00426000
                     MIN_AMOUNT_05 = :MINAMT05,                        *00427000
                     ACCUM_OPTION_06 = :ACCOPT06,                      *00428000
                     MIN_AMOUNT_06 = :MINAMT06,                        *00429000
                     ACCUM_OPTION_07 = :ACCOPT07,                      *00430000
                     MIN_AMOUNT_07 = :MINAMT07,                        *00431000
                     ACCUM_OPTION_08 = :ACCOPT08,                      *00432000
                     MIN_AMOUNT_08 = :MINAMT08,                        *00433000
                     ACCUM_OPTION_09 = :ACCOPT09,                      *00434000
                     MIN_AMOUNT_09 = :MINAMT09,                        *00435000
                     ACCUM_OPTION_10 = :ACCOPT10,                      *00436000
                     MIN_AMOUNT_10 = :MINAMT10,                        *00437000
                     ACCUM_OPTION_11 = :ACCOPT11,                      *00438000
                     MIN_AMOUNT_11 = :MINAMT11,                        *00439000
                     ACCUM_OPTION_12 = :ACCOPT12,                      *00440000
                     MIN_AMOUNT_12 = :MINAMT12                         *00441000
                 WHERE CURRENT OF S11UPD0                               00442000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00443000
         BR    14                      RETURN TO CALLER                 00444000
         LTORG                                                          00445000
*                                                                       00446000
**********************************************************************  00447000
* DELETE STATEMENT BY PRIMARY KEY:                                      00448000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00449000
**********************************************************************  00450000
*                                                                       00451000
DELUC0   DS    0H                                                       00452000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00453000
         EXEC  SQL DELETE FROM S11                                     *00454000
                 WHERE CURRENT OF S11UPD0                               00455000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00456000
         BR    14                      RETURN TO CALLER                 00457000
         LTORG                                                          00458000
*                                                                       00459000
**********************************************************************  00460000
* DELETE ALL STATEMENT:                                                 00461000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00462000
**********************************************************************  00463000
*                                                                       00464000
DELTBL   DS    0H                                                       00465000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00466000
         EXEC  SQL DELETE FROM S11                                      00467000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00468000
         BR    14                      RETURN TO CALLER                 00469000
         LTORG                                                          00470000
*                                                                       00471000
**********************************************************************  00472000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00473000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00474000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00475000
*     TO CLOSE THE UPDATE CURSOR.                                       00476000
**********************************************************************  00477000
*                                                                       00478000
CLSUC0   DS    0H                                                       00479000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00480000
         EXEC  SQL CLOSE S11UPD0                                        00481000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00482000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00483000
         BR    14                      RETURN TO CALLER                 00484000
         LTORG                                                          00485000
*                                                                       00486000
**********************************************************************  00487000
* ALTERNATE KEY 1 NOT DEFINED                                           00488000
**********************************************************************  00489000
*                                                                       00490000
SELUC1   DS    0H                                                       00491000
FETUC1   DS    0H                                                       00492000
UPDUC1   DS    0H                                                       00493000
DELUC1   DS    0H                                                       00494000
CLSUC1   DS    0H                                                       00495000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00496000
*                                                                       00497000
**********************************************************************  00498000
* ALTERNATE KEY 2 NOT DEFINED                                           00499000
**********************************************************************  00500000
*                                                                       00501000
SELUC2   DS    0H                                                       00502000
FETUC2   DS    0H                                                       00503000
UPDUC2   DS    0H                                                       00504000
DELUC2   DS    0H                                                       00505000
CLSUC2   DS    0H                                                       00506000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00507000
*                                                                       00508000
**********************************************************************  00509000
* ALTERNATE KEY 3 NOT DEFINED                                           00510000
**********************************************************************  00511000
*                                                                       00512000
SELUC3   DS    0H                                                       00513000
FETUC3   DS    0H                                                       00514000
UPDUC3   DS    0H                                                       00515000
DELUC3   DS    0H                                                       00516000
CLSUC3   DS    0H                                                       00517000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00518000
*                                                                       00519000
         DS    0H                      END OF SQL STATEMENTS            00520000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00521000
*                                                                       00522000
**********************************************************************  00523000
* DUMMY ENTRY POINT DSNHLI                                              00524000
**********************************************************************  00525000
*                                                                       00526000
         ENTRY DSNHLI                                                   00527000
DSNHLI   DS    0H                                                       00528000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00529000
         BR    15                      BRANCH TO ATTACH FACILITY        00530000
*                                                                       00531000
**********************************************************************  00532000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00533000
**********************************************************************  00534000
*                                                                       00535000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00536000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00537000
* OR:                                                                   00538000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00539000
* WHERE:                                                                00540000
*   RRRR = RECORD AREA OFFSET                                           00541000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00542000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00543000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00544000
*   KK   = KEY FIELD MASK:                                              00545000
*            80 = KEY 0 FIELD                                           00546000
*            40 = KEY 1 FIELD                                           00547000
*            20 = KEY 2 FIELD                                           00548000
*            10 = KEY 3 FIELD                                           00549000
*   DD   = DATA FIELD MASK:                                             00550000
*            80 = RECORD FIELD IS PACKED                                00551000
*            40 = HOST VARIABLE IS PACKED                               00552000
*            20 = NULLABLE FIELD                                        00553000
*            01 = DATE FIELD                                            00554000
*            02 = TIME FIELD                                            00555000
*                                                                       00556000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00557000
         DC    H'0000',H'0000',H'0025',X'80',X'00'                      00558000
         DC    H'0025',H'0025',H'0127',X'00',X'00'                      00559000
         DC    8X'FF'                                                   00560000
*                                                                       00561000
         LTORG                                                          00562000
         END                                                            00563000
