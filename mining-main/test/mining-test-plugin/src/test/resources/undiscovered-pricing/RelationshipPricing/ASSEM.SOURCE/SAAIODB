* REL=SAAIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SAAIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAA FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL437                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
PRDCDE   DS    CL6                                                      00039000
ACCTNBR  DS    CL18                                                     00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
SCINCENO DS    CL1                                                      00045000
INCENQ   DS    CL1                                                      00046000
SCMODEL  DS    CL10                                                     00047000
DISCAMT  DS    PL6'0.00'                                                00048000
DISCPCT  DS    CL5                                                      00049000
RINCENO  DS    CL1                                                      00050000
RINCENQ  DS    CL1                                                      00051000
RATMODL  DS    CL10                                                     00052000
RATTYP   DS    CL1                                                      00053000
RATOPT   DS    CL1                                                      00054000
RATEPCT  DS    CL9                                                      00055000
PROCOPT  DS    CL1                                                      00056000
RTAMT1   DS    PL5'0.'                                                  00057000
RTPCT1   DS    PL5'0.000000000'                                         00058000
RTAMT2   DS    PL5'0.'                                                  00059000
RTPCT2   DS    PL5'0.000000000'                                         00060000
RTAMT3   DS    PL5'0.'                                                  00061000
RTPCT3   DS    PL5'0.000000000'                                         00062000
RTAMT4   DS    PL5'0.'                                                  00063000
RTPCT4   DS    PL5'0.000000000'                                         00064000
RTAMT5   DS    PL5'0.'                                                  00065000
RTPCT5   DS    PL5'0.000000000'                                         00066000
RTAMT6   DS    PL5'0.'                                                  00067000
RTPCT6   DS    PL5'0.000000000'                                         00068000
RTAMT7   DS    PL5'0.'                                                  00069000
RTPCT7   DS    PL5'0.000000000'                                         00070000
RTAMT8   DS    PL5'0.'                                                  00071000
RTPCT8   DS    PL5'0.000000000'                                         00072000
RTAMT9   DS    PL5'0.'                                                  00073000
RTPCT9   DS    PL5'0.000000000'                                         00074000
RTAMT10  DS    PL5'0.'                                                  00075000
RTPCT10  DS    PL5'0.000000000'                                         00076000
RTAMT11  DS    PL5'0.'                                                  00077000
RTPCT11  DS    PL5'0.000000000'                                         00078000
RTAMT12  DS    PL5'0.'                                                  00079000
RTPCT12  DS    PL5'0.000000000'                                         00080000
RTAMT13  DS    PL5'0.'                                                  00081000
RTPCT13  DS    PL5'0.000000000'                                         00082000
RTAMT14  DS    PL5'0.'                                                  00083000
RTPCT14  DS    PL5'0.000000000'                                         00084000
RTAMT15  DS    PL5'0.'                                                  00085000
RTPCT15  DS    PL5'0.000000000'                                         00086000
APPLNBR  DS    CL2                                                      00087000
SVCIOPT  DS    CL1                                                      00088000
SECSVC1  DS    CL6                                                      00089000
SECSVC2  DS    CL6                                                      00090000
SECSVC3  DS    CL6                                                      00091000
SECSVC4  DS    CL6                                                      00092000
SECSVC5  DS    CL6                                                      00093000
SECSVC6  DS    CL6                                                      00094000
SECSVC7  DS    CL6                                                      00095000
SECSVC8  DS    CL6                                                      00096000
SECSVC9  DS    CL6                                                      00097000
SECSVC10 DS    CL6                                                      00098000
SECSVC11 DS    CL6                                                      00099000
SECSVC12 DS    CL6                                                      00100000
SECSVC13 DS    CL6                                                      00101000
SECSVC14 DS    CL6                                                      00102000
SECSVC15 DS    CL6                                                      00103000
SECSVC16 DS    CL6                                                      00104000
SECSVC17 DS    CL6                                                      00105000
SECSVC18 DS    CL6                                                      00106000
SECSVC19 DS    CL6                                                      00107000
SECSVC20 DS    CL6                                                      00108000
RSVAMT   DS    PL8'0.00'                                                00109000
MISCOPT1 DS    CL1                                                      00110000
MISCOPT2 DS    CL1                                                      00111000
MISCOPT3 DS    CL1                                                      00112000
RSVFLG   DS    CL1                                                      00113000
RSVFLG1  DS    CL1                                                      00114000
RSVFLG2  DS    CL1                                                      00115000
RSVFLG3  DS    CL1                                                      00116000
RAREA    DS    CL50                                                     00117000
*                                                                       00118000
*                                                                       00119000
**********************************************************************  00120000
* PROGRAM TABLE HEADER SECTION:                                         00121000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00122000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00123000
**********************************************************************  00124000
*                                                                       00125000
SAAIODB  CSECT                         PROGRAM TABLE SECTION            00126000
SAAIODB  AMODE ANY                                                      00127000
SAAIODB  RMODE ANY                                                      00128000
         DC    CL9'SAAIODB'            PROGRAM ID                       00129000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00130000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00131000
         DC    A(0)                    RESERVED                         00132000
         DC    A(0)                    RESERVED                         00133000
         DC    24CL1' '                RESERVED                         00134000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00135000
*                                                                       00136000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00137000
         DC    CL29'WWW.INFOR.COM                '                      00137001
*                                                                       00138000
*                                                                       00139000
**********************************************************************  00140000
* STATEMENT TABLE SECTION:                                              00141000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00142000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00143000
*   SHOULD NOT BE MODIFIED.                                             00144000
**********************************************************************  00145000
*                                                                       00146000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00147000
STM#TAB  AMODE ANY                                                      00148000
STM#TAB  RMODE ANY                                                      00149000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00150000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00151000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00152000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00153000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00154000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00155000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00156000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00157000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00158000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00159000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00160000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00161000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00162000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00163000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00164000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00165000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00166000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00167000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00168000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00169000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00170000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00171000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00172000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00173000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00174000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00175000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00176000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00177000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00178000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00179000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00180000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00181000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00182000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00183000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00184000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00185000
         DC    A(SQL#0036)             INSERT STATEMENT                 00186000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00187000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00188000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00189000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00190000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00191000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00192000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00193000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00194000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00195000
         DC    4X'FF'                                                   00196000
*                                                                       00197000
*                                                                       00198000
**********************************************************************  00199000
* SQL STATEMENT SECTION:                                                00200000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00201000
*     TO SUPPORT THIS TABLE.                                            00202000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00203000
*     ARE EQUIVALENT.                                                   00204000
**********************************************************************  00205000
*                                                                       00206000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00207000
SQL#STMT AMODE ANY                                                      00208000
SQL#STMT RMODE ANY                                                      00209000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00210000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00211000
         USING COM#AREA,11             ADDRESS COMMAREA                 00212000
*                                                                       00213000
*                                                                       00214000
**********************************************************************  00215000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00216000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00217000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00218000
**********************************************************************  00219000
*                                                                       00220000
SQL#0000 DS    0H                                                       00221000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00222000
         B     *+6                     BRANCH AROUND ADCON              00223000
BASE0000 DC    AL2(4096)                                                00224000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00225000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00226000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00227000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00228000
         AH    3,BASE0000              ADD 4K                           00229000
         EXEC  SQL                                                     *00230000
               SELECT AUDIT_DATE,                                      *00231000
                   AUDIT_TIME,                                         *00232000
                   AUDIT_USER,                                         *00233000
                   AUDIT_ORG,                                          *00234000
                   SVC_INCEN_OPT,                                      *00235000
                   SVC_INCEN_QLFY,                                     *00236000
                   SVC_MODEL,                                          *00237000
                   DISC_AMT,                                           *00238000
                   DISC_PERCENT,                                       *00239000
                   RATE_INCEN_OPT,                                     *00240000
                   RATE_INCEN_QLFY,                                    *00241000
                   RATE_MODEL,                                         *00242000
                   RATE_TYPE,                                          *00243000
                   RATE_OPTION,                                        *00244000
                   RATE_PCT,                                           *00245000
                   PROCESS_OPTION,                                     *00246000
                   RATE_AMT_1,                                         *00247000
                   RATE_PCT_1,                                         *00248000
                   RATE_AMT_2,                                         *00249000
                   RATE_PCT_2,                                         *00250000
                   RATE_AMT_3,                                         *00251000
                   RATE_PCT_3,                                         *00252000
                   RATE_AMT_4,                                         *00253000
                   RATE_PCT_4,                                         *00254000
                   RATE_AMT_5,                                         *00255000
                   RATE_PCT_5,                                         *00256000
                   RATE_AMT_6,                                         *00257000
                   RATE_PCT_6,                                         *00258000
                   RATE_AMT_7,                                         *00259000
                   RATE_PCT_7,                                         *00260000
                   RATE_AMT_8,                                         *00261000
                   RATE_PCT_8,                                         *00262000
                   RATE_AMT_9,                                         *00263000
                   RATE_PCT_9,                                         *00264000
                   RATE_AMT_10,                                        *00265000
                   RATE_PCT_10,                                        *00266000
                   RATE_AMT_11,                                        *00267000
                   RATE_PCT_11,                                        *00268000
                   RATE_AMT_12,                                        *00269000
                   RATE_PCT_12,                                        *00270000
                   RATE_AMT_13,                                        *00271000
                   RATE_PCT_13,                                        *00272000
                   RATE_AMT_14,                                        *00273000
                   RATE_PCT_14,                                        *00274000
                   RATE_AMT_15,                                        *00275000
                   RATE_PCT_15,                                        *00276000
                   APPL_NBR,                                           *00277000
                   SEC_SVC_OPT,                                        *00278000
                   SEC_SVC_01,                                         *00279000
                   SEC_SVC_02,                                         *00280000
                   SEC_SVC_03,                                         *00281000
                   SEC_SVC_04,                                         *00282000
                   SEC_SVC_05,                                         *00283000
                   SEC_SVC_06,                                         *00284000
                   SEC_SVC_07,                                         *00285000
                   SEC_SVC_08,                                         *00286000
                   SEC_SVC_09,                                         *00287000
                   SEC_SVC_10,                                         *00288000
                   SEC_SVC_11,                                         *00289000
                   SEC_SVC_12,                                         *00290000
                   SEC_SVC_13,                                         *00291000
                   SEC_SVC_14,                                         *00292000
                   SEC_SVC_15,                                         *00293000
                   SEC_SVC_16,                                         *00294000
                   SEC_SVC_17,                                         *00295000
                   SEC_SVC_18,                                         *00296000
                   SEC_SVC_19,                                         *00297000
                   SEC_SVC_20,                                         *00298000
                   RSV_AMT,                                            *00299000
                   MISC_OPTION_1,                                      *00300000
                   MISC_OPTION_2,                                      *00301000
                   MISC_OPTION_3,                                      *00302000
                   RSV_FLAG,                                           *00303000
                   RSV_FLAG_1,                                         *00304000
                   RSV_FLAG_2,                                         *00305000
                   RSV_FLAG_3,                                         *00306000
                   RSV_AREA                                            *00307000
                 INTO :AUDDATE,                                        *00308000
                   :AUDTIME,                                           *00309000
                   :AUDUSER,                                           *00310000
                   :AUDORG,                                            *00311000
                   :SCINCENO,                                          *00312000
                   :INCENQ,                                            *00313000
                   :SCMODEL,                                           *00314000
                   :DISCAMT,                                           *00315000
                   :DISCPCT,                                           *00316000
                   :RINCENO,                                           *00317000
                   :RINCENQ,                                           *00318000
                   :RATMODL,                                           *00319000
                   :RATTYP,                                            *00320000
                   :RATOPT,                                            *00321000
                   :RATEPCT,                                           *00322000
                   :PROCOPT,                                           *00323000
                   :RTAMT1,                                            *00324000
                   :RTPCT1,                                            *00325000
                   :RTAMT2,                                            *00326000
                   :RTPCT2,                                            *00327000
                   :RTAMT3,                                            *00328000
                   :RTPCT3,                                            *00329000
                   :RTAMT4,                                            *00330000
                   :RTPCT4,                                            *00331000
                   :RTAMT5,                                            *00332000
                   :RTPCT5,                                            *00333000
                   :RTAMT6,                                            *00334000
                   :RTPCT6,                                            *00335000
                   :RTAMT7,                                            *00336000
                   :RTPCT7,                                            *00337000
                   :RTAMT8,                                            *00338000
                   :RTPCT8,                                            *00339000
                   :RTAMT9,                                            *00340000
                   :RTPCT9,                                            *00341000
                   :RTAMT10,                                           *00342000
                   :RTPCT10,                                           *00343000
                   :RTAMT11,                                           *00344000
                   :RTPCT11,                                           *00345000
                   :RTAMT12,                                           *00346000
                   :RTPCT12,                                           *00347000
                   :RTAMT13,                                           *00348000
                   :RTPCT13,                                           *00349000
                   :RTAMT14,                                           *00350000
                   :RTPCT14,                                           *00351000
                   :RTAMT15,                                           *00352000
                   :RTPCT15,                                           *00353000
                   :APPLNBR,                                           *00354000
                   :SVCIOPT,                                           *00355000
                   :SECSVC1,                                           *00356000
                   :SECSVC2,                                           *00357000
                   :SECSVC3,                                           *00358000
                   :SECSVC4,                                           *00359000
                   :SECSVC5,                                           *00360000
                   :SECSVC6,                                           *00361000
                   :SECSVC7,                                           *00362000
                   :SECSVC8,                                           *00363000
                   :SECSVC9,                                           *00364000
                   :SECSVC10,                                          *00365000
                   :SECSVC11,                                          *00366000
                   :SECSVC12,                                          *00367000
                   :SECSVC13,                                          *00368000
                   :SECSVC14,                                          *00369000
                   :SECSVC15,                                          *00370000
                   :SECSVC16,                                          *00371000
                   :SECSVC17,                                          *00372000
                   :SECSVC18,                                          *00373000
                   :SECSVC19,                                          *00374000
                   :SECSVC20,                                          *00375000
                   :RSVAMT,                                            *00376000
                   :MISCOPT1,                                          *00377000
                   :MISCOPT2,                                          *00378000
                   :MISCOPT3,                                          *00379000
                   :RSVFLG,                                            *00380000
                   :RSVFLG1,                                           *00381000
                   :RSVFLG2,                                           *00382000
                   :RSVFLG3,                                           *00383000
                   :RAREA                                              *00384000
                 FROM SAA                                              *00385000
                 WHERE INST_NBR = :INST AND                            *00386000
                   PROD_CODE = :PRDCDE AND                             *00387000
                   ACCT_NBR = :ACCTNBR                                 *00388000
                 FETCH FIRST 1 ROW ONLY                                 00389000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00390000
         BALR  4,5                     MOVE INTO RECORD AREA            00391000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00392000
         BR    14                      RETURN TO CALLER                 00393000
         LTORG                                                          00394000
*                                                                       00395000
*                                                                       00396000
**********************************************************************  00397000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00398000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00399000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00400000
**********************************************************************  00401000
*                                                                       00402000
SQL#0001 DS    0H                                                       00403000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00404000
         LA    15,255                  SET RETURN CODE                  00405000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00406000
         BR    14                      RETURN TO CALLER                 00407000
         LTORG                                                          00408000
*                                                                       00409000
*                                                                       00410000
**********************************************************************  00411000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00412000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00413000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00414000
**********************************************************************  00415000
*                                                                       00416000
SQL#0002 DS    0H                                                       00417000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00418000
         LA    15,255                  SET RETURN CODE                  00419000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00420000
         BR    14                      RETURN TO CALLER                 00421000
         LTORG                                                          00422000
*                                                                       00423000
*                                                                       00424000
**********************************************************************  00425000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00426000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00427000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00428000
**********************************************************************  00429000
*                                                                       00430000
SQL#0003 DS    0H                                                       00431000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00432000
         LA    15,255                  SET RETURN CODE                  00433000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00434000
         BR    14                      RETURN TO CALLER                 00435000
         LTORG                                                          00436000
*                                                                       00437000
*                                                                       00438000
**********************************************************************  00439000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00440000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00441000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00442000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00443000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00444000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00445000
*     UPDATE STATEMENT TO MATCH.                                        00446000
**********************************************************************  00447000
*                                                                       00448000
SQL#0004 DS    0H                                                       00449000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00450000
         B     *+6                     BRANCH AROUND ADCON              00451000
BASE0004 DC    AL2(4096)                                                00452000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00453000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00454000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00455000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00456000
         AH    3,BASE0004              ADD 4K                           00457000
         EXEC  SQL                                                     *00458000
               DECLARE SAAUPD0 CURSOR FOR                              *00459000
               SELECT AUDIT_DATE,                                      *00460000
                   AUDIT_TIME,                                         *00461000
                   AUDIT_USER,                                         *00462000
                   AUDIT_ORG,                                          *00463000
                   SVC_INCEN_OPT,                                      *00464000
                   SVC_INCEN_QLFY,                                     *00465000
                   SVC_MODEL,                                          *00466000
                   DISC_AMT,                                           *00467000
                   DISC_PERCENT,                                       *00468000
                   RATE_INCEN_OPT,                                     *00469000
                   RATE_INCEN_QLFY,                                    *00470000
                   RATE_MODEL,                                         *00471000
                   RATE_TYPE,                                          *00472000
                   RATE_OPTION,                                        *00473000
                   RATE_PCT,                                           *00474000
                   PROCESS_OPTION,                                     *00475000
                   RATE_AMT_1,                                         *00476000
                   RATE_PCT_1,                                         *00477000
                   RATE_AMT_2,                                         *00478000
                   RATE_PCT_2,                                         *00479000
                   RATE_AMT_3,                                         *00480000
                   RATE_PCT_3,                                         *00481000
                   RATE_AMT_4,                                         *00482000
                   RATE_PCT_4,                                         *00483000
                   RATE_AMT_5,                                         *00484000
                   RATE_PCT_5,                                         *00485000
                   RATE_AMT_6,                                         *00486000
                   RATE_PCT_6,                                         *00487000
                   RATE_AMT_7,                                         *00488000
                   RATE_PCT_7,                                         *00489000
                   RATE_AMT_8,                                         *00490000
                   RATE_PCT_8,                                         *00491000
                   RATE_AMT_9,                                         *00492000
                   RATE_PCT_9,                                         *00493000
                   RATE_AMT_10,                                        *00494000
                   RATE_PCT_10,                                        *00495000
                   RATE_AMT_11,                                        *00496000
                   RATE_PCT_11,                                        *00497000
                   RATE_AMT_12,                                        *00498000
                   RATE_PCT_12,                                        *00499000
                   RATE_AMT_13,                                        *00500000
                   RATE_PCT_13,                                        *00501000
                   RATE_AMT_14,                                        *00502000
                   RATE_PCT_14,                                        *00503000
                   RATE_AMT_15,                                        *00504000
                   RATE_PCT_15,                                        *00505000
                   APPL_NBR,                                           *00506000
                   SEC_SVC_OPT,                                        *00507000
                   SEC_SVC_01,                                         *00508000
                   SEC_SVC_02,                                         *00509000
                   SEC_SVC_03,                                         *00510000
                   SEC_SVC_04,                                         *00511000
                   SEC_SVC_05,                                         *00512000
                   SEC_SVC_06,                                         *00513000
                   SEC_SVC_07,                                         *00514000
                   SEC_SVC_08,                                         *00515000
                   SEC_SVC_09,                                         *00516000
                   SEC_SVC_10,                                         *00517000
                   SEC_SVC_11,                                         *00518000
                   SEC_SVC_12,                                         *00519000
                   SEC_SVC_13,                                         *00520000
                   SEC_SVC_14,                                         *00521000
                   SEC_SVC_15,                                         *00522000
                   SEC_SVC_16,                                         *00523000
                   SEC_SVC_17,                                         *00524000
                   SEC_SVC_18,                                         *00525000
                   SEC_SVC_19,                                         *00526000
                   SEC_SVC_20,                                         *00527000
                   RSV_AMT,                                            *00528000
                   MISC_OPTION_1,                                      *00529000
                   MISC_OPTION_2,                                      *00530000
                   MISC_OPTION_3,                                      *00531000
                   RSV_FLAG,                                           *00532000
                   RSV_FLAG_1,                                         *00533000
                   RSV_FLAG_2,                                         *00534000
                   RSV_FLAG_3,                                         *00535000
                   RSV_AREA                                            *00536000
                 FROM SAA                                              *00537000
                 WHERE INST_NBR = :INST AND                            *00538000
                   PROD_CODE = :PRDCDE AND                             *00539000
                   ACCT_NBR = :ACCTNBR                                 *00540000
                 FOR UPDATE OF AUDIT_DATE,                             *00541000
                   AUDIT_TIME,                                         *00542000
                   AUDIT_USER,                                         *00543000
                   AUDIT_ORG,                                          *00544000
                   SVC_INCEN_OPT,                                      *00545000
                   SVC_INCEN_QLFY,                                     *00546000
                   SVC_MODEL,                                          *00547000
                   DISC_AMT,                                           *00548000
                   DISC_PERCENT,                                       *00549000
                   RATE_INCEN_OPT,                                     *00550000
                   RATE_INCEN_QLFY,                                    *00551000
                   RATE_MODEL,                                         *00552000
                   RATE_TYPE,                                          *00553000
                   RATE_OPTION,                                        *00554000
                   RATE_PCT,                                           *00555000
                   PROCESS_OPTION,                                     *00556000
                   RATE_AMT_1,                                         *00557000
                   RATE_PCT_1,                                         *00558000
                   RATE_AMT_2,                                         *00559000
                   RATE_PCT_2,                                         *00560000
                   RATE_AMT_3,                                         *00561000
                   RATE_PCT_3,                                         *00562000
                   RATE_AMT_4,                                         *00563000
                   RATE_PCT_4,                                         *00564000
                   RATE_AMT_5,                                         *00565000
                   RATE_PCT_5,                                         *00566000
                   RATE_AMT_6,                                         *00567000
                   RATE_PCT_6,                                         *00568000
                   RATE_AMT_7,                                         *00569000
                   RATE_PCT_7,                                         *00570000
                   RATE_AMT_8,                                         *00571000
                   RATE_PCT_8,                                         *00572000
                   RATE_AMT_9,                                         *00573000
                   RATE_PCT_9,                                         *00574000
                   RATE_AMT_10,                                        *00575000
                   RATE_PCT_10,                                        *00576000
                   RATE_AMT_11,                                        *00577000
                   RATE_PCT_11,                                        *00578000
                   RATE_AMT_12,                                        *00579000
                   RATE_PCT_12,                                        *00580000
                   RATE_AMT_13,                                        *00581000
                   RATE_PCT_13,                                        *00582000
                   RATE_AMT_14,                                        *00583000
                   RATE_PCT_14,                                        *00584000
                   RATE_AMT_15,                                        *00585000
                   RATE_PCT_15,                                        *00586000
                   APPL_NBR,                                           *00587000
                   SEC_SVC_OPT,                                        *00588000
                   SEC_SVC_01,                                         *00589000
                   SEC_SVC_02,                                         *00590000
                   SEC_SVC_03,                                         *00591000
                   SEC_SVC_04,                                         *00592000
                   SEC_SVC_05,                                         *00593000
                   SEC_SVC_06,                                         *00594000
                   SEC_SVC_07,                                         *00595000
                   SEC_SVC_08,                                         *00596000
                   SEC_SVC_09,                                         *00597000
                   SEC_SVC_10,                                         *00598000
                   SEC_SVC_11,                                         *00599000
                   SEC_SVC_12,                                         *00600000
                   SEC_SVC_13,                                         *00601000
                   SEC_SVC_14,                                         *00602000
                   SEC_SVC_15,                                         *00603000
                   SEC_SVC_16,                                         *00604000
                   SEC_SVC_17,                                         *00605000
                   SEC_SVC_18,                                         *00606000
                   SEC_SVC_19,                                         *00607000
                   SEC_SVC_20,                                         *00608000
                   RSV_AMT,                                            *00609000
                   MISC_OPTION_1,                                      *00610000
                   MISC_OPTION_2,                                      *00611000
                   MISC_OPTION_3,                                      *00612000
                   RSV_FLAG,                                           *00613000
                   RSV_FLAG_1,                                         *00614000
                   RSV_FLAG_2,                                         *00615000
                   RSV_FLAG_3,                                         *00616000
                   RSV_AREA                                            *00617000
                 FETCH FIRST 1 ROW ONLY                                 00618000
         EXEC  SQL                                                     *00619000
               OPEN SAAUPD0                                             00620000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00621000
         BR    14                      RETURN TO CALLER                 00622000
         LTORG                                                          00623000
*                                                                       00624000
*                                                                       00625000
**********************************************************************  00626000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00627000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00628000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00629000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00630000
*     UPDATE STATEMENT TO MATCH.                                        00631000
**********************************************************************  00632000
*                                                                       00633000
SQL#0005 DS    0H                                                       00634000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00635000
         LA    15,255                  SET RETURN CODE                  00636000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00637000
         BR    14                      RETURN TO CALLER                 00638000
         LTORG                                                          00639000
*                                                                       00640000
*                                                                       00641000
**********************************************************************  00642000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00643000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00644000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00645000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00646000
*     UPDATE STATEMENT TO MATCH.                                        00647000
**********************************************************************  00648000
*                                                                       00649000
SQL#0006 DS    0H                                                       00650000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00651000
         LA    15,255                  SET RETURN CODE                  00652000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00653000
         BR    14                      RETURN TO CALLER                 00654000
         LTORG                                                          00655000
*                                                                       00656000
*                                                                       00657000
**********************************************************************  00658000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00659000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00660000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00661000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00662000
*     UPDATE STATEMENT TO MATCH.                                        00663000
**********************************************************************  00664000
*                                                                       00665000
SQL#0007 DS    0H                                                       00666000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00667000
         LA    15,255                  SET RETURN CODE                  00668000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00669000
         BR    14                      RETURN TO CALLER                 00670000
         LTORG                                                          00671000
*                                                                       00672000
*                                                                       00673000
**********************************************************************  00674000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00675000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00676000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00677000
*     THE ACTUAL ROW.                                                   00678000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00679000
**********************************************************************  00680000
*                                                                       00681000
SQL#0008 DS    0H                                                       00682000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00683000
         B     *+6                     BRANCH AROUND ADCON              00684000
BASE0008 DC    AL2(4096)                                                00685000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00686000
         AH    3,BASE0008              ADD 4K                           00687000
         EXEC  SQL                                                     *00688000
               FETCH SAAUPD0                                           *00689000
                 INTO :AUDDATE,                                        *00690000
                   :AUDTIME,                                           *00691000
                   :AUDUSER,                                           *00692000
                   :AUDORG,                                            *00693000
                   :SCINCENO,                                          *00694000
                   :INCENQ,                                            *00695000
                   :SCMODEL,                                           *00696000
                   :DISCAMT,                                           *00697000
                   :DISCPCT,                                           *00698000
                   :RINCENO,                                           *00699000
                   :RINCENQ,                                           *00700000
                   :RATMODL,                                           *00701000
                   :RATTYP,                                            *00702000
                   :RATOPT,                                            *00703000
                   :RATEPCT,                                           *00704000
                   :PROCOPT,                                           *00705000
                   :RTAMT1,                                            *00706000
                   :RTPCT1,                                            *00707000
                   :RTAMT2,                                            *00708000
                   :RTPCT2,                                            *00709000
                   :RTAMT3,                                            *00710000
                   :RTPCT3,                                            *00711000
                   :RTAMT4,                                            *00712000
                   :RTPCT4,                                            *00713000
                   :RTAMT5,                                            *00714000
                   :RTPCT5,                                            *00715000
                   :RTAMT6,                                            *00716000
                   :RTPCT6,                                            *00717000
                   :RTAMT7,                                            *00718000
                   :RTPCT7,                                            *00719000
                   :RTAMT8,                                            *00720000
                   :RTPCT8,                                            *00721000
                   :RTAMT9,                                            *00722000
                   :RTPCT9,                                            *00723000
                   :RTAMT10,                                           *00724000
                   :RTPCT10,                                           *00725000
                   :RTAMT11,                                           *00726000
                   :RTPCT11,                                           *00727000
                   :RTAMT12,                                           *00728000
                   :RTPCT12,                                           *00729000
                   :RTAMT13,                                           *00730000
                   :RTPCT13,                                           *00731000
                   :RTAMT14,                                           *00732000
                   :RTPCT14,                                           *00733000
                   :RTAMT15,                                           *00734000
                   :RTPCT15,                                           *00735000
                   :APPLNBR,                                           *00736000
                   :SVCIOPT,                                           *00737000
                   :SECSVC1,                                           *00738000
                   :SECSVC2,                                           *00739000
                   :SECSVC3,                                           *00740000
                   :SECSVC4,                                           *00741000
                   :SECSVC5,                                           *00742000
                   :SECSVC6,                                           *00743000
                   :SECSVC7,                                           *00744000
                   :SECSVC8,                                           *00745000
                   :SECSVC9,                                           *00746000
                   :SECSVC10,                                          *00747000
                   :SECSVC11,                                          *00748000
                   :SECSVC12,                                          *00749000
                   :SECSVC13,                                          *00750000
                   :SECSVC14,                                          *00751000
                   :SECSVC15,                                          *00752000
                   :SECSVC16,                                          *00753000
                   :SECSVC17,                                          *00754000
                   :SECSVC18,                                          *00755000
                   :SECSVC19,                                          *00756000
                   :SECSVC20,                                          *00757000
                   :RSVAMT,                                            *00758000
                   :MISCOPT1,                                          *00759000
                   :MISCOPT2,                                          *00760000
                   :MISCOPT3,                                          *00761000
                   :RSVFLG,                                            *00762000
                   :RSVFLG1,                                           *00763000
                   :RSVFLG2,                                           *00764000
                   :RSVFLG3,                                           *00765000
                   :RAREA                                               00766000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00767000
         BALR  4,5                     MOVE INTO RECORD AREA            00768000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00769000
         BR    14                      RETURN TO CALLER                 00770000
         LTORG                                                          00771000
*                                                                       00772000
*                                                                       00773000
**********************************************************************  00774000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00775000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00776000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00777000
*     THE ACTUAL ROW.                                                   00778000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00779000
**********************************************************************  00780000
*                                                                       00781000
SQL#0009 DS    0H                                                       00782000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00783000
         LA    15,255                  SET RETURN CODE                  00784000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00785000
         BR    14                      RETURN TO CALLER                 00786000
         LTORG                                                          00787000
*                                                                       00788000
*                                                                       00789000
**********************************************************************  00790000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00791000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00792000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00793000
*     THE ACTUAL ROW.                                                   00794000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00795000
**********************************************************************  00796000
*                                                                       00797000
SQL#0010 DS    0H                                                       00798000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00799000
         LA    15,255                  SET RETURN CODE                  00800000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00801000
         BR    14                      RETURN TO CALLER                 00802000
         LTORG                                                          00803000
*                                                                       00804000
*                                                                       00805000
**********************************************************************  00806000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00807000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00808000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00809000
*     THE ACTUAL ROW.                                                   00810000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00811000
**********************************************************************  00812000
*                                                                       00813000
SQL#0011 DS    0H                                                       00814000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00815000
         LA    15,255                  SET RETURN CODE                  00816000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00817000
         BR    14                      RETURN TO CALLER                 00818000
         LTORG                                                          00819000
*                                                                       00820000
*                                                                       00821000
**********************************************************************  00822000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00823000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00824000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00825000
*     TO CLOSE THE UPDATE CURSOR.                                       00826000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00827000
**********************************************************************  00828000
*                                                                       00829000
SQL#0012 DS    0H                                                       00830000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00831000
         B     *+6                     BRANCH AROUND ADCON              00832000
BASE0012 DC    AL2(4096)                                                00833000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00834000
         AH    3,BASE0012              ADD 4K                           00835000
         EXEC  SQL                                                     *00836000
               CLOSE SAAUPD0                                            00837000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00838000
         BR    14                      RETURN TO CALLER                 00839000
         LTORG                                                          00840000
*                                                                       00841000
*                                                                       00842000
**********************************************************************  00843000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00844000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00845000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00846000
*     TO CLOSE THE UPDATE CURSOR.                                       00847000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00848000
**********************************************************************  00849000
*                                                                       00850000
SQL#0013 DS    0H                                                       00851000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00852000
         LA    15,255                  SET RETURN CODE                  00853000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00854000
         BR    14                      RETURN TO CALLER                 00855000
         LTORG                                                          00856000
*                                                                       00857000
*                                                                       00858000
**********************************************************************  00859000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00860000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00861000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00862000
*     TO CLOSE THE UPDATE CURSOR.                                       00863000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00864000
**********************************************************************  00865000
*                                                                       00866000
SQL#0014 DS    0H                                                       00867000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00868000
         LA    15,255                  SET RETURN CODE                  00869000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00870000
         BR    14                      RETURN TO CALLER                 00871000
         LTORG                                                          00872000
*                                                                       00873000
*                                                                       00874000
**********************************************************************  00875000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00876000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00877000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00878000
*     TO CLOSE THE UPDATE CURSOR.                                       00879000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00880000
**********************************************************************  00881000
*                                                                       00882000
SQL#0015 DS    0H                                                       00883000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00884000
         LA    15,255                  SET RETURN CODE                  00885000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00886000
         BR    14                      RETURN TO CALLER                 00887000
         LTORG                                                          00888000
*                                                                       00889000
*                                                                       00890000
**********************************************************************  00891000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00892000
* KEY:                                                                  00893000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00894000
*     AND GET-NEXT-LOCK VERBS.                                          00895000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00896000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00897000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00898000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00899000
*     ORDER BY CLAUSE.                                                  00900000
**********************************************************************  00901000
*                                                                       00902000
SQL#0016 DS    0H                                                       00903000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00904000
         B     *+6                     BRANCH AROUND ADCON              00905000
BASE0016 DC    AL2(4096)                                                00906000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00907000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00908000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00909000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00910000
         AH    3,BASE0016              ADD 4K                           00911000
         EXEC  SQL                                                     *00912000
               DECLARE SAASQ001 CURSOR FOR                             *00913000
               SELECT INST_NBR,                                        *00914000
                   PROD_CODE,                                          *00915000
                   ACCT_NBR,                                           *00916000
                   AUDIT_DATE,                                         *00917000
                   AUDIT_TIME,                                         *00918000
                   AUDIT_USER,                                         *00919000
                   AUDIT_ORG,                                          *00920000
                   SVC_INCEN_OPT,                                      *00921000
                   SVC_INCEN_QLFY,                                     *00922000
                   SVC_MODEL,                                          *00923000
                   DISC_AMT,                                           *00924000
                   DISC_PERCENT,                                       *00925000
                   RATE_INCEN_OPT,                                     *00926000
                   RATE_INCEN_QLFY,                                    *00927000
                   RATE_MODEL,                                         *00928000
                   RATE_TYPE,                                          *00929000
                   RATE_OPTION,                                        *00930000
                   RATE_PCT,                                           *00931000
                   PROCESS_OPTION,                                     *00932000
                   RATE_AMT_1,                                         *00933000
                   RATE_PCT_1,                                         *00934000
                   RATE_AMT_2,                                         *00935000
                   RATE_PCT_2,                                         *00936000
                   RATE_AMT_3,                                         *00937000
                   RATE_PCT_3,                                         *00938000
                   RATE_AMT_4,                                         *00939000
                   RATE_PCT_4,                                         *00940000
                   RATE_AMT_5,                                         *00941000
                   RATE_PCT_5,                                         *00942000
                   RATE_AMT_6,                                         *00943000
                   RATE_PCT_6,                                         *00944000
                   RATE_AMT_7,                                         *00945000
                   RATE_PCT_7,                                         *00946000
                   RATE_AMT_8,                                         *00947000
                   RATE_PCT_8,                                         *00948000
                   RATE_AMT_9,                                         *00949000
                   RATE_PCT_9,                                         *00950000
                   RATE_AMT_10,                                        *00951000
                   RATE_PCT_10,                                        *00952000
                   RATE_AMT_11,                                        *00953000
                   RATE_PCT_11,                                        *00954000
                   RATE_AMT_12,                                        *00955000
                   RATE_PCT_12,                                        *00956000
                   RATE_AMT_13,                                        *00957000
                   RATE_PCT_13,                                        *00958000
                   RATE_AMT_14,                                        *00959000
                   RATE_PCT_14,                                        *00960000
                   RATE_AMT_15,                                        *00961000
                   RATE_PCT_15,                                        *00962000
                   APPL_NBR,                                           *00963000
                   SEC_SVC_OPT,                                        *00964000
                   SEC_SVC_01,                                         *00965000
                   SEC_SVC_02,                                         *00966000
                   SEC_SVC_03,                                         *00967000
                   SEC_SVC_04,                                         *00968000
                   SEC_SVC_05,                                         *00969000
                   SEC_SVC_06,                                         *00970000
                   SEC_SVC_07,                                         *00971000
                   SEC_SVC_08,                                         *00972000
                   SEC_SVC_09,                                         *00973000
                   SEC_SVC_10,                                         *00974000
                   SEC_SVC_11,                                         *00975000
                   SEC_SVC_12,                                         *00976000
                   SEC_SVC_13,                                         *00977000
                   SEC_SVC_14,                                         *00978000
                   SEC_SVC_15,                                         *00979000
                   SEC_SVC_16,                                         *00980000
                   SEC_SVC_17,                                         *00981000
                   SEC_SVC_18,                                         *00982000
                   SEC_SVC_19,                                         *00983000
                   SEC_SVC_20,                                         *00984000
                   RSV_AMT,                                            *00985000
                   MISC_OPTION_1,                                      *00986000
                   MISC_OPTION_2,                                      *00987000
                   MISC_OPTION_3,                                      *00988000
                   RSV_FLAG,                                           *00989000
                   RSV_FLAG_1,                                         *00990000
                   RSV_FLAG_2,                                         *00991000
                   RSV_FLAG_3,                                         *00992000
                   RSV_AREA                                            *00993000
                 FROM SAA                                              *00994000
                 WHERE                                                 *00995000
                    INST_NBR = :INST AND                               *00996000
                    PROD_CODE = :PRDCDE AND                            *00997000
                    ACCT_NBR >= :ACCTNBR                               *00998000
                 ORDER BY ACCT_NBR                                     *00999000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01000000
         EXEC  SQL                                                     *01001000
               OPEN SAASQ001                                            01002000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01003000
         BR    14                      RETURN TO CALLER                 01004000
         LTORG                                                          01005000
*                                                                       01006000
*                                                                       01007000
**********************************************************************  01008000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  01009000
* KEY 1:                                                                01010000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         01011000
*     AND GET-NEXT-LOCK VERBS.                                          01012000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              01013000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                01014000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      01015000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     01016000
*     ORDER BY CLAUSE.                                                  01017000
**********************************************************************  01018000
*                                                                       01019000
SQL#0017 DS    0H                                                       01020000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          01021000
         LA    15,255                  SET RETURN CODE                  01022000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01023000
         BR    14                      RETURN TO CALLER                 01024000
         LTORG                                                          01025000
*                                                                       01026000
*                                                                       01027000
**********************************************************************  01028000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  01029000
* KEY 2:                                                                01030000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         01031000
*     AND GET-NEXT-LOCK VERBS.                                          01032000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              01033000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                01034000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      01035000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     01036000
*     ORDER BY CLAUSE.                                                  01037000
**********************************************************************  01038000
*                                                                       01039000
SQL#0018 DS    0H                                                       01040000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          01041000
         LA    15,255                  SET RETURN CODE                  01042000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01043000
         BR    14                      RETURN TO CALLER                 01044000
         LTORG                                                          01045000
*                                                                       01046000
*                                                                       01047000
**********************************************************************  01048000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  01049000
* KEY 3:                                                                01050000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         01051000
*     AND GET-NEXT-LOCK VERBS.                                          01052000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              01053000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                01054000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      01055000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     01056000
*     ORDER BY CLAUSE.                                                  01057000
**********************************************************************  01058000
*                                                                       01059000
SQL#0019 DS    0H                                                       01060000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          01061000
         LA    15,255                  SET RETURN CODE                  01062000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01063000
         BR    14                      RETURN TO CALLER                 01064000
         LTORG                                                          01065000
*                                                                       01066000
*                                                                       01067000
**********************************************************************  01068000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               01069000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01070000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01071000
*     RETRIEVE THE ACTUAL ROW.                                          01072000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01073000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01074000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01075000
**********************************************************************  01076000
*                                                                       01077000
SQL#0020 DS    0H                                                       01078000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          01079000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01080000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    01081000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01082000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01083000
VECT0020 DC    A(SQL#0120)                                              01084000
         DC    A(SQL#0220)                                              01085000
         DC    A(SQL#0320)                                              01086000
         LTORG                                                          01087000
*                                                                       01088000
SQL#0120 DS    0H                                                       01089000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          01090000
         B     *+6                     BRANCH AROUND ADCON              01091000
BASE0120 DC    AL2(4096)                                                01092000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01093000
         AH    3,BASE0120              ADD 4K                           01094000
         EXEC  SQL                                                     *01095000
               FETCH SAASQ001                                          *01096000
                 INTO :INST,                                           *01097000
                      :PRDCDE,                                         *01098000
                      :ACCTNBR,                                        *01099000
                      :AUDDATE,                                        *01100000
                      :AUDTIME,                                        *01101000
                      :AUDUSER,                                        *01102000
                      :AUDORG,                                         *01103000
                      :SCINCENO,                                       *01104000
                      :INCENQ,                                         *01105000
                      :SCMODEL,                                        *01106000
                      :DISCAMT,                                        *01107000
                      :DISCPCT,                                        *01108000
                      :RINCENO,                                        *01109000
                      :RINCENQ,                                        *01110000
                      :RATMODL,                                        *01111000
                      :RATTYP,                                         *01112000
                      :RATOPT,                                         *01113000
                      :RATEPCT,                                        *01114000
                      :PROCOPT,                                        *01115000
                      :RTAMT1,                                         *01116000
                      :RTPCT1,                                         *01117000
                      :RTAMT2,                                         *01118000
                      :RTPCT2,                                         *01119000
                      :RTAMT3,                                         *01120000
                      :RTPCT3,                                         *01121000
                      :RTAMT4,                                         *01122000
                      :RTPCT4,                                         *01123000
                      :RTAMT5,                                         *01124000
                      :RTPCT5,                                         *01125000
                      :RTAMT6,                                         *01126000
                      :RTPCT6,                                         *01127000
                      :RTAMT7,                                         *01128000
                      :RTPCT7,                                         *01129000
                      :RTAMT8,                                         *01130000
                      :RTPCT8,                                         *01131000
                      :RTAMT9,                                         *01132000
                      :RTPCT9,                                         *01133000
                      :RTAMT10,                                        *01134000
                      :RTPCT10,                                        *01135000
                      :RTAMT11,                                        *01136000
                      :RTPCT11,                                        *01137000
                      :RTAMT12,                                        *01138000
                      :RTPCT12,                                        *01139000
                      :RTAMT13,                                        *01140000
                      :RTPCT13,                                        *01141000
                      :RTAMT14,                                        *01142000
                      :RTPCT14,                                        *01143000
                      :RTAMT15,                                        *01144000
                      :RTPCT15,                                        *01145000
                      :APPLNBR,                                        *01146000
                      :SVCIOPT,                                        *01147000
                      :SECSVC1,                                        *01148000
                      :SECSVC2,                                        *01149000
                      :SECSVC3,                                        *01150000
                      :SECSVC4,                                        *01151000
                      :SECSVC5,                                        *01152000
                      :SECSVC6,                                        *01153000
                      :SECSVC7,                                        *01154000
                      :SECSVC8,                                        *01155000
                      :SECSVC9,                                        *01156000
                      :SECSVC10,                                       *01157000
                      :SECSVC11,                                       *01158000
                      :SECSVC12,                                       *01159000
                      :SECSVC13,                                       *01160000
                      :SECSVC14,                                       *01161000
                      :SECSVC15,                                       *01162000
                      :SECSVC16,                                       *01163000
                      :SECSVC17,                                       *01164000
                      :SECSVC18,                                       *01165000
                      :SECSVC19,                                       *01166000
                      :SECSVC20,                                       *01167000
                      :RSVAMT,                                         *01168000
                      :MISCOPT1,                                       *01169000
                      :MISCOPT2,                                       *01170000
                      :MISCOPT3,                                       *01171000
                      :RSVFLG,                                         *01172000
                      :RSVFLG1,                                        *01173000
                      :RSVFLG2,                                        *01174000
                      :RSVFLG3,                                        *01175000
                      :RAREA                                            01176000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01177000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01178000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01179000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01180000
         BR    12                      OPEN NEXT CURSOR                 01181000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01182000
         BALR  4,5                     MOVE INTO RECORD AREA            01183000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01184000
         BR    14                      RETURN TO CALLER                 01185000
         LTORG                                                          01186000
*                                                                       01187000
SQL#0220 DS    0H                                                       01188000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          01189000
         B     *+6                     BRANCH AROUND ADCON              01190000
BASE0220 DC    AL2(4096)                                                01191000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01192000
         AH    3,BASE0220              ADD 4K                           01193000
         EXEC  SQL                                                     *01194000
               FETCH SAASQ002                                          *01195000
                 INTO :INST,                                           *01196000
                      :PRDCDE,                                         *01197000
                      :ACCTNBR,                                        *01198000
                      :AUDDATE,                                        *01199000
                      :AUDTIME,                                        *01200000
                      :AUDUSER,                                        *01201000
                      :AUDORG,                                         *01202000
                      :SCINCENO,                                       *01203000
                      :INCENQ,                                         *01204000
                      :SCMODEL,                                        *01205000
                      :DISCAMT,                                        *01206000
                      :DISCPCT,                                        *01207000
                      :RINCENO,                                        *01208000
                      :RINCENQ,                                        *01209000
                      :RATMODL,                                        *01210000
                      :RATTYP,                                         *01211000
                      :RATOPT,                                         *01212000
                      :RATEPCT,                                        *01213000
                      :PROCOPT,                                        *01214000
                      :RTAMT1,                                         *01215000
                      :RTPCT1,                                         *01216000
                      :RTAMT2,                                         *01217000
                      :RTPCT2,                                         *01218000
                      :RTAMT3,                                         *01219000
                      :RTPCT3,                                         *01220000
                      :RTAMT4,                                         *01221000
                      :RTPCT4,                                         *01222000
                      :RTAMT5,                                         *01223000
                      :RTPCT5,                                         *01224000
                      :RTAMT6,                                         *01225000
                      :RTPCT6,                                         *01226000
                      :RTAMT7,                                         *01227000
                      :RTPCT7,                                         *01228000
                      :RTAMT8,                                         *01229000
                      :RTPCT8,                                         *01230000
                      :RTAMT9,                                         *01231000
                      :RTPCT9,                                         *01232000
                      :RTAMT10,                                        *01233000
                      :RTPCT10,                                        *01234000
                      :RTAMT11,                                        *01235000
                      :RTPCT11,                                        *01236000
                      :RTAMT12,                                        *01237000
                      :RTPCT12,                                        *01238000
                      :RTAMT13,                                        *01239000
                      :RTPCT13,                                        *01240000
                      :RTAMT14,                                        *01241000
                      :RTPCT14,                                        *01242000
                      :RTAMT15,                                        *01243000
                      :RTPCT15,                                        *01244000
                      :APPLNBR,                                        *01245000
                      :SVCIOPT,                                        *01246000
                      :SECSVC1,                                        *01247000
                      :SECSVC2,                                        *01248000
                      :SECSVC3,                                        *01249000
                      :SECSVC4,                                        *01250000
                      :SECSVC5,                                        *01251000
                      :SECSVC6,                                        *01252000
                      :SECSVC7,                                        *01253000
                      :SECSVC8,                                        *01254000
                      :SECSVC9,                                        *01255000
                      :SECSVC10,                                       *01256000
                      :SECSVC11,                                       *01257000
                      :SECSVC12,                                       *01258000
                      :SECSVC13,                                       *01259000
                      :SECSVC14,                                       *01260000
                      :SECSVC15,                                       *01261000
                      :SECSVC16,                                       *01262000
                      :SECSVC17,                                       *01263000
                      :SECSVC18,                                       *01264000
                      :SECSVC19,                                       *01265000
                      :SECSVC20,                                       *01266000
                      :RSVAMT,                                         *01267000
                      :MISCOPT1,                                       *01268000
                      :MISCOPT2,                                       *01269000
                      :MISCOPT3,                                       *01270000
                      :RSVFLG,                                         *01271000
                      :RSVFLG1,                                        *01272000
                      :RSVFLG2,                                        *01273000
                      :RSVFLG3,                                        *01274000
                      :RAREA                                            01275000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01276000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01277000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01278000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01279000
         BR    12                      OPEN NEXT CURSOR                 01280000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01281000
         BALR  4,5                     MOVE INTO RECORD AREA            01282000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01283000
         BR    14                      RETURN TO CALLER                 01284000
         LTORG                                                          01285000
*                                                                       01286000
SQL#0320 DS    0H                                                       01287000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          01288000
         B     *+6                     BRANCH AROUND ADCON              01289000
BASE0320 DC    AL2(4096)                                                01290000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01291000
         AH    3,BASE0320              ADD 4K                           01292000
         EXEC  SQL                                                     *01293000
               FETCH SAASQ003                                          *01294000
                 INTO :INST,                                           *01295000
                      :PRDCDE,                                         *01296000
                      :ACCTNBR,                                        *01297000
                      :AUDDATE,                                        *01298000
                      :AUDTIME,                                        *01299000
                      :AUDUSER,                                        *01300000
                      :AUDORG,                                         *01301000
                      :SCINCENO,                                       *01302000
                      :INCENQ,                                         *01303000
                      :SCMODEL,                                        *01304000
                      :DISCAMT,                                        *01305000
                      :DISCPCT,                                        *01306000
                      :RINCENO,                                        *01307000
                      :RINCENQ,                                        *01308000
                      :RATMODL,                                        *01309000
                      :RATTYP,                                         *01310000
                      :RATOPT,                                         *01311000
                      :RATEPCT,                                        *01312000
                      :PROCOPT,                                        *01313000
                      :RTAMT1,                                         *01314000
                      :RTPCT1,                                         *01315000
                      :RTAMT2,                                         *01316000
                      :RTPCT2,                                         *01317000
                      :RTAMT3,                                         *01318000
                      :RTPCT3,                                         *01319000
                      :RTAMT4,                                         *01320000
                      :RTPCT4,                                         *01321000
                      :RTAMT5,                                         *01322000
                      :RTPCT5,                                         *01323000
                      :RTAMT6,                                         *01324000
                      :RTPCT6,                                         *01325000
                      :RTAMT7,                                         *01326000
                      :RTPCT7,                                         *01327000
                      :RTAMT8,                                         *01328000
                      :RTPCT8,                                         *01329000
                      :RTAMT9,                                         *01330000
                      :RTPCT9,                                         *01331000
                      :RTAMT10,                                        *01332000
                      :RTPCT10,                                        *01333000
                      :RTAMT11,                                        *01334000
                      :RTPCT11,                                        *01335000
                      :RTAMT12,                                        *01336000
                      :RTPCT12,                                        *01337000
                      :RTAMT13,                                        *01338000
                      :RTPCT13,                                        *01339000
                      :RTAMT14,                                        *01340000
                      :RTPCT14,                                        *01341000
                      :RTAMT15,                                        *01342000
                      :RTPCT15,                                        *01343000
                      :APPLNBR,                                        *01344000
                      :SVCIOPT,                                        *01345000
                      :SECSVC1,                                        *01346000
                      :SECSVC2,                                        *01347000
                      :SECSVC3,                                        *01348000
                      :SECSVC4,                                        *01349000
                      :SECSVC5,                                        *01350000
                      :SECSVC6,                                        *01351000
                      :SECSVC7,                                        *01352000
                      :SECSVC8,                                        *01353000
                      :SECSVC9,                                        *01354000
                      :SECSVC10,                                       *01355000
                      :SECSVC11,                                       *01356000
                      :SECSVC12,                                       *01357000
                      :SECSVC13,                                       *01358000
                      :SECSVC14,                                       *01359000
                      :SECSVC15,                                       *01360000
                      :SECSVC16,                                       *01361000
                      :SECSVC17,                                       *01362000
                      :SECSVC18,                                       *01363000
                      :SECSVC19,                                       *01364000
                      :SECSVC20,                                       *01365000
                      :RSVAMT,                                         *01366000
                      :MISCOPT1,                                       *01367000
                      :MISCOPT2,                                       *01368000
                      :MISCOPT3,                                       *01369000
                      :RSVFLG,                                         *01370000
                      :RSVFLG1,                                        *01371000
                      :RSVFLG2,                                        *01372000
                      :RSVFLG3,                                        *01373000
                      :RAREA                                            01374000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01375000
         BALR  4,5                     MOVE INTO RECORD AREA            01376000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01377000
         BR    14                      RETURN TO CALLER                 01378000
         LTORG                                                          01379000
*                                                                       01380000
*                                                                       01381000
**********************************************************************  01382000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01383000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01384000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01385000
*     RETRIEVE THE ACTUAL ROW.                                          01386000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01387000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01388000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01389000
**********************************************************************  01390000
*                                                                       01391000
SQL#0021 DS    0H                                                       01392000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01393000
         LA    15,255                  SET RETURN CODE                  01394000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01395000
         BR    14                      RETURN TO CALLER                 01396000
         LTORG                                                          01397000
*                                                                       01398000
*                                                                       01399000
**********************************************************************  01400000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01401000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01402000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01403000
*     RETRIEVE THE ACTUAL ROW.                                          01404000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01405000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01406000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01407000
**********************************************************************  01408000
*                                                                       01409000
SQL#0022 DS    0H                                                       01410000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01411000
         LA    15,255                  SET RETURN CODE                  01412000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01413000
         BR    14                      RETURN TO CALLER                 01414000
         LTORG                                                          01415000
*                                                                       01416000
*                                                                       01417000
**********************************************************************  01418000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01419000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01420000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01421000
*     RETRIEVE THE ACTUAL ROW.                                          01422000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01423000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01424000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01425000
**********************************************************************  01426000
*                                                                       01427000
SQL#0023 DS    0H                                                       01428000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01429000
         LA    15,255                  SET RETURN CODE                  01430000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01431000
         BR    14                      RETURN TO CALLER                 01432000
         LTORG                                                          01433000
*                                                                       01434000
*                                                                       01435000
**********************************************************************  01436000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01437000
* THE PRIMARY KEY:                                                      01438000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01439000
*     VERBS.                                                            01440000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01441000
*     RETRIEVE THE ACTUAL ROW.                                          01442000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01443000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01444000
*     WILL BE THRU THE UPDATE CURSOR.                                   01445000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01446000
**********************************************************************  01447000
*                                                                       01448000
SQL#0024 DS    0H                                                       01449000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01450000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01451000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01452000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01453000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01454000
VECT0024 DC    A(SQL#0124)                                              01455000
         DC    A(SQL#0224)                                              01456000
         DC    A(SQL#0324)                                              01457000
         LTORG                                                          01458000
*                                                                       01459000
SQL#0124 DS    0H                                                       01460000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01461000
         B     *+6                     BRANCH AROUND ADCON              01462000
BASE0124 DC    AL2(4096)                                                01463000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01464000
         AH    3,BASE0124              ADD 4K                           01465000
         EXEC  SQL                                                     *01466000
               FETCH SAASQ001                                          *01467000
                 INTO :INST,                                           *01468000
                      :PRDCDE,                                         *01469000
                      :ACCTNBR                                          01470000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01471000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01472000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01473000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01474000
         BR    12                      OPEN NEXT CURSOR                 01475000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01476000
         BALR  4,5                     MOVE INTO RECORD AREA            01477000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01478000
         BR    14                      RETURN TO CALLER                 01479000
         LTORG                                                          01480000
*                                                                       01481000
SQL#0224 DS    0H                                                       01482000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01483000
         B     *+6                     BRANCH AROUND ADCON              01484000
BASE0224 DC    AL2(4096)                                                01485000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01486000
         AH    3,BASE0224              ADD 4K                           01487000
         EXEC  SQL                                                     *01488000
               FETCH SAASQ002                                          *01489000
                 INTO :INST,                                           *01490000
                      :PRDCDE,                                         *01491000
                      :ACCTNBR                                          01492000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01493000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01494000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01495000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01496000
         BR    12                      OPEN NEXT CURSOR                 01497000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01498000
         BALR  4,5                     MOVE INTO RECORD AREA            01499000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01500000
         BR    14                      RETURN TO CALLER                 01501000
         LTORG                                                          01502000
*                                                                       01503000
SQL#0324 DS    0H                                                       01504000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01505000
         B     *+6                     BRANCH AROUND ADCON              01506000
BASE0324 DC    AL2(4096)                                                01507000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01508000
         AH    3,BASE0324              ADD 4K                           01509000
         EXEC  SQL                                                     *01510000
               FETCH SAASQ003                                          *01511000
                 INTO :INST,                                           *01512000
                      :PRDCDE,                                         *01513000
                      :ACCTNBR                                          01514000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01515000
         BALR  4,5                     MOVE INTO RECORD AREA            01516000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01517000
         BR    14                      RETURN TO CALLER                 01518000
         LTORG                                                          01519000
*                                                                       01520000
*                                                                       01521000
**********************************************************************  01522000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01523000
* ALTERNATE KEY 1:                                                      01524000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01525000
*     VERBS.                                                            01526000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01527000
*     RETRIEVE THE ACTUAL ROW.                                          01528000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01529000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01530000
*     WILL BE THRU THE UPDATE CURSOR.                                   01531000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01532000
**********************************************************************  01533000
*                                                                       01534000
SQL#0025 DS    0H                                                       01535000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01536000
         LA    15,255                  SET RETURN CODE                  01537000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01538000
         BR    14                      RETURN TO CALLER                 01539000
         LTORG                                                          01540000
*                                                                       01541000
*                                                                       01542000
**********************************************************************  01543000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01544000
* ALTERNATE KEY 2:                                                      01545000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01546000
*     VERBS.                                                            01547000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01548000
*     RETRIEVE THE ACTUAL ROW.                                          01549000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01550000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01551000
*     WILL BE THRU THE UPDATE CURSOR.                                   01552000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01553000
**********************************************************************  01554000
*                                                                       01555000
SQL#0026 DS    0H                                                       01556000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01557000
         LA    15,255                  SET RETURN CODE                  01558000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01559000
         BR    14                      RETURN TO CALLER                 01560000
         LTORG                                                          01561000
*                                                                       01562000
*                                                                       01563000
**********************************************************************  01564000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01565000
* ALTERNATE KEY 3:                                                      01566000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01567000
*     VERBS.                                                            01568000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01569000
*     RETRIEVE THE ACTUAL ROW.                                          01570000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01571000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01572000
*     WILL BE THRU THE UPDATE CURSOR.                                   01573000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01574000
**********************************************************************  01575000
*                                                                       01576000
SQL#0027 DS    0H                                                       01577000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01578000
         LA    15,255                  SET RETURN CODE                  01579000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01580000
         BR    14                      RETURN TO CALLER                 01581000
         LTORG                                                          01582000
*                                                                       01583000
*                                                                       01584000
**********************************************************************  01585000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01586000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01587000
*     AND GET-NEXT-LOCK VERBS.                                          01588000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01589000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01590000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01591000
**********************************************************************  01592000
*                                                                       01593000
SQL#0028 DS    0H                                                       01594000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01595000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01596000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01597000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01598000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01599000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01600000
VECT0028 DC    A(SQL#0128)                                              01601000
         DC    A(SQL#0228)                                              01602000
         DC    A(SQL#0328)                                              01603000
         LTORG                                                          01604000
*                                                                       01605000
SQL#0128 DS    0H                                                       01606000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01607000
         B     *+6                     BRANCH AROUND ADCON              01608000
BASE0128 DC    AL2(4096)                                                01609000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01610000
         AH    3,BASE0128              ADD 4K                           01611000
         EXEC  SQL                                                     *01612000
               CLOSE SAASQ001                                           01613000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01614000
         BR    14                      RETURN TO CALLER                 01615000
         LTORG                                                          01616000
*                                                                       01617000
SQL#0228 DS    0H                                                       01618000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01619000
         B     *+6                     BRANCH AROUND ADCON              01620000
BASE0228 DC    AL2(4096)                                                01621000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01622000
         AH    3,BASE0228              ADD 4K                           01623000
         EXEC  SQL                                                     *01624000
               CLOSE SAASQ002                                           01625000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01626000
         BR    14                      RETURN TO CALLER                 01627000
         LTORG                                                          01628000
*                                                                       01629000
SQL#0328 DS    0H                                                       01630000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01631000
         B     *+6                     BRANCH AROUND ADCON              01632000
BASE0328 DC    AL2(4096)                                                01633000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01634000
         AH    3,BASE0328              ADD 4K                           01635000
         EXEC  SQL                                                     *01636000
               CLOSE SAASQ003                                           01637000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01638000
         BR    14                      RETURN TO CALLER                 01639000
         LTORG                                                          01640000
*                                                                       01641000
*                                                                       01642000
**********************************************************************  01643000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01644000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01645000
*     AND GET-NEXT-LOCK VERBS.                                          01646000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01647000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01648000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01649000
**********************************************************************  01650000
*                                                                       01651000
SQL#0029 DS    0H                                                       01652000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01653000
         LA    15,255                  SET RETURN CODE                  01654000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01655000
         BR    14                      RETURN TO CALLER                 01656000
         LTORG                                                          01657000
*                                                                       01658000
*                                                                       01659000
**********************************************************************  01660000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01661000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01662000
*     AND GET-NEXT-LOCK VERBS.                                          01663000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01664000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01665000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01666000
**********************************************************************  01667000
*                                                                       01668000
SQL#0030 DS    0H                                                       01669000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01670000
         LA    15,255                  SET RETURN CODE                  01671000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01672000
         BR    14                      RETURN TO CALLER                 01673000
         LTORG                                                          01674000
*                                                                       01675000
*                                                                       01676000
**********************************************************************  01677000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01678000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01679000
*     AND GET-NEXT-LOCK VERBS.                                          01680000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01681000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01682000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01683000
**********************************************************************  01684000
*                                                                       01685000
SQL#0031 DS    0H                                                       01686000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01687000
         LA    15,255                  SET RETURN CODE                  01688000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01689000
         BR    14                      RETURN TO CALLER                 01690000
         LTORG                                                          01691000
*                                                                       01692000
*                                                                       01693000
**********************************************************************  01694000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01695000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01696000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01697000
**********************************************************************  01698000
*                                                                       01699000
SQL#0032 DS    0H                                                       01700000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01701000
         B     *+6                     BRANCH AROUND ADCON              01702000
BASE0032 DC    AL2(4096)                                                01703000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01704000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01705000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01706000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01707000
         AH    3,BASE0032              ADD 4K                           01708000
         EXEC  SQL                                                     *01709000
               SELECT INST_NBR,                                        *01710000
                   PROD_CODE,                                          *01711000
                   ACCT_NBR                                            *01712000
                 INTO :INST,                                           *01713000
                   :PRDCDE,                                            *01714000
                   :ACCTNBR                                            *01715000
                 FROM SAA                                              *01716000
                 WHERE INST_NBR = :INST AND                            *01717000
                   PROD_CODE = :PRDCDE AND                             *01718000
                   ACCT_NBR = :ACCTNBR                                 *01719000
                 FETCH FIRST 1 ROW ONLY                                 01720000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01721000
         BR    14                      RETURN TO CALLER                 01722000
         LTORG                                                          01723000
*                                                                       01724000
*                                                                       01725000
**********************************************************************  01726000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01727000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01728000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01729000
**********************************************************************  01730000
*                                                                       01731000
SQL#0033 DS    0H                                                       01732000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01733000
         LA    15,255                  SET RETURN CODE                  01734000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01735000
         BR    14                      RETURN TO CALLER                 01736000
         LTORG                                                          01737000
*                                                                       01738000
*                                                                       01739000
**********************************************************************  01740000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01741000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01742000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01743000
**********************************************************************  01744000
*                                                                       01745000
SQL#0034 DS    0H                                                       01746000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01747000
         LA    15,255                  SET RETURN CODE                  01748000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01749000
         BR    14                      RETURN TO CALLER                 01750000
         LTORG                                                          01751000
*                                                                       01752000
*                                                                       01753000
**********************************************************************  01754000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01755000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01756000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01757000
**********************************************************************  01758000
*                                                                       01759000
SQL#0035 DS    0H                                                       01760000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01761000
         LA    15,255                  SET RETURN CODE                  01762000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01763000
         BR    14                      RETURN TO CALLER                 01764000
         LTORG                                                          01765000
*                                                                       01766000
*                                                                       01767000
**********************************************************************  01768000
* INSERT STATEMENT:                                                     01769000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01770000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01771000
**********************************************************************  01772000
*                                                                       01773000
SQL#0036 DS    0H                                                       01774000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01775000
         B     *+6                     BRANCH AROUND ADCON              01776000
BASE0036 DC    AL2(4096)                                                01777000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01778000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01779000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01780000
         AH    3,BASE0036              ADD 4K                           01781000
         EXEC  SQL                                                     *01782000
               INSERT INTO SAA                                         *01783000
                   (INST_NBR,                                          *01784000
                    PROD_CODE,                                         *01785000
                    ACCT_NBR,                                          *01786000
                    AUDIT_DATE,                                        *01787000
                    AUDIT_TIME,                                        *01788000
                    AUDIT_USER,                                        *01789000
                    AUDIT_ORG,                                         *01790000
                    SVC_INCEN_OPT,                                     *01791000
                    SVC_INCEN_QLFY,                                    *01792000
                    SVC_MODEL,                                         *01793000
                    DISC_AMT,                                          *01794000
                    DISC_PERCENT,                                      *01795000
                    RATE_INCEN_OPT,                                    *01796000
                    RATE_INCEN_QLFY,                                   *01797000
                    RATE_MODEL,                                        *01798000
                    RATE_TYPE,                                         *01799000
                    RATE_OPTION,                                       *01800000
                    RATE_PCT,                                          *01801000
                    PROCESS_OPTION,                                    *01802000
                    RATE_AMT_1,                                        *01803000
                    RATE_PCT_1,                                        *01804000
                    RATE_AMT_2,                                        *01805000
                    RATE_PCT_2,                                        *01806000
                    RATE_AMT_3,                                        *01807000
                    RATE_PCT_3,                                        *01808000
                    RATE_AMT_4,                                        *01809000
                    RATE_PCT_4,                                        *01810000
                    RATE_AMT_5,                                        *01811000
                    RATE_PCT_5,                                        *01812000
                    RATE_AMT_6,                                        *01813000
                    RATE_PCT_6,                                        *01814000
                    RATE_AMT_7,                                        *01815000
                    RATE_PCT_7,                                        *01816000
                    RATE_AMT_8,                                        *01817000
                    RATE_PCT_8,                                        *01818000
                    RATE_AMT_9,                                        *01819000
                    RATE_PCT_9,                                        *01820000
                    RATE_AMT_10,                                       *01821000
                    RATE_PCT_10,                                       *01822000
                    RATE_AMT_11,                                       *01823000
                    RATE_PCT_11,                                       *01824000
                    RATE_AMT_12,                                       *01825000
                    RATE_PCT_12,                                       *01826000
                    RATE_AMT_13,                                       *01827000
                    RATE_PCT_13,                                       *01828000
                    RATE_AMT_14,                                       *01829000
                    RATE_PCT_14,                                       *01830000
                    RATE_AMT_15,                                       *01831000
                    RATE_PCT_15,                                       *01832000
                    APPL_NBR,                                          *01833000
                    SEC_SVC_OPT,                                       *01834000
                    SEC_SVC_01,                                        *01835000
                    SEC_SVC_02,                                        *01836000
                    SEC_SVC_03,                                        *01837000
                    SEC_SVC_04,                                        *01838000
                    SEC_SVC_05,                                        *01839000
                    SEC_SVC_06,                                        *01840000
                    SEC_SVC_07,                                        *01841000
                    SEC_SVC_08,                                        *01842000
                    SEC_SVC_09,                                        *01843000
                    SEC_SVC_10,                                        *01844000
                    SEC_SVC_11,                                        *01845000
                    SEC_SVC_12,                                        *01846000
                    SEC_SVC_13,                                        *01847000
                    SEC_SVC_14,                                        *01848000
                    SEC_SVC_15,                                        *01849000
                    SEC_SVC_16,                                        *01850000
                    SEC_SVC_17,                                        *01851000
                    SEC_SVC_18,                                        *01852000
                    SEC_SVC_19,                                        *01853000
                    SEC_SVC_20,                                        *01854000
                    RSV_AMT,                                           *01855000
                    MISC_OPTION_1,                                     *01856000
                    MISC_OPTION_2,                                     *01857000
                    MISC_OPTION_3,                                     *01858000
                    RSV_FLAG,                                          *01859000
                    RSV_FLAG_1,                                        *01860000
                    RSV_FLAG_2,                                        *01861000
                    RSV_FLAG_3,                                        *01862000
                    RSV_AREA)                                          *01863000
                  VALUES (:INST,                                       *01864000
                   :PRDCDE,                                            *01865000
                   :ACCTNBR,                                           *01866000
                   :AUDDATE,                                           *01867000
                   :AUDTIME,                                           *01868000
                   :AUDUSER,                                           *01869000
                   :AUDORG,                                            *01870000
                   :SCINCENO,                                          *01871000
                   :INCENQ,                                            *01872000
                   :SCMODEL,                                           *01873000
                   :DISCAMT,                                           *01874000
                   :DISCPCT,                                           *01875000
                   :RINCENO,                                           *01876000
                   :RINCENQ,                                           *01877000
                   :RATMODL,                                           *01878000
                   :RATTYP,                                            *01879000
                   :RATOPT,                                            *01880000
                   :RATEPCT,                                           *01881000
                   :PROCOPT,                                           *01882000
                   :RTAMT1,                                            *01883000
                   :RTPCT1,                                            *01884000
                   :RTAMT2,                                            *01885000
                   :RTPCT2,                                            *01886000
                   :RTAMT3,                                            *01887000
                   :RTPCT3,                                            *01888000
                   :RTAMT4,                                            *01889000
                   :RTPCT4,                                            *01890000
                   :RTAMT5,                                            *01891000
                   :RTPCT5,                                            *01892000
                   :RTAMT6,                                            *01893000
                   :RTPCT6,                                            *01894000
                   :RTAMT7,                                            *01895000
                   :RTPCT7,                                            *01896000
                   :RTAMT8,                                            *01897000
                   :RTPCT8,                                            *01898000
                   :RTAMT9,                                            *01899000
                   :RTPCT9,                                            *01900000
                   :RTAMT10,                                           *01901000
                   :RTPCT10,                                           *01902000
                   :RTAMT11,                                           *01903000
                   :RTPCT11,                                           *01904000
                   :RTAMT12,                                           *01905000
                   :RTPCT12,                                           *01906000
                   :RTAMT13,                                           *01907000
                   :RTPCT13,                                           *01908000
                   :RTAMT14,                                           *01909000
                   :RTPCT14,                                           *01910000
                   :RTAMT15,                                           *01911000
                   :RTPCT15,                                           *01912000
                   :APPLNBR,                                           *01913000
                   :SVCIOPT,                                           *01914000
                   :SECSVC1,                                           *01915000
                   :SECSVC2,                                           *01916000
                   :SECSVC3,                                           *01917000
                   :SECSVC4,                                           *01918000
                   :SECSVC5,                                           *01919000
                   :SECSVC6,                                           *01920000
                   :SECSVC7,                                           *01921000
                   :SECSVC8,                                           *01922000
                   :SECSVC9,                                           *01923000
                   :SECSVC10,                                          *01924000
                   :SECSVC11,                                          *01925000
                   :SECSVC12,                                          *01926000
                   :SECSVC13,                                          *01927000
                   :SECSVC14,                                          *01928000
                   :SECSVC15,                                          *01929000
                   :SECSVC16,                                          *01930000
                   :SECSVC17,                                          *01931000
                   :SECSVC18,                                          *01932000
                   :SECSVC19,                                          *01933000
                   :SECSVC20,                                          *01934000
                   :RSVAMT,                                            *01935000
                   :MISCOPT1,                                          *01936000
                   :MISCOPT2,                                          *01937000
                   :MISCOPT3,                                          *01938000
                   :RSVFLG,                                            *01939000
                   :RSVFLG1,                                           *01940000
                   :RSVFLG2,                                           *01941000
                   :RSVFLG3,                                           *01942000
                   :RAREA)                                              01943000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01944000
         BR    14                      RETURN TO CALLER                 01945000
         LTORG                                                          01946000
*                                                                       01947000
*                                                                       01948000
**********************************************************************  01949000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01950000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01951000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01952000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01953000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01954000
*     STATEMENT.                                                        01955000
**********************************************************************  01956000
*                                                                       01957000
SQL#0037 DS    0H                                                       01958000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01959000
         B     *+6                     BRANCH AROUND ADCON              01960000
BASE0037 DC    AL2(4096)                                                01961000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01962000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01963000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01964000
         AH    3,BASE0037              ADD 4K                           01965000
         EXEC  SQL                                                     *01966000
               UPDATE SAA                                              *01967000
                   SET AUDIT_DATE = :AUDDATE,                          *01968000
                     AUDIT_TIME = :AUDTIME,                            *01969000
                     AUDIT_USER = :AUDUSER,                            *01970000
                     AUDIT_ORG = :AUDORG,                              *01971000
                     SVC_INCEN_OPT = :SCINCENO,                        *01972000
                     SVC_INCEN_QLFY = :INCENQ,                         *01973000
                     SVC_MODEL = :SCMODEL,                             *01974000
                     DISC_AMT = :DISCAMT,                              *01975000
                     DISC_PERCENT = :DISCPCT,                          *01976000
                     RATE_INCEN_OPT = :RINCENO,                        *01977000
                     RATE_INCEN_QLFY = :RINCENQ,                       *01978000
                     RATE_MODEL = :RATMODL,                            *01979000
                     RATE_TYPE = :RATTYP,                              *01980000
                     RATE_OPTION = :RATOPT,                            *01981000
                     RATE_PCT = :RATEPCT,                              *01982000
                     PROCESS_OPTION = :PROCOPT,                        *01983000
                     RATE_AMT_1 = :RTAMT1,                             *01984000
                     RATE_PCT_1 = :RTPCT1,                             *01985000
                     RATE_AMT_2 = :RTAMT2,                             *01986000
                     RATE_PCT_2 = :RTPCT2,                             *01987000
                     RATE_AMT_3 = :RTAMT3,                             *01988000
                     RATE_PCT_3 = :RTPCT3,                             *01989000
                     RATE_AMT_4 = :RTAMT4,                             *01990000
                     RATE_PCT_4 = :RTPCT4,                             *01991000
                     RATE_AMT_5 = :RTAMT5,                             *01992000
                     RATE_PCT_5 = :RTPCT5,                             *01993000
                     RATE_AMT_6 = :RTAMT6,                             *01994000
                     RATE_PCT_6 = :RTPCT6,                             *01995000
                     RATE_AMT_7 = :RTAMT7,                             *01996000
                     RATE_PCT_7 = :RTPCT7,                             *01997000
                     RATE_AMT_8 = :RTAMT8,                             *01998000
                     RATE_PCT_8 = :RTPCT8,                             *01999000
                     RATE_AMT_9 = :RTAMT9,                             *02000000
                     RATE_PCT_9 = :RTPCT9,                             *02001000
                     RATE_AMT_10 = :RTAMT10,                           *02002000
                     RATE_PCT_10 = :RTPCT10,                           *02003000
                     RATE_AMT_11 = :RTAMT11,                           *02004000
                     RATE_PCT_11 = :RTPCT11,                           *02005000
                     RATE_AMT_12 = :RTAMT12,                           *02006000
                     RATE_PCT_12 = :RTPCT12,                           *02007000
                     RATE_AMT_13 = :RTAMT13,                           *02008000
                     RATE_PCT_13 = :RTPCT13,                           *02009000
                     RATE_AMT_14 = :RTAMT14,                           *02010000
                     RATE_PCT_14 = :RTPCT14,                           *02011000
                     RATE_AMT_15 = :RTAMT15,                           *02012000
                     RATE_PCT_15 = :RTPCT15,                           *02013000
                     APPL_NBR = :APPLNBR,                              *02014000
                     SEC_SVC_OPT = :SVCIOPT,                           *02015000
                     SEC_SVC_01 = :SECSVC1,                            *02016000
                     SEC_SVC_02 = :SECSVC2,                            *02017000
                     SEC_SVC_03 = :SECSVC3,                            *02018000
                     SEC_SVC_04 = :SECSVC4,                            *02019000
                     SEC_SVC_05 = :SECSVC5,                            *02020000
                     SEC_SVC_06 = :SECSVC6,                            *02021000
                     SEC_SVC_07 = :SECSVC7,                            *02022000
                     SEC_SVC_08 = :SECSVC8,                            *02023000
                     SEC_SVC_09 = :SECSVC9,                            *02024000
                     SEC_SVC_10 = :SECSVC10,                           *02025000
                     SEC_SVC_11 = :SECSVC11,                           *02026000
                     SEC_SVC_12 = :SECSVC12,                           *02027000
                     SEC_SVC_13 = :SECSVC13,                           *02028000
                     SEC_SVC_14 = :SECSVC14,                           *02029000
                     SEC_SVC_15 = :SECSVC15,                           *02030000
                     SEC_SVC_16 = :SECSVC16,                           *02031000
                     SEC_SVC_17 = :SECSVC17,                           *02032000
                     SEC_SVC_18 = :SECSVC18,                           *02033000
                     SEC_SVC_19 = :SECSVC19,                           *02034000
                     SEC_SVC_20 = :SECSVC20,                           *02035000
                     RSV_AMT = :RSVAMT,                                *02036000
                     MISC_OPTION_1 = :MISCOPT1,                        *02037000
                     MISC_OPTION_2 = :MISCOPT2,                        *02038000
                     MISC_OPTION_3 = :MISCOPT3,                        *02039000
                     RSV_FLAG = :RSVFLG,                               *02040000
                     RSV_FLAG_1 = :RSVFLG1,                            *02041000
                     RSV_FLAG_2 = :RSVFLG2,                            *02042000
                     RSV_FLAG_3 = :RSVFLG3,                            *02043000
                     RSV_AREA = :RAREA                                 *02044000
                 WHERE CURRENT OF SAAUPD0                               02045000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02046000
         BR    14                      RETURN TO CALLER                 02047000
         LTORG                                                          02048000
*                                                                       02049000
*                                                                       02050000
**********************************************************************  02051000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  02052000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02053000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02054000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02055000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02056000
*     STATEMENT.                                                        02057000
**********************************************************************  02058000
*                                                                       02059000
SQL#0038 DS    0H                                                       02060000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          02061000
         LA    15,255                  SET RETURN CODE                  02062000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02063000
         BR    14                      RETURN TO CALLER                 02064000
         LTORG                                                          02065000
*                                                                       02066000
*                                                                       02067000
**********************************************************************  02068000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  02069000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02070000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02071000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02072000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02073000
*     STATEMENT.                                                        02074000
**********************************************************************  02075000
*                                                                       02076000
SQL#0039 DS    0H                                                       02077000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          02078000
         LA    15,255                  SET RETURN CODE                  02079000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02080000
         BR    14                      RETURN TO CALLER                 02081000
         LTORG                                                          02082000
*                                                                       02083000
*                                                                       02084000
**********************************************************************  02085000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  02086000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02087000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02088000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02089000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02090000
*     STATEMENT.                                                        02091000
**********************************************************************  02092000
*                                                                       02093000
SQL#0040 DS    0H                                                       02094000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          02095000
         LA    15,255                  SET RETURN CODE                  02096000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02097000
         BR    14                      RETURN TO CALLER                 02098000
         LTORG                                                          02099000
*                                                                       02100000
*                                                                       02101000
**********************************************************************  02102000
* DELETE STATEMENT BY PRIMARY KEY:                                      02103000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02104000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02105000
**********************************************************************  02106000
*                                                                       02107000
SQL#0041 DS    0H                                                       02108000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          02109000
         B     *+6                     BRANCH AROUND ADCON              02110000
BASE0041 DC    AL2(4096)                                                02111000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02112000
         AH    3,BASE0041              ADD 4K                           02113000
         EXEC  SQL                                                     *02114000
               DELETE FROM SAA                                         *02115000
                 WHERE CURRENT OF SAAUPD0                               02116000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02117000
         BR    14                      RETURN TO CALLER                 02118000
         LTORG                                                          02119000
*                                                                       02120000
*                                                                       02121000
**********************************************************************  02122000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  02123000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02124000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02125000
**********************************************************************  02126000
*                                                                       02127000
SQL#0042 DS    0H                                                       02128000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          02129000
         LA    15,255                  SET RETURN CODE                  02130000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02131000
         BR    14                      RETURN TO CALLER                 02132000
         LTORG                                                          02133000
*                                                                       02134000
*                                                                       02135000
**********************************************************************  02136000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  02137000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02138000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02139000
**********************************************************************  02140000
*                                                                       02141000
SQL#0043 DS    0H                                                       02142000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          02143000
         LA    15,255                  SET RETURN CODE                  02144000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02145000
         BR    14                      RETURN TO CALLER                 02146000
         LTORG                                                          02147000
*                                                                       02148000
*                                                                       02149000
**********************************************************************  02150000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  02151000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02152000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02153000
**********************************************************************  02154000
*                                                                       02155000
SQL#0044 DS    0H                                                       02156000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          02157000
         LA    15,255                  SET RETURN CODE                  02158000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02159000
         BR    14                      RETURN TO CALLER                 02160000
         LTORG                                                          02161000
*                                                                       02162000
*                                                                       02163000
**********************************************************************  02164000
* DELETE ALL STATEMENT:                                                 02165000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       02166000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02167000
**********************************************************************  02168000
*                                                                       02169000
SQL#0045 DS    0H                                                       02170000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          02171000
         B     *+6                     BRANCH AROUND ADCON              02172000
BASE0045 DC    AL2(4096)                                                02173000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02174000
         AH    3,BASE0045              ADD 4K                           02175000
         EXEC  SQL                                                     *02176000
               DELETE FROM SAA                                          02177000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02178000
         BR    14                      RETURN TO CALLER                 02179000
         LTORG                                                          02180000
*                                                                       02181000
*                                                                       02182000
**********************************************************************  02183000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          02184000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                02185000
**********************************************************************  02186000
*                                                                       02187000
SQL#0046 DS    0H                                                       02188000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          02189000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              02190000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02191000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02192000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      02193000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         02194000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               02195000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      02196000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      02197000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     02198000
VECT0046 DC    A(0)                                                     02199000
         DC    A(SQL#0246)                                              02200000
         DC    A(SQL#0346)                                              02201000
         LTORG                                                          02202000
*                                                                       02203000
SQL#0246 DS    0H                                                       02204000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          02205000
         B     *+6                     BRANCH AROUND ADCON              02206000
BASE0246 DC    AL2(4096)                                                02207000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02208000
         AH    3,BASE0246              ADD 4K                           02209000
         EXEC  SQL                                                     *02210000
               CLOSE SAASQ001                                           02211000
         EXEC  SQL                                                     *02212000
               DECLARE SAASQ002 CURSOR FOR                             *02213000
               SELECT INST_NBR,                                        *02214000
                   PROD_CODE,                                          *02215000
                   ACCT_NBR,                                           *02216000
                   AUDIT_DATE,                                         *02217000
                   AUDIT_TIME,                                         *02218000
                   AUDIT_USER,                                         *02219000
                   AUDIT_ORG,                                          *02220000
                   SVC_INCEN_OPT,                                      *02221000
                   SVC_INCEN_QLFY,                                     *02222000
                   SVC_MODEL,                                          *02223000
                   DISC_AMT,                                           *02224000
                   DISC_PERCENT,                                       *02225000
                   RATE_INCEN_OPT,                                     *02226000
                   RATE_INCEN_QLFY,                                    *02227000
                   RATE_MODEL,                                         *02228000
                   RATE_TYPE,                                          *02229000
                   RATE_OPTION,                                        *02230000
                   RATE_PCT,                                           *02231000
                   PROCESS_OPTION,                                     *02232000
                   RATE_AMT_1,                                         *02233000
                   RATE_PCT_1,                                         *02234000
                   RATE_AMT_2,                                         *02235000
                   RATE_PCT_2,                                         *02236000
                   RATE_AMT_3,                                         *02237000
                   RATE_PCT_3,                                         *02238000
                   RATE_AMT_4,                                         *02239000
                   RATE_PCT_4,                                         *02240000
                   RATE_AMT_5,                                         *02241000
                   RATE_PCT_5,                                         *02242000
                   RATE_AMT_6,                                         *02243000
                   RATE_PCT_6,                                         *02244000
                   RATE_AMT_7,                                         *02245000
                   RATE_PCT_7,                                         *02246000
                   RATE_AMT_8,                                         *02247000
                   RATE_PCT_8,                                         *02248000
                   RATE_AMT_9,                                         *02249000
                   RATE_PCT_9,                                         *02250000
                   RATE_AMT_10,                                        *02251000
                   RATE_PCT_10,                                        *02252000
                   RATE_AMT_11,                                        *02253000
                   RATE_PCT_11,                                        *02254000
                   RATE_AMT_12,                                        *02255000
                   RATE_PCT_12,                                        *02256000
                   RATE_AMT_13,                                        *02257000
                   RATE_PCT_13,                                        *02258000
                   RATE_AMT_14,                                        *02259000
                   RATE_PCT_14,                                        *02260000
                   RATE_AMT_15,                                        *02261000
                   RATE_PCT_15,                                        *02262000
                   APPL_NBR,                                           *02263000
                   SEC_SVC_OPT,                                        *02264000
                   SEC_SVC_01,                                         *02265000
                   SEC_SVC_02,                                         *02266000
                   SEC_SVC_03,                                         *02267000
                   SEC_SVC_04,                                         *02268000
                   SEC_SVC_05,                                         *02269000
                   SEC_SVC_06,                                         *02270000
                   SEC_SVC_07,                                         *02271000
                   SEC_SVC_08,                                         *02272000
                   SEC_SVC_09,                                         *02273000
                   SEC_SVC_10,                                         *02274000
                   SEC_SVC_11,                                         *02275000
                   SEC_SVC_12,                                         *02276000
                   SEC_SVC_13,                                         *02277000
                   SEC_SVC_14,                                         *02278000
                   SEC_SVC_15,                                         *02279000
                   SEC_SVC_16,                                         *02280000
                   SEC_SVC_17,                                         *02281000
                   SEC_SVC_18,                                         *02282000
                   SEC_SVC_19,                                         *02283000
                   SEC_SVC_20,                                         *02284000
                   RSV_AMT,                                            *02285000
                   MISC_OPTION_1,                                      *02286000
                   MISC_OPTION_2,                                      *02287000
                   MISC_OPTION_3,                                      *02288000
                   RSV_FLAG,                                           *02289000
                   RSV_FLAG_1,                                         *02290000
                   RSV_FLAG_2,                                         *02291000
                   RSV_FLAG_3,                                         *02292000
                   RSV_AREA                                            *02293000
                 FROM SAA                                              *02294000
                 WHERE                                                 *02295000
                    INST_NBR = :INST AND                               *02296000
                    PROD_CODE > :PRDCDE                                *02297000
                 ORDER BY PROD_CODE,                                   *02298000
                   ACCT_NBR                                            *02299000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02300000
         EXEC  SQL                                                     *02301000
               OPEN SAASQ002                                            02302000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02303000
         BNZ   *+8                     NO - RETURN ERROR                02304000
         LR    12,9                    LOAD RETURN ADDRESS              02305000
         BR    12                      RETURN TO FETCH ROUTINE          02306000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02307000
         BR    14                      RETURN TO CALLER                 02308000
         LTORG                                                          02309000
*                                                                       02310000
SQL#0346 DS    0H                                                       02311000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          02312000
         B     *+6                     BRANCH AROUND ADCON              02313000
BASE0346 DC    AL2(4096)                                                02314000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02315000
         AH    3,BASE0346              ADD 4K                           02316000
         EXEC  SQL                                                     *02317000
               CLOSE SAASQ002                                           02318000
         EXEC  SQL                                                     *02319000
               DECLARE SAASQ003 CURSOR FOR                             *02320000
               SELECT INST_NBR,                                        *02321000
                   PROD_CODE,                                          *02322000
                   ACCT_NBR,                                           *02323000
                   AUDIT_DATE,                                         *02324000
                   AUDIT_TIME,                                         *02325000
                   AUDIT_USER,                                         *02326000
                   AUDIT_ORG,                                          *02327000
                   SVC_INCEN_OPT,                                      *02328000
                   SVC_INCEN_QLFY,                                     *02329000
                   SVC_MODEL,                                          *02330000
                   DISC_AMT,                                           *02331000
                   DISC_PERCENT,                                       *02332000
                   RATE_INCEN_OPT,                                     *02333000
                   RATE_INCEN_QLFY,                                    *02334000
                   RATE_MODEL,                                         *02335000
                   RATE_TYPE,                                          *02336000
                   RATE_OPTION,                                        *02337000
                   RATE_PCT,                                           *02338000
                   PROCESS_OPTION,                                     *02339000
                   RATE_AMT_1,                                         *02340000
                   RATE_PCT_1,                                         *02341000
                   RATE_AMT_2,                                         *02342000
                   RATE_PCT_2,                                         *02343000
                   RATE_AMT_3,                                         *02344000
                   RATE_PCT_3,                                         *02345000
                   RATE_AMT_4,                                         *02346000
                   RATE_PCT_4,                                         *02347000
                   RATE_AMT_5,                                         *02348000
                   RATE_PCT_5,                                         *02349000
                   RATE_AMT_6,                                         *02350000
                   RATE_PCT_6,                                         *02351000
                   RATE_AMT_7,                                         *02352000
                   RATE_PCT_7,                                         *02353000
                   RATE_AMT_8,                                         *02354000
                   RATE_PCT_8,                                         *02355000
                   RATE_AMT_9,                                         *02356000
                   RATE_PCT_9,                                         *02357000
                   RATE_AMT_10,                                        *02358000
                   RATE_PCT_10,                                        *02359000
                   RATE_AMT_11,                                        *02360000
                   RATE_PCT_11,                                        *02361000
                   RATE_AMT_12,                                        *02362000
                   RATE_PCT_12,                                        *02363000
                   RATE_AMT_13,                                        *02364000
                   RATE_PCT_13,                                        *02365000
                   RATE_AMT_14,                                        *02366000
                   RATE_PCT_14,                                        *02367000
                   RATE_AMT_15,                                        *02368000
                   RATE_PCT_15,                                        *02369000
                   APPL_NBR,                                           *02370000
                   SEC_SVC_OPT,                                        *02371000
                   SEC_SVC_01,                                         *02372000
                   SEC_SVC_02,                                         *02373000
                   SEC_SVC_03,                                         *02374000
                   SEC_SVC_04,                                         *02375000
                   SEC_SVC_05,                                         *02376000
                   SEC_SVC_06,                                         *02377000
                   SEC_SVC_07,                                         *02378000
                   SEC_SVC_08,                                         *02379000
                   SEC_SVC_09,                                         *02380000
                   SEC_SVC_10,                                         *02381000
                   SEC_SVC_11,                                         *02382000
                   SEC_SVC_12,                                         *02383000
                   SEC_SVC_13,                                         *02384000
                   SEC_SVC_14,                                         *02385000
                   SEC_SVC_15,                                         *02386000
                   SEC_SVC_16,                                         *02387000
                   SEC_SVC_17,                                         *02388000
                   SEC_SVC_18,                                         *02389000
                   SEC_SVC_19,                                         *02390000
                   SEC_SVC_20,                                         *02391000
                   RSV_AMT,                                            *02392000
                   MISC_OPTION_1,                                      *02393000
                   MISC_OPTION_2,                                      *02394000
                   MISC_OPTION_3,                                      *02395000
                   RSV_FLAG,                                           *02396000
                   RSV_FLAG_1,                                         *02397000
                   RSV_FLAG_2,                                         *02398000
                   RSV_FLAG_3,                                         *02399000
                   RSV_AREA                                            *02400000
                 FROM SAA                                              *02401000
                 WHERE                                                 *02402000
                    INST_NBR > :INST                                   *02403000
                 ORDER BY INST_NBR,                                    *02404000
                   PROD_CODE,                                          *02405000
                   ACCT_NBR                                            *02406000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02407000
         EXEC  SQL                                                     *02408000
               OPEN SAASQ003                                            02409000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02410000
         BNZ   *+8                     NO - RETURN ERROR                02411000
         LR    12,9                    LOAD RETURN ADDRESS              02412000
         BR    12                      RETURN TO FETCH ROUTINE          02413000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02414000
         BR    14                      RETURN TO CALLER                 02415000
         LTORG                                                          02416000
*                                                                       02417000
*                                                                       02418000
**********************************************************************  02419000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02420000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02421000
**********************************************************************  02422000
*                                                                       02423000
SQL#0047 DS    0H                                                       02424000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02425000
         LA    15,255                  SET RETURN CODE                  02426000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02427000
         BR    14                      RETURN TO CALLER                 02428000
         LTORG                                                          02429000
*                                                                       02430000
*                                                                       02431000
**********************************************************************  02432000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02433000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02434000
**********************************************************************  02435000
*                                                                       02436000
SQL#0048 DS    0H                                                       02437000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02438000
         LA    15,255                  SET RETURN CODE                  02439000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02440000
         BR    14                      RETURN TO CALLER                 02441000
         LTORG                                                          02442000
*                                                                       02443000
*                                                                       02444000
**********************************************************************  02445000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02446000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02447000
**********************************************************************  02448000
*                                                                       02449000
SQL#0049 DS    0H                                                       02450000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02451000
         LA    15,255                  SET RETURN CODE                  02452000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02453000
         BR    14                      RETURN TO CALLER                 02454000
         LTORG                                                          02455000
*                                                                       02456000
         DS    0H                      END OF SQL STATEMENTS            02457000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02458000
*                                                                       02459000
*                                                                       02460000
**********************************************************************  02461000
* DUMMY ENTRY POINT DSNHLI                                              02462000
*   MUST NOT BE MODIFIED.                                               02463000
**********************************************************************  02464000
*                                                                       02465000
         ENTRY DSNHLI                                                   02466000
DSNHLI   DS    0H                                                       02467000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02468000
         BR    15                      BRANCH TO ATTACH FACILITY        02469000
*                                                                       02470000
*                                                                       02471000
**********************************************************************  02472000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02473000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02474000
*   MUST NOT BE MODIFIED.                                               02475000
**********************************************************************  02476000
*                                                                       02477000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02478000
CONV#RTN AMODE ANY                                                      02479000
CONV#RTN RMODE ANY                                                      02480000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02481000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02482000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02483000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02484000
         BER   4                         YES - RETURN TO SQL            02485000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02486000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02487000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02488000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02489000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02490000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02491000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02492000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02493000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02494000
*                                                                       02495000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02496000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02497000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02498000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02499000
         BER   4                         YES - RETURN TO SQL            02500000
         SLR   0,0                     CLEAR FOR INSERT                 02501000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02502000
         NR    0,3                     FOR THE CURRENT KEY?             02503000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02504000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02505000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02506000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02507000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02508000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02509000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02510000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02511000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02512000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02513000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02514000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02515000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02516000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02517000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02518000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02519000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02520000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02521000
*                                                                       02522000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02523000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02524000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02525000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02526000
         BER   4                         YES - RETURN TO SQL            02527000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02528000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02529000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02530000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02531000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02532000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02533000
         MVCL  0,14                    MOVE TO RECORD AREA              02534000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02535000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02536000
*                                                                       02537000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02538000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02539000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02540000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02541000
         BER   4                         YES - RETURN TO SQL            02542000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02543000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02544000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02545000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02546000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02547000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02548000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02549000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02550000
         MVCL  0,14                    MOVE TO RECORD AREA              02551000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02552000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02553000
*                                                                       02554000
*                                                                       02555000
**********************************************************************  02556000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02557000
*   MUST NOT BE MODIFIED.                                               02558000
**********************************************************************  02559000
*                                                                       02560000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02561000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02562000
         DC    H'0028'                 LENGTH TO MOVE                   02563000
         DC    X'80'                   80 = KEY 0 FIELD                 02564000
*                                      40 = KEY 1 FIELD                 02565000
*                                      20 = KEY 2 FIELD                 02566000
*                                      10 = KEY 3 FIELD                 02567000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02568000
*                                                                       02569000
*                                      REST OF FIELD ENTRIES            02570000
         DC    H'0028',H'0028',H'0409',X'00',X'00'                      02571000
         DC    8X'FF'                  END OF FIELD ENTRIES             02572000
         LTORG                                                          02573000
         END                                                            02574000
