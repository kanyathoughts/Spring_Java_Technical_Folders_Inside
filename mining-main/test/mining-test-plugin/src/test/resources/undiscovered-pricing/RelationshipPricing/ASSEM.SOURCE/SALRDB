**********************************************************************  00001000
*                                                                       00002000
*  SALRDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAL TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
PRDCDE   DS    CL6                                                      00051000
ACCTNBR  DS    CL18                                                     00052000
MODEL    DS    CL10                                                     00053000
AUDDATE  DS    PL5'0.'                                                  00054000
AUDTIME  DS    PL5'0.'                                                  00055000
AUDUSER  DS    CL8                                                      00056000
AUDORG   DS    CL6                                                      00057000
GRACEDTE DS    PL5'0.'                                                  00058000
TRNDTE01 DS    PL5'0.'                                                  00059000
TRNCNT01 DS    PL3'0.'                                                  00060000
TRNAMT01 DS    PL7'0.00'                                                00061000
TRNDTE02 DS    PL5'0.'                                                  00062000
TRNCNT02 DS    PL3'0.'                                                  00063000
TRNAMT02 DS    PL7'0.00'                                                00064000
TRNDTE03 DS    PL5'0.'                                                  00065000
TRNCNT03 DS    PL3'0.'                                                  00066000
TRNAMT03 DS    PL7'0.00'                                                00067000
TRNDTE04 DS    PL5'0.'                                                  00068000
TRNCNT04 DS    PL3'0.'                                                  00069000
TRNAMT04 DS    PL7'0.00'                                                00070000
TRNDTE05 DS    PL5'0.'                                                  00071000
TRNCNT05 DS    PL3'0.'                                                  00072000
TRNAMT05 DS    PL7'0.00'                                                00073000
TRNDTE06 DS    PL5'0.'                                                  00074000
TRNCNT06 DS    PL3'0.'                                                  00075000
TRNAMT06 DS    PL7'0.00'                                                00076000
TRNDTE07 DS    PL5'0.'                                                  00077000
TRNCNT07 DS    PL3'0.'                                                  00078000
TRNAMT07 DS    PL7'0.00'                                                00079000
TRNDTE08 DS    PL5'0.'                                                  00080000
TRNCNT08 DS    PL3'0.'                                                  00081000
TRNAMT08 DS    PL7'0.00'                                                00082000
TRNDTE09 DS    PL5'0.'                                                  00083000
TRNCNT09 DS    PL3'0.'                                                  00084000
TRNAMT09 DS    PL7'0.00'                                                00085000
TRNDTE10 DS    PL5'0.'                                                  00086000
TRNCNT10 DS    PL3'0.'                                                  00087000
TRNAMT10 DS    PL7'0.00'                                                00088000
TRNDTE11 DS    PL5'0.'                                                  00089000
TRNCNT11 DS    PL3'0.'                                                  00090000
TRNAMT11 DS    PL7'0.00'                                                00091000
TRNDTE12 DS    PL5'0.'                                                  00092000
TRNCNT12 DS    PL3'0.'                                                  00093000
TRNAMT12 DS    PL7'0.00'                                                00094000
RAREA    DS    CL50                                                     00095000
*                                                                       00096000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00097000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00098000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00099000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00100000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00101000
         DS    CL97                    RESERVED                         00102000
*                                                                       00103000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00104000
INDVARX  DS    0H                                                       00105000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00106000
*                                                                       00107000
*                                                                       00108000
**********************************************************************  00109000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00110000
**********************************************************************  00111000
*                                                                       00112000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00113000
*                                                                       00114000
**********************************************************************  00115000
* PROGRAM TABLE HEADER SECTION:                                         00116000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00117000
**********************************************************************  00118000
*                                                                       00119000
SALRDB   CSECT                         PROGRAM TABLE SECTION            00120000
SALRDB   AMODE ANY                                                      00121000
SALRDB   RMODE ANY                                                      00122000
         DC    CL8'SALRDB  '           PROGRAM ID                       00123000
         DC    CL1' '                                                   00124000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00125000
         DC    CL1' '                                                   00126000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00127000
         DC    CL1' '                                                   00128000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00129000
         DC    5A(0)                   RESERVED                         00130000
         DC    AL2(0)                  RESERVED                         00131000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00132000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00133000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00134000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00135000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00136000
         DC    CL29'WWW.INFOR.COM                '                      00136001
*                                                                       00137000
**********************************************************************  00138000
* STATEMENT TABLE SECTION:                                              00139000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00140000
**********************************************************************  00141000
*                                                                       00142000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00143000
STM#TAB  AMODE ANY                                                      00144000
STM#TAB  RMODE ANY                                                      00145000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00146000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00147000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00148000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00149000
         DC    12A(0)                  UDB MODULE VECTORS               00150000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00151000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00152000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00153000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00154000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00155000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00156000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00157000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00158000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00159000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00160000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00161000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00162000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00163000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00164000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00165000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00166000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00167000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00168000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00169000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00170000
         DC    10A(0)                  UDB MODULE VECTORS               00171000
         DC    4X'FF'                                                   00172000
*                                                                       00173000
**********************************************************************  00174000
* SQL STATEMENT SECTION:                                                00175000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00176000
*     TO SUPPORT THIS TABLE.                                            00177000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00178000
*     ARE EQUIVALENT.                                                   00179000
**********************************************************************  00180000
*                                                                       00181000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00182000
SQL#STMT AMODE ANY                                                      00183000
SQL#STMT RMODE ANY                                                      00184000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00185000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00186000
         USING COM#AREA,11             ADDRESS COMMAREA                 00187000
*                                                                       00188000
**********************************************************************  00189000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00190000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00191000
**********************************************************************  00192000
*                                                                       00193000
SELIN0   DS    0H                                                       00194000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00195000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00196000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00197000
         BALR  14,15                   MOVE REQUESTED DATA              00198000
         B     *+6                     BRANCH AROUND ADCON              00199000
BASIN0   DC    AL2(4096)                                                00200000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00201000
         AH    3,BASIN0                ADD 4K                           00202000
         EXEC  SQL SELECT                                              *00203000
                   AUDIT_DATE,                                         *00204000
                   AUDIT_TIME,                                         *00205000
                   AUDIT_USER,                                         *00206000
                   AUDIT_ORG,                                          *00207000
                   GRACE_EXP_DATE,                                     *00208000
                   TRAN_DATE_01,                                       *00209000
                   TRAN_COUNT_01,                                      *00210000
                   TRAN_AMOUNT_01,                                     *00211000
                   TRAN_DATE_02,                                       *00212000
                   TRAN_COUNT_02,                                      *00213000
                   TRAN_AMOUNT_02,                                     *00214000
                   TRAN_DATE_03,                                       *00215000
                   TRAN_COUNT_03,                                      *00216000
                   TRAN_AMOUNT_03,                                     *00217000
                   TRAN_DATE_04,                                       *00218000
                   TRAN_COUNT_04,                                      *00219000
                   TRAN_AMOUNT_04,                                     *00220000
                   TRAN_DATE_05,                                       *00221000
                   TRAN_COUNT_05,                                      *00222000
                   TRAN_AMOUNT_05,                                     *00223000
                   TRAN_DATE_06,                                       *00224000
                   TRAN_COUNT_06,                                      *00225000
                   TRAN_AMOUNT_06,                                     *00226000
                   TRAN_DATE_07,                                       *00227000
                   TRAN_COUNT_07,                                      *00228000
                   TRAN_AMOUNT_07,                                     *00229000
                   TRAN_DATE_08,                                       *00230000
                   TRAN_COUNT_08,                                      *00231000
                   TRAN_AMOUNT_08,                                     *00232000
                   TRAN_DATE_09,                                       *00233000
                   TRAN_COUNT_09,                                      *00234000
                   TRAN_AMOUNT_09,                                     *00235000
                   TRAN_DATE_10,                                       *00236000
                   TRAN_COUNT_10,                                      *00237000
                   TRAN_AMOUNT_10,                                     *00238000
                   TRAN_DATE_11,                                       *00239000
                   TRAN_COUNT_11,                                      *00240000
                   TRAN_AMOUNT_11,                                     *00241000
                   TRAN_DATE_12,                                       *00242000
                   TRAN_COUNT_12,                                      *00243000
                   TRAN_AMOUNT_12,                                     *00244000
                   RSV_AREA                                            *00245000
                 INTO                                                  *00246000
                   :AUDDATE,                                           *00247000
                   :AUDTIME,                                           *00248000
                   :AUDUSER,                                           *00249000
                   :AUDORG,                                            *00250000
                   :GRACEDTE,                                          *00251000
                   :TRNDTE01,                                          *00252000
                   :TRNCNT01,                                          *00253000
                   :TRNAMT01,                                          *00254000
                   :TRNDTE02,                                          *00255000
                   :TRNCNT02,                                          *00256000
                   :TRNAMT02,                                          *00257000
                   :TRNDTE03,                                          *00258000
                   :TRNCNT03,                                          *00259000
                   :TRNAMT03,                                          *00260000
                   :TRNDTE04,                                          *00261000
                   :TRNCNT04,                                          *00262000
                   :TRNAMT04,                                          *00263000
                   :TRNDTE05,                                          *00264000
                   :TRNCNT05,                                          *00265000
                   :TRNAMT05,                                          *00266000
                   :TRNDTE06,                                          *00267000
                   :TRNCNT06,                                          *00268000
                   :TRNAMT06,                                          *00269000
                   :TRNDTE07,                                          *00270000
                   :TRNCNT07,                                          *00271000
                   :TRNAMT07,                                          *00272000
                   :TRNDTE08,                                          *00273000
                   :TRNCNT08,                                          *00274000
                   :TRNAMT08,                                          *00275000
                   :TRNDTE09,                                          *00276000
                   :TRNCNT09,                                          *00277000
                   :TRNAMT09,                                          *00278000
                   :TRNDTE10,                                          *00279000
                   :TRNCNT10,                                          *00280000
                   :TRNAMT10,                                          *00281000
                   :TRNDTE11,                                          *00282000
                   :TRNCNT11,                                          *00283000
                   :TRNAMT11,                                          *00284000
                   :TRNDTE12,                                          *00285000
                   :TRNCNT12,                                          *00286000
                   :TRNAMT12,                                          *00287000
                   :RAREA                                              *00288000
                 FROM SAL                                              *00289000
                 WHERE                                                 *00290000
                   INST_NBR = :INST AND                                *00291000
                   PROD_CODE = :PRDCDE AND                             *00292000
                   ACCT_NBR = :ACCTNBR AND                             *00293000
                   MODEL = :MODEL                                      *00294000
                 FETCH FIRST 1 ROW ONLY                                 00295000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00296000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00297000
         BALR  14,15                   MOVE REQUESTED DATA              00298000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00299000
         BR    14                      RETURN TO CALLER                 00300000
         LTORG                                                          00301000
*                                                                       00302000
**********************************************************************  00303000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00304000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00305000
**********************************************************************  00306000
*                                                                       00307000
SELKY0   DS    0H                                                       00308000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00309000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00310000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00311000
         BALR  14,15                   MOVE REQUESTED DATA              00312000
         B     *+6                     BRANCH AROUND ADCON              00313000
BASKY0   DC    AL2(4096)                                                00314000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00315000
         AH    3,BASKY0                ADD 4K                           00316000
         EXEC  SQL SELECT                                              *00317000
                   COUNT(*)                                            *00318000
                 INTO                                                  *00319000
                   :SQWINTHV                                           *00320000
                 FROM SAL                                              *00321000
                 WHERE                                                 *00322000
                   INST_NBR = :INST AND                                *00323000
                   PROD_CODE = :PRDCDE AND                             *00324000
                   ACCT_NBR = :ACCTNBR AND                             *00325000
                   MODEL = :MODEL                                      *00326000
                 FETCH FIRST 1 ROW ONLY                                 00327000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00328000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00329000
         BNER  14                      NO - RETURN TO CALLER            00330000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00331000
         BNER  14                      YES - RETURN ZERO SQLCODE        00332000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00333000
         BR    14                      RETURN TO CALLER                 00334000
         LTORG                                                          00335000
*                                                                       00336000
**********************************************************************  00337000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00338000
* KEY:                                                                  00339000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00340000
*     AND GET-NEXT-LOCK VERBS.                                          00341000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00342000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00343000
**********************************************************************  00344000
*                                                                       00345000
SELXC0   DS    0H                                                       00346000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00347000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00348000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00349000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00350000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00351000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00352000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00353000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00354000
SELXC0P  DC    A(SELGE001)                                              00355000
         DC    (KY0COLMS-01)A(0)                                        00356000
         DC    A(SELGE002)                                              00357000
         DC    (KY0COLMS-02)A(0)                                        00358000
         DC    A(SELGE003)                                              00359000
         DC    (KY0COLMS-03)A(0)                                        00360000
         DC    A(SELGE004)                                              00361000
         LTORG                                                          00362000
*                                                                       00363000
SELGE001 DS    0H                                                       00364000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00365000
         B     *+6                     BRANCH AROUND ADCON              00366000
BASGE001 DC    AL2(4096)                                                00367000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00368000
         AH    3,BASGE001              ADD 4K                           00369000
         EXEC  SQL DECLARE SALGE001 CURSOR                             *00370000
               WITH ROWSET POSITIONING                                 *00371000
               FOR SELECT                                              *00372000
                   INST_NBR,                                           *00373000
                   PROD_CODE,                                          *00374000
                   ACCT_NBR,                                           *00375000
                   MODEL,                                              *00376000
                   AUDIT_DATE,                                         *00377000
                   AUDIT_TIME,                                         *00378000
                   AUDIT_USER,                                         *00379000
                   AUDIT_ORG,                                          *00380000
                   GRACE_EXP_DATE,                                     *00381000
                   TRAN_DATE_01,                                       *00382000
                   TRAN_COUNT_01,                                      *00383000
                   TRAN_AMOUNT_01,                                     *00384000
                   TRAN_DATE_02,                                       *00385000
                   TRAN_COUNT_02,                                      *00386000
                   TRAN_AMOUNT_02,                                     *00387000
                   TRAN_DATE_03,                                       *00388000
                   TRAN_COUNT_03,                                      *00389000
                   TRAN_AMOUNT_03,                                     *00390000
                   TRAN_DATE_04,                                       *00391000
                   TRAN_COUNT_04,                                      *00392000
                   TRAN_AMOUNT_04,                                     *00393000
                   TRAN_DATE_05,                                       *00394000
                   TRAN_COUNT_05,                                      *00395000
                   TRAN_AMOUNT_05,                                     *00396000
                   TRAN_DATE_06,                                       *00397000
                   TRAN_COUNT_06,                                      *00398000
                   TRAN_AMOUNT_06,                                     *00399000
                   TRAN_DATE_07,                                       *00400000
                   TRAN_COUNT_07,                                      *00401000
                   TRAN_AMOUNT_07,                                     *00402000
                   TRAN_DATE_08,                                       *00403000
                   TRAN_COUNT_08,                                      *00404000
                   TRAN_AMOUNT_08,                                     *00405000
                   TRAN_DATE_09,                                       *00406000
                   TRAN_COUNT_09,                                      *00407000
                   TRAN_AMOUNT_09,                                     *00408000
                   TRAN_DATE_10,                                       *00409000
                   TRAN_COUNT_10,                                      *00410000
                   TRAN_AMOUNT_10,                                     *00411000
                   TRAN_DATE_11,                                       *00412000
                   TRAN_COUNT_11,                                      *00413000
                   TRAN_AMOUNT_11,                                     *00414000
                   TRAN_DATE_12,                                       *00415000
                   TRAN_COUNT_12,                                      *00416000
                   TRAN_AMOUNT_12,                                     *00417000
                   RSV_AREA                                            *00418000
                 FROM SAL                                              *00419000
                 WHERE                                                 *00420000
                   INST_NBR = :INST AND                                *00421000
                   PROD_CODE = :PRDCDE AND                             *00422000
                   ACCT_NBR = :ACCTNBR AND                             *00423000
                   MODEL >=                                            *00424000
                     :MODEL                                            *00425000
                 ORDER BY MODEL ASC                                    *00426000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00427000
         EXEC  SQL OPEN SALGE001                                        00428000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00429000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00430000
         BR    14                      RETURN TO CALLER                 00431000
         LTORG                                                          00432000
*                                                                       00433000
SELGE002 DS    0H                                                       00434000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00435000
         B     *+6                     BRANCH AROUND ADCON              00436000
BASGE002 DC    AL2(4096)                                                00437000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00438000
         AH    3,BASGE002              ADD 4K                           00439000
         EXEC  SQL DECLARE SALGE002 CURSOR                             *00440000
               WITH ROWSET POSITIONING                                 *00441000
               FOR SELECT                                              *00442000
                   INST_NBR,                                           *00443000
                   PROD_CODE,                                          *00444000
                   ACCT_NBR,                                           *00445000
                   MODEL,                                              *00446000
                   AUDIT_DATE,                                         *00447000
                   AUDIT_TIME,                                         *00448000
                   AUDIT_USER,                                         *00449000
                   AUDIT_ORG,                                          *00450000
                   GRACE_EXP_DATE,                                     *00451000
                   TRAN_DATE_01,                                       *00452000
                   TRAN_COUNT_01,                                      *00453000
                   TRAN_AMOUNT_01,                                     *00454000
                   TRAN_DATE_02,                                       *00455000
                   TRAN_COUNT_02,                                      *00456000
                   TRAN_AMOUNT_02,                                     *00457000
                   TRAN_DATE_03,                                       *00458000
                   TRAN_COUNT_03,                                      *00459000
                   TRAN_AMOUNT_03,                                     *00460000
                   TRAN_DATE_04,                                       *00461000
                   TRAN_COUNT_04,                                      *00462000
                   TRAN_AMOUNT_04,                                     *00463000
                   TRAN_DATE_05,                                       *00464000
                   TRAN_COUNT_05,                                      *00465000
                   TRAN_AMOUNT_05,                                     *00466000
                   TRAN_DATE_06,                                       *00467000
                   TRAN_COUNT_06,                                      *00468000
                   TRAN_AMOUNT_06,                                     *00469000
                   TRAN_DATE_07,                                       *00470000
                   TRAN_COUNT_07,                                      *00471000
                   TRAN_AMOUNT_07,                                     *00472000
                   TRAN_DATE_08,                                       *00473000
                   TRAN_COUNT_08,                                      *00474000
                   TRAN_AMOUNT_08,                                     *00475000
                   TRAN_DATE_09,                                       *00476000
                   TRAN_COUNT_09,                                      *00477000
                   TRAN_AMOUNT_09,                                     *00478000
                   TRAN_DATE_10,                                       *00479000
                   TRAN_COUNT_10,                                      *00480000
                   TRAN_AMOUNT_10,                                     *00481000
                   TRAN_DATE_11,                                       *00482000
                   TRAN_COUNT_11,                                      *00483000
                   TRAN_AMOUNT_11,                                     *00484000
                   TRAN_DATE_12,                                       *00485000
                   TRAN_COUNT_12,                                      *00486000
                   TRAN_AMOUNT_12,                                     *00487000
                   RSV_AREA                                            *00488000
                 FROM SAL                                              *00489000
                 WHERE                                                 *00490000
                   INST_NBR = :INST AND                                *00491000
                   PROD_CODE = :PRDCDE AND                             *00492000
                   ACCT_NBR >=                                         *00493000
                     :ACCTNBR                                          *00494000
                 ORDER BY ACCT_NBR ASC,                                *00495000
                   MODEL ASC                                           *00496000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00497000
         EXEC  SQL OPEN SALGE002                                        00498000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00499000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00500000
         BR    14                      RETURN TO CALLER                 00501000
         LTORG                                                          00502000
*                                                                       00503000
SELGE003 DS    0H                                                       00504000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00505000
         B     *+6                     BRANCH AROUND ADCON              00506000
BASGE003 DC    AL2(4096)                                                00507000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00508000
         AH    3,BASGE003              ADD 4K                           00509000
         EXEC  SQL DECLARE SALGE003 CURSOR                             *00510000
               WITH ROWSET POSITIONING                                 *00511000
               FOR SELECT                                              *00512000
                   INST_NBR,                                           *00513000
                   PROD_CODE,                                          *00514000
                   ACCT_NBR,                                           *00515000
                   MODEL,                                              *00516000
                   AUDIT_DATE,                                         *00517000
                   AUDIT_TIME,                                         *00518000
                   AUDIT_USER,                                         *00519000
                   AUDIT_ORG,                                          *00520000
                   GRACE_EXP_DATE,                                     *00521000
                   TRAN_DATE_01,                                       *00522000
                   TRAN_COUNT_01,                                      *00523000
                   TRAN_AMOUNT_01,                                     *00524000
                   TRAN_DATE_02,                                       *00525000
                   TRAN_COUNT_02,                                      *00526000
                   TRAN_AMOUNT_02,                                     *00527000
                   TRAN_DATE_03,                                       *00528000
                   TRAN_COUNT_03,                                      *00529000
                   TRAN_AMOUNT_03,                                     *00530000
                   TRAN_DATE_04,                                       *00531000
                   TRAN_COUNT_04,                                      *00532000
                   TRAN_AMOUNT_04,                                     *00533000
                   TRAN_DATE_05,                                       *00534000
                   TRAN_COUNT_05,                                      *00535000
                   TRAN_AMOUNT_05,                                     *00536000
                   TRAN_DATE_06,                                       *00537000
                   TRAN_COUNT_06,                                      *00538000
                   TRAN_AMOUNT_06,                                     *00539000
                   TRAN_DATE_07,                                       *00540000
                   TRAN_COUNT_07,                                      *00541000
                   TRAN_AMOUNT_07,                                     *00542000
                   TRAN_DATE_08,                                       *00543000
                   TRAN_COUNT_08,                                      *00544000
                   TRAN_AMOUNT_08,                                     *00545000
                   TRAN_DATE_09,                                       *00546000
                   TRAN_COUNT_09,                                      *00547000
                   TRAN_AMOUNT_09,                                     *00548000
                   TRAN_DATE_10,                                       *00549000
                   TRAN_COUNT_10,                                      *00550000
                   TRAN_AMOUNT_10,                                     *00551000
                   TRAN_DATE_11,                                       *00552000
                   TRAN_COUNT_11,                                      *00553000
                   TRAN_AMOUNT_11,                                     *00554000
                   TRAN_DATE_12,                                       *00555000
                   TRAN_COUNT_12,                                      *00556000
                   TRAN_AMOUNT_12,                                     *00557000
                   RSV_AREA                                            *00558000
                 FROM SAL                                              *00559000
                 WHERE                                                 *00560000
                   INST_NBR = :INST AND                                *00561000
                   PROD_CODE >=                                        *00562000
                     :PRDCDE                                           *00563000
                 ORDER BY PROD_CODE ASC,                               *00564000
                   ACCT_NBR ASC,                                       *00565000
                   MODEL ASC                                           *00566000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00567000
         EXEC  SQL OPEN SALGE003                                        00568000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00569000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00570000
         BR    14                      RETURN TO CALLER                 00571000
         LTORG                                                          00572000
*                                                                       00573000
SELGE004 DS    0H                                                       00574000
         USING SELGE004,12             ESTABLISH BASE REGISTER          00575000
         B     *+6                     BRANCH AROUND ADCON              00576000
BASGE004 DC    AL2(4096)                                                00577000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00578000
         AH    3,BASGE004              ADD 4K                           00579000
         EXEC  SQL DECLARE SALGE004 CURSOR                             *00580000
               WITH ROWSET POSITIONING                                 *00581000
               FOR SELECT                                              *00582000
                   INST_NBR,                                           *00583000
                   PROD_CODE,                                          *00584000
                   ACCT_NBR,                                           *00585000
                   MODEL,                                              *00586000
                   AUDIT_DATE,                                         *00587000
                   AUDIT_TIME,                                         *00588000
                   AUDIT_USER,                                         *00589000
                   AUDIT_ORG,                                          *00590000
                   GRACE_EXP_DATE,                                     *00591000
                   TRAN_DATE_01,                                       *00592000
                   TRAN_COUNT_01,                                      *00593000
                   TRAN_AMOUNT_01,                                     *00594000
                   TRAN_DATE_02,                                       *00595000
                   TRAN_COUNT_02,                                      *00596000
                   TRAN_AMOUNT_02,                                     *00597000
                   TRAN_DATE_03,                                       *00598000
                   TRAN_COUNT_03,                                      *00599000
                   TRAN_AMOUNT_03,                                     *00600000
                   TRAN_DATE_04,                                       *00601000
                   TRAN_COUNT_04,                                      *00602000
                   TRAN_AMOUNT_04,                                     *00603000
                   TRAN_DATE_05,                                       *00604000
                   TRAN_COUNT_05,                                      *00605000
                   TRAN_AMOUNT_05,                                     *00606000
                   TRAN_DATE_06,                                       *00607000
                   TRAN_COUNT_06,                                      *00608000
                   TRAN_AMOUNT_06,                                     *00609000
                   TRAN_DATE_07,                                       *00610000
                   TRAN_COUNT_07,                                      *00611000
                   TRAN_AMOUNT_07,                                     *00612000
                   TRAN_DATE_08,                                       *00613000
                   TRAN_COUNT_08,                                      *00614000
                   TRAN_AMOUNT_08,                                     *00615000
                   TRAN_DATE_09,                                       *00616000
                   TRAN_COUNT_09,                                      *00617000
                   TRAN_AMOUNT_09,                                     *00618000
                   TRAN_DATE_10,                                       *00619000
                   TRAN_COUNT_10,                                      *00620000
                   TRAN_AMOUNT_10,                                     *00621000
                   TRAN_DATE_11,                                       *00622000
                   TRAN_COUNT_11,                                      *00623000
                   TRAN_AMOUNT_11,                                     *00624000
                   TRAN_DATE_12,                                       *00625000
                   TRAN_COUNT_12,                                      *00626000
                   TRAN_AMOUNT_12,                                     *00627000
                   RSV_AREA                                            *00628000
                 FROM SAL                                              *00629000
                 WHERE                                                 *00630000
                   INST_NBR >=                                         *00631000
                     :INST                                             *00632000
                 ORDER BY INST_NBR ASC,                                *00633000
                   PROD_CODE ASC,                                      *00634000
                   ACCT_NBR ASC,                                       *00635000
                   MODEL ASC                                           *00636000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00637000
         EXEC  SQL OPEN SALGE004                                        00638000
         MVC   SQWCSRCA,=A(CLSGE004)   SET CURSOR CLOSE ROUTINE ADDRESS 00639000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00640000
         BR    14                      RETURN TO CALLER                 00641000
         LTORG                                                          00642000
*                                                                       00643000
**********************************************************************  00644000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00645000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00646000
**********************************************************************  00647000
*                                                                       00648000
NXTXC0   DS    0H                                                       00649000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00650000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00651000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00652000
         BALR  14,15                   MOVE REQUESTED DATA              00653000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00654000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00655000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00656000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00657000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00658000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00659000
NXTXC0P  DC    A(0)                                                     00660000
         DC    A(NXTGT002)                                              00661000
         DC    A(NXTGT003)                                              00662000
         DC    A(NXTGT004)                                              00663000
         DC    A(NXTGT099)                                              00664000
         DC    A(NXTGT003)                                              00665000
         DC    A(NXTGT004)                                              00666000
         DC    A(NXTGT099)                                              00667000
         DC    A(NXTGT004)                                              00668000
         DC    A(NXTGT099)                                              00669000
         DC    A(NXTGT099)                                              00670000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00671000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00672000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00673000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00674000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00675000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00676000
         BR    14                      RETURN TO SQI                    00677000
         LTORG                                                          00678000
*                                                                       00679000
NXTGT002 DS    0H                                                       00680000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00681000
         B     *+6                     BRANCH AROUND ADCON              00682000
BASGT002 DC    AL2(4096)                                                00683000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00684000
         AH    3,BASGT002              ADD 4K                           00685000
         EXEC  SQL DECLARE SALGT002 CURSOR                             *00686000
               WITH ROWSET POSITIONING                                 *00687000
               FOR SELECT                                              *00688000
                   INST_NBR,                                           *00689000
                   PROD_CODE,                                          *00690000
                   ACCT_NBR,                                           *00691000
                   MODEL,                                              *00692000
                   AUDIT_DATE,                                         *00693000
                   AUDIT_TIME,                                         *00694000
                   AUDIT_USER,                                         *00695000
                   AUDIT_ORG,                                          *00696000
                   GRACE_EXP_DATE,                                     *00697000
                   TRAN_DATE_01,                                       *00698000
                   TRAN_COUNT_01,                                      *00699000
                   TRAN_AMOUNT_01,                                     *00700000
                   TRAN_DATE_02,                                       *00701000
                   TRAN_COUNT_02,                                      *00702000
                   TRAN_AMOUNT_02,                                     *00703000
                   TRAN_DATE_03,                                       *00704000
                   TRAN_COUNT_03,                                      *00705000
                   TRAN_AMOUNT_03,                                     *00706000
                   TRAN_DATE_04,                                       *00707000
                   TRAN_COUNT_04,                                      *00708000
                   TRAN_AMOUNT_04,                                     *00709000
                   TRAN_DATE_05,                                       *00710000
                   TRAN_COUNT_05,                                      *00711000
                   TRAN_AMOUNT_05,                                     *00712000
                   TRAN_DATE_06,                                       *00713000
                   TRAN_COUNT_06,                                      *00714000
                   TRAN_AMOUNT_06,                                     *00715000
                   TRAN_DATE_07,                                       *00716000
                   TRAN_COUNT_07,                                      *00717000
                   TRAN_AMOUNT_07,                                     *00718000
                   TRAN_DATE_08,                                       *00719000
                   TRAN_COUNT_08,                                      *00720000
                   TRAN_AMOUNT_08,                                     *00721000
                   TRAN_DATE_09,                                       *00722000
                   TRAN_COUNT_09,                                      *00723000
                   TRAN_AMOUNT_09,                                     *00724000
                   TRAN_DATE_10,                                       *00725000
                   TRAN_COUNT_10,                                      *00726000
                   TRAN_AMOUNT_10,                                     *00727000
                   TRAN_DATE_11,                                       *00728000
                   TRAN_COUNT_11,                                      *00729000
                   TRAN_AMOUNT_11,                                     *00730000
                   TRAN_DATE_12,                                       *00731000
                   TRAN_COUNT_12,                                      *00732000
                   TRAN_AMOUNT_12,                                     *00733000
                   RSV_AREA                                            *00734000
                 FROM SAL                                              *00735000
                 WHERE                                                 *00736000
                   INST_NBR = :INST AND                                *00737000
                   PROD_CODE = :PRDCDE AND                             *00738000
                   ACCT_NBR >                                          *00739000
                     :ACCTNBR                                          *00740000
                 ORDER BY ACCT_NBR ASC,                                *00741000
                   MODEL ASC                                           *00742000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00743000
         EXEC  SQL OPEN SALGT002                                        00744000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00745000
         BNZ   *+14                    NO - RETURN ERROR                00746000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00747000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00748000
         BR    12                      RETURN TO FETCH ROUTINE          00749000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00750000
         BR    14                      RETURN TO CALLER                 00751000
         LTORG                                                          00752000
*                                                                       00753000
NXTGT003 DS    0H                                                       00754000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00755000
         B     *+6                     BRANCH AROUND ADCON              00756000
BASGT003 DC    AL2(4096)                                                00757000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00758000
         AH    3,BASGT003              ADD 4K                           00759000
         EXEC  SQL DECLARE SALGT003 CURSOR                             *00760000
               WITH ROWSET POSITIONING                                 *00761000
               FOR SELECT                                              *00762000
                   INST_NBR,                                           *00763000
                   PROD_CODE,                                          *00764000
                   ACCT_NBR,                                           *00765000
                   MODEL,                                              *00766000
                   AUDIT_DATE,                                         *00767000
                   AUDIT_TIME,                                         *00768000
                   AUDIT_USER,                                         *00769000
                   AUDIT_ORG,                                          *00770000
                   GRACE_EXP_DATE,                                     *00771000
                   TRAN_DATE_01,                                       *00772000
                   TRAN_COUNT_01,                                      *00773000
                   TRAN_AMOUNT_01,                                     *00774000
                   TRAN_DATE_02,                                       *00775000
                   TRAN_COUNT_02,                                      *00776000
                   TRAN_AMOUNT_02,                                     *00777000
                   TRAN_DATE_03,                                       *00778000
                   TRAN_COUNT_03,                                      *00779000
                   TRAN_AMOUNT_03,                                     *00780000
                   TRAN_DATE_04,                                       *00781000
                   TRAN_COUNT_04,                                      *00782000
                   TRAN_AMOUNT_04,                                     *00783000
                   TRAN_DATE_05,                                       *00784000
                   TRAN_COUNT_05,                                      *00785000
                   TRAN_AMOUNT_05,                                     *00786000
                   TRAN_DATE_06,                                       *00787000
                   TRAN_COUNT_06,                                      *00788000
                   TRAN_AMOUNT_06,                                     *00789000
                   TRAN_DATE_07,                                       *00790000
                   TRAN_COUNT_07,                                      *00791000
                   TRAN_AMOUNT_07,                                     *00792000
                   TRAN_DATE_08,                                       *00793000
                   TRAN_COUNT_08,                                      *00794000
                   TRAN_AMOUNT_08,                                     *00795000
                   TRAN_DATE_09,                                       *00796000
                   TRAN_COUNT_09,                                      *00797000
                   TRAN_AMOUNT_09,                                     *00798000
                   TRAN_DATE_10,                                       *00799000
                   TRAN_COUNT_10,                                      *00800000
                   TRAN_AMOUNT_10,                                     *00801000
                   TRAN_DATE_11,                                       *00802000
                   TRAN_COUNT_11,                                      *00803000
                   TRAN_AMOUNT_11,                                     *00804000
                   TRAN_DATE_12,                                       *00805000
                   TRAN_COUNT_12,                                      *00806000
                   TRAN_AMOUNT_12,                                     *00807000
                   RSV_AREA                                            *00808000
                 FROM SAL                                              *00809000
                 WHERE                                                 *00810000
                   INST_NBR = :INST AND                                *00811000
                   PROD_CODE >                                         *00812000
                     :PRDCDE                                           *00813000
                 ORDER BY PROD_CODE ASC,                               *00814000
                   ACCT_NBR ASC,                                       *00815000
                   MODEL ASC                                           *00816000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00817000
         EXEC  SQL OPEN SALGT003                                        00818000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00819000
         BNZ   *+14                    NO - RETURN ERROR                00820000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00821000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00822000
         BR    12                      RETURN TO FETCH ROUTINE          00823000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00824000
         BR    14                      RETURN TO CALLER                 00825000
         LTORG                                                          00826000
*                                                                       00827000
NXTGT004 DS    0H                                                       00828000
         USING NXTGT004,12             ESTABLISH BASE REGISTER          00829000
         B     *+6                     BRANCH AROUND ADCON              00830000
BASGT004 DC    AL2(4096)                                                00831000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00832000
         AH    3,BASGT004              ADD 4K                           00833000
         EXEC  SQL DECLARE SALGT004 CURSOR                             *00834000
               WITH ROWSET POSITIONING                                 *00835000
               FOR SELECT                                              *00836000
                   INST_NBR,                                           *00837000
                   PROD_CODE,                                          *00838000
                   ACCT_NBR,                                           *00839000
                   MODEL,                                              *00840000
                   AUDIT_DATE,                                         *00841000
                   AUDIT_TIME,                                         *00842000
                   AUDIT_USER,                                         *00843000
                   AUDIT_ORG,                                          *00844000
                   GRACE_EXP_DATE,                                     *00845000
                   TRAN_DATE_01,                                       *00846000
                   TRAN_COUNT_01,                                      *00847000
                   TRAN_AMOUNT_01,                                     *00848000
                   TRAN_DATE_02,                                       *00849000
                   TRAN_COUNT_02,                                      *00850000
                   TRAN_AMOUNT_02,                                     *00851000
                   TRAN_DATE_03,                                       *00852000
                   TRAN_COUNT_03,                                      *00853000
                   TRAN_AMOUNT_03,                                     *00854000
                   TRAN_DATE_04,                                       *00855000
                   TRAN_COUNT_04,                                      *00856000
                   TRAN_AMOUNT_04,                                     *00857000
                   TRAN_DATE_05,                                       *00858000
                   TRAN_COUNT_05,                                      *00859000
                   TRAN_AMOUNT_05,                                     *00860000
                   TRAN_DATE_06,                                       *00861000
                   TRAN_COUNT_06,                                      *00862000
                   TRAN_AMOUNT_06,                                     *00863000
                   TRAN_DATE_07,                                       *00864000
                   TRAN_COUNT_07,                                      *00865000
                   TRAN_AMOUNT_07,                                     *00866000
                   TRAN_DATE_08,                                       *00867000
                   TRAN_COUNT_08,                                      *00868000
                   TRAN_AMOUNT_08,                                     *00869000
                   TRAN_DATE_09,                                       *00870000
                   TRAN_COUNT_09,                                      *00871000
                   TRAN_AMOUNT_09,                                     *00872000
                   TRAN_DATE_10,                                       *00873000
                   TRAN_COUNT_10,                                      *00874000
                   TRAN_AMOUNT_10,                                     *00875000
                   TRAN_DATE_11,                                       *00876000
                   TRAN_COUNT_11,                                      *00877000
                   TRAN_AMOUNT_11,                                     *00878000
                   TRAN_DATE_12,                                       *00879000
                   TRAN_COUNT_12,                                      *00880000
                   TRAN_AMOUNT_12,                                     *00881000
                   RSV_AREA                                            *00882000
                 FROM SAL                                              *00883000
                 WHERE                                                 *00884000
                   INST_NBR >                                          *00885000
                     :INST                                             *00886000
                 ORDER BY INST_NBR ASC,                                *00887000
                   PROD_CODE ASC,                                      *00888000
                   ACCT_NBR ASC,                                       *00889000
                   MODEL ASC                                           *00890000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00891000
         EXEC  SQL OPEN SALGT004                                        00892000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00893000
         BNZ   *+14                    NO - RETURN ERROR                00894000
         MVC   SQWCSRCA,=A(CLSGT004)   SET CURSOR CLOSE ROUTINE ADDRESS 00895000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00896000
         BR    12                      RETURN TO FETCH ROUTINE          00897000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00898000
         BR    14                      RETURN TO CALLER                 00899000
         LTORG                                                          00900000
*                                                                       00901000
**********************************************************************  00902000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00903000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00904000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00905000
*     RETRIEVE THE ACTUAL ROW.                                          00906000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00907000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00908000
**********************************************************************  00909000
*                                                                       00910000
FETDC0   DS    0H                                                       00911000
         USING FETDC0,12               ESTABLISH BASE REGISTER          00912000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       00913000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00914000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       00915000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00916000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    00917000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00918000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00919000
FETDC0P  DC    A(FETGE001)                                              00920000
         DC    A(FETGT002)                                              00921000
         DC    A(FETGT003)                                              00922000
         DC    A(FETGT004)                                              00923000
         DC    A(FETGE002)                                              00924000
         DC    A(FETGT003)                                              00925000
         DC    A(FETGT004)                                              00926000
         DC    A(FETGE003)                                              00927000
         DC    A(FETGT004)                                              00928000
         DC    A(FETGE004)                                              00929000
         DC    A(0)                                                     00930000
         LTORG                                                          00931000
*                                                                       00932000
**********************************************************************  00933000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00934000
* THE PRIMARY KEY:                                                      00935000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00936000
*     VERBS.                                                            00937000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00938000
*     RETRIEVE THE ACTUAL ROW.                                          00939000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00940000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00941000
*     WILL BE THRU THE UPDATE CURSOR.                                   00942000
**********************************************************************  00943000
*                                                                       00944000
FETKC0   DS    0H                                                       00945000
         USING FETKC0,12               ESTABLISH BASE REGISTER          00946000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       00947000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00948000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           00949000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00950000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    00951000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00952000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00953000
FETKC0P  DC    A(FETGE001)                                              00954000
         DC    A(FETGT002)                                              00955000
         DC    A(FETGT003)                                              00956000
         DC    A(FETGT004)                                              00957000
         DC    A(FETGE002)                                              00958000
         DC    A(FETGT003)                                              00959000
         DC    A(FETGT004)                                              00960000
         DC    A(FETGE003)                                              00961000
         DC    A(FETGT004)                                              00962000
         DC    A(FETGE004)                                              00963000
         DC    A(0)                                                     00964000
         LTORG                                                          00965000
*                                                                       00966000
FETGE001 DS    0H                                                       00967000
         USING FETGE001,12             ESTABLISH BASE REGISTER          00968000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00969000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00970000
         BALR  14,15                   MOVE REQUESTED DATA              00971000
         EXEC  SQL FETCH NEXT ROWSET FROM SALGE001                     *00972000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00973000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00974000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00975000
         BALR  14,15                   MOVE REQUESTED DATA              00976000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00977000
         BR    14                      RETURN TO CALLER                 00978000
         LTORG                                                          00979000
*                                                                       00980000
FETGE002 DS    0H                                                       00981000
         USING FETGE002,12             ESTABLISH BASE REGISTER          00982000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00983000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00984000
         BALR  14,15                   MOVE REQUESTED DATA              00985000
         EXEC  SQL FETCH NEXT ROWSET FROM SALGE002                     *00986000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00987000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00988000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00989000
         BALR  14,15                   MOVE REQUESTED DATA              00990000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00991000
         BR    14                      RETURN TO CALLER                 00992000
         LTORG                                                          00993000
*                                                                       00994000
FETGE003 DS    0H                                                       00995000
         USING FETGE003,12             ESTABLISH BASE REGISTER          00996000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00997000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00998000
         BALR  14,15                   MOVE REQUESTED DATA              00999000
         EXEC  SQL FETCH NEXT ROWSET FROM SALGE003                     *01000000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01001000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01002000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01003000
         BALR  14,15                   MOVE REQUESTED DATA              01004000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01005000
         BR    14                      RETURN TO CALLER                 01006000
         LTORG                                                          01007000
*                                                                       01008000
FETGE004 DS    0H                                                       01009000
         USING FETGE004,12             ESTABLISH BASE REGISTER          01010000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01011000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01012000
         BALR  14,15                   MOVE REQUESTED DATA              01013000
         EXEC  SQL FETCH NEXT ROWSET FROM SALGE004                     *01014000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01015000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01016000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01017000
         BALR  14,15                   MOVE REQUESTED DATA              01018000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01019000
         BR    14                      RETURN TO CALLER                 01020000
         LTORG                                                          01021000
*                                                                       01022000
FETGT002 DS    0H                                                       01023000
         USING FETGT002,12             ESTABLISH BASE REGISTER          01024000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01025000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01026000
         BALR  14,15                   MOVE REQUESTED DATA              01027000
         EXEC  SQL FETCH NEXT ROWSET FROM SALGT002                     *01028000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01029000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01030000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01031000
         BALR  14,15                   MOVE REQUESTED DATA              01032000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01033000
         BR    14                      RETURN TO CALLER                 01034000
         LTORG                                                          01035000
*                                                                       01036000
FETGT003 DS    0H                                                       01037000
         USING FETGT003,12             ESTABLISH BASE REGISTER          01038000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01039000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01040000
         BALR  14,15                   MOVE REQUESTED DATA              01041000
         EXEC  SQL FETCH NEXT ROWSET FROM SALGT003                     *01042000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01043000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01044000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01045000
         BALR  14,15                   MOVE REQUESTED DATA              01046000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01047000
         BR    14                      RETURN TO CALLER                 01048000
         LTORG                                                          01049000
*                                                                       01050000
FETGT004 DS    0H                                                       01051000
         USING FETGT004,12             ESTABLISH BASE REGISTER          01052000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01053000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01054000
         BALR  14,15                   MOVE REQUESTED DATA              01055000
         EXEC  SQL FETCH NEXT ROWSET FROM SALGT004                     *01056000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01057000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01058000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01059000
         BALR  14,15                   MOVE REQUESTED DATA              01060000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01061000
         BR    14                      RETURN TO CALLER                 01062000
         LTORG                                                          01063000
*                                                                       01064000
**********************************************************************  01065000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01066000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01067000
*     AND GET-NEXT-LOCK VERBS.                                          01068000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01069000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01070000
**********************************************************************  01071000
*                                                                       01072000
CLSXC0   DS    0H                                                       01073000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          01074000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 01075000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  01076000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       01077000
         LTORG                                                          01078000
*                                                                       01079000
CLSGE001 DS    0H                                                       01080000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          01081000
         EXEC  SQL CLOSE SALGE001                                       01082000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01083000
         BR    14                      RETURN TO CALLER                 01084000
         LTORG                                                          01085000
*                                                                       01086000
CLSGE002 DS    0H                                                       01087000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          01088000
         EXEC  SQL CLOSE SALGE002                                       01089000
         L     14,SQW@RET                                               01090000
         BR    14                                                       01091000
         LTORG                                                          01092000
*                                                                       01093000
CLSGE003 DS    0H                                                       01094000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          01095000
         EXEC  SQL CLOSE SALGE003                                       01096000
         L     14,SQW@RET                                               01097000
         BR    14                                                       01098000
         LTORG                                                          01099000
*                                                                       01100000
CLSGE004 DS    0H                                                       01101000
         USING CLSGE004,12             ESTABLISH BASE REGISTER          01102000
         EXEC  SQL CLOSE SALGE004                                       01103000
         L     14,SQW@RET                                               01104000
         BR    14                                                       01105000
         LTORG                                                          01106000
*                                                                       01107000
CLSGT002 DS    0H                                                       01108000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          01109000
         EXEC  SQL CLOSE SALGT002                                       01110000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01111000
         BR    14                      RETURN TO CALLER                 01112000
         LTORG                                                          01113000
*                                                                       01114000
CLSGT003 DS    0H                                                       01115000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          01116000
         EXEC  SQL CLOSE SALGT003                                       01117000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01118000
         BR    14                      RETURN TO CALLER                 01119000
         LTORG                                                          01120000
*                                                                       01121000
CLSGT004 DS    0H                                                       01122000
         USING CLSGT004,12             ESTABLISH BASE REGISTER          01123000
         EXEC  SQL CLOSE SALGT004                                       01124000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01125000
         BR    14                      RETURN TO CALLER                 01126000
         LTORG                                                          01127000
*                                                                       01128000
**********************************************************************  01129000
* ALTERNATE KEY 1 NOT DEFINED                                           01130000
**********************************************************************  01131000
*                                                                       01132000
SELIN1   DS    0H                                                       01133000
SELKY1   DS    0H                                                       01134000
SELXC1   DS    0H                                                       01135000
FETDC1   DS    0H                                                       01136000
FETKC1   DS    0H                                                       01137000
CLSXC1   DS    0H                                                       01138000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 01139000
*                                                                       01140000
**********************************************************************  01141000
* ALTERNATE KEY 2 NOT DEFINED                                           01142000
**********************************************************************  01143000
*                                                                       01144000
SELIN2   DS    0H                                                       01145000
SELKY2   DS    0H                                                       01146000
SELXC2   DS    0H                                                       01147000
FETDC2   DS    0H                                                       01148000
FETKC2   DS    0H                                                       01149000
CLSXC2   DS    0H                                                       01150000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 01151000
*                                                                       01152000
**********************************************************************  01153000
* ALTERNATE KEY 3 NOT DEFINED                                           01154000
**********************************************************************  01155000
*                                                                       01156000
SELIN3   DS    0H                                                       01157000
SELKY3   DS    0H                                                       01158000
SELXC3   DS    0H                                                       01159000
FETDC3   DS    0H                                                       01160000
FETKC3   DS    0H                                                       01161000
CLSXC3   DS    0H                                                       01162000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 01163000
*                                                                       01164000
         DS    0H                      END OF SQL STATEMENTS            01165000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01166000
*                                                                       01167000
**********************************************************************  01168000
* DUMMY ENTRY POINT DSNHLI                                              01169000
**********************************************************************  01170000
*                                                                       01171000
         ENTRY DSNHLI                                                   01172000
DSNHLI   DS    0H                                                       01173000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01174000
         BR    15                      BRANCH TO ATTACH FACILITY        01175000
*                                                                       01176000
**********************************************************************  01177000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01178000
**********************************************************************  01179000
*                                                                       01180000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       01181000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      01182000
* OR:                                                                   01183000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      01184000
* WHERE:                                                                01185000
*   RRRR = RECORD AREA OFFSET                                           01186000
*   VVVV = HOST VARIABLE AREA OFFSET                                    01187000
*   LLLL = HALFWORD LENGTH TO MOVE                                      01188000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       01189000
*   KK   = KEY FIELD MASK:                                              01190000
*            80 = KEY 0 FIELD                                           01191000
*            40 = KEY 1 FIELD                                           01192000
*            20 = KEY 2 FIELD                                           01193000
*            10 = KEY 3 FIELD                                           01194000
*   DD   = DATA FIELD MASK:                                             01195000
*            80 = RECORD FIELD IS PACKED                                01196000
*            40 = HOST VARIABLE IS PACKED                               01197000
*            20 = NULLABLE FIELD                                        01198000
*            01 = DATE FIELD                                            01199000
*            02 = TIME FIELD                                            01200000
*                                                                       01201000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 01202000
         DC    H'0000',H'0000',H'0038',X'80',X'00'                      01203000
         DC    H'0038',H'0038',H'0259',X'00',X'00'                      01204000
         DC    8X'FF'                                                   01205000
*                                                                       01206000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               01207000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  01208000
* OR:                                                                   01209000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  01210000
* WHERE:                                                                01211000
*   RRRR = RECORD AREA OFFSET                                           01212000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     01213000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      01214000
*   TTTT = SQLDA DATA TYPE:                                             01215000
*            452 = CHAR       453 = CHAR NULLABLE                       01216000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    01217000
*            496 = INTEGER    497 = INTEGER NULLABLE                    01218000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   01219000
*                                                                       01220000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      01221000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 01222000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       01223000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    01224000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       01225000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       01226000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       01227000
         DC    AL2(00297)              SUMMATION OF ALL COLUMN LENGTHS  01228000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     01229000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       01230000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       01231000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       01232000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      01233000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        01234000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        01235000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        01236000
CONVDATA DS    0H                                                       01237000
         DC    H'0000',H'0004',H'452'  INST_NBR                         01238000
         DC    H'0004',H'0006',H'452'  PROD_CODE                        01239000
         DC    H'0010',H'0018',H'452'  ACCT_NBR                         01240000
         DC    H'0028',H'0010',H'452'  MODEL                            01241000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   01242000
         DC    H'0038',X'0900',H'484'  AUDIT_DATE                       01243000
         DC    H'0043',X'0900',H'484'  AUDIT_TIME                       01244000
         DC    H'0048',H'0008',H'452'  AUDIT_USER                       01245000
         DC    H'0056',H'0006',H'452'  AUDIT_ORG                        01246000
         DC    H'0062',X'0900',H'484'  GRACE_EXP_DATE                   01247000
         DC    H'0067',X'0900',H'484'  TRAN_DATE_01                     01248000
         DC    H'0072',X'0500',H'484'  TRAN_COUNT_01                    01249000
         DC    H'0075',X'0D02',H'484'  TRAN_AMOUNT_01                   01250000
         DC    H'0082',X'0900',H'484'  TRAN_DATE_02                     01251000
         DC    H'0087',X'0500',H'484'  TRAN_COUNT_02                    01252000
         DC    H'0090',X'0D02',H'484'  TRAN_AMOUNT_02                   01253000
         DC    H'0097',X'0900',H'484'  TRAN_DATE_03                     01254000
         DC    H'0102',X'0500',H'484'  TRAN_COUNT_03                    01255000
         DC    H'0105',X'0D02',H'484'  TRAN_AMOUNT_03                   01256000
         DC    H'0112',X'0900',H'484'  TRAN_DATE_04                     01257000
         DC    H'0117',X'0500',H'484'  TRAN_COUNT_04                    01258000
         DC    H'0120',X'0D02',H'484'  TRAN_AMOUNT_04                   01259000
         DC    H'0127',X'0900',H'484'  TRAN_DATE_05                     01260000
         DC    H'0132',X'0500',H'484'  TRAN_COUNT_05                    01261000
         DC    H'0135',X'0D02',H'484'  TRAN_AMOUNT_05                   01262000
         DC    H'0142',X'0900',H'484'  TRAN_DATE_06                     01263000
         DC    H'0147',X'0500',H'484'  TRAN_COUNT_06                    01264000
         DC    H'0150',X'0D02',H'484'  TRAN_AMOUNT_06                   01265000
         DC    H'0157',X'0900',H'484'  TRAN_DATE_07                     01266000
         DC    H'0162',X'0500',H'484'  TRAN_COUNT_07                    01267000
         DC    H'0165',X'0D02',H'484'  TRAN_AMOUNT_07                   01268000
         DC    H'0172',X'0900',H'484'  TRAN_DATE_08                     01269000
         DC    H'0177',X'0500',H'484'  TRAN_COUNT_08                    01270000
         DC    H'0180',X'0D02',H'484'  TRAN_AMOUNT_08                   01271000
         DC    H'0187',X'0900',H'484'  TRAN_DATE_09                     01272000
         DC    H'0192',X'0500',H'484'  TRAN_COUNT_09                    01273000
         DC    H'0195',X'0D02',H'484'  TRAN_AMOUNT_09                   01274000
         DC    H'0202',X'0900',H'484'  TRAN_DATE_10                     01275000
         DC    H'0207',X'0500',H'484'  TRAN_COUNT_10                    01276000
         DC    H'0210',X'0D02',H'484'  TRAN_AMOUNT_10                   01277000
         DC    H'0217',X'0900',H'484'  TRAN_DATE_11                     01278000
         DC    H'0222',X'0500',H'484'  TRAN_COUNT_11                    01279000
         DC    H'0225',X'0D02',H'484'  TRAN_AMOUNT_11                   01280000
         DC    H'0232',X'0900',H'484'  TRAN_DATE_12                     01281000
         DC    H'0237',X'0500',H'484'  TRAN_COUNT_12                    01282000
         DC    H'0240',X'0D02',H'484'  TRAN_AMOUNT_12                   01283000
         DC    H'0247',H'0050',H'452'  RSV_AREA                         01284000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       01285000
KY0COLMS EQU   00004                   NUMBER OF PRIMARY KEY COLUMNS    01286000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      01287000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      01288000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      01289000
*                                                                       01290000
         LTORG                                                          01291000
         END                                                            01292000
