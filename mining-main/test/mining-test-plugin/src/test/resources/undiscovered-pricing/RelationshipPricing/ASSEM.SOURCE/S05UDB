**********************************************************************  00001000
*                                                                       00002000
*  S05UDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S05 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
DEMO     DS    CL6                                                      00052000
AUDDATE  DS    PL5'0.'                                                  00053000
AUDTIME  DS    PL5'0.'                                                  00054000
AUDUSER  DS    CL8                                                      00055000
AUDORG   DS    CL6                                                      00056000
KEYWRD1  DS    CL15                                                     00057000
RELCD1   DS    CL2                                                      00058000
VALUE1   DS    CL15                                                     00059000
ANDOR1   DS    CL3                                                      00060000
KEYWRD2  DS    CL15                                                     00061000
RELCD2   DS    CL2                                                      00062000
VALUE2   DS    CL15                                                     00063000
ANDOR2   DS    CL3                                                      00064000
KEYWRD3  DS    CL15                                                     00065000
RELCD3   DS    CL2                                                      00066000
VALUE3   DS    CL15                                                     00067000
ANDOR3   DS    CL3                                                      00068000
KEYWRD4  DS    CL15                                                     00069000
RELCD4   DS    CL2                                                      00070000
VALUE4   DS    CL15                                                     00071000
ANDOR4   DS    CL3                                                      00072000
KEYWRD5  DS    CL15                                                     00073000
RELCD5   DS    CL2                                                      00074000
VALUE5   DS    CL15                                                     00075000
ANDOR5   DS    CL3                                                      00076000
KEYWRD6  DS    CL15                                                     00077000
RELCD6   DS    CL2                                                      00078000
VALUE6   DS    CL15                                                     00079000
ANDOR6   DS    CL3                                                      00080000
KEYWRD7  DS    CL15                                                     00081000
RELCD7   DS    CL2                                                      00082000
VALUE7   DS    CL15                                                     00083000
ANDOR7   DS    CL3                                                      00084000
KEYWRD8  DS    CL15                                                     00085000
RELCD8   DS    CL2                                                      00086000
VALUE8   DS    CL15                                                     00087000
ANDOR8   DS    CL3                                                      00088000
KEYWRD9  DS    CL15                                                     00089000
RELCD9   DS    CL2                                                      00090000
VALUE9   DS    CL15                                                     00091000
ANDOR9   DS    CL3                                                      00092000
KEYWRD10 DS    CL15                                                     00093000
RELCD10  DS    CL2                                                      00094000
VALUE10  DS    CL15                                                     00095000
ANDOR10  DS    CL3                                                      00096000
KEYWRD11 DS    CL15                                                     00097000
RELCD11  DS    CL2                                                      00098000
VALUE11  DS    CL15                                                     00099000
ANDOR11  DS    CL3                                                      00100000
KEYWRD12 DS    CL15                                                     00101000
RELCD12  DS    CL2                                                      00102000
VALUE12  DS    CL15                                                     00103000
ANDOR12  DS    CL3                                                      00104000
KEYWRD13 DS    CL15                                                     00105000
RELCD13  DS    CL2                                                      00106000
VALUE13  DS    CL15                                                     00107000
ANDOR13  DS    CL3                                                      00108000
KEYWRD14 DS    CL15                                                     00109000
RELCD14  DS    CL2                                                      00110000
VALUE14  DS    CL15                                                     00111000
ANDOR14  DS    CL3                                                      00112000
KEYWRD15 DS    CL15                                                     00113000
RELCD15  DS    CL2                                                      00114000
VALUE15  DS    CL15                                                     00115000
ANDOR15  DS    CL3                                                      00116000
*                                                                       00117000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00118000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00119000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00120000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00121000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00122000
         DS    CL97                    RESERVED                         00123000
*                                                                       00124000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00125000
INDVARX  DS    0H                                                       00126000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00127000
*                                                                       00128000
*                                                                       00129000
**********************************************************************  00130000
* PROGRAM TABLE HEADER SECTION:                                         00131000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00132000
**********************************************************************  00133000
*                                                                       00134000
S05UDB   CSECT                         PROGRAM TABLE SECTION            00135000
S05UDB   AMODE ANY                                                      00136000
S05UDB   RMODE ANY                                                      00137000
         DC    CL8'S05UDB  '           PROGRAM ID                       00138000
         DC    CL1' '                                                   00139000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00140000
         DC    CL1' '                                                   00141000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00142000
         DC    CL1' '                                                   00143000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00144000
         DC    5A(0)                   RESERVED                         00145000
         DC    AL2(0)                  RESERVED                         00146000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00147000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00148000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00149000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00150000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00151000
         DC    CL29'WWW.INFOR.COM                '                      00151001
*                                                                       00152000
**********************************************************************  00153000
* STATEMENT TABLE SECTION:                                              00154000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00155000
**********************************************************************  00156000
*                                                                       00157000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00158000
STM#TAB  AMODE ANY                                                      00159000
STM#TAB  RMODE ANY                                                      00160000
         DC    4A(0)                   RDB MODULE VECTORS               00161000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00162000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00163000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00164000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00165000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00166000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00167000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00168000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00169000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00170000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00171000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00172000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00173000
         DC    20A(0)                  RDB MODULE VECTORS               00174000
         DC    A(INSROW)               INSERT STATEMENT                 00175000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00176000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00177000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00178000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00179000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00180000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00181000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00182000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00183000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00184000
         DC    4X'FF'                                                   00185000
*                                                                       00186000
**********************************************************************  00187000
* SQL STATEMENT SECTION:                                                00188000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00189000
*     TO SUPPORT THIS TABLE.                                            00190000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00191000
*     ARE EQUIVALENT.                                                   00192000
**********************************************************************  00193000
*                                                                       00194000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00195000
SQL#STMT AMODE ANY                                                      00196000
SQL#STMT RMODE ANY                                                      00197000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00198000
         USING COM#AREA,11             ADDRESS COMMAREA                 00199000
*                                                                       00200000
**********************************************************************  00201000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00202000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00203000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00204000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00205000
**********************************************************************  00206000
*                                                                       00207000
SELUC0   DS    0H                                                       00208000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00209000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00210000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00211000
         BALR  14,15                   MOVE REQUESTED DATA              00212000
         B     *+6                     BRANCH AROUND ADCON              00213000
BASSEL0  DC    AL2(4096)                                                00214000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00215000
         AH    3,BASSEL0               ADD 4K                           00216000
         EXEC  SQL DECLARE S05UPD0 CURSOR                              *00217000
               FOR SELECT                                              *00218000
                   AUDIT_DATE,                                         *00219000
                   AUDIT_TIME,                                         *00220000
                   AUDIT_USER,                                         *00221000
                   AUDIT_ORG,                                          *00222000
                   KEY_WORD_01,                                        *00223000
                   REL_CODE_01,                                        *00224000
                   VALUE_01,                                           *00225000
                   AND_OR_01,                                          *00226000
                   KEY_WORD_02,                                        *00227000
                   REL_CODE_02,                                        *00228000
                   VALUE_02,                                           *00229000
                   AND_OR_02,                                          *00230000
                   KEY_WORD_03,                                        *00231000
                   REL_CODE_03,                                        *00232000
                   VALUE_03,                                           *00233000
                   AND_OR_03,                                          *00234000
                   KEY_WORD_04,                                        *00235000
                   REL_CODE_04,                                        *00236000
                   VALUE_04,                                           *00237000
                   AND_OR_04,                                          *00238000
                   KEY_WORD_05,                                        *00239000
                   REL_CODE_05,                                        *00240000
                   VALUE_05,                                           *00241000
                   AND_OR_05,                                          *00242000
                   KEY_WORD_06,                                        *00243000
                   REL_CODE_06,                                        *00244000
                   VALUE_06,                                           *00245000
                   AND_OR_06,                                          *00246000
                   KEY_WORD_07,                                        *00247000
                   REL_CODE_07,                                        *00248000
                   VALUE_07,                                           *00249000
                   AND_OR_07,                                          *00250000
                   KEY_WORD_08,                                        *00251000
                   REL_CODE_08,                                        *00252000
                   VALUE_08,                                           *00253000
                   AND_OR_08,                                          *00254000
                   KEY_WORD_09,                                        *00255000
                   REL_CODE_09,                                        *00256000
                   VALUE_09,                                           *00257000
                   AND_OR_09,                                          *00258000
                   KEY_WORD_10,                                        *00259000
                   REL_CODE_10,                                        *00260000
                   VALUE_10,                                           *00261000
                   AND_OR_10,                                          *00262000
                   KEY_WORD_11,                                        *00263000
                   REL_CODE_11,                                        *00264000
                   VALUE_11,                                           *00265000
                   AND_OR_11,                                          *00266000
                   KEY_WORD_12,                                        *00267000
                   REL_CODE_12,                                        *00268000
                   VALUE_12,                                           *00269000
                   AND_OR_12,                                          *00270000
                   KEY_WORD_13,                                        *00271000
                   REL_CODE_13,                                        *00272000
                   VALUE_13,                                           *00273000
                   AND_OR_13,                                          *00274000
                   KEY_WORD_14,                                        *00275000
                   REL_CODE_14,                                        *00276000
                   VALUE_14,                                           *00277000
                   AND_OR_14,                                          *00278000
                   KEY_WORD_15,                                        *00279000
                   REL_CODE_15,                                        *00280000
                   VALUE_15,                                           *00281000
                   AND_OR_15                                           *00282000
                 FROM S05                                              *00283000
                 WHERE                                                 *00284000
                   INST_NBR = :INST AND                                *00285000
                   RECORD_NBR = :RECNBR AND                            *00286000
                   DEMOGR_CODE = :DEMO                                 *00287000
                 FOR UPDATE OF                                         *00288000
                   AUDIT_DATE,                                         *00289000
                   AUDIT_TIME,                                         *00290000
                   AUDIT_USER,                                         *00291000
                   AUDIT_ORG,                                          *00292000
                   KEY_WORD_01,                                        *00293000
                   REL_CODE_01,                                        *00294000
                   VALUE_01,                                           *00295000
                   AND_OR_01,                                          *00296000
                   KEY_WORD_02,                                        *00297000
                   REL_CODE_02,                                        *00298000
                   VALUE_02,                                           *00299000
                   AND_OR_02,                                          *00300000
                   KEY_WORD_03,                                        *00301000
                   REL_CODE_03,                                        *00302000
                   VALUE_03,                                           *00303000
                   AND_OR_03,                                          *00304000
                   KEY_WORD_04,                                        *00305000
                   REL_CODE_04,                                        *00306000
                   VALUE_04,                                           *00307000
                   AND_OR_04,                                          *00308000
                   KEY_WORD_05,                                        *00309000
                   REL_CODE_05,                                        *00310000
                   VALUE_05,                                           *00311000
                   AND_OR_05,                                          *00312000
                   KEY_WORD_06,                                        *00313000
                   REL_CODE_06,                                        *00314000
                   VALUE_06,                                           *00315000
                   AND_OR_06,                                          *00316000
                   KEY_WORD_07,                                        *00317000
                   REL_CODE_07,                                        *00318000
                   VALUE_07,                                           *00319000
                   AND_OR_07,                                          *00320000
                   KEY_WORD_08,                                        *00321000
                   REL_CODE_08,                                        *00322000
                   VALUE_08,                                           *00323000
                   AND_OR_08,                                          *00324000
                   KEY_WORD_09,                                        *00325000
                   REL_CODE_09,                                        *00326000
                   VALUE_09,                                           *00327000
                   AND_OR_09,                                          *00328000
                   KEY_WORD_10,                                        *00329000
                   REL_CODE_10,                                        *00330000
                   VALUE_10,                                           *00331000
                   AND_OR_10,                                          *00332000
                   KEY_WORD_11,                                        *00333000
                   REL_CODE_11,                                        *00334000
                   VALUE_11,                                           *00335000
                   AND_OR_11,                                          *00336000
                   KEY_WORD_12,                                        *00337000
                   REL_CODE_12,                                        *00338000
                   VALUE_12,                                           *00339000
                   AND_OR_12,                                          *00340000
                   KEY_WORD_13,                                        *00341000
                   REL_CODE_13,                                        *00342000
                   VALUE_13,                                           *00343000
                   AND_OR_13,                                          *00344000
                   KEY_WORD_14,                                        *00345000
                   REL_CODE_14,                                        *00346000
                   VALUE_14,                                           *00347000
                   AND_OR_14,                                          *00348000
                   KEY_WORD_15,                                        *00349000
                   REL_CODE_15,                                        *00350000
                   VALUE_15,                                           *00351000
                   AND_OR_15                                           *00352000
                 FETCH FIRST 1 ROW ONLY                                 00353000
         EXEC  SQL OPEN S05UPD0                                         00354000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00355000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00356000
         BR    14                      RETURN TO CALLER                 00357000
         LTORG                                                          00358000
*                                                                       00359000
**********************************************************************  00360000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00361000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00362000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00363000
*     THE ACTUAL ROW.                                                   00364000
**********************************************************************  00365000
*                                                                       00366000
FETUC0   DS    0H                                                       00367000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00368000
         B     *+6                     BRANCH AROUND ADCON              00369000
BASFET0  DC    AL2(4096)                                                00370000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00371000
         AH    3,BASFET0               ADD 4K                           00372000
         EXEC  SQL FETCH S05UPD0                                       *00373000
                 INTO                                                  *00374000
                   :AUDDATE,                                           *00375000
                   :AUDTIME,                                           *00376000
                   :AUDUSER,                                           *00377000
                   :AUDORG,                                            *00378000
                   :KEYWRD1,                                           *00379000
                   :RELCD1,                                            *00380000
                   :VALUE1,                                            *00381000
                   :ANDOR1,                                            *00382000
                   :KEYWRD2,                                           *00383000
                   :RELCD2,                                            *00384000
                   :VALUE2,                                            *00385000
                   :ANDOR2,                                            *00386000
                   :KEYWRD3,                                           *00387000
                   :RELCD3,                                            *00388000
                   :VALUE3,                                            *00389000
                   :ANDOR3,                                            *00390000
                   :KEYWRD4,                                           *00391000
                   :RELCD4,                                            *00392000
                   :VALUE4,                                            *00393000
                   :ANDOR4,                                            *00394000
                   :KEYWRD5,                                           *00395000
                   :RELCD5,                                            *00396000
                   :VALUE5,                                            *00397000
                   :ANDOR5,                                            *00398000
                   :KEYWRD6,                                           *00399000
                   :RELCD6,                                            *00400000
                   :VALUE6,                                            *00401000
                   :ANDOR6,                                            *00402000
                   :KEYWRD7,                                           *00403000
                   :RELCD7,                                            *00404000
                   :VALUE7,                                            *00405000
                   :ANDOR7,                                            *00406000
                   :KEYWRD8,                                           *00407000
                   :RELCD8,                                            *00408000
                   :VALUE8,                                            *00409000
                   :ANDOR8,                                            *00410000
                   :KEYWRD9,                                           *00411000
                   :RELCD9,                                            *00412000
                   :VALUE9,                                            *00413000
                   :ANDOR9,                                            *00414000
                   :KEYWRD10,                                          *00415000
                   :RELCD10,                                           *00416000
                   :VALUE10,                                           *00417000
                   :ANDOR10,                                           *00418000
                   :KEYWRD11,                                          *00419000
                   :RELCD11,                                           *00420000
                   :VALUE11,                                           *00421000
                   :ANDOR11,                                           *00422000
                   :KEYWRD12,                                          *00423000
                   :RELCD12,                                           *00424000
                   :VALUE12,                                           *00425000
                   :ANDOR12,                                           *00426000
                   :KEYWRD13,                                          *00427000
                   :RELCD13,                                           *00428000
                   :VALUE13,                                           *00429000
                   :ANDOR13,                                           *00430000
                   :KEYWRD14,                                          *00431000
                   :RELCD14,                                           *00432000
                   :VALUE14,                                           *00433000
                   :ANDOR14,                                           *00434000
                   :KEYWRD15,                                          *00435000
                   :RELCD15,                                           *00436000
                   :VALUE15,                                           *00437000
                   :ANDOR15                                             00438000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00439000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00440000
         BALR  14,15                   MOVE REQUESTED DATA              00441000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00442000
         BR    14                      RETURN TO CALLER                 00443000
         LTORG                                                          00444000
*                                                                       00445000
**********************************************************************  00446000
* INSERT STATEMENT:                                                     00447000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00448000
**********************************************************************  00449000
*                                                                       00450000
INSROW   DS    0H                                                       00451000
         USING INSROW,12               ESTABLISH BASE REGISTER          00452000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00453000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00454000
         BALR  14,15                   MOVE REQUESTED DATA              00455000
         B     *+6                     BRANCH AROUND ADCON              00456000
BASINS0  DC    AL2(4096)                                                00457000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00458000
         AH    3,BASINS0               ADD 4K                           00459000
         EXEC  SQL INSERT INTO S05                                     *00460000
                   (                                                   *00461000
                   INST_NBR,                                           *00462000
                   RECORD_NBR,                                         *00463000
                   DEMOGR_CODE,                                        *00464000
                   AUDIT_DATE,                                         *00465000
                   AUDIT_TIME,                                         *00466000
                   AUDIT_USER,                                         *00467000
                   AUDIT_ORG,                                          *00468000
                   KEY_WORD_01,                                        *00469000
                   REL_CODE_01,                                        *00470000
                   VALUE_01,                                           *00471000
                   AND_OR_01,                                          *00472000
                   KEY_WORD_02,                                        *00473000
                   REL_CODE_02,                                        *00474000
                   VALUE_02,                                           *00475000
                   AND_OR_02,                                          *00476000
                   KEY_WORD_03,                                        *00477000
                   REL_CODE_03,                                        *00478000
                   VALUE_03,                                           *00479000
                   AND_OR_03,                                          *00480000
                   KEY_WORD_04,                                        *00481000
                   REL_CODE_04,                                        *00482000
                   VALUE_04,                                           *00483000
                   AND_OR_04,                                          *00484000
                   KEY_WORD_05,                                        *00485000
                   REL_CODE_05,                                        *00486000
                   VALUE_05,                                           *00487000
                   AND_OR_05,                                          *00488000
                   KEY_WORD_06,                                        *00489000
                   REL_CODE_06,                                        *00490000
                   VALUE_06,                                           *00491000
                   AND_OR_06,                                          *00492000
                   KEY_WORD_07,                                        *00493000
                   REL_CODE_07,                                        *00494000
                   VALUE_07,                                           *00495000
                   AND_OR_07,                                          *00496000
                   KEY_WORD_08,                                        *00497000
                   REL_CODE_08,                                        *00498000
                   VALUE_08,                                           *00499000
                   AND_OR_08,                                          *00500000
                   KEY_WORD_09,                                        *00501000
                   REL_CODE_09,                                        *00502000
                   VALUE_09,                                           *00503000
                   AND_OR_09,                                          *00504000
                   KEY_WORD_10,                                        *00505000
                   REL_CODE_10,                                        *00506000
                   VALUE_10,                                           *00507000
                   AND_OR_10,                                          *00508000
                   KEY_WORD_11,                                        *00509000
                   REL_CODE_11,                                        *00510000
                   VALUE_11,                                           *00511000
                   AND_OR_11,                                          *00512000
                   KEY_WORD_12,                                        *00513000
                   REL_CODE_12,                                        *00514000
                   VALUE_12,                                           *00515000
                   AND_OR_12,                                          *00516000
                   KEY_WORD_13,                                        *00517000
                   REL_CODE_13,                                        *00518000
                   VALUE_13,                                           *00519000
                   AND_OR_13,                                          *00520000
                   KEY_WORD_14,                                        *00521000
                   REL_CODE_14,                                        *00522000
                   VALUE_14,                                           *00523000
                   AND_OR_14,                                          *00524000
                   KEY_WORD_15,                                        *00525000
                   REL_CODE_15,                                        *00526000
                   VALUE_15,                                           *00527000
                   AND_OR_15                                           *00528000
                   )                                                   *00529000
                  VALUES                                               *00530000
                   (                                                   *00531000
                   :INST,                                              *00532000
                   :RECNBR,                                            *00533000
                   :DEMO,                                              *00534000
                   :AUDDATE,                                           *00535000
                   :AUDTIME,                                           *00536000
                   :AUDUSER,                                           *00537000
                   :AUDORG,                                            *00538000
                   :KEYWRD1,                                           *00539000
                   :RELCD1,                                            *00540000
                   :VALUE1,                                            *00541000
                   :ANDOR1,                                            *00542000
                   :KEYWRD2,                                           *00543000
                   :RELCD2,                                            *00544000
                   :VALUE2,                                            *00545000
                   :ANDOR2,                                            *00546000
                   :KEYWRD3,                                           *00547000
                   :RELCD3,                                            *00548000
                   :VALUE3,                                            *00549000
                   :ANDOR3,                                            *00550000
                   :KEYWRD4,                                           *00551000
                   :RELCD4,                                            *00552000
                   :VALUE4,                                            *00553000
                   :ANDOR4,                                            *00554000
                   :KEYWRD5,                                           *00555000
                   :RELCD5,                                            *00556000
                   :VALUE5,                                            *00557000
                   :ANDOR5,                                            *00558000
                   :KEYWRD6,                                           *00559000
                   :RELCD6,                                            *00560000
                   :VALUE6,                                            *00561000
                   :ANDOR6,                                            *00562000
                   :KEYWRD7,                                           *00563000
                   :RELCD7,                                            *00564000
                   :VALUE7,                                            *00565000
                   :ANDOR7,                                            *00566000
                   :KEYWRD8,                                           *00567000
                   :RELCD8,                                            *00568000
                   :VALUE8,                                            *00569000
                   :ANDOR8,                                            *00570000
                   :KEYWRD9,                                           *00571000
                   :RELCD9,                                            *00572000
                   :VALUE9,                                            *00573000
                   :ANDOR9,                                            *00574000
                   :KEYWRD10,                                          *00575000
                   :RELCD10,                                           *00576000
                   :VALUE10,                                           *00577000
                   :ANDOR10,                                           *00578000
                   :KEYWRD11,                                          *00579000
                   :RELCD11,                                           *00580000
                   :VALUE11,                                           *00581000
                   :ANDOR11,                                           *00582000
                   :KEYWRD12,                                          *00583000
                   :RELCD12,                                           *00584000
                   :VALUE12,                                           *00585000
                   :ANDOR12,                                           *00586000
                   :KEYWRD13,                                          *00587000
                   :RELCD13,                                           *00588000
                   :VALUE13,                                           *00589000
                   :ANDOR13,                                           *00590000
                   :KEYWRD14,                                          *00591000
                   :RELCD14,                                           *00592000
                   :VALUE14,                                           *00593000
                   :ANDOR14,                                           *00594000
                   :KEYWRD15,                                          *00595000
                   :RELCD15,                                           *00596000
                   :VALUE15,                                           *00597000
                   :ANDOR15                                            *00598000
                   )                                                    00599000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00600000
         BR    14                      RETURN TO CALLER                 00601000
         LTORG                                                          00602000
*                                                                       00603000
**********************************************************************  00604000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00605000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00606000
**********************************************************************  00607000
*                                                                       00608000
UPDUC0   DS    0H                                                       00609000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00610000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00611000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00612000
         BALR  14,15                   MOVE REQUESTED DATA              00613000
         B     *+6                     BRANCH AROUND ADCON              00614000
BASUPD0  DC    AL2(4096)                                                00615000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00616000
         AH    3,BASUPD0               ADD 4K                           00617000
         EXEC  SQL UPDATE S05                                          *00618000
                   SET                                                 *00619000
                     AUDIT_DATE = :AUDDATE,                            *00620000
                     AUDIT_TIME = :AUDTIME,                            *00621000
                     AUDIT_USER = :AUDUSER,                            *00622000
                     AUDIT_ORG = :AUDORG,                              *00623000
                     KEY_WORD_01 = :KEYWRD1,                           *00624000
                     REL_CODE_01 = :RELCD1,                            *00625000
                     VALUE_01 = :VALUE1,                               *00626000
                     AND_OR_01 = :ANDOR1,                              *00627000
                     KEY_WORD_02 = :KEYWRD2,                           *00628000
                     REL_CODE_02 = :RELCD2,                            *00629000
                     VALUE_02 = :VALUE2,                               *00630000
                     AND_OR_02 = :ANDOR2,                              *00631000
                     KEY_WORD_03 = :KEYWRD3,                           *00632000
                     REL_CODE_03 = :RELCD3,                            *00633000
                     VALUE_03 = :VALUE3,                               *00634000
                     AND_OR_03 = :ANDOR3,                              *00635000
                     KEY_WORD_04 = :KEYWRD4,                           *00636000
                     REL_CODE_04 = :RELCD4,                            *00637000
                     VALUE_04 = :VALUE4,                               *00638000
                     AND_OR_04 = :ANDOR4,                              *00639000
                     KEY_WORD_05 = :KEYWRD5,                           *00640000
                     REL_CODE_05 = :RELCD5,                            *00641000
                     VALUE_05 = :VALUE5,                               *00642000
                     AND_OR_05 = :ANDOR5,                              *00643000
                     KEY_WORD_06 = :KEYWRD6,                           *00644000
                     REL_CODE_06 = :RELCD6,                            *00645000
                     VALUE_06 = :VALUE6,                               *00646000
                     AND_OR_06 = :ANDOR6,                              *00647000
                     KEY_WORD_07 = :KEYWRD7,                           *00648000
                     REL_CODE_07 = :RELCD7,                            *00649000
                     VALUE_07 = :VALUE7,                               *00650000
                     AND_OR_07 = :ANDOR7,                              *00651000
                     KEY_WORD_08 = :KEYWRD8,                           *00652000
                     REL_CODE_08 = :RELCD8,                            *00653000
                     VALUE_08 = :VALUE8,                               *00654000
                     AND_OR_08 = :ANDOR8,                              *00655000
                     KEY_WORD_09 = :KEYWRD9,                           *00656000
                     REL_CODE_09 = :RELCD9,                            *00657000
                     VALUE_09 = :VALUE9,                               *00658000
                     AND_OR_09 = :ANDOR9,                              *00659000
                     KEY_WORD_10 = :KEYWRD10,                          *00660000
                     REL_CODE_10 = :RELCD10,                           *00661000
                     VALUE_10 = :VALUE10,                              *00662000
                     AND_OR_10 = :ANDOR10,                             *00663000
                     KEY_WORD_11 = :KEYWRD11,                          *00664000
                     REL_CODE_11 = :RELCD11,                           *00665000
                     VALUE_11 = :VALUE11,                              *00666000
                     AND_OR_11 = :ANDOR11,                             *00667000
                     KEY_WORD_12 = :KEYWRD12,                          *00668000
                     REL_CODE_12 = :RELCD12,                           *00669000
                     VALUE_12 = :VALUE12,                              *00670000
                     AND_OR_12 = :ANDOR12,                             *00671000
                     KEY_WORD_13 = :KEYWRD13,                          *00672000
                     REL_CODE_13 = :RELCD13,                           *00673000
                     VALUE_13 = :VALUE13,                              *00674000
                     AND_OR_13 = :ANDOR13,                             *00675000
                     KEY_WORD_14 = :KEYWRD14,                          *00676000
                     REL_CODE_14 = :RELCD14,                           *00677000
                     VALUE_14 = :VALUE14,                              *00678000
                     AND_OR_14 = :ANDOR14,                             *00679000
                     KEY_WORD_15 = :KEYWRD15,                          *00680000
                     REL_CODE_15 = :RELCD15,                           *00681000
                     VALUE_15 = :VALUE15,                              *00682000
                     AND_OR_15 = :ANDOR15                              *00683000
                 WHERE CURRENT OF S05UPD0                               00684000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00685000
         BR    14                      RETURN TO CALLER                 00686000
         LTORG                                                          00687000
*                                                                       00688000
**********************************************************************  00689000
* DELETE STATEMENT BY PRIMARY KEY:                                      00690000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00691000
**********************************************************************  00692000
*                                                                       00693000
DELUC0   DS    0H                                                       00694000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00695000
         EXEC  SQL DELETE FROM S05                                     *00696000
                 WHERE CURRENT OF S05UPD0                               00697000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00698000
         BR    14                      RETURN TO CALLER                 00699000
         LTORG                                                          00700000
*                                                                       00701000
**********************************************************************  00702000
* DELETE ALL STATEMENT:                                                 00703000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00704000
**********************************************************************  00705000
*                                                                       00706000
DELTBL   DS    0H                                                       00707000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00708000
         EXEC  SQL DELETE FROM S05                                      00709000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00710000
         BR    14                      RETURN TO CALLER                 00711000
         LTORG                                                          00712000
*                                                                       00713000
**********************************************************************  00714000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00715000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00716000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00717000
*     TO CLOSE THE UPDATE CURSOR.                                       00718000
**********************************************************************  00719000
*                                                                       00720000
CLSUC0   DS    0H                                                       00721000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00722000
         EXEC  SQL CLOSE S05UPD0                                        00723000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00724000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00725000
         BR    14                      RETURN TO CALLER                 00726000
         LTORG                                                          00727000
*                                                                       00728000
**********************************************************************  00729000
* ALTERNATE KEY 1 NOT DEFINED                                           00730000
**********************************************************************  00731000
*                                                                       00732000
SELUC1   DS    0H                                                       00733000
FETUC1   DS    0H                                                       00734000
UPDUC1   DS    0H                                                       00735000
DELUC1   DS    0H                                                       00736000
CLSUC1   DS    0H                                                       00737000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00738000
*                                                                       00739000
**********************************************************************  00740000
* ALTERNATE KEY 2 NOT DEFINED                                           00741000
**********************************************************************  00742000
*                                                                       00743000
SELUC2   DS    0H                                                       00744000
FETUC2   DS    0H                                                       00745000
UPDUC2   DS    0H                                                       00746000
DELUC2   DS    0H                                                       00747000
CLSUC2   DS    0H                                                       00748000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00749000
*                                                                       00750000
**********************************************************************  00751000
* ALTERNATE KEY 3 NOT DEFINED                                           00752000
**********************************************************************  00753000
*                                                                       00754000
SELUC3   DS    0H                                                       00755000
FETUC3   DS    0H                                                       00756000
UPDUC3   DS    0H                                                       00757000
DELUC3   DS    0H                                                       00758000
CLSUC3   DS    0H                                                       00759000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00760000
*                                                                       00761000
         DS    0H                      END OF SQL STATEMENTS            00762000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00763000
*                                                                       00764000
**********************************************************************  00765000
* DUMMY ENTRY POINT DSNHLI                                              00766000
**********************************************************************  00767000
*                                                                       00768000
         ENTRY DSNHLI                                                   00769000
DSNHLI   DS    0H                                                       00770000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00771000
         BR    15                      BRANCH TO ATTACH FACILITY        00772000
*                                                                       00773000
**********************************************************************  00774000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00775000
**********************************************************************  00776000
*                                                                       00777000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00778000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00779000
* OR:                                                                   00780000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00781000
* WHERE:                                                                00782000
*   RRRR = RECORD AREA OFFSET                                           00783000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00784000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00785000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00786000
*   KK   = KEY FIELD MASK:                                              00787000
*            80 = KEY 0 FIELD                                           00788000
*            40 = KEY 1 FIELD                                           00789000
*            20 = KEY 2 FIELD                                           00790000
*            10 = KEY 3 FIELD                                           00791000
*   DD   = DATA FIELD MASK:                                             00792000
*            80 = RECORD FIELD IS PACKED                                00793000
*            40 = HOST VARIABLE IS PACKED                               00794000
*            20 = NULLABLE FIELD                                        00795000
*            01 = DATE FIELD                                            00796000
*            02 = TIME FIELD                                            00797000
*                                                                       00798000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00799000
         DC    H'0000',H'0000',H'0014',X'80',X'00'                      00800000
         DC    H'0014',H'0014',H'0549',X'00',X'00'                      00801000
         DC    8X'FF'                                                   00802000
*                                                                       00803000
         LTORG                                                          00804000
         END                                                            00805000
