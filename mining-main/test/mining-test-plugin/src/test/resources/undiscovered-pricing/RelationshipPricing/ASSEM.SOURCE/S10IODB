* REL=S10IODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  S10IODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/28/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S10 FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL430                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
RECNBR   DS    CL4                                                      00039000
TRANPROF DS    CL6                                                      00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
DESC     DS    CL30                                                     00045000
GRACEDAY DS    CL2                                                      00046000
ACCOND01 DS    CL1                                                      00047000
ACCUM01  DS    CL2                                                      00048000
RELCD01  DS    CL2                                                      00049000
REQOPT01 DS    CL1                                                      00050000
TRNCNT01 DS    PL3'0.'                                                  00051000
TRNAMT01 DS    PL6'0.00'                                                00052000
ACDESC01 DS    CL15                                                     00053000
ACCOND02 DS    CL1                                                      00054000
ACCUM02  DS    CL2                                                      00055000
RELCD02  DS    CL2                                                      00056000
REQOPT02 DS    CL1                                                      00057000
TRNCNT02 DS    PL3'0.'                                                  00058000
TRNAMT02 DS    PL6'0.00'                                                00059000
ACDESC02 DS    CL15                                                     00060000
ACCOND03 DS    CL1                                                      00061000
ACCUM03  DS    CL2                                                      00062000
RELCD03  DS    CL2                                                      00063000
REQOPT03 DS    CL1                                                      00064000
TRNCNT03 DS    PL3'0.'                                                  00065000
TRNAMT03 DS    PL6'0.00'                                                00066000
ACDESC03 DS    CL15                                                     00067000
ACCOND04 DS    CL1                                                      00068000
ACCUM04  DS    CL2                                                      00069000
RELCD04  DS    CL2                                                      00070000
REQOPT04 DS    CL1                                                      00071000
TRNCNT04 DS    PL3'0.'                                                  00072000
TRNAMT04 DS    PL6'0.00'                                                00073000
ACDESC04 DS    CL15                                                     00074000
ACCOND05 DS    CL1                                                      00075000
ACCUM05  DS    CL2                                                      00076000
RELCD05  DS    CL2                                                      00077000
REQOPT05 DS    CL1                                                      00078000
TRNCNT05 DS    PL3'0.'                                                  00079000
TRNAMT05 DS    PL6'0.00'                                                00080000
ACDESC05 DS    CL15                                                     00081000
ACCOND06 DS    CL1                                                      00082000
ACCUM06  DS    CL2                                                      00083000
RELCD06  DS    CL2                                                      00084000
REQOPT06 DS    CL1                                                      00085000
TRNCNT06 DS    PL3'0.'                                                  00086000
TRNAMT06 DS    PL6'0.00'                                                00087000
ACDESC06 DS    CL15                                                     00088000
ACCOND07 DS    CL1                                                      00089000
ACCUM07  DS    CL2                                                      00090000
RELCD07  DS    CL2                                                      00091000
REQOPT07 DS    CL1                                                      00092000
TRNCNT07 DS    PL3'0.'                                                  00093000
TRNAMT07 DS    PL6'0.00'                                                00094000
ACDESC07 DS    CL15                                                     00095000
ACCOND08 DS    CL1                                                      00096000
ACCUM08  DS    CL2                                                      00097000
RELCD08  DS    CL2                                                      00098000
REQOPT08 DS    CL1                                                      00099000
TRNCNT08 DS    PL3'0.'                                                  00100000
TRNAMT08 DS    PL6'0.00'                                                00101000
ACDESC08 DS    CL15                                                     00102000
ACCOND09 DS    CL1                                                      00103000
ACCUM09  DS    CL2                                                      00104000
RELCD09  DS    CL2                                                      00105000
REQOPT09 DS    CL1                                                      00106000
TRNCNT09 DS    PL3'0.'                                                  00107000
TRNAMT09 DS    PL6'0.00'                                                00108000
ACDESC09 DS    CL15                                                     00109000
ACCOND10 DS    CL1                                                      00110000
ACCUM10  DS    CL2                                                      00111000
RELCD10  DS    CL2                                                      00112000
REQOPT10 DS    CL1                                                      00113000
TRNCNT10 DS    PL3'0.'                                                  00114000
TRNAMT10 DS    PL6'0.00'                                                00115000
ACDESC10 DS    CL15                                                     00116000
ACCOND11 DS    CL1                                                      00117000
ACCUM11  DS    CL2                                                      00118000
RELCD11  DS    CL2                                                      00119000
REQOPT11 DS    CL1                                                      00120000
TRNCNT11 DS    PL3'0.'                                                  00121000
TRNAMT11 DS    PL6'0.00'                                                00122000
ACDESC11 DS    CL15                                                     00123000
ACCOND12 DS    CL1                                                      00124000
ACCUM12  DS    CL2                                                      00125000
RELCD12  DS    CL2                                                      00126000
REQOPT12 DS    CL1                                                      00127000
TRNCNT12 DS    PL3'0.'                                                  00128000
TRNAMT12 DS    PL6'0.00'                                                00129000
ACDESC12 DS    CL15                                                     00130000
*                                                                       00131000
*                                                                       00132000
**********************************************************************  00133000
* PROGRAM TABLE HEADER SECTION:                                         00134000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00135000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00136000
**********************************************************************  00137000
*                                                                       00138000
S10IODB  CSECT                         PROGRAM TABLE SECTION            00139000
S10IODB  AMODE ANY                                                      00140000
S10IODB  RMODE ANY                                                      00141000
         DC    CL9'S10IODB'            PROGRAM ID                       00142000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00143000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00144000
         DC    A(0)                    RESERVED                         00145000
         DC    A(0)                    RESERVED                         00146000
         DC    24CL1' '                RESERVED                         00147000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00148000
*                                                                       00149000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00150000
         DC    CL29'WWW.INFOR.COM                '                      00150001
*                                                                       00151000
*                                                                       00152000
**********************************************************************  00153000
* STATEMENT TABLE SECTION:                                              00154000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00155000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00156000
*   SHOULD NOT BE MODIFIED.                                             00157000
**********************************************************************  00158000
*                                                                       00159000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00160000
STM#TAB  AMODE ANY                                                      00161000
STM#TAB  RMODE ANY                                                      00162000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00163000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00164000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00165000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00166000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00167000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00168000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00169000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00170000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00171000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00172000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00173000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00174000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00175000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00176000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00177000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00178000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00179000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00180000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00181000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00182000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00183000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00184000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00185000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00186000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00187000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00188000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00189000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00190000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00191000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00192000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00193000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00194000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00195000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00196000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00197000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00198000
         DC    A(SQL#0036)             INSERT STATEMENT                 00199000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00200000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00201000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00202000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00203000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00204000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00205000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00206000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00207000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00208000
         DC    4X'FF'                                                   00209000
*                                                                       00210000
*                                                                       00211000
**********************************************************************  00212000
* SQL STATEMENT SECTION:                                                00213000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00214000
*     TO SUPPORT THIS TABLE.                                            00215000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00216000
*     ARE EQUIVALENT.                                                   00217000
**********************************************************************  00218000
*                                                                       00219000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00220000
SQL#STMT AMODE ANY                                                      00221000
SQL#STMT RMODE ANY                                                      00222000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00223000
         USING SQLDSECT,10,3,4         ADDRESS SQLDSECT                 00224000
         USING COM#AREA,11             ADDRESS COMMAREA                 00225000
*                                                                       00226000
*                                                                       00227000
**********************************************************************  00228000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00229000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00230000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00231000
**********************************************************************  00232000
*                                                                       00233000
SQL#0000 DS    0H                                                       00234000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00235000
         B     *+6                     BRANCH AROUND ADCON              00236000
BASE0000 DC    AL2(4096)                                                00237000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00238000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00239000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00240000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00241000
         AH    3,BASE0000              ADD 4K                           00242000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00243000
         AH    4,BASE0000              ADD 4K                           00244000
         EXEC  SQL                                                     *00245000
               SELECT AUDIT_DATE,                                      *00246000
                   AUDIT_TIME,                                         *00247000
                   AUDIT_USER,                                         *00248000
                   AUDIT_ORG,                                          *00249000
                   DESCRIPTION,                                        *00250000
                   GRACE_DAYS,                                         *00251000
                   ACCUM_COND_01,                                      *00252000
                   ACCUM_01,                                           *00253000
                   REL_CODE_01,                                        *00254000
                   REQM_OPTION_01,                                     *00255000
                   TRAN_COUNT_01,                                      *00256000
                   TRAN_AMOUNT_01,                                     *00257000
                   ACCUM_DESC_01,                                      *00258000
                   ACCUM_COND_02,                                      *00259000
                   ACCUM_02,                                           *00260000
                   REL_CODE_02,                                        *00261000
                   REQM_OPTION_02,                                     *00262000
                   TRAN_COUNT_02,                                      *00263000
                   TRAN_AMOUNT_02,                                     *00264000
                   ACCUM_DESC_02,                                      *00265000
                   ACCUM_COND_03,                                      *00266000
                   ACCUM_03,                                           *00267000
                   REL_CODE_03,                                        *00268000
                   REQM_OPTION_03,                                     *00269000
                   TRAN_COUNT_03,                                      *00270000
                   TRAN_AMOUNT_03,                                     *00271000
                   ACCUM_DESC_03,                                      *00272000
                   ACCUM_COND_04,                                      *00273000
                   ACCUM_04,                                           *00274000
                   REL_CODE_04,                                        *00275000
                   REQM_OPTION_04,                                     *00276000
                   TRAN_COUNT_04,                                      *00277000
                   TRAN_AMOUNT_04,                                     *00278000
                   ACCUM_DESC_04,                                      *00279000
                   ACCUM_COND_05,                                      *00280000
                   ACCUM_05,                                           *00281000
                   REL_CODE_05,                                        *00282000
                   REQM_OPTION_05,                                     *00283000
                   TRAN_COUNT_05,                                      *00284000
                   TRAN_AMOUNT_05,                                     *00285000
                   ACCUM_DESC_05,                                      *00286000
                   ACCUM_COND_06,                                      *00287000
                   ACCUM_06,                                           *00288000
                   REL_CODE_06,                                        *00289000
                   REQM_OPTION_06,                                     *00290000
                   TRAN_COUNT_06,                                      *00291000
                   TRAN_AMOUNT_06,                                     *00292000
                   ACCUM_DESC_06,                                      *00293000
                   ACCUM_COND_07,                                      *00294000
                   ACCUM_07,                                           *00295000
                   REL_CODE_07,                                        *00296000
                   REQM_OPTION_07,                                     *00297000
                   TRAN_COUNT_07,                                      *00298000
                   TRAN_AMOUNT_07,                                     *00299000
                   ACCUM_DESC_07,                                      *00300000
                   ACCUM_COND_08,                                      *00301000
                   ACCUM_08,                                           *00302000
                   REL_CODE_08,                                        *00303000
                   REQM_OPTION_08,                                     *00304000
                   TRAN_COUNT_08,                                      *00305000
                   TRAN_AMOUNT_08,                                     *00306000
                   ACCUM_DESC_08,                                      *00307000
                   ACCUM_COND_09,                                      *00308000
                   ACCUM_09,                                           *00309000
                   REL_CODE_09,                                        *00310000
                   REQM_OPTION_09,                                     *00311000
                   TRAN_COUNT_09,                                      *00312000
                   TRAN_AMOUNT_09,                                     *00313000
                   ACCUM_DESC_09,                                      *00314000
                   ACCUM_COND_10,                                      *00315000
                   ACCUM_10,                                           *00316000
                   REL_CODE_10,                                        *00317000
                   REQM_OPTION_10,                                     *00318000
                   TRAN_COUNT_10,                                      *00319000
                   TRAN_AMOUNT_10,                                     *00320000
                   ACCUM_DESC_10,                                      *00321000
                   ACCUM_COND_11,                                      *00322000
                   ACCUM_11,                                           *00323000
                   REL_CODE_11,                                        *00324000
                   REQM_OPTION_11,                                     *00325000
                   TRAN_COUNT_11,                                      *00326000
                   TRAN_AMOUNT_11,                                     *00327000
                   ACCUM_DESC_11,                                      *00328000
                   ACCUM_COND_12,                                      *00329000
                   ACCUM_12,                                           *00330000
                   REL_CODE_12,                                        *00331000
                   REQM_OPTION_12,                                     *00332000
                   TRAN_COUNT_12,                                      *00333000
                   TRAN_AMOUNT_12,                                     *00334000
                   ACCUM_DESC_12                                       *00335000
                 INTO :AUDDATE,                                        *00336000
                   :AUDTIME,                                           *00337000
                   :AUDUSER,                                           *00338000
                   :AUDORG,                                            *00339000
                   :DESC,                                              *00340000
                   :GRACEDAY,                                          *00341000
                   :ACCOND01,                                          *00342000
                   :ACCUM01,                                           *00343000
                   :RELCD01,                                           *00344000
                   :REQOPT01,                                          *00345000
                   :TRNCNT01,                                          *00346000
                   :TRNAMT01,                                          *00347000
                   :ACDESC01,                                          *00348000
                   :ACCOND02,                                          *00349000
                   :ACCUM02,                                           *00350000
                   :RELCD02,                                           *00351000
                   :REQOPT02,                                          *00352000
                   :TRNCNT02,                                          *00353000
                   :TRNAMT02,                                          *00354000
                   :ACDESC02,                                          *00355000
                   :ACCOND03,                                          *00356000
                   :ACCUM03,                                           *00357000
                   :RELCD03,                                           *00358000
                   :REQOPT03,                                          *00359000
                   :TRNCNT03,                                          *00360000
                   :TRNAMT03,                                          *00361000
                   :ACDESC03,                                          *00362000
                   :ACCOND04,                                          *00363000
                   :ACCUM04,                                           *00364000
                   :RELCD04,                                           *00365000
                   :REQOPT04,                                          *00366000
                   :TRNCNT04,                                          *00367000
                   :TRNAMT04,                                          *00368000
                   :ACDESC04,                                          *00369000
                   :ACCOND05,                                          *00370000
                   :ACCUM05,                                           *00371000
                   :RELCD05,                                           *00372000
                   :REQOPT05,                                          *00373000
                   :TRNCNT05,                                          *00374000
                   :TRNAMT05,                                          *00375000
                   :ACDESC05,                                          *00376000
                   :ACCOND06,                                          *00377000
                   :ACCUM06,                                           *00378000
                   :RELCD06,                                           *00379000
                   :REQOPT06,                                          *00380000
                   :TRNCNT06,                                          *00381000
                   :TRNAMT06,                                          *00382000
                   :ACDESC06,                                          *00383000
                   :ACCOND07,                                          *00384000
                   :ACCUM07,                                           *00385000
                   :RELCD07,                                           *00386000
                   :REQOPT07,                                          *00387000
                   :TRNCNT07,                                          *00388000
                   :TRNAMT07,                                          *00389000
                   :ACDESC07,                                          *00390000
                   :ACCOND08,                                          *00391000
                   :ACCUM08,                                           *00392000
                   :RELCD08,                                           *00393000
                   :REQOPT08,                                          *00394000
                   :TRNCNT08,                                          *00395000
                   :TRNAMT08,                                          *00396000
                   :ACDESC08,                                          *00397000
                   :ACCOND09,                                          *00398000
                   :ACCUM09,                                           *00399000
                   :RELCD09,                                           *00400000
                   :REQOPT09,                                          *00401000
                   :TRNCNT09,                                          *00402000
                   :TRNAMT09,                                          *00403000
                   :ACDESC09,                                          *00404000
                   :ACCOND10,                                          *00405000
                   :ACCUM10,                                           *00406000
                   :RELCD10,                                           *00407000
                   :REQOPT10,                                          *00408000
                   :TRNCNT10,                                          *00409000
                   :TRNAMT10,                                          *00410000
                   :ACDESC10,                                          *00411000
                   :ACCOND11,                                          *00412000
                   :ACCUM11,                                           *00413000
                   :RELCD11,                                           *00414000
                   :REQOPT11,                                          *00415000
                   :TRNCNT11,                                          *00416000
                   :TRNAMT11,                                          *00417000
                   :ACDESC11,                                          *00418000
                   :ACCOND12,                                          *00419000
                   :ACCUM12,                                           *00420000
                   :RELCD12,                                           *00421000
                   :REQOPT12,                                          *00422000
                   :TRNCNT12,                                          *00423000
                   :TRNAMT12,                                          *00424000
                   :ACDESC12                                           *00425000
                 FROM S10                                              *00426000
                 WHERE INST_NBR = :INST AND                            *00427000
                   RECORD_NBR = :RECNBR AND                            *00428000
                   TRAN_PROFILE = :TRANPROF                            *00429000
                 FETCH FIRST 1 ROW ONLY                                 00430000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00431000
         BALR  4,5                     MOVE INTO RECORD AREA            00432000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00433000
         BR    14                      RETURN TO CALLER                 00434000
         LTORG                                                          00435000
*                                                                       00436000
*                                                                       00437000
**********************************************************************  00438000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00439000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00440000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00441000
**********************************************************************  00442000
*                                                                       00443000
SQL#0001 DS    0H                                                       00444000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00445000
         LA    15,255                  SET RETURN CODE                  00446000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00447000
         BR    14                      RETURN TO CALLER                 00448000
         LTORG                                                          00449000
*                                                                       00450000
*                                                                       00451000
**********************************************************************  00452000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00453000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00454000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00455000
**********************************************************************  00456000
*                                                                       00457000
SQL#0002 DS    0H                                                       00458000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00459000
         LA    15,255                  SET RETURN CODE                  00460000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00461000
         BR    14                      RETURN TO CALLER                 00462000
         LTORG                                                          00463000
*                                                                       00464000
*                                                                       00465000
**********************************************************************  00466000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00467000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00468000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00469000
**********************************************************************  00470000
*                                                                       00471000
SQL#0003 DS    0H                                                       00472000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00473000
         LA    15,255                  SET RETURN CODE                  00474000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00475000
         BR    14                      RETURN TO CALLER                 00476000
         LTORG                                                          00477000
*                                                                       00478000
*                                                                       00479000
**********************************************************************  00480000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00481000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00482000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00483000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00484000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00485000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00486000
*     UPDATE STATEMENT TO MATCH.                                        00487000
**********************************************************************  00488000
*                                                                       00489000
SQL#0004 DS    0H                                                       00490000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00491000
         B     *+6                     BRANCH AROUND ADCON              00492000
BASE0004 DC    AL2(4096)                                                00493000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00494000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00495000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00496000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00497000
         AH    3,BASE0004              ADD 4K                           00498000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00499000
         AH    4,BASE0004              ADD 4K                           00500000
         EXEC  SQL                                                     *00501000
               DECLARE S10UPD0 CURSOR FOR                              *00502000
               SELECT AUDIT_DATE,                                      *00503000
                   AUDIT_TIME,                                         *00504000
                   AUDIT_USER,                                         *00505000
                   AUDIT_ORG,                                          *00506000
                   DESCRIPTION,                                        *00507000
                   GRACE_DAYS,                                         *00508000
                   ACCUM_COND_01,                                      *00509000
                   ACCUM_01,                                           *00510000
                   REL_CODE_01,                                        *00511000
                   REQM_OPTION_01,                                     *00512000
                   TRAN_COUNT_01,                                      *00513000
                   TRAN_AMOUNT_01,                                     *00514000
                   ACCUM_DESC_01,                                      *00515000
                   ACCUM_COND_02,                                      *00516000
                   ACCUM_02,                                           *00517000
                   REL_CODE_02,                                        *00518000
                   REQM_OPTION_02,                                     *00519000
                   TRAN_COUNT_02,                                      *00520000
                   TRAN_AMOUNT_02,                                     *00521000
                   ACCUM_DESC_02,                                      *00522000
                   ACCUM_COND_03,                                      *00523000
                   ACCUM_03,                                           *00524000
                   REL_CODE_03,                                        *00525000
                   REQM_OPTION_03,                                     *00526000
                   TRAN_COUNT_03,                                      *00527000
                   TRAN_AMOUNT_03,                                     *00528000
                   ACCUM_DESC_03,                                      *00529000
                   ACCUM_COND_04,                                      *00530000
                   ACCUM_04,                                           *00531000
                   REL_CODE_04,                                        *00532000
                   REQM_OPTION_04,                                     *00533000
                   TRAN_COUNT_04,                                      *00534000
                   TRAN_AMOUNT_04,                                     *00535000
                   ACCUM_DESC_04,                                      *00536000
                   ACCUM_COND_05,                                      *00537000
                   ACCUM_05,                                           *00538000
                   REL_CODE_05,                                        *00539000
                   REQM_OPTION_05,                                     *00540000
                   TRAN_COUNT_05,                                      *00541000
                   TRAN_AMOUNT_05,                                     *00542000
                   ACCUM_DESC_05,                                      *00543000
                   ACCUM_COND_06,                                      *00544000
                   ACCUM_06,                                           *00545000
                   REL_CODE_06,                                        *00546000
                   REQM_OPTION_06,                                     *00547000
                   TRAN_COUNT_06,                                      *00548000
                   TRAN_AMOUNT_06,                                     *00549000
                   ACCUM_DESC_06,                                      *00550000
                   ACCUM_COND_07,                                      *00551000
                   ACCUM_07,                                           *00552000
                   REL_CODE_07,                                        *00553000
                   REQM_OPTION_07,                                     *00554000
                   TRAN_COUNT_07,                                      *00555000
                   TRAN_AMOUNT_07,                                     *00556000
                   ACCUM_DESC_07,                                      *00557000
                   ACCUM_COND_08,                                      *00558000
                   ACCUM_08,                                           *00559000
                   REL_CODE_08,                                        *00560000
                   REQM_OPTION_08,                                     *00561000
                   TRAN_COUNT_08,                                      *00562000
                   TRAN_AMOUNT_08,                                     *00563000
                   ACCUM_DESC_08,                                      *00564000
                   ACCUM_COND_09,                                      *00565000
                   ACCUM_09,                                           *00566000
                   REL_CODE_09,                                        *00567000
                   REQM_OPTION_09,                                     *00568000
                   TRAN_COUNT_09,                                      *00569000
                   TRAN_AMOUNT_09,                                     *00570000
                   ACCUM_DESC_09,                                      *00571000
                   ACCUM_COND_10,                                      *00572000
                   ACCUM_10,                                           *00573000
                   REL_CODE_10,                                        *00574000
                   REQM_OPTION_10,                                     *00575000
                   TRAN_COUNT_10,                                      *00576000
                   TRAN_AMOUNT_10,                                     *00577000
                   ACCUM_DESC_10,                                      *00578000
                   ACCUM_COND_11,                                      *00579000
                   ACCUM_11,                                           *00580000
                   REL_CODE_11,                                        *00581000
                   REQM_OPTION_11,                                     *00582000
                   TRAN_COUNT_11,                                      *00583000
                   TRAN_AMOUNT_11,                                     *00584000
                   ACCUM_DESC_11,                                      *00585000
                   ACCUM_COND_12,                                      *00586000
                   ACCUM_12,                                           *00587000
                   REL_CODE_12,                                        *00588000
                   REQM_OPTION_12,                                     *00589000
                   TRAN_COUNT_12,                                      *00590000
                   TRAN_AMOUNT_12,                                     *00591000
                   ACCUM_DESC_12                                       *00592000
                 FROM S10                                              *00593000
                 WHERE INST_NBR = :INST AND                            *00594000
                   RECORD_NBR = :RECNBR AND                            *00595000
                   TRAN_PROFILE = :TRANPROF                            *00596000
                 FOR UPDATE OF AUDIT_DATE,                             *00597000
                   AUDIT_TIME,                                         *00598000
                   AUDIT_USER,                                         *00599000
                   AUDIT_ORG,                                          *00600000
                   DESCRIPTION,                                        *00601000
                   GRACE_DAYS,                                         *00602000
                   ACCUM_COND_01,                                      *00603000
                   ACCUM_01,                                           *00604000
                   REL_CODE_01,                                        *00605000
                   REQM_OPTION_01,                                     *00606000
                   TRAN_COUNT_01,                                      *00607000
                   TRAN_AMOUNT_01,                                     *00608000
                   ACCUM_DESC_01,                                      *00609000
                   ACCUM_COND_02,                                      *00610000
                   ACCUM_02,                                           *00611000
                   REL_CODE_02,                                        *00612000
                   REQM_OPTION_02,                                     *00613000
                   TRAN_COUNT_02,                                      *00614000
                   TRAN_AMOUNT_02,                                     *00615000
                   ACCUM_DESC_02,                                      *00616000
                   ACCUM_COND_03,                                      *00617000
                   ACCUM_03,                                           *00618000
                   REL_CODE_03,                                        *00619000
                   REQM_OPTION_03,                                     *00620000
                   TRAN_COUNT_03,                                      *00621000
                   TRAN_AMOUNT_03,                                     *00622000
                   ACCUM_DESC_03,                                      *00623000
                   ACCUM_COND_04,                                      *00624000
                   ACCUM_04,                                           *00625000
                   REL_CODE_04,                                        *00626000
                   REQM_OPTION_04,                                     *00627000
                   TRAN_COUNT_04,                                      *00628000
                   TRAN_AMOUNT_04,                                     *00629000
                   ACCUM_DESC_04,                                      *00630000
                   ACCUM_COND_05,                                      *00631000
                   ACCUM_05,                                           *00632000
                   REL_CODE_05,                                        *00633000
                   REQM_OPTION_05,                                     *00634000
                   TRAN_COUNT_05,                                      *00635000
                   TRAN_AMOUNT_05,                                     *00636000
                   ACCUM_DESC_05,                                      *00637000
                   ACCUM_COND_06,                                      *00638000
                   ACCUM_06,                                           *00639000
                   REL_CODE_06,                                        *00640000
                   REQM_OPTION_06,                                     *00641000
                   TRAN_COUNT_06,                                      *00642000
                   TRAN_AMOUNT_06,                                     *00643000
                   ACCUM_DESC_06,                                      *00644000
                   ACCUM_COND_07,                                      *00645000
                   ACCUM_07,                                           *00646000
                   REL_CODE_07,                                        *00647000
                   REQM_OPTION_07,                                     *00648000
                   TRAN_COUNT_07,                                      *00649000
                   TRAN_AMOUNT_07,                                     *00650000
                   ACCUM_DESC_07,                                      *00651000
                   ACCUM_COND_08,                                      *00652000
                   ACCUM_08,                                           *00653000
                   REL_CODE_08,                                        *00654000
                   REQM_OPTION_08,                                     *00655000
                   TRAN_COUNT_08,                                      *00656000
                   TRAN_AMOUNT_08,                                     *00657000
                   ACCUM_DESC_08,                                      *00658000
                   ACCUM_COND_09,                                      *00659000
                   ACCUM_09,                                           *00660000
                   REL_CODE_09,                                        *00661000
                   REQM_OPTION_09,                                     *00662000
                   TRAN_COUNT_09,                                      *00663000
                   TRAN_AMOUNT_09,                                     *00664000
                   ACCUM_DESC_09,                                      *00665000
                   ACCUM_COND_10,                                      *00666000
                   ACCUM_10,                                           *00667000
                   REL_CODE_10,                                        *00668000
                   REQM_OPTION_10,                                     *00669000
                   TRAN_COUNT_10,                                      *00670000
                   TRAN_AMOUNT_10,                                     *00671000
                   ACCUM_DESC_10,                                      *00672000
                   ACCUM_COND_11,                                      *00673000
                   ACCUM_11,                                           *00674000
                   REL_CODE_11,                                        *00675000
                   REQM_OPTION_11,                                     *00676000
                   TRAN_COUNT_11,                                      *00677000
                   TRAN_AMOUNT_11,                                     *00678000
                   ACCUM_DESC_11,                                      *00679000
                   ACCUM_COND_12,                                      *00680000
                   ACCUM_12,                                           *00681000
                   REL_CODE_12,                                        *00682000
                   REQM_OPTION_12,                                     *00683000
                   TRAN_COUNT_12,                                      *00684000
                   TRAN_AMOUNT_12,                                     *00685000
                   ACCUM_DESC_12                                       *00686000
                 FETCH FIRST 1 ROW ONLY                                 00687000
         EXEC  SQL                                                     *00688000
               OPEN S10UPD0                                             00689000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00690000
         BR    14                      RETURN TO CALLER                 00691000
         LTORG                                                          00692000
*                                                                       00693000
*                                                                       00694000
**********************************************************************  00695000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00696000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00697000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00698000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00699000
*     UPDATE STATEMENT TO MATCH.                                        00700000
**********************************************************************  00701000
*                                                                       00702000
SQL#0005 DS    0H                                                       00703000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00704000
         LA    15,255                  SET RETURN CODE                  00705000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00706000
         BR    14                      RETURN TO CALLER                 00707000
         LTORG                                                          00708000
*                                                                       00709000
*                                                                       00710000
**********************************************************************  00711000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00712000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00713000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00714000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00715000
*     UPDATE STATEMENT TO MATCH.                                        00716000
**********************************************************************  00717000
*                                                                       00718000
SQL#0006 DS    0H                                                       00719000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00720000
         LA    15,255                  SET RETURN CODE                  00721000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00722000
         BR    14                      RETURN TO CALLER                 00723000
         LTORG                                                          00724000
*                                                                       00725000
*                                                                       00726000
**********************************************************************  00727000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00728000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00729000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00730000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00731000
*     UPDATE STATEMENT TO MATCH.                                        00732000
**********************************************************************  00733000
*                                                                       00734000
SQL#0007 DS    0H                                                       00735000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00736000
         LA    15,255                  SET RETURN CODE                  00737000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00738000
         BR    14                      RETURN TO CALLER                 00739000
         LTORG                                                          00740000
*                                                                       00741000
*                                                                       00742000
**********************************************************************  00743000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00744000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00745000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00746000
*     THE ACTUAL ROW.                                                   00747000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00748000
**********************************************************************  00749000
*                                                                       00750000
SQL#0008 DS    0H                                                       00751000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00752000
         B     *+6                     BRANCH AROUND ADCON              00753000
BASE0008 DC    AL2(4096)                                                00754000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00755000
         AH    3,BASE0008              ADD 4K                           00756000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00757000
         AH    4,BASE0008              ADD 4K                           00758000
         EXEC  SQL                                                     *00759000
               FETCH S10UPD0                                           *00760000
                 INTO :AUDDATE,                                        *00761000
                   :AUDTIME,                                           *00762000
                   :AUDUSER,                                           *00763000
                   :AUDORG,                                            *00764000
                   :DESC,                                              *00765000
                   :GRACEDAY,                                          *00766000
                   :ACCOND01,                                          *00767000
                   :ACCUM01,                                           *00768000
                   :RELCD01,                                           *00769000
                   :REQOPT01,                                          *00770000
                   :TRNCNT01,                                          *00771000
                   :TRNAMT01,                                          *00772000
                   :ACDESC01,                                          *00773000
                   :ACCOND02,                                          *00774000
                   :ACCUM02,                                           *00775000
                   :RELCD02,                                           *00776000
                   :REQOPT02,                                          *00777000
                   :TRNCNT02,                                          *00778000
                   :TRNAMT02,                                          *00779000
                   :ACDESC02,                                          *00780000
                   :ACCOND03,                                          *00781000
                   :ACCUM03,                                           *00782000
                   :RELCD03,                                           *00783000
                   :REQOPT03,                                          *00784000
                   :TRNCNT03,                                          *00785000
                   :TRNAMT03,                                          *00786000
                   :ACDESC03,                                          *00787000
                   :ACCOND04,                                          *00788000
                   :ACCUM04,                                           *00789000
                   :RELCD04,                                           *00790000
                   :REQOPT04,                                          *00791000
                   :TRNCNT04,                                          *00792000
                   :TRNAMT04,                                          *00793000
                   :ACDESC04,                                          *00794000
                   :ACCOND05,                                          *00795000
                   :ACCUM05,                                           *00796000
                   :RELCD05,                                           *00797000
                   :REQOPT05,                                          *00798000
                   :TRNCNT05,                                          *00799000
                   :TRNAMT05,                                          *00800000
                   :ACDESC05,                                          *00801000
                   :ACCOND06,                                          *00802000
                   :ACCUM06,                                           *00803000
                   :RELCD06,                                           *00804000
                   :REQOPT06,                                          *00805000
                   :TRNCNT06,                                          *00806000
                   :TRNAMT06,                                          *00807000
                   :ACDESC06,                                          *00808000
                   :ACCOND07,                                          *00809000
                   :ACCUM07,                                           *00810000
                   :RELCD07,                                           *00811000
                   :REQOPT07,                                          *00812000
                   :TRNCNT07,                                          *00813000
                   :TRNAMT07,                                          *00814000
                   :ACDESC07,                                          *00815000
                   :ACCOND08,                                          *00816000
                   :ACCUM08,                                           *00817000
                   :RELCD08,                                           *00818000
                   :REQOPT08,                                          *00819000
                   :TRNCNT08,                                          *00820000
                   :TRNAMT08,                                          *00821000
                   :ACDESC08,                                          *00822000
                   :ACCOND09,                                          *00823000
                   :ACCUM09,                                           *00824000
                   :RELCD09,                                           *00825000
                   :REQOPT09,                                          *00826000
                   :TRNCNT09,                                          *00827000
                   :TRNAMT09,                                          *00828000
                   :ACDESC09,                                          *00829000
                   :ACCOND10,                                          *00830000
                   :ACCUM10,                                           *00831000
                   :RELCD10,                                           *00832000
                   :REQOPT10,                                          *00833000
                   :TRNCNT10,                                          *00834000
                   :TRNAMT10,                                          *00835000
                   :ACDESC10,                                          *00836000
                   :ACCOND11,                                          *00837000
                   :ACCUM11,                                           *00838000
                   :RELCD11,                                           *00839000
                   :REQOPT11,                                          *00840000
                   :TRNCNT11,                                          *00841000
                   :TRNAMT11,                                          *00842000
                   :ACDESC11,                                          *00843000
                   :ACCOND12,                                          *00844000
                   :ACCUM12,                                           *00845000
                   :RELCD12,                                           *00846000
                   :REQOPT12,                                          *00847000
                   :TRNCNT12,                                          *00848000
                   :TRNAMT12,                                          *00849000
                   :ACDESC12                                            00850000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00851000
         BALR  4,5                     MOVE INTO RECORD AREA            00852000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00853000
         BR    14                      RETURN TO CALLER                 00854000
         LTORG                                                          00855000
*                                                                       00856000
*                                                                       00857000
**********************************************************************  00858000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00859000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00860000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00861000
*     THE ACTUAL ROW.                                                   00862000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00863000
**********************************************************************  00864000
*                                                                       00865000
SQL#0009 DS    0H                                                       00866000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00867000
         LA    15,255                  SET RETURN CODE                  00868000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00869000
         BR    14                      RETURN TO CALLER                 00870000
         LTORG                                                          00871000
*                                                                       00872000
*                                                                       00873000
**********************************************************************  00874000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00875000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00876000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00877000
*     THE ACTUAL ROW.                                                   00878000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00879000
**********************************************************************  00880000
*                                                                       00881000
SQL#0010 DS    0H                                                       00882000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00883000
         LA    15,255                  SET RETURN CODE                  00884000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00885000
         BR    14                      RETURN TO CALLER                 00886000
         LTORG                                                          00887000
*                                                                       00888000
*                                                                       00889000
**********************************************************************  00890000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00891000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00892000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00893000
*     THE ACTUAL ROW.                                                   00894000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00895000
**********************************************************************  00896000
*                                                                       00897000
SQL#0011 DS    0H                                                       00898000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00899000
         LA    15,255                  SET RETURN CODE                  00900000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00901000
         BR    14                      RETURN TO CALLER                 00902000
         LTORG                                                          00903000
*                                                                       00904000
*                                                                       00905000
**********************************************************************  00906000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00907000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00908000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00909000
*     TO CLOSE THE UPDATE CURSOR.                                       00910000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00911000
**********************************************************************  00912000
*                                                                       00913000
SQL#0012 DS    0H                                                       00914000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00915000
         B     *+6                     BRANCH AROUND ADCON              00916000
BASE0012 DC    AL2(4096)                                                00917000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00918000
         AH    3,BASE0012              ADD 4K                           00919000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00920000
         AH    4,BASE0012              ADD 4K                           00921000
         EXEC  SQL                                                     *00922000
               CLOSE S10UPD0                                            00923000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00924000
         BR    14                      RETURN TO CALLER                 00925000
         LTORG                                                          00926000
*                                                                       00927000
*                                                                       00928000
**********************************************************************  00929000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00930000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00931000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00932000
*     TO CLOSE THE UPDATE CURSOR.                                       00933000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00934000
**********************************************************************  00935000
*                                                                       00936000
SQL#0013 DS    0H                                                       00937000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00938000
         LA    15,255                  SET RETURN CODE                  00939000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00940000
         BR    14                      RETURN TO CALLER                 00941000
         LTORG                                                          00942000
*                                                                       00943000
*                                                                       00944000
**********************************************************************  00945000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00946000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00947000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00948000
*     TO CLOSE THE UPDATE CURSOR.                                       00949000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00950000
**********************************************************************  00951000
*                                                                       00952000
SQL#0014 DS    0H                                                       00953000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00954000
         LA    15,255                  SET RETURN CODE                  00955000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00956000
         BR    14                      RETURN TO CALLER                 00957000
         LTORG                                                          00958000
*                                                                       00959000
*                                                                       00960000
**********************************************************************  00961000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00962000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00963000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00964000
*     TO CLOSE THE UPDATE CURSOR.                                       00965000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00966000
**********************************************************************  00967000
*                                                                       00968000
SQL#0015 DS    0H                                                       00969000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00970000
         LA    15,255                  SET RETURN CODE                  00971000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00972000
         BR    14                      RETURN TO CALLER                 00973000
         LTORG                                                          00974000
*                                                                       00975000
*                                                                       00976000
**********************************************************************  00977000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00978000
* KEY:                                                                  00979000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00980000
*     AND GET-NEXT-LOCK VERBS.                                          00981000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00982000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00983000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00984000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00985000
*     ORDER BY CLAUSE.                                                  00986000
**********************************************************************  00987000
*                                                                       00988000
SQL#0016 DS    0H                                                       00989000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00990000
         B     *+6                     BRANCH AROUND ADCON              00991000
BASE0016 DC    AL2(4096)                                                00992000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00993000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00994000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00995000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00996000
         AH    3,BASE0016              ADD 4K                           00997000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00998000
         AH    4,BASE0016              ADD 4K                           00999000
         EXEC  SQL                                                     *01000000
               DECLARE S10SQ001 CURSOR FOR                             *01001000
               SELECT INST_NBR,                                        *01002000
                   RECORD_NBR,                                         *01003000
                   TRAN_PROFILE,                                       *01004000
                   AUDIT_DATE,                                         *01005000
                   AUDIT_TIME,                                         *01006000
                   AUDIT_USER,                                         *01007000
                   AUDIT_ORG,                                          *01008000
                   DESCRIPTION,                                        *01009000
                   GRACE_DAYS,                                         *01010000
                   ACCUM_COND_01,                                      *01011000
                   ACCUM_01,                                           *01012000
                   REL_CODE_01,                                        *01013000
                   REQM_OPTION_01,                                     *01014000
                   TRAN_COUNT_01,                                      *01015000
                   TRAN_AMOUNT_01,                                     *01016000
                   ACCUM_DESC_01,                                      *01017000
                   ACCUM_COND_02,                                      *01018000
                   ACCUM_02,                                           *01019000
                   REL_CODE_02,                                        *01020000
                   REQM_OPTION_02,                                     *01021000
                   TRAN_COUNT_02,                                      *01022000
                   TRAN_AMOUNT_02,                                     *01023000
                   ACCUM_DESC_02,                                      *01024000
                   ACCUM_COND_03,                                      *01025000
                   ACCUM_03,                                           *01026000
                   REL_CODE_03,                                        *01027000
                   REQM_OPTION_03,                                     *01028000
                   TRAN_COUNT_03,                                      *01029000
                   TRAN_AMOUNT_03,                                     *01030000
                   ACCUM_DESC_03,                                      *01031000
                   ACCUM_COND_04,                                      *01032000
                   ACCUM_04,                                           *01033000
                   REL_CODE_04,                                        *01034000
                   REQM_OPTION_04,                                     *01035000
                   TRAN_COUNT_04,                                      *01036000
                   TRAN_AMOUNT_04,                                     *01037000
                   ACCUM_DESC_04,                                      *01038000
                   ACCUM_COND_05,                                      *01039000
                   ACCUM_05,                                           *01040000
                   REL_CODE_05,                                        *01041000
                   REQM_OPTION_05,                                     *01042000
                   TRAN_COUNT_05,                                      *01043000
                   TRAN_AMOUNT_05,                                     *01044000
                   ACCUM_DESC_05,                                      *01045000
                   ACCUM_COND_06,                                      *01046000
                   ACCUM_06,                                           *01047000
                   REL_CODE_06,                                        *01048000
                   REQM_OPTION_06,                                     *01049000
                   TRAN_COUNT_06,                                      *01050000
                   TRAN_AMOUNT_06,                                     *01051000
                   ACCUM_DESC_06,                                      *01052000
                   ACCUM_COND_07,                                      *01053000
                   ACCUM_07,                                           *01054000
                   REL_CODE_07,                                        *01055000
                   REQM_OPTION_07,                                     *01056000
                   TRAN_COUNT_07,                                      *01057000
                   TRAN_AMOUNT_07,                                     *01058000
                   ACCUM_DESC_07,                                      *01059000
                   ACCUM_COND_08,                                      *01060000
                   ACCUM_08,                                           *01061000
                   REL_CODE_08,                                        *01062000
                   REQM_OPTION_08,                                     *01063000
                   TRAN_COUNT_08,                                      *01064000
                   TRAN_AMOUNT_08,                                     *01065000
                   ACCUM_DESC_08,                                      *01066000
                   ACCUM_COND_09,                                      *01067000
                   ACCUM_09,                                           *01068000
                   REL_CODE_09,                                        *01069000
                   REQM_OPTION_09,                                     *01070000
                   TRAN_COUNT_09,                                      *01071000
                   TRAN_AMOUNT_09,                                     *01072000
                   ACCUM_DESC_09,                                      *01073000
                   ACCUM_COND_10,                                      *01074000
                   ACCUM_10,                                           *01075000
                   REL_CODE_10,                                        *01076000
                   REQM_OPTION_10,                                     *01077000
                   TRAN_COUNT_10,                                      *01078000
                   TRAN_AMOUNT_10,                                     *01079000
                   ACCUM_DESC_10,                                      *01080000
                   ACCUM_COND_11,                                      *01081000
                   ACCUM_11,                                           *01082000
                   REL_CODE_11,                                        *01083000
                   REQM_OPTION_11,                                     *01084000
                   TRAN_COUNT_11,                                      *01085000
                   TRAN_AMOUNT_11,                                     *01086000
                   ACCUM_DESC_11,                                      *01087000
                   ACCUM_COND_12,                                      *01088000
                   ACCUM_12,                                           *01089000
                   REL_CODE_12,                                        *01090000
                   REQM_OPTION_12,                                     *01091000
                   TRAN_COUNT_12,                                      *01092000
                   TRAN_AMOUNT_12,                                     *01093000
                   ACCUM_DESC_12                                       *01094000
                 FROM S10                                              *01095000
                 WHERE                                                 *01096000
                    INST_NBR = :INST AND                               *01097000
                    RECORD_NBR = :RECNBR AND                           *01098000
                    TRAN_PROFILE >= :TRANPROF                          *01099000
                 ORDER BY TRAN_PROFILE                                 *01100000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01101000
         EXEC  SQL                                                     *01102000
               OPEN S10SQ001                                            01103000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01104000
         BR    14                      RETURN TO CALLER                 01105000
         LTORG                                                          01106000
*                                                                       01107000
*                                                                       01108000
**********************************************************************  01109000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  01110000
* KEY 1:                                                                01111000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         01112000
*     AND GET-NEXT-LOCK VERBS.                                          01113000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              01114000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                01115000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      01116000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     01117000
*     ORDER BY CLAUSE.                                                  01118000
**********************************************************************  01119000
*                                                                       01120000
SQL#0017 DS    0H                                                       01121000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          01122000
         LA    15,255                  SET RETURN CODE                  01123000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01124000
         BR    14                      RETURN TO CALLER                 01125000
         LTORG                                                          01126000
*                                                                       01127000
*                                                                       01128000
**********************************************************************  01129000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  01130000
* KEY 2:                                                                01131000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         01132000
*     AND GET-NEXT-LOCK VERBS.                                          01133000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              01134000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                01135000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      01136000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     01137000
*     ORDER BY CLAUSE.                                                  01138000
**********************************************************************  01139000
*                                                                       01140000
SQL#0018 DS    0H                                                       01141000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          01142000
         LA    15,255                  SET RETURN CODE                  01143000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01144000
         BR    14                      RETURN TO CALLER                 01145000
         LTORG                                                          01146000
*                                                                       01147000
*                                                                       01148000
**********************************************************************  01149000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  01150000
* KEY 3:                                                                01151000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         01152000
*     AND GET-NEXT-LOCK VERBS.                                          01153000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              01154000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                01155000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      01156000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     01157000
*     ORDER BY CLAUSE.                                                  01158000
**********************************************************************  01159000
*                                                                       01160000
SQL#0019 DS    0H                                                       01161000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          01162000
         LA    15,255                  SET RETURN CODE                  01163000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01164000
         BR    14                      RETURN TO CALLER                 01165000
         LTORG                                                          01166000
*                                                                       01167000
*                                                                       01168000
**********************************************************************  01169000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               01170000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01171000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01172000
*     RETRIEVE THE ACTUAL ROW.                                          01173000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01174000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01175000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01176000
**********************************************************************  01177000
*                                                                       01178000
SQL#0020 DS    0H                                                       01179000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          01180000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01181000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    01182000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01183000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01184000
VECT0020 DC    A(SQL#0120)                                              01185000
         DC    A(SQL#0220)                                              01186000
         DC    A(SQL#0320)                                              01187000
         LTORG                                                          01188000
*                                                                       01189000
SQL#0120 DS    0H                                                       01190000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          01191000
         B     *+6                     BRANCH AROUND ADCON              01192000
BASE0120 DC    AL2(4096)                                                01193000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01194000
         AH    3,BASE0120              ADD 4K                           01195000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01196000
         AH    4,BASE0120              ADD 4K                           01197000
         EXEC  SQL                                                     *01198000
               FETCH S10SQ001                                          *01199000
                 INTO :INST,                                           *01200000
                      :RECNBR,                                         *01201000
                      :TRANPROF,                                       *01202000
                      :AUDDATE,                                        *01203000
                      :AUDTIME,                                        *01204000
                      :AUDUSER,                                        *01205000
                      :AUDORG,                                         *01206000
                      :DESC,                                           *01207000
                      :GRACEDAY,                                       *01208000
                      :ACCOND01,                                       *01209000
                      :ACCUM01,                                        *01210000
                      :RELCD01,                                        *01211000
                      :REQOPT01,                                       *01212000
                      :TRNCNT01,                                       *01213000
                      :TRNAMT01,                                       *01214000
                      :ACDESC01,                                       *01215000
                      :ACCOND02,                                       *01216000
                      :ACCUM02,                                        *01217000
                      :RELCD02,                                        *01218000
                      :REQOPT02,                                       *01219000
                      :TRNCNT02,                                       *01220000
                      :TRNAMT02,                                       *01221000
                      :ACDESC02,                                       *01222000
                      :ACCOND03,                                       *01223000
                      :ACCUM03,                                        *01224000
                      :RELCD03,                                        *01225000
                      :REQOPT03,                                       *01226000
                      :TRNCNT03,                                       *01227000
                      :TRNAMT03,                                       *01228000
                      :ACDESC03,                                       *01229000
                      :ACCOND04,                                       *01230000
                      :ACCUM04,                                        *01231000
                      :RELCD04,                                        *01232000
                      :REQOPT04,                                       *01233000
                      :TRNCNT04,                                       *01234000
                      :TRNAMT04,                                       *01235000
                      :ACDESC04,                                       *01236000
                      :ACCOND05,                                       *01237000
                      :ACCUM05,                                        *01238000
                      :RELCD05,                                        *01239000
                      :REQOPT05,                                       *01240000
                      :TRNCNT05,                                       *01241000
                      :TRNAMT05,                                       *01242000
                      :ACDESC05,                                       *01243000
                      :ACCOND06,                                       *01244000
                      :ACCUM06,                                        *01245000
                      :RELCD06,                                        *01246000
                      :REQOPT06,                                       *01247000
                      :TRNCNT06,                                       *01248000
                      :TRNAMT06,                                       *01249000
                      :ACDESC06,                                       *01250000
                      :ACCOND07,                                       *01251000
                      :ACCUM07,                                        *01252000
                      :RELCD07,                                        *01253000
                      :REQOPT07,                                       *01254000
                      :TRNCNT07,                                       *01255000
                      :TRNAMT07,                                       *01256000
                      :ACDESC07,                                       *01257000
                      :ACCOND08,                                       *01258000
                      :ACCUM08,                                        *01259000
                      :RELCD08,                                        *01260000
                      :REQOPT08,                                       *01261000
                      :TRNCNT08,                                       *01262000
                      :TRNAMT08,                                       *01263000
                      :ACDESC08,                                       *01264000
                      :ACCOND09,                                       *01265000
                      :ACCUM09,                                        *01266000
                      :RELCD09,                                        *01267000
                      :REQOPT09,                                       *01268000
                      :TRNCNT09,                                       *01269000
                      :TRNAMT09,                                       *01270000
                      :ACDESC09,                                       *01271000
                      :ACCOND10,                                       *01272000
                      :ACCUM10,                                        *01273000
                      :RELCD10,                                        *01274000
                      :REQOPT10,                                       *01275000
                      :TRNCNT10,                                       *01276000
                      :TRNAMT10,                                       *01277000
                      :ACDESC10,                                       *01278000
                      :ACCOND11,                                       *01279000
                      :ACCUM11,                                        *01280000
                      :RELCD11,                                        *01281000
                      :REQOPT11,                                       *01282000
                      :TRNCNT11,                                       *01283000
                      :TRNAMT11,                                       *01284000
                      :ACDESC11,                                       *01285000
                      :ACCOND12,                                       *01286000
                      :ACCUM12,                                        *01287000
                      :RELCD12,                                        *01288000
                      :REQOPT12,                                       *01289000
                      :TRNCNT12,                                       *01290000
                      :TRNAMT12,                                       *01291000
                      :ACDESC12                                         01292000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01293000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01294000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01295000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01296000
         BR    12                      OPEN NEXT CURSOR                 01297000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01298000
         BALR  4,5                     MOVE INTO RECORD AREA            01299000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01300000
         BR    14                      RETURN TO CALLER                 01301000
         LTORG                                                          01302000
*                                                                       01303000
SQL#0220 DS    0H                                                       01304000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          01305000
         B     *+6                     BRANCH AROUND ADCON              01306000
BASE0220 DC    AL2(4096)                                                01307000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01308000
         AH    3,BASE0220              ADD 4K                           01309000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01310000
         AH    4,BASE0220              ADD 4K                           01311000
         EXEC  SQL                                                     *01312000
               FETCH S10SQ002                                          *01313000
                 INTO :INST,                                           *01314000
                      :RECNBR,                                         *01315000
                      :TRANPROF,                                       *01316000
                      :AUDDATE,                                        *01317000
                      :AUDTIME,                                        *01318000
                      :AUDUSER,                                        *01319000
                      :AUDORG,                                         *01320000
                      :DESC,                                           *01321000
                      :GRACEDAY,                                       *01322000
                      :ACCOND01,                                       *01323000
                      :ACCUM01,                                        *01324000
                      :RELCD01,                                        *01325000
                      :REQOPT01,                                       *01326000
                      :TRNCNT01,                                       *01327000
                      :TRNAMT01,                                       *01328000
                      :ACDESC01,                                       *01329000
                      :ACCOND02,                                       *01330000
                      :ACCUM02,                                        *01331000
                      :RELCD02,                                        *01332000
                      :REQOPT02,                                       *01333000
                      :TRNCNT02,                                       *01334000
                      :TRNAMT02,                                       *01335000
                      :ACDESC02,                                       *01336000
                      :ACCOND03,                                       *01337000
                      :ACCUM03,                                        *01338000
                      :RELCD03,                                        *01339000
                      :REQOPT03,                                       *01340000
                      :TRNCNT03,                                       *01341000
                      :TRNAMT03,                                       *01342000
                      :ACDESC03,                                       *01343000
                      :ACCOND04,                                       *01344000
                      :ACCUM04,                                        *01345000
                      :RELCD04,                                        *01346000
                      :REQOPT04,                                       *01347000
                      :TRNCNT04,                                       *01348000
                      :TRNAMT04,                                       *01349000
                      :ACDESC04,                                       *01350000
                      :ACCOND05,                                       *01351000
                      :ACCUM05,                                        *01352000
                      :RELCD05,                                        *01353000
                      :REQOPT05,                                       *01354000
                      :TRNCNT05,                                       *01355000
                      :TRNAMT05,                                       *01356000
                      :ACDESC05,                                       *01357000
                      :ACCOND06,                                       *01358000
                      :ACCUM06,                                        *01359000
                      :RELCD06,                                        *01360000
                      :REQOPT06,                                       *01361000
                      :TRNCNT06,                                       *01362000
                      :TRNAMT06,                                       *01363000
                      :ACDESC06,                                       *01364000
                      :ACCOND07,                                       *01365000
                      :ACCUM07,                                        *01366000
                      :RELCD07,                                        *01367000
                      :REQOPT07,                                       *01368000
                      :TRNCNT07,                                       *01369000
                      :TRNAMT07,                                       *01370000
                      :ACDESC07,                                       *01371000
                      :ACCOND08,                                       *01372000
                      :ACCUM08,                                        *01373000
                      :RELCD08,                                        *01374000
                      :REQOPT08,                                       *01375000
                      :TRNCNT08,                                       *01376000
                      :TRNAMT08,                                       *01377000
                      :ACDESC08,                                       *01378000
                      :ACCOND09,                                       *01379000
                      :ACCUM09,                                        *01380000
                      :RELCD09,                                        *01381000
                      :REQOPT09,                                       *01382000
                      :TRNCNT09,                                       *01383000
                      :TRNAMT09,                                       *01384000
                      :ACDESC09,                                       *01385000
                      :ACCOND10,                                       *01386000
                      :ACCUM10,                                        *01387000
                      :RELCD10,                                        *01388000
                      :REQOPT10,                                       *01389000
                      :TRNCNT10,                                       *01390000
                      :TRNAMT10,                                       *01391000
                      :ACDESC10,                                       *01392000
                      :ACCOND11,                                       *01393000
                      :ACCUM11,                                        *01394000
                      :RELCD11,                                        *01395000
                      :REQOPT11,                                       *01396000
                      :TRNCNT11,                                       *01397000
                      :TRNAMT11,                                       *01398000
                      :ACDESC11,                                       *01399000
                      :ACCOND12,                                       *01400000
                      :ACCUM12,                                        *01401000
                      :RELCD12,                                        *01402000
                      :REQOPT12,                                       *01403000
                      :TRNCNT12,                                       *01404000
                      :TRNAMT12,                                       *01405000
                      :ACDESC12                                         01406000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01407000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01408000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01409000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01410000
         BR    12                      OPEN NEXT CURSOR                 01411000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01412000
         BALR  4,5                     MOVE INTO RECORD AREA            01413000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01414000
         BR    14                      RETURN TO CALLER                 01415000
         LTORG                                                          01416000
*                                                                       01417000
SQL#0320 DS    0H                                                       01418000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          01419000
         B     *+6                     BRANCH AROUND ADCON              01420000
BASE0320 DC    AL2(4096)                                                01421000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01422000
         AH    3,BASE0320              ADD 4K                           01423000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01424000
         AH    4,BASE0320              ADD 4K                           01425000
         EXEC  SQL                                                     *01426000
               FETCH S10SQ003                                          *01427000
                 INTO :INST,                                           *01428000
                      :RECNBR,                                         *01429000
                      :TRANPROF,                                       *01430000
                      :AUDDATE,                                        *01431000
                      :AUDTIME,                                        *01432000
                      :AUDUSER,                                        *01433000
                      :AUDORG,                                         *01434000
                      :DESC,                                           *01435000
                      :GRACEDAY,                                       *01436000
                      :ACCOND01,                                       *01437000
                      :ACCUM01,                                        *01438000
                      :RELCD01,                                        *01439000
                      :REQOPT01,                                       *01440000
                      :TRNCNT01,                                       *01441000
                      :TRNAMT01,                                       *01442000
                      :ACDESC01,                                       *01443000
                      :ACCOND02,                                       *01444000
                      :ACCUM02,                                        *01445000
                      :RELCD02,                                        *01446000
                      :REQOPT02,                                       *01447000
                      :TRNCNT02,                                       *01448000
                      :TRNAMT02,                                       *01449000
                      :ACDESC02,                                       *01450000
                      :ACCOND03,                                       *01451000
                      :ACCUM03,                                        *01452000
                      :RELCD03,                                        *01453000
                      :REQOPT03,                                       *01454000
                      :TRNCNT03,                                       *01455000
                      :TRNAMT03,                                       *01456000
                      :ACDESC03,                                       *01457000
                      :ACCOND04,                                       *01458000
                      :ACCUM04,                                        *01459000
                      :RELCD04,                                        *01460000
                      :REQOPT04,                                       *01461000
                      :TRNCNT04,                                       *01462000
                      :TRNAMT04,                                       *01463000
                      :ACDESC04,                                       *01464000
                      :ACCOND05,                                       *01465000
                      :ACCUM05,                                        *01466000
                      :RELCD05,                                        *01467000
                      :REQOPT05,                                       *01468000
                      :TRNCNT05,                                       *01469000
                      :TRNAMT05,                                       *01470000
                      :ACDESC05,                                       *01471000
                      :ACCOND06,                                       *01472000
                      :ACCUM06,                                        *01473000
                      :RELCD06,                                        *01474000
                      :REQOPT06,                                       *01475000
                      :TRNCNT06,                                       *01476000
                      :TRNAMT06,                                       *01477000
                      :ACDESC06,                                       *01478000
                      :ACCOND07,                                       *01479000
                      :ACCUM07,                                        *01480000
                      :RELCD07,                                        *01481000
                      :REQOPT07,                                       *01482000
                      :TRNCNT07,                                       *01483000
                      :TRNAMT07,                                       *01484000
                      :ACDESC07,                                       *01485000
                      :ACCOND08,                                       *01486000
                      :ACCUM08,                                        *01487000
                      :RELCD08,                                        *01488000
                      :REQOPT08,                                       *01489000
                      :TRNCNT08,                                       *01490000
                      :TRNAMT08,                                       *01491000
                      :ACDESC08,                                       *01492000
                      :ACCOND09,                                       *01493000
                      :ACCUM09,                                        *01494000
                      :RELCD09,                                        *01495000
                      :REQOPT09,                                       *01496000
                      :TRNCNT09,                                       *01497000
                      :TRNAMT09,                                       *01498000
                      :ACDESC09,                                       *01499000
                      :ACCOND10,                                       *01500000
                      :ACCUM10,                                        *01501000
                      :RELCD10,                                        *01502000
                      :REQOPT10,                                       *01503000
                      :TRNCNT10,                                       *01504000
                      :TRNAMT10,                                       *01505000
                      :ACDESC10,                                       *01506000
                      :ACCOND11,                                       *01507000
                      :ACCUM11,                                        *01508000
                      :RELCD11,                                        *01509000
                      :REQOPT11,                                       *01510000
                      :TRNCNT11,                                       *01511000
                      :TRNAMT11,                                       *01512000
                      :ACDESC11,                                       *01513000
                      :ACCOND12,                                       *01514000
                      :ACCUM12,                                        *01515000
                      :RELCD12,                                        *01516000
                      :REQOPT12,                                       *01517000
                      :TRNCNT12,                                       *01518000
                      :TRNAMT12,                                       *01519000
                      :ACDESC12                                         01520000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01521000
         BALR  4,5                     MOVE INTO RECORD AREA            01522000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01523000
         BR    14                      RETURN TO CALLER                 01524000
         LTORG                                                          01525000
*                                                                       01526000
*                                                                       01527000
**********************************************************************  01528000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01529000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01530000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01531000
*     RETRIEVE THE ACTUAL ROW.                                          01532000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01533000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01534000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01535000
**********************************************************************  01536000
*                                                                       01537000
SQL#0021 DS    0H                                                       01538000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01539000
         LA    15,255                  SET RETURN CODE                  01540000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01541000
         BR    14                      RETURN TO CALLER                 01542000
         LTORG                                                          01543000
*                                                                       01544000
*                                                                       01545000
**********************************************************************  01546000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01547000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01548000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01549000
*     RETRIEVE THE ACTUAL ROW.                                          01550000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01551000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01552000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01553000
**********************************************************************  01554000
*                                                                       01555000
SQL#0022 DS    0H                                                       01556000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01557000
         LA    15,255                  SET RETURN CODE                  01558000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01559000
         BR    14                      RETURN TO CALLER                 01560000
         LTORG                                                          01561000
*                                                                       01562000
*                                                                       01563000
**********************************************************************  01564000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01565000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01566000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01567000
*     RETRIEVE THE ACTUAL ROW.                                          01568000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01569000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01570000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01571000
**********************************************************************  01572000
*                                                                       01573000
SQL#0023 DS    0H                                                       01574000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01575000
         LA    15,255                  SET RETURN CODE                  01576000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01577000
         BR    14                      RETURN TO CALLER                 01578000
         LTORG                                                          01579000
*                                                                       01580000
*                                                                       01581000
**********************************************************************  01582000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01583000
* THE PRIMARY KEY:                                                      01584000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01585000
*     VERBS.                                                            01586000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01587000
*     RETRIEVE THE ACTUAL ROW.                                          01588000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01589000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01590000
*     WILL BE THRU THE UPDATE CURSOR.                                   01591000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01592000
**********************************************************************  01593000
*                                                                       01594000
SQL#0024 DS    0H                                                       01595000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01596000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01597000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01598000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01599000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01600000
VECT0024 DC    A(SQL#0124)                                              01601000
         DC    A(SQL#0224)                                              01602000
         DC    A(SQL#0324)                                              01603000
         LTORG                                                          01604000
*                                                                       01605000
SQL#0124 DS    0H                                                       01606000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01607000
         B     *+6                     BRANCH AROUND ADCON              01608000
BASE0124 DC    AL2(4096)                                                01609000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01610000
         AH    3,BASE0124              ADD 4K                           01611000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01612000
         AH    4,BASE0124              ADD 4K                           01613000
         EXEC  SQL                                                     *01614000
               FETCH S10SQ001                                          *01615000
                 INTO :INST,                                           *01616000
                      :RECNBR,                                         *01617000
                      :TRANPROF                                         01618000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01619000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01620000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01621000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01622000
         BR    12                      OPEN NEXT CURSOR                 01623000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01624000
         BALR  4,5                     MOVE INTO RECORD AREA            01625000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01626000
         BR    14                      RETURN TO CALLER                 01627000
         LTORG                                                          01628000
*                                                                       01629000
SQL#0224 DS    0H                                                       01630000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01631000
         B     *+6                     BRANCH AROUND ADCON              01632000
BASE0224 DC    AL2(4096)                                                01633000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01634000
         AH    3,BASE0224              ADD 4K                           01635000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01636000
         AH    4,BASE0224              ADD 4K                           01637000
         EXEC  SQL                                                     *01638000
               FETCH S10SQ002                                          *01639000
                 INTO :INST,                                           *01640000
                      :RECNBR,                                         *01641000
                      :TRANPROF                                         01642000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01643000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01644000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01645000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01646000
         BR    12                      OPEN NEXT CURSOR                 01647000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01648000
         BALR  4,5                     MOVE INTO RECORD AREA            01649000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01650000
         BR    14                      RETURN TO CALLER                 01651000
         LTORG                                                          01652000
*                                                                       01653000
SQL#0324 DS    0H                                                       01654000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01655000
         B     *+6                     BRANCH AROUND ADCON              01656000
BASE0324 DC    AL2(4096)                                                01657000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01658000
         AH    3,BASE0324              ADD 4K                           01659000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01660000
         AH    4,BASE0324              ADD 4K                           01661000
         EXEC  SQL                                                     *01662000
               FETCH S10SQ003                                          *01663000
                 INTO :INST,                                           *01664000
                      :RECNBR,                                         *01665000
                      :TRANPROF                                         01666000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01667000
         BALR  4,5                     MOVE INTO RECORD AREA            01668000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01669000
         BR    14                      RETURN TO CALLER                 01670000
         LTORG                                                          01671000
*                                                                       01672000
*                                                                       01673000
**********************************************************************  01674000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01675000
* ALTERNATE KEY 1:                                                      01676000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01677000
*     VERBS.                                                            01678000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01679000
*     RETRIEVE THE ACTUAL ROW.                                          01680000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01681000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01682000
*     WILL BE THRU THE UPDATE CURSOR.                                   01683000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01684000
**********************************************************************  01685000
*                                                                       01686000
SQL#0025 DS    0H                                                       01687000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01688000
         LA    15,255                  SET RETURN CODE                  01689000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01690000
         BR    14                      RETURN TO CALLER                 01691000
         LTORG                                                          01692000
*                                                                       01693000
*                                                                       01694000
**********************************************************************  01695000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01696000
* ALTERNATE KEY 2:                                                      01697000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01698000
*     VERBS.                                                            01699000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01700000
*     RETRIEVE THE ACTUAL ROW.                                          01701000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01702000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01703000
*     WILL BE THRU THE UPDATE CURSOR.                                   01704000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01705000
**********************************************************************  01706000
*                                                                       01707000
SQL#0026 DS    0H                                                       01708000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01709000
         LA    15,255                  SET RETURN CODE                  01710000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01711000
         BR    14                      RETURN TO CALLER                 01712000
         LTORG                                                          01713000
*                                                                       01714000
*                                                                       01715000
**********************************************************************  01716000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01717000
* ALTERNATE KEY 3:                                                      01718000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01719000
*     VERBS.                                                            01720000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01721000
*     RETRIEVE THE ACTUAL ROW.                                          01722000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01723000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01724000
*     WILL BE THRU THE UPDATE CURSOR.                                   01725000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01726000
**********************************************************************  01727000
*                                                                       01728000
SQL#0027 DS    0H                                                       01729000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01730000
         LA    15,255                  SET RETURN CODE                  01731000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01732000
         BR    14                      RETURN TO CALLER                 01733000
         LTORG                                                          01734000
*                                                                       01735000
*                                                                       01736000
**********************************************************************  01737000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01738000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01739000
*     AND GET-NEXT-LOCK VERBS.                                          01740000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01741000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01742000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01743000
**********************************************************************  01744000
*                                                                       01745000
SQL#0028 DS    0H                                                       01746000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01747000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01748000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01749000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01750000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01751000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01752000
VECT0028 DC    A(SQL#0128)                                              01753000
         DC    A(SQL#0228)                                              01754000
         DC    A(SQL#0328)                                              01755000
         LTORG                                                          01756000
*                                                                       01757000
SQL#0128 DS    0H                                                       01758000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01759000
         B     *+6                     BRANCH AROUND ADCON              01760000
BASE0128 DC    AL2(4096)                                                01761000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01762000
         AH    3,BASE0128              ADD 4K                           01763000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01764000
         AH    4,BASE0128              ADD 4K                           01765000
         EXEC  SQL                                                     *01766000
               CLOSE S10SQ001                                           01767000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01768000
         BR    14                      RETURN TO CALLER                 01769000
         LTORG                                                          01770000
*                                                                       01771000
SQL#0228 DS    0H                                                       01772000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01773000
         B     *+6                     BRANCH AROUND ADCON              01774000
BASE0228 DC    AL2(4096)                                                01775000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01776000
         AH    3,BASE0228              ADD 4K                           01777000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01778000
         AH    4,BASE0228              ADD 4K                           01779000
         EXEC  SQL                                                     *01780000
               CLOSE S10SQ002                                           01781000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01782000
         BR    14                      RETURN TO CALLER                 01783000
         LTORG                                                          01784000
*                                                                       01785000
SQL#0328 DS    0H                                                       01786000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01787000
         B     *+6                     BRANCH AROUND ADCON              01788000
BASE0328 DC    AL2(4096)                                                01789000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01790000
         AH    3,BASE0328              ADD 4K                           01791000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01792000
         AH    4,BASE0328              ADD 4K                           01793000
         EXEC  SQL                                                     *01794000
               CLOSE S10SQ003                                           01795000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01796000
         BR    14                      RETURN TO CALLER                 01797000
         LTORG                                                          01798000
*                                                                       01799000
*                                                                       01800000
**********************************************************************  01801000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01802000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01803000
*     AND GET-NEXT-LOCK VERBS.                                          01804000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01805000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01806000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01807000
**********************************************************************  01808000
*                                                                       01809000
SQL#0029 DS    0H                                                       01810000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01811000
         LA    15,255                  SET RETURN CODE                  01812000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01813000
         BR    14                      RETURN TO CALLER                 01814000
         LTORG                                                          01815000
*                                                                       01816000
*                                                                       01817000
**********************************************************************  01818000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01819000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01820000
*     AND GET-NEXT-LOCK VERBS.                                          01821000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01822000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01823000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01824000
**********************************************************************  01825000
*                                                                       01826000
SQL#0030 DS    0H                                                       01827000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01828000
         LA    15,255                  SET RETURN CODE                  01829000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01830000
         BR    14                      RETURN TO CALLER                 01831000
         LTORG                                                          01832000
*                                                                       01833000
*                                                                       01834000
**********************************************************************  01835000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01836000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01837000
*     AND GET-NEXT-LOCK VERBS.                                          01838000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01839000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01840000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01841000
**********************************************************************  01842000
*                                                                       01843000
SQL#0031 DS    0H                                                       01844000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01845000
         LA    15,255                  SET RETURN CODE                  01846000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01847000
         BR    14                      RETURN TO CALLER                 01848000
         LTORG                                                          01849000
*                                                                       01850000
*                                                                       01851000
**********************************************************************  01852000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01853000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01854000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01855000
**********************************************************************  01856000
*                                                                       01857000
SQL#0032 DS    0H                                                       01858000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01859000
         B     *+6                     BRANCH AROUND ADCON              01860000
BASE0032 DC    AL2(4096)                                                01861000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01862000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01863000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01864000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01865000
         AH    3,BASE0032              ADD 4K                           01866000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01867000
         AH    4,BASE0032              ADD 4K                           01868000
         EXEC  SQL                                                     *01869000
               SELECT INST_NBR,                                        *01870000
                   RECORD_NBR,                                         *01871000
                   TRAN_PROFILE                                        *01872000
                 INTO :INST,                                           *01873000
                   :RECNBR,                                            *01874000
                   :TRANPROF                                           *01875000
                 FROM S10                                              *01876000
                 WHERE INST_NBR = :INST AND                            *01877000
                   RECORD_NBR = :RECNBR AND                            *01878000
                   TRAN_PROFILE = :TRANPROF                            *01879000
                 FETCH FIRST 1 ROW ONLY                                 01880000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01881000
         BR    14                      RETURN TO CALLER                 01882000
         LTORG                                                          01883000
*                                                                       01884000
*                                                                       01885000
**********************************************************************  01886000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01887000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01888000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01889000
**********************************************************************  01890000
*                                                                       01891000
SQL#0033 DS    0H                                                       01892000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01893000
         LA    15,255                  SET RETURN CODE                  01894000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01895000
         BR    14                      RETURN TO CALLER                 01896000
         LTORG                                                          01897000
*                                                                       01898000
*                                                                       01899000
**********************************************************************  01900000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01901000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01902000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01903000
**********************************************************************  01904000
*                                                                       01905000
SQL#0034 DS    0H                                                       01906000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01907000
         LA    15,255                  SET RETURN CODE                  01908000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01909000
         BR    14                      RETURN TO CALLER                 01910000
         LTORG                                                          01911000
*                                                                       01912000
*                                                                       01913000
**********************************************************************  01914000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01915000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01916000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01917000
**********************************************************************  01918000
*                                                                       01919000
SQL#0035 DS    0H                                                       01920000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01921000
         LA    15,255                  SET RETURN CODE                  01922000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01923000
         BR    14                      RETURN TO CALLER                 01924000
         LTORG                                                          01925000
*                                                                       01926000
*                                                                       01927000
**********************************************************************  01928000
* INSERT STATEMENT:                                                     01929000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01930000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01931000
**********************************************************************  01932000
*                                                                       01933000
SQL#0036 DS    0H                                                       01934000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01935000
         B     *+6                     BRANCH AROUND ADCON              01936000
BASE0036 DC    AL2(4096)                                                01937000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01938000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01939000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01940000
         AH    3,BASE0036              ADD 4K                           01941000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01942000
         AH    4,BASE0036              ADD 4K                           01943000
         EXEC  SQL                                                     *01944000
               INSERT INTO S10                                         *01945000
                   (INST_NBR,                                          *01946000
                    RECORD_NBR,                                        *01947000
                    TRAN_PROFILE,                                      *01948000
                    AUDIT_DATE,                                        *01949000
                    AUDIT_TIME,                                        *01950000
                    AUDIT_USER,                                        *01951000
                    AUDIT_ORG,                                         *01952000
                    DESCRIPTION,                                       *01953000
                    GRACE_DAYS,                                        *01954000
                    ACCUM_COND_01,                                     *01955000
                    ACCUM_01,                                          *01956000
                    REL_CODE_01,                                       *01957000
                    REQM_OPTION_01,                                    *01958000
                    TRAN_COUNT_01,                                     *01959000
                    TRAN_AMOUNT_01,                                    *01960000
                    ACCUM_DESC_01,                                     *01961000
                    ACCUM_COND_02,                                     *01962000
                    ACCUM_02,                                          *01963000
                    REL_CODE_02,                                       *01964000
                    REQM_OPTION_02,                                    *01965000
                    TRAN_COUNT_02,                                     *01966000
                    TRAN_AMOUNT_02,                                    *01967000
                    ACCUM_DESC_02,                                     *01968000
                    ACCUM_COND_03,                                     *01969000
                    ACCUM_03,                                          *01970000
                    REL_CODE_03,                                       *01971000
                    REQM_OPTION_03,                                    *01972000
                    TRAN_COUNT_03,                                     *01973000
                    TRAN_AMOUNT_03,                                    *01974000
                    ACCUM_DESC_03,                                     *01975000
                    ACCUM_COND_04,                                     *01976000
                    ACCUM_04,                                          *01977000
                    REL_CODE_04,                                       *01978000
                    REQM_OPTION_04,                                    *01979000
                    TRAN_COUNT_04,                                     *01980000
                    TRAN_AMOUNT_04,                                    *01981000
                    ACCUM_DESC_04,                                     *01982000
                    ACCUM_COND_05,                                     *01983000
                    ACCUM_05,                                          *01984000
                    REL_CODE_05,                                       *01985000
                    REQM_OPTION_05,                                    *01986000
                    TRAN_COUNT_05,                                     *01987000
                    TRAN_AMOUNT_05,                                    *01988000
                    ACCUM_DESC_05,                                     *01989000
                    ACCUM_COND_06,                                     *01990000
                    ACCUM_06,                                          *01991000
                    REL_CODE_06,                                       *01992000
                    REQM_OPTION_06,                                    *01993000
                    TRAN_COUNT_06,                                     *01994000
                    TRAN_AMOUNT_06,                                    *01995000
                    ACCUM_DESC_06,                                     *01996000
                    ACCUM_COND_07,                                     *01997000
                    ACCUM_07,                                          *01998000
                    REL_CODE_07,                                       *01999000
                    REQM_OPTION_07,                                    *02000000
                    TRAN_COUNT_07,                                     *02001000
                    TRAN_AMOUNT_07,                                    *02002000
                    ACCUM_DESC_07,                                     *02003000
                    ACCUM_COND_08,                                     *02004000
                    ACCUM_08,                                          *02005000
                    REL_CODE_08,                                       *02006000
                    REQM_OPTION_08,                                    *02007000
                    TRAN_COUNT_08,                                     *02008000
                    TRAN_AMOUNT_08,                                    *02009000
                    ACCUM_DESC_08,                                     *02010000
                    ACCUM_COND_09,                                     *02011000
                    ACCUM_09,                                          *02012000
                    REL_CODE_09,                                       *02013000
                    REQM_OPTION_09,                                    *02014000
                    TRAN_COUNT_09,                                     *02015000
                    TRAN_AMOUNT_09,                                    *02016000
                    ACCUM_DESC_09,                                     *02017000
                    ACCUM_COND_10,                                     *02018000
                    ACCUM_10,                                          *02019000
                    REL_CODE_10,                                       *02020000
                    REQM_OPTION_10,                                    *02021000
                    TRAN_COUNT_10,                                     *02022000
                    TRAN_AMOUNT_10,                                    *02023000
                    ACCUM_DESC_10,                                     *02024000
                    ACCUM_COND_11,                                     *02025000
                    ACCUM_11,                                          *02026000
                    REL_CODE_11,                                       *02027000
                    REQM_OPTION_11,                                    *02028000
                    TRAN_COUNT_11,                                     *02029000
                    TRAN_AMOUNT_11,                                    *02030000
                    ACCUM_DESC_11,                                     *02031000
                    ACCUM_COND_12,                                     *02032000
                    ACCUM_12,                                          *02033000
                    REL_CODE_12,                                       *02034000
                    REQM_OPTION_12,                                    *02035000
                    TRAN_COUNT_12,                                     *02036000
                    TRAN_AMOUNT_12,                                    *02037000
                    ACCUM_DESC_12)                                     *02038000
                  VALUES (:INST,                                       *02039000
                   :RECNBR,                                            *02040000
                   :TRANPROF,                                          *02041000
                   :AUDDATE,                                           *02042000
                   :AUDTIME,                                           *02043000
                   :AUDUSER,                                           *02044000
                   :AUDORG,                                            *02045000
                   :DESC,                                              *02046000
                   :GRACEDAY,                                          *02047000
                   :ACCOND01,                                          *02048000
                   :ACCUM01,                                           *02049000
                   :RELCD01,                                           *02050000
                   :REQOPT01,                                          *02051000
                   :TRNCNT01,                                          *02052000
                   :TRNAMT01,                                          *02053000
                   :ACDESC01,                                          *02054000
                   :ACCOND02,                                          *02055000
                   :ACCUM02,                                           *02056000
                   :RELCD02,                                           *02057000
                   :REQOPT02,                                          *02058000
                   :TRNCNT02,                                          *02059000
                   :TRNAMT02,                                          *02060000
                   :ACDESC02,                                          *02061000
                   :ACCOND03,                                          *02062000
                   :ACCUM03,                                           *02063000
                   :RELCD03,                                           *02064000
                   :REQOPT03,                                          *02065000
                   :TRNCNT03,                                          *02066000
                   :TRNAMT03,                                          *02067000
                   :ACDESC03,                                          *02068000
                   :ACCOND04,                                          *02069000
                   :ACCUM04,                                           *02070000
                   :RELCD04,                                           *02071000
                   :REQOPT04,                                          *02072000
                   :TRNCNT04,                                          *02073000
                   :TRNAMT04,                                          *02074000
                   :ACDESC04,                                          *02075000
                   :ACCOND05,                                          *02076000
                   :ACCUM05,                                           *02077000
                   :RELCD05,                                           *02078000
                   :REQOPT05,                                          *02079000
                   :TRNCNT05,                                          *02080000
                   :TRNAMT05,                                          *02081000
                   :ACDESC05,                                          *02082000
                   :ACCOND06,                                          *02083000
                   :ACCUM06,                                           *02084000
                   :RELCD06,                                           *02085000
                   :REQOPT06,                                          *02086000
                   :TRNCNT06,                                          *02087000
                   :TRNAMT06,                                          *02088000
                   :ACDESC06,                                          *02089000
                   :ACCOND07,                                          *02090000
                   :ACCUM07,                                           *02091000
                   :RELCD07,                                           *02092000
                   :REQOPT07,                                          *02093000
                   :TRNCNT07,                                          *02094000
                   :TRNAMT07,                                          *02095000
                   :ACDESC07,                                          *02096000
                   :ACCOND08,                                          *02097000
                   :ACCUM08,                                           *02098000
                   :RELCD08,                                           *02099000
                   :REQOPT08,                                          *02100000
                   :TRNCNT08,                                          *02101000
                   :TRNAMT08,                                          *02102000
                   :ACDESC08,                                          *02103000
                   :ACCOND09,                                          *02104000
                   :ACCUM09,                                           *02105000
                   :RELCD09,                                           *02106000
                   :REQOPT09,                                          *02107000
                   :TRNCNT09,                                          *02108000
                   :TRNAMT09,                                          *02109000
                   :ACDESC09,                                          *02110000
                   :ACCOND10,                                          *02111000
                   :ACCUM10,                                           *02112000
                   :RELCD10,                                           *02113000
                   :REQOPT10,                                          *02114000
                   :TRNCNT10,                                          *02115000
                   :TRNAMT10,                                          *02116000
                   :ACDESC10,                                          *02117000
                   :ACCOND11,                                          *02118000
                   :ACCUM11,                                           *02119000
                   :RELCD11,                                           *02120000
                   :REQOPT11,                                          *02121000
                   :TRNCNT11,                                          *02122000
                   :TRNAMT11,                                          *02123000
                   :ACDESC11,                                          *02124000
                   :ACCOND12,                                          *02125000
                   :ACCUM12,                                           *02126000
                   :RELCD12,                                           *02127000
                   :REQOPT12,                                          *02128000
                   :TRNCNT12,                                          *02129000
                   :TRNAMT12,                                          *02130000
                   :ACDESC12)                                           02131000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02132000
         BR    14                      RETURN TO CALLER                 02133000
         LTORG                                                          02134000
*                                                                       02135000
*                                                                       02136000
**********************************************************************  02137000
* UPDATE STATEMENT BY PRIMARY KEY:                                      02138000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02139000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02140000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02141000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02142000
*     STATEMENT.                                                        02143000
**********************************************************************  02144000
*                                                                       02145000
SQL#0037 DS    0H                                                       02146000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          02147000
         B     *+6                     BRANCH AROUND ADCON              02148000
BASE0037 DC    AL2(4096)                                                02149000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    02150000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02151000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02152000
         AH    3,BASE0037              ADD 4K                           02153000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    02154000
         AH    4,BASE0037              ADD 4K                           02155000
         EXEC  SQL                                                     *02156000
               UPDATE S10                                              *02157000
                   SET AUDIT_DATE = :AUDDATE,                          *02158000
                     AUDIT_TIME = :AUDTIME,                            *02159000
                     AUDIT_USER = :AUDUSER,                            *02160000
                     AUDIT_ORG = :AUDORG,                              *02161000
                     DESCRIPTION = :DESC,                              *02162000
                     GRACE_DAYS = :GRACEDAY,                           *02163000
                     ACCUM_COND_01 = :ACCOND01,                        *02164000
                     ACCUM_01 = :ACCUM01,                              *02165000
                     REL_CODE_01 = :RELCD01,                           *02166000
                     REQM_OPTION_01 = :REQOPT01,                       *02167000
                     TRAN_COUNT_01 = :TRNCNT01,                        *02168000
                     TRAN_AMOUNT_01 = :TRNAMT01,                       *02169000
                     ACCUM_DESC_01 = :ACDESC01,                        *02170000
                     ACCUM_COND_02 = :ACCOND02,                        *02171000
                     ACCUM_02 = :ACCUM02,                              *02172000
                     REL_CODE_02 = :RELCD02,                           *02173000
                     REQM_OPTION_02 = :REQOPT02,                       *02174000
                     TRAN_COUNT_02 = :TRNCNT02,                        *02175000
                     TRAN_AMOUNT_02 = :TRNAMT02,                       *02176000
                     ACCUM_DESC_02 = :ACDESC02,                        *02177000
                     ACCUM_COND_03 = :ACCOND03,                        *02178000
                     ACCUM_03 = :ACCUM03,                              *02179000
                     REL_CODE_03 = :RELCD03,                           *02180000
                     REQM_OPTION_03 = :REQOPT03,                       *02181000
                     TRAN_COUNT_03 = :TRNCNT03,                        *02182000
                     TRAN_AMOUNT_03 = :TRNAMT03,                       *02183000
                     ACCUM_DESC_03 = :ACDESC03,                        *02184000
                     ACCUM_COND_04 = :ACCOND04,                        *02185000
                     ACCUM_04 = :ACCUM04,                              *02186000
                     REL_CODE_04 = :RELCD04,                           *02187000
                     REQM_OPTION_04 = :REQOPT04,                       *02188000
                     TRAN_COUNT_04 = :TRNCNT04,                        *02189000
                     TRAN_AMOUNT_04 = :TRNAMT04,                       *02190000
                     ACCUM_DESC_04 = :ACDESC04,                        *02191000
                     ACCUM_COND_05 = :ACCOND05,                        *02192000
                     ACCUM_05 = :ACCUM05,                              *02193000
                     REL_CODE_05 = :RELCD05,                           *02194000
                     REQM_OPTION_05 = :REQOPT05,                       *02195000
                     TRAN_COUNT_05 = :TRNCNT05,                        *02196000
                     TRAN_AMOUNT_05 = :TRNAMT05,                       *02197000
                     ACCUM_DESC_05 = :ACDESC05,                        *02198000
                     ACCUM_COND_06 = :ACCOND06,                        *02199000
                     ACCUM_06 = :ACCUM06,                              *02200000
                     REL_CODE_06 = :RELCD06,                           *02201000
                     REQM_OPTION_06 = :REQOPT06,                       *02202000
                     TRAN_COUNT_06 = :TRNCNT06,                        *02203000
                     TRAN_AMOUNT_06 = :TRNAMT06,                       *02204000
                     ACCUM_DESC_06 = :ACDESC06,                        *02205000
                     ACCUM_COND_07 = :ACCOND07,                        *02206000
                     ACCUM_07 = :ACCUM07,                              *02207000
                     REL_CODE_07 = :RELCD07,                           *02208000
                     REQM_OPTION_07 = :REQOPT07,                       *02209000
                     TRAN_COUNT_07 = :TRNCNT07,                        *02210000
                     TRAN_AMOUNT_07 = :TRNAMT07,                       *02211000
                     ACCUM_DESC_07 = :ACDESC07,                        *02212000
                     ACCUM_COND_08 = :ACCOND08,                        *02213000
                     ACCUM_08 = :ACCUM08,                              *02214000
                     REL_CODE_08 = :RELCD08,                           *02215000
                     REQM_OPTION_08 = :REQOPT08,                       *02216000
                     TRAN_COUNT_08 = :TRNCNT08,                        *02217000
                     TRAN_AMOUNT_08 = :TRNAMT08,                       *02218000
                     ACCUM_DESC_08 = :ACDESC08,                        *02219000
                     ACCUM_COND_09 = :ACCOND09,                        *02220000
                     ACCUM_09 = :ACCUM09,                              *02221000
                     REL_CODE_09 = :RELCD09,                           *02222000
                     REQM_OPTION_09 = :REQOPT09,                       *02223000
                     TRAN_COUNT_09 = :TRNCNT09,                        *02224000
                     TRAN_AMOUNT_09 = :TRNAMT09,                       *02225000
                     ACCUM_DESC_09 = :ACDESC09,                        *02226000
                     ACCUM_COND_10 = :ACCOND10,                        *02227000
                     ACCUM_10 = :ACCUM10,                              *02228000
                     REL_CODE_10 = :RELCD10,                           *02229000
                     REQM_OPTION_10 = :REQOPT10,                       *02230000
                     TRAN_COUNT_10 = :TRNCNT10,                        *02231000
                     TRAN_AMOUNT_10 = :TRNAMT10,                       *02232000
                     ACCUM_DESC_10 = :ACDESC10,                        *02233000
                     ACCUM_COND_11 = :ACCOND11,                        *02234000
                     ACCUM_11 = :ACCUM11,                              *02235000
                     REL_CODE_11 = :RELCD11,                           *02236000
                     REQM_OPTION_11 = :REQOPT11,                       *02237000
                     TRAN_COUNT_11 = :TRNCNT11,                        *02238000
                     TRAN_AMOUNT_11 = :TRNAMT11,                       *02239000
                     ACCUM_DESC_11 = :ACDESC11,                        *02240000
                     ACCUM_COND_12 = :ACCOND12,                        *02241000
                     ACCUM_12 = :ACCUM12,                              *02242000
                     REL_CODE_12 = :RELCD12,                           *02243000
                     REQM_OPTION_12 = :REQOPT12,                       *02244000
                     TRAN_COUNT_12 = :TRNCNT12,                        *02245000
                     TRAN_AMOUNT_12 = :TRNAMT12,                       *02246000
                     ACCUM_DESC_12 = :ACDESC12                         *02247000
                 WHERE CURRENT OF S10UPD0                               02248000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02249000
         BR    14                      RETURN TO CALLER                 02250000
         LTORG                                                          02251000
*                                                                       02252000
*                                                                       02253000
**********************************************************************  02254000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  02255000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02256000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02257000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02258000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02259000
*     STATEMENT.                                                        02260000
**********************************************************************  02261000
*                                                                       02262000
SQL#0038 DS    0H                                                       02263000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          02264000
         LA    15,255                  SET RETURN CODE                  02265000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02266000
         BR    14                      RETURN TO CALLER                 02267000
         LTORG                                                          02268000
*                                                                       02269000
*                                                                       02270000
**********************************************************************  02271000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  02272000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02273000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02274000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02275000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02276000
*     STATEMENT.                                                        02277000
**********************************************************************  02278000
*                                                                       02279000
SQL#0039 DS    0H                                                       02280000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          02281000
         LA    15,255                  SET RETURN CODE                  02282000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02283000
         BR    14                      RETURN TO CALLER                 02284000
         LTORG                                                          02285000
*                                                                       02286000
*                                                                       02287000
**********************************************************************  02288000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  02289000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02290000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02291000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02292000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02293000
*     STATEMENT.                                                        02294000
**********************************************************************  02295000
*                                                                       02296000
SQL#0040 DS    0H                                                       02297000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          02298000
         LA    15,255                  SET RETURN CODE                  02299000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02300000
         BR    14                      RETURN TO CALLER                 02301000
         LTORG                                                          02302000
*                                                                       02303000
*                                                                       02304000
**********************************************************************  02305000
* DELETE STATEMENT BY PRIMARY KEY:                                      02306000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02307000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02308000
**********************************************************************  02309000
*                                                                       02310000
SQL#0041 DS    0H                                                       02311000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          02312000
         B     *+6                     BRANCH AROUND ADCON              02313000
BASE0041 DC    AL2(4096)                                                02314000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02315000
         AH    3,BASE0041              ADD 4K                           02316000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    02317000
         AH    4,BASE0041              ADD 4K                           02318000
         EXEC  SQL                                                     *02319000
               DELETE FROM S10                                         *02320000
                 WHERE CURRENT OF S10UPD0                               02321000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02322000
         BR    14                      RETURN TO CALLER                 02323000
         LTORG                                                          02324000
*                                                                       02325000
*                                                                       02326000
**********************************************************************  02327000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  02328000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02329000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02330000
**********************************************************************  02331000
*                                                                       02332000
SQL#0042 DS    0H                                                       02333000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          02334000
         LA    15,255                  SET RETURN CODE                  02335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02336000
         BR    14                      RETURN TO CALLER                 02337000
         LTORG                                                          02338000
*                                                                       02339000
*                                                                       02340000
**********************************************************************  02341000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  02342000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02343000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02344000
**********************************************************************  02345000
*                                                                       02346000
SQL#0043 DS    0H                                                       02347000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          02348000
         LA    15,255                  SET RETURN CODE                  02349000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02350000
         BR    14                      RETURN TO CALLER                 02351000
         LTORG                                                          02352000
*                                                                       02353000
*                                                                       02354000
**********************************************************************  02355000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  02356000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02357000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02358000
**********************************************************************  02359000
*                                                                       02360000
SQL#0044 DS    0H                                                       02361000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          02362000
         LA    15,255                  SET RETURN CODE                  02363000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02364000
         BR    14                      RETURN TO CALLER                 02365000
         LTORG                                                          02366000
*                                                                       02367000
*                                                                       02368000
**********************************************************************  02369000
* DELETE ALL STATEMENT:                                                 02370000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       02371000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02372000
**********************************************************************  02373000
*                                                                       02374000
SQL#0045 DS    0H                                                       02375000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          02376000
         B     *+6                     BRANCH AROUND ADCON              02377000
BASE0045 DC    AL2(4096)                                                02378000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02379000
         AH    3,BASE0045              ADD 4K                           02380000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    02381000
         AH    4,BASE0045              ADD 4K                           02382000
         EXEC  SQL                                                     *02383000
               DELETE FROM S10                                          02384000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02385000
         BR    14                      RETURN TO CALLER                 02386000
         LTORG                                                          02387000
*                                                                       02388000
*                                                                       02389000
**********************************************************************  02390000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          02391000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                02392000
**********************************************************************  02393000
*                                                                       02394000
SQL#0046 DS    0H                                                       02395000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          02396000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              02397000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02398000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02399000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      02400000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         02401000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               02402000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      02403000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      02404000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     02405000
VECT0046 DC    A(0)                                                     02406000
         DC    A(SQL#0246)                                              02407000
         DC    A(SQL#0346)                                              02408000
         LTORG                                                          02409000
*                                                                       02410000
SQL#0246 DS    0H                                                       02411000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          02412000
         B     *+6                     BRANCH AROUND ADCON              02413000
BASE0246 DC    AL2(4096)                                                02414000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02415000
         AH    3,BASE0246              ADD 4K                           02416000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    02417000
         AH    4,BASE0246              ADD 4K                           02418000
         EXEC  SQL                                                     *02419000
               CLOSE S10SQ001                                           02420000
         EXEC  SQL                                                     *02421000
               DECLARE S10SQ002 CURSOR FOR                             *02422000
               SELECT INST_NBR,                                        *02423000
                   RECORD_NBR,                                         *02424000
                   TRAN_PROFILE,                                       *02425000
                   AUDIT_DATE,                                         *02426000
                   AUDIT_TIME,                                         *02427000
                   AUDIT_USER,                                         *02428000
                   AUDIT_ORG,                                          *02429000
                   DESCRIPTION,                                        *02430000
                   GRACE_DAYS,                                         *02431000
                   ACCUM_COND_01,                                      *02432000
                   ACCUM_01,                                           *02433000
                   REL_CODE_01,                                        *02434000
                   REQM_OPTION_01,                                     *02435000
                   TRAN_COUNT_01,                                      *02436000
                   TRAN_AMOUNT_01,                                     *02437000
                   ACCUM_DESC_01,                                      *02438000
                   ACCUM_COND_02,                                      *02439000
                   ACCUM_02,                                           *02440000
                   REL_CODE_02,                                        *02441000
                   REQM_OPTION_02,                                     *02442000
                   TRAN_COUNT_02,                                      *02443000
                   TRAN_AMOUNT_02,                                     *02444000
                   ACCUM_DESC_02,                                      *02445000
                   ACCUM_COND_03,                                      *02446000
                   ACCUM_03,                                           *02447000
                   REL_CODE_03,                                        *02448000
                   REQM_OPTION_03,                                     *02449000
                   TRAN_COUNT_03,                                      *02450000
                   TRAN_AMOUNT_03,                                     *02451000
                   ACCUM_DESC_03,                                      *02452000
                   ACCUM_COND_04,                                      *02453000
                   ACCUM_04,                                           *02454000
                   REL_CODE_04,                                        *02455000
                   REQM_OPTION_04,                                     *02456000
                   TRAN_COUNT_04,                                      *02457000
                   TRAN_AMOUNT_04,                                     *02458000
                   ACCUM_DESC_04,                                      *02459000
                   ACCUM_COND_05,                                      *02460000
                   ACCUM_05,                                           *02461000
                   REL_CODE_05,                                        *02462000
                   REQM_OPTION_05,                                     *02463000
                   TRAN_COUNT_05,                                      *02464000
                   TRAN_AMOUNT_05,                                     *02465000
                   ACCUM_DESC_05,                                      *02466000
                   ACCUM_COND_06,                                      *02467000
                   ACCUM_06,                                           *02468000
                   REL_CODE_06,                                        *02469000
                   REQM_OPTION_06,                                     *02470000
                   TRAN_COUNT_06,                                      *02471000
                   TRAN_AMOUNT_06,                                     *02472000
                   ACCUM_DESC_06,                                      *02473000
                   ACCUM_COND_07,                                      *02474000
                   ACCUM_07,                                           *02475000
                   REL_CODE_07,                                        *02476000
                   REQM_OPTION_07,                                     *02477000
                   TRAN_COUNT_07,                                      *02478000
                   TRAN_AMOUNT_07,                                     *02479000
                   ACCUM_DESC_07,                                      *02480000
                   ACCUM_COND_08,                                      *02481000
                   ACCUM_08,                                           *02482000
                   REL_CODE_08,                                        *02483000
                   REQM_OPTION_08,                                     *02484000
                   TRAN_COUNT_08,                                      *02485000
                   TRAN_AMOUNT_08,                                     *02486000
                   ACCUM_DESC_08,                                      *02487000
                   ACCUM_COND_09,                                      *02488000
                   ACCUM_09,                                           *02489000
                   REL_CODE_09,                                        *02490000
                   REQM_OPTION_09,                                     *02491000
                   TRAN_COUNT_09,                                      *02492000
                   TRAN_AMOUNT_09,                                     *02493000
                   ACCUM_DESC_09,                                      *02494000
                   ACCUM_COND_10,                                      *02495000
                   ACCUM_10,                                           *02496000
                   REL_CODE_10,                                        *02497000
                   REQM_OPTION_10,                                     *02498000
                   TRAN_COUNT_10,                                      *02499000
                   TRAN_AMOUNT_10,                                     *02500000
                   ACCUM_DESC_10,                                      *02501000
                   ACCUM_COND_11,                                      *02502000
                   ACCUM_11,                                           *02503000
                   REL_CODE_11,                                        *02504000
                   REQM_OPTION_11,                                     *02505000
                   TRAN_COUNT_11,                                      *02506000
                   TRAN_AMOUNT_11,                                     *02507000
                   ACCUM_DESC_11,                                      *02508000
                   ACCUM_COND_12,                                      *02509000
                   ACCUM_12,                                           *02510000
                   REL_CODE_12,                                        *02511000
                   REQM_OPTION_12,                                     *02512000
                   TRAN_COUNT_12,                                      *02513000
                   TRAN_AMOUNT_12,                                     *02514000
                   ACCUM_DESC_12                                       *02515000
                 FROM S10                                              *02516000
                 WHERE                                                 *02517000
                    INST_NBR = :INST AND                               *02518000
                    RECORD_NBR > :RECNBR                               *02519000
                 ORDER BY RECORD_NBR,                                  *02520000
                   TRAN_PROFILE                                        *02521000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02522000
         EXEC  SQL                                                     *02523000
               OPEN S10SQ002                                            02524000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02525000
         BNZ   *+8                     NO - RETURN ERROR                02526000
         LR    12,9                    LOAD RETURN ADDRESS              02527000
         BR    12                      RETURN TO FETCH ROUTINE          02528000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02529000
         BR    14                      RETURN TO CALLER                 02530000
         LTORG                                                          02531000
*                                                                       02532000
SQL#0346 DS    0H                                                       02533000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          02534000
         B     *+6                     BRANCH AROUND ADCON              02535000
BASE0346 DC    AL2(4096)                                                02536000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02537000
         AH    3,BASE0346              ADD 4K                           02538000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    02539000
         AH    4,BASE0346              ADD 4K                           02540000
         EXEC  SQL                                                     *02541000
               CLOSE S10SQ002                                           02542000
         EXEC  SQL                                                     *02543000
               DECLARE S10SQ003 CURSOR FOR                             *02544000
               SELECT INST_NBR,                                        *02545000
                   RECORD_NBR,                                         *02546000
                   TRAN_PROFILE,                                       *02547000
                   AUDIT_DATE,                                         *02548000
                   AUDIT_TIME,                                         *02549000
                   AUDIT_USER,                                         *02550000
                   AUDIT_ORG,                                          *02551000
                   DESCRIPTION,                                        *02552000
                   GRACE_DAYS,                                         *02553000
                   ACCUM_COND_01,                                      *02554000
                   ACCUM_01,                                           *02555000
                   REL_CODE_01,                                        *02556000
                   REQM_OPTION_01,                                     *02557000
                   TRAN_COUNT_01,                                      *02558000
                   TRAN_AMOUNT_01,                                     *02559000
                   ACCUM_DESC_01,                                      *02560000
                   ACCUM_COND_02,                                      *02561000
                   ACCUM_02,                                           *02562000
                   REL_CODE_02,                                        *02563000
                   REQM_OPTION_02,                                     *02564000
                   TRAN_COUNT_02,                                      *02565000
                   TRAN_AMOUNT_02,                                     *02566000
                   ACCUM_DESC_02,                                      *02567000
                   ACCUM_COND_03,                                      *02568000
                   ACCUM_03,                                           *02569000
                   REL_CODE_03,                                        *02570000
                   REQM_OPTION_03,                                     *02571000
                   TRAN_COUNT_03,                                      *02572000
                   TRAN_AMOUNT_03,                                     *02573000
                   ACCUM_DESC_03,                                      *02574000
                   ACCUM_COND_04,                                      *02575000
                   ACCUM_04,                                           *02576000
                   REL_CODE_04,                                        *02577000
                   REQM_OPTION_04,                                     *02578000
                   TRAN_COUNT_04,                                      *02579000
                   TRAN_AMOUNT_04,                                     *02580000
                   ACCUM_DESC_04,                                      *02581000
                   ACCUM_COND_05,                                      *02582000
                   ACCUM_05,                                           *02583000
                   REL_CODE_05,                                        *02584000
                   REQM_OPTION_05,                                     *02585000
                   TRAN_COUNT_05,                                      *02586000
                   TRAN_AMOUNT_05,                                     *02587000
                   ACCUM_DESC_05,                                      *02588000
                   ACCUM_COND_06,                                      *02589000
                   ACCUM_06,                                           *02590000
                   REL_CODE_06,                                        *02591000
                   REQM_OPTION_06,                                     *02592000
                   TRAN_COUNT_06,                                      *02593000
                   TRAN_AMOUNT_06,                                     *02594000
                   ACCUM_DESC_06,                                      *02595000
                   ACCUM_COND_07,                                      *02596000
                   ACCUM_07,                                           *02597000
                   REL_CODE_07,                                        *02598000
                   REQM_OPTION_07,                                     *02599000
                   TRAN_COUNT_07,                                      *02600000
                   TRAN_AMOUNT_07,                                     *02601000
                   ACCUM_DESC_07,                                      *02602000
                   ACCUM_COND_08,                                      *02603000
                   ACCUM_08,                                           *02604000
                   REL_CODE_08,                                        *02605000
                   REQM_OPTION_08,                                     *02606000
                   TRAN_COUNT_08,                                      *02607000
                   TRAN_AMOUNT_08,                                     *02608000
                   ACCUM_DESC_08,                                      *02609000
                   ACCUM_COND_09,                                      *02610000
                   ACCUM_09,                                           *02611000
                   REL_CODE_09,                                        *02612000
                   REQM_OPTION_09,                                     *02613000
                   TRAN_COUNT_09,                                      *02614000
                   TRAN_AMOUNT_09,                                     *02615000
                   ACCUM_DESC_09,                                      *02616000
                   ACCUM_COND_10,                                      *02617000
                   ACCUM_10,                                           *02618000
                   REL_CODE_10,                                        *02619000
                   REQM_OPTION_10,                                     *02620000
                   TRAN_COUNT_10,                                      *02621000
                   TRAN_AMOUNT_10,                                     *02622000
                   ACCUM_DESC_10,                                      *02623000
                   ACCUM_COND_11,                                      *02624000
                   ACCUM_11,                                           *02625000
                   REL_CODE_11,                                        *02626000
                   REQM_OPTION_11,                                     *02627000
                   TRAN_COUNT_11,                                      *02628000
                   TRAN_AMOUNT_11,                                     *02629000
                   ACCUM_DESC_11,                                      *02630000
                   ACCUM_COND_12,                                      *02631000
                   ACCUM_12,                                           *02632000
                   REL_CODE_12,                                        *02633000
                   REQM_OPTION_12,                                     *02634000
                   TRAN_COUNT_12,                                      *02635000
                   TRAN_AMOUNT_12,                                     *02636000
                   ACCUM_DESC_12                                       *02637000
                 FROM S10                                              *02638000
                 WHERE                                                 *02639000
                    INST_NBR > :INST                                   *02640000
                 ORDER BY INST_NBR,                                    *02641000
                   RECORD_NBR,                                         *02642000
                   TRAN_PROFILE                                        *02643000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02644000
         EXEC  SQL                                                     *02645000
               OPEN S10SQ003                                            02646000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02647000
         BNZ   *+8                     NO - RETURN ERROR                02648000
         LR    12,9                    LOAD RETURN ADDRESS              02649000
         BR    12                      RETURN TO FETCH ROUTINE          02650000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02651000
         BR    14                      RETURN TO CALLER                 02652000
         LTORG                                                          02653000
*                                                                       02654000
*                                                                       02655000
**********************************************************************  02656000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02657000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02658000
**********************************************************************  02659000
*                                                                       02660000
SQL#0047 DS    0H                                                       02661000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02662000
         LA    15,255                  SET RETURN CODE                  02663000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02664000
         BR    14                      RETURN TO CALLER                 02665000
         LTORG                                                          02666000
*                                                                       02667000
*                                                                       02668000
**********************************************************************  02669000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02670000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02671000
**********************************************************************  02672000
*                                                                       02673000
SQL#0048 DS    0H                                                       02674000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02675000
         LA    15,255                  SET RETURN CODE                  02676000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02677000
         BR    14                      RETURN TO CALLER                 02678000
         LTORG                                                          02679000
*                                                                       02680000
*                                                                       02681000
**********************************************************************  02682000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02683000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02684000
**********************************************************************  02685000
*                                                                       02686000
SQL#0049 DS    0H                                                       02687000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02688000
         LA    15,255                  SET RETURN CODE                  02689000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02690000
         BR    14                      RETURN TO CALLER                 02691000
         LTORG                                                          02692000
*                                                                       02693000
         DS    0H                      END OF SQL STATEMENTS            02694000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02695000
*                                                                       02696000
*                                                                       02697000
**********************************************************************  02698000
* DUMMY ENTRY POINT DSNHLI                                              02699000
*   MUST NOT BE MODIFIED.                                               02700000
**********************************************************************  02701000
*                                                                       02702000
         ENTRY DSNHLI                                                   02703000
DSNHLI   DS    0H                                                       02704000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02705000
         BR    15                      BRANCH TO ATTACH FACILITY        02706000
*                                                                       02707000
*                                                                       02708000
**********************************************************************  02709000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02710000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02711000
*   MUST NOT BE MODIFIED.                                               02712000
**********************************************************************  02713000
*                                                                       02714000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02715000
CONV#RTN AMODE ANY                                                      02716000
CONV#RTN RMODE ANY                                                      02717000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02718000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02719000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02720000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02721000
         BER   4                         YES - RETURN TO SQL            02722000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02723000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02724000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02725000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02726000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02727000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02728000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02729000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02730000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02731000
*                                                                       02732000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02733000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02734000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02735000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02736000
         BER   4                         YES - RETURN TO SQL            02737000
         SLR   0,0                     CLEAR FOR INSERT                 02738000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02739000
         NR    0,3                     FOR THE CURRENT KEY?             02740000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02741000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02742000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02743000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02744000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02745000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02746000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02747000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02748000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02749000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02750000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02751000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02752000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02753000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02754000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02755000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02756000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02757000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02758000
*                                                                       02759000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02760000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02761000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02762000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02763000
         BER   4                         YES - RETURN TO SQL            02764000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02765000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02766000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02767000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02768000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02769000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02770000
         MVCL  0,14                    MOVE TO RECORD AREA              02771000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02772000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02773000
*                                                                       02774000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02775000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02776000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02777000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02778000
         BER   4                         YES - RETURN TO SQL            02779000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02780000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02781000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02782000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02783000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02784000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02785000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02786000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02787000
         MVCL  0,14                    MOVE TO RECORD AREA              02788000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02789000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02790000
*                                                                       02791000
*                                                                       02792000
**********************************************************************  02793000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02794000
*   MUST NOT BE MODIFIED.                                               02795000
**********************************************************************  02796000
*                                                                       02797000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02798000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02799000
         DC    H'0014'                 LENGTH TO MOVE                   02800000
         DC    X'80'                   80 = KEY 0 FIELD                 02801000
*                                      40 = KEY 1 FIELD                 02802000
*                                      20 = KEY 2 FIELD                 02803000
*                                      10 = KEY 3 FIELD                 02804000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02805000
*                                                                       02806000
*                                      REST OF FIELD ENTRIES            02807000
         DC    H'0014',H'0014',H'0416',X'00',X'00'                      02808000
         DC    8X'FF'                  END OF FIELD ENTRIES             02809000
         LTORG                                                          02810000
         END                                                            02811000
