**********************************************************************  00001000
*                                                                       00002000
*  SAMUDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/27/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAM TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST1    DS    CL4                                                      00050000
PRDCDE1  DS    CL6                                                      00051000
ACCTNBR1 DS    CL18                                                     00052000
EVNTDATE DS    CL8                                                      00053000
INST2    DS    CL4                                                      00054000
PRDCDE2  DS    CL6                                                      00055000
ACCTNBR2 DS    CL18                                                     00056000
MODEL2   DS    CL10                                                     00057000
RECSEQ   DS    CL3                                                      00058000
AUDDATE  DS    PL5'0.'                                                  00059000
AUDTIME  DS    PL5'0.'                                                  00060000
AUDUSER  DS    CL8                                                      00061000
AUDORG   DS    CL6                                                      00062000
EVTCODE  DS    CL2                                                      00063000
SCINCENO DS    CL1                                                      00064000
INCENQ   DS    CL1                                                      00065000
DISCAMT  DS    PL6'0.00'                                                00066000
DISCPCT  DS    PL3'0.00000'                                             00067000
RINCENO  DS    CL1                                                      00068000
RINCENQ  DS    CL1                                                      00069000
RATOPT   DS    CL1                                                      00070000
RATTYP   DS    CL1                                                      00071000
RATEPCT  DS    PL5'0.000000000'                                         00072000
MSGNBR   DS    CL4                                                      00073000
IDNBR    DS    CL18                                                     00074000
MODULE   DS    CL8                                                      00075000
RAREA    DS    CL11                                                     00076000
*                                                                       00077000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00078000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00079000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00080000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00081000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00082000
         DS    CL97                    RESERVED                         00083000
*                                                                       00084000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00085000
INDVARX  DS    0H                                                       00086000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00087000
*                                                                       00088000
*                                                                       00089000
**********************************************************************  00090000
* PROGRAM TABLE HEADER SECTION:                                         00091000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00092000
**********************************************************************  00093000
*                                                                       00094000
SAMUDB   CSECT                         PROGRAM TABLE SECTION            00095000
SAMUDB   AMODE ANY                                                      00096000
SAMUDB   RMODE ANY                                                      00097000
         DC    CL8'SAMUDB  '           PROGRAM ID                       00098000
         DC    CL1' '                                                   00099000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00100000
         DC    CL1' '                                                   00101000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00102000
         DC    CL1' '                                                   00103000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00104000
         DC    5A(0)                   RESERVED                         00105000
         DC    AL2(0)                  RESERVED                         00106000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00107000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00108000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00109000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00110000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00111000
         DC    CL29'WWW.INFOR.COM                '                      00111001
*                                                                       00112000
**********************************************************************  00113000
* STATEMENT TABLE SECTION:                                              00114000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00115000
**********************************************************************  00116000
*                                                                       00117000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00118000
STM#TAB  AMODE ANY                                                      00119000
STM#TAB  RMODE ANY                                                      00120000
         DC    4A(0)                   RDB MODULE VECTORS               00121000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00122000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00123000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00124000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00125000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00126000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00127000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00128000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00129000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00130000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00131000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00132000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00133000
         DC    20A(0)                  RDB MODULE VECTORS               00134000
         DC    A(INSROW)               INSERT STATEMENT                 00135000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00136000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00137000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00138000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00139000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00140000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00141000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00142000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00143000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00144000
         DC    4X'FF'                                                   00145000
*                                                                       00146000
**********************************************************************  00147000
* SQL STATEMENT SECTION:                                                00148000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00149000
*     TO SUPPORT THIS TABLE.                                            00150000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00151000
*     ARE EQUIVALENT.                                                   00152000
**********************************************************************  00153000
*                                                                       00154000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00155000
SQL#STMT AMODE ANY                                                      00156000
SQL#STMT RMODE ANY                                                      00157000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00158000
         USING COM#AREA,11             ADDRESS COMMAREA                 00159000
*                                                                       00160000
**********************************************************************  00161000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00162000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00163000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00164000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00165000
**********************************************************************  00166000
*                                                                       00167000
SELUC0   DS    0H                                                       00168000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00169000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00170000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00171000
         BALR  14,15                   MOVE REQUESTED DATA              00172000
         EXEC  SQL DECLARE SAMUPD0 CURSOR                              *00173000
               FOR SELECT                                              *00174000
                   AUDIT_DATE,                                         *00175000
                   AUDIT_TIME,                                         *00176000
                   AUDIT_USER,                                         *00177000
                   AUDIT_ORG,                                          *00178000
                   EVENT_CODE,                                         *00179000
                   SVC_INCEN_OPT,                                      *00180000
                   SVC_INCEN_QLFY,                                     *00181000
                   DISC_AMT,                                           *00182000
                   DISC_PERCENT,                                       *00183000
                   RATE_INCEN_OPT,                                     *00184000
                   RATE_INCEN_QLFY,                                    *00185000
                   RATE_OPTION,                                        *00186000
                   RATE_TYPE,                                          *00187000
                   RATE_PCT,                                           *00188000
                   MESSAGE_NBR,                                        *00189000
                   IDENT_NBR,                                          *00190000
                   MODULE,                                             *00191000
                   RSV_AREA                                            *00192000
                 FROM SAM                                              *00193000
                 WHERE                                                 *00194000
                   ACCT_INST_1 = :INST1 AND                            *00195000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00196000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00197000
                   EVENT_DATE = :EVNTDATE AND                          *00198000
                   ACCT_INST_2 = :INST2 AND                            *00199000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00200000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00201000
                   MODEL_2 = :MODEL2 AND                               *00202000
                   RECORD_SEQ = :RECSEQ                                *00203000
                 FOR UPDATE OF                                         *00204000
                   AUDIT_DATE,                                         *00205000
                   AUDIT_TIME,                                         *00206000
                   AUDIT_USER,                                         *00207000
                   AUDIT_ORG,                                          *00208000
                   EVENT_CODE,                                         *00209000
                   SVC_INCEN_OPT,                                      *00210000
                   SVC_INCEN_QLFY,                                     *00211000
                   DISC_AMT,                                           *00212000
                   DISC_PERCENT,                                       *00213000
                   RATE_INCEN_OPT,                                     *00214000
                   RATE_INCEN_QLFY,                                    *00215000
                   RATE_OPTION,                                        *00216000
                   RATE_TYPE,                                          *00217000
                   RATE_PCT,                                           *00218000
                   MESSAGE_NBR,                                        *00219000
                   IDENT_NBR,                                          *00220000
                   MODULE,                                             *00221000
                   RSV_AREA                                            *00222000
                 FETCH FIRST 1 ROW ONLY                                 00223000
         EXEC  SQL OPEN SAMUPD0                                         00224000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00225000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00226000
         BR    14                      RETURN TO CALLER                 00227000
         LTORG                                                          00228000
*                                                                       00229000
**********************************************************************  00230000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00231000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00232000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00233000
*     THE ACTUAL ROW.                                                   00234000
**********************************************************************  00235000
*                                                                       00236000
FETUC0   DS    0H                                                       00237000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00238000
         EXEC  SQL FETCH SAMUPD0                                       *00239000
                 INTO                                                  *00240000
                   :AUDDATE,                                           *00241000
                   :AUDTIME,                                           *00242000
                   :AUDUSER,                                           *00243000
                   :AUDORG,                                            *00244000
                   :EVTCODE,                                           *00245000
                   :SCINCENO,                                          *00246000
                   :INCENQ,                                            *00247000
                   :DISCAMT,                                           *00248000
                   :DISCPCT,                                           *00249000
                   :RINCENO,                                           *00250000
                   :RINCENQ,                                           *00251000
                   :RATOPT,                                            *00252000
                   :RATTYP,                                            *00253000
                   :RATEPCT,                                           *00254000
                   :MSGNBR,                                            *00255000
                   :IDNBR,                                             *00256000
                   :MODULE,                                            *00257000
                   :RAREA                                               00258000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00259000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00260000
         BALR  14,15                   MOVE REQUESTED DATA              00261000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00262000
         BR    14                      RETURN TO CALLER                 00263000
         LTORG                                                          00264000
*                                                                       00265000
**********************************************************************  00266000
* INSERT STATEMENT:                                                     00267000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00268000
**********************************************************************  00269000
*                                                                       00270000
INSROW   DS    0H                                                       00271000
         USING INSROW,12               ESTABLISH BASE REGISTER          00272000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00273000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00274000
         BALR  14,15                   MOVE REQUESTED DATA              00275000
         EXEC  SQL INSERT INTO SAM                                     *00276000
                   (                                                   *00277000
                   ACCT_INST_1,                                        *00278000
                   PROD_CODE_1,                                        *00279000
                   ACCT_NBR_1,                                         *00280000
                   EVENT_DATE,                                         *00281000
                   ACCT_INST_2,                                        *00282000
                   PROD_CODE_2,                                        *00283000
                   ACCT_NBR_2,                                         *00284000
                   MODEL_2,                                            *00285000
                   RECORD_SEQ,                                         *00286000
                   AUDIT_DATE,                                         *00287000
                   AUDIT_TIME,                                         *00288000
                   AUDIT_USER,                                         *00289000
                   AUDIT_ORG,                                          *00290000
                   EVENT_CODE,                                         *00291000
                   SVC_INCEN_OPT,                                      *00292000
                   SVC_INCEN_QLFY,                                     *00293000
                   DISC_AMT,                                           *00294000
                   DISC_PERCENT,                                       *00295000
                   RATE_INCEN_OPT,                                     *00296000
                   RATE_INCEN_QLFY,                                    *00297000
                   RATE_OPTION,                                        *00298000
                   RATE_TYPE,                                          *00299000
                   RATE_PCT,                                           *00300000
                   MESSAGE_NBR,                                        *00301000
                   IDENT_NBR,                                          *00302000
                   MODULE,                                             *00303000
                   RSV_AREA                                            *00304000
                   )                                                   *00305000
                  VALUES                                               *00306000
                   (                                                   *00307000
                   :INST1,                                             *00308000
                   :PRDCDE1,                                           *00309000
                   :ACCTNBR1,                                          *00310000
                   :EVNTDATE,                                          *00311000
                   :INST2,                                             *00312000
                   :PRDCDE2,                                           *00313000
                   :ACCTNBR2,                                          *00314000
                   :MODEL2,                                            *00315000
                   :RECSEQ,                                            *00316000
                   :AUDDATE,                                           *00317000
                   :AUDTIME,                                           *00318000
                   :AUDUSER,                                           *00319000
                   :AUDORG,                                            *00320000
                   :EVTCODE,                                           *00321000
                   :SCINCENO,                                          *00322000
                   :INCENQ,                                            *00323000
                   :DISCAMT,                                           *00324000
                   :DISCPCT,                                           *00325000
                   :RINCENO,                                           *00326000
                   :RINCENQ,                                           *00327000
                   :RATOPT,                                            *00328000
                   :RATTYP,                                            *00329000
                   :RATEPCT,                                           *00330000
                   :MSGNBR,                                            *00331000
                   :IDNBR,                                             *00332000
                   :MODULE,                                            *00333000
                   :RAREA                                              *00334000
                   )                                                    00335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00336000
         BR    14                      RETURN TO CALLER                 00337000
         LTORG                                                          00338000
*                                                                       00339000
**********************************************************************  00340000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00341000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00342000
**********************************************************************  00343000
*                                                                       00344000
UPDUC0   DS    0H                                                       00345000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00346000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00347000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00348000
         BALR  14,15                   MOVE REQUESTED DATA              00349000
         EXEC  SQL UPDATE SAM                                          *00350000
                   SET                                                 *00351000
                     AUDIT_DATE = :AUDDATE,                            *00352000
                     AUDIT_TIME = :AUDTIME,                            *00353000
                     AUDIT_USER = :AUDUSER,                            *00354000
                     AUDIT_ORG = :AUDORG,                              *00355000
                     EVENT_CODE = :EVTCODE,                            *00356000
                     SVC_INCEN_OPT = :SCINCENO,                        *00357000
                     SVC_INCEN_QLFY = :INCENQ,                         *00358000
                     DISC_AMT = :DISCAMT,                              *00359000
                     DISC_PERCENT = :DISCPCT,                          *00360000
                     RATE_INCEN_OPT = :RINCENO,                        *00361000
                     RATE_INCEN_QLFY = :RINCENQ,                       *00362000
                     RATE_OPTION = :RATOPT,                            *00363000
                     RATE_TYPE = :RATTYP,                              *00364000
                     RATE_PCT = :RATEPCT,                              *00365000
                     MESSAGE_NBR = :MSGNBR,                            *00366000
                     IDENT_NBR = :IDNBR,                               *00367000
                     MODULE = :MODULE,                                 *00368000
                     RSV_AREA = :RAREA                                 *00369000
                 WHERE CURRENT OF SAMUPD0                               00370000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00371000
         BR    14                      RETURN TO CALLER                 00372000
         LTORG                                                          00373000
*                                                                       00374000
**********************************************************************  00375000
* DELETE STATEMENT BY PRIMARY KEY:                                      00376000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00377000
**********************************************************************  00378000
*                                                                       00379000
DELUC0   DS    0H                                                       00380000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00381000
         EXEC  SQL DELETE FROM SAM                                     *00382000
                 WHERE CURRENT OF SAMUPD0                               00383000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00384000
         BR    14                      RETURN TO CALLER                 00385000
         LTORG                                                          00386000
*                                                                       00387000
**********************************************************************  00388000
* DELETE ALL STATEMENT:                                                 00389000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00390000
**********************************************************************  00391000
*                                                                       00392000
DELTBL   DS    0H                                                       00393000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00394000
         EXEC  SQL DELETE FROM SAM                                      00395000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00396000
         BR    14                      RETURN TO CALLER                 00397000
         LTORG                                                          00398000
*                                                                       00399000
**********************************************************************  00400000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00401000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00402000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00403000
*     TO CLOSE THE UPDATE CURSOR.                                       00404000
**********************************************************************  00405000
*                                                                       00406000
CLSUC0   DS    0H                                                       00407000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00408000
         EXEC  SQL CLOSE SAMUPD0                                        00409000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00410000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00411000
         BR    14                      RETURN TO CALLER                 00412000
         LTORG                                                          00413000
*                                                                       00414000
**********************************************************************  00415000
* ALTERNATE KEY 1 NOT DEFINED                                           00416000
**********************************************************************  00417000
*                                                                       00418000
SELUC1   DS    0H                                                       00419000
FETUC1   DS    0H                                                       00420000
UPDUC1   DS    0H                                                       00421000
DELUC1   DS    0H                                                       00422000
CLSUC1   DS    0H                                                       00423000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00424000
*                                                                       00425000
**********************************************************************  00426000
* ALTERNATE KEY 2 NOT DEFINED                                           00427000
**********************************************************************  00428000
*                                                                       00429000
SELUC2   DS    0H                                                       00430000
FETUC2   DS    0H                                                       00431000
UPDUC2   DS    0H                                                       00432000
DELUC2   DS    0H                                                       00433000
CLSUC2   DS    0H                                                       00434000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00435000
*                                                                       00436000
**********************************************************************  00437000
* ALTERNATE KEY 3 NOT DEFINED                                           00438000
**********************************************************************  00439000
*                                                                       00440000
SELUC3   DS    0H                                                       00441000
FETUC3   DS    0H                                                       00442000
UPDUC3   DS    0H                                                       00443000
DELUC3   DS    0H                                                       00444000
CLSUC3   DS    0H                                                       00445000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00446000
*                                                                       00447000
         DS    0H                      END OF SQL STATEMENTS            00448000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00449000
*                                                                       00450000
**********************************************************************  00451000
* DUMMY ENTRY POINT DSNHLI                                              00452000
**********************************************************************  00453000
*                                                                       00454000
         ENTRY DSNHLI                                                   00455000
DSNHLI   DS    0H                                                       00456000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00457000
         BR    15                      BRANCH TO ATTACH FACILITY        00458000
*                                                                       00459000
**********************************************************************  00460000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00461000
**********************************************************************  00462000
*                                                                       00463000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00464000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00465000
* OR:                                                                   00466000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00467000
* WHERE:                                                                00468000
*   RRRR = RECORD AREA OFFSET                                           00469000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00470000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00471000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00472000
*   KK   = KEY FIELD MASK:                                              00473000
*            80 = KEY 0 FIELD                                           00474000
*            40 = KEY 1 FIELD                                           00475000
*            20 = KEY 2 FIELD                                           00476000
*            10 = KEY 3 FIELD                                           00477000
*   DD   = DATA FIELD MASK:                                             00478000
*            80 = RECORD FIELD IS PACKED                                00479000
*            40 = HOST VARIABLE IS PACKED                               00480000
*            20 = NULLABLE FIELD                                        00481000
*            01 = DATE FIELD                                            00482000
*            02 = TIME FIELD                                            00483000
*                                                                       00484000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00485000
         DC    H'0000',H'0000',H'0077',X'80',X'00'                      00486000
         DC    H'0077',H'0077',H'0087',X'00',X'00'                      00487000
         DC    8X'FF'                                                   00488000
*                                                                       00489000
         LTORG                                                          00490000
         END                                                            00491000
