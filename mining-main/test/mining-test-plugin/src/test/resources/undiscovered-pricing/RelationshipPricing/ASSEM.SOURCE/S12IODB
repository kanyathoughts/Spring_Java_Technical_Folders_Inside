* REL=S12IODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  S12IODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S12 FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL159                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
RECNBR   DS    CL4                                                      00039000
SS_TABLE DS    CL6                                                      00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
BALOPT   DS    CL1                                                      00045000
AMOUNT1  DS    PL6'0.00'                                                00046000
SECSERV1 DS    CL6                                                      00047000
AMOUNT2  DS    PL6'0.00'                                                00048000
SECSERV2 DS    CL6                                                      00049000
AMOUNT3  DS    PL6'0.00'                                                00050000
SECSERV3 DS    CL6                                                      00051000
AMOUNT4  DS    PL6'0.00'                                                00052000
SECSERV4 DS    CL6                                                      00053000
AMOUNT5  DS    PL6'0.00'                                                00054000
SECSERV5 DS    CL6                                                      00055000
AMOUNT6  DS    PL6'0.00'                                                00056000
SECSERV6 DS    CL6                                                      00057000
AMOUNT7  DS    PL6'0.00'                                                00058000
SECSERV7 DS    CL6                                                      00059000
AMOUNT8  DS    PL6'0.00'                                                00060000
SECSERV8 DS    CL6                                                      00061000
AMOUNT9  DS    PL6'0.00'                                                00062000
SECSERV9 DS    CL6                                                      00063000
AMOUNT10 DS    PL6'0.00'                                                00064000
SECSER10 DS    CL6                                                      00065000
*                                                                       00066000
*                                                                       00067000
**********************************************************************  00068000
* PROGRAM TABLE HEADER SECTION:                                         00069000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00070000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00071000
**********************************************************************  00072000
*                                                                       00073000
S12IODB  CSECT                         PROGRAM TABLE SECTION            00074000
S12IODB  AMODE ANY                                                      00075000
S12IODB  RMODE ANY                                                      00076000
         DC    CL9'S12IODB'            PROGRAM ID                       00077000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00078000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00079000
         DC    A(0)                    RESERVED                         00080000
         DC    A(0)                    RESERVED                         00081000
         DC    24CL1' '                RESERVED                         00082000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00083000
*                                                                       00084000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00085000
         DC    CL29'WWW.INFOR.COM                '                      00085001
*                                                                       00086000
*                                                                       00087000
**********************************************************************  00088000
* STATEMENT TABLE SECTION:                                              00089000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00090000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00091000
*   SHOULD NOT BE MODIFIED.                                             00092000
**********************************************************************  00093000
*                                                                       00094000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00095000
STM#TAB  AMODE ANY                                                      00096000
STM#TAB  RMODE ANY                                                      00097000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00098000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00099000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00100000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00101000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00102000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00103000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00104000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00105000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00106000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00107000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00108000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00109000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00110000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00111000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00112000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00113000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00114000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00115000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00116000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00117000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00118000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00119000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00120000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00121000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00122000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00123000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00124000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00125000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00126000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00127000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00128000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00129000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00130000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00131000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00132000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00133000
         DC    A(SQL#0036)             INSERT STATEMENT                 00134000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00135000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00136000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00137000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00138000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00139000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00140000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00141000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00142000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00143000
         DC    4X'FF'                                                   00144000
*                                                                       00145000
*                                                                       00146000
**********************************************************************  00147000
* SQL STATEMENT SECTION:                                                00148000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00149000
*     TO SUPPORT THIS TABLE.                                            00150000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00151000
*     ARE EQUIVALENT.                                                   00152000
**********************************************************************  00153000
*                                                                       00154000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00155000
SQL#STMT AMODE ANY                                                      00156000
SQL#STMT RMODE ANY                                                      00157000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00158000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00159000
         USING COM#AREA,11             ADDRESS COMMAREA                 00160000
*                                                                       00161000
*                                                                       00162000
**********************************************************************  00163000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00164000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00165000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00166000
**********************************************************************  00167000
*                                                                       00168000
SQL#0000 DS    0H                                                       00169000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00170000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00171000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00172000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00173000
         EXEC  SQL                                                     *00174000
               SELECT AUDIT_DATE,                                      *00175000
                   AUDIT_TIME,                                         *00176000
                   AUDIT_USER,                                         *00177000
                   AUDIT_ORG,                                          *00178000
                   BAL_OPT,                                            *00179000
                   AMOUNT_01,                                          *00180000
                   SEC_SVC_01,                                         *00181000
                   AMOUNT_02,                                          *00182000
                   SEC_SVC_02,                                         *00183000
                   AMOUNT_03,                                          *00184000
                   SEC_SVC_03,                                         *00185000
                   AMOUNT_04,                                          *00186000
                   SEC_SVC_04,                                         *00187000
                   AMOUNT_05,                                          *00188000
                   SEC_SVC_05,                                         *00189000
                   AMOUNT_06,                                          *00190000
                   SEC_SVC_06,                                         *00191000
                   AMOUNT_07,                                          *00192000
                   SEC_SVC_07,                                         *00193000
                   AMOUNT_08,                                          *00194000
                   SEC_SVC_08,                                         *00195000
                   AMOUNT_09,                                          *00196000
                   SEC_SVC_09,                                         *00197000
                   AMOUNT_10,                                          *00198000
                   SEC_SVC10                                           *00199000
                 INTO :AUDDATE,                                        *00200000
                   :AUDTIME,                                           *00201000
                   :AUDUSER,                                           *00202000
                   :AUDORG,                                            *00203000
                   :BALOPT,                                            *00204000
                   :AMOUNT1,                                           *00205000
                   :SECSERV1,                                          *00206000
                   :AMOUNT2,                                           *00207000
                   :SECSERV2,                                          *00208000
                   :AMOUNT3,                                           *00209000
                   :SECSERV3,                                          *00210000
                   :AMOUNT4,                                           *00211000
                   :SECSERV4,                                          *00212000
                   :AMOUNT5,                                           *00213000
                   :SECSERV5,                                          *00214000
                   :AMOUNT6,                                           *00215000
                   :SECSERV6,                                          *00216000
                   :AMOUNT7,                                           *00217000
                   :SECSERV7,                                          *00218000
                   :AMOUNT8,                                           *00219000
                   :SECSERV8,                                          *00220000
                   :AMOUNT9,                                           *00221000
                   :SECSERV9,                                          *00222000
                   :AMOUNT10,                                          *00223000
                   :SECSER10                                           *00224000
                 FROM S12                                              *00225000
                 WHERE INST_NBR = :INST AND                            *00226000
                   RECORD_NBR = :RECNBR AND                            *00227000
                   SEC_SVC_TABLE = :SS_TABLE                           *00228000
                 FETCH FIRST 1 ROW ONLY                                 00229000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00230000
         BALR  4,5                     MOVE INTO RECORD AREA            00231000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00232000
         BR    14                      RETURN TO CALLER                 00233000
         LTORG                                                          00234000
*                                                                       00235000
*                                                                       00236000
**********************************************************************  00237000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00238000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00239000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00240000
**********************************************************************  00241000
*                                                                       00242000
SQL#0001 DS    0H                                                       00243000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00244000
         LA    15,255                  SET RETURN CODE                  00245000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00246000
         BR    14                      RETURN TO CALLER                 00247000
         LTORG                                                          00248000
*                                                                       00249000
*                                                                       00250000
**********************************************************************  00251000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00252000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00253000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00254000
**********************************************************************  00255000
*                                                                       00256000
SQL#0002 DS    0H                                                       00257000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00258000
         LA    15,255                  SET RETURN CODE                  00259000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00260000
         BR    14                      RETURN TO CALLER                 00261000
         LTORG                                                          00262000
*                                                                       00263000
*                                                                       00264000
**********************************************************************  00265000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00266000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00267000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00268000
**********************************************************************  00269000
*                                                                       00270000
SQL#0003 DS    0H                                                       00271000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00272000
         LA    15,255                  SET RETURN CODE                  00273000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00274000
         BR    14                      RETURN TO CALLER                 00275000
         LTORG                                                          00276000
*                                                                       00277000
*                                                                       00278000
**********************************************************************  00279000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00280000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00281000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00282000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00283000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00284000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00285000
*     UPDATE STATEMENT TO MATCH.                                        00286000
**********************************************************************  00287000
*                                                                       00288000
SQL#0004 DS    0H                                                       00289000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00290000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00291000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00292000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00293000
         EXEC  SQL                                                     *00294000
               DECLARE S12UPD0 CURSOR FOR                              *00295000
               SELECT AUDIT_DATE,                                      *00296000
                   AUDIT_TIME,                                         *00297000
                   AUDIT_USER,                                         *00298000
                   AUDIT_ORG,                                          *00299000
                   BAL_OPT,                                            *00300000
                   AMOUNT_01,                                          *00301000
                   SEC_SVC_01,                                         *00302000
                   AMOUNT_02,                                          *00303000
                   SEC_SVC_02,                                         *00304000
                   AMOUNT_03,                                          *00305000
                   SEC_SVC_03,                                         *00306000
                   AMOUNT_04,                                          *00307000
                   SEC_SVC_04,                                         *00308000
                   AMOUNT_05,                                          *00309000
                   SEC_SVC_05,                                         *00310000
                   AMOUNT_06,                                          *00311000
                   SEC_SVC_06,                                         *00312000
                   AMOUNT_07,                                          *00313000
                   SEC_SVC_07,                                         *00314000
                   AMOUNT_08,                                          *00315000
                   SEC_SVC_08,                                         *00316000
                   AMOUNT_09,                                          *00317000
                   SEC_SVC_09,                                         *00318000
                   AMOUNT_10,                                          *00319000
                   SEC_SVC10                                           *00320000
                 FROM S12                                              *00321000
                 WHERE INST_NBR = :INST AND                            *00322000
                   RECORD_NBR = :RECNBR AND                            *00323000
                   SEC_SVC_TABLE = :SS_TABLE                           *00324000
                 FOR UPDATE OF AUDIT_DATE,                             *00325000
                   AUDIT_TIME,                                         *00326000
                   AUDIT_USER,                                         *00327000
                   AUDIT_ORG,                                          *00328000
                   BAL_OPT,                                            *00329000
                   AMOUNT_01,                                          *00330000
                   SEC_SVC_01,                                         *00331000
                   AMOUNT_02,                                          *00332000
                   SEC_SVC_02,                                         *00333000
                   AMOUNT_03,                                          *00334000
                   SEC_SVC_03,                                         *00335000
                   AMOUNT_04,                                          *00336000
                   SEC_SVC_04,                                         *00337000
                   AMOUNT_05,                                          *00338000
                   SEC_SVC_05,                                         *00339000
                   AMOUNT_06,                                          *00340000
                   SEC_SVC_06,                                         *00341000
                   AMOUNT_07,                                          *00342000
                   SEC_SVC_07,                                         *00343000
                   AMOUNT_08,                                          *00344000
                   SEC_SVC_08,                                         *00345000
                   AMOUNT_09,                                          *00346000
                   SEC_SVC_09,                                         *00347000
                   AMOUNT_10,                                          *00348000
                   SEC_SVC10                                           *00349000
                 FETCH FIRST 1 ROW ONLY                                 00350000
         EXEC  SQL                                                     *00351000
               OPEN S12UPD0                                             00352000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00353000
         BR    14                      RETURN TO CALLER                 00354000
         LTORG                                                          00355000
*                                                                       00356000
*                                                                       00357000
**********************************************************************  00358000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00359000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00360000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00361000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00362000
*     UPDATE STATEMENT TO MATCH.                                        00363000
**********************************************************************  00364000
*                                                                       00365000
SQL#0005 DS    0H                                                       00366000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00367000
         LA    15,255                  SET RETURN CODE                  00368000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00369000
         BR    14                      RETURN TO CALLER                 00370000
         LTORG                                                          00371000
*                                                                       00372000
*                                                                       00373000
**********************************************************************  00374000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00375000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00376000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00377000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00378000
*     UPDATE STATEMENT TO MATCH.                                        00379000
**********************************************************************  00380000
*                                                                       00381000
SQL#0006 DS    0H                                                       00382000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00383000
         LA    15,255                  SET RETURN CODE                  00384000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00385000
         BR    14                      RETURN TO CALLER                 00386000
         LTORG                                                          00387000
*                                                                       00388000
*                                                                       00389000
**********************************************************************  00390000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00391000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00392000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00393000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00394000
*     UPDATE STATEMENT TO MATCH.                                        00395000
**********************************************************************  00396000
*                                                                       00397000
SQL#0007 DS    0H                                                       00398000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00399000
         LA    15,255                  SET RETURN CODE                  00400000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00401000
         BR    14                      RETURN TO CALLER                 00402000
         LTORG                                                          00403000
*                                                                       00404000
*                                                                       00405000
**********************************************************************  00406000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00407000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00408000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00409000
*     THE ACTUAL ROW.                                                   00410000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00411000
**********************************************************************  00412000
*                                                                       00413000
SQL#0008 DS    0H                                                       00414000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00415000
         EXEC  SQL                                                     *00416000
               FETCH S12UPD0                                           *00417000
                 INTO :AUDDATE,                                        *00418000
                   :AUDTIME,                                           *00419000
                   :AUDUSER,                                           *00420000
                   :AUDORG,                                            *00421000
                   :BALOPT,                                            *00422000
                   :AMOUNT1,                                           *00423000
                   :SECSERV1,                                          *00424000
                   :AMOUNT2,                                           *00425000
                   :SECSERV2,                                          *00426000
                   :AMOUNT3,                                           *00427000
                   :SECSERV3,                                          *00428000
                   :AMOUNT4,                                           *00429000
                   :SECSERV4,                                          *00430000
                   :AMOUNT5,                                           *00431000
                   :SECSERV5,                                          *00432000
                   :AMOUNT6,                                           *00433000
                   :SECSERV6,                                          *00434000
                   :AMOUNT7,                                           *00435000
                   :SECSERV7,                                          *00436000
                   :AMOUNT8,                                           *00437000
                   :SECSERV8,                                          *00438000
                   :AMOUNT9,                                           *00439000
                   :SECSERV9,                                          *00440000
                   :AMOUNT10,                                          *00441000
                   :SECSER10                                            00442000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00443000
         BALR  4,5                     MOVE INTO RECORD AREA            00444000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00445000
         BR    14                      RETURN TO CALLER                 00446000
         LTORG                                                          00447000
*                                                                       00448000
*                                                                       00449000
**********************************************************************  00450000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00451000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00452000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00453000
*     THE ACTUAL ROW.                                                   00454000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00455000
**********************************************************************  00456000
*                                                                       00457000
SQL#0009 DS    0H                                                       00458000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00459000
         LA    15,255                  SET RETURN CODE                  00460000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00461000
         BR    14                      RETURN TO CALLER                 00462000
         LTORG                                                          00463000
*                                                                       00464000
*                                                                       00465000
**********************************************************************  00466000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00467000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00468000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00469000
*     THE ACTUAL ROW.                                                   00470000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00471000
**********************************************************************  00472000
*                                                                       00473000
SQL#0010 DS    0H                                                       00474000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00475000
         LA    15,255                  SET RETURN CODE                  00476000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00477000
         BR    14                      RETURN TO CALLER                 00478000
         LTORG                                                          00479000
*                                                                       00480000
*                                                                       00481000
**********************************************************************  00482000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00483000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00484000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00485000
*     THE ACTUAL ROW.                                                   00486000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00487000
**********************************************************************  00488000
*                                                                       00489000
SQL#0011 DS    0H                                                       00490000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00491000
         LA    15,255                  SET RETURN CODE                  00492000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00493000
         BR    14                      RETURN TO CALLER                 00494000
         LTORG                                                          00495000
*                                                                       00496000
*                                                                       00497000
**********************************************************************  00498000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00499000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00500000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00501000
*     TO CLOSE THE UPDATE CURSOR.                                       00502000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00503000
**********************************************************************  00504000
*                                                                       00505000
SQL#0012 DS    0H                                                       00506000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00507000
         EXEC  SQL                                                     *00508000
               CLOSE S12UPD0                                            00509000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00510000
         BR    14                      RETURN TO CALLER                 00511000
         LTORG                                                          00512000
*                                                                       00513000
*                                                                       00514000
**********************************************************************  00515000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00516000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00517000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00518000
*     TO CLOSE THE UPDATE CURSOR.                                       00519000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00520000
**********************************************************************  00521000
*                                                                       00522000
SQL#0013 DS    0H                                                       00523000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00524000
         LA    15,255                  SET RETURN CODE                  00525000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00526000
         BR    14                      RETURN TO CALLER                 00527000
         LTORG                                                          00528000
*                                                                       00529000
*                                                                       00530000
**********************************************************************  00531000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00532000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00533000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00534000
*     TO CLOSE THE UPDATE CURSOR.                                       00535000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00536000
**********************************************************************  00537000
*                                                                       00538000
SQL#0014 DS    0H                                                       00539000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00540000
         LA    15,255                  SET RETURN CODE                  00541000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00542000
         BR    14                      RETURN TO CALLER                 00543000
         LTORG                                                          00544000
*                                                                       00545000
*                                                                       00546000
**********************************************************************  00547000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00548000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00549000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00550000
*     TO CLOSE THE UPDATE CURSOR.                                       00551000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00552000
**********************************************************************  00553000
*                                                                       00554000
SQL#0015 DS    0H                                                       00555000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00556000
         LA    15,255                  SET RETURN CODE                  00557000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00558000
         BR    14                      RETURN TO CALLER                 00559000
         LTORG                                                          00560000
*                                                                       00561000
*                                                                       00562000
**********************************************************************  00563000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00564000
* KEY:                                                                  00565000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00566000
*     AND GET-NEXT-LOCK VERBS.                                          00567000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00568000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00569000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00570000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00571000
*     ORDER BY CLAUSE.                                                  00572000
**********************************************************************  00573000
*                                                                       00574000
SQL#0016 DS    0H                                                       00575000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00576000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00577000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00578000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00579000
         EXEC  SQL                                                     *00580000
               DECLARE S12SQ001 CURSOR FOR                             *00581000
               SELECT INST_NBR,                                        *00582000
                   RECORD_NBR,                                         *00583000
                   SEC_SVC_TABLE,                                      *00584000
                   AUDIT_DATE,                                         *00585000
                   AUDIT_TIME,                                         *00586000
                   AUDIT_USER,                                         *00587000
                   AUDIT_ORG,                                          *00588000
                   BAL_OPT,                                            *00589000
                   AMOUNT_01,                                          *00590000
                   SEC_SVC_01,                                         *00591000
                   AMOUNT_02,                                          *00592000
                   SEC_SVC_02,                                         *00593000
                   AMOUNT_03,                                          *00594000
                   SEC_SVC_03,                                         *00595000
                   AMOUNT_04,                                          *00596000
                   SEC_SVC_04,                                         *00597000
                   AMOUNT_05,                                          *00598000
                   SEC_SVC_05,                                         *00599000
                   AMOUNT_06,                                          *00600000
                   SEC_SVC_06,                                         *00601000
                   AMOUNT_07,                                          *00602000
                   SEC_SVC_07,                                         *00603000
                   AMOUNT_08,                                          *00604000
                   SEC_SVC_08,                                         *00605000
                   AMOUNT_09,                                          *00606000
                   SEC_SVC_09,                                         *00607000
                   AMOUNT_10,                                          *00608000
                   SEC_SVC10                                           *00609000
                 FROM S12                                              *00610000
                 WHERE                                                 *00611000
                    INST_NBR = :INST AND                               *00612000
                    RECORD_NBR = :RECNBR AND                           *00613000
                    SEC_SVC_TABLE >= :SS_TABLE                         *00614000
                 ORDER BY SEC_SVC_TABLE                                *00615000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00616000
         EXEC  SQL                                                     *00617000
               OPEN S12SQ001                                            00618000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00619000
         BR    14                      RETURN TO CALLER                 00620000
         LTORG                                                          00621000
*                                                                       00622000
*                                                                       00623000
**********************************************************************  00624000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00625000
* KEY 1:                                                                00626000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00627000
*     AND GET-NEXT-LOCK VERBS.                                          00628000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00629000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00630000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00631000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00632000
*     ORDER BY CLAUSE.                                                  00633000
**********************************************************************  00634000
*                                                                       00635000
SQL#0017 DS    0H                                                       00636000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00637000
         LA    15,255                  SET RETURN CODE                  00638000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00639000
         BR    14                      RETURN TO CALLER                 00640000
         LTORG                                                          00641000
*                                                                       00642000
*                                                                       00643000
**********************************************************************  00644000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00645000
* KEY 2:                                                                00646000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00647000
*     AND GET-NEXT-LOCK VERBS.                                          00648000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00649000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00650000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00651000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00652000
*     ORDER BY CLAUSE.                                                  00653000
**********************************************************************  00654000
*                                                                       00655000
SQL#0018 DS    0H                                                       00656000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00657000
         LA    15,255                  SET RETURN CODE                  00658000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00659000
         BR    14                      RETURN TO CALLER                 00660000
         LTORG                                                          00661000
*                                                                       00662000
*                                                                       00663000
**********************************************************************  00664000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00665000
* KEY 3:                                                                00666000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00667000
*     AND GET-NEXT-LOCK VERBS.                                          00668000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00669000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00670000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00671000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00672000
*     ORDER BY CLAUSE.                                                  00673000
**********************************************************************  00674000
*                                                                       00675000
SQL#0019 DS    0H                                                       00676000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00677000
         LA    15,255                  SET RETURN CODE                  00678000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00679000
         BR    14                      RETURN TO CALLER                 00680000
         LTORG                                                          00681000
*                                                                       00682000
*                                                                       00683000
**********************************************************************  00684000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00685000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00686000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00687000
*     RETRIEVE THE ACTUAL ROW.                                          00688000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00689000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00690000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00691000
**********************************************************************  00692000
*                                                                       00693000
SQL#0020 DS    0H                                                       00694000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00695000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00696000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00697000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00698000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00699000
VECT0020 DC    A(SQL#0120)                                              00700000
         DC    A(SQL#0220)                                              00701000
         DC    A(SQL#0320)                                              00702000
         LTORG                                                          00703000
*                                                                       00704000
SQL#0120 DS    0H                                                       00705000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00706000
         EXEC  SQL                                                     *00707000
               FETCH S12SQ001                                          *00708000
                 INTO :INST,                                           *00709000
                      :RECNBR,                                         *00710000
                      :SS_TABLE,                                       *00711000
                      :AUDDATE,                                        *00712000
                      :AUDTIME,                                        *00713000
                      :AUDUSER,                                        *00714000
                      :AUDORG,                                         *00715000
                      :BALOPT,                                         *00716000
                      :AMOUNT1,                                        *00717000
                      :SECSERV1,                                       *00718000
                      :AMOUNT2,                                        *00719000
                      :SECSERV2,                                       *00720000
                      :AMOUNT3,                                        *00721000
                      :SECSERV3,                                       *00722000
                      :AMOUNT4,                                        *00723000
                      :SECSERV4,                                       *00724000
                      :AMOUNT5,                                        *00725000
                      :SECSERV5,                                       *00726000
                      :AMOUNT6,                                        *00727000
                      :SECSERV6,                                       *00728000
                      :AMOUNT7,                                        *00729000
                      :SECSERV7,                                       *00730000
                      :AMOUNT8,                                        *00731000
                      :SECSERV8,                                       *00732000
                      :AMOUNT9,                                        *00733000
                      :SECSERV9,                                       *00734000
                      :AMOUNT10,                                       *00735000
                      :SECSER10                                         00736000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00737000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00738000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00739000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00740000
         BR    12                      OPEN NEXT CURSOR                 00741000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00742000
         BALR  4,5                     MOVE INTO RECORD AREA            00743000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00744000
         BR    14                      RETURN TO CALLER                 00745000
         LTORG                                                          00746000
*                                                                       00747000
SQL#0220 DS    0H                                                       00748000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00749000
         EXEC  SQL                                                     *00750000
               FETCH S12SQ002                                          *00751000
                 INTO :INST,                                           *00752000
                      :RECNBR,                                         *00753000
                      :SS_TABLE,                                       *00754000
                      :AUDDATE,                                        *00755000
                      :AUDTIME,                                        *00756000
                      :AUDUSER,                                        *00757000
                      :AUDORG,                                         *00758000
                      :BALOPT,                                         *00759000
                      :AMOUNT1,                                        *00760000
                      :SECSERV1,                                       *00761000
                      :AMOUNT2,                                        *00762000
                      :SECSERV2,                                       *00763000
                      :AMOUNT3,                                        *00764000
                      :SECSERV3,                                       *00765000
                      :AMOUNT4,                                        *00766000
                      :SECSERV4,                                       *00767000
                      :AMOUNT5,                                        *00768000
                      :SECSERV5,                                       *00769000
                      :AMOUNT6,                                        *00770000
                      :SECSERV6,                                       *00771000
                      :AMOUNT7,                                        *00772000
                      :SECSERV7,                                       *00773000
                      :AMOUNT8,                                        *00774000
                      :SECSERV8,                                       *00775000
                      :AMOUNT9,                                        *00776000
                      :SECSERV9,                                       *00777000
                      :AMOUNT10,                                       *00778000
                      :SECSER10                                         00779000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00780000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00781000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00782000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00783000
         BR    12                      OPEN NEXT CURSOR                 00784000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00785000
         BALR  4,5                     MOVE INTO RECORD AREA            00786000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00787000
         BR    14                      RETURN TO CALLER                 00788000
         LTORG                                                          00789000
*                                                                       00790000
SQL#0320 DS    0H                                                       00791000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00792000
         EXEC  SQL                                                     *00793000
               FETCH S12SQ003                                          *00794000
                 INTO :INST,                                           *00795000
                      :RECNBR,                                         *00796000
                      :SS_TABLE,                                       *00797000
                      :AUDDATE,                                        *00798000
                      :AUDTIME,                                        *00799000
                      :AUDUSER,                                        *00800000
                      :AUDORG,                                         *00801000
                      :BALOPT,                                         *00802000
                      :AMOUNT1,                                        *00803000
                      :SECSERV1,                                       *00804000
                      :AMOUNT2,                                        *00805000
                      :SECSERV2,                                       *00806000
                      :AMOUNT3,                                        *00807000
                      :SECSERV3,                                       *00808000
                      :AMOUNT4,                                        *00809000
                      :SECSERV4,                                       *00810000
                      :AMOUNT5,                                        *00811000
                      :SECSERV5,                                       *00812000
                      :AMOUNT6,                                        *00813000
                      :SECSERV6,                                       *00814000
                      :AMOUNT7,                                        *00815000
                      :SECSERV7,                                       *00816000
                      :AMOUNT8,                                        *00817000
                      :SECSERV8,                                       *00818000
                      :AMOUNT9,                                        *00819000
                      :SECSERV9,                                       *00820000
                      :AMOUNT10,                                       *00821000
                      :SECSER10                                         00822000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00823000
         BALR  4,5                     MOVE INTO RECORD AREA            00824000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00825000
         BR    14                      RETURN TO CALLER                 00826000
         LTORG                                                          00827000
*                                                                       00828000
*                                                                       00829000
**********************************************************************  00830000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00831000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00832000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00833000
*     RETRIEVE THE ACTUAL ROW.                                          00834000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00835000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00836000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00837000
**********************************************************************  00838000
*                                                                       00839000
SQL#0021 DS    0H                                                       00840000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00841000
         LA    15,255                  SET RETURN CODE                  00842000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00843000
         BR    14                      RETURN TO CALLER                 00844000
         LTORG                                                          00845000
*                                                                       00846000
*                                                                       00847000
**********************************************************************  00848000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           00849000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00850000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00851000
*     RETRIEVE THE ACTUAL ROW.                                          00852000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00853000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00854000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00855000
**********************************************************************  00856000
*                                                                       00857000
SQL#0022 DS    0H                                                       00858000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          00859000
         LA    15,255                  SET RETURN CODE                  00860000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00861000
         BR    14                      RETURN TO CALLER                 00862000
         LTORG                                                          00863000
*                                                                       00864000
*                                                                       00865000
**********************************************************************  00866000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           00867000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00868000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00869000
*     RETRIEVE THE ACTUAL ROW.                                          00870000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00871000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00872000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00873000
**********************************************************************  00874000
*                                                                       00875000
SQL#0023 DS    0H                                                       00876000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          00877000
         LA    15,255                  SET RETURN CODE                  00878000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00879000
         BR    14                      RETURN TO CALLER                 00880000
         LTORG                                                          00881000
*                                                                       00882000
*                                                                       00883000
**********************************************************************  00884000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00885000
* THE PRIMARY KEY:                                                      00886000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00887000
*     VERBS.                                                            00888000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00889000
*     RETRIEVE THE ACTUAL ROW.                                          00890000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00891000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00892000
*     WILL BE THRU THE UPDATE CURSOR.                                   00893000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00894000
**********************************************************************  00895000
*                                                                       00896000
SQL#0024 DS    0H                                                       00897000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          00898000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00899000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    00900000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00901000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00902000
VECT0024 DC    A(SQL#0124)                                              00903000
         DC    A(SQL#0224)                                              00904000
         DC    A(SQL#0324)                                              00905000
         LTORG                                                          00906000
*                                                                       00907000
SQL#0124 DS    0H                                                       00908000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          00909000
         EXEC  SQL                                                     *00910000
               FETCH S12SQ001                                          *00911000
                 INTO :INST,                                           *00912000
                      :RECNBR,                                         *00913000
                      :SS_TABLE                                         00914000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00915000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00916000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00917000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00918000
         BR    12                      OPEN NEXT CURSOR                 00919000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00920000
         BALR  4,5                     MOVE INTO RECORD AREA            00921000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00922000
         BR    14                      RETURN TO CALLER                 00923000
         LTORG                                                          00924000
*                                                                       00925000
SQL#0224 DS    0H                                                       00926000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          00927000
         EXEC  SQL                                                     *00928000
               FETCH S12SQ002                                          *00929000
                 INTO :INST,                                           *00930000
                      :RECNBR,                                         *00931000
                      :SS_TABLE                                         00932000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00933000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00934000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00935000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00936000
         BR    12                      OPEN NEXT CURSOR                 00937000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00938000
         BALR  4,5                     MOVE INTO RECORD AREA            00939000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00940000
         BR    14                      RETURN TO CALLER                 00941000
         LTORG                                                          00942000
*                                                                       00943000
SQL#0324 DS    0H                                                       00944000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          00945000
         EXEC  SQL                                                     *00946000
               FETCH S12SQ003                                          *00947000
                 INTO :INST,                                           *00948000
                      :RECNBR,                                         *00949000
                      :SS_TABLE                                         00950000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00951000
         BALR  4,5                     MOVE INTO RECORD AREA            00952000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00953000
         BR    14                      RETURN TO CALLER                 00954000
         LTORG                                                          00955000
*                                                                       00956000
*                                                                       00957000
**********************************************************************  00958000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00959000
* ALTERNATE KEY 1:                                                      00960000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00961000
*     VERBS.                                                            00962000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00963000
*     RETRIEVE THE ACTUAL ROW.                                          00964000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00965000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00966000
*     WILL BE THRU THE UPDATE CURSOR.                                   00967000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00968000
**********************************************************************  00969000
*                                                                       00970000
SQL#0025 DS    0H                                                       00971000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          00972000
         LA    15,255                  SET RETURN CODE                  00973000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00974000
         BR    14                      RETURN TO CALLER                 00975000
         LTORG                                                          00976000
*                                                                       00977000
*                                                                       00978000
**********************************************************************  00979000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00980000
* ALTERNATE KEY 2:                                                      00981000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00982000
*     VERBS.                                                            00983000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00984000
*     RETRIEVE THE ACTUAL ROW.                                          00985000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00986000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00987000
*     WILL BE THRU THE UPDATE CURSOR.                                   00988000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00989000
**********************************************************************  00990000
*                                                                       00991000
SQL#0026 DS    0H                                                       00992000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          00993000
         LA    15,255                  SET RETURN CODE                  00994000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00995000
         BR    14                      RETURN TO CALLER                 00996000
         LTORG                                                          00997000
*                                                                       00998000
*                                                                       00999000
**********************************************************************  01000000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01001000
* ALTERNATE KEY 3:                                                      01002000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01003000
*     VERBS.                                                            01004000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01005000
*     RETRIEVE THE ACTUAL ROW.                                          01006000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01007000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01008000
*     WILL BE THRU THE UPDATE CURSOR.                                   01009000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01010000
**********************************************************************  01011000
*                                                                       01012000
SQL#0027 DS    0H                                                       01013000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01014000
         LA    15,255                  SET RETURN CODE                  01015000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01016000
         BR    14                      RETURN TO CALLER                 01017000
         LTORG                                                          01018000
*                                                                       01019000
*                                                                       01020000
**********************************************************************  01021000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01022000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01023000
*     AND GET-NEXT-LOCK VERBS.                                          01024000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01025000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01026000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01027000
**********************************************************************  01028000
*                                                                       01029000
SQL#0028 DS    0H                                                       01030000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01031000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01032000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01033000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01034000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01035000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01036000
VECT0028 DC    A(SQL#0128)                                              01037000
         DC    A(SQL#0228)                                              01038000
         DC    A(SQL#0328)                                              01039000
         LTORG                                                          01040000
*                                                                       01041000
SQL#0128 DS    0H                                                       01042000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01043000
         EXEC  SQL                                                     *01044000
               CLOSE S12SQ001                                           01045000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01046000
         BR    14                      RETURN TO CALLER                 01047000
         LTORG                                                          01048000
*                                                                       01049000
SQL#0228 DS    0H                                                       01050000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01051000
         EXEC  SQL                                                     *01052000
               CLOSE S12SQ002                                           01053000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01054000
         BR    14                      RETURN TO CALLER                 01055000
         LTORG                                                          01056000
*                                                                       01057000
SQL#0328 DS    0H                                                       01058000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01059000
         EXEC  SQL                                                     *01060000
               CLOSE S12SQ003                                           01061000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01062000
         BR    14                      RETURN TO CALLER                 01063000
         LTORG                                                          01064000
*                                                                       01065000
*                                                                       01066000
**********************************************************************  01067000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01068000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01069000
*     AND GET-NEXT-LOCK VERBS.                                          01070000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01071000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01072000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01073000
**********************************************************************  01074000
*                                                                       01075000
SQL#0029 DS    0H                                                       01076000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01077000
         LA    15,255                  SET RETURN CODE                  01078000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01079000
         BR    14                      RETURN TO CALLER                 01080000
         LTORG                                                          01081000
*                                                                       01082000
*                                                                       01083000
**********************************************************************  01084000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01085000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01086000
*     AND GET-NEXT-LOCK VERBS.                                          01087000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01088000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01089000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01090000
**********************************************************************  01091000
*                                                                       01092000
SQL#0030 DS    0H                                                       01093000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01094000
         LA    15,255                  SET RETURN CODE                  01095000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01096000
         BR    14                      RETURN TO CALLER                 01097000
         LTORG                                                          01098000
*                                                                       01099000
*                                                                       01100000
**********************************************************************  01101000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01102000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01103000
*     AND GET-NEXT-LOCK VERBS.                                          01104000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01105000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01106000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01107000
**********************************************************************  01108000
*                                                                       01109000
SQL#0031 DS    0H                                                       01110000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01111000
         LA    15,255                  SET RETURN CODE                  01112000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01113000
         BR    14                      RETURN TO CALLER                 01114000
         LTORG                                                          01115000
*                                                                       01116000
*                                                                       01117000
**********************************************************************  01118000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01119000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01120000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01121000
**********************************************************************  01122000
*                                                                       01123000
SQL#0032 DS    0H                                                       01124000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01125000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01126000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01127000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01128000
         EXEC  SQL                                                     *01129000
               SELECT INST_NBR,                                        *01130000
                   RECORD_NBR,                                         *01131000
                   SEC_SVC_TABLE                                       *01132000
                 INTO :INST,                                           *01133000
                   :RECNBR,                                            *01134000
                   :SS_TABLE                                           *01135000
                 FROM S12                                              *01136000
                 WHERE INST_NBR = :INST AND                            *01137000
                   RECORD_NBR = :RECNBR AND                            *01138000
                   SEC_SVC_TABLE = :SS_TABLE                           *01139000
                 FETCH FIRST 1 ROW ONLY                                 01140000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01141000
         BR    14                      RETURN TO CALLER                 01142000
         LTORG                                                          01143000
*                                                                       01144000
*                                                                       01145000
**********************************************************************  01146000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01147000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01148000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01149000
**********************************************************************  01150000
*                                                                       01151000
SQL#0033 DS    0H                                                       01152000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01153000
         LA    15,255                  SET RETURN CODE                  01154000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01155000
         BR    14                      RETURN TO CALLER                 01156000
         LTORG                                                          01157000
*                                                                       01158000
*                                                                       01159000
**********************************************************************  01160000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01161000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01162000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01163000
**********************************************************************  01164000
*                                                                       01165000
SQL#0034 DS    0H                                                       01166000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01167000
         LA    15,255                  SET RETURN CODE                  01168000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01169000
         BR    14                      RETURN TO CALLER                 01170000
         LTORG                                                          01171000
*                                                                       01172000
*                                                                       01173000
**********************************************************************  01174000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01175000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01176000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01177000
**********************************************************************  01178000
*                                                                       01179000
SQL#0035 DS    0H                                                       01180000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01181000
         LA    15,255                  SET RETURN CODE                  01182000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01183000
         BR    14                      RETURN TO CALLER                 01184000
         LTORG                                                          01185000
*                                                                       01186000
*                                                                       01187000
**********************************************************************  01188000
* INSERT STATEMENT:                                                     01189000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01190000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01191000
**********************************************************************  01192000
*                                                                       01193000
SQL#0036 DS    0H                                                       01194000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01195000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01196000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01197000
         EXEC  SQL                                                     *01198000
               INSERT INTO S12                                         *01199000
                   (INST_NBR,                                          *01200000
                    RECORD_NBR,                                        *01201000
                    SEC_SVC_TABLE,                                     *01202000
                    AUDIT_DATE,                                        *01203000
                    AUDIT_TIME,                                        *01204000
                    AUDIT_USER,                                        *01205000
                    AUDIT_ORG,                                         *01206000
                    BAL_OPT,                                           *01207000
                    AMOUNT_01,                                         *01208000
                    SEC_SVC_01,                                        *01209000
                    AMOUNT_02,                                         *01210000
                    SEC_SVC_02,                                        *01211000
                    AMOUNT_03,                                         *01212000
                    SEC_SVC_03,                                        *01213000
                    AMOUNT_04,                                         *01214000
                    SEC_SVC_04,                                        *01215000
                    AMOUNT_05,                                         *01216000
                    SEC_SVC_05,                                        *01217000
                    AMOUNT_06,                                         *01218000
                    SEC_SVC_06,                                        *01219000
                    AMOUNT_07,                                         *01220000
                    SEC_SVC_07,                                        *01221000
                    AMOUNT_08,                                         *01222000
                    SEC_SVC_08,                                        *01223000
                    AMOUNT_09,                                         *01224000
                    SEC_SVC_09,                                        *01225000
                    AMOUNT_10,                                         *01226000
                    SEC_SVC10)                                         *01227000
                  VALUES (:INST,                                       *01228000
                   :RECNBR,                                            *01229000
                   :SS_TABLE,                                          *01230000
                   :AUDDATE,                                           *01231000
                   :AUDTIME,                                           *01232000
                   :AUDUSER,                                           *01233000
                   :AUDORG,                                            *01234000
                   :BALOPT,                                            *01235000
                   :AMOUNT1,                                           *01236000
                   :SECSERV1,                                          *01237000
                   :AMOUNT2,                                           *01238000
                   :SECSERV2,                                          *01239000
                   :AMOUNT3,                                           *01240000
                   :SECSERV3,                                          *01241000
                   :AMOUNT4,                                           *01242000
                   :SECSERV4,                                          *01243000
                   :AMOUNT5,                                           *01244000
                   :SECSERV5,                                          *01245000
                   :AMOUNT6,                                           *01246000
                   :SECSERV6,                                          *01247000
                   :AMOUNT7,                                           *01248000
                   :SECSERV7,                                          *01249000
                   :AMOUNT8,                                           *01250000
                   :SECSERV8,                                          *01251000
                   :AMOUNT9,                                           *01252000
                   :SECSERV9,                                          *01253000
                   :AMOUNT10,                                          *01254000
                   :SECSER10)                                           01255000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01256000
         BR    14                      RETURN TO CALLER                 01257000
         LTORG                                                          01258000
*                                                                       01259000
*                                                                       01260000
**********************************************************************  01261000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01262000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01263000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01264000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01265000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01266000
*     STATEMENT.                                                        01267000
**********************************************************************  01268000
*                                                                       01269000
SQL#0037 DS    0H                                                       01270000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01271000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01272000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01273000
         EXEC  SQL                                                     *01274000
               UPDATE S12                                              *01275000
                   SET AUDIT_DATE = :AUDDATE,                          *01276000
                     AUDIT_TIME = :AUDTIME,                            *01277000
                     AUDIT_USER = :AUDUSER,                            *01278000
                     AUDIT_ORG = :AUDORG,                              *01279000
                     BAL_OPT = :BALOPT,                                *01280000
                     AMOUNT_01 = :AMOUNT1,                             *01281000
                     SEC_SVC_01 = :SECSERV1,                           *01282000
                     AMOUNT_02 = :AMOUNT2,                             *01283000
                     SEC_SVC_02 = :SECSERV2,                           *01284000
                     AMOUNT_03 = :AMOUNT3,                             *01285000
                     SEC_SVC_03 = :SECSERV3,                           *01286000
                     AMOUNT_04 = :AMOUNT4,                             *01287000
                     SEC_SVC_04 = :SECSERV4,                           *01288000
                     AMOUNT_05 = :AMOUNT5,                             *01289000
                     SEC_SVC_05 = :SECSERV5,                           *01290000
                     AMOUNT_06 = :AMOUNT6,                             *01291000
                     SEC_SVC_06 = :SECSERV6,                           *01292000
                     AMOUNT_07 = :AMOUNT7,                             *01293000
                     SEC_SVC_07 = :SECSERV7,                           *01294000
                     AMOUNT_08 = :AMOUNT8,                             *01295000
                     SEC_SVC_08 = :SECSERV8,                           *01296000
                     AMOUNT_09 = :AMOUNT9,                             *01297000
                     SEC_SVC_09 = :SECSERV9,                           *01298000
                     AMOUNT_10 = :AMOUNT10,                            *01299000
                     SEC_SVC10 = :SECSER10                             *01300000
                 WHERE CURRENT OF S12UPD0                               01301000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01302000
         BR    14                      RETURN TO CALLER                 01303000
         LTORG                                                          01304000
*                                                                       01305000
*                                                                       01306000
**********************************************************************  01307000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01308000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01309000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01310000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01311000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01312000
*     STATEMENT.                                                        01313000
**********************************************************************  01314000
*                                                                       01315000
SQL#0038 DS    0H                                                       01316000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01317000
         LA    15,255                  SET RETURN CODE                  01318000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01319000
         BR    14                      RETURN TO CALLER                 01320000
         LTORG                                                          01321000
*                                                                       01322000
*                                                                       01323000
**********************************************************************  01324000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01325000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01326000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01327000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01328000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01329000
*     STATEMENT.                                                        01330000
**********************************************************************  01331000
*                                                                       01332000
SQL#0039 DS    0H                                                       01333000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01334000
         LA    15,255                  SET RETURN CODE                  01335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01336000
         BR    14                      RETURN TO CALLER                 01337000
         LTORG                                                          01338000
*                                                                       01339000
*                                                                       01340000
**********************************************************************  01341000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01342000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01343000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01344000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01345000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01346000
*     STATEMENT.                                                        01347000
**********************************************************************  01348000
*                                                                       01349000
SQL#0040 DS    0H                                                       01350000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01351000
         LA    15,255                  SET RETURN CODE                  01352000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01353000
         BR    14                      RETURN TO CALLER                 01354000
         LTORG                                                          01355000
*                                                                       01356000
*                                                                       01357000
**********************************************************************  01358000
* DELETE STATEMENT BY PRIMARY KEY:                                      01359000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01360000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01361000
**********************************************************************  01362000
*                                                                       01363000
SQL#0041 DS    0H                                                       01364000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01365000
         EXEC  SQL                                                     *01366000
               DELETE FROM S12                                         *01367000
                 WHERE CURRENT OF S12UPD0                               01368000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01369000
         BR    14                      RETURN TO CALLER                 01370000
         LTORG                                                          01371000
*                                                                       01372000
*                                                                       01373000
**********************************************************************  01374000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01375000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01376000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01377000
**********************************************************************  01378000
*                                                                       01379000
SQL#0042 DS    0H                                                       01380000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01381000
         LA    15,255                  SET RETURN CODE                  01382000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01383000
         BR    14                      RETURN TO CALLER                 01384000
         LTORG                                                          01385000
*                                                                       01386000
*                                                                       01387000
**********************************************************************  01388000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01389000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01390000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01391000
**********************************************************************  01392000
*                                                                       01393000
SQL#0043 DS    0H                                                       01394000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01395000
         LA    15,255                  SET RETURN CODE                  01396000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01397000
         BR    14                      RETURN TO CALLER                 01398000
         LTORG                                                          01399000
*                                                                       01400000
*                                                                       01401000
**********************************************************************  01402000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01403000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01404000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01405000
**********************************************************************  01406000
*                                                                       01407000
SQL#0044 DS    0H                                                       01408000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01409000
         LA    15,255                  SET RETURN CODE                  01410000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01411000
         BR    14                      RETURN TO CALLER                 01412000
         LTORG                                                          01413000
*                                                                       01414000
*                                                                       01415000
**********************************************************************  01416000
* DELETE ALL STATEMENT:                                                 01417000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01418000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01419000
**********************************************************************  01420000
*                                                                       01421000
SQL#0045 DS    0H                                                       01422000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01423000
         EXEC  SQL                                                     *01424000
               DELETE FROM S12                                          01425000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01426000
         BR    14                      RETURN TO CALLER                 01427000
         LTORG                                                          01428000
*                                                                       01429000
*                                                                       01430000
**********************************************************************  01431000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01432000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01433000
**********************************************************************  01434000
*                                                                       01435000
SQL#0046 DS    0H                                                       01436000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01437000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01438000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01439000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01440000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01441000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01442000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01443000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01444000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01445000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01446000
VECT0046 DC    A(0)                                                     01447000
         DC    A(SQL#0246)                                              01448000
         DC    A(SQL#0346)                                              01449000
         LTORG                                                          01450000
*                                                                       01451000
SQL#0246 DS    0H                                                       01452000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01453000
         EXEC  SQL                                                     *01454000
               CLOSE S12SQ001                                           01455000
         EXEC  SQL                                                     *01456000
               DECLARE S12SQ002 CURSOR FOR                             *01457000
               SELECT INST_NBR,                                        *01458000
                   RECORD_NBR,                                         *01459000
                   SEC_SVC_TABLE,                                      *01460000
                   AUDIT_DATE,                                         *01461000
                   AUDIT_TIME,                                         *01462000
                   AUDIT_USER,                                         *01463000
                   AUDIT_ORG,                                          *01464000
                   BAL_OPT,                                            *01465000
                   AMOUNT_01,                                          *01466000
                   SEC_SVC_01,                                         *01467000
                   AMOUNT_02,                                          *01468000
                   SEC_SVC_02,                                         *01469000
                   AMOUNT_03,                                          *01470000
                   SEC_SVC_03,                                         *01471000
                   AMOUNT_04,                                          *01472000
                   SEC_SVC_04,                                         *01473000
                   AMOUNT_05,                                          *01474000
                   SEC_SVC_05,                                         *01475000
                   AMOUNT_06,                                          *01476000
                   SEC_SVC_06,                                         *01477000
                   AMOUNT_07,                                          *01478000
                   SEC_SVC_07,                                         *01479000
                   AMOUNT_08,                                          *01480000
                   SEC_SVC_08,                                         *01481000
                   AMOUNT_09,                                          *01482000
                   SEC_SVC_09,                                         *01483000
                   AMOUNT_10,                                          *01484000
                   SEC_SVC10                                           *01485000
                 FROM S12                                              *01486000
                 WHERE                                                 *01487000
                    INST_NBR = :INST AND                               *01488000
                    RECORD_NBR > :RECNBR                               *01489000
                 ORDER BY RECORD_NBR,                                  *01490000
                   SEC_SVC_TABLE                                       *01491000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01492000
         EXEC  SQL                                                     *01493000
               OPEN S12SQ002                                            01494000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01495000
         BNZ   *+8                     NO - RETURN ERROR                01496000
         LR    12,9                    LOAD RETURN ADDRESS              01497000
         BR    12                      RETURN TO FETCH ROUTINE          01498000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01499000
         BR    14                      RETURN TO CALLER                 01500000
         LTORG                                                          01501000
*                                                                       01502000
SQL#0346 DS    0H                                                       01503000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01504000
         EXEC  SQL                                                     *01505000
               CLOSE S12SQ002                                           01506000
         EXEC  SQL                                                     *01507000
               DECLARE S12SQ003 CURSOR FOR                             *01508000
               SELECT INST_NBR,                                        *01509000
                   RECORD_NBR,                                         *01510000
                   SEC_SVC_TABLE,                                      *01511000
                   AUDIT_DATE,                                         *01512000
                   AUDIT_TIME,                                         *01513000
                   AUDIT_USER,                                         *01514000
                   AUDIT_ORG,                                          *01515000
                   BAL_OPT,                                            *01516000
                   AMOUNT_01,                                          *01517000
                   SEC_SVC_01,                                         *01518000
                   AMOUNT_02,                                          *01519000
                   SEC_SVC_02,                                         *01520000
                   AMOUNT_03,                                          *01521000
                   SEC_SVC_03,                                         *01522000
                   AMOUNT_04,                                          *01523000
                   SEC_SVC_04,                                         *01524000
                   AMOUNT_05,                                          *01525000
                   SEC_SVC_05,                                         *01526000
                   AMOUNT_06,                                          *01527000
                   SEC_SVC_06,                                         *01528000
                   AMOUNT_07,                                          *01529000
                   SEC_SVC_07,                                         *01530000
                   AMOUNT_08,                                          *01531000
                   SEC_SVC_08,                                         *01532000
                   AMOUNT_09,                                          *01533000
                   SEC_SVC_09,                                         *01534000
                   AMOUNT_10,                                          *01535000
                   SEC_SVC10                                           *01536000
                 FROM S12                                              *01537000
                 WHERE                                                 *01538000
                    INST_NBR > :INST                                   *01539000
                 ORDER BY INST_NBR,                                    *01540000
                   RECORD_NBR,                                         *01541000
                   SEC_SVC_TABLE                                       *01542000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01543000
         EXEC  SQL                                                     *01544000
               OPEN S12SQ003                                            01545000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01546000
         BNZ   *+8                     NO - RETURN ERROR                01547000
         LR    12,9                    LOAD RETURN ADDRESS              01548000
         BR    12                      RETURN TO FETCH ROUTINE          01549000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01550000
         BR    14                      RETURN TO CALLER                 01551000
         LTORG                                                          01552000
*                                                                       01553000
*                                                                       01554000
**********************************************************************  01555000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01556000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01557000
**********************************************************************  01558000
*                                                                       01559000
SQL#0047 DS    0H                                                       01560000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01561000
         LA    15,255                  SET RETURN CODE                  01562000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01563000
         BR    14                      RETURN TO CALLER                 01564000
         LTORG                                                          01565000
*                                                                       01566000
*                                                                       01567000
**********************************************************************  01568000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01569000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01570000
**********************************************************************  01571000
*                                                                       01572000
SQL#0048 DS    0H                                                       01573000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01574000
         LA    15,255                  SET RETURN CODE                  01575000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01576000
         BR    14                      RETURN TO CALLER                 01577000
         LTORG                                                          01578000
*                                                                       01579000
*                                                                       01580000
**********************************************************************  01581000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01582000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01583000
**********************************************************************  01584000
*                                                                       01585000
SQL#0049 DS    0H                                                       01586000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01587000
         LA    15,255                  SET RETURN CODE                  01588000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01589000
         BR    14                      RETURN TO CALLER                 01590000
         LTORG                                                          01591000
*                                                                       01592000
         DS    0H                      END OF SQL STATEMENTS            01593000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01594000
*                                                                       01595000
*                                                                       01596000
**********************************************************************  01597000
* DUMMY ENTRY POINT DSNHLI                                              01598000
*   MUST NOT BE MODIFIED.                                               01599000
**********************************************************************  01600000
*                                                                       01601000
         ENTRY DSNHLI                                                   01602000
DSNHLI   DS    0H                                                       01603000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01604000
         BR    15                      BRANCH TO ATTACH FACILITY        01605000
*                                                                       01606000
*                                                                       01607000
**********************************************************************  01608000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01609000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01610000
*   MUST NOT BE MODIFIED.                                               01611000
**********************************************************************  01612000
*                                                                       01613000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01614000
CONV#RTN AMODE ANY                                                      01615000
CONV#RTN RMODE ANY                                                      01616000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01617000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01618000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01619000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01620000
         BER   4                         YES - RETURN TO SQL            01621000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01622000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01623000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01624000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01625000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01626000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01627000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01628000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01629000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01630000
*                                                                       01631000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01632000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01633000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01634000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01635000
         BER   4                         YES - RETURN TO SQL            01636000
         SLR   0,0                     CLEAR FOR INSERT                 01637000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01638000
         NR    0,3                     FOR THE CURRENT KEY?             01639000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01640000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01641000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01642000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01643000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01644000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01645000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01646000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01647000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01648000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01649000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01650000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01651000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01652000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01653000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01654000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01655000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01656000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01657000
*                                                                       01658000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01659000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01660000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01661000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01662000
         BER   4                         YES - RETURN TO SQL            01663000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01664000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01665000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01666000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01667000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01668000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01669000
         MVCL  0,14                    MOVE TO RECORD AREA              01670000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01671000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01672000
*                                                                       01673000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01674000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01675000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01676000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01677000
         BER   4                         YES - RETURN TO SQL            01678000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01679000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01680000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01681000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01682000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01683000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01684000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01685000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01686000
         MVCL  0,14                    MOVE TO RECORD AREA              01687000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01688000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01689000
*                                                                       01690000
*                                                                       01691000
**********************************************************************  01692000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01693000
*   MUST NOT BE MODIFIED.                                               01694000
**********************************************************************  01695000
*                                                                       01696000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01697000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01698000
         DC    H'0014'                 LENGTH TO MOVE                   01699000
         DC    X'80'                   80 = KEY 0 FIELD                 01700000
*                                      40 = KEY 1 FIELD                 01701000
*                                      20 = KEY 2 FIELD                 01702000
*                                      10 = KEY 3 FIELD                 01703000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        01704000
*                                                                       01705000
*                                      REST OF FIELD ENTRIES            01706000
         DC    H'0014',H'0014',H'0145',X'00',X'00'                      01707000
         DC    8X'FF'                  END OF FIELD ENTRIES             01708000
         LTORG                                                          01709000
         END                                                            01710000
