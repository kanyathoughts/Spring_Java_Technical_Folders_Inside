**********************************************************************  00001000
*                                                                       00002000
*  S13RDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S13 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
SS_PLAN  DS    CL6                                                      00052000
AUDDATE  DS    PL5'0.'                                                  00053000
AUDTIME  DS    PL5'0.'                                                  00054000
AUDUSER  DS    CL8                                                      00055000
AUDORG   DS    CL6                                                      00056000
SSCD1    DS    CL6                                                      00057000
SSCD2    DS    CL6                                                      00058000
SSCD3    DS    CL6                                                      00059000
SSCD4    DS    CL6                                                      00060000
SSCD5    DS    CL6                                                      00061000
SSCD6    DS    CL6                                                      00062000
SSCD7    DS    CL6                                                      00063000
SSCD8    DS    CL6                                                      00064000
SSCD9    DS    CL6                                                      00065000
SSCD10   DS    CL6                                                      00066000
SSCD11   DS    CL6                                                      00067000
SSCD12   DS    CL6                                                      00068000
SSCD13   DS    CL6                                                      00069000
SSCD14   DS    CL6                                                      00070000
SSCD15   DS    CL6                                                      00071000
SSCD16   DS    CL6                                                      00072000
SSCD17   DS    CL6                                                      00073000
SSCD18   DS    CL6                                                      00074000
SSCD19   DS    CL6                                                      00075000
SSCD20   DS    CL6                                                      00076000
*                                                                       00077000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00078000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00079000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00080000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00081000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00082000
         DS    CL97                    RESERVED                         00083000
*                                                                       00084000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00085000
INDVARX  DS    0H                                                       00086000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00087000
*                                                                       00088000
*                                                                       00089000
**********************************************************************  00090000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00091000
**********************************************************************  00092000
*                                                                       00093000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00094000
*                                                                       00095000
**********************************************************************  00096000
* PROGRAM TABLE HEADER SECTION:                                         00097000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00098000
**********************************************************************  00099000
*                                                                       00100000
S13RDB   CSECT                         PROGRAM TABLE SECTION            00101000
S13RDB   AMODE ANY                                                      00102000
S13RDB   RMODE ANY                                                      00103000
         DC    CL8'S13RDB  '           PROGRAM ID                       00104000
         DC    CL1' '                                                   00105000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00106000
         DC    CL1' '                                                   00107000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00108000
         DC    CL1' '                                                   00109000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00110000
         DC    5A(0)                   RESERVED                         00111000
         DC    AL2(0)                  RESERVED                         00112000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00113000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00114000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00115000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00116000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00117000
         DC    CL29'WWW.INFOR.COM                '                      00117001
*                                                                       00118000
**********************************************************************  00119000
* STATEMENT TABLE SECTION:                                              00120000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00121000
**********************************************************************  00122000
*                                                                       00123000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00124000
STM#TAB  AMODE ANY                                                      00125000
STM#TAB  RMODE ANY                                                      00126000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00127000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00128000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00129000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00130000
         DC    12A(0)                  UDB MODULE VECTORS               00131000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00132000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00133000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00134000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00135000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00136000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00137000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00138000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00139000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00140000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00141000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00142000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00143000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00144000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00145000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00146000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00147000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00148000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00149000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00150000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00151000
         DC    10A(0)                  UDB MODULE VECTORS               00152000
         DC    4X'FF'                                                   00153000
*                                                                       00154000
**********************************************************************  00155000
* SQL STATEMENT SECTION:                                                00156000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00157000
*     TO SUPPORT THIS TABLE.                                            00158000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00159000
*     ARE EQUIVALENT.                                                   00160000
**********************************************************************  00161000
*                                                                       00162000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00163000
SQL#STMT AMODE ANY                                                      00164000
SQL#STMT RMODE ANY                                                      00165000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00166000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00167000
         USING COM#AREA,11             ADDRESS COMMAREA                 00168000
*                                                                       00169000
**********************************************************************  00170000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00171000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00172000
**********************************************************************  00173000
*                                                                       00174000
SELIN0   DS    0H                                                       00175000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00176000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00177000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00178000
         BALR  14,15                   MOVE REQUESTED DATA              00179000
         EXEC  SQL SELECT                                              *00180000
                   AUDIT_DATE,                                         *00181000
                   AUDIT_TIME,                                         *00182000
                   AUDIT_USER,                                         *00183000
                   AUDIT_ORG,                                          *00184000
                   SEC_SVC_CD_01,                                      *00185000
                   SEC_SVC_CD_02,                                      *00186000
                   SEC_SVC_CD_03,                                      *00187000
                   SEC_SVC_CD_04,                                      *00188000
                   SEC_SVC_CD_05,                                      *00189000
                   SEC_SVC_CD_06,                                      *00190000
                   SEC_SVC_CD_07,                                      *00191000
                   SEC_SVC_CD_08,                                      *00192000
                   SEC_SVC_CD_09,                                      *00193000
                   SEC_SVC_CD_10,                                      *00194000
                   SEC_SVC_CD_11,                                      *00195000
                   SEC_SVC_CD_12,                                      *00196000
                   SEC_SVC_CD_13,                                      *00197000
                   SEC_SVC_CD_14,                                      *00198000
                   SEC_SVC_CD_15,                                      *00199000
                   SEC_SVC_CD_16,                                      *00200000
                   SEC_SVC_CD_17,                                      *00201000
                   SEC_SVC_CD_18,                                      *00202000
                   SEC_SVC_CD_19,                                      *00203000
                   SEC_SVC_CD_20                                       *00204000
                 INTO                                                  *00205000
                   :AUDDATE,                                           *00206000
                   :AUDTIME,                                           *00207000
                   :AUDUSER,                                           *00208000
                   :AUDORG,                                            *00209000
                   :SSCD1,                                             *00210000
                   :SSCD2,                                             *00211000
                   :SSCD3,                                             *00212000
                   :SSCD4,                                             *00213000
                   :SSCD5,                                             *00214000
                   :SSCD6,                                             *00215000
                   :SSCD7,                                             *00216000
                   :SSCD8,                                             *00217000
                   :SSCD9,                                             *00218000
                   :SSCD10,                                            *00219000
                   :SSCD11,                                            *00220000
                   :SSCD12,                                            *00221000
                   :SSCD13,                                            *00222000
                   :SSCD14,                                            *00223000
                   :SSCD15,                                            *00224000
                   :SSCD16,                                            *00225000
                   :SSCD17,                                            *00226000
                   :SSCD18,                                            *00227000
                   :SSCD19,                                            *00228000
                   :SSCD20                                             *00229000
                 FROM S13                                              *00230000
                 WHERE                                                 *00231000
                   INST_NBR = :INST AND                                *00232000
                   RECORD_NBR = :RECNBR AND                            *00233000
                   SEC_SVC_PLAN = :SS_PLAN                             *00234000
                 FETCH FIRST 1 ROW ONLY                                 00235000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00236000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00237000
         BALR  14,15                   MOVE REQUESTED DATA              00238000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00239000
         BR    14                      RETURN TO CALLER                 00240000
         LTORG                                                          00241000
*                                                                       00242000
**********************************************************************  00243000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00244000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00245000
**********************************************************************  00246000
*                                                                       00247000
SELKY0   DS    0H                                                       00248000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00249000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00250000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00251000
         BALR  14,15                   MOVE REQUESTED DATA              00252000
         EXEC  SQL SELECT                                              *00253000
                   COUNT(*)                                            *00254000
                 INTO                                                  *00255000
                   :SQWINTHV                                           *00256000
                 FROM S13                                              *00257000
                 WHERE                                                 *00258000
                   INST_NBR = :INST AND                                *00259000
                   RECORD_NBR = :RECNBR AND                            *00260000
                   SEC_SVC_PLAN = :SS_PLAN                             *00261000
                 FETCH FIRST 1 ROW ONLY                                 00262000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00263000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00264000
         BNER  14                      NO - RETURN TO CALLER            00265000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00266000
         BNER  14                      YES - RETURN ZERO SQLCODE        00267000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00268000
         BR    14                      RETURN TO CALLER                 00269000
         LTORG                                                          00270000
*                                                                       00271000
**********************************************************************  00272000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00273000
* KEY:                                                                  00274000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00275000
*     AND GET-NEXT-LOCK VERBS.                                          00276000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00277000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00278000
**********************************************************************  00279000
*                                                                       00280000
SELXC0   DS    0H                                                       00281000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00282000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00283000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00284000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00285000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00286000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00287000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00288000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00289000
SELXC0P  DC    A(SELGE001)                                              00290000
         DC    (KY0COLMS-01)A(0)                                        00291000
         DC    A(SELGE002)                                              00292000
         DC    (KY0COLMS-02)A(0)                                        00293000
         DC    A(SELGE003)                                              00294000
         LTORG                                                          00295000
*                                                                       00296000
SELGE001 DS    0H                                                       00297000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00298000
         EXEC  SQL DECLARE S13GE001 CURSOR                             *00299000
               WITH ROWSET POSITIONING                                 *00300000
               FOR SELECT                                              *00301000
                   INST_NBR,                                           *00302000
                   RECORD_NBR,                                         *00303000
                   SEC_SVC_PLAN,                                       *00304000
                   AUDIT_DATE,                                         *00305000
                   AUDIT_TIME,                                         *00306000
                   AUDIT_USER,                                         *00307000
                   AUDIT_ORG,                                          *00308000
                   SEC_SVC_CD_01,                                      *00309000
                   SEC_SVC_CD_02,                                      *00310000
                   SEC_SVC_CD_03,                                      *00311000
                   SEC_SVC_CD_04,                                      *00312000
                   SEC_SVC_CD_05,                                      *00313000
                   SEC_SVC_CD_06,                                      *00314000
                   SEC_SVC_CD_07,                                      *00315000
                   SEC_SVC_CD_08,                                      *00316000
                   SEC_SVC_CD_09,                                      *00317000
                   SEC_SVC_CD_10,                                      *00318000
                   SEC_SVC_CD_11,                                      *00319000
                   SEC_SVC_CD_12,                                      *00320000
                   SEC_SVC_CD_13,                                      *00321000
                   SEC_SVC_CD_14,                                      *00322000
                   SEC_SVC_CD_15,                                      *00323000
                   SEC_SVC_CD_16,                                      *00324000
                   SEC_SVC_CD_17,                                      *00325000
                   SEC_SVC_CD_18,                                      *00326000
                   SEC_SVC_CD_19,                                      *00327000
                   SEC_SVC_CD_20                                       *00328000
                 FROM S13                                              *00329000
                 WHERE                                                 *00330000
                   INST_NBR = :INST AND                                *00331000
                   RECORD_NBR = :RECNBR AND                            *00332000
                   SEC_SVC_PLAN >=                                     *00333000
                     :SS_PLAN                                          *00334000
                 ORDER BY SEC_SVC_PLAN ASC                             *00335000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00336000
         EXEC  SQL OPEN S13GE001                                        00337000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00338000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00339000
         BR    14                      RETURN TO CALLER                 00340000
         LTORG                                                          00341000
*                                                                       00342000
SELGE002 DS    0H                                                       00343000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00344000
         EXEC  SQL DECLARE S13GE002 CURSOR                             *00345000
               WITH ROWSET POSITIONING                                 *00346000
               FOR SELECT                                              *00347000
                   INST_NBR,                                           *00348000
                   RECORD_NBR,                                         *00349000
                   SEC_SVC_PLAN,                                       *00350000
                   AUDIT_DATE,                                         *00351000
                   AUDIT_TIME,                                         *00352000
                   AUDIT_USER,                                         *00353000
                   AUDIT_ORG,                                          *00354000
                   SEC_SVC_CD_01,                                      *00355000
                   SEC_SVC_CD_02,                                      *00356000
                   SEC_SVC_CD_03,                                      *00357000
                   SEC_SVC_CD_04,                                      *00358000
                   SEC_SVC_CD_05,                                      *00359000
                   SEC_SVC_CD_06,                                      *00360000
                   SEC_SVC_CD_07,                                      *00361000
                   SEC_SVC_CD_08,                                      *00362000
                   SEC_SVC_CD_09,                                      *00363000
                   SEC_SVC_CD_10,                                      *00364000
                   SEC_SVC_CD_11,                                      *00365000
                   SEC_SVC_CD_12,                                      *00366000
                   SEC_SVC_CD_13,                                      *00367000
                   SEC_SVC_CD_14,                                      *00368000
                   SEC_SVC_CD_15,                                      *00369000
                   SEC_SVC_CD_16,                                      *00370000
                   SEC_SVC_CD_17,                                      *00371000
                   SEC_SVC_CD_18,                                      *00372000
                   SEC_SVC_CD_19,                                      *00373000
                   SEC_SVC_CD_20                                       *00374000
                 FROM S13                                              *00375000
                 WHERE                                                 *00376000
                   INST_NBR = :INST AND                                *00377000
                   RECORD_NBR >=                                       *00378000
                     :RECNBR                                           *00379000
                 ORDER BY RECORD_NBR ASC,                              *00380000
                   SEC_SVC_PLAN ASC                                    *00381000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00382000
         EXEC  SQL OPEN S13GE002                                        00383000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00384000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00385000
         BR    14                      RETURN TO CALLER                 00386000
         LTORG                                                          00387000
*                                                                       00388000
SELGE003 DS    0H                                                       00389000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00390000
         EXEC  SQL DECLARE S13GE003 CURSOR                             *00391000
               WITH ROWSET POSITIONING                                 *00392000
               FOR SELECT                                              *00393000
                   INST_NBR,                                           *00394000
                   RECORD_NBR,                                         *00395000
                   SEC_SVC_PLAN,                                       *00396000
                   AUDIT_DATE,                                         *00397000
                   AUDIT_TIME,                                         *00398000
                   AUDIT_USER,                                         *00399000
                   AUDIT_ORG,                                          *00400000
                   SEC_SVC_CD_01,                                      *00401000
                   SEC_SVC_CD_02,                                      *00402000
                   SEC_SVC_CD_03,                                      *00403000
                   SEC_SVC_CD_04,                                      *00404000
                   SEC_SVC_CD_05,                                      *00405000
                   SEC_SVC_CD_06,                                      *00406000
                   SEC_SVC_CD_07,                                      *00407000
                   SEC_SVC_CD_08,                                      *00408000
                   SEC_SVC_CD_09,                                      *00409000
                   SEC_SVC_CD_10,                                      *00410000
                   SEC_SVC_CD_11,                                      *00411000
                   SEC_SVC_CD_12,                                      *00412000
                   SEC_SVC_CD_13,                                      *00413000
                   SEC_SVC_CD_14,                                      *00414000
                   SEC_SVC_CD_15,                                      *00415000
                   SEC_SVC_CD_16,                                      *00416000
                   SEC_SVC_CD_17,                                      *00417000
                   SEC_SVC_CD_18,                                      *00418000
                   SEC_SVC_CD_19,                                      *00419000
                   SEC_SVC_CD_20                                       *00420000
                 FROM S13                                              *00421000
                 WHERE                                                 *00422000
                   INST_NBR >=                                         *00423000
                     :INST                                             *00424000
                 ORDER BY INST_NBR ASC,                                *00425000
                   RECORD_NBR ASC,                                     *00426000
                   SEC_SVC_PLAN ASC                                    *00427000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00428000
         EXEC  SQL OPEN S13GE003                                        00429000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00430000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00431000
         BR    14                      RETURN TO CALLER                 00432000
         LTORG                                                          00433000
*                                                                       00434000
**********************************************************************  00435000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00436000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00437000
**********************************************************************  00438000
*                                                                       00439000
NXTXC0   DS    0H                                                       00440000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00441000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00442000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00443000
         BALR  14,15                   MOVE REQUESTED DATA              00444000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00445000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00446000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00447000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00448000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00449000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00450000
NXTXC0P  DC    A(0)                                                     00451000
         DC    A(NXTGT002)                                              00452000
         DC    A(NXTGT003)                                              00453000
         DC    A(NXTGT099)                                              00454000
         DC    A(NXTGT003)                                              00455000
         DC    A(NXTGT099)                                              00456000
         DC    A(NXTGT099)                                              00457000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00458000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00459000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00460000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00461000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00462000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00463000
         BR    14                      RETURN TO SQI                    00464000
         LTORG                                                          00465000
*                                                                       00466000
NXTGT002 DS    0H                                                       00467000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00468000
         EXEC  SQL DECLARE S13GT002 CURSOR                             *00469000
               WITH ROWSET POSITIONING                                 *00470000
               FOR SELECT                                              *00471000
                   INST_NBR,                                           *00472000
                   RECORD_NBR,                                         *00473000
                   SEC_SVC_PLAN,                                       *00474000
                   AUDIT_DATE,                                         *00475000
                   AUDIT_TIME,                                         *00476000
                   AUDIT_USER,                                         *00477000
                   AUDIT_ORG,                                          *00478000
                   SEC_SVC_CD_01,                                      *00479000
                   SEC_SVC_CD_02,                                      *00480000
                   SEC_SVC_CD_03,                                      *00481000
                   SEC_SVC_CD_04,                                      *00482000
                   SEC_SVC_CD_05,                                      *00483000
                   SEC_SVC_CD_06,                                      *00484000
                   SEC_SVC_CD_07,                                      *00485000
                   SEC_SVC_CD_08,                                      *00486000
                   SEC_SVC_CD_09,                                      *00487000
                   SEC_SVC_CD_10,                                      *00488000
                   SEC_SVC_CD_11,                                      *00489000
                   SEC_SVC_CD_12,                                      *00490000
                   SEC_SVC_CD_13,                                      *00491000
                   SEC_SVC_CD_14,                                      *00492000
                   SEC_SVC_CD_15,                                      *00493000
                   SEC_SVC_CD_16,                                      *00494000
                   SEC_SVC_CD_17,                                      *00495000
                   SEC_SVC_CD_18,                                      *00496000
                   SEC_SVC_CD_19,                                      *00497000
                   SEC_SVC_CD_20                                       *00498000
                 FROM S13                                              *00499000
                 WHERE                                                 *00500000
                   INST_NBR = :INST AND                                *00501000
                   RECORD_NBR >                                        *00502000
                     :RECNBR                                           *00503000
                 ORDER BY RECORD_NBR ASC,                              *00504000
                   SEC_SVC_PLAN ASC                                    *00505000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00506000
         EXEC  SQL OPEN S13GT002                                        00507000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00508000
         BNZ   *+14                    NO - RETURN ERROR                00509000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00510000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00511000
         BR    12                      RETURN TO FETCH ROUTINE          00512000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00513000
         BR    14                      RETURN TO CALLER                 00514000
         LTORG                                                          00515000
*                                                                       00516000
NXTGT003 DS    0H                                                       00517000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00518000
         EXEC  SQL DECLARE S13GT003 CURSOR                             *00519000
               WITH ROWSET POSITIONING                                 *00520000
               FOR SELECT                                              *00521000
                   INST_NBR,                                           *00522000
                   RECORD_NBR,                                         *00523000
                   SEC_SVC_PLAN,                                       *00524000
                   AUDIT_DATE,                                         *00525000
                   AUDIT_TIME,                                         *00526000
                   AUDIT_USER,                                         *00527000
                   AUDIT_ORG,                                          *00528000
                   SEC_SVC_CD_01,                                      *00529000
                   SEC_SVC_CD_02,                                      *00530000
                   SEC_SVC_CD_03,                                      *00531000
                   SEC_SVC_CD_04,                                      *00532000
                   SEC_SVC_CD_05,                                      *00533000
                   SEC_SVC_CD_06,                                      *00534000
                   SEC_SVC_CD_07,                                      *00535000
                   SEC_SVC_CD_08,                                      *00536000
                   SEC_SVC_CD_09,                                      *00537000
                   SEC_SVC_CD_10,                                      *00538000
                   SEC_SVC_CD_11,                                      *00539000
                   SEC_SVC_CD_12,                                      *00540000
                   SEC_SVC_CD_13,                                      *00541000
                   SEC_SVC_CD_14,                                      *00542000
                   SEC_SVC_CD_15,                                      *00543000
                   SEC_SVC_CD_16,                                      *00544000
                   SEC_SVC_CD_17,                                      *00545000
                   SEC_SVC_CD_18,                                      *00546000
                   SEC_SVC_CD_19,                                      *00547000
                   SEC_SVC_CD_20                                       *00548000
                 FROM S13                                              *00549000
                 WHERE                                                 *00550000
                   INST_NBR >                                          *00551000
                     :INST                                             *00552000
                 ORDER BY INST_NBR ASC,                                *00553000
                   RECORD_NBR ASC,                                     *00554000
                   SEC_SVC_PLAN ASC                                    *00555000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00556000
         EXEC  SQL OPEN S13GT003                                        00557000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00558000
         BNZ   *+14                    NO - RETURN ERROR                00559000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00560000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00561000
         BR    12                      RETURN TO FETCH ROUTINE          00562000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00563000
         BR    14                      RETURN TO CALLER                 00564000
         LTORG                                                          00565000
*                                                                       00566000
**********************************************************************  00567000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00568000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00569000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00570000
*     RETRIEVE THE ACTUAL ROW.                                          00571000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00572000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00573000
**********************************************************************  00574000
*                                                                       00575000
FETDC0   DS    0H                                                       00576000
         USING FETDC0,12               ESTABLISH BASE REGISTER          00577000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       00578000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00579000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       00580000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00581000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    00582000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00583000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00584000
FETDC0P  DC    A(FETGE001)                                              00585000
         DC    A(FETGT002)                                              00586000
         DC    A(FETGT003)                                              00587000
         DC    A(FETGE002)                                              00588000
         DC    A(FETGT003)                                              00589000
         DC    A(FETGE003)                                              00590000
         DC    A(0)                                                     00591000
         LTORG                                                          00592000
*                                                                       00593000
**********************************************************************  00594000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00595000
* THE PRIMARY KEY:                                                      00596000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00597000
*     VERBS.                                                            00598000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00599000
*     RETRIEVE THE ACTUAL ROW.                                          00600000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00601000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00602000
*     WILL BE THRU THE UPDATE CURSOR.                                   00603000
**********************************************************************  00604000
*                                                                       00605000
FETKC0   DS    0H                                                       00606000
         USING FETKC0,12               ESTABLISH BASE REGISTER          00607000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       00608000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00609000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           00610000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00611000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    00612000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00613000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00614000
FETKC0P  DC    A(FETGE001)                                              00615000
         DC    A(FETGT002)                                              00616000
         DC    A(FETGT003)                                              00617000
         DC    A(FETGE002)                                              00618000
         DC    A(FETGT003)                                              00619000
         DC    A(FETGE003)                                              00620000
         DC    A(0)                                                     00621000
         LTORG                                                          00622000
*                                                                       00623000
FETGE001 DS    0H                                                       00624000
         USING FETGE001,12             ESTABLISH BASE REGISTER          00625000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00626000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00627000
         BALR  14,15                   MOVE REQUESTED DATA              00628000
         EXEC  SQL FETCH NEXT ROWSET FROM S13GE001                     *00629000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00630000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00631000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00632000
         BALR  14,15                   MOVE REQUESTED DATA              00633000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00634000
         BR    14                      RETURN TO CALLER                 00635000
         LTORG                                                          00636000
*                                                                       00637000
FETGE002 DS    0H                                                       00638000
         USING FETGE002,12             ESTABLISH BASE REGISTER          00639000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00640000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00641000
         BALR  14,15                   MOVE REQUESTED DATA              00642000
         EXEC  SQL FETCH NEXT ROWSET FROM S13GE002                     *00643000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00644000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00645000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00646000
         BALR  14,15                   MOVE REQUESTED DATA              00647000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00648000
         BR    14                      RETURN TO CALLER                 00649000
         LTORG                                                          00650000
*                                                                       00651000
FETGE003 DS    0H                                                       00652000
         USING FETGE003,12             ESTABLISH BASE REGISTER          00653000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00654000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00655000
         BALR  14,15                   MOVE REQUESTED DATA              00656000
         EXEC  SQL FETCH NEXT ROWSET FROM S13GE003                     *00657000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00658000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00659000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00660000
         BALR  14,15                   MOVE REQUESTED DATA              00661000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00662000
         BR    14                      RETURN TO CALLER                 00663000
         LTORG                                                          00664000
*                                                                       00665000
FETGT002 DS    0H                                                       00666000
         USING FETGT002,12             ESTABLISH BASE REGISTER          00667000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00668000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00669000
         BALR  14,15                   MOVE REQUESTED DATA              00670000
         EXEC  SQL FETCH NEXT ROWSET FROM S13GT002                     *00671000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00672000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00673000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00674000
         BALR  14,15                   MOVE REQUESTED DATA              00675000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00676000
         BR    14                      RETURN TO CALLER                 00677000
         LTORG                                                          00678000
*                                                                       00679000
FETGT003 DS    0H                                                       00680000
         USING FETGT003,12             ESTABLISH BASE REGISTER          00681000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00682000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00683000
         BALR  14,15                   MOVE REQUESTED DATA              00684000
         EXEC  SQL FETCH NEXT ROWSET FROM S13GT003                     *00685000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00686000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00687000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00688000
         BALR  14,15                   MOVE REQUESTED DATA              00689000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00690000
         BR    14                      RETURN TO CALLER                 00691000
         LTORG                                                          00692000
*                                                                       00693000
**********************************************************************  00694000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    00695000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00696000
*     AND GET-NEXT-LOCK VERBS.                                          00697000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00698000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00699000
**********************************************************************  00700000
*                                                                       00701000
CLSXC0   DS    0H                                                       00702000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          00703000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 00704000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00705000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       00706000
         LTORG                                                          00707000
*                                                                       00708000
CLSGE001 DS    0H                                                       00709000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          00710000
         EXEC  SQL CLOSE S13GE001                                       00711000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00712000
         BR    14                      RETURN TO CALLER                 00713000
         LTORG                                                          00714000
*                                                                       00715000
CLSGE002 DS    0H                                                       00716000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          00717000
         EXEC  SQL CLOSE S13GE002                                       00718000
         L     14,SQW@RET                                               00719000
         BR    14                                                       00720000
         LTORG                                                          00721000
*                                                                       00722000
CLSGE003 DS    0H                                                       00723000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          00724000
         EXEC  SQL CLOSE S13GE003                                       00725000
         L     14,SQW@RET                                               00726000
         BR    14                                                       00727000
         LTORG                                                          00728000
*                                                                       00729000
CLSGT002 DS    0H                                                       00730000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          00731000
         EXEC  SQL CLOSE S13GT002                                       00732000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00733000
         BR    14                      RETURN TO CALLER                 00734000
         LTORG                                                          00735000
*                                                                       00736000
CLSGT003 DS    0H                                                       00737000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          00738000
         EXEC  SQL CLOSE S13GT003                                       00739000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00740000
         BR    14                      RETURN TO CALLER                 00741000
         LTORG                                                          00742000
*                                                                       00743000
**********************************************************************  00744000
* ALTERNATE KEY 1 NOT DEFINED                                           00745000
**********************************************************************  00746000
*                                                                       00747000
SELIN1   DS    0H                                                       00748000
SELKY1   DS    0H                                                       00749000
SELXC1   DS    0H                                                       00750000
FETDC1   DS    0H                                                       00751000
FETKC1   DS    0H                                                       00752000
CLSXC1   DS    0H                                                       00753000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00754000
*                                                                       00755000
**********************************************************************  00756000
* ALTERNATE KEY 2 NOT DEFINED                                           00757000
**********************************************************************  00758000
*                                                                       00759000
SELIN2   DS    0H                                                       00760000
SELKY2   DS    0H                                                       00761000
SELXC2   DS    0H                                                       00762000
FETDC2   DS    0H                                                       00763000
FETKC2   DS    0H                                                       00764000
CLSXC2   DS    0H                                                       00765000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00766000
*                                                                       00767000
**********************************************************************  00768000
* ALTERNATE KEY 3 NOT DEFINED                                           00769000
**********************************************************************  00770000
*                                                                       00771000
SELIN3   DS    0H                                                       00772000
SELKY3   DS    0H                                                       00773000
SELXC3   DS    0H                                                       00774000
FETDC3   DS    0H                                                       00775000
FETKC3   DS    0H                                                       00776000
CLSXC3   DS    0H                                                       00777000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00778000
*                                                                       00779000
         DS    0H                      END OF SQL STATEMENTS            00780000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00781000
*                                                                       00782000
**********************************************************************  00783000
* DUMMY ENTRY POINT DSNHLI                                              00784000
**********************************************************************  00785000
*                                                                       00786000
         ENTRY DSNHLI                                                   00787000
DSNHLI   DS    0H                                                       00788000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00789000
         BR    15                      BRANCH TO ATTACH FACILITY        00790000
*                                                                       00791000
**********************************************************************  00792000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00793000
**********************************************************************  00794000
*                                                                       00795000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00796000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00797000
* OR:                                                                   00798000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00799000
* WHERE:                                                                00800000
*   RRRR = RECORD AREA OFFSET                                           00801000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00802000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00803000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00804000
*   KK   = KEY FIELD MASK:                                              00805000
*            80 = KEY 0 FIELD                                           00806000
*            40 = KEY 1 FIELD                                           00807000
*            20 = KEY 2 FIELD                                           00808000
*            10 = KEY 3 FIELD                                           00809000
*   DD   = DATA FIELD MASK:                                             00810000
*            80 = RECORD FIELD IS PACKED                                00811000
*            40 = HOST VARIABLE IS PACKED                               00812000
*            20 = NULLABLE FIELD                                        00813000
*            01 = DATE FIELD                                            00814000
*            02 = TIME FIELD                                            00815000
*                                                                       00816000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00817000
         DC    H'0000',H'0000',H'0014',X'80',X'00'                      00818000
         DC    H'0014',H'0014',H'0144',X'00',X'00'                      00819000
         DC    8X'FF'                                                   00820000
*                                                                       00821000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               00822000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  00823000
* OR:                                                                   00824000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  00825000
* WHERE:                                                                00826000
*   RRRR = RECORD AREA OFFSET                                           00827000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     00828000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      00829000
*   TTTT = SQLDA DATA TYPE:                                             00830000
*            452 = CHAR       453 = CHAR NULLABLE                       00831000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    00832000
*            496 = INTEGER    497 = INTEGER NULLABLE                    00833000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   00834000
*                                                                       00835000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      00836000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 00837000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       00838000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    00839000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       00840000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       00841000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       00842000
         DC    AL2(00158)              SUMMATION OF ALL COLUMN LENGTHS  00843000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     00844000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       00845000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       00846000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       00847000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      00848000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        00849000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        00850000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        00851000
CONVDATA DS    0H                                                       00852000
         DC    H'0000',H'0004',H'452'  INST_NBR                         00853000
         DC    H'0004',H'0004',H'452'  RECORD_NBR                       00854000
         DC    H'0008',H'0006',H'452'  SEC_SVC_PLAN                     00855000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   00856000
         DC    H'0014',X'0900',H'484'  AUDIT_DATE                       00857000
         DC    H'0019',X'0900',H'484'  AUDIT_TIME                       00858000
         DC    H'0024',H'0008',H'452'  AUDIT_USER                       00859000
         DC    H'0032',H'0006',H'452'  AUDIT_ORG                        00860000
         DC    H'0038',H'0006',H'452'  SEC_SVC_CD_01                    00861000
         DC    H'0044',H'0006',H'452'  SEC_SVC_CD_02                    00862000
         DC    H'0050',H'0006',H'452'  SEC_SVC_CD_03                    00863000
         DC    H'0056',H'0006',H'452'  SEC_SVC_CD_04                    00864000
         DC    H'0062',H'0006',H'452'  SEC_SVC_CD_05                    00865000
         DC    H'0068',H'0006',H'452'  SEC_SVC_CD_06                    00866000
         DC    H'0074',H'0006',H'452'  SEC_SVC_CD_07                    00867000
         DC    H'0080',H'0006',H'452'  SEC_SVC_CD_08                    00868000
         DC    H'0086',H'0006',H'452'  SEC_SVC_CD_09                    00869000
         DC    H'0092',H'0006',H'452'  SEC_SVC_CD_10                    00870000
         DC    H'0098',H'0006',H'452'  SEC_SVC_CD_11                    00871000
         DC    H'0104',H'0006',H'452'  SEC_SVC_CD_12                    00872000
         DC    H'0110',H'0006',H'452'  SEC_SVC_CD_13                    00873000
         DC    H'0116',H'0006',H'452'  SEC_SVC_CD_14                    00874000
         DC    H'0122',H'0006',H'452'  SEC_SVC_CD_15                    00875000
         DC    H'0128',H'0006',H'452'  SEC_SVC_CD_16                    00876000
         DC    H'0134',H'0006',H'452'  SEC_SVC_CD_17                    00877000
         DC    H'0140',H'0006',H'452'  SEC_SVC_CD_18                    00878000
         DC    H'0146',H'0006',H'452'  SEC_SVC_CD_19                    00879000
         DC    H'0152',H'0006',H'452'  SEC_SVC_CD_20                    00880000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       00881000
KY0COLMS EQU   00003                   NUMBER OF PRIMARY KEY COLUMNS    00882000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      00883000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      00884000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      00885000
*                                                                       00886000
         LTORG                                                          00887000
         END                                                            00888000
