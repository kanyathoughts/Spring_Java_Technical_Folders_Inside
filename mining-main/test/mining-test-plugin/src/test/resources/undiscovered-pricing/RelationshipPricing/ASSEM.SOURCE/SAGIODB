* REL=SAGIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SAGIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAG FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL232                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
PRDCDE   DS    CL6                                                      00039000
ACCTNBR  DS    CL18                                                     00040000
MODEL    DS    CL10                                                     00041000
AUDDATE  DS    PL5'0.'                                                  00042000
AUDTIME  DS    PL5'0.'                                                  00043000
AUDUSER  DS    CL8                                                      00044000
AUDORG   DS    CL6                                                      00045000
RCIFINST DS    CL4                                                      00046000
RCIFTYPE DS    CL1                                                      00047000
QLFYALPH DS    CL14                                                     00048000
QLFYACUM DS    CL3                                                      00049000
TIBR     DS    CL4                                                      00050000
CUSTNAME DS    CL40                                                     00051000
DTEOPEN  DS    PL5'0.'                                                  00052000
IDNBR    DS    CL18                                                     00053000
BRCH     DS    PL3'0.'                                                  00054000
ACCTTYPE DS    PL2'0.'                                                  00055000
ADDACCT  DS    PL2'0.'                                                  00056000
CASHINST DS    CL4                                                      00057000
CASHPROD DS    CL6                                                      00058000
CASHACCT DS    CL18                                                     00059000
ENRATTP  DS    CL2                                                      00060000
DATEEXPR DS    PL5'0.'                                                  00061000
RAREA    DS    CL39                                                     00062000
*                                                                       00063000
*                                                                       00064000
**********************************************************************  00065000
* PROGRAM TABLE HEADER SECTION:                                         00066000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00067000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00068000
**********************************************************************  00069000
*                                                                       00070000
SAGIODB  CSECT                         PROGRAM TABLE SECTION            00071000
SAGIODB  AMODE ANY                                                      00072000
SAGIODB  RMODE ANY                                                      00073000
         DC    CL9'SAGIODB'            PROGRAM ID                       00074000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00075000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00076000
         DC    A(0)                    RESERVED                         00077000
         DC    A(0)                    RESERVED                         00078000
         DC    24CL1' '                RESERVED                         00079000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00080000
*                                                                       00081000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00082000
         DC    CL29'WWW.INFOR.COM                '                      00082001
*                                                                       00083000
*                                                                       00084000
**********************************************************************  00085000
* STATEMENT TABLE SECTION:                                              00086000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00087000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00088000
*   SHOULD NOT BE MODIFIED.                                             00089000
**********************************************************************  00090000
*                                                                       00091000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00092000
STM#TAB  AMODE ANY                                                      00093000
STM#TAB  RMODE ANY                                                      00094000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00095000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00096000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00097000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00098000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00099000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00100000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00101000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00102000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00103000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00104000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00105000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00106000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00107000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00108000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00109000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00110000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00111000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00112000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00113000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00114000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00115000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00116000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00117000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00118000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00119000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00120000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00121000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00122000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00123000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00124000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00125000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00126000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00127000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00128000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00129000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00130000
         DC    A(SQL#0036)             INSERT STATEMENT                 00131000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00132000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00133000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00134000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00135000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00136000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00137000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00138000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00139000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00140000
         DC    4X'FF'                                                   00141000
*                                                                       00142000
*                                                                       00143000
**********************************************************************  00144000
* SQL STATEMENT SECTION:                                                00145000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00146000
*     TO SUPPORT THIS TABLE.                                            00147000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00148000
*     ARE EQUIVALENT.                                                   00149000
**********************************************************************  00150000
*                                                                       00151000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00152000
SQL#STMT AMODE ANY                                                      00153000
SQL#STMT RMODE ANY                                                      00154000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00155000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00156000
         USING COM#AREA,11             ADDRESS COMMAREA                 00157000
*                                                                       00158000
*                                                                       00159000
**********************************************************************  00160000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00161000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00162000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00163000
**********************************************************************  00164000
*                                                                       00165000
SQL#0000 DS    0H                                                       00166000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00167000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00168000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00169000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00170000
         EXEC  SQL                                                     *00171000
               SELECT AUDIT_DATE,                                      *00172000
                   AUDIT_TIME,                                         *00173000
                   AUDIT_USER,                                         *00174000
                   AUDIT_ORG,                                          *00175000
                   RCIF_INST,                                          *00176000
                   RCIF_TYPE,                                          *00177000
                   QUALIFY_ALPHA,                                      *00178000
                   QUALIFY_ACCUM,                                      *00179000
                   TIEBRK,                                             *00180000
                   CUST_NAME,                                          *00181000
                   DATE_OPEN,                                          *00182000
                   IDENT_NBR,                                          *00183000
                   BRANCH,                                             *00184000
                   ACCT_TYPE,                                          *00185000
                   ADD_ON_ACCT,                                        *00186000
                   CASH_INST,                                          *00187000
                   CASH_PROD_CODE,                                     *00188000
                   CASH_ACCOUNT,                                       *00189000
                   ENROLL_LEFT,                                        *00190000
                   DATE_EXPIRE,                                        *00191000
                   RSV_AREA                                            *00192000
                 INTO :AUDDATE,                                        *00193000
                   :AUDTIME,                                           *00194000
                   :AUDUSER,                                           *00195000
                   :AUDORG,                                            *00196000
                   :RCIFINST,                                          *00197000
                   :RCIFTYPE,                                          *00198000
                   :QLFYALPH,                                          *00199000
                   :QLFYACUM,                                          *00200000
                   :TIBR,                                              *00201000
                   :CUSTNAME,                                          *00202000
                   :DTEOPEN,                                           *00203000
                   :IDNBR,                                             *00204000
                   :BRCH,                                              *00205000
                   :ACCTTYPE,                                          *00206000
                   :ADDACCT,                                           *00207000
                   :CASHINST,                                          *00208000
                   :CASHPROD,                                          *00209000
                   :CASHACCT,                                          *00210000
                   :ENRATTP,                                           *00211000
                   :DATEEXPR,                                          *00212000
                   :RAREA                                              *00213000
                 FROM SAG                                              *00214000
                 WHERE INST_NBR = :INST AND                            *00215000
                   PROD_CODE = :PRDCDE AND                             *00216000
                   ACCT_NBR = :ACCTNBR AND                             *00217000
                   MODEL = :MODEL                                      *00218000
                 FETCH FIRST 1 ROW ONLY                                 00219000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00220000
         BALR  4,5                     MOVE INTO RECORD AREA            00221000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00222000
         BR    14                      RETURN TO CALLER                 00223000
         LTORG                                                          00224000
*                                                                       00225000
*                                                                       00226000
**********************************************************************  00227000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00228000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00229000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00230000
**********************************************************************  00231000
*                                                                       00232000
SQL#0001 DS    0H                                                       00233000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00234000
         LA    15,255                  SET RETURN CODE                  00235000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00236000
         BR    14                      RETURN TO CALLER                 00237000
         LTORG                                                          00238000
*                                                                       00239000
*                                                                       00240000
**********************************************************************  00241000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00242000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00243000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00244000
**********************************************************************  00245000
*                                                                       00246000
SQL#0002 DS    0H                                                       00247000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00248000
         LA    15,255                  SET RETURN CODE                  00249000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00250000
         BR    14                      RETURN TO CALLER                 00251000
         LTORG                                                          00252000
*                                                                       00253000
*                                                                       00254000
**********************************************************************  00255000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00256000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00257000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00258000
**********************************************************************  00259000
*                                                                       00260000
SQL#0003 DS    0H                                                       00261000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00262000
         LA    15,255                  SET RETURN CODE                  00263000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00264000
         BR    14                      RETURN TO CALLER                 00265000
         LTORG                                                          00266000
*                                                                       00267000
*                                                                       00268000
**********************************************************************  00269000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00270000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00271000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00272000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00273000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00274000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00275000
*     UPDATE STATEMENT TO MATCH.                                        00276000
**********************************************************************  00277000
*                                                                       00278000
SQL#0004 DS    0H                                                       00279000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00280000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00281000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00282000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00283000
         EXEC  SQL                                                     *00284000
               DECLARE SAGUPD0 CURSOR FOR                              *00285000
               SELECT AUDIT_DATE,                                      *00286000
                   AUDIT_TIME,                                         *00287000
                   AUDIT_USER,                                         *00288000
                   AUDIT_ORG,                                          *00289000
                   RCIF_INST,                                          *00290000
                   RCIF_TYPE,                                          *00291000
                   QUALIFY_ALPHA,                                      *00292000
                   QUALIFY_ACCUM,                                      *00293000
                   TIEBRK,                                             *00294000
                   CUST_NAME,                                          *00295000
                   DATE_OPEN,                                          *00296000
                   IDENT_NBR,                                          *00297000
                   BRANCH,                                             *00298000
                   ACCT_TYPE,                                          *00299000
                   ADD_ON_ACCT,                                        *00300000
                   CASH_INST,                                          *00301000
                   CASH_PROD_CODE,                                     *00302000
                   CASH_ACCOUNT,                                       *00303000
                   ENROLL_LEFT,                                        *00304000
                   DATE_EXPIRE,                                        *00305000
                   RSV_AREA                                            *00306000
                 FROM SAG                                              *00307000
                 WHERE INST_NBR = :INST AND                            *00308000
                   PROD_CODE = :PRDCDE AND                             *00309000
                   ACCT_NBR = :ACCTNBR AND                             *00310000
                   MODEL = :MODEL                                      *00311000
                 FOR UPDATE OF AUDIT_DATE,                             *00312000
                   AUDIT_TIME,                                         *00313000
                   AUDIT_USER,                                         *00314000
                   AUDIT_ORG,                                          *00315000
                   RCIF_INST,                                          *00316000
                   RCIF_TYPE,                                          *00317000
                   QUALIFY_ALPHA,                                      *00318000
                   QUALIFY_ACCUM,                                      *00319000
                   TIEBRK,                                             *00320000
                   CUST_NAME,                                          *00321000
                   DATE_OPEN,                                          *00322000
                   IDENT_NBR,                                          *00323000
                   BRANCH,                                             *00324000
                   ACCT_TYPE,                                          *00325000
                   ADD_ON_ACCT,                                        *00326000
                   CASH_INST,                                          *00327000
                   CASH_PROD_CODE,                                     *00328000
                   CASH_ACCOUNT,                                       *00329000
                   ENROLL_LEFT,                                        *00330000
                   DATE_EXPIRE,                                        *00331000
                   RSV_AREA                                            *00332000
                 FETCH FIRST 1 ROW ONLY                                 00333000
         EXEC  SQL                                                     *00334000
               OPEN SAGUPD0                                             00335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00336000
         BR    14                      RETURN TO CALLER                 00337000
         LTORG                                                          00338000
*                                                                       00339000
*                                                                       00340000
**********************************************************************  00341000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00342000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00343000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00344000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00345000
*     UPDATE STATEMENT TO MATCH.                                        00346000
**********************************************************************  00347000
*                                                                       00348000
SQL#0005 DS    0H                                                       00349000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00350000
         LA    15,255                  SET RETURN CODE                  00351000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00352000
         BR    14                      RETURN TO CALLER                 00353000
         LTORG                                                          00354000
*                                                                       00355000
*                                                                       00356000
**********************************************************************  00357000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00358000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00359000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00360000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00361000
*     UPDATE STATEMENT TO MATCH.                                        00362000
**********************************************************************  00363000
*                                                                       00364000
SQL#0006 DS    0H                                                       00365000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00366000
         LA    15,255                  SET RETURN CODE                  00367000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00368000
         BR    14                      RETURN TO CALLER                 00369000
         LTORG                                                          00370000
*                                                                       00371000
*                                                                       00372000
**********************************************************************  00373000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00374000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00375000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00376000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00377000
*     UPDATE STATEMENT TO MATCH.                                        00378000
**********************************************************************  00379000
*                                                                       00380000
SQL#0007 DS    0H                                                       00381000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00382000
         LA    15,255                  SET RETURN CODE                  00383000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00384000
         BR    14                      RETURN TO CALLER                 00385000
         LTORG                                                          00386000
*                                                                       00387000
*                                                                       00388000
**********************************************************************  00389000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00390000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00391000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00392000
*     THE ACTUAL ROW.                                                   00393000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00394000
**********************************************************************  00395000
*                                                                       00396000
SQL#0008 DS    0H                                                       00397000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00398000
         EXEC  SQL                                                     *00399000
               FETCH SAGUPD0                                           *00400000
                 INTO :AUDDATE,                                        *00401000
                   :AUDTIME,                                           *00402000
                   :AUDUSER,                                           *00403000
                   :AUDORG,                                            *00404000
                   :RCIFINST,                                          *00405000
                   :RCIFTYPE,                                          *00406000
                   :QLFYALPH,                                          *00407000
                   :QLFYACUM,                                          *00408000
                   :TIBR,                                              *00409000
                   :CUSTNAME,                                          *00410000
                   :DTEOPEN,                                           *00411000
                   :IDNBR,                                             *00412000
                   :BRCH,                                              *00413000
                   :ACCTTYPE,                                          *00414000
                   :ADDACCT,                                           *00415000
                   :CASHINST,                                          *00416000
                   :CASHPROD,                                          *00417000
                   :CASHACCT,                                          *00418000
                   :ENRATTP,                                           *00419000
                   :DATEEXPR,                                          *00420000
                   :RAREA                                               00421000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00422000
         BALR  4,5                     MOVE INTO RECORD AREA            00423000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00424000
         BR    14                      RETURN TO CALLER                 00425000
         LTORG                                                          00426000
*                                                                       00427000
*                                                                       00428000
**********************************************************************  00429000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00430000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00431000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00432000
*     THE ACTUAL ROW.                                                   00433000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00434000
**********************************************************************  00435000
*                                                                       00436000
SQL#0009 DS    0H                                                       00437000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00438000
         LA    15,255                  SET RETURN CODE                  00439000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00440000
         BR    14                      RETURN TO CALLER                 00441000
         LTORG                                                          00442000
*                                                                       00443000
*                                                                       00444000
**********************************************************************  00445000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00446000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00447000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00448000
*     THE ACTUAL ROW.                                                   00449000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00450000
**********************************************************************  00451000
*                                                                       00452000
SQL#0010 DS    0H                                                       00453000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00454000
         LA    15,255                  SET RETURN CODE                  00455000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00456000
         BR    14                      RETURN TO CALLER                 00457000
         LTORG                                                          00458000
*                                                                       00459000
*                                                                       00460000
**********************************************************************  00461000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00462000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00463000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00464000
*     THE ACTUAL ROW.                                                   00465000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00466000
**********************************************************************  00467000
*                                                                       00468000
SQL#0011 DS    0H                                                       00469000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00470000
         LA    15,255                  SET RETURN CODE                  00471000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00472000
         BR    14                      RETURN TO CALLER                 00473000
         LTORG                                                          00474000
*                                                                       00475000
*                                                                       00476000
**********************************************************************  00477000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00478000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00479000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00480000
*     TO CLOSE THE UPDATE CURSOR.                                       00481000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00482000
**********************************************************************  00483000
*                                                                       00484000
SQL#0012 DS    0H                                                       00485000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00486000
         EXEC  SQL                                                     *00487000
               CLOSE SAGUPD0                                            00488000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00489000
         BR    14                      RETURN TO CALLER                 00490000
         LTORG                                                          00491000
*                                                                       00492000
*                                                                       00493000
**********************************************************************  00494000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00495000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00496000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00497000
*     TO CLOSE THE UPDATE CURSOR.                                       00498000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00499000
**********************************************************************  00500000
*                                                                       00501000
SQL#0013 DS    0H                                                       00502000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00503000
         LA    15,255                  SET RETURN CODE                  00504000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00505000
         BR    14                      RETURN TO CALLER                 00506000
         LTORG                                                          00507000
*                                                                       00508000
*                                                                       00509000
**********************************************************************  00510000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00511000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00512000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00513000
*     TO CLOSE THE UPDATE CURSOR.                                       00514000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00515000
**********************************************************************  00516000
*                                                                       00517000
SQL#0014 DS    0H                                                       00518000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00519000
         LA    15,255                  SET RETURN CODE                  00520000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00521000
         BR    14                      RETURN TO CALLER                 00522000
         LTORG                                                          00523000
*                                                                       00524000
*                                                                       00525000
**********************************************************************  00526000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00527000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00528000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00529000
*     TO CLOSE THE UPDATE CURSOR.                                       00530000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00531000
**********************************************************************  00532000
*                                                                       00533000
SQL#0015 DS    0H                                                       00534000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00535000
         LA    15,255                  SET RETURN CODE                  00536000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00537000
         BR    14                      RETURN TO CALLER                 00538000
         LTORG                                                          00539000
*                                                                       00540000
*                                                                       00541000
**********************************************************************  00542000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00543000
* KEY:                                                                  00544000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00545000
*     AND GET-NEXT-LOCK VERBS.                                          00546000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00547000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00548000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00549000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00550000
*     ORDER BY CLAUSE.                                                  00551000
**********************************************************************  00552000
*                                                                       00553000
SQL#0016 DS    0H                                                       00554000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00555000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00556000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00557000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00558000
         EXEC  SQL                                                     *00559000
               DECLARE SAGSQ001 CURSOR FOR                             *00560000
               SELECT INST_NBR,                                        *00561000
                   PROD_CODE,                                          *00562000
                   ACCT_NBR,                                           *00563000
                   MODEL,                                              *00564000
                   AUDIT_DATE,                                         *00565000
                   AUDIT_TIME,                                         *00566000
                   AUDIT_USER,                                         *00567000
                   AUDIT_ORG,                                          *00568000
                   RCIF_INST,                                          *00569000
                   RCIF_TYPE,                                          *00570000
                   QUALIFY_ALPHA,                                      *00571000
                   QUALIFY_ACCUM,                                      *00572000
                   TIEBRK,                                             *00573000
                   CUST_NAME,                                          *00574000
                   DATE_OPEN,                                          *00575000
                   IDENT_NBR,                                          *00576000
                   BRANCH,                                             *00577000
                   ACCT_TYPE,                                          *00578000
                   ADD_ON_ACCT,                                        *00579000
                   CASH_INST,                                          *00580000
                   CASH_PROD_CODE,                                     *00581000
                   CASH_ACCOUNT,                                       *00582000
                   ENROLL_LEFT,                                        *00583000
                   DATE_EXPIRE,                                        *00584000
                   RSV_AREA                                            *00585000
                 FROM SAG                                              *00586000
                 WHERE                                                 *00587000
                    INST_NBR = :INST AND                               *00588000
                    PROD_CODE = :PRDCDE AND                            *00589000
                    ACCT_NBR = :ACCTNBR AND                            *00590000
                    MODEL >= :MODEL                                    *00591000
                 ORDER BY MODEL                                        *00592000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00593000
         EXEC  SQL                                                     *00594000
               OPEN SAGSQ001                                            00595000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00596000
         BR    14                      RETURN TO CALLER                 00597000
         LTORG                                                          00598000
*                                                                       00599000
*                                                                       00600000
**********************************************************************  00601000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00602000
* KEY 1:                                                                00603000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00604000
*     AND GET-NEXT-LOCK VERBS.                                          00605000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00606000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00607000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00608000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00609000
*     ORDER BY CLAUSE.                                                  00610000
**********************************************************************  00611000
*                                                                       00612000
SQL#0017 DS    0H                                                       00613000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00614000
         LA    15,255                  SET RETURN CODE                  00615000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00616000
         BR    14                      RETURN TO CALLER                 00617000
         LTORG                                                          00618000
*                                                                       00619000
*                                                                       00620000
**********************************************************************  00621000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00622000
* KEY 2:                                                                00623000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00624000
*     AND GET-NEXT-LOCK VERBS.                                          00625000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00626000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00627000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00628000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00629000
*     ORDER BY CLAUSE.                                                  00630000
**********************************************************************  00631000
*                                                                       00632000
SQL#0018 DS    0H                                                       00633000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00634000
         LA    15,255                  SET RETURN CODE                  00635000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00636000
         BR    14                      RETURN TO CALLER                 00637000
         LTORG                                                          00638000
*                                                                       00639000
*                                                                       00640000
**********************************************************************  00641000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00642000
* KEY 3:                                                                00643000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00644000
*     AND GET-NEXT-LOCK VERBS.                                          00645000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00646000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00647000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00648000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00649000
*     ORDER BY CLAUSE.                                                  00650000
**********************************************************************  00651000
*                                                                       00652000
SQL#0019 DS    0H                                                       00653000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00654000
         LA    15,255                  SET RETURN CODE                  00655000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00656000
         BR    14                      RETURN TO CALLER                 00657000
         LTORG                                                          00658000
*                                                                       00659000
*                                                                       00660000
**********************************************************************  00661000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00662000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00663000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00664000
*     RETRIEVE THE ACTUAL ROW.                                          00665000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00666000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00667000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00668000
**********************************************************************  00669000
*                                                                       00670000
SQL#0020 DS    0H                                                       00671000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00672000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00673000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00674000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00675000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00676000
VECT0020 DC    A(SQL#0120)                                              00677000
         DC    A(SQL#0220)                                              00678000
         DC    A(SQL#0320)                                              00679000
         DC    A(SQL#0420)                                              00680000
         LTORG                                                          00681000
*                                                                       00682000
SQL#0120 DS    0H                                                       00683000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00684000
         EXEC  SQL                                                     *00685000
               FETCH SAGSQ001                                          *00686000
                 INTO :INST,                                           *00687000
                      :PRDCDE,                                         *00688000
                      :ACCTNBR,                                        *00689000
                      :MODEL,                                          *00690000
                      :AUDDATE,                                        *00691000
                      :AUDTIME,                                        *00692000
                      :AUDUSER,                                        *00693000
                      :AUDORG,                                         *00694000
                      :RCIFINST,                                       *00695000
                      :RCIFTYPE,                                       *00696000
                      :QLFYALPH,                                       *00697000
                      :QLFYACUM,                                       *00698000
                      :TIBR,                                           *00699000
                      :CUSTNAME,                                       *00700000
                      :DTEOPEN,                                        *00701000
                      :IDNBR,                                          *00702000
                      :BRCH,                                           *00703000
                      :ACCTTYPE,                                       *00704000
                      :ADDACCT,                                        *00705000
                      :CASHINST,                                       *00706000
                      :CASHPROD,                                       *00707000
                      :CASHACCT,                                       *00708000
                      :ENRATTP,                                        *00709000
                      :DATEEXPR,                                       *00710000
                      :RAREA                                            00711000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00712000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00713000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00714000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00715000
         BR    12                      OPEN NEXT CURSOR                 00716000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00717000
         BALR  4,5                     MOVE INTO RECORD AREA            00718000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00719000
         BR    14                      RETURN TO CALLER                 00720000
         LTORG                                                          00721000
*                                                                       00722000
SQL#0220 DS    0H                                                       00723000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00724000
         EXEC  SQL                                                     *00725000
               FETCH SAGSQ002                                          *00726000
                 INTO :INST,                                           *00727000
                      :PRDCDE,                                         *00728000
                      :ACCTNBR,                                        *00729000
                      :MODEL,                                          *00730000
                      :AUDDATE,                                        *00731000
                      :AUDTIME,                                        *00732000
                      :AUDUSER,                                        *00733000
                      :AUDORG,                                         *00734000
                      :RCIFINST,                                       *00735000
                      :RCIFTYPE,                                       *00736000
                      :QLFYALPH,                                       *00737000
                      :QLFYACUM,                                       *00738000
                      :TIBR,                                           *00739000
                      :CUSTNAME,                                       *00740000
                      :DTEOPEN,                                        *00741000
                      :IDNBR,                                          *00742000
                      :BRCH,                                           *00743000
                      :ACCTTYPE,                                       *00744000
                      :ADDACCT,                                        *00745000
                      :CASHINST,                                       *00746000
                      :CASHPROD,                                       *00747000
                      :CASHACCT,                                       *00748000
                      :ENRATTP,                                        *00749000
                      :DATEEXPR,                                       *00750000
                      :RAREA                                            00751000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00752000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00753000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00754000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00755000
         BR    12                      OPEN NEXT CURSOR                 00756000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00757000
         BALR  4,5                     MOVE INTO RECORD AREA            00758000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00759000
         BR    14                      RETURN TO CALLER                 00760000
         LTORG                                                          00761000
*                                                                       00762000
SQL#0320 DS    0H                                                       00763000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00764000
         EXEC  SQL                                                     *00765000
               FETCH SAGSQ003                                          *00766000
                 INTO :INST,                                           *00767000
                      :PRDCDE,                                         *00768000
                      :ACCTNBR,                                        *00769000
                      :MODEL,                                          *00770000
                      :AUDDATE,                                        *00771000
                      :AUDTIME,                                        *00772000
                      :AUDUSER,                                        *00773000
                      :AUDORG,                                         *00774000
                      :RCIFINST,                                       *00775000
                      :RCIFTYPE,                                       *00776000
                      :QLFYALPH,                                       *00777000
                      :QLFYACUM,                                       *00778000
                      :TIBR,                                           *00779000
                      :CUSTNAME,                                       *00780000
                      :DTEOPEN,                                        *00781000
                      :IDNBR,                                          *00782000
                      :BRCH,                                           *00783000
                      :ACCTTYPE,                                       *00784000
                      :ADDACCT,                                        *00785000
                      :CASHINST,                                       *00786000
                      :CASHPROD,                                       *00787000
                      :CASHACCT,                                       *00788000
                      :ENRATTP,                                        *00789000
                      :DATEEXPR,                                       *00790000
                      :RAREA                                            00791000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00792000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00793000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00794000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00795000
         BR    12                      OPEN NEXT CURSOR                 00796000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00797000
         BALR  4,5                     MOVE INTO RECORD AREA            00798000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00799000
         BR    14                      RETURN TO CALLER                 00800000
         LTORG                                                          00801000
*                                                                       00802000
SQL#0420 DS    0H                                                       00803000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          00804000
         EXEC  SQL                                                     *00805000
               FETCH SAGSQ004                                          *00806000
                 INTO :INST,                                           *00807000
                      :PRDCDE,                                         *00808000
                      :ACCTNBR,                                        *00809000
                      :MODEL,                                          *00810000
                      :AUDDATE,                                        *00811000
                      :AUDTIME,                                        *00812000
                      :AUDUSER,                                        *00813000
                      :AUDORG,                                         *00814000
                      :RCIFINST,                                       *00815000
                      :RCIFTYPE,                                       *00816000
                      :QLFYALPH,                                       *00817000
                      :QLFYACUM,                                       *00818000
                      :TIBR,                                           *00819000
                      :CUSTNAME,                                       *00820000
                      :DTEOPEN,                                        *00821000
                      :IDNBR,                                          *00822000
                      :BRCH,                                           *00823000
                      :ACCTTYPE,                                       *00824000
                      :ADDACCT,                                        *00825000
                      :CASHINST,                                       *00826000
                      :CASHPROD,                                       *00827000
                      :CASHACCT,                                       *00828000
                      :ENRATTP,                                        *00829000
                      :DATEEXPR,                                       *00830000
                      :RAREA                                            00831000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00832000
         BALR  4,5                     MOVE INTO RECORD AREA            00833000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00834000
         BR    14                      RETURN TO CALLER                 00835000
         LTORG                                                          00836000
*                                                                       00837000
*                                                                       00838000
**********************************************************************  00839000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00840000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00841000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00842000
*     RETRIEVE THE ACTUAL ROW.                                          00843000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00844000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00845000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00846000
**********************************************************************  00847000
*                                                                       00848000
SQL#0021 DS    0H                                                       00849000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00850000
         LA    15,255                  SET RETURN CODE                  00851000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00852000
         BR    14                      RETURN TO CALLER                 00853000
         LTORG                                                          00854000
*                                                                       00855000
*                                                                       00856000
**********************************************************************  00857000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           00858000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00859000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00860000
*     RETRIEVE THE ACTUAL ROW.                                          00861000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00862000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00863000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00864000
**********************************************************************  00865000
*                                                                       00866000
SQL#0022 DS    0H                                                       00867000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          00868000
         LA    15,255                  SET RETURN CODE                  00869000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00870000
         BR    14                      RETURN TO CALLER                 00871000
         LTORG                                                          00872000
*                                                                       00873000
*                                                                       00874000
**********************************************************************  00875000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           00876000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00877000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00878000
*     RETRIEVE THE ACTUAL ROW.                                          00879000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00880000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00881000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00882000
**********************************************************************  00883000
*                                                                       00884000
SQL#0023 DS    0H                                                       00885000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          00886000
         LA    15,255                  SET RETURN CODE                  00887000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00888000
         BR    14                      RETURN TO CALLER                 00889000
         LTORG                                                          00890000
*                                                                       00891000
*                                                                       00892000
**********************************************************************  00893000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00894000
* THE PRIMARY KEY:                                                      00895000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00896000
*     VERBS.                                                            00897000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00898000
*     RETRIEVE THE ACTUAL ROW.                                          00899000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00900000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00901000
*     WILL BE THRU THE UPDATE CURSOR.                                   00902000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00903000
**********************************************************************  00904000
*                                                                       00905000
SQL#0024 DS    0H                                                       00906000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          00907000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00908000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    00909000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00910000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00911000
VECT0024 DC    A(SQL#0124)                                              00912000
         DC    A(SQL#0224)                                              00913000
         DC    A(SQL#0324)                                              00914000
         DC    A(SQL#0424)                                              00915000
         LTORG                                                          00916000
*                                                                       00917000
SQL#0124 DS    0H                                                       00918000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          00919000
         EXEC  SQL                                                     *00920000
               FETCH SAGSQ001                                          *00921000
                 INTO :INST,                                           *00922000
                      :PRDCDE,                                         *00923000
                      :ACCTNBR,                                        *00924000
                      :MODEL                                            00925000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00926000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00927000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00928000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00929000
         BR    12                      OPEN NEXT CURSOR                 00930000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00931000
         BALR  4,5                     MOVE INTO RECORD AREA            00932000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00933000
         BR    14                      RETURN TO CALLER                 00934000
         LTORG                                                          00935000
*                                                                       00936000
SQL#0224 DS    0H                                                       00937000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          00938000
         EXEC  SQL                                                     *00939000
               FETCH SAGSQ002                                          *00940000
                 INTO :INST,                                           *00941000
                      :PRDCDE,                                         *00942000
                      :ACCTNBR,                                        *00943000
                      :MODEL                                            00944000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00945000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00946000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00947000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00948000
         BR    12                      OPEN NEXT CURSOR                 00949000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00950000
         BALR  4,5                     MOVE INTO RECORD AREA            00951000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00952000
         BR    14                      RETURN TO CALLER                 00953000
         LTORG                                                          00954000
*                                                                       00955000
SQL#0324 DS    0H                                                       00956000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          00957000
         EXEC  SQL                                                     *00958000
               FETCH SAGSQ003                                          *00959000
                 INTO :INST,                                           *00960000
                      :PRDCDE,                                         *00961000
                      :ACCTNBR,                                        *00962000
                      :MODEL                                            00963000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00964000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00965000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00966000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00967000
         BR    12                      OPEN NEXT CURSOR                 00968000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00969000
         BALR  4,5                     MOVE INTO RECORD AREA            00970000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00971000
         BR    14                      RETURN TO CALLER                 00972000
         LTORG                                                          00973000
*                                                                       00974000
SQL#0424 DS    0H                                                       00975000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          00976000
         EXEC  SQL                                                     *00977000
               FETCH SAGSQ004                                          *00978000
                 INTO :INST,                                           *00979000
                      :PRDCDE,                                         *00980000
                      :ACCTNBR,                                        *00981000
                      :MODEL                                            00982000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00983000
         BALR  4,5                     MOVE INTO RECORD AREA            00984000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00985000
         BR    14                      RETURN TO CALLER                 00986000
         LTORG                                                          00987000
*                                                                       00988000
*                                                                       00989000
**********************************************************************  00990000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00991000
* ALTERNATE KEY 1:                                                      00992000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00993000
*     VERBS.                                                            00994000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00995000
*     RETRIEVE THE ACTUAL ROW.                                          00996000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00997000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00998000
*     WILL BE THRU THE UPDATE CURSOR.                                   00999000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01000000
**********************************************************************  01001000
*                                                                       01002000
SQL#0025 DS    0H                                                       01003000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01004000
         LA    15,255                  SET RETURN CODE                  01005000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01006000
         BR    14                      RETURN TO CALLER                 01007000
         LTORG                                                          01008000
*                                                                       01009000
*                                                                       01010000
**********************************************************************  01011000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01012000
* ALTERNATE KEY 2:                                                      01013000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01014000
*     VERBS.                                                            01015000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01016000
*     RETRIEVE THE ACTUAL ROW.                                          01017000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01018000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01019000
*     WILL BE THRU THE UPDATE CURSOR.                                   01020000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01021000
**********************************************************************  01022000
*                                                                       01023000
SQL#0026 DS    0H                                                       01024000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01025000
         LA    15,255                  SET RETURN CODE                  01026000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01027000
         BR    14                      RETURN TO CALLER                 01028000
         LTORG                                                          01029000
*                                                                       01030000
*                                                                       01031000
**********************************************************************  01032000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01033000
* ALTERNATE KEY 3:                                                      01034000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01035000
*     VERBS.                                                            01036000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01037000
*     RETRIEVE THE ACTUAL ROW.                                          01038000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01039000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01040000
*     WILL BE THRU THE UPDATE CURSOR.                                   01041000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01042000
**********************************************************************  01043000
*                                                                       01044000
SQL#0027 DS    0H                                                       01045000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01046000
         LA    15,255                  SET RETURN CODE                  01047000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01048000
         BR    14                      RETURN TO CALLER                 01049000
         LTORG                                                          01050000
*                                                                       01051000
*                                                                       01052000
**********************************************************************  01053000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01054000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01055000
*     AND GET-NEXT-LOCK VERBS.                                          01056000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01057000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01058000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01059000
**********************************************************************  01060000
*                                                                       01061000
SQL#0028 DS    0H                                                       01062000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01063000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01064000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01065000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01066000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01067000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01068000
VECT0028 DC    A(SQL#0128)                                              01069000
         DC    A(SQL#0228)                                              01070000
         DC    A(SQL#0328)                                              01071000
         DC    A(SQL#0428)                                              01072000
         LTORG                                                          01073000
*                                                                       01074000
SQL#0128 DS    0H                                                       01075000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01076000
         EXEC  SQL                                                     *01077000
               CLOSE SAGSQ001                                           01078000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01079000
         BR    14                      RETURN TO CALLER                 01080000
         LTORG                                                          01081000
*                                                                       01082000
SQL#0228 DS    0H                                                       01083000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01084000
         EXEC  SQL                                                     *01085000
               CLOSE SAGSQ002                                           01086000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01087000
         BR    14                      RETURN TO CALLER                 01088000
         LTORG                                                          01089000
*                                                                       01090000
SQL#0328 DS    0H                                                       01091000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01092000
         EXEC  SQL                                                     *01093000
               CLOSE SAGSQ003                                           01094000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01095000
         BR    14                      RETURN TO CALLER                 01096000
         LTORG                                                          01097000
*                                                                       01098000
SQL#0428 DS    0H                                                       01099000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01100000
         EXEC  SQL                                                     *01101000
               CLOSE SAGSQ004                                           01102000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01103000
         BR    14                      RETURN TO CALLER                 01104000
         LTORG                                                          01105000
*                                                                       01106000
*                                                                       01107000
**********************************************************************  01108000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01109000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01110000
*     AND GET-NEXT-LOCK VERBS.                                          01111000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01112000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01113000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01114000
**********************************************************************  01115000
*                                                                       01116000
SQL#0029 DS    0H                                                       01117000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01118000
         LA    15,255                  SET RETURN CODE                  01119000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01120000
         BR    14                      RETURN TO CALLER                 01121000
         LTORG                                                          01122000
*                                                                       01123000
*                                                                       01124000
**********************************************************************  01125000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01126000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01127000
*     AND GET-NEXT-LOCK VERBS.                                          01128000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01129000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01130000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01131000
**********************************************************************  01132000
*                                                                       01133000
SQL#0030 DS    0H                                                       01134000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01135000
         LA    15,255                  SET RETURN CODE                  01136000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01137000
         BR    14                      RETURN TO CALLER                 01138000
         LTORG                                                          01139000
*                                                                       01140000
*                                                                       01141000
**********************************************************************  01142000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01143000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01144000
*     AND GET-NEXT-LOCK VERBS.                                          01145000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01146000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01147000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01148000
**********************************************************************  01149000
*                                                                       01150000
SQL#0031 DS    0H                                                       01151000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01152000
         LA    15,255                  SET RETURN CODE                  01153000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01154000
         BR    14                      RETURN TO CALLER                 01155000
         LTORG                                                          01156000
*                                                                       01157000
*                                                                       01158000
**********************************************************************  01159000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01160000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01161000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01162000
**********************************************************************  01163000
*                                                                       01164000
SQL#0032 DS    0H                                                       01165000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01166000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01167000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01168000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01169000
         EXEC  SQL                                                     *01170000
               SELECT INST_NBR,                                        *01171000
                   PROD_CODE,                                          *01172000
                   ACCT_NBR,                                           *01173000
                   MODEL                                               *01174000
                 INTO :INST,                                           *01175000
                   :PRDCDE,                                            *01176000
                   :ACCTNBR,                                           *01177000
                   :MODEL                                              *01178000
                 FROM SAG                                              *01179000
                 WHERE INST_NBR = :INST AND                            *01180000
                   PROD_CODE = :PRDCDE AND                             *01181000
                   ACCT_NBR = :ACCTNBR AND                             *01182000
                   MODEL = :MODEL                                      *01183000
                 FETCH FIRST 1 ROW ONLY                                 01184000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01185000
         BR    14                      RETURN TO CALLER                 01186000
         LTORG                                                          01187000
*                                                                       01188000
*                                                                       01189000
**********************************************************************  01190000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01191000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01192000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01193000
**********************************************************************  01194000
*                                                                       01195000
SQL#0033 DS    0H                                                       01196000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01197000
         LA    15,255                  SET RETURN CODE                  01198000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01199000
         BR    14                      RETURN TO CALLER                 01200000
         LTORG                                                          01201000
*                                                                       01202000
*                                                                       01203000
**********************************************************************  01204000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01205000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01206000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01207000
**********************************************************************  01208000
*                                                                       01209000
SQL#0034 DS    0H                                                       01210000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01211000
         LA    15,255                  SET RETURN CODE                  01212000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01213000
         BR    14                      RETURN TO CALLER                 01214000
         LTORG                                                          01215000
*                                                                       01216000
*                                                                       01217000
**********************************************************************  01218000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01219000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01220000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01221000
**********************************************************************  01222000
*                                                                       01223000
SQL#0035 DS    0H                                                       01224000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01225000
         LA    15,255                  SET RETURN CODE                  01226000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01227000
         BR    14                      RETURN TO CALLER                 01228000
         LTORG                                                          01229000
*                                                                       01230000
*                                                                       01231000
**********************************************************************  01232000
* INSERT STATEMENT:                                                     01233000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01234000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01235000
**********************************************************************  01236000
*                                                                       01237000
SQL#0036 DS    0H                                                       01238000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01239000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01240000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01241000
         EXEC  SQL                                                     *01242000
               INSERT INTO SAG                                         *01243000
                   (INST_NBR,                                          *01244000
                    PROD_CODE,                                         *01245000
                    ACCT_NBR,                                          *01246000
                    MODEL,                                             *01247000
                    AUDIT_DATE,                                        *01248000
                    AUDIT_TIME,                                        *01249000
                    AUDIT_USER,                                        *01250000
                    AUDIT_ORG,                                         *01251000
                    RCIF_INST,                                         *01252000
                    RCIF_TYPE,                                         *01253000
                    QUALIFY_ALPHA,                                     *01254000
                    QUALIFY_ACCUM,                                     *01255000
                    TIEBRK,                                            *01256000
                    CUST_NAME,                                         *01257000
                    DATE_OPEN,                                         *01258000
                    IDENT_NBR,                                         *01259000
                    BRANCH,                                            *01260000
                    ACCT_TYPE,                                         *01261000
                    ADD_ON_ACCT,                                       *01262000
                    CASH_INST,                                         *01263000
                    CASH_PROD_CODE,                                    *01264000
                    CASH_ACCOUNT,                                      *01265000
                    ENROLL_LEFT,                                       *01266000
                    DATE_EXPIRE,                                       *01267000
                    RSV_AREA)                                          *01268000
                  VALUES (:INST,                                       *01269000
                   :PRDCDE,                                            *01270000
                   :ACCTNBR,                                           *01271000
                   :MODEL,                                             *01272000
                   :AUDDATE,                                           *01273000
                   :AUDTIME,                                           *01274000
                   :AUDUSER,                                           *01275000
                   :AUDORG,                                            *01276000
                   :RCIFINST,                                          *01277000
                   :RCIFTYPE,                                          *01278000
                   :QLFYALPH,                                          *01279000
                   :QLFYACUM,                                          *01280000
                   :TIBR,                                              *01281000
                   :CUSTNAME,                                          *01282000
                   :DTEOPEN,                                           *01283000
                   :IDNBR,                                             *01284000
                   :BRCH,                                              *01285000
                   :ACCTTYPE,                                          *01286000
                   :ADDACCT,                                           *01287000
                   :CASHINST,                                          *01288000
                   :CASHPROD,                                          *01289000
                   :CASHACCT,                                          *01290000
                   :ENRATTP,                                           *01291000
                   :DATEEXPR,                                          *01292000
                   :RAREA)                                              01293000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01294000
         BR    14                      RETURN TO CALLER                 01295000
         LTORG                                                          01296000
*                                                                       01297000
*                                                                       01298000
**********************************************************************  01299000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01300000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01301000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01302000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01303000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01304000
*     STATEMENT.                                                        01305000
**********************************************************************  01306000
*                                                                       01307000
SQL#0037 DS    0H                                                       01308000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01309000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01310000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01311000
         EXEC  SQL                                                     *01312000
               UPDATE SAG                                              *01313000
                   SET AUDIT_DATE = :AUDDATE,                          *01314000
                     AUDIT_TIME = :AUDTIME,                            *01315000
                     AUDIT_USER = :AUDUSER,                            *01316000
                     AUDIT_ORG = :AUDORG,                              *01317000
                     RCIF_INST = :RCIFINST,                            *01318000
                     RCIF_TYPE = :RCIFTYPE,                            *01319000
                     QUALIFY_ALPHA = :QLFYALPH,                        *01320000
                     QUALIFY_ACCUM = :QLFYACUM,                        *01321000
                     TIEBRK = :TIBR,                                   *01322000
                     CUST_NAME = :CUSTNAME,                            *01323000
                     DATE_OPEN = :DTEOPEN,                             *01324000
                     IDENT_NBR = :IDNBR,                               *01325000
                     BRANCH = :BRCH,                                   *01326000
                     ACCT_TYPE = :ACCTTYPE,                            *01327000
                     ADD_ON_ACCT = :ADDACCT,                           *01328000
                     CASH_INST = :CASHINST,                            *01329000
                     CASH_PROD_CODE = :CASHPROD,                       *01330000
                     CASH_ACCOUNT = :CASHACCT,                         *01331000
                     ENROLL_LEFT = :ENRATTP,                           *01332000
                     DATE_EXPIRE = :DATEEXPR,                          *01333000
                     RSV_AREA = :RAREA                                 *01334000
                 WHERE CURRENT OF SAGUPD0                               01335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01336000
         BR    14                      RETURN TO CALLER                 01337000
         LTORG                                                          01338000
*                                                                       01339000
*                                                                       01340000
**********************************************************************  01341000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01342000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01343000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01344000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01345000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01346000
*     STATEMENT.                                                        01347000
**********************************************************************  01348000
*                                                                       01349000
SQL#0038 DS    0H                                                       01350000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01351000
         LA    15,255                  SET RETURN CODE                  01352000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01353000
         BR    14                      RETURN TO CALLER                 01354000
         LTORG                                                          01355000
*                                                                       01356000
*                                                                       01357000
**********************************************************************  01358000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01359000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01360000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01361000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01362000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01363000
*     STATEMENT.                                                        01364000
**********************************************************************  01365000
*                                                                       01366000
SQL#0039 DS    0H                                                       01367000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01368000
         LA    15,255                  SET RETURN CODE                  01369000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01370000
         BR    14                      RETURN TO CALLER                 01371000
         LTORG                                                          01372000
*                                                                       01373000
*                                                                       01374000
**********************************************************************  01375000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01376000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01377000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01378000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01379000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01380000
*     STATEMENT.                                                        01381000
**********************************************************************  01382000
*                                                                       01383000
SQL#0040 DS    0H                                                       01384000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01385000
         LA    15,255                  SET RETURN CODE                  01386000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01387000
         BR    14                      RETURN TO CALLER                 01388000
         LTORG                                                          01389000
*                                                                       01390000
*                                                                       01391000
**********************************************************************  01392000
* DELETE STATEMENT BY PRIMARY KEY:                                      01393000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01394000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01395000
**********************************************************************  01396000
*                                                                       01397000
SQL#0041 DS    0H                                                       01398000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01399000
         EXEC  SQL                                                     *01400000
               DELETE FROM SAG                                         *01401000
                 WHERE CURRENT OF SAGUPD0                               01402000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01403000
         BR    14                      RETURN TO CALLER                 01404000
         LTORG                                                          01405000
*                                                                       01406000
*                                                                       01407000
**********************************************************************  01408000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01409000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01410000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01411000
**********************************************************************  01412000
*                                                                       01413000
SQL#0042 DS    0H                                                       01414000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01415000
         LA    15,255                  SET RETURN CODE                  01416000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01417000
         BR    14                      RETURN TO CALLER                 01418000
         LTORG                                                          01419000
*                                                                       01420000
*                                                                       01421000
**********************************************************************  01422000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01423000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01424000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01425000
**********************************************************************  01426000
*                                                                       01427000
SQL#0043 DS    0H                                                       01428000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01429000
         LA    15,255                  SET RETURN CODE                  01430000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01431000
         BR    14                      RETURN TO CALLER                 01432000
         LTORG                                                          01433000
*                                                                       01434000
*                                                                       01435000
**********************************************************************  01436000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01437000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01438000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01439000
**********************************************************************  01440000
*                                                                       01441000
SQL#0044 DS    0H                                                       01442000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01443000
         LA    15,255                  SET RETURN CODE                  01444000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01445000
         BR    14                      RETURN TO CALLER                 01446000
         LTORG                                                          01447000
*                                                                       01448000
*                                                                       01449000
**********************************************************************  01450000
* DELETE ALL STATEMENT:                                                 01451000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01452000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01453000
**********************************************************************  01454000
*                                                                       01455000
SQL#0045 DS    0H                                                       01456000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01457000
         EXEC  SQL                                                     *01458000
               DELETE FROM SAG                                          01459000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01460000
         BR    14                      RETURN TO CALLER                 01461000
         LTORG                                                          01462000
*                                                                       01463000
*                                                                       01464000
**********************************************************************  01465000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01466000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01467000
**********************************************************************  01468000
*                                                                       01469000
SQL#0046 DS    0H                                                       01470000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01471000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01472000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01473000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01474000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01475000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01476000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01477000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01478000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01479000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01480000
VECT0046 DC    A(0)                                                     01481000
         DC    A(SQL#0246)                                              01482000
         DC    A(SQL#0346)                                              01483000
         DC    A(SQL#0446)                                              01484000
         LTORG                                                          01485000
*                                                                       01486000
SQL#0246 DS    0H                                                       01487000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01488000
         EXEC  SQL                                                     *01489000
               CLOSE SAGSQ001                                           01490000
         EXEC  SQL                                                     *01491000
               DECLARE SAGSQ002 CURSOR FOR                             *01492000
               SELECT INST_NBR,                                        *01493000
                   PROD_CODE,                                          *01494000
                   ACCT_NBR,                                           *01495000
                   MODEL,                                              *01496000
                   AUDIT_DATE,                                         *01497000
                   AUDIT_TIME,                                         *01498000
                   AUDIT_USER,                                         *01499000
                   AUDIT_ORG,                                          *01500000
                   RCIF_INST,                                          *01501000
                   RCIF_TYPE,                                          *01502000
                   QUALIFY_ALPHA,                                      *01503000
                   QUALIFY_ACCUM,                                      *01504000
                   TIEBRK,                                             *01505000
                   CUST_NAME,                                          *01506000
                   DATE_OPEN,                                          *01507000
                   IDENT_NBR,                                          *01508000
                   BRANCH,                                             *01509000
                   ACCT_TYPE,                                          *01510000
                   ADD_ON_ACCT,                                        *01511000
                   CASH_INST,                                          *01512000
                   CASH_PROD_CODE,                                     *01513000
                   CASH_ACCOUNT,                                       *01514000
                   ENROLL_LEFT,                                        *01515000
                   DATE_EXPIRE,                                        *01516000
                   RSV_AREA                                            *01517000
                 FROM SAG                                              *01518000
                 WHERE                                                 *01519000
                    INST_NBR = :INST AND                               *01520000
                    PROD_CODE = :PRDCDE AND                            *01521000
                    ACCT_NBR > :ACCTNBR                                *01522000
                 ORDER BY ACCT_NBR,                                    *01523000
                   MODEL                                               *01524000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01525000
         EXEC  SQL                                                     *01526000
               OPEN SAGSQ002                                            01527000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01528000
         BNZ   *+8                     NO - RETURN ERROR                01529000
         LR    12,9                    LOAD RETURN ADDRESS              01530000
         BR    12                      RETURN TO FETCH ROUTINE          01531000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01532000
         BR    14                      RETURN TO CALLER                 01533000
         LTORG                                                          01534000
*                                                                       01535000
SQL#0346 DS    0H                                                       01536000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01537000
         EXEC  SQL                                                     *01538000
               CLOSE SAGSQ002                                           01539000
         EXEC  SQL                                                     *01540000
               DECLARE SAGSQ003 CURSOR FOR                             *01541000
               SELECT INST_NBR,                                        *01542000
                   PROD_CODE,                                          *01543000
                   ACCT_NBR,                                           *01544000
                   MODEL,                                              *01545000
                   AUDIT_DATE,                                         *01546000
                   AUDIT_TIME,                                         *01547000
                   AUDIT_USER,                                         *01548000
                   AUDIT_ORG,                                          *01549000
                   RCIF_INST,                                          *01550000
                   RCIF_TYPE,                                          *01551000
                   QUALIFY_ALPHA,                                      *01552000
                   QUALIFY_ACCUM,                                      *01553000
                   TIEBRK,                                             *01554000
                   CUST_NAME,                                          *01555000
                   DATE_OPEN,                                          *01556000
                   IDENT_NBR,                                          *01557000
                   BRANCH,                                             *01558000
                   ACCT_TYPE,                                          *01559000
                   ADD_ON_ACCT,                                        *01560000
                   CASH_INST,                                          *01561000
                   CASH_PROD_CODE,                                     *01562000
                   CASH_ACCOUNT,                                       *01563000
                   ENROLL_LEFT,                                        *01564000
                   DATE_EXPIRE,                                        *01565000
                   RSV_AREA                                            *01566000
                 FROM SAG                                              *01567000
                 WHERE                                                 *01568000
                    INST_NBR = :INST AND                               *01569000
                    PROD_CODE > :PRDCDE                                *01570000
                 ORDER BY PROD_CODE,                                   *01571000
                   ACCT_NBR,                                           *01572000
                   MODEL                                               *01573000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01574000
         EXEC  SQL                                                     *01575000
               OPEN SAGSQ003                                            01576000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01577000
         BNZ   *+8                     NO - RETURN ERROR                01578000
         LR    12,9                    LOAD RETURN ADDRESS              01579000
         BR    12                      RETURN TO FETCH ROUTINE          01580000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01581000
         BR    14                      RETURN TO CALLER                 01582000
         LTORG                                                          01583000
*                                                                       01584000
SQL#0446 DS    0H                                                       01585000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          01586000
         EXEC  SQL                                                     *01587000
               CLOSE SAGSQ003                                           01588000
         EXEC  SQL                                                     *01589000
               DECLARE SAGSQ004 CURSOR FOR                             *01590000
               SELECT INST_NBR,                                        *01591000
                   PROD_CODE,                                          *01592000
                   ACCT_NBR,                                           *01593000
                   MODEL,                                              *01594000
                   AUDIT_DATE,                                         *01595000
                   AUDIT_TIME,                                         *01596000
                   AUDIT_USER,                                         *01597000
                   AUDIT_ORG,                                          *01598000
                   RCIF_INST,                                          *01599000
                   RCIF_TYPE,                                          *01600000
                   QUALIFY_ALPHA,                                      *01601000
                   QUALIFY_ACCUM,                                      *01602000
                   TIEBRK,                                             *01603000
                   CUST_NAME,                                          *01604000
                   DATE_OPEN,                                          *01605000
                   IDENT_NBR,                                          *01606000
                   BRANCH,                                             *01607000
                   ACCT_TYPE,                                          *01608000
                   ADD_ON_ACCT,                                        *01609000
                   CASH_INST,                                          *01610000
                   CASH_PROD_CODE,                                     *01611000
                   CASH_ACCOUNT,                                       *01612000
                   ENROLL_LEFT,                                        *01613000
                   DATE_EXPIRE,                                        *01614000
                   RSV_AREA                                            *01615000
                 FROM SAG                                              *01616000
                 WHERE                                                 *01617000
                    INST_NBR > :INST                                   *01618000
                 ORDER BY INST_NBR,                                    *01619000
                   PROD_CODE,                                          *01620000
                   ACCT_NBR,                                           *01621000
                   MODEL                                               *01622000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01623000
         EXEC  SQL                                                     *01624000
               OPEN SAGSQ004                                            01625000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01626000
         BNZ   *+8                     NO - RETURN ERROR                01627000
         LR    12,9                    LOAD RETURN ADDRESS              01628000
         BR    12                      RETURN TO FETCH ROUTINE          01629000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01630000
         BR    14                      RETURN TO CALLER                 01631000
         LTORG                                                          01632000
*                                                                       01633000
*                                                                       01634000
**********************************************************************  01635000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01636000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01637000
**********************************************************************  01638000
*                                                                       01639000
SQL#0047 DS    0H                                                       01640000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01641000
         LA    15,255                  SET RETURN CODE                  01642000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01643000
         BR    14                      RETURN TO CALLER                 01644000
         LTORG                                                          01645000
*                                                                       01646000
*                                                                       01647000
**********************************************************************  01648000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01649000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01650000
**********************************************************************  01651000
*                                                                       01652000
SQL#0048 DS    0H                                                       01653000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01654000
         LA    15,255                  SET RETURN CODE                  01655000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01656000
         BR    14                      RETURN TO CALLER                 01657000
         LTORG                                                          01658000
*                                                                       01659000
*                                                                       01660000
**********************************************************************  01661000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01662000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01663000
**********************************************************************  01664000
*                                                                       01665000
SQL#0049 DS    0H                                                       01666000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01667000
         LA    15,255                  SET RETURN CODE                  01668000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01669000
         BR    14                      RETURN TO CALLER                 01670000
         LTORG                                                          01671000
*                                                                       01672000
         DS    0H                      END OF SQL STATEMENTS            01673000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01674000
*                                                                       01675000
*                                                                       01676000
**********************************************************************  01677000
* DUMMY ENTRY POINT DSNHLI                                              01678000
*   MUST NOT BE MODIFIED.                                               01679000
**********************************************************************  01680000
*                                                                       01681000
         ENTRY DSNHLI                                                   01682000
DSNHLI   DS    0H                                                       01683000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01684000
         BR    15                      BRANCH TO ATTACH FACILITY        01685000
*                                                                       01686000
*                                                                       01687000
**********************************************************************  01688000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01689000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01690000
*   MUST NOT BE MODIFIED.                                               01691000
**********************************************************************  01692000
*                                                                       01693000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01694000
CONV#RTN AMODE ANY                                                      01695000
CONV#RTN RMODE ANY                                                      01696000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01697000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01698000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01699000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01700000
         BER   4                         YES - RETURN TO SQL            01701000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01702000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01703000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01704000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01705000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01706000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01707000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01708000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01709000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01710000
*                                                                       01711000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01712000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01713000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01714000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01715000
         BER   4                         YES - RETURN TO SQL            01716000
         SLR   0,0                     CLEAR FOR INSERT                 01717000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01718000
         NR    0,3                     FOR THE CURRENT KEY?             01719000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01720000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01721000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01722000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01723000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01724000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01725000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01726000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01727000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01728000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01729000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01730000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01731000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01732000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01733000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01734000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01735000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01736000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01737000
*                                                                       01738000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01739000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01740000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01741000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01742000
         BER   4                         YES - RETURN TO SQL            01743000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01744000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01745000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01746000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01747000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01748000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01749000
         MVCL  0,14                    MOVE TO RECORD AREA              01750000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01751000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01752000
*                                                                       01753000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01754000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01755000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01756000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01757000
         BER   4                         YES - RETURN TO SQL            01758000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01759000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01760000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01761000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01762000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01763000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01764000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01765000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01766000
         MVCL  0,14                    MOVE TO RECORD AREA              01767000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01768000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01769000
*                                                                       01770000
*                                                                       01771000
**********************************************************************  01772000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01773000
*   MUST NOT BE MODIFIED.                                               01774000
**********************************************************************  01775000
*                                                                       01776000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01777000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01778000
         DC    H'0038'                 LENGTH TO MOVE                   01779000
         DC    X'80'                   80 = KEY 0 FIELD                 01780000
*                                      40 = KEY 1 FIELD                 01781000
*                                      20 = KEY 2 FIELD                 01782000
*                                      10 = KEY 3 FIELD                 01783000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        01784000
*                                                                       01785000
*                                      REST OF FIELD ENTRIES            01786000
         DC    H'0038',H'0038',H'0194',X'00',X'00'                      01787000
         DC    8X'FF'                  END OF FIELD ENTRIES             01788000
         LTORG                                                          01789000
         END                                                            01790000
