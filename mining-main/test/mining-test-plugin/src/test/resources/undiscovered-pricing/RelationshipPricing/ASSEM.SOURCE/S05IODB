* REL=S05IODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  S05IODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S05 FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL563                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
RECNBR   DS    CL4                                                      00039000
DEMO     DS    CL6                                                      00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
KEYWRD1  DS    CL15                                                     00045000
RELCD1   DS    CL2                                                      00046000
VALUE1   DS    CL15                                                     00047000
ANDOR1   DS    CL3                                                      00048000
KEYWRD2  DS    CL15                                                     00049000
RELCD2   DS    CL2                                                      00050000
VALUE2   DS    CL15                                                     00051000
ANDOR2   DS    CL3                                                      00052000
KEYWRD3  DS    CL15                                                     00053000
RELCD3   DS    CL2                                                      00054000
VALUE3   DS    CL15                                                     00055000
ANDOR3   DS    CL3                                                      00056000
KEYWRD4  DS    CL15                                                     00057000
RELCD4   DS    CL2                                                      00058000
VALUE4   DS    CL15                                                     00059000
ANDOR4   DS    CL3                                                      00060000
KEYWRD5  DS    CL15                                                     00061000
RELCD5   DS    CL2                                                      00062000
VALUE5   DS    CL15                                                     00063000
ANDOR5   DS    CL3                                                      00064000
KEYWRD6  DS    CL15                                                     00065000
RELCD6   DS    CL2                                                      00066000
VALUE6   DS    CL15                                                     00067000
ANDOR6   DS    CL3                                                      00068000
KEYWRD7  DS    CL15                                                     00069000
RELCD7   DS    CL2                                                      00070000
VALUE7   DS    CL15                                                     00071000
ANDOR7   DS    CL3                                                      00072000
KEYWRD8  DS    CL15                                                     00073000
RELCD8   DS    CL2                                                      00074000
VALUE8   DS    CL15                                                     00075000
ANDOR8   DS    CL3                                                      00076000
KEYWRD9  DS    CL15                                                     00077000
RELCD9   DS    CL2                                                      00078000
VALUE9   DS    CL15                                                     00079000
ANDOR9   DS    CL3                                                      00080000
KEYWRD10 DS    CL15                                                     00081000
RELCD10  DS    CL2                                                      00082000
VALUE10  DS    CL15                                                     00083000
ANDOR10  DS    CL3                                                      00084000
KEYWRD11 DS    CL15                                                     00085000
RELCD11  DS    CL2                                                      00086000
VALUE11  DS    CL15                                                     00087000
ANDOR11  DS    CL3                                                      00088000
KEYWRD12 DS    CL15                                                     00089000
RELCD12  DS    CL2                                                      00090000
VALUE12  DS    CL15                                                     00091000
ANDOR12  DS    CL3                                                      00092000
KEYWRD13 DS    CL15                                                     00093000
RELCD13  DS    CL2                                                      00094000
VALUE13  DS    CL15                                                     00095000
ANDOR13  DS    CL3                                                      00096000
KEYWRD14 DS    CL15                                                     00097000
RELCD14  DS    CL2                                                      00098000
VALUE14  DS    CL15                                                     00099000
ANDOR14  DS    CL3                                                      00100000
KEYWRD15 DS    CL15                                                     00101000
RELCD15  DS    CL2                                                      00102000
VALUE15  DS    CL15                                                     00103000
ANDOR15  DS    CL3                                                      00104000
*                                                                       00105000
*                                                                       00106000
**********************************************************************  00107000
* PROGRAM TABLE HEADER SECTION:                                         00108000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00109000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00110000
**********************************************************************  00111000
*                                                                       00112000
S05IODB  CSECT                         PROGRAM TABLE SECTION            00113000
S05IODB  AMODE ANY                                                      00114000
S05IODB  RMODE ANY                                                      00115000
         DC    CL9'S05IODB'            PROGRAM ID                       00116000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00117000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00118000
         DC    A(0)                    RESERVED                         00119000
         DC    A(0)                    RESERVED                         00120000
         DC    24CL1' '                RESERVED                         00121000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00122000
*                                                                       00123000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00124000
         DC    CL29'WWW.INFOR.COM                '                      00124001
*                                                                       00125000
*                                                                       00126000
**********************************************************************  00127000
* STATEMENT TABLE SECTION:                                              00128000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00129000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00130000
*   SHOULD NOT BE MODIFIED.                                             00131000
**********************************************************************  00132000
*                                                                       00133000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00134000
STM#TAB  AMODE ANY                                                      00135000
STM#TAB  RMODE ANY                                                      00136000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00137000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00138000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00139000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00140000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00141000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00142000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00143000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00144000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00145000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00146000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00147000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00148000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00149000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00150000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00151000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00152000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00153000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00154000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00155000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00156000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00157000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00158000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00159000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00160000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00161000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00162000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00163000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00164000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00165000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00166000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00167000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00168000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00169000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00170000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00171000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00172000
         DC    A(SQL#0036)             INSERT STATEMENT                 00173000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00174000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00175000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00176000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00177000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00178000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00179000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00180000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00181000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00182000
         DC    4X'FF'                                                   00183000
*                                                                       00184000
*                                                                       00185000
**********************************************************************  00186000
* SQL STATEMENT SECTION:                                                00187000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00188000
*     TO SUPPORT THIS TABLE.                                            00189000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00190000
*     ARE EQUIVALENT.                                                   00191000
**********************************************************************  00192000
*                                                                       00193000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00194000
SQL#STMT AMODE ANY                                                      00195000
SQL#STMT RMODE ANY                                                      00196000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00197000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00198000
         USING COM#AREA,11             ADDRESS COMMAREA                 00199000
*                                                                       00200000
*                                                                       00201000
**********************************************************************  00202000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00203000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00204000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00205000
**********************************************************************  00206000
*                                                                       00207000
SQL#0000 DS    0H                                                       00208000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00209000
         B     *+6                     BRANCH AROUND ADCON              00210000
BASE0000 DC    AL2(4096)                                                00211000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00212000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00213000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00214000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00215000
         AH    3,BASE0000              ADD 4K                           00216000
         EXEC  SQL                                                     *00217000
               SELECT AUDIT_DATE,                                      *00218000
                   AUDIT_TIME,                                         *00219000
                   AUDIT_USER,                                         *00220000
                   AUDIT_ORG,                                          *00221000
                   KEY_WORD_01,                                        *00222000
                   REL_CODE_01,                                        *00223000
                   VALUE_01,                                           *00224000
                   AND_OR_01,                                          *00225000
                   KEY_WORD_02,                                        *00226000
                   REL_CODE_02,                                        *00227000
                   VALUE_02,                                           *00228000
                   AND_OR_02,                                          *00229000
                   KEY_WORD_03,                                        *00230000
                   REL_CODE_03,                                        *00231000
                   VALUE_03,                                           *00232000
                   AND_OR_03,                                          *00233000
                   KEY_WORD_04,                                        *00234000
                   REL_CODE_04,                                        *00235000
                   VALUE_04,                                           *00236000
                   AND_OR_04,                                          *00237000
                   KEY_WORD_05,                                        *00238000
                   REL_CODE_05,                                        *00239000
                   VALUE_05,                                           *00240000
                   AND_OR_05,                                          *00241000
                   KEY_WORD_06,                                        *00242000
                   REL_CODE_06,                                        *00243000
                   VALUE_06,                                           *00244000
                   AND_OR_06,                                          *00245000
                   KEY_WORD_07,                                        *00246000
                   REL_CODE_07,                                        *00247000
                   VALUE_07,                                           *00248000
                   AND_OR_07,                                          *00249000
                   KEY_WORD_08,                                        *00250000
                   REL_CODE_08,                                        *00251000
                   VALUE_08,                                           *00252000
                   AND_OR_08,                                          *00253000
                   KEY_WORD_09,                                        *00254000
                   REL_CODE_09,                                        *00255000
                   VALUE_09,                                           *00256000
                   AND_OR_09,                                          *00257000
                   KEY_WORD_10,                                        *00258000
                   REL_CODE_10,                                        *00259000
                   VALUE_10,                                           *00260000
                   AND_OR_10,                                          *00261000
                   KEY_WORD_11,                                        *00262000
                   REL_CODE_11,                                        *00263000
                   VALUE_11,                                           *00264000
                   AND_OR_11,                                          *00265000
                   KEY_WORD_12,                                        *00266000
                   REL_CODE_12,                                        *00267000
                   VALUE_12,                                           *00268000
                   AND_OR_12,                                          *00269000
                   KEY_WORD_13,                                        *00270000
                   REL_CODE_13,                                        *00271000
                   VALUE_13,                                           *00272000
                   AND_OR_13,                                          *00273000
                   KEY_WORD_14,                                        *00274000
                   REL_CODE_14,                                        *00275000
                   VALUE_14,                                           *00276000
                   AND_OR_14,                                          *00277000
                   KEY_WORD_15,                                        *00278000
                   REL_CODE_15,                                        *00279000
                   VALUE_15,                                           *00280000
                   AND_OR_15                                           *00281000
                 INTO :AUDDATE,                                        *00282000
                   :AUDTIME,                                           *00283000
                   :AUDUSER,                                           *00284000
                   :AUDORG,                                            *00285000
                   :KEYWRD1,                                           *00286000
                   :RELCD1,                                            *00287000
                   :VALUE1,                                            *00288000
                   :ANDOR1,                                            *00289000
                   :KEYWRD2,                                           *00290000
                   :RELCD2,                                            *00291000
                   :VALUE2,                                            *00292000
                   :ANDOR2,                                            *00293000
                   :KEYWRD3,                                           *00294000
                   :RELCD3,                                            *00295000
                   :VALUE3,                                            *00296000
                   :ANDOR3,                                            *00297000
                   :KEYWRD4,                                           *00298000
                   :RELCD4,                                            *00299000
                   :VALUE4,                                            *00300000
                   :ANDOR4,                                            *00301000
                   :KEYWRD5,                                           *00302000
                   :RELCD5,                                            *00303000
                   :VALUE5,                                            *00304000
                   :ANDOR5,                                            *00305000
                   :KEYWRD6,                                           *00306000
                   :RELCD6,                                            *00307000
                   :VALUE6,                                            *00308000
                   :ANDOR6,                                            *00309000
                   :KEYWRD7,                                           *00310000
                   :RELCD7,                                            *00311000
                   :VALUE7,                                            *00312000
                   :ANDOR7,                                            *00313000
                   :KEYWRD8,                                           *00314000
                   :RELCD8,                                            *00315000
                   :VALUE8,                                            *00316000
                   :ANDOR8,                                            *00317000
                   :KEYWRD9,                                           *00318000
                   :RELCD9,                                            *00319000
                   :VALUE9,                                            *00320000
                   :ANDOR9,                                            *00321000
                   :KEYWRD10,                                          *00322000
                   :RELCD10,                                           *00323000
                   :VALUE10,                                           *00324000
                   :ANDOR10,                                           *00325000
                   :KEYWRD11,                                          *00326000
                   :RELCD11,                                           *00327000
                   :VALUE11,                                           *00328000
                   :ANDOR11,                                           *00329000
                   :KEYWRD12,                                          *00330000
                   :RELCD12,                                           *00331000
                   :VALUE12,                                           *00332000
                   :ANDOR12,                                           *00333000
                   :KEYWRD13,                                          *00334000
                   :RELCD13,                                           *00335000
                   :VALUE13,                                           *00336000
                   :ANDOR13,                                           *00337000
                   :KEYWRD14,                                          *00338000
                   :RELCD14,                                           *00339000
                   :VALUE14,                                           *00340000
                   :ANDOR14,                                           *00341000
                   :KEYWRD15,                                          *00342000
                   :RELCD15,                                           *00343000
                   :VALUE15,                                           *00344000
                   :ANDOR15                                            *00345000
                 FROM S05                                              *00346000
                 WHERE INST_NBR = :INST AND                            *00347000
                   RECORD_NBR = :RECNBR AND                            *00348000
                   DEMOGR_CODE = :DEMO                                 *00349000
                 FETCH FIRST 1 ROW ONLY                                 00350000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00351000
         BALR  4,5                     MOVE INTO RECORD AREA            00352000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00353000
         BR    14                      RETURN TO CALLER                 00354000
         LTORG                                                          00355000
*                                                                       00356000
*                                                                       00357000
**********************************************************************  00358000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00359000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00360000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00361000
**********************************************************************  00362000
*                                                                       00363000
SQL#0001 DS    0H                                                       00364000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00365000
         LA    15,255                  SET RETURN CODE                  00366000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00367000
         BR    14                      RETURN TO CALLER                 00368000
         LTORG                                                          00369000
*                                                                       00370000
*                                                                       00371000
**********************************************************************  00372000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00373000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00374000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00375000
**********************************************************************  00376000
*                                                                       00377000
SQL#0002 DS    0H                                                       00378000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00379000
         LA    15,255                  SET RETURN CODE                  00380000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00381000
         BR    14                      RETURN TO CALLER                 00382000
         LTORG                                                          00383000
*                                                                       00384000
*                                                                       00385000
**********************************************************************  00386000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00387000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00388000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00389000
**********************************************************************  00390000
*                                                                       00391000
SQL#0003 DS    0H                                                       00392000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00393000
         LA    15,255                  SET RETURN CODE                  00394000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00395000
         BR    14                      RETURN TO CALLER                 00396000
         LTORG                                                          00397000
*                                                                       00398000
*                                                                       00399000
**********************************************************************  00400000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00401000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00402000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00403000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00404000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00405000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00406000
*     UPDATE STATEMENT TO MATCH.                                        00407000
**********************************************************************  00408000
*                                                                       00409000
SQL#0004 DS    0H                                                       00410000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00411000
         B     *+6                     BRANCH AROUND ADCON              00412000
BASE0004 DC    AL2(4096)                                                00413000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00414000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00415000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00416000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00417000
         AH    3,BASE0004              ADD 4K                           00418000
         EXEC  SQL                                                     *00419000
               DECLARE S05UPD0 CURSOR FOR                              *00420000
               SELECT AUDIT_DATE,                                      *00421000
                   AUDIT_TIME,                                         *00422000
                   AUDIT_USER,                                         *00423000
                   AUDIT_ORG,                                          *00424000
                   KEY_WORD_01,                                        *00425000
                   REL_CODE_01,                                        *00426000
                   VALUE_01,                                           *00427000
                   AND_OR_01,                                          *00428000
                   KEY_WORD_02,                                        *00429000
                   REL_CODE_02,                                        *00430000
                   VALUE_02,                                           *00431000
                   AND_OR_02,                                          *00432000
                   KEY_WORD_03,                                        *00433000
                   REL_CODE_03,                                        *00434000
                   VALUE_03,                                           *00435000
                   AND_OR_03,                                          *00436000
                   KEY_WORD_04,                                        *00437000
                   REL_CODE_04,                                        *00438000
                   VALUE_04,                                           *00439000
                   AND_OR_04,                                          *00440000
                   KEY_WORD_05,                                        *00441000
                   REL_CODE_05,                                        *00442000
                   VALUE_05,                                           *00443000
                   AND_OR_05,                                          *00444000
                   KEY_WORD_06,                                        *00445000
                   REL_CODE_06,                                        *00446000
                   VALUE_06,                                           *00447000
                   AND_OR_06,                                          *00448000
                   KEY_WORD_07,                                        *00449000
                   REL_CODE_07,                                        *00450000
                   VALUE_07,                                           *00451000
                   AND_OR_07,                                          *00452000
                   KEY_WORD_08,                                        *00453000
                   REL_CODE_08,                                        *00454000
                   VALUE_08,                                           *00455000
                   AND_OR_08,                                          *00456000
                   KEY_WORD_09,                                        *00457000
                   REL_CODE_09,                                        *00458000
                   VALUE_09,                                           *00459000
                   AND_OR_09,                                          *00460000
                   KEY_WORD_10,                                        *00461000
                   REL_CODE_10,                                        *00462000
                   VALUE_10,                                           *00463000
                   AND_OR_10,                                          *00464000
                   KEY_WORD_11,                                        *00465000
                   REL_CODE_11,                                        *00466000
                   VALUE_11,                                           *00467000
                   AND_OR_11,                                          *00468000
                   KEY_WORD_12,                                        *00469000
                   REL_CODE_12,                                        *00470000
                   VALUE_12,                                           *00471000
                   AND_OR_12,                                          *00472000
                   KEY_WORD_13,                                        *00473000
                   REL_CODE_13,                                        *00474000
                   VALUE_13,                                           *00475000
                   AND_OR_13,                                          *00476000
                   KEY_WORD_14,                                        *00477000
                   REL_CODE_14,                                        *00478000
                   VALUE_14,                                           *00479000
                   AND_OR_14,                                          *00480000
                   KEY_WORD_15,                                        *00481000
                   REL_CODE_15,                                        *00482000
                   VALUE_15,                                           *00483000
                   AND_OR_15                                           *00484000
                 FROM S05                                              *00485000
                 WHERE INST_NBR = :INST AND                            *00486000
                   RECORD_NBR = :RECNBR AND                            *00487000
                   DEMOGR_CODE = :DEMO                                 *00488000
                 FOR UPDATE OF AUDIT_DATE,                             *00489000
                   AUDIT_TIME,                                         *00490000
                   AUDIT_USER,                                         *00491000
                   AUDIT_ORG,                                          *00492000
                   KEY_WORD_01,                                        *00493000
                   REL_CODE_01,                                        *00494000
                   VALUE_01,                                           *00495000
                   AND_OR_01,                                          *00496000
                   KEY_WORD_02,                                        *00497000
                   REL_CODE_02,                                        *00498000
                   VALUE_02,                                           *00499000
                   AND_OR_02,                                          *00500000
                   KEY_WORD_03,                                        *00501000
                   REL_CODE_03,                                        *00502000
                   VALUE_03,                                           *00503000
                   AND_OR_03,                                          *00504000
                   KEY_WORD_04,                                        *00505000
                   REL_CODE_04,                                        *00506000
                   VALUE_04,                                           *00507000
                   AND_OR_04,                                          *00508000
                   KEY_WORD_05,                                        *00509000
                   REL_CODE_05,                                        *00510000
                   VALUE_05,                                           *00511000
                   AND_OR_05,                                          *00512000
                   KEY_WORD_06,                                        *00513000
                   REL_CODE_06,                                        *00514000
                   VALUE_06,                                           *00515000
                   AND_OR_06,                                          *00516000
                   KEY_WORD_07,                                        *00517000
                   REL_CODE_07,                                        *00518000
                   VALUE_07,                                           *00519000
                   AND_OR_07,                                          *00520000
                   KEY_WORD_08,                                        *00521000
                   REL_CODE_08,                                        *00522000
                   VALUE_08,                                           *00523000
                   AND_OR_08,                                          *00524000
                   KEY_WORD_09,                                        *00525000
                   REL_CODE_09,                                        *00526000
                   VALUE_09,                                           *00527000
                   AND_OR_09,                                          *00528000
                   KEY_WORD_10,                                        *00529000
                   REL_CODE_10,                                        *00530000
                   VALUE_10,                                           *00531000
                   AND_OR_10,                                          *00532000
                   KEY_WORD_11,                                        *00533000
                   REL_CODE_11,                                        *00534000
                   VALUE_11,                                           *00535000
                   AND_OR_11,                                          *00536000
                   KEY_WORD_12,                                        *00537000
                   REL_CODE_12,                                        *00538000
                   VALUE_12,                                           *00539000
                   AND_OR_12,                                          *00540000
                   KEY_WORD_13,                                        *00541000
                   REL_CODE_13,                                        *00542000
                   VALUE_13,                                           *00543000
                   AND_OR_13,                                          *00544000
                   KEY_WORD_14,                                        *00545000
                   REL_CODE_14,                                        *00546000
                   VALUE_14,                                           *00547000
                   AND_OR_14,                                          *00548000
                   KEY_WORD_15,                                        *00549000
                   REL_CODE_15,                                        *00550000
                   VALUE_15,                                           *00551000
                   AND_OR_15                                           *00552000
                 FETCH FIRST 1 ROW ONLY                                 00553000
         EXEC  SQL                                                     *00554000
               OPEN S05UPD0                                             00555000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00556000
         BR    14                      RETURN TO CALLER                 00557000
         LTORG                                                          00558000
*                                                                       00559000
*                                                                       00560000
**********************************************************************  00561000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00562000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00563000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00564000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00565000
*     UPDATE STATEMENT TO MATCH.                                        00566000
**********************************************************************  00567000
*                                                                       00568000
SQL#0005 DS    0H                                                       00569000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00570000
         LA    15,255                  SET RETURN CODE                  00571000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00572000
         BR    14                      RETURN TO CALLER                 00573000
         LTORG                                                          00574000
*                                                                       00575000
*                                                                       00576000
**********************************************************************  00577000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00578000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00579000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00580000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00581000
*     UPDATE STATEMENT TO MATCH.                                        00582000
**********************************************************************  00583000
*                                                                       00584000
SQL#0006 DS    0H                                                       00585000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00586000
         LA    15,255                  SET RETURN CODE                  00587000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00588000
         BR    14                      RETURN TO CALLER                 00589000
         LTORG                                                          00590000
*                                                                       00591000
*                                                                       00592000
**********************************************************************  00593000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00594000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00595000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00596000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00597000
*     UPDATE STATEMENT TO MATCH.                                        00598000
**********************************************************************  00599000
*                                                                       00600000
SQL#0007 DS    0H                                                       00601000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00602000
         LA    15,255                  SET RETURN CODE                  00603000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00604000
         BR    14                      RETURN TO CALLER                 00605000
         LTORG                                                          00606000
*                                                                       00607000
*                                                                       00608000
**********************************************************************  00609000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00610000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00611000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00612000
*     THE ACTUAL ROW.                                                   00613000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00614000
**********************************************************************  00615000
*                                                                       00616000
SQL#0008 DS    0H                                                       00617000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00618000
         B     *+6                     BRANCH AROUND ADCON              00619000
BASE0008 DC    AL2(4096)                                                00620000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00621000
         AH    3,BASE0008              ADD 4K                           00622000
         EXEC  SQL                                                     *00623000
               FETCH S05UPD0                                           *00624000
                 INTO :AUDDATE,                                        *00625000
                   :AUDTIME,                                           *00626000
                   :AUDUSER,                                           *00627000
                   :AUDORG,                                            *00628000
                   :KEYWRD1,                                           *00629000
                   :RELCD1,                                            *00630000
                   :VALUE1,                                            *00631000
                   :ANDOR1,                                            *00632000
                   :KEYWRD2,                                           *00633000
                   :RELCD2,                                            *00634000
                   :VALUE2,                                            *00635000
                   :ANDOR2,                                            *00636000
                   :KEYWRD3,                                           *00637000
                   :RELCD3,                                            *00638000
                   :VALUE3,                                            *00639000
                   :ANDOR3,                                            *00640000
                   :KEYWRD4,                                           *00641000
                   :RELCD4,                                            *00642000
                   :VALUE4,                                            *00643000
                   :ANDOR4,                                            *00644000
                   :KEYWRD5,                                           *00645000
                   :RELCD5,                                            *00646000
                   :VALUE5,                                            *00647000
                   :ANDOR5,                                            *00648000
                   :KEYWRD6,                                           *00649000
                   :RELCD6,                                            *00650000
                   :VALUE6,                                            *00651000
                   :ANDOR6,                                            *00652000
                   :KEYWRD7,                                           *00653000
                   :RELCD7,                                            *00654000
                   :VALUE7,                                            *00655000
                   :ANDOR7,                                            *00656000
                   :KEYWRD8,                                           *00657000
                   :RELCD8,                                            *00658000
                   :VALUE8,                                            *00659000
                   :ANDOR8,                                            *00660000
                   :KEYWRD9,                                           *00661000
                   :RELCD9,                                            *00662000
                   :VALUE9,                                            *00663000
                   :ANDOR9,                                            *00664000
                   :KEYWRD10,                                          *00665000
                   :RELCD10,                                           *00666000
                   :VALUE10,                                           *00667000
                   :ANDOR10,                                           *00668000
                   :KEYWRD11,                                          *00669000
                   :RELCD11,                                           *00670000
                   :VALUE11,                                           *00671000
                   :ANDOR11,                                           *00672000
                   :KEYWRD12,                                          *00673000
                   :RELCD12,                                           *00674000
                   :VALUE12,                                           *00675000
                   :ANDOR12,                                           *00676000
                   :KEYWRD13,                                          *00677000
                   :RELCD13,                                           *00678000
                   :VALUE13,                                           *00679000
                   :ANDOR13,                                           *00680000
                   :KEYWRD14,                                          *00681000
                   :RELCD14,                                           *00682000
                   :VALUE14,                                           *00683000
                   :ANDOR14,                                           *00684000
                   :KEYWRD15,                                          *00685000
                   :RELCD15,                                           *00686000
                   :VALUE15,                                           *00687000
                   :ANDOR15                                             00688000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00689000
         BALR  4,5                     MOVE INTO RECORD AREA            00690000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00691000
         BR    14                      RETURN TO CALLER                 00692000
         LTORG                                                          00693000
*                                                                       00694000
*                                                                       00695000
**********************************************************************  00696000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00697000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00698000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00699000
*     THE ACTUAL ROW.                                                   00700000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00701000
**********************************************************************  00702000
*                                                                       00703000
SQL#0009 DS    0H                                                       00704000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00705000
         LA    15,255                  SET RETURN CODE                  00706000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00707000
         BR    14                      RETURN TO CALLER                 00708000
         LTORG                                                          00709000
*                                                                       00710000
*                                                                       00711000
**********************************************************************  00712000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00713000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00714000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00715000
*     THE ACTUAL ROW.                                                   00716000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00717000
**********************************************************************  00718000
*                                                                       00719000
SQL#0010 DS    0H                                                       00720000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00721000
         LA    15,255                  SET RETURN CODE                  00722000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00723000
         BR    14                      RETURN TO CALLER                 00724000
         LTORG                                                          00725000
*                                                                       00726000
*                                                                       00727000
**********************************************************************  00728000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00729000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00730000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00731000
*     THE ACTUAL ROW.                                                   00732000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00733000
**********************************************************************  00734000
*                                                                       00735000
SQL#0011 DS    0H                                                       00736000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00737000
         LA    15,255                  SET RETURN CODE                  00738000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00739000
         BR    14                      RETURN TO CALLER                 00740000
         LTORG                                                          00741000
*                                                                       00742000
*                                                                       00743000
**********************************************************************  00744000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00745000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00746000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00747000
*     TO CLOSE THE UPDATE CURSOR.                                       00748000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00749000
**********************************************************************  00750000
*                                                                       00751000
SQL#0012 DS    0H                                                       00752000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00753000
         B     *+6                     BRANCH AROUND ADCON              00754000
BASE0012 DC    AL2(4096)                                                00755000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00756000
         AH    3,BASE0012              ADD 4K                           00757000
         EXEC  SQL                                                     *00758000
               CLOSE S05UPD0                                            00759000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00760000
         BR    14                      RETURN TO CALLER                 00761000
         LTORG                                                          00762000
*                                                                       00763000
*                                                                       00764000
**********************************************************************  00765000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00766000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00767000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00768000
*     TO CLOSE THE UPDATE CURSOR.                                       00769000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00770000
**********************************************************************  00771000
*                                                                       00772000
SQL#0013 DS    0H                                                       00773000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00774000
         LA    15,255                  SET RETURN CODE                  00775000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00776000
         BR    14                      RETURN TO CALLER                 00777000
         LTORG                                                          00778000
*                                                                       00779000
*                                                                       00780000
**********************************************************************  00781000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00782000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00783000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00784000
*     TO CLOSE THE UPDATE CURSOR.                                       00785000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00786000
**********************************************************************  00787000
*                                                                       00788000
SQL#0014 DS    0H                                                       00789000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00790000
         LA    15,255                  SET RETURN CODE                  00791000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00792000
         BR    14                      RETURN TO CALLER                 00793000
         LTORG                                                          00794000
*                                                                       00795000
*                                                                       00796000
**********************************************************************  00797000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00798000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00799000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00800000
*     TO CLOSE THE UPDATE CURSOR.                                       00801000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00802000
**********************************************************************  00803000
*                                                                       00804000
SQL#0015 DS    0H                                                       00805000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00806000
         LA    15,255                  SET RETURN CODE                  00807000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00808000
         BR    14                      RETURN TO CALLER                 00809000
         LTORG                                                          00810000
*                                                                       00811000
*                                                                       00812000
**********************************************************************  00813000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00814000
* KEY:                                                                  00815000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00816000
*     AND GET-NEXT-LOCK VERBS.                                          00817000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00818000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00819000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00820000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00821000
*     ORDER BY CLAUSE.                                                  00822000
**********************************************************************  00823000
*                                                                       00824000
SQL#0016 DS    0H                                                       00825000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00826000
         B     *+6                     BRANCH AROUND ADCON              00827000
BASE0016 DC    AL2(4096)                                                00828000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00829000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00830000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00831000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00832000
         AH    3,BASE0016              ADD 4K                           00833000
         EXEC  SQL                                                     *00834000
               DECLARE S05SQ001 CURSOR FOR                             *00835000
               SELECT INST_NBR,                                        *00836000
                   RECORD_NBR,                                         *00837000
                   DEMOGR_CODE,                                        *00838000
                   AUDIT_DATE,                                         *00839000
                   AUDIT_TIME,                                         *00840000
                   AUDIT_USER,                                         *00841000
                   AUDIT_ORG,                                          *00842000
                   KEY_WORD_01,                                        *00843000
                   REL_CODE_01,                                        *00844000
                   VALUE_01,                                           *00845000
                   AND_OR_01,                                          *00846000
                   KEY_WORD_02,                                        *00847000
                   REL_CODE_02,                                        *00848000
                   VALUE_02,                                           *00849000
                   AND_OR_02,                                          *00850000
                   KEY_WORD_03,                                        *00851000
                   REL_CODE_03,                                        *00852000
                   VALUE_03,                                           *00853000
                   AND_OR_03,                                          *00854000
                   KEY_WORD_04,                                        *00855000
                   REL_CODE_04,                                        *00856000
                   VALUE_04,                                           *00857000
                   AND_OR_04,                                          *00858000
                   KEY_WORD_05,                                        *00859000
                   REL_CODE_05,                                        *00860000
                   VALUE_05,                                           *00861000
                   AND_OR_05,                                          *00862000
                   KEY_WORD_06,                                        *00863000
                   REL_CODE_06,                                        *00864000
                   VALUE_06,                                           *00865000
                   AND_OR_06,                                          *00866000
                   KEY_WORD_07,                                        *00867000
                   REL_CODE_07,                                        *00868000
                   VALUE_07,                                           *00869000
                   AND_OR_07,                                          *00870000
                   KEY_WORD_08,                                        *00871000
                   REL_CODE_08,                                        *00872000
                   VALUE_08,                                           *00873000
                   AND_OR_08,                                          *00874000
                   KEY_WORD_09,                                        *00875000
                   REL_CODE_09,                                        *00876000
                   VALUE_09,                                           *00877000
                   AND_OR_09,                                          *00878000
                   KEY_WORD_10,                                        *00879000
                   REL_CODE_10,                                        *00880000
                   VALUE_10,                                           *00881000
                   AND_OR_10,                                          *00882000
                   KEY_WORD_11,                                        *00883000
                   REL_CODE_11,                                        *00884000
                   VALUE_11,                                           *00885000
                   AND_OR_11,                                          *00886000
                   KEY_WORD_12,                                        *00887000
                   REL_CODE_12,                                        *00888000
                   VALUE_12,                                           *00889000
                   AND_OR_12,                                          *00890000
                   KEY_WORD_13,                                        *00891000
                   REL_CODE_13,                                        *00892000
                   VALUE_13,                                           *00893000
                   AND_OR_13,                                          *00894000
                   KEY_WORD_14,                                        *00895000
                   REL_CODE_14,                                        *00896000
                   VALUE_14,                                           *00897000
                   AND_OR_14,                                          *00898000
                   KEY_WORD_15,                                        *00899000
                   REL_CODE_15,                                        *00900000
                   VALUE_15,                                           *00901000
                   AND_OR_15                                           *00902000
                 FROM S05                                              *00903000
                 WHERE                                                 *00904000
                    INST_NBR = :INST AND                               *00905000
                    RECORD_NBR = :RECNBR AND                           *00906000
                    DEMOGR_CODE >= :DEMO                               *00907000
                 ORDER BY DEMOGR_CODE                                  *00908000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00909000
         EXEC  SQL                                                     *00910000
               OPEN S05SQ001                                            00911000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00912000
         BR    14                      RETURN TO CALLER                 00913000
         LTORG                                                          00914000
*                                                                       00915000
*                                                                       00916000
**********************************************************************  00917000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00918000
* KEY 1:                                                                00919000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00920000
*     AND GET-NEXT-LOCK VERBS.                                          00921000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00922000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00923000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00924000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00925000
*     ORDER BY CLAUSE.                                                  00926000
**********************************************************************  00927000
*                                                                       00928000
SQL#0017 DS    0H                                                       00929000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00930000
         LA    15,255                  SET RETURN CODE                  00931000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00932000
         BR    14                      RETURN TO CALLER                 00933000
         LTORG                                                          00934000
*                                                                       00935000
*                                                                       00936000
**********************************************************************  00937000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00938000
* KEY 2:                                                                00939000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00940000
*     AND GET-NEXT-LOCK VERBS.                                          00941000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00942000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00943000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00944000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00945000
*     ORDER BY CLAUSE.                                                  00946000
**********************************************************************  00947000
*                                                                       00948000
SQL#0018 DS    0H                                                       00949000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00950000
         LA    15,255                  SET RETURN CODE                  00951000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00952000
         BR    14                      RETURN TO CALLER                 00953000
         LTORG                                                          00954000
*                                                                       00955000
*                                                                       00956000
**********************************************************************  00957000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00958000
* KEY 3:                                                                00959000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00960000
*     AND GET-NEXT-LOCK VERBS.                                          00961000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00962000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00963000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00964000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00965000
*     ORDER BY CLAUSE.                                                  00966000
**********************************************************************  00967000
*                                                                       00968000
SQL#0019 DS    0H                                                       00969000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00970000
         LA    15,255                  SET RETURN CODE                  00971000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00972000
         BR    14                      RETURN TO CALLER                 00973000
         LTORG                                                          00974000
*                                                                       00975000
*                                                                       00976000
**********************************************************************  00977000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00978000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00979000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00980000
*     RETRIEVE THE ACTUAL ROW.                                          00981000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00982000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00983000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00984000
**********************************************************************  00985000
*                                                                       00986000
SQL#0020 DS    0H                                                       00987000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00988000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00989000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00990000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00991000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00992000
VECT0020 DC    A(SQL#0120)                                              00993000
         DC    A(SQL#0220)                                              00994000
         DC    A(SQL#0320)                                              00995000
         LTORG                                                          00996000
*                                                                       00997000
SQL#0120 DS    0H                                                       00998000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00999000
         B     *+6                     BRANCH AROUND ADCON              01000000
BASE0120 DC    AL2(4096)                                                01001000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01002000
         AH    3,BASE0120              ADD 4K                           01003000
         EXEC  SQL                                                     *01004000
               FETCH S05SQ001                                          *01005000
                 INTO :INST,                                           *01006000
                      :RECNBR,                                         *01007000
                      :DEMO,                                           *01008000
                      :AUDDATE,                                        *01009000
                      :AUDTIME,                                        *01010000
                      :AUDUSER,                                        *01011000
                      :AUDORG,                                         *01012000
                      :KEYWRD1,                                        *01013000
                      :RELCD1,                                         *01014000
                      :VALUE1,                                         *01015000
                      :ANDOR1,                                         *01016000
                      :KEYWRD2,                                        *01017000
                      :RELCD2,                                         *01018000
                      :VALUE2,                                         *01019000
                      :ANDOR2,                                         *01020000
                      :KEYWRD3,                                        *01021000
                      :RELCD3,                                         *01022000
                      :VALUE3,                                         *01023000
                      :ANDOR3,                                         *01024000
                      :KEYWRD4,                                        *01025000
                      :RELCD4,                                         *01026000
                      :VALUE4,                                         *01027000
                      :ANDOR4,                                         *01028000
                      :KEYWRD5,                                        *01029000
                      :RELCD5,                                         *01030000
                      :VALUE5,                                         *01031000
                      :ANDOR5,                                         *01032000
                      :KEYWRD6,                                        *01033000
                      :RELCD6,                                         *01034000
                      :VALUE6,                                         *01035000
                      :ANDOR6,                                         *01036000
                      :KEYWRD7,                                        *01037000
                      :RELCD7,                                         *01038000
                      :VALUE7,                                         *01039000
                      :ANDOR7,                                         *01040000
                      :KEYWRD8,                                        *01041000
                      :RELCD8,                                         *01042000
                      :VALUE8,                                         *01043000
                      :ANDOR8,                                         *01044000
                      :KEYWRD9,                                        *01045000
                      :RELCD9,                                         *01046000
                      :VALUE9,                                         *01047000
                      :ANDOR9,                                         *01048000
                      :KEYWRD10,                                       *01049000
                      :RELCD10,                                        *01050000
                      :VALUE10,                                        *01051000
                      :ANDOR10,                                        *01052000
                      :KEYWRD11,                                       *01053000
                      :RELCD11,                                        *01054000
                      :VALUE11,                                        *01055000
                      :ANDOR11,                                        *01056000
                      :KEYWRD12,                                       *01057000
                      :RELCD12,                                        *01058000
                      :VALUE12,                                        *01059000
                      :ANDOR12,                                        *01060000
                      :KEYWRD13,                                       *01061000
                      :RELCD13,                                        *01062000
                      :VALUE13,                                        *01063000
                      :ANDOR13,                                        *01064000
                      :KEYWRD14,                                       *01065000
                      :RELCD14,                                        *01066000
                      :VALUE14,                                        *01067000
                      :ANDOR14,                                        *01068000
                      :KEYWRD15,                                       *01069000
                      :RELCD15,                                        *01070000
                      :VALUE15,                                        *01071000
                      :ANDOR15                                          01072000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01073000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01074000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01075000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01076000
         BR    12                      OPEN NEXT CURSOR                 01077000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01078000
         BALR  4,5                     MOVE INTO RECORD AREA            01079000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01080000
         BR    14                      RETURN TO CALLER                 01081000
         LTORG                                                          01082000
*                                                                       01083000
SQL#0220 DS    0H                                                       01084000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          01085000
         B     *+6                     BRANCH AROUND ADCON              01086000
BASE0220 DC    AL2(4096)                                                01087000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01088000
         AH    3,BASE0220              ADD 4K                           01089000
         EXEC  SQL                                                     *01090000
               FETCH S05SQ002                                          *01091000
                 INTO :INST,                                           *01092000
                      :RECNBR,                                         *01093000
                      :DEMO,                                           *01094000
                      :AUDDATE,                                        *01095000
                      :AUDTIME,                                        *01096000
                      :AUDUSER,                                        *01097000
                      :AUDORG,                                         *01098000
                      :KEYWRD1,                                        *01099000
                      :RELCD1,                                         *01100000
                      :VALUE1,                                         *01101000
                      :ANDOR1,                                         *01102000
                      :KEYWRD2,                                        *01103000
                      :RELCD2,                                         *01104000
                      :VALUE2,                                         *01105000
                      :ANDOR2,                                         *01106000
                      :KEYWRD3,                                        *01107000
                      :RELCD3,                                         *01108000
                      :VALUE3,                                         *01109000
                      :ANDOR3,                                         *01110000
                      :KEYWRD4,                                        *01111000
                      :RELCD4,                                         *01112000
                      :VALUE4,                                         *01113000
                      :ANDOR4,                                         *01114000
                      :KEYWRD5,                                        *01115000
                      :RELCD5,                                         *01116000
                      :VALUE5,                                         *01117000
                      :ANDOR5,                                         *01118000
                      :KEYWRD6,                                        *01119000
                      :RELCD6,                                         *01120000
                      :VALUE6,                                         *01121000
                      :ANDOR6,                                         *01122000
                      :KEYWRD7,                                        *01123000
                      :RELCD7,                                         *01124000
                      :VALUE7,                                         *01125000
                      :ANDOR7,                                         *01126000
                      :KEYWRD8,                                        *01127000
                      :RELCD8,                                         *01128000
                      :VALUE8,                                         *01129000
                      :ANDOR8,                                         *01130000
                      :KEYWRD9,                                        *01131000
                      :RELCD9,                                         *01132000
                      :VALUE9,                                         *01133000
                      :ANDOR9,                                         *01134000
                      :KEYWRD10,                                       *01135000
                      :RELCD10,                                        *01136000
                      :VALUE10,                                        *01137000
                      :ANDOR10,                                        *01138000
                      :KEYWRD11,                                       *01139000
                      :RELCD11,                                        *01140000
                      :VALUE11,                                        *01141000
                      :ANDOR11,                                        *01142000
                      :KEYWRD12,                                       *01143000
                      :RELCD12,                                        *01144000
                      :VALUE12,                                        *01145000
                      :ANDOR12,                                        *01146000
                      :KEYWRD13,                                       *01147000
                      :RELCD13,                                        *01148000
                      :VALUE13,                                        *01149000
                      :ANDOR13,                                        *01150000
                      :KEYWRD14,                                       *01151000
                      :RELCD14,                                        *01152000
                      :VALUE14,                                        *01153000
                      :ANDOR14,                                        *01154000
                      :KEYWRD15,                                       *01155000
                      :RELCD15,                                        *01156000
                      :VALUE15,                                        *01157000
                      :ANDOR15                                          01158000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01159000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01160000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01161000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01162000
         BR    12                      OPEN NEXT CURSOR                 01163000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01164000
         BALR  4,5                     MOVE INTO RECORD AREA            01165000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01166000
         BR    14                      RETURN TO CALLER                 01167000
         LTORG                                                          01168000
*                                                                       01169000
SQL#0320 DS    0H                                                       01170000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          01171000
         B     *+6                     BRANCH AROUND ADCON              01172000
BASE0320 DC    AL2(4096)                                                01173000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01174000
         AH    3,BASE0320              ADD 4K                           01175000
         EXEC  SQL                                                     *01176000
               FETCH S05SQ003                                          *01177000
                 INTO :INST,                                           *01178000
                      :RECNBR,                                         *01179000
                      :DEMO,                                           *01180000
                      :AUDDATE,                                        *01181000
                      :AUDTIME,                                        *01182000
                      :AUDUSER,                                        *01183000
                      :AUDORG,                                         *01184000
                      :KEYWRD1,                                        *01185000
                      :RELCD1,                                         *01186000
                      :VALUE1,                                         *01187000
                      :ANDOR1,                                         *01188000
                      :KEYWRD2,                                        *01189000
                      :RELCD2,                                         *01190000
                      :VALUE2,                                         *01191000
                      :ANDOR2,                                         *01192000
                      :KEYWRD3,                                        *01193000
                      :RELCD3,                                         *01194000
                      :VALUE3,                                         *01195000
                      :ANDOR3,                                         *01196000
                      :KEYWRD4,                                        *01197000
                      :RELCD4,                                         *01198000
                      :VALUE4,                                         *01199000
                      :ANDOR4,                                         *01200000
                      :KEYWRD5,                                        *01201000
                      :RELCD5,                                         *01202000
                      :VALUE5,                                         *01203000
                      :ANDOR5,                                         *01204000
                      :KEYWRD6,                                        *01205000
                      :RELCD6,                                         *01206000
                      :VALUE6,                                         *01207000
                      :ANDOR6,                                         *01208000
                      :KEYWRD7,                                        *01209000
                      :RELCD7,                                         *01210000
                      :VALUE7,                                         *01211000
                      :ANDOR7,                                         *01212000
                      :KEYWRD8,                                        *01213000
                      :RELCD8,                                         *01214000
                      :VALUE8,                                         *01215000
                      :ANDOR8,                                         *01216000
                      :KEYWRD9,                                        *01217000
                      :RELCD9,                                         *01218000
                      :VALUE9,                                         *01219000
                      :ANDOR9,                                         *01220000
                      :KEYWRD10,                                       *01221000
                      :RELCD10,                                        *01222000
                      :VALUE10,                                        *01223000
                      :ANDOR10,                                        *01224000
                      :KEYWRD11,                                       *01225000
                      :RELCD11,                                        *01226000
                      :VALUE11,                                        *01227000
                      :ANDOR11,                                        *01228000
                      :KEYWRD12,                                       *01229000
                      :RELCD12,                                        *01230000
                      :VALUE12,                                        *01231000
                      :ANDOR12,                                        *01232000
                      :KEYWRD13,                                       *01233000
                      :RELCD13,                                        *01234000
                      :VALUE13,                                        *01235000
                      :ANDOR13,                                        *01236000
                      :KEYWRD14,                                       *01237000
                      :RELCD14,                                        *01238000
                      :VALUE14,                                        *01239000
                      :ANDOR14,                                        *01240000
                      :KEYWRD15,                                       *01241000
                      :RELCD15,                                        *01242000
                      :VALUE15,                                        *01243000
                      :ANDOR15                                          01244000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01245000
         BALR  4,5                     MOVE INTO RECORD AREA            01246000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01247000
         BR    14                      RETURN TO CALLER                 01248000
         LTORG                                                          01249000
*                                                                       01250000
*                                                                       01251000
**********************************************************************  01252000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01253000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01254000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01255000
*     RETRIEVE THE ACTUAL ROW.                                          01256000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01257000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01258000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01259000
**********************************************************************  01260000
*                                                                       01261000
SQL#0021 DS    0H                                                       01262000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01263000
         LA    15,255                  SET RETURN CODE                  01264000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01265000
         BR    14                      RETURN TO CALLER                 01266000
         LTORG                                                          01267000
*                                                                       01268000
*                                                                       01269000
**********************************************************************  01270000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01271000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01272000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01273000
*     RETRIEVE THE ACTUAL ROW.                                          01274000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01275000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01276000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01277000
**********************************************************************  01278000
*                                                                       01279000
SQL#0022 DS    0H                                                       01280000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01281000
         LA    15,255                  SET RETURN CODE                  01282000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01283000
         BR    14                      RETURN TO CALLER                 01284000
         LTORG                                                          01285000
*                                                                       01286000
*                                                                       01287000
**********************************************************************  01288000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01289000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01290000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01291000
*     RETRIEVE THE ACTUAL ROW.                                          01292000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01293000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01294000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01295000
**********************************************************************  01296000
*                                                                       01297000
SQL#0023 DS    0H                                                       01298000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01299000
         LA    15,255                  SET RETURN CODE                  01300000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01301000
         BR    14                      RETURN TO CALLER                 01302000
         LTORG                                                          01303000
*                                                                       01304000
*                                                                       01305000
**********************************************************************  01306000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01307000
* THE PRIMARY KEY:                                                      01308000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01309000
*     VERBS.                                                            01310000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01311000
*     RETRIEVE THE ACTUAL ROW.                                          01312000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01313000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01314000
*     WILL BE THRU THE UPDATE CURSOR.                                   01315000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01316000
**********************************************************************  01317000
*                                                                       01318000
SQL#0024 DS    0H                                                       01319000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01320000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01321000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01322000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01323000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01324000
VECT0024 DC    A(SQL#0124)                                              01325000
         DC    A(SQL#0224)                                              01326000
         DC    A(SQL#0324)                                              01327000
         LTORG                                                          01328000
*                                                                       01329000
SQL#0124 DS    0H                                                       01330000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01331000
         B     *+6                     BRANCH AROUND ADCON              01332000
BASE0124 DC    AL2(4096)                                                01333000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01334000
         AH    3,BASE0124              ADD 4K                           01335000
         EXEC  SQL                                                     *01336000
               FETCH S05SQ001                                          *01337000
                 INTO :INST,                                           *01338000
                      :RECNBR,                                         *01339000
                      :DEMO                                             01340000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01341000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01342000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01343000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01344000
         BR    12                      OPEN NEXT CURSOR                 01345000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01346000
         BALR  4,5                     MOVE INTO RECORD AREA            01347000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01348000
         BR    14                      RETURN TO CALLER                 01349000
         LTORG                                                          01350000
*                                                                       01351000
SQL#0224 DS    0H                                                       01352000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01353000
         B     *+6                     BRANCH AROUND ADCON              01354000
BASE0224 DC    AL2(4096)                                                01355000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01356000
         AH    3,BASE0224              ADD 4K                           01357000
         EXEC  SQL                                                     *01358000
               FETCH S05SQ002                                          *01359000
                 INTO :INST,                                           *01360000
                      :RECNBR,                                         *01361000
                      :DEMO                                             01362000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01363000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01364000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01365000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01366000
         BR    12                      OPEN NEXT CURSOR                 01367000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01368000
         BALR  4,5                     MOVE INTO RECORD AREA            01369000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01370000
         BR    14                      RETURN TO CALLER                 01371000
         LTORG                                                          01372000
*                                                                       01373000
SQL#0324 DS    0H                                                       01374000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01375000
         B     *+6                     BRANCH AROUND ADCON              01376000
BASE0324 DC    AL2(4096)                                                01377000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01378000
         AH    3,BASE0324              ADD 4K                           01379000
         EXEC  SQL                                                     *01380000
               FETCH S05SQ003                                          *01381000
                 INTO :INST,                                           *01382000
                      :RECNBR,                                         *01383000
                      :DEMO                                             01384000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01385000
         BALR  4,5                     MOVE INTO RECORD AREA            01386000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01387000
         BR    14                      RETURN TO CALLER                 01388000
         LTORG                                                          01389000
*                                                                       01390000
*                                                                       01391000
**********************************************************************  01392000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01393000
* ALTERNATE KEY 1:                                                      01394000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01395000
*     VERBS.                                                            01396000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01397000
*     RETRIEVE THE ACTUAL ROW.                                          01398000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01399000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01400000
*     WILL BE THRU THE UPDATE CURSOR.                                   01401000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01402000
**********************************************************************  01403000
*                                                                       01404000
SQL#0025 DS    0H                                                       01405000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01406000
         LA    15,255                  SET RETURN CODE                  01407000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01408000
         BR    14                      RETURN TO CALLER                 01409000
         LTORG                                                          01410000
*                                                                       01411000
*                                                                       01412000
**********************************************************************  01413000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01414000
* ALTERNATE KEY 2:                                                      01415000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01416000
*     VERBS.                                                            01417000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01418000
*     RETRIEVE THE ACTUAL ROW.                                          01419000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01420000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01421000
*     WILL BE THRU THE UPDATE CURSOR.                                   01422000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01423000
**********************************************************************  01424000
*                                                                       01425000
SQL#0026 DS    0H                                                       01426000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01427000
         LA    15,255                  SET RETURN CODE                  01428000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01429000
         BR    14                      RETURN TO CALLER                 01430000
         LTORG                                                          01431000
*                                                                       01432000
*                                                                       01433000
**********************************************************************  01434000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01435000
* ALTERNATE KEY 3:                                                      01436000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01437000
*     VERBS.                                                            01438000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01439000
*     RETRIEVE THE ACTUAL ROW.                                          01440000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01441000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01442000
*     WILL BE THRU THE UPDATE CURSOR.                                   01443000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01444000
**********************************************************************  01445000
*                                                                       01446000
SQL#0027 DS    0H                                                       01447000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01448000
         LA    15,255                  SET RETURN CODE                  01449000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01450000
         BR    14                      RETURN TO CALLER                 01451000
         LTORG                                                          01452000
*                                                                       01453000
*                                                                       01454000
**********************************************************************  01455000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01456000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01457000
*     AND GET-NEXT-LOCK VERBS.                                          01458000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01459000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01460000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01461000
**********************************************************************  01462000
*                                                                       01463000
SQL#0028 DS    0H                                                       01464000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01465000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01466000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01467000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01468000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01469000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01470000
VECT0028 DC    A(SQL#0128)                                              01471000
         DC    A(SQL#0228)                                              01472000
         DC    A(SQL#0328)                                              01473000
         LTORG                                                          01474000
*                                                                       01475000
SQL#0128 DS    0H                                                       01476000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01477000
         B     *+6                     BRANCH AROUND ADCON              01478000
BASE0128 DC    AL2(4096)                                                01479000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01480000
         AH    3,BASE0128              ADD 4K                           01481000
         EXEC  SQL                                                     *01482000
               CLOSE S05SQ001                                           01483000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01484000
         BR    14                      RETURN TO CALLER                 01485000
         LTORG                                                          01486000
*                                                                       01487000
SQL#0228 DS    0H                                                       01488000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01489000
         B     *+6                     BRANCH AROUND ADCON              01490000
BASE0228 DC    AL2(4096)                                                01491000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01492000
         AH    3,BASE0228              ADD 4K                           01493000
         EXEC  SQL                                                     *01494000
               CLOSE S05SQ002                                           01495000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01496000
         BR    14                      RETURN TO CALLER                 01497000
         LTORG                                                          01498000
*                                                                       01499000
SQL#0328 DS    0H                                                       01500000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01501000
         B     *+6                     BRANCH AROUND ADCON              01502000
BASE0328 DC    AL2(4096)                                                01503000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01504000
         AH    3,BASE0328              ADD 4K                           01505000
         EXEC  SQL                                                     *01506000
               CLOSE S05SQ003                                           01507000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01508000
         BR    14                      RETURN TO CALLER                 01509000
         LTORG                                                          01510000
*                                                                       01511000
*                                                                       01512000
**********************************************************************  01513000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01514000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01515000
*     AND GET-NEXT-LOCK VERBS.                                          01516000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01517000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01518000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01519000
**********************************************************************  01520000
*                                                                       01521000
SQL#0029 DS    0H                                                       01522000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01523000
         LA    15,255                  SET RETURN CODE                  01524000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01525000
         BR    14                      RETURN TO CALLER                 01526000
         LTORG                                                          01527000
*                                                                       01528000
*                                                                       01529000
**********************************************************************  01530000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01531000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01532000
*     AND GET-NEXT-LOCK VERBS.                                          01533000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01534000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01535000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01536000
**********************************************************************  01537000
*                                                                       01538000
SQL#0030 DS    0H                                                       01539000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01540000
         LA    15,255                  SET RETURN CODE                  01541000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01542000
         BR    14                      RETURN TO CALLER                 01543000
         LTORG                                                          01544000
*                                                                       01545000
*                                                                       01546000
**********************************************************************  01547000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01548000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01549000
*     AND GET-NEXT-LOCK VERBS.                                          01550000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01551000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01552000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01553000
**********************************************************************  01554000
*                                                                       01555000
SQL#0031 DS    0H                                                       01556000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01557000
         LA    15,255                  SET RETURN CODE                  01558000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01559000
         BR    14                      RETURN TO CALLER                 01560000
         LTORG                                                          01561000
*                                                                       01562000
*                                                                       01563000
**********************************************************************  01564000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01565000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01566000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01567000
**********************************************************************  01568000
*                                                                       01569000
SQL#0032 DS    0H                                                       01570000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01571000
         B     *+6                     BRANCH AROUND ADCON              01572000
BASE0032 DC    AL2(4096)                                                01573000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01574000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01575000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01576000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01577000
         AH    3,BASE0032              ADD 4K                           01578000
         EXEC  SQL                                                     *01579000
               SELECT INST_NBR,                                        *01580000
                   RECORD_NBR,                                         *01581000
                   DEMOGR_CODE                                         *01582000
                 INTO :INST,                                           *01583000
                   :RECNBR,                                            *01584000
                   :DEMO                                               *01585000
                 FROM S05                                              *01586000
                 WHERE INST_NBR = :INST AND                            *01587000
                   RECORD_NBR = :RECNBR AND                            *01588000
                   DEMOGR_CODE = :DEMO                                 *01589000
                 FETCH FIRST 1 ROW ONLY                                 01590000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01591000
         BR    14                      RETURN TO CALLER                 01592000
         LTORG                                                          01593000
*                                                                       01594000
*                                                                       01595000
**********************************************************************  01596000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01597000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01598000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01599000
**********************************************************************  01600000
*                                                                       01601000
SQL#0033 DS    0H                                                       01602000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01603000
         LA    15,255                  SET RETURN CODE                  01604000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01605000
         BR    14                      RETURN TO CALLER                 01606000
         LTORG                                                          01607000
*                                                                       01608000
*                                                                       01609000
**********************************************************************  01610000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01611000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01612000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01613000
**********************************************************************  01614000
*                                                                       01615000
SQL#0034 DS    0H                                                       01616000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01617000
         LA    15,255                  SET RETURN CODE                  01618000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01619000
         BR    14                      RETURN TO CALLER                 01620000
         LTORG                                                          01621000
*                                                                       01622000
*                                                                       01623000
**********************************************************************  01624000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01625000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01626000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01627000
**********************************************************************  01628000
*                                                                       01629000
SQL#0035 DS    0H                                                       01630000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01631000
         LA    15,255                  SET RETURN CODE                  01632000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01633000
         BR    14                      RETURN TO CALLER                 01634000
         LTORG                                                          01635000
*                                                                       01636000
*                                                                       01637000
**********************************************************************  01638000
* INSERT STATEMENT:                                                     01639000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01640000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01641000
**********************************************************************  01642000
*                                                                       01643000
SQL#0036 DS    0H                                                       01644000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01645000
         B     *+6                     BRANCH AROUND ADCON              01646000
BASE0036 DC    AL2(4096)                                                01647000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01648000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01649000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01650000
         AH    3,BASE0036              ADD 4K                           01651000
         EXEC  SQL                                                     *01652000
               INSERT INTO S05                                         *01653000
                   (INST_NBR,                                          *01654000
                    RECORD_NBR,                                        *01655000
                    DEMOGR_CODE,                                       *01656000
                    AUDIT_DATE,                                        *01657000
                    AUDIT_TIME,                                        *01658000
                    AUDIT_USER,                                        *01659000
                    AUDIT_ORG,                                         *01660000
                    KEY_WORD_01,                                       *01661000
                    REL_CODE_01,                                       *01662000
                    VALUE_01,                                          *01663000
                    AND_OR_01,                                         *01664000
                    KEY_WORD_02,                                       *01665000
                    REL_CODE_02,                                       *01666000
                    VALUE_02,                                          *01667000
                    AND_OR_02,                                         *01668000
                    KEY_WORD_03,                                       *01669000
                    REL_CODE_03,                                       *01670000
                    VALUE_03,                                          *01671000
                    AND_OR_03,                                         *01672000
                    KEY_WORD_04,                                       *01673000
                    REL_CODE_04,                                       *01674000
                    VALUE_04,                                          *01675000
                    AND_OR_04,                                         *01676000
                    KEY_WORD_05,                                       *01677000
                    REL_CODE_05,                                       *01678000
                    VALUE_05,                                          *01679000
                    AND_OR_05,                                         *01680000
                    KEY_WORD_06,                                       *01681000
                    REL_CODE_06,                                       *01682000
                    VALUE_06,                                          *01683000
                    AND_OR_06,                                         *01684000
                    KEY_WORD_07,                                       *01685000
                    REL_CODE_07,                                       *01686000
                    VALUE_07,                                          *01687000
                    AND_OR_07,                                         *01688000
                    KEY_WORD_08,                                       *01689000
                    REL_CODE_08,                                       *01690000
                    VALUE_08,                                          *01691000
                    AND_OR_08,                                         *01692000
                    KEY_WORD_09,                                       *01693000
                    REL_CODE_09,                                       *01694000
                    VALUE_09,                                          *01695000
                    AND_OR_09,                                         *01696000
                    KEY_WORD_10,                                       *01697000
                    REL_CODE_10,                                       *01698000
                    VALUE_10,                                          *01699000
                    AND_OR_10,                                         *01700000
                    KEY_WORD_11,                                       *01701000
                    REL_CODE_11,                                       *01702000
                    VALUE_11,                                          *01703000
                    AND_OR_11,                                         *01704000
                    KEY_WORD_12,                                       *01705000
                    REL_CODE_12,                                       *01706000
                    VALUE_12,                                          *01707000
                    AND_OR_12,                                         *01708000
                    KEY_WORD_13,                                       *01709000
                    REL_CODE_13,                                       *01710000
                    VALUE_13,                                          *01711000
                    AND_OR_13,                                         *01712000
                    KEY_WORD_14,                                       *01713000
                    REL_CODE_14,                                       *01714000
                    VALUE_14,                                          *01715000
                    AND_OR_14,                                         *01716000
                    KEY_WORD_15,                                       *01717000
                    REL_CODE_15,                                       *01718000
                    VALUE_15,                                          *01719000
                    AND_OR_15)                                         *01720000
                  VALUES (:INST,                                       *01721000
                   :RECNBR,                                            *01722000
                   :DEMO,                                              *01723000
                   :AUDDATE,                                           *01724000
                   :AUDTIME,                                           *01725000
                   :AUDUSER,                                           *01726000
                   :AUDORG,                                            *01727000
                   :KEYWRD1,                                           *01728000
                   :RELCD1,                                            *01729000
                   :VALUE1,                                            *01730000
                   :ANDOR1,                                            *01731000
                   :KEYWRD2,                                           *01732000
                   :RELCD2,                                            *01733000
                   :VALUE2,                                            *01734000
                   :ANDOR2,                                            *01735000
                   :KEYWRD3,                                           *01736000
                   :RELCD3,                                            *01737000
                   :VALUE3,                                            *01738000
                   :ANDOR3,                                            *01739000
                   :KEYWRD4,                                           *01740000
                   :RELCD4,                                            *01741000
                   :VALUE4,                                            *01742000
                   :ANDOR4,                                            *01743000
                   :KEYWRD5,                                           *01744000
                   :RELCD5,                                            *01745000
                   :VALUE5,                                            *01746000
                   :ANDOR5,                                            *01747000
                   :KEYWRD6,                                           *01748000
                   :RELCD6,                                            *01749000
                   :VALUE6,                                            *01750000
                   :ANDOR6,                                            *01751000
                   :KEYWRD7,                                           *01752000
                   :RELCD7,                                            *01753000
                   :VALUE7,                                            *01754000
                   :ANDOR7,                                            *01755000
                   :KEYWRD8,                                           *01756000
                   :RELCD8,                                            *01757000
                   :VALUE8,                                            *01758000
                   :ANDOR8,                                            *01759000
                   :KEYWRD9,                                           *01760000
                   :RELCD9,                                            *01761000
                   :VALUE9,                                            *01762000
                   :ANDOR9,                                            *01763000
                   :KEYWRD10,                                          *01764000
                   :RELCD10,                                           *01765000
                   :VALUE10,                                           *01766000
                   :ANDOR10,                                           *01767000
                   :KEYWRD11,                                          *01768000
                   :RELCD11,                                           *01769000
                   :VALUE11,                                           *01770000
                   :ANDOR11,                                           *01771000
                   :KEYWRD12,                                          *01772000
                   :RELCD12,                                           *01773000
                   :VALUE12,                                           *01774000
                   :ANDOR12,                                           *01775000
                   :KEYWRD13,                                          *01776000
                   :RELCD13,                                           *01777000
                   :VALUE13,                                           *01778000
                   :ANDOR13,                                           *01779000
                   :KEYWRD14,                                          *01780000
                   :RELCD14,                                           *01781000
                   :VALUE14,                                           *01782000
                   :ANDOR14,                                           *01783000
                   :KEYWRD15,                                          *01784000
                   :RELCD15,                                           *01785000
                   :VALUE15,                                           *01786000
                   :ANDOR15)                                            01787000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01788000
         BR    14                      RETURN TO CALLER                 01789000
         LTORG                                                          01790000
*                                                                       01791000
*                                                                       01792000
**********************************************************************  01793000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01794000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01795000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01796000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01797000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01798000
*     STATEMENT.                                                        01799000
**********************************************************************  01800000
*                                                                       01801000
SQL#0037 DS    0H                                                       01802000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01803000
         B     *+6                     BRANCH AROUND ADCON              01804000
BASE0037 DC    AL2(4096)                                                01805000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01806000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01807000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01808000
         AH    3,BASE0037              ADD 4K                           01809000
         EXEC  SQL                                                     *01810000
               UPDATE S05                                              *01811000
                   SET AUDIT_DATE = :AUDDATE,                          *01812000
                     AUDIT_TIME = :AUDTIME,                            *01813000
                     AUDIT_USER = :AUDUSER,                            *01814000
                     AUDIT_ORG = :AUDORG,                              *01815000
                     KEY_WORD_01 = :KEYWRD1,                           *01816000
                     REL_CODE_01 = :RELCD1,                            *01817000
                     VALUE_01 = :VALUE1,                               *01818000
                     AND_OR_01 = :ANDOR1,                              *01819000
                     KEY_WORD_02 = :KEYWRD2,                           *01820000
                     REL_CODE_02 = :RELCD2,                            *01821000
                     VALUE_02 = :VALUE2,                               *01822000
                     AND_OR_02 = :ANDOR2,                              *01823000
                     KEY_WORD_03 = :KEYWRD3,                           *01824000
                     REL_CODE_03 = :RELCD3,                            *01825000
                     VALUE_03 = :VALUE3,                               *01826000
                     AND_OR_03 = :ANDOR3,                              *01827000
                     KEY_WORD_04 = :KEYWRD4,                           *01828000
                     REL_CODE_04 = :RELCD4,                            *01829000
                     VALUE_04 = :VALUE4,                               *01830000
                     AND_OR_04 = :ANDOR4,                              *01831000
                     KEY_WORD_05 = :KEYWRD5,                           *01832000
                     REL_CODE_05 = :RELCD5,                            *01833000
                     VALUE_05 = :VALUE5,                               *01834000
                     AND_OR_05 = :ANDOR5,                              *01835000
                     KEY_WORD_06 = :KEYWRD6,                           *01836000
                     REL_CODE_06 = :RELCD6,                            *01837000
                     VALUE_06 = :VALUE6,                               *01838000
                     AND_OR_06 = :ANDOR6,                              *01839000
                     KEY_WORD_07 = :KEYWRD7,                           *01840000
                     REL_CODE_07 = :RELCD7,                            *01841000
                     VALUE_07 = :VALUE7,                               *01842000
                     AND_OR_07 = :ANDOR7,                              *01843000
                     KEY_WORD_08 = :KEYWRD8,                           *01844000
                     REL_CODE_08 = :RELCD8,                            *01845000
                     VALUE_08 = :VALUE8,                               *01846000
                     AND_OR_08 = :ANDOR8,                              *01847000
                     KEY_WORD_09 = :KEYWRD9,                           *01848000
                     REL_CODE_09 = :RELCD9,                            *01849000
                     VALUE_09 = :VALUE9,                               *01850000
                     AND_OR_09 = :ANDOR9,                              *01851000
                     KEY_WORD_10 = :KEYWRD10,                          *01852000
                     REL_CODE_10 = :RELCD10,                           *01853000
                     VALUE_10 = :VALUE10,                              *01854000
                     AND_OR_10 = :ANDOR10,                             *01855000
                     KEY_WORD_11 = :KEYWRD11,                          *01856000
                     REL_CODE_11 = :RELCD11,                           *01857000
                     VALUE_11 = :VALUE11,                              *01858000
                     AND_OR_11 = :ANDOR11,                             *01859000
                     KEY_WORD_12 = :KEYWRD12,                          *01860000
                     REL_CODE_12 = :RELCD12,                           *01861000
                     VALUE_12 = :VALUE12,                              *01862000
                     AND_OR_12 = :ANDOR12,                             *01863000
                     KEY_WORD_13 = :KEYWRD13,                          *01864000
                     REL_CODE_13 = :RELCD13,                           *01865000
                     VALUE_13 = :VALUE13,                              *01866000
                     AND_OR_13 = :ANDOR13,                             *01867000
                     KEY_WORD_14 = :KEYWRD14,                          *01868000
                     REL_CODE_14 = :RELCD14,                           *01869000
                     VALUE_14 = :VALUE14,                              *01870000
                     AND_OR_14 = :ANDOR14,                             *01871000
                     KEY_WORD_15 = :KEYWRD15,                          *01872000
                     REL_CODE_15 = :RELCD15,                           *01873000
                     VALUE_15 = :VALUE15,                              *01874000
                     AND_OR_15 = :ANDOR15                              *01875000
                 WHERE CURRENT OF S05UPD0                               01876000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01877000
         BR    14                      RETURN TO CALLER                 01878000
         LTORG                                                          01879000
*                                                                       01880000
*                                                                       01881000
**********************************************************************  01882000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01883000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01884000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01885000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01886000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01887000
*     STATEMENT.                                                        01888000
**********************************************************************  01889000
*                                                                       01890000
SQL#0038 DS    0H                                                       01891000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01892000
         LA    15,255                  SET RETURN CODE                  01893000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01894000
         BR    14                      RETURN TO CALLER                 01895000
         LTORG                                                          01896000
*                                                                       01897000
*                                                                       01898000
**********************************************************************  01899000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01900000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01901000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01902000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01903000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01904000
*     STATEMENT.                                                        01905000
**********************************************************************  01906000
*                                                                       01907000
SQL#0039 DS    0H                                                       01908000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01909000
         LA    15,255                  SET RETURN CODE                  01910000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01911000
         BR    14                      RETURN TO CALLER                 01912000
         LTORG                                                          01913000
*                                                                       01914000
*                                                                       01915000
**********************************************************************  01916000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01917000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01918000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01919000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01920000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01921000
*     STATEMENT.                                                        01922000
**********************************************************************  01923000
*                                                                       01924000
SQL#0040 DS    0H                                                       01925000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01926000
         LA    15,255                  SET RETURN CODE                  01927000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01928000
         BR    14                      RETURN TO CALLER                 01929000
         LTORG                                                          01930000
*                                                                       01931000
*                                                                       01932000
**********************************************************************  01933000
* DELETE STATEMENT BY PRIMARY KEY:                                      01934000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01935000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01936000
**********************************************************************  01937000
*                                                                       01938000
SQL#0041 DS    0H                                                       01939000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01940000
         B     *+6                     BRANCH AROUND ADCON              01941000
BASE0041 DC    AL2(4096)                                                01942000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01943000
         AH    3,BASE0041              ADD 4K                           01944000
         EXEC  SQL                                                     *01945000
               DELETE FROM S05                                         *01946000
                 WHERE CURRENT OF S05UPD0                               01947000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01948000
         BR    14                      RETURN TO CALLER                 01949000
         LTORG                                                          01950000
*                                                                       01951000
*                                                                       01952000
**********************************************************************  01953000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01954000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01955000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01956000
**********************************************************************  01957000
*                                                                       01958000
SQL#0042 DS    0H                                                       01959000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01960000
         LA    15,255                  SET RETURN CODE                  01961000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01962000
         BR    14                      RETURN TO CALLER                 01963000
         LTORG                                                          01964000
*                                                                       01965000
*                                                                       01966000
**********************************************************************  01967000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01968000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01969000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01970000
**********************************************************************  01971000
*                                                                       01972000
SQL#0043 DS    0H                                                       01973000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01974000
         LA    15,255                  SET RETURN CODE                  01975000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01976000
         BR    14                      RETURN TO CALLER                 01977000
         LTORG                                                          01978000
*                                                                       01979000
*                                                                       01980000
**********************************************************************  01981000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01982000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01983000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01984000
**********************************************************************  01985000
*                                                                       01986000
SQL#0044 DS    0H                                                       01987000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01988000
         LA    15,255                  SET RETURN CODE                  01989000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01990000
         BR    14                      RETURN TO CALLER                 01991000
         LTORG                                                          01992000
*                                                                       01993000
*                                                                       01994000
**********************************************************************  01995000
* DELETE ALL STATEMENT:                                                 01996000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01997000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01998000
**********************************************************************  01999000
*                                                                       02000000
SQL#0045 DS    0H                                                       02001000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          02002000
         B     *+6                     BRANCH AROUND ADCON              02003000
BASE0045 DC    AL2(4096)                                                02004000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02005000
         AH    3,BASE0045              ADD 4K                           02006000
         EXEC  SQL                                                     *02007000
               DELETE FROM S05                                          02008000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02009000
         BR    14                      RETURN TO CALLER                 02010000
         LTORG                                                          02011000
*                                                                       02012000
*                                                                       02013000
**********************************************************************  02014000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          02015000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                02016000
**********************************************************************  02017000
*                                                                       02018000
SQL#0046 DS    0H                                                       02019000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          02020000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              02021000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02022000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02023000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      02024000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         02025000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               02026000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      02027000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      02028000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     02029000
VECT0046 DC    A(0)                                                     02030000
         DC    A(SQL#0246)                                              02031000
         DC    A(SQL#0346)                                              02032000
         LTORG                                                          02033000
*                                                                       02034000
SQL#0246 DS    0H                                                       02035000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          02036000
         B     *+6                     BRANCH AROUND ADCON              02037000
BASE0246 DC    AL2(4096)                                                02038000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02039000
         AH    3,BASE0246              ADD 4K                           02040000
         EXEC  SQL                                                     *02041000
               CLOSE S05SQ001                                           02042000
         EXEC  SQL                                                     *02043000
               DECLARE S05SQ002 CURSOR FOR                             *02044000
               SELECT INST_NBR,                                        *02045000
                   RECORD_NBR,                                         *02046000
                   DEMOGR_CODE,                                        *02047000
                   AUDIT_DATE,                                         *02048000
                   AUDIT_TIME,                                         *02049000
                   AUDIT_USER,                                         *02050000
                   AUDIT_ORG,                                          *02051000
                   KEY_WORD_01,                                        *02052000
                   REL_CODE_01,                                        *02053000
                   VALUE_01,                                           *02054000
                   AND_OR_01,                                          *02055000
                   KEY_WORD_02,                                        *02056000
                   REL_CODE_02,                                        *02057000
                   VALUE_02,                                           *02058000
                   AND_OR_02,                                          *02059000
                   KEY_WORD_03,                                        *02060000
                   REL_CODE_03,                                        *02061000
                   VALUE_03,                                           *02062000
                   AND_OR_03,                                          *02063000
                   KEY_WORD_04,                                        *02064000
                   REL_CODE_04,                                        *02065000
                   VALUE_04,                                           *02066000
                   AND_OR_04,                                          *02067000
                   KEY_WORD_05,                                        *02068000
                   REL_CODE_05,                                        *02069000
                   VALUE_05,                                           *02070000
                   AND_OR_05,                                          *02071000
                   KEY_WORD_06,                                        *02072000
                   REL_CODE_06,                                        *02073000
                   VALUE_06,                                           *02074000
                   AND_OR_06,                                          *02075000
                   KEY_WORD_07,                                        *02076000
                   REL_CODE_07,                                        *02077000
                   VALUE_07,                                           *02078000
                   AND_OR_07,                                          *02079000
                   KEY_WORD_08,                                        *02080000
                   REL_CODE_08,                                        *02081000
                   VALUE_08,                                           *02082000
                   AND_OR_08,                                          *02083000
                   KEY_WORD_09,                                        *02084000
                   REL_CODE_09,                                        *02085000
                   VALUE_09,                                           *02086000
                   AND_OR_09,                                          *02087000
                   KEY_WORD_10,                                        *02088000
                   REL_CODE_10,                                        *02089000
                   VALUE_10,                                           *02090000
                   AND_OR_10,                                          *02091000
                   KEY_WORD_11,                                        *02092000
                   REL_CODE_11,                                        *02093000
                   VALUE_11,                                           *02094000
                   AND_OR_11,                                          *02095000
                   KEY_WORD_12,                                        *02096000
                   REL_CODE_12,                                        *02097000
                   VALUE_12,                                           *02098000
                   AND_OR_12,                                          *02099000
                   KEY_WORD_13,                                        *02100000
                   REL_CODE_13,                                        *02101000
                   VALUE_13,                                           *02102000
                   AND_OR_13,                                          *02103000
                   KEY_WORD_14,                                        *02104000
                   REL_CODE_14,                                        *02105000
                   VALUE_14,                                           *02106000
                   AND_OR_14,                                          *02107000
                   KEY_WORD_15,                                        *02108000
                   REL_CODE_15,                                        *02109000
                   VALUE_15,                                           *02110000
                   AND_OR_15                                           *02111000
                 FROM S05                                              *02112000
                 WHERE                                                 *02113000
                    INST_NBR = :INST AND                               *02114000
                    RECORD_NBR > :RECNBR                               *02115000
                 ORDER BY RECORD_NBR,                                  *02116000
                   DEMOGR_CODE                                         *02117000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02118000
         EXEC  SQL                                                     *02119000
               OPEN S05SQ002                                            02120000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02121000
         BNZ   *+8                     NO - RETURN ERROR                02122000
         LR    12,9                    LOAD RETURN ADDRESS              02123000
         BR    12                      RETURN TO FETCH ROUTINE          02124000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02125000
         BR    14                      RETURN TO CALLER                 02126000
         LTORG                                                          02127000
*                                                                       02128000
SQL#0346 DS    0H                                                       02129000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          02130000
         B     *+6                     BRANCH AROUND ADCON              02131000
BASE0346 DC    AL2(4096)                                                02132000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02133000
         AH    3,BASE0346              ADD 4K                           02134000
         EXEC  SQL                                                     *02135000
               CLOSE S05SQ002                                           02136000
         EXEC  SQL                                                     *02137000
               DECLARE S05SQ003 CURSOR FOR                             *02138000
               SELECT INST_NBR,                                        *02139000
                   RECORD_NBR,                                         *02140000
                   DEMOGR_CODE,                                        *02141000
                   AUDIT_DATE,                                         *02142000
                   AUDIT_TIME,                                         *02143000
                   AUDIT_USER,                                         *02144000
                   AUDIT_ORG,                                          *02145000
                   KEY_WORD_01,                                        *02146000
                   REL_CODE_01,                                        *02147000
                   VALUE_01,                                           *02148000
                   AND_OR_01,                                          *02149000
                   KEY_WORD_02,                                        *02150000
                   REL_CODE_02,                                        *02151000
                   VALUE_02,                                           *02152000
                   AND_OR_02,                                          *02153000
                   KEY_WORD_03,                                        *02154000
                   REL_CODE_03,                                        *02155000
                   VALUE_03,                                           *02156000
                   AND_OR_03,                                          *02157000
                   KEY_WORD_04,                                        *02158000
                   REL_CODE_04,                                        *02159000
                   VALUE_04,                                           *02160000
                   AND_OR_04,                                          *02161000
                   KEY_WORD_05,                                        *02162000
                   REL_CODE_05,                                        *02163000
                   VALUE_05,                                           *02164000
                   AND_OR_05,                                          *02165000
                   KEY_WORD_06,                                        *02166000
                   REL_CODE_06,                                        *02167000
                   VALUE_06,                                           *02168000
                   AND_OR_06,                                          *02169000
                   KEY_WORD_07,                                        *02170000
                   REL_CODE_07,                                        *02171000
                   VALUE_07,                                           *02172000
                   AND_OR_07,                                          *02173000
                   KEY_WORD_08,                                        *02174000
                   REL_CODE_08,                                        *02175000
                   VALUE_08,                                           *02176000
                   AND_OR_08,                                          *02177000
                   KEY_WORD_09,                                        *02178000
                   REL_CODE_09,                                        *02179000
                   VALUE_09,                                           *02180000
                   AND_OR_09,                                          *02181000
                   KEY_WORD_10,                                        *02182000
                   REL_CODE_10,                                        *02183000
                   VALUE_10,                                           *02184000
                   AND_OR_10,                                          *02185000
                   KEY_WORD_11,                                        *02186000
                   REL_CODE_11,                                        *02187000
                   VALUE_11,                                           *02188000
                   AND_OR_11,                                          *02189000
                   KEY_WORD_12,                                        *02190000
                   REL_CODE_12,                                        *02191000
                   VALUE_12,                                           *02192000
                   AND_OR_12,                                          *02193000
                   KEY_WORD_13,                                        *02194000
                   REL_CODE_13,                                        *02195000
                   VALUE_13,                                           *02196000
                   AND_OR_13,                                          *02197000
                   KEY_WORD_14,                                        *02198000
                   REL_CODE_14,                                        *02199000
                   VALUE_14,                                           *02200000
                   AND_OR_14,                                          *02201000
                   KEY_WORD_15,                                        *02202000
                   REL_CODE_15,                                        *02203000
                   VALUE_15,                                           *02204000
                   AND_OR_15                                           *02205000
                 FROM S05                                              *02206000
                 WHERE                                                 *02207000
                    INST_NBR > :INST                                   *02208000
                 ORDER BY INST_NBR,                                    *02209000
                   RECORD_NBR,                                         *02210000
                   DEMOGR_CODE                                         *02211000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02212000
         EXEC  SQL                                                     *02213000
               OPEN S05SQ003                                            02214000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02215000
         BNZ   *+8                     NO - RETURN ERROR                02216000
         LR    12,9                    LOAD RETURN ADDRESS              02217000
         BR    12                      RETURN TO FETCH ROUTINE          02218000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02219000
         BR    14                      RETURN TO CALLER                 02220000
         LTORG                                                          02221000
*                                                                       02222000
*                                                                       02223000
**********************************************************************  02224000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02225000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02226000
**********************************************************************  02227000
*                                                                       02228000
SQL#0047 DS    0H                                                       02229000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02230000
         LA    15,255                  SET RETURN CODE                  02231000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02232000
         BR    14                      RETURN TO CALLER                 02233000
         LTORG                                                          02234000
*                                                                       02235000
*                                                                       02236000
**********************************************************************  02237000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02238000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02239000
**********************************************************************  02240000
*                                                                       02241000
SQL#0048 DS    0H                                                       02242000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02243000
         LA    15,255                  SET RETURN CODE                  02244000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02245000
         BR    14                      RETURN TO CALLER                 02246000
         LTORG                                                          02247000
*                                                                       02248000
*                                                                       02249000
**********************************************************************  02250000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02251000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02252000
**********************************************************************  02253000
*                                                                       02254000
SQL#0049 DS    0H                                                       02255000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02256000
         LA    15,255                  SET RETURN CODE                  02257000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02258000
         BR    14                      RETURN TO CALLER                 02259000
         LTORG                                                          02260000
*                                                                       02261000
         DS    0H                      END OF SQL STATEMENTS            02262000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02263000
*                                                                       02264000
*                                                                       02265000
**********************************************************************  02266000
* DUMMY ENTRY POINT DSNHLI                                              02267000
*   MUST NOT BE MODIFIED.                                               02268000
**********************************************************************  02269000
*                                                                       02270000
         ENTRY DSNHLI                                                   02271000
DSNHLI   DS    0H                                                       02272000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02273000
         BR    15                      BRANCH TO ATTACH FACILITY        02274000
*                                                                       02275000
*                                                                       02276000
**********************************************************************  02277000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02278000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02279000
*   MUST NOT BE MODIFIED.                                               02280000
**********************************************************************  02281000
*                                                                       02282000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02283000
CONV#RTN AMODE ANY                                                      02284000
CONV#RTN RMODE ANY                                                      02285000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02286000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02287000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02288000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02289000
         BER   4                         YES - RETURN TO SQL            02290000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02291000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02292000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02293000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02294000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02295000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02296000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02297000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02298000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02299000
*                                                                       02300000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02301000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02302000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02303000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02304000
         BER   4                         YES - RETURN TO SQL            02305000
         SLR   0,0                     CLEAR FOR INSERT                 02306000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02307000
         NR    0,3                     FOR THE CURRENT KEY?             02308000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02309000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02310000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02311000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02312000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02313000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02314000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02315000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02316000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02317000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02318000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02319000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02320000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02321000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02322000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02323000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02324000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02325000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02326000
*                                                                       02327000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02328000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02329000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02330000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02331000
         BER   4                         YES - RETURN TO SQL            02332000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02333000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02334000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02335000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02336000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02337000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02338000
         MVCL  0,14                    MOVE TO RECORD AREA              02339000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02340000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02341000
*                                                                       02342000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02343000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02344000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02345000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02346000
         BER   4                         YES - RETURN TO SQL            02347000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02348000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02349000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02350000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02351000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02352000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02353000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02354000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02355000
         MVCL  0,14                    MOVE TO RECORD AREA              02356000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02357000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02358000
*                                                                       02359000
*                                                                       02360000
**********************************************************************  02361000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02362000
*   MUST NOT BE MODIFIED.                                               02363000
**********************************************************************  02364000
*                                                                       02365000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02366000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02367000
         DC    H'0014'                 LENGTH TO MOVE                   02368000
         DC    X'80'                   80 = KEY 0 FIELD                 02369000
*                                      40 = KEY 1 FIELD                 02370000
*                                      20 = KEY 2 FIELD                 02371000
*                                      10 = KEY 3 FIELD                 02372000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02373000
*                                                                       02374000
*                                      REST OF FIELD ENTRIES            02375000
         DC    H'0014',H'0014',H'0549',X'00',X'00'                      02376000
         DC    8X'FF'                  END OF FIELD ENTRIES             02377000
         LTORG                                                          02378000
         END                                                            02379000
