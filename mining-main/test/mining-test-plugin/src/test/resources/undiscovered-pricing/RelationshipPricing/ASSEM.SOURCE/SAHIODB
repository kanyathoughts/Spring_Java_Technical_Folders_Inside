* REL=SAHIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SAHIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAH FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL246                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST1    DS    CL4                                                      00038000
PRDCDE1  DS    CL6                                                      00039000
ACCTNBR1 DS    CL18                                                     00040000
MODEL    DS    CL10                                                     00041000
INST2    DS    CL4                                                      00042000
PRDCDE2  DS    CL6                                                      00043000
ACCTNBR2 DS    CL18                                                     00044000
AUDDATE  DS    PL5'0.'                                                  00045000
AUDTIME  DS    PL5'0.'                                                  00046000
AUDUSER  DS    CL8                                                      00047000
AUDORG   DS    CL6                                                      00048000
ACCTST   DS    CL1                                                      00049000
BRCH     DS    PL3'0.'                                                  00050000
ACCTTYPE DS    PL2'0.'                                                  00051000
SCINCENO DS    CL1                                                      00052000
RINCENO  DS    CL1                                                      00053000
APPLNBR  DS    CL2                                                      00054000
ACCTBAL1 DS    PL8'0.00'                                                00055000
ACCTBAL2 DS    PL8'0.00'                                                00056000
PRIMEBAL DS    PL8'0.00'                                                00057000
ACMBBAL1 DS    PL8'0.00'                                                00058000
ACMBBAL2 DS    PL8'0.00'                                                00059000
ACMBBAL3 DS    PL8'0.00'                                                00060000
ACMBBAL4 DS    PL8'0.00'                                                00061000
CASHBAL  DS    PL8'0.00'                                                00062000
ACCTRATE DS    PL8'0.00'                                                00063000
SCBAL    DS    PL8'0.00'                                                00064000
SECSVBAL DS    PL8'0.00'                                                00065000
DAMTFLAG DS    CL1                                                      00066000
DPCTFLAG DS    CL1                                                      00067000
RPCTFLAG DS    CL1                                                      00068000
DAMTOVRD DS    PL6'0.00'                                                00069000
DPCTOVRD DS    PL3'0.00000'                                             00070000
RPCTOVRD DS    PL3'0.00000'                                             00071000
RAREA    DS    CL43                                                     00072000
*                                                                       00073000
*                                                                       00074000
**********************************************************************  00075000
* PROGRAM TABLE HEADER SECTION:                                         00076000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00077000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00078000
**********************************************************************  00079000
*                                                                       00080000
SAHIODB  CSECT                         PROGRAM TABLE SECTION            00081000
SAHIODB  AMODE ANY                                                      00082000
SAHIODB  RMODE ANY                                                      00083000
         DC    CL9'SAHIODB'            PROGRAM ID                       00084000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00085000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00086000
         DC    A(0)                    RESERVED                         00087000
         DC    A(0)                    RESERVED                         00088000
         DC    24CL1' '                RESERVED                         00089000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00090000
*                                                                       00091000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00092000
         DC    CL29'WWW.INFOR.COM                '                      00092001
*                                                                       00093000
*                                                                       00094000
**********************************************************************  00095000
* STATEMENT TABLE SECTION:                                              00096000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00097000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00098000
*   SHOULD NOT BE MODIFIED.                                             00099000
**********************************************************************  00100000
*                                                                       00101000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00102000
STM#TAB  AMODE ANY                                                      00103000
STM#TAB  RMODE ANY                                                      00104000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00105000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00106000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00107000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00108000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00109000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00110000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00111000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00112000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00113000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00114000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00115000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00116000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00117000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00118000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00119000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00120000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00121000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00122000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00123000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00124000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00125000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00126000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00127000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00128000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00129000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00130000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00131000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00132000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00133000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00134000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00135000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00136000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00137000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00138000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00139000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00140000
         DC    A(SQL#0036)             INSERT STATEMENT                 00141000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00142000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00143000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00144000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00145000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00146000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00147000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00148000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00149000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00150000
         DC    4X'FF'                                                   00151000
*                                                                       00152000
*                                                                       00153000
**********************************************************************  00154000
* SQL STATEMENT SECTION:                                                00155000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00156000
*     TO SUPPORT THIS TABLE.                                            00157000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00158000
*     ARE EQUIVALENT.                                                   00159000
**********************************************************************  00160000
*                                                                       00161000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00162000
SQL#STMT AMODE ANY                                                      00163000
SQL#STMT RMODE ANY                                                      00164000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00165000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00166000
         USING COM#AREA,11             ADDRESS COMMAREA                 00167000
*                                                                       00168000
*                                                                       00169000
**********************************************************************  00170000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00171000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00172000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00173000
**********************************************************************  00174000
*                                                                       00175000
SQL#0000 DS    0H                                                       00176000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00177000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00178000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00179000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00180000
         EXEC  SQL                                                     *00181000
               SELECT AUDIT_DATE,                                      *00182000
                   AUDIT_TIME,                                         *00183000
                   AUDIT_USER,                                         *00184000
                   AUDIT_ORG,                                          *00185000
                   ACCT_STATUS,                                        *00186000
                   BRANCH,                                             *00187000
                   ACCT_TYPE,                                          *00188000
                   SVC_INCEN_OPT,                                      *00189000
                   RATE_INCEN_OPT,                                     *00190000
                   APPL_NBR,                                           *00191000
                   ACCT_BAL_1,                                         *00192000
                   ACCT_BAL_2,                                         *00193000
                   PRIMARY_BAL,                                        *00194000
                   ACCT_CMB_BAL_1,                                     *00195000
                   ACCT_CMB_BAL_2,                                     *00196000
                   ACCT_CMB_BAL_3,                                     *00197000
                   ACCT_CMB_BAL_4,                                     *00198000
                   CASH_BALANCE,                                       *00199000
                   ACCT_RATE_BAL,                                      *00200000
                   SVC_CHG_BAL,                                        *00201000
                   SEC_SVC_BAL,                                        *00202000
                   DISC_AMT_FLAG,                                      *00203000
                   DISC_PCT_FLAG,                                      *00204000
                   RATE_PCT_FLAG,                                      *00205000
                   DISC_AMT_OVRD,                                      *00206000
                   DISC_PCT_OVRD,                                      *00207000
                   RATE_PCT_OVRD,                                      *00208000
                   RSV_AREA                                            *00209000
                 INTO :AUDDATE,                                        *00210000
                   :AUDTIME,                                           *00211000
                   :AUDUSER,                                           *00212000
                   :AUDORG,                                            *00213000
                   :ACCTST,                                            *00214000
                   :BRCH,                                              *00215000
                   :ACCTTYPE,                                          *00216000
                   :SCINCENO,                                          *00217000
                   :RINCENO,                                           *00218000
                   :APPLNBR,                                           *00219000
                   :ACCTBAL1,                                          *00220000
                   :ACCTBAL2,                                          *00221000
                   :PRIMEBAL,                                          *00222000
                   :ACMBBAL1,                                          *00223000
                   :ACMBBAL2,                                          *00224000
                   :ACMBBAL3,                                          *00225000
                   :ACMBBAL4,                                          *00226000
                   :CASHBAL,                                           *00227000
                   :ACCTRATE,                                          *00228000
                   :SCBAL,                                             *00229000
                   :SECSVBAL,                                          *00230000
                   :DAMTFLAG,                                          *00231000
                   :DPCTFLAG,                                          *00232000
                   :RPCTFLAG,                                          *00233000
                   :DAMTOVRD,                                          *00234000
                   :DPCTOVRD,                                          *00235000
                   :RPCTOVRD,                                          *00236000
                   :RAREA                                              *00237000
                 FROM SAH                                              *00238000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00239000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00240000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00241000
                   MODEL = :MODEL AND                                  *00242000
                   ACCT_INST_2 = :INST2 AND                            *00243000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00244000
                   ACCT_NBR_2 = :ACCTNBR2                              *00245000
                 FETCH FIRST 1 ROW ONLY                                 00246000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00247000
         BALR  4,5                     MOVE INTO RECORD AREA            00248000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00249000
         BR    14                      RETURN TO CALLER                 00250000
         LTORG                                                          00251000
*                                                                       00252000
*                                                                       00253000
**********************************************************************  00254000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00255000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00256000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00257000
**********************************************************************  00258000
*                                                                       00259000
SQL#0001 DS    0H                                                       00260000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00261000
         LA    15,255                  SET RETURN CODE                  00262000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00263000
         BR    14                      RETURN TO CALLER                 00264000
         LTORG                                                          00265000
*                                                                       00266000
*                                                                       00267000
**********************************************************************  00268000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00269000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00270000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00271000
**********************************************************************  00272000
*                                                                       00273000
SQL#0002 DS    0H                                                       00274000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00275000
         LA    15,255                  SET RETURN CODE                  00276000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00277000
         BR    14                      RETURN TO CALLER                 00278000
         LTORG                                                          00279000
*                                                                       00280000
*                                                                       00281000
**********************************************************************  00282000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00283000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00284000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00285000
**********************************************************************  00286000
*                                                                       00287000
SQL#0003 DS    0H                                                       00288000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00289000
         LA    15,255                  SET RETURN CODE                  00290000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00291000
         BR    14                      RETURN TO CALLER                 00292000
         LTORG                                                          00293000
*                                                                       00294000
*                                                                       00295000
**********************************************************************  00296000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00297000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00298000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00299000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00300000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00301000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00302000
*     UPDATE STATEMENT TO MATCH.                                        00303000
**********************************************************************  00304000
*                                                                       00305000
SQL#0004 DS    0H                                                       00306000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00307000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00308000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00309000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00310000
         EXEC  SQL                                                     *00311000
               DECLARE SAHUPD0 CURSOR FOR                              *00312000
               SELECT AUDIT_DATE,                                      *00313000
                   AUDIT_TIME,                                         *00314000
                   AUDIT_USER,                                         *00315000
                   AUDIT_ORG,                                          *00316000
                   ACCT_STATUS,                                        *00317000
                   BRANCH,                                             *00318000
                   ACCT_TYPE,                                          *00319000
                   SVC_INCEN_OPT,                                      *00320000
                   RATE_INCEN_OPT,                                     *00321000
                   APPL_NBR,                                           *00322000
                   ACCT_BAL_1,                                         *00323000
                   ACCT_BAL_2,                                         *00324000
                   PRIMARY_BAL,                                        *00325000
                   ACCT_CMB_BAL_1,                                     *00326000
                   ACCT_CMB_BAL_2,                                     *00327000
                   ACCT_CMB_BAL_3,                                     *00328000
                   ACCT_CMB_BAL_4,                                     *00329000
                   CASH_BALANCE,                                       *00330000
                   ACCT_RATE_BAL,                                      *00331000
                   SVC_CHG_BAL,                                        *00332000
                   SEC_SVC_BAL,                                        *00333000
                   DISC_AMT_FLAG,                                      *00334000
                   DISC_PCT_FLAG,                                      *00335000
                   RATE_PCT_FLAG,                                      *00336000
                   DISC_AMT_OVRD,                                      *00337000
                   DISC_PCT_OVRD,                                      *00338000
                   RATE_PCT_OVRD,                                      *00339000
                   RSV_AREA                                            *00340000
                 FROM SAH                                              *00341000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00342000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00343000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00344000
                   MODEL = :MODEL AND                                  *00345000
                   ACCT_INST_2 = :INST2 AND                            *00346000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00347000
                   ACCT_NBR_2 = :ACCTNBR2                              *00348000
                 FOR UPDATE OF AUDIT_DATE,                             *00349000
                   AUDIT_TIME,                                         *00350000
                   AUDIT_USER,                                         *00351000
                   AUDIT_ORG,                                          *00352000
                   ACCT_STATUS,                                        *00353000
                   BRANCH,                                             *00354000
                   ACCT_TYPE,                                          *00355000
                   SVC_INCEN_OPT,                                      *00356000
                   RATE_INCEN_OPT,                                     *00357000
                   APPL_NBR,                                           *00358000
                   ACCT_BAL_1,                                         *00359000
                   ACCT_BAL_2,                                         *00360000
                   PRIMARY_BAL,                                        *00361000
                   ACCT_CMB_BAL_1,                                     *00362000
                   ACCT_CMB_BAL_2,                                     *00363000
                   ACCT_CMB_BAL_3,                                     *00364000
                   ACCT_CMB_BAL_4,                                     *00365000
                   CASH_BALANCE,                                       *00366000
                   ACCT_RATE_BAL,                                      *00367000
                   SVC_CHG_BAL,                                        *00368000
                   SEC_SVC_BAL,                                        *00369000
                   DISC_AMT_FLAG,                                      *00370000
                   DISC_PCT_FLAG,                                      *00371000
                   RATE_PCT_FLAG,                                      *00372000
                   DISC_AMT_OVRD,                                      *00373000
                   DISC_PCT_OVRD,                                      *00374000
                   RATE_PCT_OVRD,                                      *00375000
                   RSV_AREA                                            *00376000
                 FETCH FIRST 1 ROW ONLY                                 00377000
         EXEC  SQL                                                     *00378000
               OPEN SAHUPD0                                             00379000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00380000
         BR    14                      RETURN TO CALLER                 00381000
         LTORG                                                          00382000
*                                                                       00383000
*                                                                       00384000
**********************************************************************  00385000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00386000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00387000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00388000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00389000
*     UPDATE STATEMENT TO MATCH.                                        00390000
**********************************************************************  00391000
*                                                                       00392000
SQL#0005 DS    0H                                                       00393000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00394000
         LA    15,255                  SET RETURN CODE                  00395000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00396000
         BR    14                      RETURN TO CALLER                 00397000
         LTORG                                                          00398000
*                                                                       00399000
*                                                                       00400000
**********************************************************************  00401000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00402000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00403000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00404000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00405000
*     UPDATE STATEMENT TO MATCH.                                        00406000
**********************************************************************  00407000
*                                                                       00408000
SQL#0006 DS    0H                                                       00409000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00410000
         LA    15,255                  SET RETURN CODE                  00411000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00412000
         BR    14                      RETURN TO CALLER                 00413000
         LTORG                                                          00414000
*                                                                       00415000
*                                                                       00416000
**********************************************************************  00417000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00418000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00419000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00420000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00421000
*     UPDATE STATEMENT TO MATCH.                                        00422000
**********************************************************************  00423000
*                                                                       00424000
SQL#0007 DS    0H                                                       00425000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00426000
         LA    15,255                  SET RETURN CODE                  00427000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00428000
         BR    14                      RETURN TO CALLER                 00429000
         LTORG                                                          00430000
*                                                                       00431000
*                                                                       00432000
**********************************************************************  00433000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00434000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00435000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00436000
*     THE ACTUAL ROW.                                                   00437000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00438000
**********************************************************************  00439000
*                                                                       00440000
SQL#0008 DS    0H                                                       00441000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00442000
         EXEC  SQL                                                     *00443000
               FETCH SAHUPD0                                           *00444000
                 INTO :AUDDATE,                                        *00445000
                   :AUDTIME,                                           *00446000
                   :AUDUSER,                                           *00447000
                   :AUDORG,                                            *00448000
                   :ACCTST,                                            *00449000
                   :BRCH,                                              *00450000
                   :ACCTTYPE,                                          *00451000
                   :SCINCENO,                                          *00452000
                   :RINCENO,                                           *00453000
                   :APPLNBR,                                           *00454000
                   :ACCTBAL1,                                          *00455000
                   :ACCTBAL2,                                          *00456000
                   :PRIMEBAL,                                          *00457000
                   :ACMBBAL1,                                          *00458000
                   :ACMBBAL2,                                          *00459000
                   :ACMBBAL3,                                          *00460000
                   :ACMBBAL4,                                          *00461000
                   :CASHBAL,                                           *00462000
                   :ACCTRATE,                                          *00463000
                   :SCBAL,                                             *00464000
                   :SECSVBAL,                                          *00465000
                   :DAMTFLAG,                                          *00466000
                   :DPCTFLAG,                                          *00467000
                   :RPCTFLAG,                                          *00468000
                   :DAMTOVRD,                                          *00469000
                   :DPCTOVRD,                                          *00470000
                   :RPCTOVRD,                                          *00471000
                   :RAREA                                               00472000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00473000
         BALR  4,5                     MOVE INTO RECORD AREA            00474000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00475000
         BR    14                      RETURN TO CALLER                 00476000
         LTORG                                                          00477000
*                                                                       00478000
*                                                                       00479000
**********************************************************************  00480000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00481000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00482000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00483000
*     THE ACTUAL ROW.                                                   00484000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00485000
**********************************************************************  00486000
*                                                                       00487000
SQL#0009 DS    0H                                                       00488000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00489000
         LA    15,255                  SET RETURN CODE                  00490000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00491000
         BR    14                      RETURN TO CALLER                 00492000
         LTORG                                                          00493000
*                                                                       00494000
*                                                                       00495000
**********************************************************************  00496000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00497000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00498000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00499000
*     THE ACTUAL ROW.                                                   00500000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00501000
**********************************************************************  00502000
*                                                                       00503000
SQL#0010 DS    0H                                                       00504000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00505000
         LA    15,255                  SET RETURN CODE                  00506000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00507000
         BR    14                      RETURN TO CALLER                 00508000
         LTORG                                                          00509000
*                                                                       00510000
*                                                                       00511000
**********************************************************************  00512000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00513000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00514000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00515000
*     THE ACTUAL ROW.                                                   00516000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00517000
**********************************************************************  00518000
*                                                                       00519000
SQL#0011 DS    0H                                                       00520000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00521000
         LA    15,255                  SET RETURN CODE                  00522000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00523000
         BR    14                      RETURN TO CALLER                 00524000
         LTORG                                                          00525000
*                                                                       00526000
*                                                                       00527000
**********************************************************************  00528000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00529000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00530000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00531000
*     TO CLOSE THE UPDATE CURSOR.                                       00532000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00533000
**********************************************************************  00534000
*                                                                       00535000
SQL#0012 DS    0H                                                       00536000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00537000
         EXEC  SQL                                                     *00538000
               CLOSE SAHUPD0                                            00539000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00540000
         BR    14                      RETURN TO CALLER                 00541000
         LTORG                                                          00542000
*                                                                       00543000
*                                                                       00544000
**********************************************************************  00545000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00546000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00547000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00548000
*     TO CLOSE THE UPDATE CURSOR.                                       00549000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00550000
**********************************************************************  00551000
*                                                                       00552000
SQL#0013 DS    0H                                                       00553000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00554000
         LA    15,255                  SET RETURN CODE                  00555000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00556000
         BR    14                      RETURN TO CALLER                 00557000
         LTORG                                                          00558000
*                                                                       00559000
*                                                                       00560000
**********************************************************************  00561000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00562000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00563000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00564000
*     TO CLOSE THE UPDATE CURSOR.                                       00565000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00566000
**********************************************************************  00567000
*                                                                       00568000
SQL#0014 DS    0H                                                       00569000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00570000
         LA    15,255                  SET RETURN CODE                  00571000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00572000
         BR    14                      RETURN TO CALLER                 00573000
         LTORG                                                          00574000
*                                                                       00575000
*                                                                       00576000
**********************************************************************  00577000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00578000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00579000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00580000
*     TO CLOSE THE UPDATE CURSOR.                                       00581000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00582000
**********************************************************************  00583000
*                                                                       00584000
SQL#0015 DS    0H                                                       00585000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00586000
         LA    15,255                  SET RETURN CODE                  00587000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00588000
         BR    14                      RETURN TO CALLER                 00589000
         LTORG                                                          00590000
*                                                                       00591000
*                                                                       00592000
**********************************************************************  00593000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00594000
* KEY:                                                                  00595000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00596000
*     AND GET-NEXT-LOCK VERBS.                                          00597000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00598000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00599000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00600000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00601000
*     ORDER BY CLAUSE.                                                  00602000
**********************************************************************  00603000
*                                                                       00604000
SQL#0016 DS    0H                                                       00605000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00606000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00607000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00608000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00609000
         EXEC  SQL                                                     *00610000
               DECLARE SAHSQ001 CURSOR FOR                             *00611000
               SELECT ACCT_INST_1,                                     *00612000
                   PROD_CODE_1,                                        *00613000
                   ACCT_NBR_1,                                         *00614000
                   MODEL,                                              *00615000
                   ACCT_INST_2,                                        *00616000
                   PROD_CODE_2,                                        *00617000
                   ACCT_NBR_2,                                         *00618000
                   AUDIT_DATE,                                         *00619000
                   AUDIT_TIME,                                         *00620000
                   AUDIT_USER,                                         *00621000
                   AUDIT_ORG,                                          *00622000
                   ACCT_STATUS,                                        *00623000
                   BRANCH,                                             *00624000
                   ACCT_TYPE,                                          *00625000
                   SVC_INCEN_OPT,                                      *00626000
                   RATE_INCEN_OPT,                                     *00627000
                   APPL_NBR,                                           *00628000
                   ACCT_BAL_1,                                         *00629000
                   ACCT_BAL_2,                                         *00630000
                   PRIMARY_BAL,                                        *00631000
                   ACCT_CMB_BAL_1,                                     *00632000
                   ACCT_CMB_BAL_2,                                     *00633000
                   ACCT_CMB_BAL_3,                                     *00634000
                   ACCT_CMB_BAL_4,                                     *00635000
                   CASH_BALANCE,                                       *00636000
                   ACCT_RATE_BAL,                                      *00637000
                   SVC_CHG_BAL,                                        *00638000
                   SEC_SVC_BAL,                                        *00639000
                   DISC_AMT_FLAG,                                      *00640000
                   DISC_PCT_FLAG,                                      *00641000
                   RATE_PCT_FLAG,                                      *00642000
                   DISC_AMT_OVRD,                                      *00643000
                   DISC_PCT_OVRD,                                      *00644000
                   RATE_PCT_OVRD,                                      *00645000
                   RSV_AREA                                            *00646000
                 FROM SAH                                              *00647000
                 WHERE                                                 *00648000
                    ACCT_INST_1 = :INST1 AND                           *00649000
                    PROD_CODE_1 = :PRDCDE1 AND                         *00650000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *00651000
                    MODEL = :MODEL AND                                 *00652000
                    ACCT_INST_2 = :INST2 AND                           *00653000
                    PROD_CODE_2 = :PRDCDE2 AND                         *00654000
                    ACCT_NBR_2 >= :ACCTNBR2                            *00655000
                 ORDER BY ACCT_NBR_2                                   *00656000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00657000
         EXEC  SQL                                                     *00658000
               OPEN SAHSQ001                                            00659000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00660000
         BR    14                      RETURN TO CALLER                 00661000
         LTORG                                                          00662000
*                                                                       00663000
*                                                                       00664000
**********************************************************************  00665000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00666000
* KEY 1:                                                                00667000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00668000
*     AND GET-NEXT-LOCK VERBS.                                          00669000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00670000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00671000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00672000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00673000
*     ORDER BY CLAUSE.                                                  00674000
**********************************************************************  00675000
*                                                                       00676000
SQL#0017 DS    0H                                                       00677000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00678000
         LA    15,255                  SET RETURN CODE                  00679000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00680000
         BR    14                      RETURN TO CALLER                 00681000
         LTORG                                                          00682000
*                                                                       00683000
*                                                                       00684000
**********************************************************************  00685000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00686000
* KEY 2:                                                                00687000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00688000
*     AND GET-NEXT-LOCK VERBS.                                          00689000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00690000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00691000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00692000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00693000
*     ORDER BY CLAUSE.                                                  00694000
**********************************************************************  00695000
*                                                                       00696000
SQL#0018 DS    0H                                                       00697000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00698000
         LA    15,255                  SET RETURN CODE                  00699000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00700000
         BR    14                      RETURN TO CALLER                 00701000
         LTORG                                                          00702000
*                                                                       00703000
*                                                                       00704000
**********************************************************************  00705000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00706000
* KEY 3:                                                                00707000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00708000
*     AND GET-NEXT-LOCK VERBS.                                          00709000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00710000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00711000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00712000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00713000
*     ORDER BY CLAUSE.                                                  00714000
**********************************************************************  00715000
*                                                                       00716000
SQL#0019 DS    0H                                                       00717000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00718000
         LA    15,255                  SET RETURN CODE                  00719000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00720000
         BR    14                      RETURN TO CALLER                 00721000
         LTORG                                                          00722000
*                                                                       00723000
*                                                                       00724000
**********************************************************************  00725000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00726000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00727000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00728000
*     RETRIEVE THE ACTUAL ROW.                                          00729000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00730000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00731000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00732000
**********************************************************************  00733000
*                                                                       00734000
SQL#0020 DS    0H                                                       00735000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00736000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00737000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00738000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00739000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00740000
VECT0020 DC    A(SQL#0120)                                              00741000
         DC    A(SQL#0220)                                              00742000
         DC    A(SQL#0320)                                              00743000
         DC    A(SQL#0420)                                              00744000
         DC    A(SQL#0520)                                              00745000
         DC    A(SQL#0620)                                              00746000
         DC    A(SQL#0720)                                              00747000
         LTORG                                                          00748000
*                                                                       00749000
SQL#0120 DS    0H                                                       00750000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00751000
         EXEC  SQL                                                     *00752000
               FETCH SAHSQ001                                          *00753000
                 INTO :INST1,                                          *00754000
                      :PRDCDE1,                                        *00755000
                      :ACCTNBR1,                                       *00756000
                      :MODEL,                                          *00757000
                      :INST2,                                          *00758000
                      :PRDCDE2,                                        *00759000
                      :ACCTNBR2,                                       *00760000
                      :AUDDATE,                                        *00761000
                      :AUDTIME,                                        *00762000
                      :AUDUSER,                                        *00763000
                      :AUDORG,                                         *00764000
                      :ACCTST,                                         *00765000
                      :BRCH,                                           *00766000
                      :ACCTTYPE,                                       *00767000
                      :SCINCENO,                                       *00768000
                      :RINCENO,                                        *00769000
                      :APPLNBR,                                        *00770000
                      :ACCTBAL1,                                       *00771000
                      :ACCTBAL2,                                       *00772000
                      :PRIMEBAL,                                       *00773000
                      :ACMBBAL1,                                       *00774000
                      :ACMBBAL2,                                       *00775000
                      :ACMBBAL3,                                       *00776000
                      :ACMBBAL4,                                       *00777000
                      :CASHBAL,                                        *00778000
                      :ACCTRATE,                                       *00779000
                      :SCBAL,                                          *00780000
                      :SECSVBAL,                                       *00781000
                      :DAMTFLAG,                                       *00782000
                      :DPCTFLAG,                                       *00783000
                      :RPCTFLAG,                                       *00784000
                      :DAMTOVRD,                                       *00785000
                      :DPCTOVRD,                                       *00786000
                      :RPCTOVRD,                                       *00787000
                      :RAREA                                            00788000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00789000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00790000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00791000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00792000
         BR    12                      OPEN NEXT CURSOR                 00793000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00794000
         BALR  4,5                     MOVE INTO RECORD AREA            00795000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00796000
         BR    14                      RETURN TO CALLER                 00797000
         LTORG                                                          00798000
*                                                                       00799000
SQL#0220 DS    0H                                                       00800000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00801000
         EXEC  SQL                                                     *00802000
               FETCH SAHSQ002                                          *00803000
                 INTO :INST1,                                          *00804000
                      :PRDCDE1,                                        *00805000
                      :ACCTNBR1,                                       *00806000
                      :MODEL,                                          *00807000
                      :INST2,                                          *00808000
                      :PRDCDE2,                                        *00809000
                      :ACCTNBR2,                                       *00810000
                      :AUDDATE,                                        *00811000
                      :AUDTIME,                                        *00812000
                      :AUDUSER,                                        *00813000
                      :AUDORG,                                         *00814000
                      :ACCTST,                                         *00815000
                      :BRCH,                                           *00816000
                      :ACCTTYPE,                                       *00817000
                      :SCINCENO,                                       *00818000
                      :RINCENO,                                        *00819000
                      :APPLNBR,                                        *00820000
                      :ACCTBAL1,                                       *00821000
                      :ACCTBAL2,                                       *00822000
                      :PRIMEBAL,                                       *00823000
                      :ACMBBAL1,                                       *00824000
                      :ACMBBAL2,                                       *00825000
                      :ACMBBAL3,                                       *00826000
                      :ACMBBAL4,                                       *00827000
                      :CASHBAL,                                        *00828000
                      :ACCTRATE,                                       *00829000
                      :SCBAL,                                          *00830000
                      :SECSVBAL,                                       *00831000
                      :DAMTFLAG,                                       *00832000
                      :DPCTFLAG,                                       *00833000
                      :RPCTFLAG,                                       *00834000
                      :DAMTOVRD,                                       *00835000
                      :DPCTOVRD,                                       *00836000
                      :RPCTOVRD,                                       *00837000
                      :RAREA                                            00838000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00839000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00840000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00841000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00842000
         BR    12                      OPEN NEXT CURSOR                 00843000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00844000
         BALR  4,5                     MOVE INTO RECORD AREA            00845000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00846000
         BR    14                      RETURN TO CALLER                 00847000
         LTORG                                                          00848000
*                                                                       00849000
SQL#0320 DS    0H                                                       00850000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00851000
         EXEC  SQL                                                     *00852000
               FETCH SAHSQ003                                          *00853000
                 INTO :INST1,                                          *00854000
                      :PRDCDE1,                                        *00855000
                      :ACCTNBR1,                                       *00856000
                      :MODEL,                                          *00857000
                      :INST2,                                          *00858000
                      :PRDCDE2,                                        *00859000
                      :ACCTNBR2,                                       *00860000
                      :AUDDATE,                                        *00861000
                      :AUDTIME,                                        *00862000
                      :AUDUSER,                                        *00863000
                      :AUDORG,                                         *00864000
                      :ACCTST,                                         *00865000
                      :BRCH,                                           *00866000
                      :ACCTTYPE,                                       *00867000
                      :SCINCENO,                                       *00868000
                      :RINCENO,                                        *00869000
                      :APPLNBR,                                        *00870000
                      :ACCTBAL1,                                       *00871000
                      :ACCTBAL2,                                       *00872000
                      :PRIMEBAL,                                       *00873000
                      :ACMBBAL1,                                       *00874000
                      :ACMBBAL2,                                       *00875000
                      :ACMBBAL3,                                       *00876000
                      :ACMBBAL4,                                       *00877000
                      :CASHBAL,                                        *00878000
                      :ACCTRATE,                                       *00879000
                      :SCBAL,                                          *00880000
                      :SECSVBAL,                                       *00881000
                      :DAMTFLAG,                                       *00882000
                      :DPCTFLAG,                                       *00883000
                      :RPCTFLAG,                                       *00884000
                      :DAMTOVRD,                                       *00885000
                      :DPCTOVRD,                                       *00886000
                      :RPCTOVRD,                                       *00887000
                      :RAREA                                            00888000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00889000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00890000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00891000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00892000
         BR    12                      OPEN NEXT CURSOR                 00893000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00894000
         BALR  4,5                     MOVE INTO RECORD AREA            00895000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00896000
         BR    14                      RETURN TO CALLER                 00897000
         LTORG                                                          00898000
*                                                                       00899000
SQL#0420 DS    0H                                                       00900000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          00901000
         EXEC  SQL                                                     *00902000
               FETCH SAHSQ004                                          *00903000
                 INTO :INST1,                                          *00904000
                      :PRDCDE1,                                        *00905000
                      :ACCTNBR1,                                       *00906000
                      :MODEL,                                          *00907000
                      :INST2,                                          *00908000
                      :PRDCDE2,                                        *00909000
                      :ACCTNBR2,                                       *00910000
                      :AUDDATE,                                        *00911000
                      :AUDTIME,                                        *00912000
                      :AUDUSER,                                        *00913000
                      :AUDORG,                                         *00914000
                      :ACCTST,                                         *00915000
                      :BRCH,                                           *00916000
                      :ACCTTYPE,                                       *00917000
                      :SCINCENO,                                       *00918000
                      :RINCENO,                                        *00919000
                      :APPLNBR,                                        *00920000
                      :ACCTBAL1,                                       *00921000
                      :ACCTBAL2,                                       *00922000
                      :PRIMEBAL,                                       *00923000
                      :ACMBBAL1,                                       *00924000
                      :ACMBBAL2,                                       *00925000
                      :ACMBBAL3,                                       *00926000
                      :ACMBBAL4,                                       *00927000
                      :CASHBAL,                                        *00928000
                      :ACCTRATE,                                       *00929000
                      :SCBAL,                                          *00930000
                      :SECSVBAL,                                       *00931000
                      :DAMTFLAG,                                       *00932000
                      :DPCTFLAG,                                       *00933000
                      :RPCTFLAG,                                       *00934000
                      :DAMTOVRD,                                       *00935000
                      :DPCTOVRD,                                       *00936000
                      :RPCTOVRD,                                       *00937000
                      :RAREA                                            00938000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00939000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00940000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00941000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00942000
         BR    12                      OPEN NEXT CURSOR                 00943000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00944000
         BALR  4,5                     MOVE INTO RECORD AREA            00945000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00946000
         BR    14                      RETURN TO CALLER                 00947000
         LTORG                                                          00948000
*                                                                       00949000
SQL#0520 DS    0H                                                       00950000
         USING SQL#0520,12             ESTABLISH BASE REGISTER          00951000
         EXEC  SQL                                                     *00952000
               FETCH SAHSQ005                                          *00953000
                 INTO :INST1,                                          *00954000
                      :PRDCDE1,                                        *00955000
                      :ACCTNBR1,                                       *00956000
                      :MODEL,                                          *00957000
                      :INST2,                                          *00958000
                      :PRDCDE2,                                        *00959000
                      :ACCTNBR2,                                       *00960000
                      :AUDDATE,                                        *00961000
                      :AUDTIME,                                        *00962000
                      :AUDUSER,                                        *00963000
                      :AUDORG,                                         *00964000
                      :ACCTST,                                         *00965000
                      :BRCH,                                           *00966000
                      :ACCTTYPE,                                       *00967000
                      :SCINCENO,                                       *00968000
                      :RINCENO,                                        *00969000
                      :APPLNBR,                                        *00970000
                      :ACCTBAL1,                                       *00971000
                      :ACCTBAL2,                                       *00972000
                      :PRIMEBAL,                                       *00973000
                      :ACMBBAL1,                                       *00974000
                      :ACMBBAL2,                                       *00975000
                      :ACMBBAL3,                                       *00976000
                      :ACMBBAL4,                                       *00977000
                      :CASHBAL,                                        *00978000
                      :ACCTRATE,                                       *00979000
                      :SCBAL,                                          *00980000
                      :SECSVBAL,                                       *00981000
                      :DAMTFLAG,                                       *00982000
                      :DPCTFLAG,                                       *00983000
                      :RPCTFLAG,                                       *00984000
                      :DAMTOVRD,                                       *00985000
                      :DPCTOVRD,                                       *00986000
                      :RPCTOVRD,                                       *00987000
                      :RAREA                                            00988000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00989000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00990000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00991000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00992000
         BR    12                      OPEN NEXT CURSOR                 00993000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00994000
         BALR  4,5                     MOVE INTO RECORD AREA            00995000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00996000
         BR    14                      RETURN TO CALLER                 00997000
         LTORG                                                          00998000
*                                                                       00999000
SQL#0620 DS    0H                                                       01000000
         USING SQL#0620,12             ESTABLISH BASE REGISTER          01001000
         EXEC  SQL                                                     *01002000
               FETCH SAHSQ006                                          *01003000
                 INTO :INST1,                                          *01004000
                      :PRDCDE1,                                        *01005000
                      :ACCTNBR1,                                       *01006000
                      :MODEL,                                          *01007000
                      :INST2,                                          *01008000
                      :PRDCDE2,                                        *01009000
                      :ACCTNBR2,                                       *01010000
                      :AUDDATE,                                        *01011000
                      :AUDTIME,                                        *01012000
                      :AUDUSER,                                        *01013000
                      :AUDORG,                                         *01014000
                      :ACCTST,                                         *01015000
                      :BRCH,                                           *01016000
                      :ACCTTYPE,                                       *01017000
                      :SCINCENO,                                       *01018000
                      :RINCENO,                                        *01019000
                      :APPLNBR,                                        *01020000
                      :ACCTBAL1,                                       *01021000
                      :ACCTBAL2,                                       *01022000
                      :PRIMEBAL,                                       *01023000
                      :ACMBBAL1,                                       *01024000
                      :ACMBBAL2,                                       *01025000
                      :ACMBBAL3,                                       *01026000
                      :ACMBBAL4,                                       *01027000
                      :CASHBAL,                                        *01028000
                      :ACCTRATE,                                       *01029000
                      :SCBAL,                                          *01030000
                      :SECSVBAL,                                       *01031000
                      :DAMTFLAG,                                       *01032000
                      :DPCTFLAG,                                       *01033000
                      :RPCTFLAG,                                       *01034000
                      :DAMTOVRD,                                       *01035000
                      :DPCTOVRD,                                       *01036000
                      :RPCTOVRD,                                       *01037000
                      :RAREA                                            01038000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01039000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01040000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01041000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01042000
         BR    12                      OPEN NEXT CURSOR                 01043000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01044000
         BALR  4,5                     MOVE INTO RECORD AREA            01045000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01046000
         BR    14                      RETURN TO CALLER                 01047000
         LTORG                                                          01048000
*                                                                       01049000
SQL#0720 DS    0H                                                       01050000
         USING SQL#0720,12             ESTABLISH BASE REGISTER          01051000
         EXEC  SQL                                                     *01052000
               FETCH SAHSQ007                                          *01053000
                 INTO :INST1,                                          *01054000
                      :PRDCDE1,                                        *01055000
                      :ACCTNBR1,                                       *01056000
                      :MODEL,                                          *01057000
                      :INST2,                                          *01058000
                      :PRDCDE2,                                        *01059000
                      :ACCTNBR2,                                       *01060000
                      :AUDDATE,                                        *01061000
                      :AUDTIME,                                        *01062000
                      :AUDUSER,                                        *01063000
                      :AUDORG,                                         *01064000
                      :ACCTST,                                         *01065000
                      :BRCH,                                           *01066000
                      :ACCTTYPE,                                       *01067000
                      :SCINCENO,                                       *01068000
                      :RINCENO,                                        *01069000
                      :APPLNBR,                                        *01070000
                      :ACCTBAL1,                                       *01071000
                      :ACCTBAL2,                                       *01072000
                      :PRIMEBAL,                                       *01073000
                      :ACMBBAL1,                                       *01074000
                      :ACMBBAL2,                                       *01075000
                      :ACMBBAL3,                                       *01076000
                      :ACMBBAL4,                                       *01077000
                      :CASHBAL,                                        *01078000
                      :ACCTRATE,                                       *01079000
                      :SCBAL,                                          *01080000
                      :SECSVBAL,                                       *01081000
                      :DAMTFLAG,                                       *01082000
                      :DPCTFLAG,                                       *01083000
                      :RPCTFLAG,                                       *01084000
                      :DAMTOVRD,                                       *01085000
                      :DPCTOVRD,                                       *01086000
                      :RPCTOVRD,                                       *01087000
                      :RAREA                                            01088000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01089000
         BALR  4,5                     MOVE INTO RECORD AREA            01090000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01091000
         BR    14                      RETURN TO CALLER                 01092000
         LTORG                                                          01093000
*                                                                       01094000
*                                                                       01095000
**********************************************************************  01096000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01097000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01098000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01099000
*     RETRIEVE THE ACTUAL ROW.                                          01100000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01101000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01102000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01103000
**********************************************************************  01104000
*                                                                       01105000
SQL#0021 DS    0H                                                       01106000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01107000
         LA    15,255                  SET RETURN CODE                  01108000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01109000
         BR    14                      RETURN TO CALLER                 01110000
         LTORG                                                          01111000
*                                                                       01112000
*                                                                       01113000
**********************************************************************  01114000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01115000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01116000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01117000
*     RETRIEVE THE ACTUAL ROW.                                          01118000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01119000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01120000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01121000
**********************************************************************  01122000
*                                                                       01123000
SQL#0022 DS    0H                                                       01124000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01125000
         LA    15,255                  SET RETURN CODE                  01126000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01127000
         BR    14                      RETURN TO CALLER                 01128000
         LTORG                                                          01129000
*                                                                       01130000
*                                                                       01131000
**********************************************************************  01132000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01133000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01134000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01135000
*     RETRIEVE THE ACTUAL ROW.                                          01136000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01137000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01138000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01139000
**********************************************************************  01140000
*                                                                       01141000
SQL#0023 DS    0H                                                       01142000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01143000
         LA    15,255                  SET RETURN CODE                  01144000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01145000
         BR    14                      RETURN TO CALLER                 01146000
         LTORG                                                          01147000
*                                                                       01148000
*                                                                       01149000
**********************************************************************  01150000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01151000
* THE PRIMARY KEY:                                                      01152000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01153000
*     VERBS.                                                            01154000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01155000
*     RETRIEVE THE ACTUAL ROW.                                          01156000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01157000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01158000
*     WILL BE THRU THE UPDATE CURSOR.                                   01159000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01160000
**********************************************************************  01161000
*                                                                       01162000
SQL#0024 DS    0H                                                       01163000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01164000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01165000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01166000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01167000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01168000
VECT0024 DC    A(SQL#0124)                                              01169000
         DC    A(SQL#0224)                                              01170000
         DC    A(SQL#0324)                                              01171000
         DC    A(SQL#0424)                                              01172000
         DC    A(SQL#0524)                                              01173000
         DC    A(SQL#0624)                                              01174000
         DC    A(SQL#0724)                                              01175000
         LTORG                                                          01176000
*                                                                       01177000
SQL#0124 DS    0H                                                       01178000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01179000
         EXEC  SQL                                                     *01180000
               FETCH SAHSQ001                                          *01181000
                 INTO :INST1,                                          *01182000
                      :PRDCDE1,                                        *01183000
                      :ACCTNBR1,                                       *01184000
                      :MODEL,                                          *01185000
                      :INST2,                                          *01186000
                      :PRDCDE2,                                        *01187000
                      :ACCTNBR2                                         01188000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01189000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01190000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01191000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01192000
         BR    12                      OPEN NEXT CURSOR                 01193000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01194000
         BALR  4,5                     MOVE INTO RECORD AREA            01195000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01196000
         BR    14                      RETURN TO CALLER                 01197000
         LTORG                                                          01198000
*                                                                       01199000
SQL#0224 DS    0H                                                       01200000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01201000
         EXEC  SQL                                                     *01202000
               FETCH SAHSQ002                                          *01203000
                 INTO :INST1,                                          *01204000
                      :PRDCDE1,                                        *01205000
                      :ACCTNBR1,                                       *01206000
                      :MODEL,                                          *01207000
                      :INST2,                                          *01208000
                      :PRDCDE2,                                        *01209000
                      :ACCTNBR2                                         01210000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01211000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01212000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01213000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01214000
         BR    12                      OPEN NEXT CURSOR                 01215000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01216000
         BALR  4,5                     MOVE INTO RECORD AREA            01217000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01218000
         BR    14                      RETURN TO CALLER                 01219000
         LTORG                                                          01220000
*                                                                       01221000
SQL#0324 DS    0H                                                       01222000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01223000
         EXEC  SQL                                                     *01224000
               FETCH SAHSQ003                                          *01225000
                 INTO :INST1,                                          *01226000
                      :PRDCDE1,                                        *01227000
                      :ACCTNBR1,                                       *01228000
                      :MODEL,                                          *01229000
                      :INST2,                                          *01230000
                      :PRDCDE2,                                        *01231000
                      :ACCTNBR2                                         01232000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01233000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01234000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01235000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01236000
         BR    12                      OPEN NEXT CURSOR                 01237000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01238000
         BALR  4,5                     MOVE INTO RECORD AREA            01239000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01240000
         BR    14                      RETURN TO CALLER                 01241000
         LTORG                                                          01242000
*                                                                       01243000
SQL#0424 DS    0H                                                       01244000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          01245000
         EXEC  SQL                                                     *01246000
               FETCH SAHSQ004                                          *01247000
                 INTO :INST1,                                          *01248000
                      :PRDCDE1,                                        *01249000
                      :ACCTNBR1,                                       *01250000
                      :MODEL,                                          *01251000
                      :INST2,                                          *01252000
                      :PRDCDE2,                                        *01253000
                      :ACCTNBR2                                         01254000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01255000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01256000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01257000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01258000
         BR    12                      OPEN NEXT CURSOR                 01259000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01260000
         BALR  4,5                     MOVE INTO RECORD AREA            01261000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01262000
         BR    14                      RETURN TO CALLER                 01263000
         LTORG                                                          01264000
*                                                                       01265000
SQL#0524 DS    0H                                                       01266000
         USING SQL#0524,12             ESTABLISH BASE REGISTER          01267000
         EXEC  SQL                                                     *01268000
               FETCH SAHSQ005                                          *01269000
                 INTO :INST1,                                          *01270000
                      :PRDCDE1,                                        *01271000
                      :ACCTNBR1,                                       *01272000
                      :MODEL,                                          *01273000
                      :INST2,                                          *01274000
                      :PRDCDE2,                                        *01275000
                      :ACCTNBR2                                         01276000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01277000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01278000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01279000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01280000
         BR    12                      OPEN NEXT CURSOR                 01281000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01282000
         BALR  4,5                     MOVE INTO RECORD AREA            01283000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01284000
         BR    14                      RETURN TO CALLER                 01285000
         LTORG                                                          01286000
*                                                                       01287000
SQL#0624 DS    0H                                                       01288000
         USING SQL#0624,12             ESTABLISH BASE REGISTER          01289000
         EXEC  SQL                                                     *01290000
               FETCH SAHSQ006                                          *01291000
                 INTO :INST1,                                          *01292000
                      :PRDCDE1,                                        *01293000
                      :ACCTNBR1,                                       *01294000
                      :MODEL,                                          *01295000
                      :INST2,                                          *01296000
                      :PRDCDE2,                                        *01297000
                      :ACCTNBR2                                         01298000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01299000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01300000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01301000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01302000
         BR    12                      OPEN NEXT CURSOR                 01303000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01304000
         BALR  4,5                     MOVE INTO RECORD AREA            01305000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01306000
         BR    14                      RETURN TO CALLER                 01307000
         LTORG                                                          01308000
*                                                                       01309000
SQL#0724 DS    0H                                                       01310000
         USING SQL#0724,12             ESTABLISH BASE REGISTER          01311000
         EXEC  SQL                                                     *01312000
               FETCH SAHSQ007                                          *01313000
                 INTO :INST1,                                          *01314000
                      :PRDCDE1,                                        *01315000
                      :ACCTNBR1,                                       *01316000
                      :MODEL,                                          *01317000
                      :INST2,                                          *01318000
                      :PRDCDE2,                                        *01319000
                      :ACCTNBR2                                         01320000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01321000
         BALR  4,5                     MOVE INTO RECORD AREA            01322000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01323000
         BR    14                      RETURN TO CALLER                 01324000
         LTORG                                                          01325000
*                                                                       01326000
*                                                                       01327000
**********************************************************************  01328000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01329000
* ALTERNATE KEY 1:                                                      01330000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01331000
*     VERBS.                                                            01332000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01333000
*     RETRIEVE THE ACTUAL ROW.                                          01334000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01335000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01336000
*     WILL BE THRU THE UPDATE CURSOR.                                   01337000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01338000
**********************************************************************  01339000
*                                                                       01340000
SQL#0025 DS    0H                                                       01341000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01342000
         LA    15,255                  SET RETURN CODE                  01343000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01344000
         BR    14                      RETURN TO CALLER                 01345000
         LTORG                                                          01346000
*                                                                       01347000
*                                                                       01348000
**********************************************************************  01349000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01350000
* ALTERNATE KEY 2:                                                      01351000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01352000
*     VERBS.                                                            01353000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01354000
*     RETRIEVE THE ACTUAL ROW.                                          01355000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01356000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01357000
*     WILL BE THRU THE UPDATE CURSOR.                                   01358000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01359000
**********************************************************************  01360000
*                                                                       01361000
SQL#0026 DS    0H                                                       01362000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01363000
         LA    15,255                  SET RETURN CODE                  01364000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01365000
         BR    14                      RETURN TO CALLER                 01366000
         LTORG                                                          01367000
*                                                                       01368000
*                                                                       01369000
**********************************************************************  01370000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01371000
* ALTERNATE KEY 3:                                                      01372000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01373000
*     VERBS.                                                            01374000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01375000
*     RETRIEVE THE ACTUAL ROW.                                          01376000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01377000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01378000
*     WILL BE THRU THE UPDATE CURSOR.                                   01379000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01380000
**********************************************************************  01381000
*                                                                       01382000
SQL#0027 DS    0H                                                       01383000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01384000
         LA    15,255                  SET RETURN CODE                  01385000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01386000
         BR    14                      RETURN TO CALLER                 01387000
         LTORG                                                          01388000
*                                                                       01389000
*                                                                       01390000
**********************************************************************  01391000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01392000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01393000
*     AND GET-NEXT-LOCK VERBS.                                          01394000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01395000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01396000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01397000
**********************************************************************  01398000
*                                                                       01399000
SQL#0028 DS    0H                                                       01400000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01401000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01402000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01403000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01404000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01405000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01406000
VECT0028 DC    A(SQL#0128)                                              01407000
         DC    A(SQL#0228)                                              01408000
         DC    A(SQL#0328)                                              01409000
         DC    A(SQL#0428)                                              01410000
         DC    A(SQL#0528)                                              01411000
         DC    A(SQL#0628)                                              01412000
         DC    A(SQL#0728)                                              01413000
         LTORG                                                          01414000
*                                                                       01415000
SQL#0128 DS    0H                                                       01416000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01417000
         EXEC  SQL                                                     *01418000
               CLOSE SAHSQ001                                           01419000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01420000
         BR    14                      RETURN TO CALLER                 01421000
         LTORG                                                          01422000
*                                                                       01423000
SQL#0228 DS    0H                                                       01424000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01425000
         EXEC  SQL                                                     *01426000
               CLOSE SAHSQ002                                           01427000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01428000
         BR    14                      RETURN TO CALLER                 01429000
         LTORG                                                          01430000
*                                                                       01431000
SQL#0328 DS    0H                                                       01432000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01433000
         EXEC  SQL                                                     *01434000
               CLOSE SAHSQ003                                           01435000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01436000
         BR    14                      RETURN TO CALLER                 01437000
         LTORG                                                          01438000
*                                                                       01439000
SQL#0428 DS    0H                                                       01440000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01441000
         EXEC  SQL                                                     *01442000
               CLOSE SAHSQ004                                           01443000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01444000
         BR    14                      RETURN TO CALLER                 01445000
         LTORG                                                          01446000
*                                                                       01447000
SQL#0528 DS    0H                                                       01448000
         USING SQL#0528,12             ESTABLISH BASE REGISTER          01449000
         EXEC  SQL                                                     *01450000
               CLOSE SAHSQ005                                           01451000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01452000
         BR    14                      RETURN TO CALLER                 01453000
         LTORG                                                          01454000
*                                                                       01455000
SQL#0628 DS    0H                                                       01456000
         USING SQL#0628,12             ESTABLISH BASE REGISTER          01457000
         EXEC  SQL                                                     *01458000
               CLOSE SAHSQ006                                           01459000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01460000
         BR    14                      RETURN TO CALLER                 01461000
         LTORG                                                          01462000
*                                                                       01463000
SQL#0728 DS    0H                                                       01464000
         USING SQL#0728,12             ESTABLISH BASE REGISTER          01465000
         EXEC  SQL                                                     *01466000
               CLOSE SAHSQ007                                           01467000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01468000
         BR    14                      RETURN TO CALLER                 01469000
         LTORG                                                          01470000
*                                                                       01471000
*                                                                       01472000
**********************************************************************  01473000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01474000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01475000
*     AND GET-NEXT-LOCK VERBS.                                          01476000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01477000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01478000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01479000
**********************************************************************  01480000
*                                                                       01481000
SQL#0029 DS    0H                                                       01482000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01483000
         LA    15,255                  SET RETURN CODE                  01484000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01485000
         BR    14                      RETURN TO CALLER                 01486000
         LTORG                                                          01487000
*                                                                       01488000
*                                                                       01489000
**********************************************************************  01490000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01491000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01492000
*     AND GET-NEXT-LOCK VERBS.                                          01493000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01494000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01495000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01496000
**********************************************************************  01497000
*                                                                       01498000
SQL#0030 DS    0H                                                       01499000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01500000
         LA    15,255                  SET RETURN CODE                  01501000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01502000
         BR    14                      RETURN TO CALLER                 01503000
         LTORG                                                          01504000
*                                                                       01505000
*                                                                       01506000
**********************************************************************  01507000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01508000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01509000
*     AND GET-NEXT-LOCK VERBS.                                          01510000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01511000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01512000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01513000
**********************************************************************  01514000
*                                                                       01515000
SQL#0031 DS    0H                                                       01516000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01517000
         LA    15,255                  SET RETURN CODE                  01518000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01519000
         BR    14                      RETURN TO CALLER                 01520000
         LTORG                                                          01521000
*                                                                       01522000
*                                                                       01523000
**********************************************************************  01524000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01525000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01526000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01527000
**********************************************************************  01528000
*                                                                       01529000
SQL#0032 DS    0H                                                       01530000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01531000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01532000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01533000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01534000
         EXEC  SQL                                                     *01535000
               SELECT ACCT_INST_1,                                     *01536000
                   PROD_CODE_1,                                        *01537000
                   ACCT_NBR_1,                                         *01538000
                   MODEL,                                              *01539000
                   ACCT_INST_2,                                        *01540000
                   PROD_CODE_2,                                        *01541000
                   ACCT_NBR_2                                          *01542000
                 INTO :INST1,                                          *01543000
                   :PRDCDE1,                                           *01544000
                   :ACCTNBR1,                                          *01545000
                   :MODEL,                                             *01546000
                   :INST2,                                             *01547000
                   :PRDCDE2,                                           *01548000
                   :ACCTNBR2                                           *01549000
                 FROM SAH                                              *01550000
                 WHERE ACCT_INST_1 = :INST1 AND                        *01551000
                   PROD_CODE_1 = :PRDCDE1 AND                          *01552000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *01553000
                   MODEL = :MODEL AND                                  *01554000
                   ACCT_INST_2 = :INST2 AND                            *01555000
                   PROD_CODE_2 = :PRDCDE2 AND                          *01556000
                   ACCT_NBR_2 = :ACCTNBR2                              *01557000
                 FETCH FIRST 1 ROW ONLY                                 01558000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01559000
         BR    14                      RETURN TO CALLER                 01560000
         LTORG                                                          01561000
*                                                                       01562000
*                                                                       01563000
**********************************************************************  01564000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01565000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01566000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01567000
**********************************************************************  01568000
*                                                                       01569000
SQL#0033 DS    0H                                                       01570000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01571000
         LA    15,255                  SET RETURN CODE                  01572000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01573000
         BR    14                      RETURN TO CALLER                 01574000
         LTORG                                                          01575000
*                                                                       01576000
*                                                                       01577000
**********************************************************************  01578000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01579000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01580000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01581000
**********************************************************************  01582000
*                                                                       01583000
SQL#0034 DS    0H                                                       01584000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01585000
         LA    15,255                  SET RETURN CODE                  01586000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01587000
         BR    14                      RETURN TO CALLER                 01588000
         LTORG                                                          01589000
*                                                                       01590000
*                                                                       01591000
**********************************************************************  01592000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01593000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01594000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01595000
**********************************************************************  01596000
*                                                                       01597000
SQL#0035 DS    0H                                                       01598000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01599000
         LA    15,255                  SET RETURN CODE                  01600000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01601000
         BR    14                      RETURN TO CALLER                 01602000
         LTORG                                                          01603000
*                                                                       01604000
*                                                                       01605000
**********************************************************************  01606000
* INSERT STATEMENT:                                                     01607000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01608000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01609000
**********************************************************************  01610000
*                                                                       01611000
SQL#0036 DS    0H                                                       01612000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01613000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01614000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01615000
         EXEC  SQL                                                     *01616000
               INSERT INTO SAH                                         *01617000
                   (ACCT_INST_1,                                       *01618000
                    PROD_CODE_1,                                       *01619000
                    ACCT_NBR_1,                                        *01620000
                    MODEL,                                             *01621000
                    ACCT_INST_2,                                       *01622000
                    PROD_CODE_2,                                       *01623000
                    ACCT_NBR_2,                                        *01624000
                    AUDIT_DATE,                                        *01625000
                    AUDIT_TIME,                                        *01626000
                    AUDIT_USER,                                        *01627000
                    AUDIT_ORG,                                         *01628000
                    ACCT_STATUS,                                       *01629000
                    BRANCH,                                            *01630000
                    ACCT_TYPE,                                         *01631000
                    SVC_INCEN_OPT,                                     *01632000
                    RATE_INCEN_OPT,                                    *01633000
                    APPL_NBR,                                          *01634000
                    ACCT_BAL_1,                                        *01635000
                    ACCT_BAL_2,                                        *01636000
                    PRIMARY_BAL,                                       *01637000
                    ACCT_CMB_BAL_1,                                    *01638000
                    ACCT_CMB_BAL_2,                                    *01639000
                    ACCT_CMB_BAL_3,                                    *01640000
                    ACCT_CMB_BAL_4,                                    *01641000
                    CASH_BALANCE,                                      *01642000
                    ACCT_RATE_BAL,                                     *01643000
                    SVC_CHG_BAL,                                       *01644000
                    SEC_SVC_BAL,                                       *01645000
                    DISC_AMT_FLAG,                                     *01646000
                    DISC_PCT_FLAG,                                     *01647000
                    RATE_PCT_FLAG,                                     *01648000
                    DISC_AMT_OVRD,                                     *01649000
                    DISC_PCT_OVRD,                                     *01650000
                    RATE_PCT_OVRD,                                     *01651000
                    RSV_AREA)                                          *01652000
                  VALUES (:INST1,                                      *01653000
                   :PRDCDE1,                                           *01654000
                   :ACCTNBR1,                                          *01655000
                   :MODEL,                                             *01656000
                   :INST2,                                             *01657000
                   :PRDCDE2,                                           *01658000
                   :ACCTNBR2,                                          *01659000
                   :AUDDATE,                                           *01660000
                   :AUDTIME,                                           *01661000
                   :AUDUSER,                                           *01662000
                   :AUDORG,                                            *01663000
                   :ACCTST,                                            *01664000
                   :BRCH,                                              *01665000
                   :ACCTTYPE,                                          *01666000
                   :SCINCENO,                                          *01667000
                   :RINCENO,                                           *01668000
                   :APPLNBR,                                           *01669000
                   :ACCTBAL1,                                          *01670000
                   :ACCTBAL2,                                          *01671000
                   :PRIMEBAL,                                          *01672000
                   :ACMBBAL1,                                          *01673000
                   :ACMBBAL2,                                          *01674000
                   :ACMBBAL3,                                          *01675000
                   :ACMBBAL4,                                          *01676000
                   :CASHBAL,                                           *01677000
                   :ACCTRATE,                                          *01678000
                   :SCBAL,                                             *01679000
                   :SECSVBAL,                                          *01680000
                   :DAMTFLAG,                                          *01681000
                   :DPCTFLAG,                                          *01682000
                   :RPCTFLAG,                                          *01683000
                   :DAMTOVRD,                                          *01684000
                   :DPCTOVRD,                                          *01685000
                   :RPCTOVRD,                                          *01686000
                   :RAREA)                                              01687000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01688000
         BR    14                      RETURN TO CALLER                 01689000
         LTORG                                                          01690000
*                                                                       01691000
*                                                                       01692000
**********************************************************************  01693000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01694000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01695000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01696000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01697000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01698000
*     STATEMENT.                                                        01699000
**********************************************************************  01700000
*                                                                       01701000
SQL#0037 DS    0H                                                       01702000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01703000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01704000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01705000
         EXEC  SQL                                                     *01706000
               UPDATE SAH                                              *01707000
                   SET AUDIT_DATE = :AUDDATE,                          *01708000
                     AUDIT_TIME = :AUDTIME,                            *01709000
                     AUDIT_USER = :AUDUSER,                            *01710000
                     AUDIT_ORG = :AUDORG,                              *01711000
                     ACCT_STATUS = :ACCTST,                            *01712000
                     BRANCH = :BRCH,                                   *01713000
                     ACCT_TYPE = :ACCTTYPE,                            *01714000
                     SVC_INCEN_OPT = :SCINCENO,                        *01715000
                     RATE_INCEN_OPT = :RINCENO,                        *01716000
                     APPL_NBR = :APPLNBR,                              *01717000
                     ACCT_BAL_1 = :ACCTBAL1,                           *01718000
                     ACCT_BAL_2 = :ACCTBAL2,                           *01719000
                     PRIMARY_BAL = :PRIMEBAL,                          *01720000
                     ACCT_CMB_BAL_1 = :ACMBBAL1,                       *01721000
                     ACCT_CMB_BAL_2 = :ACMBBAL2,                       *01722000
                     ACCT_CMB_BAL_3 = :ACMBBAL3,                       *01723000
                     ACCT_CMB_BAL_4 = :ACMBBAL4,                       *01724000
                     CASH_BALANCE = :CASHBAL,                          *01725000
                     ACCT_RATE_BAL = :ACCTRATE,                        *01726000
                     SVC_CHG_BAL = :SCBAL,                             *01727000
                     SEC_SVC_BAL = :SECSVBAL,                          *01728000
                     DISC_AMT_FLAG = :DAMTFLAG,                        *01729000
                     DISC_PCT_FLAG = :DPCTFLAG,                        *01730000
                     RATE_PCT_FLAG = :RPCTFLAG,                        *01731000
                     DISC_AMT_OVRD = :DAMTOVRD,                        *01732000
                     DISC_PCT_OVRD = :DPCTOVRD,                        *01733000
                     RATE_PCT_OVRD = :RPCTOVRD,                        *01734000
                     RSV_AREA = :RAREA                                 *01735000
                 WHERE CURRENT OF SAHUPD0                               01736000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01737000
         BR    14                      RETURN TO CALLER                 01738000
         LTORG                                                          01739000
*                                                                       01740000
*                                                                       01741000
**********************************************************************  01742000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01743000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01744000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01745000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01746000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01747000
*     STATEMENT.                                                        01748000
**********************************************************************  01749000
*                                                                       01750000
SQL#0038 DS    0H                                                       01751000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01752000
         LA    15,255                  SET RETURN CODE                  01753000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01754000
         BR    14                      RETURN TO CALLER                 01755000
         LTORG                                                          01756000
*                                                                       01757000
*                                                                       01758000
**********************************************************************  01759000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01760000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01761000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01762000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01763000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01764000
*     STATEMENT.                                                        01765000
**********************************************************************  01766000
*                                                                       01767000
SQL#0039 DS    0H                                                       01768000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01769000
         LA    15,255                  SET RETURN CODE                  01770000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01771000
         BR    14                      RETURN TO CALLER                 01772000
         LTORG                                                          01773000
*                                                                       01774000
*                                                                       01775000
**********************************************************************  01776000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01777000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01778000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01779000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01780000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01781000
*     STATEMENT.                                                        01782000
**********************************************************************  01783000
*                                                                       01784000
SQL#0040 DS    0H                                                       01785000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01786000
         LA    15,255                  SET RETURN CODE                  01787000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01788000
         BR    14                      RETURN TO CALLER                 01789000
         LTORG                                                          01790000
*                                                                       01791000
*                                                                       01792000
**********************************************************************  01793000
* DELETE STATEMENT BY PRIMARY KEY:                                      01794000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01795000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01796000
**********************************************************************  01797000
*                                                                       01798000
SQL#0041 DS    0H                                                       01799000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01800000
         EXEC  SQL                                                     *01801000
               DELETE FROM SAH                                         *01802000
                 WHERE CURRENT OF SAHUPD0                               01803000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01804000
         BR    14                      RETURN TO CALLER                 01805000
         LTORG                                                          01806000
*                                                                       01807000
*                                                                       01808000
**********************************************************************  01809000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01810000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01811000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01812000
**********************************************************************  01813000
*                                                                       01814000
SQL#0042 DS    0H                                                       01815000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01816000
         LA    15,255                  SET RETURN CODE                  01817000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01818000
         BR    14                      RETURN TO CALLER                 01819000
         LTORG                                                          01820000
*                                                                       01821000
*                                                                       01822000
**********************************************************************  01823000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01824000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01825000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01826000
**********************************************************************  01827000
*                                                                       01828000
SQL#0043 DS    0H                                                       01829000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01830000
         LA    15,255                  SET RETURN CODE                  01831000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01832000
         BR    14                      RETURN TO CALLER                 01833000
         LTORG                                                          01834000
*                                                                       01835000
*                                                                       01836000
**********************************************************************  01837000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01838000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01839000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01840000
**********************************************************************  01841000
*                                                                       01842000
SQL#0044 DS    0H                                                       01843000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01844000
         LA    15,255                  SET RETURN CODE                  01845000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01846000
         BR    14                      RETURN TO CALLER                 01847000
         LTORG                                                          01848000
*                                                                       01849000
*                                                                       01850000
**********************************************************************  01851000
* DELETE ALL STATEMENT:                                                 01852000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01853000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01854000
**********************************************************************  01855000
*                                                                       01856000
SQL#0045 DS    0H                                                       01857000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01858000
         EXEC  SQL                                                     *01859000
               DELETE FROM SAH                                          01860000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01861000
         BR    14                      RETURN TO CALLER                 01862000
         LTORG                                                          01863000
*                                                                       01864000
*                                                                       01865000
**********************************************************************  01866000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01867000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01868000
**********************************************************************  01869000
*                                                                       01870000
SQL#0046 DS    0H                                                       01871000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01872000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01873000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01874000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01875000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01876000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01877000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01878000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01879000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01880000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01881000
VECT0046 DC    A(0)                                                     01882000
         DC    A(SQL#0246)                                              01883000
         DC    A(SQL#0346)                                              01884000
         DC    A(SQL#0446)                                              01885000
         DC    A(SQL#0546)                                              01886000
         DC    A(SQL#0646)                                              01887000
         DC    A(SQL#0746)                                              01888000
         LTORG                                                          01889000
*                                                                       01890000
SQL#0246 DS    0H                                                       01891000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01892000
         EXEC  SQL                                                     *01893000
               CLOSE SAHSQ001                                           01894000
         EXEC  SQL                                                     *01895000
               DECLARE SAHSQ002 CURSOR FOR                             *01896000
               SELECT ACCT_INST_1,                                     *01897000
                   PROD_CODE_1,                                        *01898000
                   ACCT_NBR_1,                                         *01899000
                   MODEL,                                              *01900000
                   ACCT_INST_2,                                        *01901000
                   PROD_CODE_2,                                        *01902000
                   ACCT_NBR_2,                                         *01903000
                   AUDIT_DATE,                                         *01904000
                   AUDIT_TIME,                                         *01905000
                   AUDIT_USER,                                         *01906000
                   AUDIT_ORG,                                          *01907000
                   ACCT_STATUS,                                        *01908000
                   BRANCH,                                             *01909000
                   ACCT_TYPE,                                          *01910000
                   SVC_INCEN_OPT,                                      *01911000
                   RATE_INCEN_OPT,                                     *01912000
                   APPL_NBR,                                           *01913000
                   ACCT_BAL_1,                                         *01914000
                   ACCT_BAL_2,                                         *01915000
                   PRIMARY_BAL,                                        *01916000
                   ACCT_CMB_BAL_1,                                     *01917000
                   ACCT_CMB_BAL_2,                                     *01918000
                   ACCT_CMB_BAL_3,                                     *01919000
                   ACCT_CMB_BAL_4,                                     *01920000
                   CASH_BALANCE,                                       *01921000
                   ACCT_RATE_BAL,                                      *01922000
                   SVC_CHG_BAL,                                        *01923000
                   SEC_SVC_BAL,                                        *01924000
                   DISC_AMT_FLAG,                                      *01925000
                   DISC_PCT_FLAG,                                      *01926000
                   RATE_PCT_FLAG,                                      *01927000
                   DISC_AMT_OVRD,                                      *01928000
                   DISC_PCT_OVRD,                                      *01929000
                   RATE_PCT_OVRD,                                      *01930000
                   RSV_AREA                                            *01931000
                 FROM SAH                                              *01932000
                 WHERE                                                 *01933000
                    ACCT_INST_1 = :INST1 AND                           *01934000
                    PROD_CODE_1 = :PRDCDE1 AND                         *01935000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *01936000
                    MODEL = :MODEL AND                                 *01937000
                    ACCT_INST_2 = :INST2 AND                           *01938000
                    PROD_CODE_2 > :PRDCDE2                             *01939000
                 ORDER BY PROD_CODE_2,                                 *01940000
                   ACCT_NBR_2                                          *01941000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01942000
         EXEC  SQL                                                     *01943000
               OPEN SAHSQ002                                            01944000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01945000
         BNZ   *+8                     NO - RETURN ERROR                01946000
         LR    12,9                    LOAD RETURN ADDRESS              01947000
         BR    12                      RETURN TO FETCH ROUTINE          01948000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01949000
         BR    14                      RETURN TO CALLER                 01950000
         LTORG                                                          01951000
*                                                                       01952000
SQL#0346 DS    0H                                                       01953000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01954000
         EXEC  SQL                                                     *01955000
               CLOSE SAHSQ002                                           01956000
         EXEC  SQL                                                     *01957000
               DECLARE SAHSQ003 CURSOR FOR                             *01958000
               SELECT ACCT_INST_1,                                     *01959000
                   PROD_CODE_1,                                        *01960000
                   ACCT_NBR_1,                                         *01961000
                   MODEL,                                              *01962000
                   ACCT_INST_2,                                        *01963000
                   PROD_CODE_2,                                        *01964000
                   ACCT_NBR_2,                                         *01965000
                   AUDIT_DATE,                                         *01966000
                   AUDIT_TIME,                                         *01967000
                   AUDIT_USER,                                         *01968000
                   AUDIT_ORG,                                          *01969000
                   ACCT_STATUS,                                        *01970000
                   BRANCH,                                             *01971000
                   ACCT_TYPE,                                          *01972000
                   SVC_INCEN_OPT,                                      *01973000
                   RATE_INCEN_OPT,                                     *01974000
                   APPL_NBR,                                           *01975000
                   ACCT_BAL_1,                                         *01976000
                   ACCT_BAL_2,                                         *01977000
                   PRIMARY_BAL,                                        *01978000
                   ACCT_CMB_BAL_1,                                     *01979000
                   ACCT_CMB_BAL_2,                                     *01980000
                   ACCT_CMB_BAL_3,                                     *01981000
                   ACCT_CMB_BAL_4,                                     *01982000
                   CASH_BALANCE,                                       *01983000
                   ACCT_RATE_BAL,                                      *01984000
                   SVC_CHG_BAL,                                        *01985000
                   SEC_SVC_BAL,                                        *01986000
                   DISC_AMT_FLAG,                                      *01987000
                   DISC_PCT_FLAG,                                      *01988000
                   RATE_PCT_FLAG,                                      *01989000
                   DISC_AMT_OVRD,                                      *01990000
                   DISC_PCT_OVRD,                                      *01991000
                   RATE_PCT_OVRD,                                      *01992000
                   RSV_AREA                                            *01993000
                 FROM SAH                                              *01994000
                 WHERE                                                 *01995000
                    ACCT_INST_1 = :INST1 AND                           *01996000
                    PROD_CODE_1 = :PRDCDE1 AND                         *01997000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *01998000
                    MODEL = :MODEL AND                                 *01999000
                    ACCT_INST_2 > :INST2                               *02000000
                 ORDER BY ACCT_INST_2,                                 *02001000
                   PROD_CODE_2,                                        *02002000
                   ACCT_NBR_2                                          *02003000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02004000
         EXEC  SQL                                                     *02005000
               OPEN SAHSQ003                                            02006000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02007000
         BNZ   *+8                     NO - RETURN ERROR                02008000
         LR    12,9                    LOAD RETURN ADDRESS              02009000
         BR    12                      RETURN TO FETCH ROUTINE          02010000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02011000
         BR    14                      RETURN TO CALLER                 02012000
         LTORG                                                          02013000
*                                                                       02014000
SQL#0446 DS    0H                                                       02015000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          02016000
         EXEC  SQL                                                     *02017000
               CLOSE SAHSQ003                                           02018000
         EXEC  SQL                                                     *02019000
               DECLARE SAHSQ004 CURSOR FOR                             *02020000
               SELECT ACCT_INST_1,                                     *02021000
                   PROD_CODE_1,                                        *02022000
                   ACCT_NBR_1,                                         *02023000
                   MODEL,                                              *02024000
                   ACCT_INST_2,                                        *02025000
                   PROD_CODE_2,                                        *02026000
                   ACCT_NBR_2,                                         *02027000
                   AUDIT_DATE,                                         *02028000
                   AUDIT_TIME,                                         *02029000
                   AUDIT_USER,                                         *02030000
                   AUDIT_ORG,                                          *02031000
                   ACCT_STATUS,                                        *02032000
                   BRANCH,                                             *02033000
                   ACCT_TYPE,                                          *02034000
                   SVC_INCEN_OPT,                                      *02035000
                   RATE_INCEN_OPT,                                     *02036000
                   APPL_NBR,                                           *02037000
                   ACCT_BAL_1,                                         *02038000
                   ACCT_BAL_2,                                         *02039000
                   PRIMARY_BAL,                                        *02040000
                   ACCT_CMB_BAL_1,                                     *02041000
                   ACCT_CMB_BAL_2,                                     *02042000
                   ACCT_CMB_BAL_3,                                     *02043000
                   ACCT_CMB_BAL_4,                                     *02044000
                   CASH_BALANCE,                                       *02045000
                   ACCT_RATE_BAL,                                      *02046000
                   SVC_CHG_BAL,                                        *02047000
                   SEC_SVC_BAL,                                        *02048000
                   DISC_AMT_FLAG,                                      *02049000
                   DISC_PCT_FLAG,                                      *02050000
                   RATE_PCT_FLAG,                                      *02051000
                   DISC_AMT_OVRD,                                      *02052000
                   DISC_PCT_OVRD,                                      *02053000
                   RATE_PCT_OVRD,                                      *02054000
                   RSV_AREA                                            *02055000
                 FROM SAH                                              *02056000
                 WHERE                                                 *02057000
                    ACCT_INST_1 = :INST1 AND                           *02058000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02059000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02060000
                    MODEL > :MODEL                                     *02061000
                 ORDER BY MODEL,                                       *02062000
                   ACCT_INST_2,                                        *02063000
                   PROD_CODE_2,                                        *02064000
                   ACCT_NBR_2                                          *02065000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02066000
         EXEC  SQL                                                     *02067000
               OPEN SAHSQ004                                            02068000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02069000
         BNZ   *+8                     NO - RETURN ERROR                02070000
         LR    12,9                    LOAD RETURN ADDRESS              02071000
         BR    12                      RETURN TO FETCH ROUTINE          02072000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02073000
         BR    14                      RETURN TO CALLER                 02074000
         LTORG                                                          02075000
*                                                                       02076000
SQL#0546 DS    0H                                                       02077000
         USING SQL#0546,12             ESTABLISH BASE REGISTER          02078000
         EXEC  SQL                                                     *02079000
               CLOSE SAHSQ004                                           02080000
         EXEC  SQL                                                     *02081000
               DECLARE SAHSQ005 CURSOR FOR                             *02082000
               SELECT ACCT_INST_1,                                     *02083000
                   PROD_CODE_1,                                        *02084000
                   ACCT_NBR_1,                                         *02085000
                   MODEL,                                              *02086000
                   ACCT_INST_2,                                        *02087000
                   PROD_CODE_2,                                        *02088000
                   ACCT_NBR_2,                                         *02089000
                   AUDIT_DATE,                                         *02090000
                   AUDIT_TIME,                                         *02091000
                   AUDIT_USER,                                         *02092000
                   AUDIT_ORG,                                          *02093000
                   ACCT_STATUS,                                        *02094000
                   BRANCH,                                             *02095000
                   ACCT_TYPE,                                          *02096000
                   SVC_INCEN_OPT,                                      *02097000
                   RATE_INCEN_OPT,                                     *02098000
                   APPL_NBR,                                           *02099000
                   ACCT_BAL_1,                                         *02100000
                   ACCT_BAL_2,                                         *02101000
                   PRIMARY_BAL,                                        *02102000
                   ACCT_CMB_BAL_1,                                     *02103000
                   ACCT_CMB_BAL_2,                                     *02104000
                   ACCT_CMB_BAL_3,                                     *02105000
                   ACCT_CMB_BAL_4,                                     *02106000
                   CASH_BALANCE,                                       *02107000
                   ACCT_RATE_BAL,                                      *02108000
                   SVC_CHG_BAL,                                        *02109000
                   SEC_SVC_BAL,                                        *02110000
                   DISC_AMT_FLAG,                                      *02111000
                   DISC_PCT_FLAG,                                      *02112000
                   RATE_PCT_FLAG,                                      *02113000
                   DISC_AMT_OVRD,                                      *02114000
                   DISC_PCT_OVRD,                                      *02115000
                   RATE_PCT_OVRD,                                      *02116000
                   RSV_AREA                                            *02117000
                 FROM SAH                                              *02118000
                 WHERE                                                 *02119000
                    ACCT_INST_1 = :INST1 AND                           *02120000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02121000
                    ACCT_NBR_1 > :ACCTNBR1                             *02122000
                 ORDER BY ACCT_NBR_1,                                  *02123000
                   MODEL,                                              *02124000
                   ACCT_INST_2,                                        *02125000
                   PROD_CODE_2,                                        *02126000
                   ACCT_NBR_2                                          *02127000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02128000
         EXEC  SQL                                                     *02129000
               OPEN SAHSQ005                                            02130000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02131000
         BNZ   *+8                     NO - RETURN ERROR                02132000
         LR    12,9                    LOAD RETURN ADDRESS              02133000
         BR    12                      RETURN TO FETCH ROUTINE          02134000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02135000
         BR    14                      RETURN TO CALLER                 02136000
         LTORG                                                          02137000
*                                                                       02138000
SQL#0646 DS    0H                                                       02139000
         USING SQL#0646,12             ESTABLISH BASE REGISTER          02140000
         EXEC  SQL                                                     *02141000
               CLOSE SAHSQ005                                           02142000
         EXEC  SQL                                                     *02143000
               DECLARE SAHSQ006 CURSOR FOR                             *02144000
               SELECT ACCT_INST_1,                                     *02145000
                   PROD_CODE_1,                                        *02146000
                   ACCT_NBR_1,                                         *02147000
                   MODEL,                                              *02148000
                   ACCT_INST_2,                                        *02149000
                   PROD_CODE_2,                                        *02150000
                   ACCT_NBR_2,                                         *02151000
                   AUDIT_DATE,                                         *02152000
                   AUDIT_TIME,                                         *02153000
                   AUDIT_USER,                                         *02154000
                   AUDIT_ORG,                                          *02155000
                   ACCT_STATUS,                                        *02156000
                   BRANCH,                                             *02157000
                   ACCT_TYPE,                                          *02158000
                   SVC_INCEN_OPT,                                      *02159000
                   RATE_INCEN_OPT,                                     *02160000
                   APPL_NBR,                                           *02161000
                   ACCT_BAL_1,                                         *02162000
                   ACCT_BAL_2,                                         *02163000
                   PRIMARY_BAL,                                        *02164000
                   ACCT_CMB_BAL_1,                                     *02165000
                   ACCT_CMB_BAL_2,                                     *02166000
                   ACCT_CMB_BAL_3,                                     *02167000
                   ACCT_CMB_BAL_4,                                     *02168000
                   CASH_BALANCE,                                       *02169000
                   ACCT_RATE_BAL,                                      *02170000
                   SVC_CHG_BAL,                                        *02171000
                   SEC_SVC_BAL,                                        *02172000
                   DISC_AMT_FLAG,                                      *02173000
                   DISC_PCT_FLAG,                                      *02174000
                   RATE_PCT_FLAG,                                      *02175000
                   DISC_AMT_OVRD,                                      *02176000
                   DISC_PCT_OVRD,                                      *02177000
                   RATE_PCT_OVRD,                                      *02178000
                   RSV_AREA                                            *02179000
                 FROM SAH                                              *02180000
                 WHERE                                                 *02181000
                    ACCT_INST_1 = :INST1 AND                           *02182000
                    PROD_CODE_1 > :PRDCDE1                             *02183000
                 ORDER BY PROD_CODE_1,                                 *02184000
                   ACCT_NBR_1,                                         *02185000
                   MODEL,                                              *02186000
                   ACCT_INST_2,                                        *02187000
                   PROD_CODE_2,                                        *02188000
                   ACCT_NBR_2                                          *02189000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02190000
         EXEC  SQL                                                     *02191000
               OPEN SAHSQ006                                            02192000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02193000
         BNZ   *+8                     NO - RETURN ERROR                02194000
         LR    12,9                    LOAD RETURN ADDRESS              02195000
         BR    12                      RETURN TO FETCH ROUTINE          02196000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02197000
         BR    14                      RETURN TO CALLER                 02198000
         LTORG                                                          02199000
*                                                                       02200000
SQL#0746 DS    0H                                                       02201000
         USING SQL#0746,12             ESTABLISH BASE REGISTER          02202000
         EXEC  SQL                                                     *02203000
               CLOSE SAHSQ006                                           02204000
         EXEC  SQL                                                     *02205000
               DECLARE SAHSQ007 CURSOR FOR                             *02206000
               SELECT ACCT_INST_1,                                     *02207000
                   PROD_CODE_1,                                        *02208000
                   ACCT_NBR_1,                                         *02209000
                   MODEL,                                              *02210000
                   ACCT_INST_2,                                        *02211000
                   PROD_CODE_2,                                        *02212000
                   ACCT_NBR_2,                                         *02213000
                   AUDIT_DATE,                                         *02214000
                   AUDIT_TIME,                                         *02215000
                   AUDIT_USER,                                         *02216000
                   AUDIT_ORG,                                          *02217000
                   ACCT_STATUS,                                        *02218000
                   BRANCH,                                             *02219000
                   ACCT_TYPE,                                          *02220000
                   SVC_INCEN_OPT,                                      *02221000
                   RATE_INCEN_OPT,                                     *02222000
                   APPL_NBR,                                           *02223000
                   ACCT_BAL_1,                                         *02224000
                   ACCT_BAL_2,                                         *02225000
                   PRIMARY_BAL,                                        *02226000
                   ACCT_CMB_BAL_1,                                     *02227000
                   ACCT_CMB_BAL_2,                                     *02228000
                   ACCT_CMB_BAL_3,                                     *02229000
                   ACCT_CMB_BAL_4,                                     *02230000
                   CASH_BALANCE,                                       *02231000
                   ACCT_RATE_BAL,                                      *02232000
                   SVC_CHG_BAL,                                        *02233000
                   SEC_SVC_BAL,                                        *02234000
                   DISC_AMT_FLAG,                                      *02235000
                   DISC_PCT_FLAG,                                      *02236000
                   RATE_PCT_FLAG,                                      *02237000
                   DISC_AMT_OVRD,                                      *02238000
                   DISC_PCT_OVRD,                                      *02239000
                   RATE_PCT_OVRD,                                      *02240000
                   RSV_AREA                                            *02241000
                 FROM SAH                                              *02242000
                 WHERE                                                 *02243000
                    ACCT_INST_1 > :INST1                               *02244000
                 ORDER BY ACCT_INST_1,                                 *02245000
                   PROD_CODE_1,                                        *02246000
                   ACCT_NBR_1,                                         *02247000
                   MODEL,                                              *02248000
                   ACCT_INST_2,                                        *02249000
                   PROD_CODE_2,                                        *02250000
                   ACCT_NBR_2                                          *02251000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02252000
         EXEC  SQL                                                     *02253000
               OPEN SAHSQ007                                            02254000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02255000
         BNZ   *+8                     NO - RETURN ERROR                02256000
         LR    12,9                    LOAD RETURN ADDRESS              02257000
         BR    12                      RETURN TO FETCH ROUTINE          02258000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02259000
         BR    14                      RETURN TO CALLER                 02260000
         LTORG                                                          02261000
*                                                                       02262000
*                                                                       02263000
**********************************************************************  02264000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02265000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02266000
**********************************************************************  02267000
*                                                                       02268000
SQL#0047 DS    0H                                                       02269000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02270000
         LA    15,255                  SET RETURN CODE                  02271000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02272000
         BR    14                      RETURN TO CALLER                 02273000
         LTORG                                                          02274000
*                                                                       02275000
*                                                                       02276000
**********************************************************************  02277000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02278000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02279000
**********************************************************************  02280000
*                                                                       02281000
SQL#0048 DS    0H                                                       02282000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02283000
         LA    15,255                  SET RETURN CODE                  02284000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02285000
         BR    14                      RETURN TO CALLER                 02286000
         LTORG                                                          02287000
*                                                                       02288000
*                                                                       02289000
**********************************************************************  02290000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02291000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02292000
**********************************************************************  02293000
*                                                                       02294000
SQL#0049 DS    0H                                                       02295000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02296000
         LA    15,255                  SET RETURN CODE                  02297000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02298000
         BR    14                      RETURN TO CALLER                 02299000
         LTORG                                                          02300000
*                                                                       02301000
         DS    0H                      END OF SQL STATEMENTS            02302000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02303000
*                                                                       02304000
*                                                                       02305000
**********************************************************************  02306000
* DUMMY ENTRY POINT DSNHLI                                              02307000
*   MUST NOT BE MODIFIED.                                               02308000
**********************************************************************  02309000
*                                                                       02310000
         ENTRY DSNHLI                                                   02311000
DSNHLI   DS    0H                                                       02312000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02313000
         BR    15                      BRANCH TO ATTACH FACILITY        02314000
*                                                                       02315000
*                                                                       02316000
**********************************************************************  02317000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02318000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02319000
*   MUST NOT BE MODIFIED.                                               02320000
**********************************************************************  02321000
*                                                                       02322000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02323000
CONV#RTN AMODE ANY                                                      02324000
CONV#RTN RMODE ANY                                                      02325000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02326000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02327000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02328000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02329000
         BER   4                         YES - RETURN TO SQL            02330000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02331000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02332000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02333000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02334000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02335000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02336000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02337000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02338000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02339000
*                                                                       02340000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02341000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02342000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02343000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02344000
         BER   4                         YES - RETURN TO SQL            02345000
         SLR   0,0                     CLEAR FOR INSERT                 02346000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02347000
         NR    0,3                     FOR THE CURRENT KEY?             02348000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02349000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02350000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02351000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02352000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02353000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02354000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02355000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02356000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02357000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02358000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02359000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02360000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02361000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02362000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02363000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02364000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02365000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02366000
*                                                                       02367000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02368000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02369000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02370000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02371000
         BER   4                         YES - RETURN TO SQL            02372000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02373000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02374000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02375000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02376000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02377000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02378000
         MVCL  0,14                    MOVE TO RECORD AREA              02379000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02380000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02381000
*                                                                       02382000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02383000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02384000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02385000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02386000
         BER   4                         YES - RETURN TO SQL            02387000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02388000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02389000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02390000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02391000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02392000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02393000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02394000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02395000
         MVCL  0,14                    MOVE TO RECORD AREA              02396000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02397000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02398000
*                                                                       02399000
*                                                                       02400000
**********************************************************************  02401000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02402000
*   MUST NOT BE MODIFIED.                                               02403000
**********************************************************************  02404000
*                                                                       02405000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02406000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02407000
         DC    H'0066'                 LENGTH TO MOVE                   02408000
         DC    X'80'                   80 = KEY 0 FIELD                 02409000
*                                      40 = KEY 1 FIELD                 02410000
*                                      20 = KEY 2 FIELD                 02411000
*                                      10 = KEY 3 FIELD                 02412000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02413000
*                                                                       02414000
*                                      REST OF FIELD ENTRIES            02415000
         DC    H'0066',H'0066',H'0180',X'00',X'00'                      02416000
         DC    8X'FF'                  END OF FIELD ENTRIES             02417000
         LTORG                                                          02418000
         END                                                            02419000
