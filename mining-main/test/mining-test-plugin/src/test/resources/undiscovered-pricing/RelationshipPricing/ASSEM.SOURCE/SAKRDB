**********************************************************************  00001000
*                                                                       00002000
*  SAKRDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAK TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST1    DS    CL4                                                      00050000
PRDCDE1  DS    CL6                                                      00051000
ACCTNBR1 DS    CL18                                                     00052000
MODEL1   DS    CL10                                                     00053000
INST2    DS    CL4                                                      00054000
PRDCDE2  DS    CL6                                                      00055000
ACCTNBR2 DS    CL18                                                     00056000
AUDDATE  DS    PL5'0.'                                                  00057000
AUDTIME  DS    PL5'0.'                                                  00058000
AUDUSER  DS    CL8                                                      00059000
AUDORG   DS    CL6                                                      00060000
IDNBR    DS    CL18                                                     00061000
BALOPT   DS    CL1                                                      00062000
PCTUSED  DS    PL5'0.000000000'                                         00063000
LCMBUSED DS    PL8'0.00'                                                00064000
FREQ     DS    CL1                                                      00065000
TERM     DS    PL2'0.'                                                  00066000
DAYMTH   DS    CL2                                                      00067000
NEXTDATE DS    PL5'0.'                                                  00068000
LASTDATE DS    PL5'0.'                                                  00069000
AMT      DS    PL6'0.00'                                                00070000
LASTAMT  DS    PL6'0.00'                                                00071000
AMTYTD   DS    PL8'0.00'                                                00072000
CMBBAL01 DS    PL8'0.00'                                                00073000
CMBBAL02 DS    PL8'0.00'                                                00074000
CMBBAL03 DS    PL8'0.00'                                                00075000
CMBBAL04 DS    PL8'0.00'                                                00076000
CMBBAL05 DS    PL8'0.00'                                                00077000
CMBBAL06 DS    PL8'0.00'                                                00078000
CMBBAL07 DS    PL8'0.00'                                                00079000
CMBBAL08 DS    PL8'0.00'                                                00080000
CMBBAL09 DS    PL8'0.00'                                                00081000
CMBBAL10 DS    PL8'0.00'                                                00082000
CMBBAL11 DS    PL8'0.00'                                                00083000
CMBBAL12 DS    PL8'0.00'                                                00084000
DATEOPN  DS    PL5'0.'                                                  00085000
RAREA    DS    CL45                                                     00086000
*                                                                       00087000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00088000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00089000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00090000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00091000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00092000
         DS    CL97                    RESERVED                         00093000
*                                                                       00094000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00095000
INDVARX  DS    0H                                                       00096000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00097000
*                                                                       00098000
*                                                                       00099000
**********************************************************************  00100000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00101000
**********************************************************************  00102000
*                                                                       00103000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00104000
*                                                                       00105000
**********************************************************************  00106000
* PROGRAM TABLE HEADER SECTION:                                         00107000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00108000
**********************************************************************  00109000
*                                                                       00110000
SAKRDB   CSECT                         PROGRAM TABLE SECTION            00111000
SAKRDB   AMODE ANY                                                      00112000
SAKRDB   RMODE ANY                                                      00113000
         DC    CL8'SAKRDB  '           PROGRAM ID                       00114000
         DC    CL1' '                                                   00115000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00116000
         DC    CL1' '                                                   00117000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00118000
         DC    CL1' '                                                   00119000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00120000
         DC    5A(0)                   RESERVED                         00121000
         DC    AL2(0)                  RESERVED                         00122000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00123000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00124000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00125000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00126000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00127000
         DC    CL29'WWW.INFOR.COM                '                      00127001
*                                                                       00128000
**********************************************************************  00129000
* STATEMENT TABLE SECTION:                                              00130000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00131000
**********************************************************************  00132000
*                                                                       00133000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00134000
STM#TAB  AMODE ANY                                                      00135000
STM#TAB  RMODE ANY                                                      00136000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00137000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00138000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00139000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00140000
         DC    12A(0)                  UDB MODULE VECTORS               00141000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00142000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00143000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00144000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00145000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00146000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00147000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00148000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00149000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00150000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00151000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00152000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00153000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00154000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00155000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00156000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00157000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00158000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00159000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00160000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00161000
         DC    10A(0)                  UDB MODULE VECTORS               00162000
         DC    4X'FF'                                                   00163000
*                                                                       00164000
**********************************************************************  00165000
* SQL STATEMENT SECTION:                                                00166000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00167000
*     TO SUPPORT THIS TABLE.                                            00168000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00169000
*     ARE EQUIVALENT.                                                   00170000
**********************************************************************  00171000
*                                                                       00172000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00173000
SQL#STMT AMODE ANY                                                      00174000
SQL#STMT RMODE ANY                                                      00175000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00176000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00177000
         USING COM#AREA,11             ADDRESS COMMAREA                 00178000
*                                                                       00179000
**********************************************************************  00180000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00181000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00182000
**********************************************************************  00183000
*                                                                       00184000
SELIN0   DS    0H                                                       00185000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00186000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00187000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00188000
         BALR  14,15                   MOVE REQUESTED DATA              00189000
         EXEC  SQL SELECT                                              *00190000
                   AUDIT_DATE,                                         *00191000
                   AUDIT_TIME,                                         *00192000
                   AUDIT_USER,                                         *00193000
                   AUDIT_ORG,                                          *00194000
                   IDENT_NBR,                                          *00195000
                   BAL_OPT,                                            *00196000
                   PCT_USED,                                           *00197000
                   LST_CMB_BAL_USE,                                    *00198000
                   FREQUENCY,                                          *00199000
                   TERM,                                               *00200000
                   DAY_MONTH,                                          *00201000
                   NEXT_DATE,                                          *00202000
                   LAST_DATE,                                          *00203000
                   AMOUNT,                                             *00204000
                   LAST_AMT,                                           *00205000
                   AMOUNT_YTD,                                         *00206000
                   MTH_CMB_BAL_01,                                     *00207000
                   MTH_CMB_BAL_02,                                     *00208000
                   MTH_CMB_BAL_03,                                     *00209000
                   MTH_CMB_BAL_04,                                     *00210000
                   MTH_CMB_BAL_05,                                     *00211000
                   MTH_CMB_BAL_06,                                     *00212000
                   MTH_CMB_BAL_07,                                     *00213000
                   MTH_CMB_BAL_08,                                     *00214000
                   MTH_CMB_BAL_09,                                     *00215000
                   MTH_CMB_BAL_10,                                     *00216000
                   MTH_CMB_BAL_11,                                     *00217000
                   MTH_CMB_BAL_12,                                     *00218000
                   DATE_OPEN,                                          *00219000
                   RSV_AREA                                            *00220000
                 INTO                                                  *00221000
                   :AUDDATE,                                           *00222000
                   :AUDTIME,                                           *00223000
                   :AUDUSER,                                           *00224000
                   :AUDORG,                                            *00225000
                   :IDNBR,                                             *00226000
                   :BALOPT,                                            *00227000
                   :PCTUSED,                                           *00228000
                   :LCMBUSED,                                          *00229000
                   :FREQ,                                              *00230000
                   :TERM,                                              *00231000
                   :DAYMTH,                                            *00232000
                   :NEXTDATE,                                          *00233000
                   :LASTDATE,                                          *00234000
                   :AMT,                                               *00235000
                   :LASTAMT,                                           *00236000
                   :AMTYTD,                                            *00237000
                   :CMBBAL01,                                          *00238000
                   :CMBBAL02,                                          *00239000
                   :CMBBAL03,                                          *00240000
                   :CMBBAL04,                                          *00241000
                   :CMBBAL05,                                          *00242000
                   :CMBBAL06,                                          *00243000
                   :CMBBAL07,                                          *00244000
                   :CMBBAL08,                                          *00245000
                   :CMBBAL09,                                          *00246000
                   :CMBBAL10,                                          *00247000
                   :CMBBAL11,                                          *00248000
                   :CMBBAL12,                                          *00249000
                   :DATEOPN,                                           *00250000
                   :RAREA                                              *00251000
                 FROM SAK                                              *00252000
                 WHERE                                                 *00253000
                   ACCT_INST_1 = :INST1 AND                            *00254000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00255000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00256000
                   MODEL_1 = :MODEL1 AND                               *00257000
                   ACCT_INST_2 = :INST2 AND                            *00258000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00259000
                   ACCT_NBR_2 = :ACCTNBR2                              *00260000
                 FETCH FIRST 1 ROW ONLY                                 00261000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00262000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00263000
         BALR  14,15                   MOVE REQUESTED DATA              00264000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00265000
         BR    14                      RETURN TO CALLER                 00266000
         LTORG                                                          00267000
*                                                                       00268000
**********************************************************************  00269000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00270000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00271000
**********************************************************************  00272000
*                                                                       00273000
SELKY0   DS    0H                                                       00274000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00275000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00276000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00277000
         BALR  14,15                   MOVE REQUESTED DATA              00278000
         EXEC  SQL SELECT                                              *00279000
                   COUNT(*)                                            *00280000
                 INTO                                                  *00281000
                   :SQWINTHV                                           *00282000
                 FROM SAK                                              *00283000
                 WHERE                                                 *00284000
                   ACCT_INST_1 = :INST1 AND                            *00285000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00286000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00287000
                   MODEL_1 = :MODEL1 AND                               *00288000
                   ACCT_INST_2 = :INST2 AND                            *00289000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00290000
                   ACCT_NBR_2 = :ACCTNBR2                              *00291000
                 FETCH FIRST 1 ROW ONLY                                 00292000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00293000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00294000
         BNER  14                      NO - RETURN TO CALLER            00295000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00296000
         BNER  14                      YES - RETURN ZERO SQLCODE        00297000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00298000
         BR    14                      RETURN TO CALLER                 00299000
         LTORG                                                          00300000
*                                                                       00301000
**********************************************************************  00302000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00303000
* KEY:                                                                  00304000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00305000
*     AND GET-NEXT-LOCK VERBS.                                          00306000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00307000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00308000
**********************************************************************  00309000
*                                                                       00310000
SELXC0   DS    0H                                                       00311000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00312000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00313000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00314000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00315000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00316000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00317000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00318000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00319000
SELXC0P  DC    A(SELGE001)                                              00320000
         DC    (KY0COLMS-01)A(0)                                        00321000
         DC    A(SELGE002)                                              00322000
         DC    (KY0COLMS-02)A(0)                                        00323000
         DC    A(SELGE003)                                              00324000
         DC    (KY0COLMS-03)A(0)                                        00325000
         DC    A(SELGE004)                                              00326000
         DC    (KY0COLMS-04)A(0)                                        00327000
         DC    A(SELGE005)                                              00328000
         DC    (KY0COLMS-05)A(0)                                        00329000
         DC    A(SELGE006)                                              00330000
         DC    (KY0COLMS-06)A(0)                                        00331000
         DC    A(SELGE007)                                              00332000
         LTORG                                                          00333000
*                                                                       00334000
SELGE001 DS    0H                                                       00335000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00336000
         EXEC  SQL DECLARE SAKGE001 CURSOR                             *00337000
               WITH ROWSET POSITIONING                                 *00338000
               FOR SELECT                                              *00339000
                   ACCT_INST_1,                                        *00340000
                   PROD_CODE_1,                                        *00341000
                   ACCT_NBR_1,                                         *00342000
                   MODEL_1,                                            *00343000
                   ACCT_INST_2,                                        *00344000
                   PROD_CODE_2,                                        *00345000
                   ACCT_NBR_2,                                         *00346000
                   AUDIT_DATE,                                         *00347000
                   AUDIT_TIME,                                         *00348000
                   AUDIT_USER,                                         *00349000
                   AUDIT_ORG,                                          *00350000
                   IDENT_NBR,                                          *00351000
                   BAL_OPT,                                            *00352000
                   PCT_USED,                                           *00353000
                   LST_CMB_BAL_USE,                                    *00354000
                   FREQUENCY,                                          *00355000
                   TERM,                                               *00356000
                   DAY_MONTH,                                          *00357000
                   NEXT_DATE,                                          *00358000
                   LAST_DATE,                                          *00359000
                   AMOUNT,                                             *00360000
                   LAST_AMT,                                           *00361000
                   AMOUNT_YTD,                                         *00362000
                   MTH_CMB_BAL_01,                                     *00363000
                   MTH_CMB_BAL_02,                                     *00364000
                   MTH_CMB_BAL_03,                                     *00365000
                   MTH_CMB_BAL_04,                                     *00366000
                   MTH_CMB_BAL_05,                                     *00367000
                   MTH_CMB_BAL_06,                                     *00368000
                   MTH_CMB_BAL_07,                                     *00369000
                   MTH_CMB_BAL_08,                                     *00370000
                   MTH_CMB_BAL_09,                                     *00371000
                   MTH_CMB_BAL_10,                                     *00372000
                   MTH_CMB_BAL_11,                                     *00373000
                   MTH_CMB_BAL_12,                                     *00374000
                   DATE_OPEN,                                          *00375000
                   RSV_AREA                                            *00376000
                 FROM SAK                                              *00377000
                 WHERE                                                 *00378000
                   ACCT_INST_1 = :INST1 AND                            *00379000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00380000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00381000
                   MODEL_1 = :MODEL1 AND                               *00382000
                   ACCT_INST_2 = :INST2 AND                            *00383000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00384000
                   ACCT_NBR_2 >=                                       *00385000
                     :ACCTNBR2                                         *00386000
                 ORDER BY ACCT_NBR_2 ASC                               *00387000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00388000
         EXEC  SQL OPEN SAKGE001                                        00389000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00390000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00391000
         BR    14                      RETURN TO CALLER                 00392000
         LTORG                                                          00393000
*                                                                       00394000
SELGE002 DS    0H                                                       00395000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00396000
         EXEC  SQL DECLARE SAKGE002 CURSOR                             *00397000
               WITH ROWSET POSITIONING                                 *00398000
               FOR SELECT                                              *00399000
                   ACCT_INST_1,                                        *00400000
                   PROD_CODE_1,                                        *00401000
                   ACCT_NBR_1,                                         *00402000
                   MODEL_1,                                            *00403000
                   ACCT_INST_2,                                        *00404000
                   PROD_CODE_2,                                        *00405000
                   ACCT_NBR_2,                                         *00406000
                   AUDIT_DATE,                                         *00407000
                   AUDIT_TIME,                                         *00408000
                   AUDIT_USER,                                         *00409000
                   AUDIT_ORG,                                          *00410000
                   IDENT_NBR,                                          *00411000
                   BAL_OPT,                                            *00412000
                   PCT_USED,                                           *00413000
                   LST_CMB_BAL_USE,                                    *00414000
                   FREQUENCY,                                          *00415000
                   TERM,                                               *00416000
                   DAY_MONTH,                                          *00417000
                   NEXT_DATE,                                          *00418000
                   LAST_DATE,                                          *00419000
                   AMOUNT,                                             *00420000
                   LAST_AMT,                                           *00421000
                   AMOUNT_YTD,                                         *00422000
                   MTH_CMB_BAL_01,                                     *00423000
                   MTH_CMB_BAL_02,                                     *00424000
                   MTH_CMB_BAL_03,                                     *00425000
                   MTH_CMB_BAL_04,                                     *00426000
                   MTH_CMB_BAL_05,                                     *00427000
                   MTH_CMB_BAL_06,                                     *00428000
                   MTH_CMB_BAL_07,                                     *00429000
                   MTH_CMB_BAL_08,                                     *00430000
                   MTH_CMB_BAL_09,                                     *00431000
                   MTH_CMB_BAL_10,                                     *00432000
                   MTH_CMB_BAL_11,                                     *00433000
                   MTH_CMB_BAL_12,                                     *00434000
                   DATE_OPEN,                                          *00435000
                   RSV_AREA                                            *00436000
                 FROM SAK                                              *00437000
                 WHERE                                                 *00438000
                   ACCT_INST_1 = :INST1 AND                            *00439000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00440000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00441000
                   MODEL_1 = :MODEL1 AND                               *00442000
                   ACCT_INST_2 = :INST2 AND                            *00443000
                   PROD_CODE_2 >=                                      *00444000
                     :PRDCDE2                                          *00445000
                 ORDER BY PROD_CODE_2 ASC,                             *00446000
                   ACCT_NBR_2 ASC                                      *00447000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00448000
         EXEC  SQL OPEN SAKGE002                                        00449000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00450000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00451000
         BR    14                      RETURN TO CALLER                 00452000
         LTORG                                                          00453000
*                                                                       00454000
SELGE003 DS    0H                                                       00455000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00456000
         EXEC  SQL DECLARE SAKGE003 CURSOR                             *00457000
               WITH ROWSET POSITIONING                                 *00458000
               FOR SELECT                                              *00459000
                   ACCT_INST_1,                                        *00460000
                   PROD_CODE_1,                                        *00461000
                   ACCT_NBR_1,                                         *00462000
                   MODEL_1,                                            *00463000
                   ACCT_INST_2,                                        *00464000
                   PROD_CODE_2,                                        *00465000
                   ACCT_NBR_2,                                         *00466000
                   AUDIT_DATE,                                         *00467000
                   AUDIT_TIME,                                         *00468000
                   AUDIT_USER,                                         *00469000
                   AUDIT_ORG,                                          *00470000
                   IDENT_NBR,                                          *00471000
                   BAL_OPT,                                            *00472000
                   PCT_USED,                                           *00473000
                   LST_CMB_BAL_USE,                                    *00474000
                   FREQUENCY,                                          *00475000
                   TERM,                                               *00476000
                   DAY_MONTH,                                          *00477000
                   NEXT_DATE,                                          *00478000
                   LAST_DATE,                                          *00479000
                   AMOUNT,                                             *00480000
                   LAST_AMT,                                           *00481000
                   AMOUNT_YTD,                                         *00482000
                   MTH_CMB_BAL_01,                                     *00483000
                   MTH_CMB_BAL_02,                                     *00484000
                   MTH_CMB_BAL_03,                                     *00485000
                   MTH_CMB_BAL_04,                                     *00486000
                   MTH_CMB_BAL_05,                                     *00487000
                   MTH_CMB_BAL_06,                                     *00488000
                   MTH_CMB_BAL_07,                                     *00489000
                   MTH_CMB_BAL_08,                                     *00490000
                   MTH_CMB_BAL_09,                                     *00491000
                   MTH_CMB_BAL_10,                                     *00492000
                   MTH_CMB_BAL_11,                                     *00493000
                   MTH_CMB_BAL_12,                                     *00494000
                   DATE_OPEN,                                          *00495000
                   RSV_AREA                                            *00496000
                 FROM SAK                                              *00497000
                 WHERE                                                 *00498000
                   ACCT_INST_1 = :INST1 AND                            *00499000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00500000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00501000
                   MODEL_1 = :MODEL1 AND                               *00502000
                   ACCT_INST_2 >=                                      *00503000
                     :INST2                                            *00504000
                 ORDER BY ACCT_INST_2 ASC,                             *00505000
                   PROD_CODE_2 ASC,                                    *00506000
                   ACCT_NBR_2 ASC                                      *00507000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00508000
         EXEC  SQL OPEN SAKGE003                                        00509000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00510000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00511000
         BR    14                      RETURN TO CALLER                 00512000
         LTORG                                                          00513000
*                                                                       00514000
SELGE004 DS    0H                                                       00515000
         USING SELGE004,12             ESTABLISH BASE REGISTER          00516000
         EXEC  SQL DECLARE SAKGE004 CURSOR                             *00517000
               WITH ROWSET POSITIONING                                 *00518000
               FOR SELECT                                              *00519000
                   ACCT_INST_1,                                        *00520000
                   PROD_CODE_1,                                        *00521000
                   ACCT_NBR_1,                                         *00522000
                   MODEL_1,                                            *00523000
                   ACCT_INST_2,                                        *00524000
                   PROD_CODE_2,                                        *00525000
                   ACCT_NBR_2,                                         *00526000
                   AUDIT_DATE,                                         *00527000
                   AUDIT_TIME,                                         *00528000
                   AUDIT_USER,                                         *00529000
                   AUDIT_ORG,                                          *00530000
                   IDENT_NBR,                                          *00531000
                   BAL_OPT,                                            *00532000
                   PCT_USED,                                           *00533000
                   LST_CMB_BAL_USE,                                    *00534000
                   FREQUENCY,                                          *00535000
                   TERM,                                               *00536000
                   DAY_MONTH,                                          *00537000
                   NEXT_DATE,                                          *00538000
                   LAST_DATE,                                          *00539000
                   AMOUNT,                                             *00540000
                   LAST_AMT,                                           *00541000
                   AMOUNT_YTD,                                         *00542000
                   MTH_CMB_BAL_01,                                     *00543000
                   MTH_CMB_BAL_02,                                     *00544000
                   MTH_CMB_BAL_03,                                     *00545000
                   MTH_CMB_BAL_04,                                     *00546000
                   MTH_CMB_BAL_05,                                     *00547000
                   MTH_CMB_BAL_06,                                     *00548000
                   MTH_CMB_BAL_07,                                     *00549000
                   MTH_CMB_BAL_08,                                     *00550000
                   MTH_CMB_BAL_09,                                     *00551000
                   MTH_CMB_BAL_10,                                     *00552000
                   MTH_CMB_BAL_11,                                     *00553000
                   MTH_CMB_BAL_12,                                     *00554000
                   DATE_OPEN,                                          *00555000
                   RSV_AREA                                            *00556000
                 FROM SAK                                              *00557000
                 WHERE                                                 *00558000
                   ACCT_INST_1 = :INST1 AND                            *00559000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00560000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00561000
                   MODEL_1 >=                                          *00562000
                     :MODEL1                                           *00563000
                 ORDER BY MODEL_1 ASC,                                 *00564000
                   ACCT_INST_2 ASC,                                    *00565000
                   PROD_CODE_2 ASC,                                    *00566000
                   ACCT_NBR_2 ASC                                      *00567000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00568000
         EXEC  SQL OPEN SAKGE004                                        00569000
         MVC   SQWCSRCA,=A(CLSGE004)   SET CURSOR CLOSE ROUTINE ADDRESS 00570000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00571000
         BR    14                      RETURN TO CALLER                 00572000
         LTORG                                                          00573000
*                                                                       00574000
SELGE005 DS    0H                                                       00575000
         USING SELGE005,12             ESTABLISH BASE REGISTER          00576000
         EXEC  SQL DECLARE SAKGE005 CURSOR                             *00577000
               WITH ROWSET POSITIONING                                 *00578000
               FOR SELECT                                              *00579000
                   ACCT_INST_1,                                        *00580000
                   PROD_CODE_1,                                        *00581000
                   ACCT_NBR_1,                                         *00582000
                   MODEL_1,                                            *00583000
                   ACCT_INST_2,                                        *00584000
                   PROD_CODE_2,                                        *00585000
                   ACCT_NBR_2,                                         *00586000
                   AUDIT_DATE,                                         *00587000
                   AUDIT_TIME,                                         *00588000
                   AUDIT_USER,                                         *00589000
                   AUDIT_ORG,                                          *00590000
                   IDENT_NBR,                                          *00591000
                   BAL_OPT,                                            *00592000
                   PCT_USED,                                           *00593000
                   LST_CMB_BAL_USE,                                    *00594000
                   FREQUENCY,                                          *00595000
                   TERM,                                               *00596000
                   DAY_MONTH,                                          *00597000
                   NEXT_DATE,                                          *00598000
                   LAST_DATE,                                          *00599000
                   AMOUNT,                                             *00600000
                   LAST_AMT,                                           *00601000
                   AMOUNT_YTD,                                         *00602000
                   MTH_CMB_BAL_01,                                     *00603000
                   MTH_CMB_BAL_02,                                     *00604000
                   MTH_CMB_BAL_03,                                     *00605000
                   MTH_CMB_BAL_04,                                     *00606000
                   MTH_CMB_BAL_05,                                     *00607000
                   MTH_CMB_BAL_06,                                     *00608000
                   MTH_CMB_BAL_07,                                     *00609000
                   MTH_CMB_BAL_08,                                     *00610000
                   MTH_CMB_BAL_09,                                     *00611000
                   MTH_CMB_BAL_10,                                     *00612000
                   MTH_CMB_BAL_11,                                     *00613000
                   MTH_CMB_BAL_12,                                     *00614000
                   DATE_OPEN,                                          *00615000
                   RSV_AREA                                            *00616000
                 FROM SAK                                              *00617000
                 WHERE                                                 *00618000
                   ACCT_INST_1 = :INST1 AND                            *00619000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00620000
                   ACCT_NBR_1 >=                                       *00621000
                     :ACCTNBR1                                         *00622000
                 ORDER BY ACCT_NBR_1 ASC,                              *00623000
                   MODEL_1 ASC,                                        *00624000
                   ACCT_INST_2 ASC,                                    *00625000
                   PROD_CODE_2 ASC,                                    *00626000
                   ACCT_NBR_2 ASC                                      *00627000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00628000
         EXEC  SQL OPEN SAKGE005                                        00629000
         MVC   SQWCSRCA,=A(CLSGE005)   SET CURSOR CLOSE ROUTINE ADDRESS 00630000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00631000
         BR    14                      RETURN TO CALLER                 00632000
         LTORG                                                          00633000
*                                                                       00634000
SELGE006 DS    0H                                                       00635000
         USING SELGE006,12             ESTABLISH BASE REGISTER          00636000
         EXEC  SQL DECLARE SAKGE006 CURSOR                             *00637000
               WITH ROWSET POSITIONING                                 *00638000
               FOR SELECT                                              *00639000
                   ACCT_INST_1,                                        *00640000
                   PROD_CODE_1,                                        *00641000
                   ACCT_NBR_1,                                         *00642000
                   MODEL_1,                                            *00643000
                   ACCT_INST_2,                                        *00644000
                   PROD_CODE_2,                                        *00645000
                   ACCT_NBR_2,                                         *00646000
                   AUDIT_DATE,                                         *00647000
                   AUDIT_TIME,                                         *00648000
                   AUDIT_USER,                                         *00649000
                   AUDIT_ORG,                                          *00650000
                   IDENT_NBR,                                          *00651000
                   BAL_OPT,                                            *00652000
                   PCT_USED,                                           *00653000
                   LST_CMB_BAL_USE,                                    *00654000
                   FREQUENCY,                                          *00655000
                   TERM,                                               *00656000
                   DAY_MONTH,                                          *00657000
                   NEXT_DATE,                                          *00658000
                   LAST_DATE,                                          *00659000
                   AMOUNT,                                             *00660000
                   LAST_AMT,                                           *00661000
                   AMOUNT_YTD,                                         *00662000
                   MTH_CMB_BAL_01,                                     *00663000
                   MTH_CMB_BAL_02,                                     *00664000
                   MTH_CMB_BAL_03,                                     *00665000
                   MTH_CMB_BAL_04,                                     *00666000
                   MTH_CMB_BAL_05,                                     *00667000
                   MTH_CMB_BAL_06,                                     *00668000
                   MTH_CMB_BAL_07,                                     *00669000
                   MTH_CMB_BAL_08,                                     *00670000
                   MTH_CMB_BAL_09,                                     *00671000
                   MTH_CMB_BAL_10,                                     *00672000
                   MTH_CMB_BAL_11,                                     *00673000
                   MTH_CMB_BAL_12,                                     *00674000
                   DATE_OPEN,                                          *00675000
                   RSV_AREA                                            *00676000
                 FROM SAK                                              *00677000
                 WHERE                                                 *00678000
                   ACCT_INST_1 = :INST1 AND                            *00679000
                   PROD_CODE_1 >=                                      *00680000
                     :PRDCDE1                                          *00681000
                 ORDER BY PROD_CODE_1 ASC,                             *00682000
                   ACCT_NBR_1 ASC,                                     *00683000
                   MODEL_1 ASC,                                        *00684000
                   ACCT_INST_2 ASC,                                    *00685000
                   PROD_CODE_2 ASC,                                    *00686000
                   ACCT_NBR_2 ASC                                      *00687000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00688000
         EXEC  SQL OPEN SAKGE006                                        00689000
         MVC   SQWCSRCA,=A(CLSGE006)   SET CURSOR CLOSE ROUTINE ADDRESS 00690000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00691000
         BR    14                      RETURN TO CALLER                 00692000
         LTORG                                                          00693000
*                                                                       00694000
SELGE007 DS    0H                                                       00695000
         USING SELGE007,12             ESTABLISH BASE REGISTER          00696000
         EXEC  SQL DECLARE SAKGE007 CURSOR                             *00697000
               WITH ROWSET POSITIONING                                 *00698000
               FOR SELECT                                              *00699000
                   ACCT_INST_1,                                        *00700000
                   PROD_CODE_1,                                        *00701000
                   ACCT_NBR_1,                                         *00702000
                   MODEL_1,                                            *00703000
                   ACCT_INST_2,                                        *00704000
                   PROD_CODE_2,                                        *00705000
                   ACCT_NBR_2,                                         *00706000
                   AUDIT_DATE,                                         *00707000
                   AUDIT_TIME,                                         *00708000
                   AUDIT_USER,                                         *00709000
                   AUDIT_ORG,                                          *00710000
                   IDENT_NBR,                                          *00711000
                   BAL_OPT,                                            *00712000
                   PCT_USED,                                           *00713000
                   LST_CMB_BAL_USE,                                    *00714000
                   FREQUENCY,                                          *00715000
                   TERM,                                               *00716000
                   DAY_MONTH,                                          *00717000
                   NEXT_DATE,                                          *00718000
                   LAST_DATE,                                          *00719000
                   AMOUNT,                                             *00720000
                   LAST_AMT,                                           *00721000
                   AMOUNT_YTD,                                         *00722000
                   MTH_CMB_BAL_01,                                     *00723000
                   MTH_CMB_BAL_02,                                     *00724000
                   MTH_CMB_BAL_03,                                     *00725000
                   MTH_CMB_BAL_04,                                     *00726000
                   MTH_CMB_BAL_05,                                     *00727000
                   MTH_CMB_BAL_06,                                     *00728000
                   MTH_CMB_BAL_07,                                     *00729000
                   MTH_CMB_BAL_08,                                     *00730000
                   MTH_CMB_BAL_09,                                     *00731000
                   MTH_CMB_BAL_10,                                     *00732000
                   MTH_CMB_BAL_11,                                     *00733000
                   MTH_CMB_BAL_12,                                     *00734000
                   DATE_OPEN,                                          *00735000
                   RSV_AREA                                            *00736000
                 FROM SAK                                              *00737000
                 WHERE                                                 *00738000
                   ACCT_INST_1 >=                                      *00739000
                     :INST1                                            *00740000
                 ORDER BY ACCT_INST_1 ASC,                             *00741000
                   PROD_CODE_1 ASC,                                    *00742000
                   ACCT_NBR_1 ASC,                                     *00743000
                   MODEL_1 ASC,                                        *00744000
                   ACCT_INST_2 ASC,                                    *00745000
                   PROD_CODE_2 ASC,                                    *00746000
                   ACCT_NBR_2 ASC                                      *00747000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00748000
         EXEC  SQL OPEN SAKGE007                                        00749000
         MVC   SQWCSRCA,=A(CLSGE007)   SET CURSOR CLOSE ROUTINE ADDRESS 00750000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00751000
         BR    14                      RETURN TO CALLER                 00752000
         LTORG                                                          00753000
*                                                                       00754000
**********************************************************************  00755000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00756000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00757000
**********************************************************************  00758000
*                                                                       00759000
NXTXC0   DS    0H                                                       00760000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00761000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00762000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00763000
         BALR  14,15                   MOVE REQUESTED DATA              00764000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00765000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00766000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00767000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00768000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00769000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00770000
NXTXC0P  DC    A(0)                                                     00771000
         DC    A(NXTGT002)                                              00772000
         DC    A(NXTGT003)                                              00773000
         DC    A(NXTGT004)                                              00774000
         DC    A(NXTGT005)                                              00775000
         DC    A(NXTGT006)                                              00776000
         DC    A(NXTGT007)                                              00777000
         DC    A(NXTGT099)                                              00778000
         DC    A(NXTGT003)                                              00779000
         DC    A(NXTGT004)                                              00780000
         DC    A(NXTGT005)                                              00781000
         DC    A(NXTGT006)                                              00782000
         DC    A(NXTGT007)                                              00783000
         DC    A(NXTGT099)                                              00784000
         DC    A(NXTGT004)                                              00785000
         DC    A(NXTGT005)                                              00786000
         DC    A(NXTGT006)                                              00787000
         DC    A(NXTGT007)                                              00788000
         DC    A(NXTGT099)                                              00789000
         DC    A(NXTGT005)                                              00790000
         DC    A(NXTGT006)                                              00791000
         DC    A(NXTGT007)                                              00792000
         DC    A(NXTGT099)                                              00793000
         DC    A(NXTGT006)                                              00794000
         DC    A(NXTGT007)                                              00795000
         DC    A(NXTGT099)                                              00796000
         DC    A(NXTGT007)                                              00797000
         DC    A(NXTGT099)                                              00798000
         DC    A(NXTGT099)                                              00799000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00800000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00801000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00802000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00803000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00804000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00805000
         BR    14                      RETURN TO SQI                    00806000
         LTORG                                                          00807000
*                                                                       00808000
NXTGT002 DS    0H                                                       00809000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00810000
         EXEC  SQL DECLARE SAKGT002 CURSOR                             *00811000
               WITH ROWSET POSITIONING                                 *00812000
               FOR SELECT                                              *00813000
                   ACCT_INST_1,                                        *00814000
                   PROD_CODE_1,                                        *00815000
                   ACCT_NBR_1,                                         *00816000
                   MODEL_1,                                            *00817000
                   ACCT_INST_2,                                        *00818000
                   PROD_CODE_2,                                        *00819000
                   ACCT_NBR_2,                                         *00820000
                   AUDIT_DATE,                                         *00821000
                   AUDIT_TIME,                                         *00822000
                   AUDIT_USER,                                         *00823000
                   AUDIT_ORG,                                          *00824000
                   IDENT_NBR,                                          *00825000
                   BAL_OPT,                                            *00826000
                   PCT_USED,                                           *00827000
                   LST_CMB_BAL_USE,                                    *00828000
                   FREQUENCY,                                          *00829000
                   TERM,                                               *00830000
                   DAY_MONTH,                                          *00831000
                   NEXT_DATE,                                          *00832000
                   LAST_DATE,                                          *00833000
                   AMOUNT,                                             *00834000
                   LAST_AMT,                                           *00835000
                   AMOUNT_YTD,                                         *00836000
                   MTH_CMB_BAL_01,                                     *00837000
                   MTH_CMB_BAL_02,                                     *00838000
                   MTH_CMB_BAL_03,                                     *00839000
                   MTH_CMB_BAL_04,                                     *00840000
                   MTH_CMB_BAL_05,                                     *00841000
                   MTH_CMB_BAL_06,                                     *00842000
                   MTH_CMB_BAL_07,                                     *00843000
                   MTH_CMB_BAL_08,                                     *00844000
                   MTH_CMB_BAL_09,                                     *00845000
                   MTH_CMB_BAL_10,                                     *00846000
                   MTH_CMB_BAL_11,                                     *00847000
                   MTH_CMB_BAL_12,                                     *00848000
                   DATE_OPEN,                                          *00849000
                   RSV_AREA                                            *00850000
                 FROM SAK                                              *00851000
                 WHERE                                                 *00852000
                   ACCT_INST_1 = :INST1 AND                            *00853000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00854000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00855000
                   MODEL_1 = :MODEL1 AND                               *00856000
                   ACCT_INST_2 = :INST2 AND                            *00857000
                   PROD_CODE_2 >                                       *00858000
                     :PRDCDE2                                          *00859000
                 ORDER BY PROD_CODE_2 ASC,                             *00860000
                   ACCT_NBR_2 ASC                                      *00861000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00862000
         EXEC  SQL OPEN SAKGT002                                        00863000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00864000
         BNZ   *+14                    NO - RETURN ERROR                00865000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00866000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00867000
         BR    12                      RETURN TO FETCH ROUTINE          00868000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00869000
         BR    14                      RETURN TO CALLER                 00870000
         LTORG                                                          00871000
*                                                                       00872000
NXTGT003 DS    0H                                                       00873000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00874000
         EXEC  SQL DECLARE SAKGT003 CURSOR                             *00875000
               WITH ROWSET POSITIONING                                 *00876000
               FOR SELECT                                              *00877000
                   ACCT_INST_1,                                        *00878000
                   PROD_CODE_1,                                        *00879000
                   ACCT_NBR_1,                                         *00880000
                   MODEL_1,                                            *00881000
                   ACCT_INST_2,                                        *00882000
                   PROD_CODE_2,                                        *00883000
                   ACCT_NBR_2,                                         *00884000
                   AUDIT_DATE,                                         *00885000
                   AUDIT_TIME,                                         *00886000
                   AUDIT_USER,                                         *00887000
                   AUDIT_ORG,                                          *00888000
                   IDENT_NBR,                                          *00889000
                   BAL_OPT,                                            *00890000
                   PCT_USED,                                           *00891000
                   LST_CMB_BAL_USE,                                    *00892000
                   FREQUENCY,                                          *00893000
                   TERM,                                               *00894000
                   DAY_MONTH,                                          *00895000
                   NEXT_DATE,                                          *00896000
                   LAST_DATE,                                          *00897000
                   AMOUNT,                                             *00898000
                   LAST_AMT,                                           *00899000
                   AMOUNT_YTD,                                         *00900000
                   MTH_CMB_BAL_01,                                     *00901000
                   MTH_CMB_BAL_02,                                     *00902000
                   MTH_CMB_BAL_03,                                     *00903000
                   MTH_CMB_BAL_04,                                     *00904000
                   MTH_CMB_BAL_05,                                     *00905000
                   MTH_CMB_BAL_06,                                     *00906000
                   MTH_CMB_BAL_07,                                     *00907000
                   MTH_CMB_BAL_08,                                     *00908000
                   MTH_CMB_BAL_09,                                     *00909000
                   MTH_CMB_BAL_10,                                     *00910000
                   MTH_CMB_BAL_11,                                     *00911000
                   MTH_CMB_BAL_12,                                     *00912000
                   DATE_OPEN,                                          *00913000
                   RSV_AREA                                            *00914000
                 FROM SAK                                              *00915000
                 WHERE                                                 *00916000
                   ACCT_INST_1 = :INST1 AND                            *00917000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00918000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00919000
                   MODEL_1 = :MODEL1 AND                               *00920000
                   ACCT_INST_2 >                                       *00921000
                     :INST2                                            *00922000
                 ORDER BY ACCT_INST_2 ASC,                             *00923000
                   PROD_CODE_2 ASC,                                    *00924000
                   ACCT_NBR_2 ASC                                      *00925000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00926000
         EXEC  SQL OPEN SAKGT003                                        00927000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00928000
         BNZ   *+14                    NO - RETURN ERROR                00929000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00930000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00931000
         BR    12                      RETURN TO FETCH ROUTINE          00932000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00933000
         BR    14                      RETURN TO CALLER                 00934000
         LTORG                                                          00935000
*                                                                       00936000
NXTGT004 DS    0H                                                       00937000
         USING NXTGT004,12             ESTABLISH BASE REGISTER          00938000
         EXEC  SQL DECLARE SAKGT004 CURSOR                             *00939000
               WITH ROWSET POSITIONING                                 *00940000
               FOR SELECT                                              *00941000
                   ACCT_INST_1,                                        *00942000
                   PROD_CODE_1,                                        *00943000
                   ACCT_NBR_1,                                         *00944000
                   MODEL_1,                                            *00945000
                   ACCT_INST_2,                                        *00946000
                   PROD_CODE_2,                                        *00947000
                   ACCT_NBR_2,                                         *00948000
                   AUDIT_DATE,                                         *00949000
                   AUDIT_TIME,                                         *00950000
                   AUDIT_USER,                                         *00951000
                   AUDIT_ORG,                                          *00952000
                   IDENT_NBR,                                          *00953000
                   BAL_OPT,                                            *00954000
                   PCT_USED,                                           *00955000
                   LST_CMB_BAL_USE,                                    *00956000
                   FREQUENCY,                                          *00957000
                   TERM,                                               *00958000
                   DAY_MONTH,                                          *00959000
                   NEXT_DATE,                                          *00960000
                   LAST_DATE,                                          *00961000
                   AMOUNT,                                             *00962000
                   LAST_AMT,                                           *00963000
                   AMOUNT_YTD,                                         *00964000
                   MTH_CMB_BAL_01,                                     *00965000
                   MTH_CMB_BAL_02,                                     *00966000
                   MTH_CMB_BAL_03,                                     *00967000
                   MTH_CMB_BAL_04,                                     *00968000
                   MTH_CMB_BAL_05,                                     *00969000
                   MTH_CMB_BAL_06,                                     *00970000
                   MTH_CMB_BAL_07,                                     *00971000
                   MTH_CMB_BAL_08,                                     *00972000
                   MTH_CMB_BAL_09,                                     *00973000
                   MTH_CMB_BAL_10,                                     *00974000
                   MTH_CMB_BAL_11,                                     *00975000
                   MTH_CMB_BAL_12,                                     *00976000
                   DATE_OPEN,                                          *00977000
                   RSV_AREA                                            *00978000
                 FROM SAK                                              *00979000
                 WHERE                                                 *00980000
                   ACCT_INST_1 = :INST1 AND                            *00981000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00982000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00983000
                   MODEL_1 >                                           *00984000
                     :MODEL1                                           *00985000
                 ORDER BY MODEL_1 ASC,                                 *00986000
                   ACCT_INST_2 ASC,                                    *00987000
                   PROD_CODE_2 ASC,                                    *00988000
                   ACCT_NBR_2 ASC                                      *00989000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00990000
         EXEC  SQL OPEN SAKGT004                                        00991000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00992000
         BNZ   *+14                    NO - RETURN ERROR                00993000
         MVC   SQWCSRCA,=A(CLSGT004)   SET CURSOR CLOSE ROUTINE ADDRESS 00994000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00995000
         BR    12                      RETURN TO FETCH ROUTINE          00996000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00997000
         BR    14                      RETURN TO CALLER                 00998000
         LTORG                                                          00999000
*                                                                       01000000
NXTGT005 DS    0H                                                       01001000
         USING NXTGT005,12             ESTABLISH BASE REGISTER          01002000
         EXEC  SQL DECLARE SAKGT005 CURSOR                             *01003000
               WITH ROWSET POSITIONING                                 *01004000
               FOR SELECT                                              *01005000
                   ACCT_INST_1,                                        *01006000
                   PROD_CODE_1,                                        *01007000
                   ACCT_NBR_1,                                         *01008000
                   MODEL_1,                                            *01009000
                   ACCT_INST_2,                                        *01010000
                   PROD_CODE_2,                                        *01011000
                   ACCT_NBR_2,                                         *01012000
                   AUDIT_DATE,                                         *01013000
                   AUDIT_TIME,                                         *01014000
                   AUDIT_USER,                                         *01015000
                   AUDIT_ORG,                                          *01016000
                   IDENT_NBR,                                          *01017000
                   BAL_OPT,                                            *01018000
                   PCT_USED,                                           *01019000
                   LST_CMB_BAL_USE,                                    *01020000
                   FREQUENCY,                                          *01021000
                   TERM,                                               *01022000
                   DAY_MONTH,                                          *01023000
                   NEXT_DATE,                                          *01024000
                   LAST_DATE,                                          *01025000
                   AMOUNT,                                             *01026000
                   LAST_AMT,                                           *01027000
                   AMOUNT_YTD,                                         *01028000
                   MTH_CMB_BAL_01,                                     *01029000
                   MTH_CMB_BAL_02,                                     *01030000
                   MTH_CMB_BAL_03,                                     *01031000
                   MTH_CMB_BAL_04,                                     *01032000
                   MTH_CMB_BAL_05,                                     *01033000
                   MTH_CMB_BAL_06,                                     *01034000
                   MTH_CMB_BAL_07,                                     *01035000
                   MTH_CMB_BAL_08,                                     *01036000
                   MTH_CMB_BAL_09,                                     *01037000
                   MTH_CMB_BAL_10,                                     *01038000
                   MTH_CMB_BAL_11,                                     *01039000
                   MTH_CMB_BAL_12,                                     *01040000
                   DATE_OPEN,                                          *01041000
                   RSV_AREA                                            *01042000
                 FROM SAK                                              *01043000
                 WHERE                                                 *01044000
                   ACCT_INST_1 = :INST1 AND                            *01045000
                   PROD_CODE_1 = :PRDCDE1 AND                          *01046000
                   ACCT_NBR_1 >                                        *01047000
                     :ACCTNBR1                                         *01048000
                 ORDER BY ACCT_NBR_1 ASC,                              *01049000
                   MODEL_1 ASC,                                        *01050000
                   ACCT_INST_2 ASC,                                    *01051000
                   PROD_CODE_2 ASC,                                    *01052000
                   ACCT_NBR_2 ASC                                      *01053000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01054000
         EXEC  SQL OPEN SAKGT005                                        01055000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01056000
         BNZ   *+14                    NO - RETURN ERROR                01057000
         MVC   SQWCSRCA,=A(CLSGT005)   SET CURSOR CLOSE ROUTINE ADDRESS 01058000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01059000
         BR    12                      RETURN TO FETCH ROUTINE          01060000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01061000
         BR    14                      RETURN TO CALLER                 01062000
         LTORG                                                          01063000
*                                                                       01064000
NXTGT006 DS    0H                                                       01065000
         USING NXTGT006,12             ESTABLISH BASE REGISTER          01066000
         EXEC  SQL DECLARE SAKGT006 CURSOR                             *01067000
               WITH ROWSET POSITIONING                                 *01068000
               FOR SELECT                                              *01069000
                   ACCT_INST_1,                                        *01070000
                   PROD_CODE_1,                                        *01071000
                   ACCT_NBR_1,                                         *01072000
                   MODEL_1,                                            *01073000
                   ACCT_INST_2,                                        *01074000
                   PROD_CODE_2,                                        *01075000
                   ACCT_NBR_2,                                         *01076000
                   AUDIT_DATE,                                         *01077000
                   AUDIT_TIME,                                         *01078000
                   AUDIT_USER,                                         *01079000
                   AUDIT_ORG,                                          *01080000
                   IDENT_NBR,                                          *01081000
                   BAL_OPT,                                            *01082000
                   PCT_USED,                                           *01083000
                   LST_CMB_BAL_USE,                                    *01084000
                   FREQUENCY,                                          *01085000
                   TERM,                                               *01086000
                   DAY_MONTH,                                          *01087000
                   NEXT_DATE,                                          *01088000
                   LAST_DATE,                                          *01089000
                   AMOUNT,                                             *01090000
                   LAST_AMT,                                           *01091000
                   AMOUNT_YTD,                                         *01092000
                   MTH_CMB_BAL_01,                                     *01093000
                   MTH_CMB_BAL_02,                                     *01094000
                   MTH_CMB_BAL_03,                                     *01095000
                   MTH_CMB_BAL_04,                                     *01096000
                   MTH_CMB_BAL_05,                                     *01097000
                   MTH_CMB_BAL_06,                                     *01098000
                   MTH_CMB_BAL_07,                                     *01099000
                   MTH_CMB_BAL_08,                                     *01100000
                   MTH_CMB_BAL_09,                                     *01101000
                   MTH_CMB_BAL_10,                                     *01102000
                   MTH_CMB_BAL_11,                                     *01103000
                   MTH_CMB_BAL_12,                                     *01104000
                   DATE_OPEN,                                          *01105000
                   RSV_AREA                                            *01106000
                 FROM SAK                                              *01107000
                 WHERE                                                 *01108000
                   ACCT_INST_1 = :INST1 AND                            *01109000
                   PROD_CODE_1 >                                       *01110000
                     :PRDCDE1                                          *01111000
                 ORDER BY PROD_CODE_1 ASC,                             *01112000
                   ACCT_NBR_1 ASC,                                     *01113000
                   MODEL_1 ASC,                                        *01114000
                   ACCT_INST_2 ASC,                                    *01115000
                   PROD_CODE_2 ASC,                                    *01116000
                   ACCT_NBR_2 ASC                                      *01117000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01118000
         EXEC  SQL OPEN SAKGT006                                        01119000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01120000
         BNZ   *+14                    NO - RETURN ERROR                01121000
         MVC   SQWCSRCA,=A(CLSGT006)   SET CURSOR CLOSE ROUTINE ADDRESS 01122000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01123000
         BR    12                      RETURN TO FETCH ROUTINE          01124000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01125000
         BR    14                      RETURN TO CALLER                 01126000
         LTORG                                                          01127000
*                                                                       01128000
NXTGT007 DS    0H                                                       01129000
         USING NXTGT007,12             ESTABLISH BASE REGISTER          01130000
         EXEC  SQL DECLARE SAKGT007 CURSOR                             *01131000
               WITH ROWSET POSITIONING                                 *01132000
               FOR SELECT                                              *01133000
                   ACCT_INST_1,                                        *01134000
                   PROD_CODE_1,                                        *01135000
                   ACCT_NBR_1,                                         *01136000
                   MODEL_1,                                            *01137000
                   ACCT_INST_2,                                        *01138000
                   PROD_CODE_2,                                        *01139000
                   ACCT_NBR_2,                                         *01140000
                   AUDIT_DATE,                                         *01141000
                   AUDIT_TIME,                                         *01142000
                   AUDIT_USER,                                         *01143000
                   AUDIT_ORG,                                          *01144000
                   IDENT_NBR,                                          *01145000
                   BAL_OPT,                                            *01146000
                   PCT_USED,                                           *01147000
                   LST_CMB_BAL_USE,                                    *01148000
                   FREQUENCY,                                          *01149000
                   TERM,                                               *01150000
                   DAY_MONTH,                                          *01151000
                   NEXT_DATE,                                          *01152000
                   LAST_DATE,                                          *01153000
                   AMOUNT,                                             *01154000
                   LAST_AMT,                                           *01155000
                   AMOUNT_YTD,                                         *01156000
                   MTH_CMB_BAL_01,                                     *01157000
                   MTH_CMB_BAL_02,                                     *01158000
                   MTH_CMB_BAL_03,                                     *01159000
                   MTH_CMB_BAL_04,                                     *01160000
                   MTH_CMB_BAL_05,                                     *01161000
                   MTH_CMB_BAL_06,                                     *01162000
                   MTH_CMB_BAL_07,                                     *01163000
                   MTH_CMB_BAL_08,                                     *01164000
                   MTH_CMB_BAL_09,                                     *01165000
                   MTH_CMB_BAL_10,                                     *01166000
                   MTH_CMB_BAL_11,                                     *01167000
                   MTH_CMB_BAL_12,                                     *01168000
                   DATE_OPEN,                                          *01169000
                   RSV_AREA                                            *01170000
                 FROM SAK                                              *01171000
                 WHERE                                                 *01172000
                   ACCT_INST_1 >                                       *01173000
                     :INST1                                            *01174000
                 ORDER BY ACCT_INST_1 ASC,                             *01175000
                   PROD_CODE_1 ASC,                                    *01176000
                   ACCT_NBR_1 ASC,                                     *01177000
                   MODEL_1 ASC,                                        *01178000
                   ACCT_INST_2 ASC,                                    *01179000
                   PROD_CODE_2 ASC,                                    *01180000
                   ACCT_NBR_2 ASC                                      *01181000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01182000
         EXEC  SQL OPEN SAKGT007                                        01183000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01184000
         BNZ   *+14                    NO - RETURN ERROR                01185000
         MVC   SQWCSRCA,=A(CLSGT007)   SET CURSOR CLOSE ROUTINE ADDRESS 01186000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01187000
         BR    12                      RETURN TO FETCH ROUTINE          01188000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01189000
         BR    14                      RETURN TO CALLER                 01190000
         LTORG                                                          01191000
*                                                                       01192000
**********************************************************************  01193000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               01194000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01195000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01196000
*     RETRIEVE THE ACTUAL ROW.                                          01197000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01198000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01199000
**********************************************************************  01200000
*                                                                       01201000
FETDC0   DS    0H                                                       01202000
         USING FETDC0,12               ESTABLISH BASE REGISTER          01203000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       01204000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01205000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       01206000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01207000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    01208000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01209000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01210000
FETDC0P  DC    A(FETGE001)                                              01211000
         DC    A(FETGT002)                                              01212000
         DC    A(FETGT003)                                              01213000
         DC    A(FETGT004)                                              01214000
         DC    A(FETGT005)                                              01215000
         DC    A(FETGT006)                                              01216000
         DC    A(FETGT007)                                              01217000
         DC    A(FETGE002)                                              01218000
         DC    A(FETGT003)                                              01219000
         DC    A(FETGT004)                                              01220000
         DC    A(FETGT005)                                              01221000
         DC    A(FETGT006)                                              01222000
         DC    A(FETGT007)                                              01223000
         DC    A(FETGE003)                                              01224000
         DC    A(FETGT004)                                              01225000
         DC    A(FETGT005)                                              01226000
         DC    A(FETGT006)                                              01227000
         DC    A(FETGT007)                                              01228000
         DC    A(FETGE004)                                              01229000
         DC    A(FETGT005)                                              01230000
         DC    A(FETGT006)                                              01231000
         DC    A(FETGT007)                                              01232000
         DC    A(FETGE005)                                              01233000
         DC    A(FETGT006)                                              01234000
         DC    A(FETGT007)                                              01235000
         DC    A(FETGE006)                                              01236000
         DC    A(FETGT007)                                              01237000
         DC    A(FETGE007)                                              01238000
         DC    A(0)                                                     01239000
         LTORG                                                          01240000
*                                                                       01241000
**********************************************************************  01242000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01243000
* THE PRIMARY KEY:                                                      01244000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01245000
*     VERBS.                                                            01246000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01247000
*     RETRIEVE THE ACTUAL ROW.                                          01248000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01249000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01250000
*     WILL BE THRU THE UPDATE CURSOR.                                   01251000
**********************************************************************  01252000
*                                                                       01253000
FETKC0   DS    0H                                                       01254000
         USING FETKC0,12               ESTABLISH BASE REGISTER          01255000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       01256000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01257000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           01258000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01259000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    01260000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01261000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01262000
FETKC0P  DC    A(FETGE001)                                              01263000
         DC    A(FETGT002)                                              01264000
         DC    A(FETGT003)                                              01265000
         DC    A(FETGT004)                                              01266000
         DC    A(FETGT005)                                              01267000
         DC    A(FETGT006)                                              01268000
         DC    A(FETGT007)                                              01269000
         DC    A(FETGE002)                                              01270000
         DC    A(FETGT003)                                              01271000
         DC    A(FETGT004)                                              01272000
         DC    A(FETGT005)                                              01273000
         DC    A(FETGT006)                                              01274000
         DC    A(FETGT007)                                              01275000
         DC    A(FETGE003)                                              01276000
         DC    A(FETGT004)                                              01277000
         DC    A(FETGT005)                                              01278000
         DC    A(FETGT006)                                              01279000
         DC    A(FETGT007)                                              01280000
         DC    A(FETGE004)                                              01281000
         DC    A(FETGT005)                                              01282000
         DC    A(FETGT006)                                              01283000
         DC    A(FETGT007)                                              01284000
         DC    A(FETGE005)                                              01285000
         DC    A(FETGT006)                                              01286000
         DC    A(FETGT007)                                              01287000
         DC    A(FETGE006)                                              01288000
         DC    A(FETGT007)                                              01289000
         DC    A(FETGE007)                                              01290000
         DC    A(0)                                                     01291000
         LTORG                                                          01292000
*                                                                       01293000
FETGE001 DS    0H                                                       01294000
         USING FETGE001,12             ESTABLISH BASE REGISTER          01295000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01296000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01297000
         BALR  14,15                   MOVE REQUESTED DATA              01298000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE001                     *01299000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01300000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01301000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01302000
         BALR  14,15                   MOVE REQUESTED DATA              01303000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01304000
         BR    14                      RETURN TO CALLER                 01305000
         LTORG                                                          01306000
*                                                                       01307000
FETGE002 DS    0H                                                       01308000
         USING FETGE002,12             ESTABLISH BASE REGISTER          01309000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01310000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01311000
         BALR  14,15                   MOVE REQUESTED DATA              01312000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE002                     *01313000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01314000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01315000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01316000
         BALR  14,15                   MOVE REQUESTED DATA              01317000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01318000
         BR    14                      RETURN TO CALLER                 01319000
         LTORG                                                          01320000
*                                                                       01321000
FETGE003 DS    0H                                                       01322000
         USING FETGE003,12             ESTABLISH BASE REGISTER          01323000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01324000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01325000
         BALR  14,15                   MOVE REQUESTED DATA              01326000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE003                     *01327000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01328000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01329000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01330000
         BALR  14,15                   MOVE REQUESTED DATA              01331000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01332000
         BR    14                      RETURN TO CALLER                 01333000
         LTORG                                                          01334000
*                                                                       01335000
FETGE004 DS    0H                                                       01336000
         USING FETGE004,12             ESTABLISH BASE REGISTER          01337000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01338000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01339000
         BALR  14,15                   MOVE REQUESTED DATA              01340000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE004                     *01341000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01342000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01343000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01344000
         BALR  14,15                   MOVE REQUESTED DATA              01345000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01346000
         BR    14                      RETURN TO CALLER                 01347000
         LTORG                                                          01348000
*                                                                       01349000
FETGE005 DS    0H                                                       01350000
         USING FETGE005,12             ESTABLISH BASE REGISTER          01351000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01352000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01353000
         BALR  14,15                   MOVE REQUESTED DATA              01354000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE005                     *01355000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01356000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01357000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01358000
         BALR  14,15                   MOVE REQUESTED DATA              01359000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01360000
         BR    14                      RETURN TO CALLER                 01361000
         LTORG                                                          01362000
*                                                                       01363000
FETGE006 DS    0H                                                       01364000
         USING FETGE006,12             ESTABLISH BASE REGISTER          01365000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01366000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01367000
         BALR  14,15                   MOVE REQUESTED DATA              01368000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE006                     *01369000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01370000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01371000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01372000
         BALR  14,15                   MOVE REQUESTED DATA              01373000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01374000
         BR    14                      RETURN TO CALLER                 01375000
         LTORG                                                          01376000
*                                                                       01377000
FETGE007 DS    0H                                                       01378000
         USING FETGE007,12             ESTABLISH BASE REGISTER          01379000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01380000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01381000
         BALR  14,15                   MOVE REQUESTED DATA              01382000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE007                     *01383000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01384000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01385000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01386000
         BALR  14,15                   MOVE REQUESTED DATA              01387000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01388000
         BR    14                      RETURN TO CALLER                 01389000
         LTORG                                                          01390000
*                                                                       01391000
FETGT002 DS    0H                                                       01392000
         USING FETGT002,12             ESTABLISH BASE REGISTER          01393000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01394000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01395000
         BALR  14,15                   MOVE REQUESTED DATA              01396000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT002                     *01397000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01398000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01399000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01400000
         BALR  14,15                   MOVE REQUESTED DATA              01401000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01402000
         BR    14                      RETURN TO CALLER                 01403000
         LTORG                                                          01404000
*                                                                       01405000
FETGT003 DS    0H                                                       01406000
         USING FETGT003,12             ESTABLISH BASE REGISTER          01407000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01408000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01409000
         BALR  14,15                   MOVE REQUESTED DATA              01410000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT003                     *01411000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01412000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01413000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01414000
         BALR  14,15                   MOVE REQUESTED DATA              01415000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01416000
         BR    14                      RETURN TO CALLER                 01417000
         LTORG                                                          01418000
*                                                                       01419000
FETGT004 DS    0H                                                       01420000
         USING FETGT004,12             ESTABLISH BASE REGISTER          01421000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01422000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01423000
         BALR  14,15                   MOVE REQUESTED DATA              01424000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT004                     *01425000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01426000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01427000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01428000
         BALR  14,15                   MOVE REQUESTED DATA              01429000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01430000
         BR    14                      RETURN TO CALLER                 01431000
         LTORG                                                          01432000
*                                                                       01433000
FETGT005 DS    0H                                                       01434000
         USING FETGT005,12             ESTABLISH BASE REGISTER          01435000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01436000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01437000
         BALR  14,15                   MOVE REQUESTED DATA              01438000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT005                     *01439000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01440000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01441000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01442000
         BALR  14,15                   MOVE REQUESTED DATA              01443000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01444000
         BR    14                      RETURN TO CALLER                 01445000
         LTORG                                                          01446000
*                                                                       01447000
FETGT006 DS    0H                                                       01448000
         USING FETGT006,12             ESTABLISH BASE REGISTER          01449000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01450000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01451000
         BALR  14,15                   MOVE REQUESTED DATA              01452000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT006                     *01453000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01454000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01455000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01456000
         BALR  14,15                   MOVE REQUESTED DATA              01457000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01458000
         BR    14                      RETURN TO CALLER                 01459000
         LTORG                                                          01460000
*                                                                       01461000
FETGT007 DS    0H                                                       01462000
         USING FETGT007,12             ESTABLISH BASE REGISTER          01463000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01464000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01465000
         BALR  14,15                   MOVE REQUESTED DATA              01466000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT007                     *01467000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01468000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01469000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01470000
         BALR  14,15                   MOVE REQUESTED DATA              01471000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01472000
         BR    14                      RETURN TO CALLER                 01473000
         LTORG                                                          01474000
*                                                                       01475000
**********************************************************************  01476000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01477000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01478000
*     AND GET-NEXT-LOCK VERBS.                                          01479000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01480000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01481000
**********************************************************************  01482000
*                                                                       01483000
CLSXC0   DS    0H                                                       01484000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          01485000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 01486000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  01487000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       01488000
         LTORG                                                          01489000
*                                                                       01490000
CLSGE001 DS    0H                                                       01491000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          01492000
         EXEC  SQL CLOSE SAKGE001                                       01493000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01494000
         BR    14                      RETURN TO CALLER                 01495000
         LTORG                                                          01496000
*                                                                       01497000
CLSGE002 DS    0H                                                       01498000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          01499000
         EXEC  SQL CLOSE SAKGE002                                       01500000
         L     14,SQW@RET                                               01501000
         BR    14                                                       01502000
         LTORG                                                          01503000
*                                                                       01504000
CLSGE003 DS    0H                                                       01505000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          01506000
         EXEC  SQL CLOSE SAKGE003                                       01507000
         L     14,SQW@RET                                               01508000
         BR    14                                                       01509000
         LTORG                                                          01510000
*                                                                       01511000
CLSGE004 DS    0H                                                       01512000
         USING CLSGE004,12             ESTABLISH BASE REGISTER          01513000
         EXEC  SQL CLOSE SAKGE004                                       01514000
         L     14,SQW@RET                                               01515000
         BR    14                                                       01516000
         LTORG                                                          01517000
*                                                                       01518000
CLSGE005 DS    0H                                                       01519000
         USING CLSGE005,12             ESTABLISH BASE REGISTER          01520000
         EXEC  SQL CLOSE SAKGE005                                       01521000
         L     14,SQW@RET                                               01522000
         BR    14                                                       01523000
         LTORG                                                          01524000
*                                                                       01525000
CLSGE006 DS    0H                                                       01526000
         USING CLSGE006,12             ESTABLISH BASE REGISTER          01527000
         EXEC  SQL CLOSE SAKGE006                                       01528000
         L     14,SQW@RET                                               01529000
         BR    14                                                       01530000
         LTORG                                                          01531000
*                                                                       01532000
CLSGE007 DS    0H                                                       01533000
         USING CLSGE007,12             ESTABLISH BASE REGISTER          01534000
         EXEC  SQL CLOSE SAKGE007                                       01535000
         L     14,SQW@RET                                               01536000
         BR    14                                                       01537000
         LTORG                                                          01538000
*                                                                       01539000
CLSGT002 DS    0H                                                       01540000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          01541000
         EXEC  SQL CLOSE SAKGT002                                       01542000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01543000
         BR    14                      RETURN TO CALLER                 01544000
         LTORG                                                          01545000
*                                                                       01546000
CLSGT003 DS    0H                                                       01547000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          01548000
         EXEC  SQL CLOSE SAKGT003                                       01549000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01550000
         BR    14                      RETURN TO CALLER                 01551000
         LTORG                                                          01552000
*                                                                       01553000
CLSGT004 DS    0H                                                       01554000
         USING CLSGT004,12             ESTABLISH BASE REGISTER          01555000
         EXEC  SQL CLOSE SAKGT004                                       01556000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01557000
         BR    14                      RETURN TO CALLER                 01558000
         LTORG                                                          01559000
*                                                                       01560000
CLSGT005 DS    0H                                                       01561000
         USING CLSGT005,12             ESTABLISH BASE REGISTER          01562000
         EXEC  SQL CLOSE SAKGT005                                       01563000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01564000
         BR    14                      RETURN TO CALLER                 01565000
         LTORG                                                          01566000
*                                                                       01567000
CLSGT006 DS    0H                                                       01568000
         USING CLSGT006,12             ESTABLISH BASE REGISTER          01569000
         EXEC  SQL CLOSE SAKGT006                                       01570000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01571000
         BR    14                      RETURN TO CALLER                 01572000
         LTORG                                                          01573000
*                                                                       01574000
CLSGT007 DS    0H                                                       01575000
         USING CLSGT007,12             ESTABLISH BASE REGISTER          01576000
         EXEC  SQL CLOSE SAKGT007                                       01577000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01578000
         BR    14                      RETURN TO CALLER                 01579000
         LTORG                                                          01580000
*                                                                       01581000
**********************************************************************  01582000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             01583000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                01584000
**********************************************************************  01585000
*                                                                       01586000
SELIN1   DS    0H                                                       01587000
         USING SELIN1,12               ESTABLISH BASE REGISTER          01588000
         MVI   SQWKMRP,X'40'           MOVE RECORD TO HOST FOR KEY 1    01589000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01590000
         BALR  14,15                   MOVE REQUESTED DATA              01591000
         EXEC  SQL SELECT                                              *01592000
                   ACCT_INST_1,                                        *01593000
                   PROD_CODE_1,                                        *01594000
                   ACCT_NBR_1,                                         *01595000
                   MODEL_1,                                            *01596000
                   ACCT_INST_2,                                        *01597000
                   PROD_CODE_2,                                        *01598000
                   ACCT_NBR_2,                                         *01599000
                   AUDIT_DATE,                                         *01600000
                   AUDIT_TIME,                                         *01601000
                   AUDIT_USER,                                         *01602000
                   AUDIT_ORG,                                          *01603000
                   IDENT_NBR,                                          *01604000
                   BAL_OPT,                                            *01605000
                   PCT_USED,                                           *01606000
                   LST_CMB_BAL_USE,                                    *01607000
                   FREQUENCY,                                          *01608000
                   TERM,                                               *01609000
                   DAY_MONTH,                                          *01610000
                   NEXT_DATE,                                          *01611000
                   LAST_DATE,                                          *01612000
                   AMOUNT,                                             *01613000
                   LAST_AMT,                                           *01614000
                   AMOUNT_YTD,                                         *01615000
                   MTH_CMB_BAL_01,                                     *01616000
                   MTH_CMB_BAL_02,                                     *01617000
                   MTH_CMB_BAL_03,                                     *01618000
                   MTH_CMB_BAL_04,                                     *01619000
                   MTH_CMB_BAL_05,                                     *01620000
                   MTH_CMB_BAL_06,                                     *01621000
                   MTH_CMB_BAL_07,                                     *01622000
                   MTH_CMB_BAL_08,                                     *01623000
                   MTH_CMB_BAL_09,                                     *01624000
                   MTH_CMB_BAL_10,                                     *01625000
                   MTH_CMB_BAL_11,                                     *01626000
                   MTH_CMB_BAL_12,                                     *01627000
                   DATE_OPEN,                                          *01628000
                   RSV_AREA                                            *01629000
                 INTO                                                  *01630000
                   :INST1,                                             *01631000
                   :PRDCDE1,                                           *01632000
                   :ACCTNBR1,                                          *01633000
                   :MODEL1,                                            *01634000
                   :INST2,                                             *01635000
                   :PRDCDE2,                                           *01636000
                   :ACCTNBR2,                                          *01637000
                   :AUDDATE,                                           *01638000
                   :AUDTIME,                                           *01639000
                   :AUDUSER,                                           *01640000
                   :AUDORG,                                            *01641000
                   :IDNBR,                                             *01642000
                   :BALOPT,                                            *01643000
                   :PCTUSED,                                           *01644000
                   :LCMBUSED,                                          *01645000
                   :FREQ,                                              *01646000
                   :TERM,                                              *01647000
                   :DAYMTH,                                            *01648000
                   :NEXTDATE,                                          *01649000
                   :LASTDATE,                                          *01650000
                   :AMT,                                               *01651000
                   :LASTAMT,                                           *01652000
                   :AMTYTD,                                            *01653000
                   :CMBBAL01,                                          *01654000
                   :CMBBAL02,                                          *01655000
                   :CMBBAL03,                                          *01656000
                   :CMBBAL04,                                          *01657000
                   :CMBBAL05,                                          *01658000
                   :CMBBAL06,                                          *01659000
                   :CMBBAL07,                                          *01660000
                   :CMBBAL08,                                          *01661000
                   :CMBBAL09,                                          *01662000
                   :CMBBAL10,                                          *01663000
                   :CMBBAL11,                                          *01664000
                   :CMBBAL12,                                          *01665000
                   :DATEOPN,                                           *01666000
                   :RAREA                                              *01667000
                 FROM SAK                                              *01668000
                 WHERE                                                 *01669000
                   ACCT_INST_2 = :INST2 AND                            *01670000
                   PROD_CODE_2 = :PRDCDE2 AND                          *01671000
                   ACCT_NBR_2 = :ACCTNBR2                              *01672000
                 FETCH FIRST 1 ROW ONLY                                 01673000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    01674000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01675000
         BALR  14,15                   MOVE REQUESTED DATA              01676000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01677000
         BR    14                      RETURN TO CALLER                 01678000
         LTORG                                                          01679000
*                                                                       01680000
**********************************************************************  01681000
* SELECT COUNT STATEMENT BY ALTERNATE KEY 1:                            01682000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01683000
**********************************************************************  01684000
*                                                                       01685000
SELKY1   DS    0H                                                       01686000
         USING SELKY1,12               ESTABLISH BASE REGISTER          01687000
         MVI   SQWKMRP,X'40'           MOVE RECORD TO HOST FOR KEY 1    01688000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01689000
         BALR  14,15                   MOVE REQUESTED DATA              01690000
         EXEC  SQL SELECT                                              *01691000
                   COUNT(*)                                            *01692000
                 INTO                                                  *01693000
                   :SQWINTHV                                           *01694000
                 FROM SAK                                              *01695000
                 WHERE                                                 *01696000
                   ACCT_INST_2 = :INST2 AND                            *01697000
                   PROD_CODE_2 = :PRDCDE2 AND                          *01698000
                   ACCT_NBR_2 = :ACCTNBR2                              *01699000
                 FETCH FIRST 1 ROW ONLY                                 01700000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01701000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            01702000
         BNER  14                      NO - RETURN TO CALLER            01703000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     01704000
         BNER  14                      YES - RETURN ZERO SQLCODE        01705000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     01706000
         BR    14                      RETURN TO CALLER                 01707000
         LTORG                                                          01708000
*                                                                       01709000
**********************************************************************  01710000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  01711000
* KEY 1:                                                                01712000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         01713000
*     AND GET-NEXT-LOCK VERBS.                                          01714000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              01715000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                01716000
**********************************************************************  01717000
*                                                                       01718000
SELXC1   DS    0H                                                       01719000
         USING SELXC1,12               ESTABLISH BASE REGISTER          01720000
         MVI   SQWKMRP,X'46'           SET HOST KEY 1 & CURSOR POINTER  01721000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01722000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   01723000
         LA    12,SELXC1P              LOAD VECTOR TABLE ADDRESS        01724000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  01725000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        01726000
         BR    12                      GO TO CURSOR OPEN ROUTINE        01727000
SELXC1P  DC    A(SELGE101)                                              01728000
         DC    (KY1COLMS-01)A(0)                                        01729000
         DC    A(SELGE102)                                              01730000
         DC    (KY1COLMS-02)A(0)                                        01731000
         DC    A(SELGE103)                                              01732000
         LTORG                                                          01733000
*                                                                       01734000
SELGE101 DS    0H                                                       01735000
         USING SELGE101,12             ESTABLISH BASE REGISTER          01736000
         EXEC  SQL DECLARE SAKGE101 CURSOR                             *01737000
               WITH ROWSET POSITIONING                                 *01738000
               FOR SELECT                                              *01739000
                   ACCT_INST_1,                                        *01740000
                   PROD_CODE_1,                                        *01741000
                   ACCT_NBR_1,                                         *01742000
                   MODEL_1,                                            *01743000
                   ACCT_INST_2,                                        *01744000
                   PROD_CODE_2,                                        *01745000
                   ACCT_NBR_2,                                         *01746000
                   AUDIT_DATE,                                         *01747000
                   AUDIT_TIME,                                         *01748000
                   AUDIT_USER,                                         *01749000
                   AUDIT_ORG,                                          *01750000
                   IDENT_NBR,                                          *01751000
                   BAL_OPT,                                            *01752000
                   PCT_USED,                                           *01753000
                   LST_CMB_BAL_USE,                                    *01754000
                   FREQUENCY,                                          *01755000
                   TERM,                                               *01756000
                   DAY_MONTH,                                          *01757000
                   NEXT_DATE,                                          *01758000
                   LAST_DATE,                                          *01759000
                   AMOUNT,                                             *01760000
                   LAST_AMT,                                           *01761000
                   AMOUNT_YTD,                                         *01762000
                   MTH_CMB_BAL_01,                                     *01763000
                   MTH_CMB_BAL_02,                                     *01764000
                   MTH_CMB_BAL_03,                                     *01765000
                   MTH_CMB_BAL_04,                                     *01766000
                   MTH_CMB_BAL_05,                                     *01767000
                   MTH_CMB_BAL_06,                                     *01768000
                   MTH_CMB_BAL_07,                                     *01769000
                   MTH_CMB_BAL_08,                                     *01770000
                   MTH_CMB_BAL_09,                                     *01771000
                   MTH_CMB_BAL_10,                                     *01772000
                   MTH_CMB_BAL_11,                                     *01773000
                   MTH_CMB_BAL_12,                                     *01774000
                   DATE_OPEN,                                          *01775000
                   RSV_AREA                                            *01776000
                 FROM SAK                                              *01777000
                 WHERE                                                 *01778000
                   ACCT_INST_2 = :INST2 AND                            *01779000
                   PROD_CODE_2 = :PRDCDE2 AND                          *01780000
                   ACCT_NBR_2 >=                                       *01781000
                     :ACCTNBR2                                         *01782000
                 ORDER BY ACCT_NBR_2 ASC                               *01783000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01784000
         EXEC  SQL OPEN SAKGE101                                        01785000
         MVC   SQWCSRCA,=A(CLSGE101)   SET CURSOR CLOSE ROUTINE ADDRESS 01786000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01787000
         BR    14                      RETURN TO CALLER                 01788000
         LTORG                                                          01789000
*                                                                       01790000
SELGE102 DS    0H                                                       01791000
         USING SELGE102,12             ESTABLISH BASE REGISTER          01792000
         EXEC  SQL DECLARE SAKGE102 CURSOR                             *01793000
               WITH ROWSET POSITIONING                                 *01794000
               FOR SELECT                                              *01795000
                   ACCT_INST_1,                                        *01796000
                   PROD_CODE_1,                                        *01797000
                   ACCT_NBR_1,                                         *01798000
                   MODEL_1,                                            *01799000
                   ACCT_INST_2,                                        *01800000
                   PROD_CODE_2,                                        *01801000
                   ACCT_NBR_2,                                         *01802000
                   AUDIT_DATE,                                         *01803000
                   AUDIT_TIME,                                         *01804000
                   AUDIT_USER,                                         *01805000
                   AUDIT_ORG,                                          *01806000
                   IDENT_NBR,                                          *01807000
                   BAL_OPT,                                            *01808000
                   PCT_USED,                                           *01809000
                   LST_CMB_BAL_USE,                                    *01810000
                   FREQUENCY,                                          *01811000
                   TERM,                                               *01812000
                   DAY_MONTH,                                          *01813000
                   NEXT_DATE,                                          *01814000
                   LAST_DATE,                                          *01815000
                   AMOUNT,                                             *01816000
                   LAST_AMT,                                           *01817000
                   AMOUNT_YTD,                                         *01818000
                   MTH_CMB_BAL_01,                                     *01819000
                   MTH_CMB_BAL_02,                                     *01820000
                   MTH_CMB_BAL_03,                                     *01821000
                   MTH_CMB_BAL_04,                                     *01822000
                   MTH_CMB_BAL_05,                                     *01823000
                   MTH_CMB_BAL_06,                                     *01824000
                   MTH_CMB_BAL_07,                                     *01825000
                   MTH_CMB_BAL_08,                                     *01826000
                   MTH_CMB_BAL_09,                                     *01827000
                   MTH_CMB_BAL_10,                                     *01828000
                   MTH_CMB_BAL_11,                                     *01829000
                   MTH_CMB_BAL_12,                                     *01830000
                   DATE_OPEN,                                          *01831000
                   RSV_AREA                                            *01832000
                 FROM SAK                                              *01833000
                 WHERE                                                 *01834000
                   ACCT_INST_2 = :INST2 AND                            *01835000
                   PROD_CODE_2 >=                                      *01836000
                     :PRDCDE2                                          *01837000
                 ORDER BY PROD_CODE_2 ASC,                             *01838000
                   ACCT_NBR_2 ASC                                      *01839000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01840000
         EXEC  SQL OPEN SAKGE102                                        01841000
         MVC   SQWCSRCA,=A(CLSGE102)   SET CURSOR CLOSE ROUTINE ADDRESS 01842000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01843000
         BR    14                      RETURN TO CALLER                 01844000
         LTORG                                                          01845000
*                                                                       01846000
SELGE103 DS    0H                                                       01847000
         USING SELGE103,12             ESTABLISH BASE REGISTER          01848000
         EXEC  SQL DECLARE SAKGE103 CURSOR                             *01849000
               WITH ROWSET POSITIONING                                 *01850000
               FOR SELECT                                              *01851000
                   ACCT_INST_1,                                        *01852000
                   PROD_CODE_1,                                        *01853000
                   ACCT_NBR_1,                                         *01854000
                   MODEL_1,                                            *01855000
                   ACCT_INST_2,                                        *01856000
                   PROD_CODE_2,                                        *01857000
                   ACCT_NBR_2,                                         *01858000
                   AUDIT_DATE,                                         *01859000
                   AUDIT_TIME,                                         *01860000
                   AUDIT_USER,                                         *01861000
                   AUDIT_ORG,                                          *01862000
                   IDENT_NBR,                                          *01863000
                   BAL_OPT,                                            *01864000
                   PCT_USED,                                           *01865000
                   LST_CMB_BAL_USE,                                    *01866000
                   FREQUENCY,                                          *01867000
                   TERM,                                               *01868000
                   DAY_MONTH,                                          *01869000
                   NEXT_DATE,                                          *01870000
                   LAST_DATE,                                          *01871000
                   AMOUNT,                                             *01872000
                   LAST_AMT,                                           *01873000
                   AMOUNT_YTD,                                         *01874000
                   MTH_CMB_BAL_01,                                     *01875000
                   MTH_CMB_BAL_02,                                     *01876000
                   MTH_CMB_BAL_03,                                     *01877000
                   MTH_CMB_BAL_04,                                     *01878000
                   MTH_CMB_BAL_05,                                     *01879000
                   MTH_CMB_BAL_06,                                     *01880000
                   MTH_CMB_BAL_07,                                     *01881000
                   MTH_CMB_BAL_08,                                     *01882000
                   MTH_CMB_BAL_09,                                     *01883000
                   MTH_CMB_BAL_10,                                     *01884000
                   MTH_CMB_BAL_11,                                     *01885000
                   MTH_CMB_BAL_12,                                     *01886000
                   DATE_OPEN,                                          *01887000
                   RSV_AREA                                            *01888000
                 FROM SAK                                              *01889000
                 WHERE                                                 *01890000
                   ACCT_INST_2 >=                                      *01891000
                     :INST2                                            *01892000
                 ORDER BY ACCT_INST_2 ASC,                             *01893000
                   PROD_CODE_2 ASC,                                    *01894000
                   ACCT_NBR_2 ASC                                      *01895000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01896000
         EXEC  SQL OPEN SAKGE103                                        01897000
         MVC   SQWCSRCA,=A(CLSGE103)   SET CURSOR CLOSE ROUTINE ADDRESS 01898000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01899000
         BR    14                      RETURN TO CALLER                 01900000
         LTORG                                                          01901000
*                                                                       01902000
**********************************************************************  01903000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01904000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01905000
**********************************************************************  01906000
*                                                                       01907000
NXTXC1   DS    0H                                                       01908000
         USING NXTXC1,12               ESTABLISH BASE REGISTER          01909000
         MVI   SQWKMRP,X'47'           CLOSE CURSOR & SET HOST KEY 1    01910000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01911000
         BALR  14,15                   MOVE REQUESTED DATA              01912000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01913000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01914000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       01915000
         LA    12,NXTXC1P(1)           LOAD POINTER TO NEXT CURSOR      01916000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01917000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01918000
NXTXC1P  DC    A(0)                                                     01919000
         DC    A(NXTGT102)                                              01920000
         DC    A(NXTGT103)                                              01921000
         DC    A(NXTGT199)                                              01922000
         DC    A(NXTGT103)                                              01923000
         DC    A(NXTGT199)                                              01924000
         DC    A(NXTGT199)                                              01925000
NXTGT199 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       01926000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   01927000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    01928000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     01929000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      01930000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01931000
         BR    14                      RETURN TO SQI                    01932000
         LTORG                                                          01933000
*                                                                       01934000
NXTGT102 DS    0H                                                       01935000
         USING NXTGT102,12             ESTABLISH BASE REGISTER          01936000
         EXEC  SQL DECLARE SAKGT102 CURSOR                             *01937000
               WITH ROWSET POSITIONING                                 *01938000
               FOR SELECT                                              *01939000
                   ACCT_INST_1,                                        *01940000
                   PROD_CODE_1,                                        *01941000
                   ACCT_NBR_1,                                         *01942000
                   MODEL_1,                                            *01943000
                   ACCT_INST_2,                                        *01944000
                   PROD_CODE_2,                                        *01945000
                   ACCT_NBR_2,                                         *01946000
                   AUDIT_DATE,                                         *01947000
                   AUDIT_TIME,                                         *01948000
                   AUDIT_USER,                                         *01949000
                   AUDIT_ORG,                                          *01950000
                   IDENT_NBR,                                          *01951000
                   BAL_OPT,                                            *01952000
                   PCT_USED,                                           *01953000
                   LST_CMB_BAL_USE,                                    *01954000
                   FREQUENCY,                                          *01955000
                   TERM,                                               *01956000
                   DAY_MONTH,                                          *01957000
                   NEXT_DATE,                                          *01958000
                   LAST_DATE,                                          *01959000
                   AMOUNT,                                             *01960000
                   LAST_AMT,                                           *01961000
                   AMOUNT_YTD,                                         *01962000
                   MTH_CMB_BAL_01,                                     *01963000
                   MTH_CMB_BAL_02,                                     *01964000
                   MTH_CMB_BAL_03,                                     *01965000
                   MTH_CMB_BAL_04,                                     *01966000
                   MTH_CMB_BAL_05,                                     *01967000
                   MTH_CMB_BAL_06,                                     *01968000
                   MTH_CMB_BAL_07,                                     *01969000
                   MTH_CMB_BAL_08,                                     *01970000
                   MTH_CMB_BAL_09,                                     *01971000
                   MTH_CMB_BAL_10,                                     *01972000
                   MTH_CMB_BAL_11,                                     *01973000
                   MTH_CMB_BAL_12,                                     *01974000
                   DATE_OPEN,                                          *01975000
                   RSV_AREA                                            *01976000
                 FROM SAK                                              *01977000
                 WHERE                                                 *01978000
                   ACCT_INST_2 = :INST2 AND                            *01979000
                   PROD_CODE_2 >                                       *01980000
                     :PRDCDE2                                          *01981000
                 ORDER BY PROD_CODE_2 ASC,                             *01982000
                   ACCT_NBR_2 ASC                                      *01983000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01984000
         EXEC  SQL OPEN SAKGT102                                        01985000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01986000
         BNZ   *+14                    NO - RETURN ERROR                01987000
         MVC   SQWCSRCA,=A(CLSGT102)   SET CURSOR CLOSE ROUTINE ADDRESS 01988000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01989000
         BR    12                      RETURN TO FETCH ROUTINE          01990000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01991000
         BR    14                      RETURN TO CALLER                 01992000
         LTORG                                                          01993000
*                                                                       01994000
NXTGT103 DS    0H                                                       01995000
         USING NXTGT103,12             ESTABLISH BASE REGISTER          01996000
         EXEC  SQL DECLARE SAKGT103 CURSOR                             *01997000
               WITH ROWSET POSITIONING                                 *01998000
               FOR SELECT                                              *01999000
                   ACCT_INST_1,                                        *02000000
                   PROD_CODE_1,                                        *02001000
                   ACCT_NBR_1,                                         *02002000
                   MODEL_1,                                            *02003000
                   ACCT_INST_2,                                        *02004000
                   PROD_CODE_2,                                        *02005000
                   ACCT_NBR_2,                                         *02006000
                   AUDIT_DATE,                                         *02007000
                   AUDIT_TIME,                                         *02008000
                   AUDIT_USER,                                         *02009000
                   AUDIT_ORG,                                          *02010000
                   IDENT_NBR,                                          *02011000
                   BAL_OPT,                                            *02012000
                   PCT_USED,                                           *02013000
                   LST_CMB_BAL_USE,                                    *02014000
                   FREQUENCY,                                          *02015000
                   TERM,                                               *02016000
                   DAY_MONTH,                                          *02017000
                   NEXT_DATE,                                          *02018000
                   LAST_DATE,                                          *02019000
                   AMOUNT,                                             *02020000
                   LAST_AMT,                                           *02021000
                   AMOUNT_YTD,                                         *02022000
                   MTH_CMB_BAL_01,                                     *02023000
                   MTH_CMB_BAL_02,                                     *02024000
                   MTH_CMB_BAL_03,                                     *02025000
                   MTH_CMB_BAL_04,                                     *02026000
                   MTH_CMB_BAL_05,                                     *02027000
                   MTH_CMB_BAL_06,                                     *02028000
                   MTH_CMB_BAL_07,                                     *02029000
                   MTH_CMB_BAL_08,                                     *02030000
                   MTH_CMB_BAL_09,                                     *02031000
                   MTH_CMB_BAL_10,                                     *02032000
                   MTH_CMB_BAL_11,                                     *02033000
                   MTH_CMB_BAL_12,                                     *02034000
                   DATE_OPEN,                                          *02035000
                   RSV_AREA                                            *02036000
                 FROM SAK                                              *02037000
                 WHERE                                                 *02038000
                   ACCT_INST_2 >                                       *02039000
                     :INST2                                            *02040000
                 ORDER BY ACCT_INST_2 ASC,                             *02041000
                   PROD_CODE_2 ASC,                                    *02042000
                   ACCT_NBR_2 ASC                                      *02043000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02044000
         EXEC  SQL OPEN SAKGT103                                        02045000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02046000
         BNZ   *+14                    NO - RETURN ERROR                02047000
         MVC   SQWCSRCA,=A(CLSGT103)   SET CURSOR CLOSE ROUTINE ADDRESS 02048000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              02049000
         BR    12                      RETURN TO FETCH ROUTINE          02050000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02051000
         BR    14                      RETURN TO CALLER                 02052000
         LTORG                                                          02053000
*                                                                       02054000
**********************************************************************  02055000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           02056000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              02057000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          02058000
*     RETRIEVE THE ACTUAL ROW.                                          02059000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             02060000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                02061000
**********************************************************************  02062000
*                                                                       02063000
FETDC1   DS    0H                                                       02064000
         USING FETDC1,12               ESTABLISH BASE REGISTER          02065000
         MVC   SQWCSRRA,=A(FETDC1)     SET RETURN ROUTINE ADDRESS       02066000
         MVC   SQWCSRBR,=A(NXTXC1)     SET CURSOR ROUTINE ADDRESS       02067000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       02068000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      02069000
         LA    12,FETDC1P(1)           LOAD POINTER TO FETCH ROUTINE    02070000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       02071000
         BR    12                      GO TO CURRENT FETCH ROUTINE      02072000
FETDC1P  DC    A(FETGE101)                                              02073000
         DC    A(FETGT102)                                              02074000
         DC    A(FETGT103)                                              02075000
         DC    A(FETGE102)                                              02076000
         DC    A(FETGT103)                                              02077000
         DC    A(FETGE103)                                              02078000
         DC    A(0)                                                     02079000
         LTORG                                                          02080000
*                                                                       02081000
**********************************************************************  02082000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        02083000
* ALTERNATE KEY 1:                                                      02084000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           02085000
*     VERBS.                                                            02086000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          02087000
*     RETRIEVE THE ACTUAL ROW.                                          02088000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    02089000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             02090000
*     WILL BE THRU THE UPDATE CURSOR.                                   02091000
**********************************************************************  02092000
*                                                                       02093000
FETKC1   DS    0H                                                       02094000
         USING FETKC1,12               ESTABLISH BASE REGISTER          02095000
         MVC   SQWCSRRA,=A(FETKC1)     SET RETURN ROUTINE ADDRESS       02096000
         MVC   SQWCSRBR,=A(NXTXC1)     SET CURSOR ROUTINE ADDRESS       02097000
         MVC   SQWRSFVC,=AL2(KY1COLMS) ONLY FETCH KEY COLUMNS           02098000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      02099000
         LA    12,FETKC1P(1)           LOAD POINTER TO FETCH ROUTINE    02100000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       02101000
         BR    12                      GO TO CURRENT FETCH ROUTINE      02102000
FETKC1P  DC    A(FETGE101)                                              02103000
         DC    A(FETGT102)                                              02104000
         DC    A(FETGT103)                                              02105000
         DC    A(FETGE102)                                              02106000
         DC    A(FETGT103)                                              02107000
         DC    A(FETGE103)                                              02108000
         DC    A(0)                                                     02109000
         LTORG                                                          02110000
*                                                                       02111000
FETGE101 DS    0H                                                       02112000
         USING FETGE101,12             ESTABLISH BASE REGISTER          02113000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    02114000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02115000
         BALR  14,15                   MOVE REQUESTED DATA              02116000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE101                     *02117000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             02118000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   02119000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02120000
         BALR  14,15                   MOVE REQUESTED DATA              02121000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02122000
         BR    14                      RETURN TO CALLER                 02123000
         LTORG                                                          02124000
*                                                                       02125000
FETGE102 DS    0H                                                       02126000
         USING FETGE102,12             ESTABLISH BASE REGISTER          02127000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    02128000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02129000
         BALR  14,15                   MOVE REQUESTED DATA              02130000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE102                     *02131000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             02132000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   02133000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02134000
         BALR  14,15                   MOVE REQUESTED DATA              02135000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02136000
         BR    14                      RETURN TO CALLER                 02137000
         LTORG                                                          02138000
*                                                                       02139000
FETGE103 DS    0H                                                       02140000
         USING FETGE103,12             ESTABLISH BASE REGISTER          02141000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    02142000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02143000
         BALR  14,15                   MOVE REQUESTED DATA              02144000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGE103                     *02145000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             02146000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   02147000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02148000
         BALR  14,15                   MOVE REQUESTED DATA              02149000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02150000
         BR    14                      RETURN TO CALLER                 02151000
         LTORG                                                          02152000
*                                                                       02153000
FETGT102 DS    0H                                                       02154000
         USING FETGT102,12             ESTABLISH BASE REGISTER          02155000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    02156000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02157000
         BALR  14,15                   MOVE REQUESTED DATA              02158000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT102                     *02159000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             02160000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   02161000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02162000
         BALR  14,15                   MOVE REQUESTED DATA              02163000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02164000
         BR    14                      RETURN TO CALLER                 02165000
         LTORG                                                          02166000
*                                                                       02167000
FETGT103 DS    0H                                                       02168000
         USING FETGT103,12             ESTABLISH BASE REGISTER          02169000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    02170000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02171000
         BALR  14,15                   MOVE REQUESTED DATA              02172000
         EXEC  SQL FETCH NEXT ROWSET FROM SAKGT103                     *02173000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             02174000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   02175000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   02176000
         BALR  14,15                   MOVE REQUESTED DATA              02177000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02178000
         BR    14                      RETURN TO CALLER                 02179000
         LTORG                                                          02180000
*                                                                       02181000
**********************************************************************  02182000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                02183000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          02184000
*     AND GET-NEXT-LOCK VERBS.                                          02185000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      02186000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   02187000
**********************************************************************  02188000
*                                                                       02189000
CLSXC1   DS    0H                                                       02190000
         USING CLSXC1,12               ESTABLISH BASE REGISTER          02191000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 02192000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  02193000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       02194000
         LTORG                                                          02195000
*                                                                       02196000
CLSGE101 DS    0H                                                       02197000
         USING CLSGE101,12             ESTABLISH BASE REGISTER          02198000
         EXEC  SQL CLOSE SAKGE101                                       02199000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02200000
         BR    14                      RETURN TO CALLER                 02201000
         LTORG                                                          02202000
*                                                                       02203000
CLSGE102 DS    0H                                                       02204000
         USING CLSGE102,12             ESTABLISH BASE REGISTER          02205000
         EXEC  SQL CLOSE SAKGE102                                       02206000
         L     14,SQW@RET                                               02207000
         BR    14                                                       02208000
         LTORG                                                          02209000
*                                                                       02210000
CLSGE103 DS    0H                                                       02211000
         USING CLSGE103,12             ESTABLISH BASE REGISTER          02212000
         EXEC  SQL CLOSE SAKGE103                                       02213000
         L     14,SQW@RET                                               02214000
         BR    14                                                       02215000
         LTORG                                                          02216000
*                                                                       02217000
CLSGT102 DS    0H                                                       02218000
         USING CLSGT102,12             ESTABLISH BASE REGISTER          02219000
         EXEC  SQL CLOSE SAKGT102                                       02220000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02221000
         BR    14                      RETURN TO CALLER                 02222000
         LTORG                                                          02223000
*                                                                       02224000
CLSGT103 DS    0H                                                       02225000
         USING CLSGT103,12             ESTABLISH BASE REGISTER          02226000
         EXEC  SQL CLOSE SAKGT103                                       02227000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02228000
         BR    14                      RETURN TO CALLER                 02229000
         LTORG                                                          02230000
*                                                                       02231000
*                                                                       02232000
**********************************************************************  02233000
* ALTERNATE KEY 2 NOT DEFINED                                           02234000
**********************************************************************  02235000
*                                                                       02236000
SELIN2   DS    0H                                                       02237000
SELKY2   DS    0H                                                       02238000
SELXC2   DS    0H                                                       02239000
FETDC2   DS    0H                                                       02240000
FETKC2   DS    0H                                                       02241000
CLSXC2   DS    0H                                                       02242000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 02243000
*                                                                       02244000
**********************************************************************  02245000
* ALTERNATE KEY 3 NOT DEFINED                                           02246000
**********************************************************************  02247000
*                                                                       02248000
SELIN3   DS    0H                                                       02249000
SELKY3   DS    0H                                                       02250000
SELXC3   DS    0H                                                       02251000
FETDC3   DS    0H                                                       02252000
FETKC3   DS    0H                                                       02253000
CLSXC3   DS    0H                                                       02254000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 02255000
*                                                                       02256000
         DS    0H                      END OF SQL STATEMENTS            02257000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02258000
*                                                                       02259000
**********************************************************************  02260000
* DUMMY ENTRY POINT DSNHLI                                              02261000
**********************************************************************  02262000
*                                                                       02263000
         ENTRY DSNHLI                                                   02264000
DSNHLI   DS    0H                                                       02265000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02266000
         BR    15                      BRANCH TO ATTACH FACILITY        02267000
*                                                                       02268000
**********************************************************************  02269000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02270000
**********************************************************************  02271000
*                                                                       02272000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       02273000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      02274000
* OR:                                                                   02275000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      02276000
* WHERE:                                                                02277000
*   RRRR = RECORD AREA OFFSET                                           02278000
*   VVVV = HOST VARIABLE AREA OFFSET                                    02279000
*   LLLL = HALFWORD LENGTH TO MOVE                                      02280000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       02281000
*   KK   = KEY FIELD MASK:                                              02282000
*            80 = KEY 0 FIELD                                           02283000
*            40 = KEY 1 FIELD                                           02284000
*            20 = KEY 2 FIELD                                           02285000
*            10 = KEY 3 FIELD                                           02286000
*   DD   = DATA FIELD MASK:                                             02287000
*            80 = RECORD FIELD IS PACKED                                02288000
*            40 = HOST VARIABLE IS PACKED                               02289000
*            20 = NULLABLE FIELD                                        02290000
*            01 = DATE FIELD                                            02291000
*            02 = TIME FIELD                                            02292000
*                                                                       02293000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 02294000
         DC    H'0000',H'0000',H'0038',X'80',X'00'                      02295000
         DC    H'0038',H'0038',H'0028',X'C0',X'00'                      02296000
         DC    H'0066',H'0066',H'0237',X'00',X'00'                      02297000
         DC    8X'FF'                                                   02298000
*                                                                       02299000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               02300000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  02301000
* OR:                                                                   02302000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  02303000
* WHERE:                                                                02304000
*   RRRR = RECORD AREA OFFSET                                           02305000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     02306000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      02307000
*   TTTT = SQLDA DATA TYPE:                                             02308000
*            452 = CHAR       453 = CHAR NULLABLE                       02309000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    02310000
*            496 = INTEGER    497 = INTEGER NULLABLE                    02311000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   02312000
*                                                                       02313000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      02314000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 02315000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       02316000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    02317000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       02318000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       02319000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       02320000
         DC    AL2(00303)              SUMMATION OF ALL COLUMN LENGTHS  02321000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     02322000
         DC    AL2(01000)              ALT 1 MULTIROW FETCH ARRAY       02323000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       02324000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       02325000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      02326000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        02327000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        02328000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        02329000
CONVDATA DS    0H                                                       02330000
         DC    H'0000',H'0004',H'452'  ACCT_INST_1                      02331000
         DC    H'0004',H'0006',H'452'  PROD_CODE_1                      02332000
         DC    H'0010',H'0018',H'452'  ACCT_NBR_1                       02333000
         DC    H'0028',H'0010',H'452'  MODEL_1                          02334000
         DC    H'0038',H'0004',H'452'  ACCT_INST_2                      02335000
         DC    H'0042',H'0006',H'452'  PROD_CODE_2                      02336000
         DC    H'0048',H'0018',H'452'  ACCT_NBR_2                       02337000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   02338000
         DC    H'0066',X'0900',H'484'  AUDIT_DATE                       02339000
         DC    H'0071',X'0900',H'484'  AUDIT_TIME                       02340000
         DC    H'0076',H'0008',H'452'  AUDIT_USER                       02341000
         DC    H'0084',H'0006',H'452'  AUDIT_ORG                        02342000
         DC    H'0090',H'0018',H'452'  IDENT_NBR                        02343000
         DC    H'0108',H'0001',H'452'  BAL_OPT                          02344000
         DC    H'0109',X'0909',H'484'  PCT_USED                         02345000
         DC    H'0114',X'0F02',H'484'  LST_CMB_BAL_USE                  02346000
         DC    H'0122',H'0001',H'452'  FREQUENCY                        02347000
         DC    H'0123',X'0300',H'484'  TERM                             02348000
         DC    H'0125',H'0002',H'452'  DAY_MONTH                        02349000
         DC    H'0127',X'0900',H'484'  NEXT_DATE                        02350000
         DC    H'0132',X'0900',H'484'  LAST_DATE                        02351000
         DC    H'0137',X'0B02',H'484'  AMOUNT                           02352000
         DC    H'0143',X'0B02',H'484'  LAST_AMT                         02353000
         DC    H'0149',X'0F02',H'484'  AMOUNT_YTD                       02354000
         DC    H'0157',X'0F02',H'484'  MTH_CMB_BAL_01                   02355000
         DC    H'0165',X'0F02',H'484'  MTH_CMB_BAL_02                   02356000
         DC    H'0173',X'0F02',H'484'  MTH_CMB_BAL_03                   02357000
         DC    H'0181',X'0F02',H'484'  MTH_CMB_BAL_04                   02358000
         DC    H'0189',X'0F02',H'484'  MTH_CMB_BAL_05                   02359000
         DC    H'0197',X'0F02',H'484'  MTH_CMB_BAL_06                   02360000
         DC    H'0205',X'0F02',H'484'  MTH_CMB_BAL_07                   02361000
         DC    H'0213',X'0F02',H'484'  MTH_CMB_BAL_08                   02362000
         DC    H'0221',X'0F02',H'484'  MTH_CMB_BAL_09                   02363000
         DC    H'0229',X'0F02',H'484'  MTH_CMB_BAL_10                   02364000
         DC    H'0237',X'0F02',H'484'  MTH_CMB_BAL_11                   02365000
         DC    H'0245',X'0F02',H'484'  MTH_CMB_BAL_12                   02366000
         DC    H'0253',X'0900',H'484'  DATE_OPEN                        02367000
         DC    H'0258',H'0045',H'452'  RSV_AREA                         02368000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       02369000
KY0COLMS EQU   00007                   NUMBER OF PRIMARY KEY COLUMNS    02370000
KY1COLMS EQU   00003                   NUMBER OF ALT 1 KEY COLUMNS      02371000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      02372000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      02373000
*                                                                       02374000
         LTORG                                                          02375000
         END                                                            02376000
