000100 ID DIVISION.                                                     00000100
000200 PROGRAM-ID.    DRZWR011.                                         00000200
000300*AUTHOR.                  ITS-IM-DT.                              00000300
000400*DATE-WRITTEN.            08/2001                                 00000400
000500******************************************************************00000600
000600*                 D A T E N A U S G A B E S Y S T E M            *00000700
000700*  MODUL ZUR AUSGABE DER ERGEBNISDATEN. DIE IM PARAMETER         *00000800
000800*  UEBERGEBENEN ERGEBNISDATEN WERDEN UM DIE                      *00000900
000900*  BENOETIGTEN STEUERUNGSDATEN ERWEITERT UND IN ABHAENGIGKEIT    *00001000
001000*  DER UEBERGEBENEN SATZLAENGE AUSGEGEBEN.                       *00001100
001100*                                                                 00001300
001200*    EINGABEBEREICH WIE ZSAWR011                                  00001700
001300*                                                                 00001800
001400*    KEIN FSV; STAPELINFO AUS OPI-DATENBANK (DB2)                 00001900
001500*                                                                 00002000
001600*    NEUER AUFBAU DER AUSGABESAETZE (25-STELLIGER VORSPANN)       00002100
001700*                                                                 00002200
001800*                                                                 00002300
001900*  AENDERUNGEN:                                                   00002400
002000*    16.06.2005: SONDERFALL NETZ $SC618 --> KEIN JOBNAME IN       00002500
002100*                ABTEILUNGS-NR                                    00002600
002200*                                                                 00002900
002300*    08.12.2003: WENN ABTEILUNG-ZSAWR011 = ZERO WIRD DER JOBNAME  00003000
002400*                IN DAS FELD ABTEILUNG IM SORTIERVORSPANN         00003100
002500*                EINGEFüGT (NUR BEI $ ODER # IM JOBNAMEN)         00003200
002600*                IM TEST AUCH FUER U19743 --> *U*                 00003300
002700*                                                                 00003400
002800*    15.04.2002: VOR AUFRUF DRDBZ101 WIRD FELD ABT MIT ABT-NR     00003500
002900*                GEFUELLT (NEUER KEY IN TABELLE STAPEL)           00003600
003000*                WENN NICHT VORHANDEN: STANDARD-SATZ MIT 00000000 00003700
003100*                                                                 00003800
003200******************************************************************00003900
003300 ENVIRONMENT DIVISION.                                            00004000
003400 CONFIGURATION SECTION.                                           00004100
003500 SPECIAL-NAMES. SYSOUT IS BS.                                     00004200
003600*                                                                 00004300
003700 INPUT-OUTPUT SECTION.                                            00004400
003800 FILE-CONTROL.                                                    00004500
003900     SELECT ERGDAT ASSIGN  'ERGDAT'                               00004600
004000     FILE STATUS IS ZW-FILE-STAT.                                 00004700
004100/                                                                 00004800
004200 DATA DIVISION.                                                   00004900
004300 FILE SECTION.                                                    00005000
004400 FD  ERGDAT                                                       00005100
004500******???    BLOCK CONTAINS 0 RECORDS                             00005200
004600             RECORD IS VARYING IN SIZE                            00005300
004700             FROM 21 TO 2005                                      00005400
004800             DEPENDING ON ZW-SA-LAE.                              00005500
004900 01  ERG-SATZ                     PIC X(2005).                    00005600
005000/                                                                 00005700
005100 WORKING-STORAGE SECTION.                                         00005800
005200*                                           ALLG. FELDER          00005900
005300 01  ZW-FELDER.                                                   00006000
005400     10  ZW-FILE-STAT            PIC XX.                          00006100
005500     10  ZW-ZAEHL                PIC S9(12)  VALUE 0     COMP-3.  00006200
005600     10  ZW-SA-LAE               PIC  9999           BINARY.      00006300
005700     10  ZW-AUSG-SCHL-ZSAWR011   PIC X(12)   VALUE SPACE.         00006400
005800     10  ZW-UPRO                 PIC X(8).                        00006500
005900*                                                                 00006600
006000 01  ZW-JOBNAME.                                                  00006700
006100     10  ZW-JOBNAME-1-3.                                          00006800
006200         20  ZW-JOBNAME-1        PIC X.                           00006900
006300         20  FILLER              PIC X(2).                        00007000
006400     10  FILLER                  PIC X(3).                        00007100
006500     10  ZW-JOBNAME-7-8          PIC X(2).                        00007200
006600*                                                                 00007300
006700 01  ZW-U-JOBNAME.                                                00007400
006800     10  ZW-U-JOBNAME-1-6        PIC X(6).                        00007500
006900     10  FILLER                  PIC X(2).                        00007600
007000*                                                                 00007700
007100 01  ZW-ABT-JOB.                                                  00007800
007200     10  ZW-ABT-JOB-1-3          PIC X(3).                        00007900
007300     10  ZW-ABT-JOB-4-5          PIC X(2).                        00008000
007400************************************************************      00008100
007500*                                                                 00008200
007600*               ZWISCHENBEREICH FUER 20-STELLIGEN VORSPANN.       00008300
007700*               WIRD JEMALS ZW-KZ-OPEN VOM AUFRUFENDEN PROGRAMM   00008400
007800*               UEBERGEBEN ?                                      00008500
007900 01  ZW-STEUBER.                                                  00008600
008000     02  FILLER                   PIC X(12).                      00008700
008100     02  ZW-KZ-OPEN               PIC X.                          00008800
008200     02  FILLER                   PIC X(27).                      00008900
008300/                                                                 00009000
008400*                            ZWISCHENBEREICH ERGEBNISDATENSATZ    00009100
008500 01  ZW-ERG-SATZ.                                                 00009200
008600     02 ZW-E-SORT-FIX.                                            00009300
008700        03 ZW-E-DRUCK-KZ        PIC X.                            00009400
008800        03 ZW-E-PAPIER-SET      PIC X(5).                         00009500
008900        03 ZW-E-FORM-NR         PIC X(5).                         00009600
009000        03 ZW-E-SORTVAR.                                          00009700
009100           04 ZW-E-ABTEILUNG    PIC S9(8) COMP-3.                 00009800
009200           04 ZW-E-ABTEILUNG-A REDEFINES ZW-E-ABTEILUNG           00009900
009300                                PIC X(5).                         00010000
009400           04 ZW-E-AUSGABENR.                                     00010100
009500              05 ZW-E-ARBGEB    PIC X(4).                         00010200
009600              05 ZW-E-STAPEL    PIC S9(5) COMP-3.                 00010300
009700        03 FILLER REDEFINES ZW-E-SORTVAR.                         00010400
009800           04 ZW-E-AUSGABENR-R.                                   00010500
009900              05 ZW-E-ARBGEB-R  PIC X(4).                         00010600
010000              05 ZW-E-STAPEL-R  PIC S9(5) COMP-3.                 00010700
010100           04 ZW-E-ABTEILUNG-R  PIC S9(8) COMP-3.                 00010800
010200           04 ZW-E-ABTEILUNG-A-R REDEFINES ZW-E-ABTEILUNG-R       00010900
010300                                PIC X(5).                         00011000
010400        03  ZW-E-SORT-KZ        PIC X.                            00011100
010500        03  ZW-E-KONTROL        PIC X.                            00011200
010600     02 ZW-E-DATEN.                                               00011300
010700        03  ZW-E-DATEN-1        PIC X(0050).                      00011400
010800        03  ZW-E-DATEN-VZ       PIC X(0001).                      00011500
010900        03  ZW-E-DATEN-2        PIC X(1929).                      00011600
011000/                                                                 00011700
011100*                                                                 00011800
011200*                           PARAMETER DB-ZUGRIFFSMODUL (DRDBZ101) 00011900
011300*                                                                 00012000
011400 01  PARAM-DRDBZ101.                                              00012100
011500     COPY DRDBZ10A.                                               00012200
011600/                                                                 00012300
011700*                                                  SCHALTER       00012400
011800 01  MK-SCHALTER.                                                 00012500
011900     10  MK-ERGDAT-OPCL                 PIC X VALUE 'C'.          00012600
012000         88  MK-ERGDAT-OP               VALUE 'O'.                00012700
012100         88  MK-ERGDAT-CL               VALUE 'C'.                00012800
012200     10  MK-STAPEL-OK                   PIC X VALUE 'N'.          00012900
012300         88  MK-STAPEL-FEHL             VALUE 'F'.                00013000
012400         88  MK-STAPEL-VORH             VALUE 'V'.                00013100
012500     10  MK-FEHLER                      PIC X VALUE 'O'.          00013200
012600         88  MK-FEHL                    VALUE 'F'.                00013300
012700         88  MK-OK                      VALUE 'O'.                00013400
012800     10  MK-OPC                         PIC X VALUE 'N'.          00013500
012900         88  MK-OPC-JA                  VALUE 'J'.                00013600
013000         88  MK-OPC-NEIN                VALUE 'N'.                00013700
013100/                                                                 00013800
013200*                                                  MELDUNGEN      00013900
013300 01  ZW-MELDUNGEN.                                                00014000
013400     10  ZW-MELD-001.                                             00014100
013500         20  FILLER            PIC X(15)                          00014200
013600                               VALUE 'FALSCHES ESTZ: '.           00014300
013700         20  ZW-MELD-001-ESTZ  PIC X(02).                         00014400
013800*                                                                 00014500
013900***  10  ZW-MELD-002.                                             00014600
014000***      20  FILLER            PIC X(16)                          00014700
014100***                            VALUE 'PROGRAMM-ABBRUCH'.          00014800
014200*                                                                 00014900
014300     10  ZW-MELD-003.                                             00015000
014400         20  FILLER            PIC X(22)                          00015100
014500                               VALUE 'FEHLER BEI OPEN ERGDAT'.    00015200
014600         20  FILLER            PIC X(09) VALUE ' STATUS: '.       00015300
014700         20  ZW-MELD-003-STAT  PIC XX.                            00015400
014800*                                                                 00015500
014900     10  ZW-MELD-004.                                             00015600
015000         20  FILLER            PIC X(23)                          00015700
015100                               VALUE 'FEHLER BEI CLOSE ERGDAT'.   00015800
015200         20  FILLER            PIC X(09) VALUE ' STATUS: '.       00015900
015300         20  ZW-MELD-004-STAT  PIC XX.                            00016000
015400*                                                                 00016100
015500     10  ZW-MELD-005.                                             00016200
015600         20  FILLER                PIC X VALUE SPACE.             00016300
015700         20  ZW-MELD-005-ARBGEB    PIC X(04).                     00016400
015800         20  FILLER                PIC X VALUE SPACE.             00016500
015900         20  ZW-MELD-005-STAPEL    PIC 9(05).                     00016600
016000         20  FILLER                PIC X VALUE SPACE.             00016700
016100         20  ZW-MELD-005-ABTEILUNG PIC 9(08).                     00016800
016200         20  FILLER                PIC X VALUE SPACE.             00016900
016300         20  FILLER                PIC X(24)                      00017000
016400                               VALUE 'NICHT IN STAPELTABELLE: '.  00017100
016500*                                                                 00017200
016600     10  ZW-MELD-006.                                             00017300
016700         20  FILLER            PIC X(23)                          00017400
016800                               VALUE 'SATZLAENGE FEHLERHAFT  '.   00017500
016900*                                                                 00017600
017000     10  ZW-MELD-007.                                             00017700
017100         20  FILLER            PIC X(23)                          00017800
017200                               VALUE 'FEHLER BEI WRITE ERGDAT'.   00017900
017300         20  FILLER            PIC X(09) VALUE ' STATUS: '.       00018000
017400         20  ZW-MELD-007-STAT  PIC XX.                            00018100
017500*                                                                 00018200
017600***  10  ZW-MELD-008.                                             00018300
017700***      20  FILLER            PIC X(34) VALUE                    00018400
017800***                        'ARBEITSGEBIET NICHT IN DATENBANK: '.  00018500
017900***      20 ZW-MELD-008-ARBGEB PIC X(04).                         00018600
018000*                                                                 00018700
018100     10  ZW-MELD-009.                                             00018800
018200         20  FILLER            PIC X(09)                          00018900
018300                               VALUE 'SQLCODE: '.                 00019000
018400         20  ZW-MELD-009-SQL   PIC -9(5).                         00019100
018500*                                                                 00019200
018600     10  ZW-MELD-010.                                             00019300
018700         20  FILLER            PIC X(35)                          00019400
018800                  VALUE 'KEIN AUFRUF SU VOR OP ZULAESSIG.'.       00019500
018900*                                                                 00019600
019000     10  ZW-MELD-011.                                             00019700
019100         20  FILLER            PIC X(35)                          00019800
019200                  VALUE 'ERNEUTER AUFRUF NACH ASTZ = FE .'.       00019900
019300/                                                                 00020000
019400*                                       PARAMETER ZZG00011        00020100
019500 01  PARAM-ZZG00011.                                              00020200
019600     COPY ZZG0001A.                                               00020300
019700/                                                                 00020400
019800*  PARAMETER FüR GDAZ0041                                         00020500
019900 01 PARAM-GDAZ0041.                                               00020600
020000    05 PARAM-GDAZ0041-JOBNAME.                                    00020700
020100       10 PARAM-GDAZ0041-NETZ  PIC X(06).                         00020800
020200       10 FILLER               PIC X(02).                         00020900
020300    05 PARAM-GDAZ0041-JOBNR    PIC X(05).                         00021000
020400    05 PARAM-GDAZ0041-USERID   PIC X(08).                         00021100
020500/                                                                 00021200
020600 LINKAGE SECTION.                                                 00021300
020700*                                         UEBERGABE-BEREICH       00021400
020800 01  PARAM-DRZWR011.                                              00021500
020900                             COPY DRZWR01A.                       00021600
021000/                                                                 00021700
021100 PROCEDURE DIVISION USING PARAM-DRZWR011.                         00021800
021200*                                             STEUERUNG           00021900
021300 STEUER SECTION.                                                  00022000
021400 STEUER-001.                                                      00022100
021500     MOVE SPACES TO ASTZ-ZSAWR011.                                00022200
021600*                                                                 00022300
021700     IF MK-FEHL                                                   00022400
021800           MOVE '11'          TO ZZG0001-MELD-NR                  00022500
021900           MOVE ZW-MELD-011   TO ZZG0001-MELD1                    00022600
022000           PERFORM CALL-ZZG00011                                  00022700
022100           MOVE 'FE' TO ASTZ-ZSAWR011                             00022800
022200           GO TO STEUER-999.                                      00022900
022300*                                                                 00023000
022400     IF ESTZ-ZSAWR011 = 'OP'                                      00023100
022500           PERFORM OEFFNEN-DATEIEN                                00023200
022600           GO TO STEUER-999.                                      00023300
022700*                                                                 00023400
022800     IF ESTZ-ZSAWR011 = 'SU'                                      00023500
022900           PERFORM VERARBEITUNG                                   00023600
023000           GO TO STEUER-999.                                      00023700
023100*                                                                 00023800
023200     IF ESTZ-ZSAWR011 = 'CL'                                      00023900
023300           PERFORM SCHLIESSEN-DATEIEN                             00024000
023400           GO TO STEUER-999.                                      00024100
023500*                                                                 00024200
023600     IF ESTZ-ZSAWR011 NOT = 'OE'                                  00024300
023700        MOVE ESTZ-ZSAWR011 TO ZW-MELD-001-ESTZ                    00024400
023800        MOVE '01'          TO ZZG0001-MELD-NR                     00024500
023900        MOVE ZW-MELD-001   TO ZZG0001-MELD1                       00024600
024000        PERFORM CALL-ZZG00011                                     00024700
024100        SET MK-FEHL TO TRUE                                       00024800
024200        MOVE 'FE' TO ASTZ-ZSAWR011.                               00024900
024300 STEUER-999.                                                      00025000
024400     EXIT PROGRAM.                                                00025100
024500/                                                                 00025200
024600*                                          OEFFNEN ERRDAT         00025300
024700 OEFFNEN-DATEIEN SECTION.                                         00025400
024800 OD-01.                                                           00025500
024900     IF MK-ERGDAT-OP                                              00025600
025000        GO TO OD-99.                                              00025700
025100*                                                                 00025800
025200     MOVE STEUERBEREICH-ZSAWR011 TO ZW-STEUBER.                   00025900
025300*                                           STEHT IN ZW-KZ-OPEN   00026000
025400*                                           JEMALS F ???          00026100
025500     IF  ZW-KZ-OPEN = 'F'                                         00026200
025600         OPEN EXTEND ERGDAT                                       00026300
025700     ELSE                                                         00026400
025800         OPEN OUTPUT ERGDAT                                       00026500
025900     END-IF.                                                      00026600
026000*                                                                 00026700
026100     IF ZW-FILE-STAT > ZERO                                       00026800
026200        MOVE ZW-FILE-STAT TO ZW-MELD-003-STAT                     00026900
026300        MOVE '03' TO ZZG0001-MELD-NR                              00027000
026400        MOVE ZW-MELD-003 TO ZZG0001-MELD1                         00027100
026500        PERFORM CALL-ZZG00011                                     00027200
026600        MOVE 'FE' TO ASTZ-ZSAWR011                                00027300
026700        SET MK-FEHL TO TRUE                                       00027400
026800        GO TO OD-99.                                              00027500
026900*                                                                 00027600
027000     SET MK-ERGDAT-OP TO TRUE.                                    00027700
027100     SET MK-OPC-NEIN  TO TRUE.                                    00027800
027200*                                                                 00027900
027300     MOVE 'TE' TO ASTZ-ZSAWR011.                                  00028000
027400*                                                                 00028100
027500     PERFORM CALL-GDAZ0041                                        00028200
027600*                                                                 00028300
027700     MOVE PARAM-GDAZ0041-JOBNAME TO ZW-JOBNAME.                   00028400
027800*                                                                 00028500
027900     IF ZW-JOBNAME-1 = '$' OR '#'                                 00028600
028000        SET MK-OPC-JA            TO TRUE                          00028700
028100        MOVE ZW-JOBNAME-1-3      TO ZW-ABT-JOB-1-3                00028800
028200        MOVE ZW-JOBNAME-7-8      TO ZW-ABT-JOB-4-5                00028900
028300     END-IF.                                                      00029000
028400*                                                                 00029100
028500*    SONDERFALL NETZ $SC618 : KEIN JOBNAME IN ABT-NR-FELD IM      00029200
028600*                             SORTIERVORSPANN WEGEN ZUSAMMEN-     00029300
028700*                             FUEHREN STAPEL.                     00029400
028800*                                                                 00029500
028900     MOVE PARAM-GDAZ0041-JOBNAME TO ZW-U-JOBNAME.                 00029600
029000     IF ZW-U-JOBNAME-1-6 = '$SC618'                               00029706
029100        SET MK-OPC-NEIN TO TRUE                                   00029803
029200     END-IF.                                                      00029900
029300*U*                                                               00030000
029400*U*                                 FUER TEST *U* ENTFERNEN !!!!  00030100
029500*U*                                                               00030200
029600*U*                                                               00030300
029700*U*  IF ZW-U-JOBNAME-1-6 = 'U19743'                               00030400
029800*U*     SET MK-OPC-JA            TO TRUE                          00030500
029900*U*     MOVE ZW-JOBNAME-1-3      TO ZW-ABT-JOB-1-3                00030600
030000*U*     MOVE ZW-JOBNAME-7-8      TO ZW-ABT-JOB-4-5                00030700
030100*U*  END-IF.                                                      00030800
030200*U*                                                               00030900
030300 OD-99.                                                           00031000
030400     EXIT.                                                        00031100
030500/                                                                 00031600
030600*                                            AUSGABE ERG-SATZ     00031700
030700 VERARBEITUNG SECTION.                                            00031800
030800 VA-01.                                                           00031900
030900     IF MK-ERGDAT-CL                                              00032000
031000          MOVE ZW-MELD-010         TO ZZG0001-MELD1               00032100
031100          PERFORM CALL-ZZG00011                                   00032200
031200          MOVE 'FE' TO ASTZ-ZSAWR011                              00032300
031300          SET MK-FEHL TO TRUE                                     00032400
031400          GO TO VA-99.                                            00032500
031500*                                                                 00032600
031600     MOVE EDAT-ZSAWR011 TO ZW-E-DATEN.                            00032700
031700*                                                                 00032800
031800     IF   ZW-AUSG-SCHL-ZSAWR011 = AUSG-SCHL-ZSAWR011  AND         00032900
031900          MK-STAPEL-FEHL                                          00033000
032000          MOVE ARBGEB-ZSAWR011     TO ZW-MELD-005-ARBGEB          00033100
032100          MOVE STAPELNR-ZSAWR011   TO ZW-MELD-005-STAPEL          00033200
032200          MOVE ABTEILUNG-ZSAWR011  TO ZW-MELD-005-ABTEILUNG       00033300
032300          MOVE '05'                TO ZZG0001-MELD-NR             00033400
032400          MOVE ZW-MELD-005         TO ZZG0001-MELD1               00033500
032500          PERFORM CALL-ZZG00011                                   00033600
032600          MOVE 'FE' TO ASTZ-ZSAWR011                              00033700
032700          SET MK-FEHL TO TRUE                                     00033800
032800          GO TO VA-99.                                            00033900
032900*                                                                 00034000
033000     IF   ZW-AUSG-SCHL-ZSAWR011 NOT = AUSG-SCHL-ZSAWR011          00034100
033100          MOVE AUSG-SCHL-ZSAWR011 TO ZW-AUSG-SCHL-ZSAWR011        00034200
033200          PERFORM FUELLEN-SORT-FIX.                               00034300
033300*                                                                 00034400
033400     IF   MK-STAPEL-FEHL                                          00034500
033500          MOVE ARBGEB-ZSAWR011     TO ZW-MELD-005-ARBGEB          00034600
033600          MOVE STAPELNR-ZSAWR011   TO ZW-MELD-005-STAPEL          00034700
033700          MOVE ABTEILUNG-ZSAWR011  TO ZW-MELD-005-ABTEILUNG       00034800
033800          MOVE '05'                TO ZZG0001-MELD-NR             00034900
033900          MOVE ZW-MELD-005         TO ZZG0001-MELD1               00035000
034000          PERFORM CALL-ZZG00011                                   00035100
034100          MOVE 'FE' TO ASTZ-ZSAWR011                              00035200
034200          SET MK-FEHL TO TRUE                                     00035300
034300          GO TO VA-99.                                            00035400
034400*                                                                 00035500
034500     IF   LAE-ZSAWR011 < 21 OR > 2005                             00035600
034600          MOVE '06'                TO ZZG0001-MELD-NR             00035700
034700          MOVE ZW-MELD-006         TO ZZG0001-MELD1               00035800
034800          PERFORM CALL-ZZG00011                                   00035900
034900          MOVE 'FE' TO ASTZ-ZSAWR011                              00036000
035000          SET MK-FEHL TO TRUE                                     00036100
035100          GO TO VA-99.                                            00036200
035200*                                                                 00036300
035300     MOVE LAE-ZSAWR011     TO ZW-SA-LAE.                          00036400
035400*                                                                 00036600
035500     WRITE ERG-SATZ FROM ZW-ERG-SATZ.                             00036700
035600*                                                                 00036900
035700     IF ZW-FILE-STAT > ZERO                                       00037000
035800        MOVE ZW-FILE-STAT TO ZW-MELD-007-STAT                     00037100
035900        MOVE '07'        TO ZZG0001-MELD-NR                       00037200
036000        MOVE ZW-MELD-007 TO ZZG0001-MELD1                         00037300
036100        PERFORM CALL-ZZG00011                                     00037400
036200        MOVE 'FE' TO ASTZ-ZSAWR011                                00037500
036300        SET MK-FEHL TO TRUE                                       00037600
036400        GO TO VA-99.                                              00037700
036500*                                                                 00037800
036600     ADD  1     TO ZW-ZAEHL.                                      00037900
036700     MOVE ZW-ZAEHL TO ZAEHLER-ZSAWR011.                           00038000
036800     MOVE 'SA'  TO ASTZ-ZSAWR011.                                 00038100
036900 VA-99.                                                           00038200
037000     EXIT.                                                        00038300
037100/                                                                 00038400
037200*                                       SCHLIESSEN ERGDAT         00038500
037300 SCHLIESSEN-DATEIEN SECTION.                                      00038600
037400 SD-01.                                                           00038700
037500     IF MK-ERGDAT-CL                                              00038800
037600        GO TO SD-99.                                              00038900
037700*                                                                 00039000
037800     CLOSE ERGDAT.                                                00039100
037900     IF ZW-FILE-STAT > ZERO                                       00039200
038000        MOVE ZW-FILE-STAT TO ZW-MELD-004-STAT                     00039300
038100        MOVE '04'        TO ZZG0001-MELD-NR                       00039400
038200        MOVE ZW-MELD-004 TO ZZG0001-MELD1                         00039500
038300        PERFORM CALL-ZZG00011                                     00039600
038400        MOVE 'FE' TO ASTZ-ZSAWR011                                00039700
038500        SET MK-FEHL TO TRUE                                       00039800
038600        GO TO SD-99.                                              00039900
038700*                                                                 00040000
038800     MOVE 'AE' TO ASTZ-ZSAWR011                                   00040100
038900     SET MK-ERGDAT-CL TO TRUE.                                    00040200
039000     MOVE ZW-ZAEHL TO ZAEHLER-ZSAWR011.                           00040300
039100 SD-99.                                                           00040400
039200     EXIT.                                                        00040500
039300/                                                                 00040600
039400*                                       SATZ-VORSPANN AUFBAUEN    00040700
039500 FUELLEN-SORT-FIX SECTION.                                        00040800
039600 FSF-01.                                                          00040900
039700     COMPUTE ABTEILUNG-ZSAWR011 = ABTEILUNG-ZSAWR011 * 1.         00041000
039800     COMPUTE STAPELNR-ZSAWR011  = STAPELNR-ZSAWR011 * 1.          00041100
039900     SET MK-STAPEL-VORH TO TRUE.                                  00041200
040000 FSF-02.                                                          00041300
040100*                                                                 00041400
040200     MOVE 'DRZWR011'         TO DRDBZ10-PROG.                     00041500
040300     MOVE 10                 TO DRDBZ10-ESTZ.                     00041600
040400     MOVE 'STAPEL'           TO DRDBZ10-SATZART.                  00041700
040500     MOVE ARBGEB-ZSAWR011    TO DRDBZ10-KEY-ARBGEB.               00041800
040600     MOVE STAPELNR-ZSAWR011  TO DRDBZ10-KEY-STAPELNR.             00041900
040700     MOVE ABTEILUNG-ZSAWR011 TO DRDBZ10-KEY-ABT.                  00042000
040800*                                                                 00042100
040900     PERFORM CALL-DRDBZ101.                                       00042500
041000*                                                                 00042600
041100     IF DRDBZ10-RC-OK                                             00042700
041200        GO TO FSF-05.                                             00042800
041300*                                                                 00042900
041400     IF DRDBZ10-RC-NOT-FOUND                                      00043000
041500        GO TO FSF-03.                                             00043100
041600*                                                                 00043200
041700     GO TO FSF-04.                                                00043300
041800 FSF-03.                                                          00043400
041900     MOVE '00000000' TO DRDBZ10-KEY-ABT.                          00043500
042000*                                                                 00043600
042100     PERFORM CALL-DRDBZ101.                                       00044000
042200*                                                                 00044100
042300     IF DRDBZ10-RC-OK                                             00044200
042400        GO TO FSF-05.                                             00044300
042500*                                                                 00044400
042600     IF DRDBZ10-RC-NOT-FOUND                                      00044500
042700        SET MK-STAPEL-FEHL TO TRUE                                00044600
042800        GO TO FSF-99.                                             00044700
042900 FSF-04.                                                          00044800
043000     MOVE '09'             TO ZZG0001-MELD-NR                     00044900
043100     MOVE DRDBZ10-SQLCODE TO ZW-MELD-009-SQL                      00045000
043200     MOVE ZW-MELD-009      TO ZZG0001-MELD1                       00045100
043300     PERFORM CALL-ZZG00011                                        00045200
043400     SET MK-FEHL TO TRUE                                          00045300
043500     MOVE 'FE' TO ASTZ-ZSAWR011.                                  00045400
043600*                                                                 00045500
043700     GO TO FSF-99.                                                00045600
043800  FSF-05.                                                         00045700
043900*                                                                 00045800
044000     MOVE '1'                      TO ZW-E-SORT-KZ.               00045900
044100     MOVE DRDBZ10-KZDRUCK          TO ZW-E-DRUCK-KZ.              00046000
044200     MOVE DRDBZ10-PAPIER-SET       TO ZW-E-PAPIER-SET.            00046100
044300     MOVE DRDBZ10-FORM-NR          TO ZW-E-FORM-NR.               00046200
044400     IF DRDBZ10-SORT-KZ = '1'                                     00046300
044500        IF ABTEILUNG-ZSAWR011 = ZERO AND MK-OPC-JA                00046400
044600           MOVE ZW-ABT-JOB         TO ZW-E-ABTEILUNG-A            00046500
044700        ELSE                                                      00046600
044800           MOVE ABTEILUNG-ZSAWR011 TO ZW-E-ABTEILUNG              00046700
044900        END-IF                                                    00046800
045000        MOVE ARBGEB-ZSAWR011       TO ZW-E-ARBGEB                 00046900
045100        MOVE STAPELNR-ZSAWR011     TO ZW-E-STAPEL                 00047000
045200     ELSE                                                         00047100
045300        IF ABTEILUNG-ZSAWR011 = ZERO AND MK-OPC-JA                00047200
045400           MOVE ZW-ABT-JOB         TO ZW-E-ABTEILUNG-A-R          00047300
045500        ELSE                                                      00047400
045600           MOVE ABTEILUNG-ZSAWR011 TO ZW-E-ABTEILUNG-R            00047500
045700        END-IF                                                    00047600
045800        MOVE ARBGEB-ZSAWR011       TO ZW-E-ARBGEB-R               00047700
045900        MOVE STAPELNR-ZSAWR011     TO ZW-E-STAPEL-R               00047800
046000     END-IF.                                                      00047900
046100     MOVE DRDBZ10-SORT-KZ          TO ZW-E-SORT-KZ.               00048000
046200     MOVE 'W'                      TO ZW-E-KONTROL.               00048100
046300 FSF-99.                                                          00048200
046400     EXIT.                                                        00048300
046500/                                                                 00048400
046600*                                           AUFRUF ZZG00011       00048500
046700 CALL-ZZG00011 SECTION.                                           00048600
046800 CALL-ZZG00011-001.                                               00048700
046900     MOVE 'DRZWR011' TO ZZG0001-MODUL-NAME.                       00048800
047000     MOVE 'I'        TO ZZG0001-MELD-ART.                         00048900
047100     MOVE 'O'        TO ZZG0001-AUSG-SYSOUT.                      00049000
047200*                                                                 00049100
047300     MOVE 'ZZG00011' TO ZW-UPRO.                                  00049200
047400     CALL ZW-UPRO USING PARAM-ZZG00011.                           00049300
047500*                                                                 00049400
047600 CALL-ZZG00011-999.                                               00049500
047700     EXIT.                                                        00049600
047800/                                                                 00049700
047900*                                           AUFRUF DRDBZ101       00049800
048000 CALL-DRDBZ101 SECTION.                                           00049900
048100 CALL-DRDBZ101-001.                                               00050000
048200     MOVE 'DRDBZ101' TO ZW-UPRO.                                  00050100
048300     CALL ZW-UPRO USING PARAM-DRDBZ101.                           00050200
048400 CALL-DRDBZ101-999.                                               00050300
048500     EXIT.                                                        00050400
048600*                                                                 00050500
048700*                                           ABBRUCH               00050600
048800*ABBRUCH SECTION.                                                 00050700
048900*ABBRUCH-001.                                                     00050800
049000*    MOVE ZW-MELD-002 TO ZZG0001-MELD1.                           00050900
049100*    MOVE '02'        TO ZZG0001-MELD-NR.                         00051000
049200*                                                                 00051100
049300*    PERFORM CALL-ZZG00011.                                       00051200
049400*                                                                 00051300
049500*    STOP RUN.                                                    00051400
049600*ABBRUCH-999.                                                     00052000
049700*    EXIT.                                                        00060000
049800/                                                                 00070000
049900*************************************************************     00080000
050000*  AUFRUF GDAZ0041                                                00090000
050100*************************************************************     00100000
050200 CALL-GDAZ0041 SECTION.                                           00110000
050300 CALL-GDAZ0041-001.                                               00120000
050400     MOVE 'GDAZ0041' TO ZW-UPRO.                                  00130000
050500     CALL ZW-UPRO USING PARAM-GDAZ0041.                           00140000
050600 CALL-GDAZ0041-999.                                               00150000
050700     EXIT.                                                        00160000
