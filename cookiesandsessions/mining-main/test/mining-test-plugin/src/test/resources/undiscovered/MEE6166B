       IDENTIFICATION DIVISION.                                         00010004
                                                                        00020004
       PROGRAM-ID.   NDBPRHXS.                                          00030004
       AUTHOR.       CORPORATE DATABASE SYSTEMS.                        00040004
       DATE-WRITTEN. APRIL 1991.                                        00050004
       DATE-COMPILED.                                                   00060004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*00070004
      *>>>                                                          <<<*00080004
      *>>>  SYSTEM ID:     BCNMS CORPORATE DATABASES                <<<*00090004
      *>>>  PROGRAM TITLE: BCNMS HCPCS PROCEDURE CODE DB IO PROGRAM <<<*00100004
      *>>>  PURPOSE:       PROVIDE HCPCS PROCEDURE CODE DATA TO     <<<*00110004
      *>>>                 CALLING PROGRAM                          <<<*00120004
      *>>>  12/26/96  -    CHANGE TO READ NEW DATABASE NDBPRCDB     <<<*00130004
      *>>>                 WHICH IS A SPIN OFF FROM NDBPRHDB        <<<*00140004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*00150004
      *                SUMMARY OF PROGRAM MODIFICATION                 *
      ******************************************************************
      *> PKG  |   WHO   |  WHEN  | CHANGE DESCRIPTION                  *
      *>******|*********|********|**************************************
      *>1435  | SNAPY1  | 980209 | GET CR90 0000 FOR CR90 UCCC         *
      *>******|*********|********|**************************************
     **>>>>>>>>>>--------------------------------------------<<<<<<<<<<*
     **>>>  DATE     PKG#      USERID    CHANGE                     <<<*
     **>>>  ------   --------  -----   ---------------------------- <<<*
     **>>>  07/21/98 VMDP2258  SNAPY2  Y2K COMPLIANCE                <<*
     **>>>                                                           <<*
     **>>>  08/14/98 VMDP2403  SNAPKJ  MODIFICATIONS FOR HIAA UPDATES<<*
     **>>>                             REFER TO KJ2403               <<*
     **>>>  11/11/98 VMDP2719  SNAP11  CHANGES FOR NEW CCN PRODS IN  <<*
     **>>>                             PARA 01126                    <<*
     **>>>  02/11/99 VMDP2966  SNAP52  ADDITIONS FOR TX20            <<*
     **>>>           VMDP2966  SNAPC4  MOVE '0000' TO VARN FOR       <<*
     **>>>                             CR90 0028                     <<*
     **>>>           VMDP2966  SNAPC4  FOR 'GA' PROD DO NOT GET      <<*
     **>>>                             ROOT DEFAULT (PARA 1135)      <<*
     **>>>  04/02/99 VMDP3024  SNAPY2  PRICE CCT0131 AS CCN07131     <<*
     **>>>                             REFER TO 3024                 <<*
     **>>>  05/31/99 VMDP3144  SNAPY2  MIDWEST (OH/IL) MODIFICATIONS <<*
     **>>>  07/27/99 VMDP3374  SNAP62  TEXAS AMENDMENT               <<*
     **>>>  08/03/99 VMDP3404  SNAP62  TEXAS AMENDMENT 'TX500R01'    <<*
     **>>>  10/05/99 VMDP3597  SNAPC4  CONVERT ALPHA 2ND DIGIT TO    <<*
     **>>>           (WMA02            NUMERIC EQUIVALENT FOR WMA PRDT<*
     **>>>            IMPL)            BYPASS ROOT DEFAULT PROCESS    <*
     **>>>                             POINT 157 SCHED TO 156 SCHED   <*
*4021**>>>  02/17/00 VMDP4021  SNAP62  ADD DIRECT CONTRACT 'TX400004'<<*
     **>>>  03/17/00 VMDP4092  SNAPAM  SET 'TX ONLY' FOR VARN 0L01   <<*
     **>>>                             AND 0L02.                     <<*
*3979**>>>  03/30/99 VMDP3979  SNAPF4  CONVERT ALPHA 2ND DIGIT TO    <<*
*3979**>>>                             NUMERIC EQUIVALENT FOR MNT PRDT<*
*4498**>>>  06/09/00 VMDP4498  SNAPF4  POINT TO FEE SCHEDULE CCN0A087 <*
*4498**>>>                             FOR PRODUCT CCN05O87/5087 AND <<*
*4498**>>>                             TO CCN0A088 FOR CCN05O88/5088 <<*
*4348**>>>  07/09/00 VMDP4348  SNAPC4  INCLUDE RP AND MCFS IN CONTRCT <*
*4348**>>>                             LIST THAT DOESN'T GRAB THE    <<*
*4348**>>>                             ROOT DEFAULT (PARA 01135-)    <<*
*4810**>>>  10/03/00 VMDP4810  SNAPC4  IF NO FEE SCHED FOR MPAQ 0000  <*
*4810**>>>                             DEFAULT TO MPAR 0000          <<*
CG4596*>>>  09/13/00 VMDP4596  SNAPCG  INCLUDE NA50 IN CONTRACT LIST <<*
CG4596*>>>                             THAT DOESN'T GRAB THE ROOT    <<*
CG4596*>>>                             DEFAULT (PARA 01135-)         <<*
*4596**>>>  10/16/00           SNAPC4  IF NO FEE SCHED FOR RUSP PRU   <*
*4596**>>>                             PRODUCTS IN THE 88 LEVEL      <<*
*4596**>>>                             RP-PROD-WT-MCFS-DEF, DEFAULT  <<*
*4596**>>>                             TO MCFS 0000                  <<*
*4908**>>>  10/27/00           SNAPC4  ADD MORE FEE SCHEDS TO 88 LEVEL<*
*4908**>>>                             RP-PROD-WT-MCFS-DEF           <<*
*4978**>>>  11/27/00           SNAPC4  ADD MORE FEE SCHEDS TO 88 LEVEL<*
*4978**>>>                             RP-PROD-WT-MCFS-DEF           <<*
*0013**>>>  01/11/01           SNAPC6  ADD MORE EDITS FOR BLOCK CODE  <*
CG0020*>>>  01/16/01           SNAPCG  INCLUDE THXC.0018/0020 IN LIST <*
CG0020*>>>                             THAT DOESN'T GRAB THE ROOT     <*
CG0020*>>>                             DEFAULT (01015-SET-SPECIAL-..)<<*
*0041**>>>  01/18/00  NDBP0041 SNAPC4  ADD MORE FEE SCHEDS TO 88 LEVEL<*
*0041**>>>                             RP-PROD-WT-MCFS-DEF           <<*
CG0069*>>>  02/16/01  NDBP0069 SNAPCG  IF NO FEE SCHED FOR OH10.0032  <*
CG0069*>>>                             PRODUCTS IN THE 88 LEVEL      <<*
CG0069*>>>                             OH-PROD-WT-OHHC-DEF, DEFAULT  <<*
CG0069*>>>                             TO OHHC.0000                  <<*
NK0069*>>>  02/23/00           SNAPC4  BYPASS ROOT DEFAULT (HIGH-VALUE)*
NK0069*>>>                            FOR MAHC                       <<*
CG0114*>>>  03/16/01  NDBP0114 SNAPCG  ADD MORE FEE SCHEDS TO 88 LEVEL<*
CG0114*>>>                             RP-PROD-WT-MCFS-DEF           <<*
CG0114*>>>                     SNAPCG  IF NO FEE SCHED FOR NA50.0L01 <<*
CG0114*>>>                             PRODUCTS IN THE NEW 88 LEVEL  <<*
CG0114*>>>                             NA-PROD-WT-NA50-DEF, DEFAULT  <<*
CG0114*>>>                             TO NA50.0L00                  <<*
CG0135*>>>  04/25/01  NDBP0135 SNAPCG  IF NO FEE SCHED FOR GA10.0009 <<*
CG0135*>>>                             PRODUCTS IN THE NEW 88 LEVEL  <<*
CG0135*>>>                             GA-PROD-WT-GA10-DEF, DEFAULT  <<*
CG0135*>>>                             TO GA10.0000                  <<*
CG0135*>>>                     SNAPCG  ADD MORE FEE SCHEDS TO 88 LEVEL<*
CG0135*>>>                             RP-PROD-WT-MCFS-DEF           <<*
CG0170*>>>  05/22/01  NDBP0170 SNAPCG  ADD MORE FEE SCHEDS TO 88 LEVEL<*
CG0170*>>>                             RP-PROD-WT-MCFS-DEF           <<*
CG0183*>>>  06/05/01  NDBP0183 SNAPCG  REMOVE TX02 DEFLT FOR TXHC0011<<*
CG0218*>>>  07/19/01  NDBP0218 SNAPCG  ADD IL600000 TO 88 LEVEL      <<*
CG0218*>>>                             RP-PROD-WT-MCFS-DEF           <<*
CG0218*>>>                             REMOVE TX02 DEFLT FOR TXHC0131<<*
*0243**>>>  08/03/01  NDBP0243 SNAP62  ADD NEW NETWORK 'VA'          <<*
CG0252*>>>  08/14/01  NDBP0252 SNAPCG  REMOVE TX02 DEFLT FOR TXRS0111<<*
CG0269*>>>  09/19/01  NDBP0269 SNAPCG  REMOVE TX02 DEFLT FOR TXHC0118<<*
CG0320*>>>  10/18/01  NDBP0320 SNAPCG  TRANSLATE CCN NATL ANES FOR   <<*
CG0320*>>>                             ALL STATES; CLEAN UP TX PRODS <<*
CG0320*>>>                             WITH NO TX02 DEFAULT (88 LVL) <<*
CG0320*>>>                             REMOVE TX02 DEFLT FOR TXHC0199<<*
CG0329*>>>  11/01/01  NDBP0329 SNAPCG  ALLOW TX02 DEF FOR TX POB PROD<<*
CG0350*>>>  11/15/01  NDBP0350 SNAPCG  REMOVE TX02 DEFLT FOR ALL TXHC<<*
CG0350*>>>                             TRANSLATE ALL CCN NATL FOR ALL<<*
CG0350*>>>                             STATES XIXX/X9XX TO G9XX      <<*
CG0362*>>>  12/17/01  NDBP0362 SNAPCG  REMOVE TX02 DEFLT FOR TXHL    <<*
CG0374*>>>  01/17/02  NDBP0374 SNAPCG  TRANSLATE ALL CCN NATL FOR ALL<<*
CG0374*>>>                             STATES XHXX/X8XX TO G8XX      <<*
FC0080*>>>  04/23/02  NDBP0080 SNAP62  ADD TXSH FOR TX               <<*
CG0451*>>>  06/05/02  NDBP0451 SNAPCG  USE NDBPLNST/NDBPFPRS FOR FEE-<<*
CG0451*>>>                             SCHED DEFAULT; DEL HRD-CD DEFS<<*
CG0451*>>>                             EXCEPT MCFS, NA50, TX02 DEFLTS<<*
FC0472*>>>  07/19/02  NDBP0472 SNAP62  ADD 'DCHC' FOR VA             <<*
FC0498*>>>  07/26/02  NDBP0498 SNAP62  ADD 'TXHA' FOR TX PROCESS-ONLY<<*
CG0538*>>>  10/03/02  NDBP0538 SNAPCG  REMOVE TX02 DEFLT FOR TX500C00<<*
FC0538*>>>  10/14/02  NDBP0538 SNAP62  ADD 'TX00', 'TXHM' , TX400015 <<*
FC0538*>>>                             & TX50ML00 FOR TX PROCESS-ONLY <*
CG0538*>>>  10/23/02  NDBP0538 SNAPCG  DEL RP000252 FR PROD-WT-MCFS-D<<*
CG0587*>>>  10/30/02  NDBP0587 SNAPCG  DEL TX02 DEFAULT FOR TX-PRODS <<*
CG0587*>>>                             DEL PBP1 DEF FOR OBSOLETE INS <<*
FC0614*>>>  01/24/03  NDBP0614 SNAP62  REMOVE OLD CODING FOR CCN '131' *
     **>>>>>>>>>>--------------------------------------------<<<<<<<<<<*
      *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-* 00180200
      * 04/12/03 NDBP021 SNAPC4 -   CALL MPRHPXS TO RETRIEVE HCPCS DATA 00190000
      *                              (EDIT, BLOCK,INCID,SUSP) FROM DB2  00190000
      *                         -   UPDATE FUNCTIONS WILL STAY THE SAME 00190000
      *                         -   PRICING INFO WILL STILL COME FROM   00190000
      *                             IMS DATABASE                        00190000
      *                         -   INIT MBU, PRODT CODE AND VARN       00190000
      *                         -   CHG NNM TO WGM                      00190000
      * 06/25/03 NDBP073 SNAPC4 -   COMMENT OUT NDQPRHQ FROM LIST OF    00190000
      *                             PGMS ACCESSING DB2 (ON HOLD UNTIL   00190000
      *                             DIFFERENCES VS BCC ARE DEFINED AS   00190000
      *                             EXCEPTIONS)                         00190000
      * 07/10/03 NDBP071 SNAPC4 -   INCLUDE NDQPRCQ IN THE LIST OF      00190000
      *                             PGMS ACCESSING DB2                  00190000
      *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-* 00190010
FC0100*>>>  07/30/03  NDBP0100 SNAP62  NEW CCN MAPPING                 *
FC0043*>>>  08/08/03  NDBP0043 SNAP62  ADD COSURGEON-ID                *
FC0138*>>>  09/12/03  NDBP0138 SNAP62  NEW CCN MAPPING                 *
NK0068*>>>  09/12/03  NDBP0068 SNAPC4  ALLOW NDQPRHQ TO ACCESS DB2;    *
NK0068*>>>                             PASS ROOT UPDDTE TO BLK UPDDTE  *
FC0068*>>>  08/06/03  NDBP0068 SNAP62  ADD FAC BASE UNIT               *
FC0146*>>>  10/14/03  NDBP0146 SNAP62  ADD AS-IS EFF AND END DATE      *
FC0239*>>>  04/15/04  NDBP0239 SNAP62  NEW CCN MAPPING                 *
CG0260*>>>  06/18/04  NDBP0260 SNAPCG  NEW CCN MAPPING BG/B724->B724   *
CG0260*>>>                                             IG/I724->B724   *
CG0260*>>>                                             GG/G724->B724   *
FC0270*>>>  07/14/04  NDBP0270 SNAP62  NEW CCN MAPPING DB81/281        *
FC0289*>>>  09/23/04  NDBP0289 SNAP62  NEW CCN MAPPING *488 & *755     *
FC0312*>>>  11/19/04  NDBP0312 SNAP62  NEW CCN MAPPING *490            *
FC0325*>>>  01/11/05  NDBP0325 SNAP62  NEW CCN MAPPING *107 & *594     *
FC0325*>>>                             AND FOR VARN BH* OR B8*         *
FC0345*>>>  02/17/05  NDBP0345 SNAP62  CCN MAPPING FOR B879            *
FC0342*>>>  02/10/05  NDBP0342 SNAP62  NEW CCN MAPPING *199;*752 & *757*
FC0355*>>>  03/15/05  NDBP0355 SNAP62  NEW CCN MAPPING FOR MAR MSL     *
FC355B*>>>                             NEW 'TN' PRODUCT                *
FC0370*>>>  04/14/05  NDBP0370 SNAP62  NEW CCN MAPPING FOR APR MSL     *
FC0378*>>>  05/16/05  NDBP0378 SNAP62  NEW CCN MAPPING FOR MAY MSL     *
NK0408*>>>  06/24/06  NDBP0408 SNAPC4  ENSURE EXCEPTION CRITERIA IS    *
NK0408*>>>                              TO THE MPR IO PROGRAM          *
FC0750*>>>  03/24/07  NDBP0750 SNAP62  2 BYTE PLACE-OF-TREATMENT INPUT *
NS0788*>>>  05/19/07  NDBP0788 SIHS01  POPULATE POS-EXCL-INCL IND FROM *
      *>>>                             MPRHPXC IO AREA AFTER CALL TO   *
      *>>>                             MPRHPXS.                        *
CG0891*>>>  10/20/07  NDBP0891 SNAPCG  PROD=UNGI* + POS=24 => FAC-RATE *
NK1166*>>>  06/20/09  NDBP1186 SNAPC4  PASS ORIG CALLING PGM NME TO MPR*
NK1622*>>>  12/08/12  NDBP1622 SNAPC4  SSCR - ALCAT
GM2257*>>>  04/18/15  NDBP2257 SNMSGM1 SSCR 28256 - ADD NEW CRITERIA FOR
GM2257*>>>                    /SNMSC3F RENDERING NPI.
GM2571*>>>  04/16/16  NDBP2571 SNMSGM1 SSCR 33916 - ADD POS '19' UNDER
GM2571*>>>                    /SNMSC5E GROUP FAC-BASE.
     **>>>>>>>>>>--------------------------------------------<<<<<<<<<<*
                                                                        00160004
       ENVIRONMENT DIVISION.                                            00170004
                                                                        00180004
       CONFIGURATION SECTION.                                           00190004
       SOURCE-COMPUTER.    IBM-3090.                                    00200004
       OBJECT-COMPUTER.    IBM-3090.                                    00210004
                                                                        00220004
       DATA DIVISION.                                                   00230004
                                                                        00240004
       WORKING-STORAGE SECTION.                                         00250004
       77  FILLER                      PIC  X(040)  VALUE               00260004
           'NDBPRHXS WORKING STORAGE STARTS HERE >>>'.                  00270004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*00280004
      *>>  WORK AREAS:                                               <<*00290004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*00300004
       01  WORK-AREAS.                                                  00310004
           05  WS-FUNC                      PIC X(04).                  00320004
                                                                        00330004
           05  WS-HOLD-SEND-PRDT-CDE-CHG    PIC X(04).                  00340004
                                                                        00350004
           05  WS-VALID-PRODUCT-SW          PIC X(01) VALUE SPACE.      00360004
               88  VALID-PRODUCT-CDE        VALUE 'Y'.                  00370004
           05  WS-OVERRIDE-SEG-SW           PIC X(01) VALUE SPACES.     00380004
               88  OVERRIDE-SEG-RETRIEVED   VALUE 'Y'.                  00390004
                                                                        00400004
           05  WS-HOLD-SEND-PRODUCT-VARN.                               00410004
               10 WS-HOLD-SEND-PRDT-CDE.                                00420004
                  15 WS-VALID-PRDT-AREA     PIC X(03).                  00430004
                     88  FLAT-DOLLAR-PRDT   VALUE 'AFF' 'GMC'           00440004
                                                  'FLT' 'PAZ'           00450004
                                                  'AB0' 'AB9'           00460004
                                                  'ABN' 'EKC'           00470004
                                                  'MS0'.                00480004
                  15 FILLER                 PIC X(01).                  00490004
               10 WS-HOLD-SEND-PRDT-VARN    PIC X(04) VALUE '0000'.     00500004
                  88  VALID-PRODUCT-VARN    VALUES '0000', '0001',      00510004
                                                   '0002', '0003'.      00520004
*4596*     05  FILLER REDEFINES WS-HOLD-SEND-PRODUCT-VARN PIC X(8).     00410004
CG0451*=>>    DEFAULT FEE-SCHED FROM NDBPLNST ONLY                      00510004
CG0451*=>>                                                              00510004
*4596*            88  RP-PROD-WT-MCFS-DEF  VALUES 'RP0E1810'            00510004
CG0170                                            'RP000269' 'RP000234' 00510004
*4596*                                            'RP000278'            00510004
*4596*                                            'RP000279'            00510004
*4596*                                            'RP000294'            00510004
CG0170                                            'RP000175' 'RP000192' 00510004
*4596*                                            'RP000029'            00510004
*4978*                                            'RP000075'            00510004
*0041*                                            'RP000029'            00510004
CG0114                                            'RP000035'            00510004
*4908*                                            'RP000226' 'RP000242' 00510004
CG0538                                            'RP00X252' 'RP000282' 00510004
CG0218                                            'IL600000'.           00510004
CG0069*=>>        88  OH-PROD-WT-OHHC-DEF  VALUES 'OH100032'.           00510004
CG0114            88  NA-PROD-WT-NA50-DEF  VALUES 'NA500L01'.           00510004
CG0135*=>>        88  GA-PROD-WT-GA10-DEF  VALUES 'GA100009'.           00510004
*4021***      'TX400004' POINT TO 'TXHC9899' IN NDBPLNST                04990004
CG0350            88  TX-PROD-NO-TX02-DEF  VALUES 'TX20A008' 'TX20B008' 00510004
CG0320                                            'TX20A009' 'TX20B009' 00510004
CG0320                                            'TX20A011' 'TX20B011' 00510004
FC0538                                            'TX400015' 'TX50ML00' 00510004
CG0538                                            'TX500C00'            00510004
CG0320                                            'TX500L01' 'TX500L02' 00510004
CG0329                                            'TX500R01'.           00510004
           05  WS-HOLD-IO-SEG-PRDT-CDE      PIC X(04).                  00530004
                  88  PRICING-IO-PROD-SPACES VALUE  '    '.             00540004
                  88  PRICING-IO-PROD-HI-VAL VALUE  HIGH-VALUES.        00550004
                                                                        00560004
           05  WS-HOLD-SEND-RGN-CDE         PIC X(03).                  00570004
                  88  VALID-RGN-CDE         VALUES '001' THRU '999'.    00580004
                  88  VALID-TEX-CDE         VALUE 'TEX'.                00590004
                                                                        00600004
FC0750**   05  WS-HOLD-PLC-OF-TRTMNT        PIC X(01).                  00570004
FC0750**          88  FAC-BASE              VALUES '1' '2' '7' '8'.     00580004
                                                                        00600004
FC0750     05  WS-HOLD-PLC-OF-TRTMNT        PIC X(02).                  00570004
FC0750            88  FAC-BASE              VALUES                      00580004
FC0750*GM2571                  '21' '22' '23' '26' '31' '34'            00580004
GM2571                         '21' '22' '23' '26' '31' '34' '19'       00580004
FC0750                         '41' '42' '51' '52' '53' '56' '61'.      00580004
CG0891            88  FAC-SURG              VALUE  '24'.                00580004
                                                                        00600004
           05  WS-PROCESS-IND               PIC X(01).                  00610004
                  88  WS-PROCESS-TX02-ONLY  VALUE '1'.                  00620004
                  88  WS-PROCESS-BOTH-TX    VALUE '2'.                  00630004
                  88  WS-PROCESS-MCP1-ONLY  VALUE '3'.                  00640004
                  88  WS-PROCESS-DME1-ONLY  VALUE '4'.                  00650004
                  88  WS-PROCESS-MS0X-ONLY  VALUE '5'.                  00660004
                  88  WS-PROCESS-INS-FIRST  VALUE '6'.                  00670004
                  88  WS-PROCESS-TX-ONLY    VALUE '7'.                  00680004
                  88  WS-PROCESS-MCP0-ONLY  VALUE '8'.                  00690004
                  88  WS-PROCESS-NO-TX      VALUE '9'.                  00700004
                                                                        00710004
           05  WS-DUMP-MESSAGE.                                         00720004
               10  FILLER                   PIC X(23) VALUE             00730004
                         'ERROR OCCURRED IN PARA:'.                     00740004
               10 WS-ABEND-PARA             PIC X(06).                  00750004
               10 WS-ABEND-MSG              PIC X(51).                  00760004
                                                                        00770004
                                                                        00780004
           05  WS-ERROR-MESSAGES.                                       00790004
               10 WS-ERR-MSG1.                                          00800004
                  15  FILLER           PIC X(20) VALUE                  00810004
                                       'INVALID FUNCTION'.              00820004
                  15  WS-ERR-FUNC      PIC X(08).                       00830004
               10 WS-ERR-MSG2.                                          00840004
                  15  FILLER           PIC X(30) VALUE                  00850004
                                       'INVALID RETRIEVAL FUNCTION'.    00860004
                  15  WS-ERR-RET-FUNC  PIC X(08).                       00870004
               10 WS-ERR-MSG3.                                          00880004
                  15  FILLER           PIC X(30) VALUE                  00890004
                  'GU CALL NDBPRHC NDBPRHS STAT= '.                     00900004
                  15  WS-ERR3-STATUS   PIC X(02).                       00910004
               10 WS-ERR-MSG4.                                          00920004
                  15  FILLER           PIC X(30) VALUE                  00930004
                  'GN CALL NDBPRHC ROOT STATUS = '.                     00940004
                  15  WS-ERR4-STATUS   PIC X(02).                       00950004
               10 WS-ERR-MSG5.                                          00960004
                  15  FILLER           PIC X(30) VALUE                  00970004
                  'NO ENTRY ON TBLEBASE SUSPDENY '.                     00980004
                  15  WS-ERR5-STATUS   PIC X(02).                       00990004
                                                                        01000004
*2258**01  WS-DATE                     PIC 9(06).                       01010004
*2258* 01  WS-CYMD-DATE                PIC 9(08).                       01020004
       01  WS-CURR-DATE                PIC S9(09) COMP-3.               01030004
       01  WS-PARM-COUNT               PIC S9(005) VALUE +0 COMP.       01040004
       01  WS-DB-SSA-1                 PIC X(80)  VALUE SPACES.         01050004
       01  WS-DB-SSA-2                 PIC X(80)  VALUE SPACES.         01060004
       01  WS-DB-IO-AREA               PIC X(500) VALUE SPACES.         01070004

NK0021*COPY NNMDATED.
NK0021   COPY  WGMDTFMD.                                                00027700
NK0021   COPY  WGMDATED.                                                00027800

                                                                        01080004
NK0021 01  WS-DB-WORK-AREA.
NK0021     05  WS-PROGRAM-LIST         PIC X(08) VALUE SPACES.
NK0068         88  PGM-HAS-DB2-ACCESS      VALUE   'NDQPRHQ'
NK0071                                             'NDQPRCQ'
NK0021                                             'TSTPRHX'.
NK0021     05  SUB                     PIC S9(4) COMP VALUE 0.
NK0021*>>>>>>>>>>--------------------------------------------<<<<<<<<<<*01270000
NK0021*>> DB2 TABLE DEFINITIONS                                     <<* 01280000
NK0021*>>>>>>>>>>--------------------------------------------<<<<<<<<<<*01290000
NK0021     SKIP2                                                        01300000
NK0021     COPY MPRHPXD.                                                01320000
NK0021 01  MPRHPXC-IO-AREA.                                             01310000
NK0021     COPY MPRHPXC.                                                01320000
NK0021                                                                  01090004
      *>>>>>>>>>-----------------------------------<<<<<<<<<<<*         01100004
      *>>    TABLEBASE AREA                                 <<*         01110004
      *>>>>>>>>>-----------------------------------<<<<<<<<<<<*         01120004
                                                                        01130004
           COPY NDBMSGSD.                                               01140004
                                                                        01150004
       01  TABLEBASE-CALL-CODES.                                        01160004
           COPY TBLCALSC.                                               01170004
                                                                        01180004
       01  TABLEBASE-COMMAND-AREA.                                      01190004
           COPY TBLCMNDC.                                               01200004
                                                                        01210004
           COPY NDBXTBLD.                                               01220004
           COPY NDBPRODD.                                               01230004
           COPY NDBSUSPD.                                               01240004
NK0021     COPY WGMTBLSD.                                               01250004
                                                                        01260004
                                                                        01270004
       01  WS-IO-PATH.                                                  01280004
           03  WS-IO-ROOT.                                              01290004
              05 WS-IO-ROOT-HCPCS-CDE     PIC X(5).                     01300004
                 88 MULTI-CHANNEL-PROCEDURE        VALUE '80002'        01310004
                                                    THRU '80049'        01320004
                                                         'G0058'        01330004
                                                         'G0059'        01340004
                                                         'G0060'.       01350004
              05 FILLER                   PIC XX.                       01360004
              05 WS-IO-ROOT-DESC.                                       01370004
                 10 WS-IO-ROOT-LONG       PIC X(120).                   01380004
                 10 WS-IO-ROOT-SHORT      PIC X(30).                    01390004
                 10 WS-IO-ROOT-SOUNDEX    PIC X(10).                    01400004
              05 WS-IO-ROOT-FOL-DAYS      PIC S999        COMP-3.       01410004
              05 WS-IO-ROOT-SVC-CLS-CODES.                              01420004
                 10 WS-IO-ROOT-SVC-CLS-CDE OCCURS 3 TIMES               01430004
                                          PIC XXX.                      01440004
              05 WS-IO-ROOT-PRC-CLS-CODES.                              01450004
                 10 WS-IO-ROOT-PRC-CLS-CDE OCCURS 2 TIMES               01460004
                                          PIC XXX.                      01470004
              05 WS-IO-ROOT-EDIT-DATA.                                  01480004
                 10 WS-IO-ROOT-TYPE-TRTMT-CDE                           01490004
                                           OCCURS 6 TIMES               01500004
                                          PIC XX.                       01510004
                 10 WS-IO-ROOT-PLC-TRTMT-CDE                            01520004
                                           OCCURS 7 TIMES               01530004
                                          PIC X.                        01540004
                 10 WS-IO-ROOT-AGE-FROM   PIC S999        COMP-3.       01550004
                 10 WS-IO-ROOT-AGE-THRU   PIC S999        COMP-3.       01560004
                 10 WS-IO-ROOT-SEX-CDE    PIC X.                        01570004
              05 FILLER                   PIC X(03).                    01580004
              05 WS-IO-ROOT-64-RVS-DATA.                                01590004
                 10 WS-IO-ROOT-64-UNIT    PIC S999V99     COMP-3.       01600004
                 10 WS-IO-ROOT-64-BA-UNIT PIC S999V99     COMP-3.       01610004
              05 WS-IO-ROOT-DEP-SEG-IND.                                01620004
                 10 WS-IO-ROOT-INCDNTL-IND                              01630004
                                          PIC X.                        01640004
                 10 WS-IO-ROOT-SSPND-DENY-IND                           01650004
                                          PIC X.                        01660004
              05 WS-IO-ROOT-BLOCK-CDE     PIC X.                        01670004
              05 WS-IO-ROOT-ANES-ALLOW    PIC X.                        01680004
              05 WS-IO-ROOT-ASST-SRG-ALLOW                              01690004
                                          PIC X.                        01700004
              05 WS-IO-ROOT-EFF-DTE       PIC S9(9)       COMP-3.       01710004
              05 WS-IO-ROOT-END-DTE       PIC S9(9)       COMP-3.       01720004
              05 WS-IO-ROOT-LST-UPDT-DTE  PIC S9(9)       COMP-3.       01730004
              05 WS-IO-ROOT-LST-USERID    PIC X(8).                     01740004
              05 WS-IO-ROOT-UM-APPVL-IND  PIC X(1).                     01750004
              05 WS-IO-ROOT-COPAY-IND     PIC X(1).                     01760004
              05 WS-IO-ROOT-100-IND       PIC X(1).                     01770004
              05 FILLER                   PIC X(32).                    01780004
                                                                        01790004
                                                                        01800004
           03  WS-IO-PRICE.                                             01810004
              05 WS-IO-PRI-EFF-DTE          PIC S9(9)     COMP-3.       01820004
              05 WS-IO-PRI-END-DTE          PIC S9(9)     COMP-3.       01830004
              05 WS-IO-PRI-PRDT-SPCF-DATA.                              01840004
                 10 WS-IO-PRI-UNIT-VAL      PIC S9(5)V99   COMP-3.      01850004
                 10 WS-IO-PRI-ANES-UNIT-VAL PIC S9(5)V99   COMP-3.      01860004
                 10 WS-IO-PRI-PCU           PIC S9(5)V99   COMP-3.      01870004
                 10 WS-IO-PRI-TCU           PIC S9(5)V99   COMP-3.      01880004
              05 WS-IO-OVR-CNCL-RSN-CDE     PIC XX.                     01890004
              05 WS-IO-OVR-OVRIDE-PRC       PIC S9(7)V99   COMP-3.      01900004
              05 WS-IO-OVR-OVRIDE-PRC-ANES  PIC S9(7)V99   COMP-3.      01910004
              05 WS-IO-OVR-OVRIDE-TC        PIC S9(7)V99   COMP-3.      01920016
              05 WS-IO-OVR-OVRIDE-PRC2      PIC S9(7)V99   COMP-3.      01930016
              05 WS-IO-OVR-OVRIDE-RSN-CDE   PIC X.                      01940004
              05 WS-IO-OVR-OVRIDE-RSN-TXT   PIC X(80).                  01950004
              05 WS-IO-OVR-LAST-ACTN-DTE    PIC S9(9)      COMP-3.      01960004
              05 WS-IO-OVR-LAST-USERID      PIC X(8).                   01970004
*4908*        05 WS-IO-PAY-TYPE-IND         PIC X(01).                  01980004
FC0068        05 WS-IO-FAC-UNIT-VAL         PIC S9(5)V99   COMP-3.      01850004
FC0068***     05 WS-IO-OVR-FILLER           PIC X(07).                  02000004
              05 FILLER                     PIC X(200).                 02010006
                                                                        02020004
       01  WS-IO-SUSP.                                                  02030004
           05 WS-IO-ERR-EOB-MBU      PIC X(08).                         02040007
           05 WS-IO-ERR-EOB-PRDT-VRN PIC X(08).                         02050007
           05 WS-IO-ERR-EOB-KEY-DTE  PIC S9(9)       COMP-3.            02060007
           05 WS-IO-ERR-EOB-SD-CDE   PIC XXX.                           02070004
           05 WS-IO-ERR-EOB-EFF-DTE  PIC S9(9)       COMP-3.            02080004
           05 WS-IO-ERR-EOB-END-DTE  PIC S9(9)       COMP-3.            02090004
           05 WS-IO-ERR-EOB-DLR-LMT  PIC S9(5)V99    COMP-3.            02100004
           05 WS-IO-ERR-EOB-CDE      PIC X(5).                          02110004
           05 WS-IO-ERR-EOB-MSG-CDE  PIC X.                             02120004
           05 WS-IO-ERR-EOB-TEXT     PIC X(140).                        02130004
           05 WS-IO-LAST-UPDT-DTE    PIC S9(9)       COMP-3.            02140004
           05 WS-IO-LAST-USERID      PIC X(8).                          02150004
NK1622     05 WS-IO-LCD-NCD-IND      PIC X(1).
  |        05 WS-IO-THRESHOLD-IND    PIC X(1).
  |        05 FILLER                 PIC X(17).
NK1622*    05 FILLER                 PIC X(19).
                                                                        02170004
                                                                        02180004
       01  WS-IO-BLOCK               PIC X(040).                        02190004
                                                                        02200004
       01  WS-IO-INCID               PIC X(040).                        02210004
                                                                        02220004
       01  WS-IO-GN-AREA             PIC X(500).                        02230004
                                                                        02240004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02250004
      *>>  DATABASE SSA'S:                                           <<*02260004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02270004
           SKIP2                                                        02280004
       01  NDBPRHC-SSA-Q.                                               02290004
           COPY NDBPRHCS.                                               02300004
                                                                        02310004
       01  NDBPRHS-SSA.                                                 02320004
           COPY NDBPRHSS.                                               02330004
                                                                        02340004
       01  NDBPRHS-SSA-Q.                                               02350004
           COPY NDBPRHSQ.                                               02360004
                                                                        02370004
       01  NDBPRCC-SSA.                                                 02380004
           COPY NDBPRCCS.                                               02390004
                                                                        02400004
       01  NDBPRCC-SSA-B.                                               02410009
           COPY NDBPRCCB.                                               02420009
                                                                        02430009
       01  NDBPRCC-SSA-U.                                               02440012
           COPY NDBPRCCU.                                               02450012
                                                                        02460012
       01  NDBPPRI-SSA.                                                 02470004
           COPY NDBPPRIS.                                               02480004
                                                                        02490004
       01  NDBPPRI-SSA-Q.                                               02500004
           COPY NDBPPRIQ.                                               02510004
                                                                        02520004
       01  NDBPPRI-SSA-B.                                               02530004
           COPY NDBPPRIB.                                               02540004
                                                                        02550004
       01  NDBPBLK-SSA.                                                 02560004
           COPY NDBPBLKS.                                               02570004
                                                                        02580004
*0013* 01  NDBPBLK-SSA-Q.                                               02560004
*0013*     COPY NDBPBLKQ.                                               02570004
                                                                        02580004
       01  NDBPINC-SSA.                                                 02590004
           COPY NDBPINCS.                                               02600004
                                                                        02610004
       01  NDBPINC-SSA-Q.                                               02620004
           COPY NDBPINCQ.                                               02630021
                                                                        02640004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02650004
      *>>      NDBPRHXS PARMS                                        <<*02660004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02670004
           COPY NDBPRHXD.                                               02680004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02690004
      *>>  DUMP INFORMATION:                                         <<*02700004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02710004
NK0021     COPY  WGMAPSYD.                                              02720004
                                                                        02730004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02740004
      *>>  DATABASE SEGMENT LAYOUTS:                                 <<*02750004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02760004
       01  NDBPRHXS-IO-AREA.                                            02770004
            COPY NDBPRHXC.                                              02780004
                                                                        02790004
                                                                        02800004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02810004
      *>>  IMS FUNCTION CODES:                                       <<*02820004
      *>>>>>>>>>>--------------------------------------------<<<<<<<<<<*02830004
       01  IMS-FUNCTIONS.                                               02840004
           COPY MIDFUNCC.                                               02850004
                                                                        02860004
       01  PCB-MASK.                                                    02870004
       COPY MIDDBPCB.                                                   02880004
       01  FILLER                      PIC  X(040)  VALUE               02890004
           'NDBPRHXS WORKING STORAGE ENDS   HERE >>>'.                  02900004
                                                                        02910004
      ******************************************************************02920004
      *LINKAGE SECTION                                                 *02930004
      ******************************************************************02940004
       LINKAGE SECTION.                                                 02950004
       01  HCPCS-PARMS         PIC X(072).                              02960027
       01  DUMP-INFO           PIC X(264).                              02970004
       01  HCPCS-IO            PIC X(6291).                             02980004
       01  NDBPRHDB-PCB        PIC X(136).                              02990004
       01  NDBPRCDB-PCB        PIC X(136).                              03000004
                                                                        03010004
                                                                        03020004
      ******************************************************************03030004
      *PROCEDURE DIVISION                                              *03040004
      ******************************************************************03050004
       PROCEDURE DIVISION USING HCPCS-PARMS                             03060004
                                DUMP-INFO                               03070004
                                HCPCS-IO                                03080004
                                NDBPRHDB-PCB                            03090004
                                NDBPRCDB-PCB.                           03100004
                                                                        03110004
                                                                        03120004
       00000-MAINLINE.                                                  03130004
           MOVE '00000'           TO WS-ABEND-PARA.                     03140004
                                                                        03150004
           PERFORM 00100-INITIALIZATION THRU 00100-EXIT.                03160004
                                                                        03170004
NK0021     MOVE NDBPRHXS-CALLING-PGM TO WS-PROGRAM-LIST.                02180000
NK0071     IF PGM-HAS-DB2-ACCESS                                        02190000
NK0071        SET NDBPRHXS-EXCEPTION-PRICNG-ON TO TRUE                  02190000
NK0071     END-IF                                                       02190000
                                                                        02170200
           EVALUATE TRUE                                                03180004
NK0021         WHEN (NDBPRHXS-HCPCS-UNQ-REC OR                          03190004
NK0021              NDBPRHXS-HCPCS-ALL-REC OR                           03200004
NK0021              NDBPRHXS-HCPCS-GET-ROOT)                            03210004
NK0021**        AND PGM-HAS-DB2-ACCESS                                  02190000
NK0071          AND NDBPRHXS-EXCEPTION-PRICNG-ON                        02190000
NK0021             PERFORM 00500-PROCESS-USING-DB2 THRU 00500-EXIT      03220004
               WHEN NDBPRHXS-HCPCS-UNQ-REC OR                           03190004
                    NDBPRHXS-HCPCS-ALL-REC OR                           03200004
                    NDBPRHXS-HCPCS-GET-ROOT                             03210004
                   PERFORM 01000-PROCESS-UNQ-REC THRU 01000-EXIT        03220004
               WHEN NDBPRHXS-HCPCS-ISRT-ROOT                            03230004
                   PERFORM 02100-ISRT-ROOT       THRU 02100-EXIT        03240004
               WHEN NDBPRHXS-HCPCS-ISRT-SUSP                            03250004
                   PERFORM 02200-ISRT-SUSP       THRU 02200-EXIT        03260004
               WHEN NDBPRHXS-HCPCS-ISRT-UNIT                            03270004
                   PERFORM 02300-ISRT-UNIT       THRU 02300-EXIT        03280004
               WHEN NDBPRHXS-HCPCS-ISRT-BLOK                            03290004
                   PERFORM 02400-ISRT-BLOK       THRU 02400-EXIT        03300004
               WHEN NDBPRHXS-HCPCS-ISRT-INCD                            03310004
                   PERFORM 02500-ISRT-INCD       THRU 02500-EXIT        03320004
               WHEN NDBPRHXS-HCPCS-REPL-ROOT                            03330004
                   PERFORM 03100-REPL-ROOT       THRU 03100-EXIT        03340004
               WHEN NDBPRHXS-HCPCS-REPL-SUSP                            03350004
                   PERFORM 03200-REPL-SUSP       THRU 03200-EXIT        03360004
               WHEN NDBPRHXS-HCPCS-REPL-UNIT                            03370004
                   PERFORM 03300-REPL-UNIT       THRU 03300-EXIT        03380004
               WHEN NDBPRHXS-HCPCS-REPL-BLOK                            03390004
                   PERFORM 03400-REPL-BLOK       THRU 03400-EXIT        03400004
               WHEN NDBPRHXS-HCPCS-REPL-INCD                            03410004
                   PERFORM 03500-REPL-INCD       THRU 03500-EXIT        03420004
               WHEN NDBPRHXS-HCPCS-DLET-ROOT                            03430004
                   PERFORM 04100-DLET-ROOT       THRU 04100-EXIT        03440004
                   PERFORM 04150-DLET-PRCNG-ROOT THRU 04150-EXIT        03450008
               WHEN NDBPRHXS-HCPCS-DLET-SUSP                            03460004
                   PERFORM 04200-DLET-SUSP       THRU 04200-EXIT        03470004
               WHEN NDBPRHXS-HCPCS-DLET-UNIT                            03480004
                   PERFORM 04300-DLET-UNIT       THRU 04300-EXIT        03490004
               WHEN NDBPRHXS-HCPCS-DLET-BLOK                            03500004
                   PERFORM 04400-DLET-BLOK       THRU 04400-EXIT        03510004
               WHEN NDBPRHXS-HCPCS-DLET-INCD                            03520004
                   PERFORM 04500-DLET-INCD       THRU 04500-EXIT        03530004
               WHEN NDBPRHXS-HCPCS-NXT-SEQ                              03540004
                   PERFORM 05000-PROCESS-NXT-SEQ THRU 05000-EXIT        03550004
               WHEN NDBPRHXS-HCPCS-ALL-SD                               03560004
                   PERFORM 06000-PROCESS-ALL-SD  THRU 06000-EXIT        03570004
               WHEN OTHER                                               03580004
                   MOVE '2'              TO NDBPRHXS-STATUS-CODE        03590004
                   MOVE WS-ERR-MSG1      TO WS-ABEND-MSG                03600004
                   MOVE WS-DUMP-MESSAGE  TO WGMAPSYS-MESSAGE            03610004
           END-EVALUATE                                                 03620004
                                                                        03630004
           IF WS-HOLD-SEND-PRDT-CDE-CHG  = SPACES                       03640004
              CONTINUE                                                  03650004
           ELSE                                                         03660004
              MOVE WS-HOLD-SEND-PRDT-CDE-CHG   TO                       03670004
                   NDBPRHXS-SEND-PRDT-CDE                               03680004
           END-IF                                                       03690004

CG0891     EVALUATE TRUE
FC0068       WHEN FAC-BASE  AND
FC0068            NDBPPRI-FAC-UNIT-VAL > 0
CG0891       WHEN FAC-SURG  AND
CG0891            WS-HOLD-SEND-PRDT-CDE(1:4) = 'UNGI'
FC0068            MOVE NDBPPRI-FAC-UNIT-VAL TO NDBPPRI-UNIT-VAL
FC0068     END-EVALUATE.                                                03700004

           MOVE NDBPRHXS-PARM-LIST       TO HCPCS-PARMS.                03710004
           MOVE NDBPRHXS-IO-AREA         TO HCPCS-IO.                   03720004
           MOVE APPLICATION-SYSTEM-INFO  TO DUMP-INFO.                  03730004
                                                                        03740004
       00000-GOBACK.                                                    03750004
           GOBACK.                                                      03760004
                                                                        03770004
                                                                        03780004
       00100-INITIALIZATION.                                            03790004
                                                                        03800004
           MOVE HCPCS-PARMS      TO NDBPRHXS-PARM-LIST.                 03810004
           MOVE DUMP-INFO        TO APPLICATION-SYSTEM-INFO.            03820004
           MOVE 'NDBPRHXS'       TO WGMAPSYS-PGM-NAME-ABEND.            03830004
           MOVE HCPCS-IO         TO NDBPRHXS-IO-AREA.                   03840004
NK0408     MOVE NDBPRHXS-EXCEPTION-KEYS TO MPRHPXS-EXCEPTION-KEYS
GM2257     MOVE NDBPRHXS-ADDL-EXCEPTN-KEYS
GM2257                                 TO MPRHPXS-ADDL-EXCEPTN-KEYS
NK0021**   CONVERTED TO WGM                                             03850004
*2258**    ACCEPT WS-DATE        FROM DATE.                             03860004
*2258**    MOVE    WS-DATE(1:6)      TO  WS-CYMD-DATE(3:6).
*2258**    COPY NNMDATEP.
*2258**    MOVE NNMDATES-DISPLAY-CCYYMMDD TO WS-CYMD-DATE.              03870004
NK0021***  MOVE WS-CYMD-DATE     TO WS-CURR-DATE.                       03880004
                                                                        03890004
NK0021     SET     WGMDATES-SYSTEM-DATE           TO TRUE               00063800
NK0021     COPY    WGMDATEP.                                            00063900
NK0021     IF      WGMDATES-OK                                          00064000
NK0021             MOVE WGMDATES-DISPLAY-CCYYMMDD                       00064100
NK0021             TO   WS-CURR-DATE                                    00064200
NK0021                  WS-CYMD-DATE.                                   00064300
                                                                        03890004
           INITIALIZE            WORK-AREAS.                            03900004
           MOVE '<='             TO NDBPPRIB-OP2.                       03910004
           MOVE '>='             TO NDBPPRIB-OP3.                       03920004
                                                                        03930004
           IF NDBPRHXS-SEND-SVC-FROM-DTE NOT NUMERIC                    03940004
              OR                                                        03950004
              NDBPRHXS-SEND-SVC-FROM-DTE = ZEROES                       03960004
              MOVE WS-CURR-DATE  TO NDBPRHXS-SEND-SVC-FROM-DTE.         03970004
                                                                        03980004
           IF NDBPRHXS-SEND-SVC-THRU-DTE NOT NUMERIC                    03990004
              OR                                                        04000004
              NDBPRHXS-SEND-SVC-THRU-DTE = ZEROES                       04010004
              MOVE WS-CURR-DATE TO  NDBPRHXS-SEND-SVC-THRU-DTE.         04020004
                                                                        04030004
           IF NDBPRHXS-SEND-PROC-CDE (6:2) = LOW-VALUES                 04040020
              MOVE SPACES TO NDBPRHXS-SEND-PROC-CDE (6:2).              04050020
                                                                        04060020
           IF NDBPRHXS-SEND-PRDT-VARN  EQUAL LOW-VALUES OR SPACES       04070033
              MOVE ZEROES TO NDBPRHXS-SEND-PRDT-VARN.                   04080032

FC0068     MOVE NDBPRHXS-PLC-OF-TRTMNT TO WS-HOLD-PLC-OF-TRTMNT.        00570004
                                                                        04090032
       00100-EXIT.                                                      04100004
           EXIT.                                                        04110004
                                                                        04120004
                                                                        04130004
NK0021 00500-PROCESS-USING-DB2.                                         04140004
                                                                        04150004
           INITIALIZE NDBPRHXS-IO-AREA.                                 04160004
                                                                        04170004
           IF NDBPRHXS-HCPCS-UNQ-REC                                    04180004
              PERFORM 01010-CHECK-SEND-DATA    THRU 01010-EXIT.         04190004
                                                                        04200004
           PERFORM 50000-GET-DB2-HCPCS-DATA                             03220004
                                                                        04200004
           IF MPRHPXS-OK                                                04220004
               PERFORM 01125-PROCESS-PRICING-ROOT THRU 01125-EXIT       04230004
           ELSE                                                         04220004
               MOVE MPRHPXS-STATUS-CODE TO NDBPRHXS-STATUS-CODE         04240004
           END-IF                                                       04240004
                                                                        04200004
           .                                                            04670004
NK0021 00500-EXIT.                                                      04680004
           EXIT.                                                        04690004
                                                                        04700004
       01000-PROCESS-UNQ-REC.                                           04140004
                                                                        04150004
           INITIALIZE NDBPRHXS-IO-AREA.                                 04160004
                                                                        04170004
           IF NDBPRHXS-HCPCS-UNQ-REC                                    04180004
              PERFORM 01010-CHECK-SEND-DATA    THRU 01010-EXIT.         04190004
                                                                        04200004
           PERFORM 01120-PROCESS-MAIN-ROOT    THRU 01120-EXIT           04210004
           IF CALL-SUCCESSFUL                                           04220004
               PERFORM 01125-PROCESS-PRICING-ROOT THRU 01125-EXIT       04230004
           END-IF                                                       04240004
           IF NDBPRHXS-STATUS-CODE     =  '1'  OR  '5'                  04250004
              GO TO 01000-EXIT.                                         04260004
                                                                        04270004
           IF NDBPRHXS-HCPCS-GET-ROOT                                   04280004
              GO TO 01000-EXIT.                                         04290004
                                                                        04300004
           IF NDBPRHC-SSPND-DENY-IND = 'Y'                              04310004
              INITIALIZE  PCB-MASK                                      04320004
              MOVE 'F' TO NDBPRHSS-COMM                                 04330004
              MOVE ' ' TO NDBPRHSS-L-PAR                                04340004
              MOVE GU  TO WS-FUNC                                       04350004
              PERFORM 01200-PROCESS-SUSP-DENY  THRU 01200-EXIT          04360004
                      VARYING NDB-SD-IDX FROM +1 BY +1 UNTIL            04370004
                      SEGMENT-NOT-FOUND-FOR-GN         OR               04380004
                      NDB-SD-IDX > +5                  OR               04390004
                      NDBPRHXS-STATUS-CODE =  '1'  OR  '5'              04400004
              IF NDBPRHXS-STATUS-CODE     =  '1'  OR  '5'               04410004
                 GO TO 01000-EXIT.                                      04420004
                                                                        04430004
      *    IF  WS-HOLD-SEND-PRDT-CDE(1:2) = 'MC'                        04440004
      *    AND WS-HOLD-SEND-PRDT-CDE(1:4) NOT = 'MCP0'                  04450004
      *    AND NDBPPRI-UNIT-VAL = 0                                     04460004
      *    AND NDBPPRI-ANES-UNIT-VAL = 0                                04470004
      *    AND NDBPPRI-PCU = 0                                          04480004
      *    AND NDBPPRI-TCU = 0                                          04490004
      *    AND NOT MULTI-CHANNEL-PROCEDURE                              04500004
      *       PERFORM 01300-ADD-MCP1-BR-SEG THRU 01300-EXIT.            04510004
      *                                                                 04520004
           INITIALIZE  PCB-MASK.                                        04530004
           MOVE 0 TO NDB-BLK-CNTR                                       04540004
           IF NDBPRHC-BLOCK-CDE      = 'I' OR 'A'                       04550004
              PERFORM 01400-PROCESS-BLOCK   THRU 01400-EXIT             04560004
                      VARYING NDB-BLK-IDX FROM +1 BY +1 UNTIL           04570004
                      SEGMENT-NOT-FOUND-FOR-GN  OR                      04580004
                      NDB-BLK-IDX > +50.                                04590004
                                                                        04600004
           INITIALIZE  PCB-MASK.                                        04610004
           IF NDBPRHC-INCDNTL-IND         = 'Y'                         04620004
              PERFORM 01500-PROCESS-INCID   THRU 01500-EXIT             04630004
                      VARYING NDB-INC-IDX FROM +1 BY +1 UNTIL           04640004
                      SEGMENT-NOT-FOUND-FOR-GN  OR                      04650004
                      NDB-INC-IDX > +50.                                04660004
                                                                        04670004
       01000-EXIT.                                                      04680004
           EXIT.                                                        04690004
                                                                        04700004
                                                                        04710004
       01010-CHECK-SEND-DATA.                                           04720004
                                                                        04730004
           MOVE NDBPRHXS-SEND-PRDT-CDE     TO WS-HOLD-SEND-PRDT-CDE.    04740004
           MOVE NDBPRHXS-SEND-PRDT-VARN    TO WS-HOLD-SEND-PRDT-VARN.   04750032
           MOVE NDBPRHXS-SEND-RGN-CDE      TO WS-HOLD-SEND-RGN-CDE.     04760004
                                                                        04770004
           PERFORM 07100-CALL-TABLE-NDBPRODT  THRU 07100-EXIT.          04780004
           IF TABLEBASE-CALL-OK AND TABLE-FOUND                         04790004
              SET VALID-PRODUCT-CDE        TO TRUE                      04800004
           ELSE                                                         04810004
              MOVE HIGH-VALUES             TO NDBPRHXS-SEND-PRDT-CDE    04820004
                                              NDBPRHXS-SEND-PRDT-VARN   04830004
                                              NDBPRHXS-SEND-RGN-CDE     04840004
              GO TO 01010-EXIT.                                         04850004
                                                                        04860004
           PERFORM 01015-SET-SPECIAL-PROCESS-IND THRU 01015-EXIT.       04870004
           PERFORM 01017-CHANGE-SEND-PRODUCT THRU 01017-EXIT.           04880004
                                                                        04890004
       01010-EXIT.                                                      04900004
            EXIT.                                                       04910004
                                                                        04920004
                                                                        04930004
       01015-SET-SPECIAL-PROCESS-IND.                                   04940004
                                                                        04950004
           EVALUATE TRUE                                                04960004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TX02'                  04970004
                   SET WS-PROCESS-TX02-ONLY TO TRUE                     04980004
      *       WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TX06'                  04990004
CG0587*=>>      REMOVE TX02 DEFAULT FOR TX PRODS                        05100004
CG0587*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TX29'                  04990004
CG0587*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TX30'                  05000004
CG0587*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TX42'                  05000005
CG0252*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TXRS'                  04990004
FC0498*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TXHA'                  04990004
CG0350*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TXHC'                  04990004
CG0362*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TXHL'                  04990004
FC0080*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TXSH'                  04990004
FC0538*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TX00'                  04990004
FC0538*=>>    WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'TXHM'                  04990004
CG0320*=>>    WHEN TX-PROD-NO-TX02-DEF                                  04990004
CG0587*=>>                                                              05100004
CG0587        WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = 'TX'                    05100004
                   SET WS-PROCESS-TX-ONLY   TO TRUE                     05010004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = 'MS'                    05020004
                   SET WS-PROCESS-MS0X-ONLY TO TRUE                     05030004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'MCP1'                  05040004
                   SET WS-PROCESS-MCP1-ONLY TO TRUE                     05050004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:4) = 'MCP0'                  05060004
                   SET WS-PROCESS-MCP0-ONLY TO TRUE                     05070004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:3) = 'DME'                   05080004
                   SET WS-PROCESS-DME1-ONLY TO TRUE                     05090004
CG0587*       WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = 'TX'                    05100004
CG0587*            SET WS-PROCESS-BOTH-TX TO TRUE                       05110004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:3) = 'INS'                   05120004
                   SET WS-PROCESS-INS-FIRST TO TRUE                     05130004
              WHEN OTHER                                                05140004
                   SET WS-PROCESS-NO-TX TO TRUE                         05150004
           END-EVALUATE.                                                05160004
                                                                        05170004
       01015-EXIT.                                                      05180004
            EXIT.                                                       05190004
                                                                        05200004
         SKIP3                                                          05210004
       01017-CHANGE-SEND-PRODUCT.                                       05220004
                                                                        05230004
           IF  WS-HOLD-SEND-PRDT-CDE(1:4) = 'PBPG'                      05240004
           AND NDBPRHXS-SEND-SVC-FROM-DTE < 19960501                    05250004
               GO TO 01017-EXIT                                         05260004
           ELSE                                                         05270004
           IF WS-HOLD-SEND-PRDT-CDE(1:4) = 'PBPX'                       05280004
               GO TO 01017-EXIT                                         05290004
           ELSE                                                         05300004
           IF WS-HOLD-SEND-PRDT-CDE (1:4) = 'PBPY'  AND                 05310018
              NDBPRHXS-SEND-PROC-CDE (1:5) = '88305'                    05320018
               GO TO 01017-EXIT.                                        05330004
                                                                        05340004
           IF WS-HOLD-SEND-PRDT-CDE(1:3) = 'INS'                        05350004
              MOVE WS-HOLD-SEND-PRDT-CDE   TO WS-HOLD-SEND-PRDT-CDE-CHG 05360004
              MOVE 'INST'                  TO NDBPRHXS-SEND-PRDT-CDE    05370004
              MOVE '0000'                  TO NDBPRHXS-SEND-PRDT-VARN   05380044
              MOVE 'INS'                   TO NDBPRHXS-SEND-RGN-CDE     05390044
           ELSE                                                         05400004
           IF WS-HOLD-SEND-PRDT-CDE(1:4) = 'LAB3'                       05410004
              MOVE WS-HOLD-SEND-PRDT-CDE   TO WS-HOLD-SEND-PRDT-CDE-CHG 05420004
              MOVE 'LAB2'                  TO NDBPRHXS-SEND-PRDT-CDE    05430004
           ELSE                                                         05440004
           IF WS-HOLD-SEND-PRDT-CDE(1:3) = 'COE'  OR                    05450004
              WS-HOLD-SEND-PRDT-CDE(1:3) = 'PBP'  OR                    05460004
              WS-HOLD-SEND-PRDT-CDE(1:4) = 'NPB1' OR                    05470004
              WS-HOLD-SEND-PRDT-CDE(1:4) = 'PB70' OR                    05480004
              WS-HOLD-SEND-PRDT-CDE(1:4) = 'PB90'                       05490004
                MOVE WS-HOLD-SEND-PRDT-CDE TO WS-HOLD-SEND-PRDT-CDE-CHG 05500004
                MOVE 'PBP1'                TO NDBPRHXS-SEND-PRDT-CDE.   05510004
                                                                        05520004
           IF  WS-HOLD-SEND-PRDT-CDE(1:2) = 'TX'                        05530004
               IF NDBPRHXS-SEND-RGN-CDE   = SPACES OR LOW-VALUES        05540005
                  MOVE 'TEX'             TO NDBPRHXS-SEND-RGN-CDE       05540144
               END-IF                                                   05560005
               IF  WS-HOLD-SEND-PRDT-CDE  = 'TX02'                      05580044
                  MOVE '0000'            TO NDBPRHXS-SEND-PRDT-VARN     05582044
               END-IF                                                   05583044
           END-IF.                                                      05584044
                                                                        05586044
       01017-EXIT.                                                      05590004
            EXIT.                                                       05600004
                                                                        05610004
                                                                        05620004
       01120-PROCESS-MAIN-ROOT.                                         05630004
           MOVE '01120'                TO  WS-ABEND-PARA.               05640004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                05650004
                                                                        05660004
           MOVE GU                     TO WS-FUNC.                      05670004
           INITIALIZE WS-IO-PATH.                                       05680004
                                                                        05690004
           PERFORM 08000-CALL-MAIN-ROOT THRU 08000-EXIT                 05700004
                                                                        05710004
           IF  CALL-SUCCESSFUL                                          05720004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          05730004
              MOVE WS-IO-ROOT          TO NDBPRHC-IO-AREA               05740004
           ELSE                                                         05750004
           IF SEGMENT-NOT-FOUND                                         05760004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          05770004
           ELSE                                                         05780004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          05790004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                05800004
                                          WGMAPSYS-STATUS-CODE          05810004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  05820004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             05830004
                                                                        05840004
       01120-EXIT.                                                      05850004
           EXIT.                                                        05860004
                                                                        05870004
       01125-PROCESS-PRICING-ROOT.                                      05880004
           MOVE '01125'                TO  WS-ABEND-PARA.               05890004
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCCS-QUAL-HCPCS-CDE      05900004
           MOVE NDBPRHXS-SEND-PRDT-CDE  TO NDBPRCCS-QUAL-PRDT-CDE       05900005
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCCS-QUAL-PRDT-VARN      05900006
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN.     05900007
                                                                        05910004
           IF WS-PROCESS-BOTH-TX                                        05910005
              MOVE 'TX02' TO NDBPRCCS-QUAL-PRDT-CDE                     05910006
              MOVE '0000' TO NDBPRCCS-QUAL-PRDT-VARN                    05910007
              MOVE 'TEX'  TO NDBPRCCS-QUAL-PRCNG-RGN                    05910008
           END-IF                                                       05910009
                                                                        05910010
           IF NDBPRHXS-SEND-PRDT-CDE  (1:2) = 'CC' AND                  05920004
              NDBPRHXS-SEND-RGN-CDE         = 'CCN'                     05920005
              PERFORM 01126-CHK-GENERIC-CCN-SCHED                       05920006
                 THRU 01126-EXIT                                        05920007
           END-IF                                                       05920008
                                                                        05910010
*3979*     IF NDBPRHXS-SEND-PRDT-CDE  (1:3) = ('DCA' OR 'WMA' OR 'MNT') 05920004
*3158*         PERFORM 01126A-CONVERT-CCN-DCA-SCHED THRU                06390006
*3158*                 01126A-EXIT                                      06390006
*3158*     END-IF                                                       05920008
                                                                        05910010
*3597*     IF NDBPRHXS-SEND-PRDT-CDE  (1:3) = 'WMA' AND                 05920004
*3597*        NDBPRHXS-SEND-PRDT-VARN (2:3) = '157'                     05920004
*3597*        MOVE '156'    TO NDBPRCCS-QUAL-PRDT-VARN (2:3)            06390011
*3597*     END-IF                                                       05920008
                                                                        05910010
980209     IF NDBPRHXS-SEND-PRDT-CDE   = 'CR90' AND                     05920004
PK2966        NDBPRHXS-SEND-PRDT-VARN  = ('UCCC' OR '0028')             05920005
980209        MOVE '0000'   TO NDBPRCCS-QUAL-PRDT-VARN                  06390011
980209     END-IF                                                       05920008
                                                                        05920009
      ***** FOR 5/97 HIAA DATA...ONLY 1 ITERATION OF DATA TO BE USED    06000139
      ***** FOR ANY DATE OF SVC...HIAA DATA LOADED WITH A 10/1/95 TO    06000239
      ***** TRY TO REFLECT BEST GUESS ON THE EFF DATE                   06000339
      ***** NEED TO CHANGE WHEN WE HAVE MORE >1 ITERATION OF DATA       06000439
                                                                        06000539
KJ2403*****  CHANGED  HAVE MORE THAN 1 ITERATION OF DATA                06000439
                                                                        06000539
KJ2403*    IF  NDBPRHXS-SEND-PRDT-CDE (1:2) = 'CR'                      06000639
KJ2403*         MOVE +999999999            TO NDBPPRIB-QUAL2            06000743
KJ2403*         MOVE +000000000            TO NDBPPRIB-QUAL3            06000843
KJ2403*    ELSE                                                         06000939
               MOVE NDBPRHXS-SEND-SVC-THRU-DTE TO                       06010039
                    NDBPPRIB-QUAL2                                      06020039
                MOVE NDBPRHXS-SEND-SVC-FROM-DTE TO                      06040237
                    NDBPPRIB-QUAL3.                                     06040339
                                                                        06050004
                                                                        06051039
           IF NDBPRHXS-SEND-PRDT-CDE(1:3) = 'INS'                       06060004
              MOVE WS-HOLD-SEND-RGN-CDE    TO NDBPRCCS-QUAL-PRCNG-RGN   06070004
           ELSE                                                         06080004
              MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN.  06090004
                                                                        06100004
           MOVE GU                     TO WS-FUNC.                      06110004
                                                                        06120004
           INITIALIZE WS-IO-PRICE.                                      06130004
                                                                        06140004
           PERFORM 08200-CALL-PRICING-ROOT THRU 08200-EXIT.             06150004
                                                                        06160004
           IF CALL-SUCCESSFUL OR                                        06170036
              (SEGMENT-NOT-FOUND AND                                    06171036
               NDBPRHXS-SEND-PRDT-CDE (1:2) NOT = 'CR')                 06172036
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          06180004
              MOVE WS-IO-PRICE         TO NDBPPRI-IO-AREA               06190004
*0013*        IF CALL-SUCCESSFUL                                        06200011
                 MOVE WS-PCB-KEYFB-AREA (1:18) TO NDBPRCC-IO-AREA       06200011
*0013*        ELSE                                                      06200011
*0013*           MOVE LOW-VALUES               TO NDBPRCC-IO-AREA       06200011
*0013*        END-IF                                                    06200011
              PERFORM 01127-CHECK-OVR-CANCEL-CODE THRU 01127-EXIT       06210004
              PERFORM 01130-CHECK-PRODUCT-INFO THRU 01130-EXIT          06220004
           ELSE                                                         06230036
           IF SEGMENT-NOT-FOUND                                         06240036
              MOVE '6'                 TO NDBPRHXS-STATUS-CODE          06250036
              INITIALIZE               NDBPRCC-IO-AREA                  06260036
                                       NDBPPRI-IO-AREA                  06270036
           ELSE                                                         06300004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          06310004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                06320004
                                          WGMAPSYS-STATUS-CODE          06330004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  06340004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             06350004
                                                                        06360004
       01125-EXIT.                                                      06370004
           EXIT.                                                        06380004
                                                                        06390004
                                                                        06390005
       01126-CHK-GENERIC-CCN-SCHED.                                     06390006
                                                                        06390007
            IF NDBPRHXS-SEND-PRDT-CDE = ('CCEA' OR 'CCEB' OR            06390008
                                         'CCEC' OR 'CCN8' OR            06390009
                                         'CCN9')                        06390010
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390011
            END-IF                                                      06390012
            IF NDBPRHXS-SEND-PRDT-CDE = ('CCTA' OR 'CCTB' OR            06390020
                                         'CCTC' OR 'CCT8' OR            06390030
                                         'CCT9')                        06390040
               MOVE 'CCT0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390050
            END-IF                                                      06390060
                                                                        06390070
*2719*      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '038'                    06390070
*2719*         MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
*2719*         MOVE '5038' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
*2719*         MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
*2719*      END-IF                                                      06390200
*2719*      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '058'                    06390070
*2719*         MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
*2719*         MOVE '1058' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
*2719*         MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
*2719*      END-IF                                                      06390200
*2719*      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '067'                    06390070
*2719*         MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
*2719*         MOVE '5067' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
*2719*         MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
*2719*      END-IF                                                      06390200
*4498*      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'O87' OR '087'           06390070
*4498*         MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
*4498*         MOVE 'A087' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
*4498*         MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
*4498*      END-IF                                                      06390200
*4498*      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'O88' OR '088'           06390070
*4498*         MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
*4498*         MOVE 'A088' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
*4498*         MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
*4498*      END-IF                                                      06390200
FC0614***   IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '131'                    06390070
FC0614***      MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
FC0614***      MOVE '7131' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
FC0614***      MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
FC0614***   END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '156'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE '1156' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
            END-IF                                                      06390200
FC0239      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '256'                    06390070
FC0239         MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
FC0239         MOVE 'B256' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
FC0239         MOVE 'CCN'    TO NDBPRCCS-QUAL-PRCNG-RGN                 06390100
FC0239      END-IF                                                      06390200
FC0100      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'O83' OR '083'           06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
  V            MOVE 'B083' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'O85' OR '085'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B085' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'O08' OR '008'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B008' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'O92' OR '092'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B092' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'O98' OR '098'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B098' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A20' OR '120'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B120' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A28' OR '128'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B128' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A29' OR '129'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B129' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A35' OR '135'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B135' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A52' OR '152'           06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
  |            MOVE 'B152' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
FC0100      END-IF                                                      06390200
                                                                        06390070
CG0350      IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'I' OR '9'               06390070
CG0320         MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
CG0320         MOVE 'G9'   TO NDBPRCCS-QUAL-PRDT-VARN (1:2)             06390090
CG0320         MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
CG0320      END-IF                                                      06390200
                                                                        06390070
CG0374      IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'H' OR '8'
FC0345         IF NDBPRHXS-SEND-PRDT-VARN = 'B879'
FC0325            CONTINUE
FC0325         ELSE
CG0374            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
CG0374            MOVE 'G8'   TO NDBPRCCS-QUAL-PRDT-VARN (1:2)
CG0374            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0325         END-IF
CG0374      END-IF

FC0270      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'B81' OR '281'           06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE 'B281' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0270      END-IF

FC0325      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A07' OR '107'           06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE 'B170' TO NDBPRCCS-QUAL-PRDT-VARN
  |            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
  |         END-IF
  |         IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'E94' OR '594'           06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE '7154' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0325      END-IF

FC0312      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '490'                    06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE 'D490' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0312      END-IF

FC0289      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '488'                    06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE 'A488' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0289      END-IF
FC0289      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '755'                    06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE '1755' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0289      END-IF

FC0342      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '199'                    06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE '5199' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0342      END-IF
FC0342      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '752'                    06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE 'D752' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0342      END-IF
FC0342      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '757'                    06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE 'G757' TO NDBPRCCS-QUAL-PRDT-VARN
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
FC0342      END-IF

FC0355      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '113'                    06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
  V            MOVE 'A113' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '259'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'A259' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '820'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'G820' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '907'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'G907' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '594'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE '7154' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '577'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B577' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '654'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'A654' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '000'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'A000' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '937'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'G937' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '939'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'G939' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '379'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B379' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '784'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'B784' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '808'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'G808' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
            END-IF                                                      06390200
            IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '958'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'G958' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
FC0355      END-IF                                                      06390200

FC0370      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '380'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'I380' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
FC0370      END-IF                                                      06390200

FC0378      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '592'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE '7592' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
FC0378      END-IF                                                      06390200
FC0378      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = '957'                    06390070
               MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
               MOVE 'G957' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
               MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
FC0378      END-IF                                                      06390200

CG0260      IF NDBPRHXS-SEND-PRDT-VARN = 'BG24' OR 'B724'
  |                                   OR 'IG24' OR 'I724'
  |                                   OR 'GG24' OR 'G724'
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE
  |            MOVE 'B7'   TO NDBPRCCS-QUAL-PRDT-VARN (1:2)
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN
CG0260      END-IF

FC0138      IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A15' OR '115'           06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
  |            MOVE 'D115' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
  |            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
  |         END-IF                                                      06390200
  |         IF NDBPRHXS-SEND-PRDT-VARN (2:3) = 'A55' OR '155'           06390070
  |            MOVE 'CCN0' TO NDBPRCCS-QUAL-PRDT-CDE                    06390080
  |            MOVE 'I155' TO NDBPRCCS-QUAL-PRDT-VARN                   06390090
  V            MOVE 'CCN'  TO NDBPRCCS-QUAL-PRCNG-RGN                   06390100
FC0138      END-IF                                                      06390200

            IF NDBPRCCS-QUAL-PRDT-CDE = 'CCN0'                          06390301
                        AND                                             06390310
               NDBPRHXS-SEND-PRDT-VARN (1:1) = '2'                      06390400
               MOVE '1'      TO NDBPRCCS-QUAL-PRDT-VARN (1:1)           06390500
            END-IF                                                      06390600
                                                                        06392100
            PERFORM 01126A-CONVERT-CCN-DCA-SCHED THRU                   06390006
                    01126A-EXIT.                                        06390006
            .                                                           06390006
       01126-EXIT.                                                      06392200
           EXIT.                                                        06392300
                                                                        06392400
                                                                        06392500
       01126A-CONVERT-CCN-DCA-SCHED.                                    06390006
                                                                        06392500
            IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'A'                      06390700
               MOVE '1'      TO NDBPRCCS-QUAL-PRDT-VARN (2:1)           06390800
            END-IF                                                      06390900
            IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'B'                      06391000
               MOVE '2'      TO NDBPRCCS-QUAL-PRDT-VARN (2:1)           06391100
            END-IF                                                      06391200
            IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'C'                      06391300
               MOVE '3'      TO NDBPRCCS-QUAL-PRDT-VARN (2:1)           06391400
            END-IF                                                      06391500
            IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'O'                      06391600
               MOVE '0'      TO NDBPRCCS-QUAL-PRDT-VARN (2:1)           06391700
            END-IF                                                      06391800
*2719*      IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'D'                      06391600
*2719*         MOVE '4'      TO NDBPRCCS-QUAL-PRDT-VARN (2:1)           06391700
*2719*      END-IF                                                      06391800
*3158*      IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'F'                      06391600
*3158*         MOVE '6'      TO NDBPRCCS-QUAL-PRDT-VARN (2:1)           06391700
*3158*      END-IF                                                      06391800
*3158*      IF NDBPRHXS-SEND-PRDT-VARN (2:1) = 'G'                      06391600
*3158*         MOVE '7'      TO NDBPRCCS-QUAL-PRDT-VARN (2:1)           06391700
*3158*      END-IF                                                      06391800
            .                                                           06392000
                                                                        06392100
       01126A-EXIT.                                                     06392200
           EXIT.                                                        06392300
                                                                        06392400
                                                                        06392500
       01127-CHECK-OVR-CANCEL-CODE.                                     06400004
           MOVE  SPACES                 TO  WS-OVERRIDE-SEG-SW          06410004
           IF CALL-SUCCESSFUL                                           06420004
              IF WS-IO-OVR-CNCL-RSN-CDE NOT = '01' AND                  06430004
                 WS-IO-OVR-CNCL-RSN-CDE NOT = '19'                      06440004
                 SET  OVERRIDE-SEG-RETRIEVED   TO TRUE                  06450004
              ELSE                                                      06460004
                 MOVE GNP                 TO WS-FUNC                    06470036
                                                                        06480004
                 PERFORM 08200-CALL-PRICING-ROOT THRU 08200-EXIT        06490004
                                                                        06500004
                 IF CALL-SUCCESSFUL                                     06510004
                    GO TO 01127-CHECK-OVR-CANCEL-CODE                   06520004
                 ELSE                                                   06530004
                 IF SEGMENT-NOT-FOUND-FOR-GN                            06540004
                    MOVE '0' TO NDBPRHXS-STATUS-CODE                    06550004
                 ELSE                                                   06560004
                    MOVE '5' TO NDBPRHXS-STATUS-CODE                    06570004
                    MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS          06580004
                                                WGMAPSYS-STATUS-CODE    06590004
                    MOVE WS-ERR-MSG3         TO WS-ABEND-MSG            06600004
                    MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.       06610004
                                                                        06620004
       01127-EXIT.                                                      06630004
           EXIT.                                                        06640004
                                                                        06650004
       01130-CHECK-PRODUCT-INFO.                                        06660004
                                                                        06670004
           EVALUATE TRUE                                                06680004
              WHEN WS-PROCESS-TX02-ONLY OR                              06690004
                   WS-PROCESS-TX-ONLY   OR                              06700004
                   WS-PROCESS-MCP1-ONLY OR                              06710004
                   WS-PROCESS-MCP0-ONLY OR                              06720004
                   WS-PROCESS-DME1-ONLY OR                              06730004
                   WS-PROCESS-MS0X-ONLY OR                              06740004
                  (OVERRIDE-SEG-RETRIEVED AND FLAT-DOLLAR-PRDT)         06750004
                   CONTINUE                                             06760004
              WHEN NDBPRHXS-SEND-PRDT-CDE = HIGH-VALUES AND             06770004
                   WS-IO-PRI-EFF-DTE NOT = WS-IO-PRI-END-DTE AND        06780004
                   CALL-SUCCESSFUL                                      06790004
                   PERFORM 01136-CHECK-FOR-ZEROES THRU 01136-EXIT       06800004
CG0451*=>>                                                              00510004
CG0451*=>>    USE NDBPLNST/NDBPFPRS TO GET DEFAULT FEE SCHEDS           00510004
CG0451*=>>               DELETE BEFORE FREEZE                           00510004
CG0451*=>>                                                              00510004
*4810**=>>    WHEN NDBPRHXS-SEND-PRDT-CDE = 'MPAQ' AND                  06810004
*4810**=>>         NDBPRHXS-SEND-PRDT-VARN = '0000' AND                 06810004
*4810**=>>         SEGMENT-NOT-FOUND                                    06171036
*4810**=>>         MOVE 'MPAR' TO NDBPRHXS-SEND-PRDT-CDE                06820004
*4810**=>>         INITIALIZE WS-IO-PRICE                               06820004
*4810**=>>         PERFORM 01146-PROCESS-TX-PROD THRU 01146-EXIT        06820004
              WHEN RP-PROD-WT-MCFS-DEF AND SEGMENT-NOT-FOUND            00510004
                   MOVE 'MCFS' TO NDBPRHXS-SEND-PRDT-CDE                06820004
                   MOVE '0000' TO NDBPRHXS-SEND-PRDT-VARN               06810004
                   INITIALIZE WS-IO-PRICE                               06820004
                   PERFORM 01146-PROCESS-TX-PROD THRU 01146-EXIT        06820004
CG0069*=>>    WHEN OH-PROD-WT-OHHC-DEF AND SEGMENT-NOT-FOUND            00510004
CG0069*=>>         MOVE 'OHHC' TO NDBPRHXS-SEND-PRDT-CDE                06820004
CG0069*=>>         MOVE '0000' TO NDBPRHXS-SEND-PRDT-VARN               06810004
CG0069*=>>         INITIALIZE WS-IO-PRICE                               06820004
CG0069*=>>         PERFORM 01146-PROCESS-TX-PROD THRU 01146-EXIT        06820004
CG0114        WHEN NA-PROD-WT-NA50-DEF AND SEGMENT-NOT-FOUND
CG0114             MOVE 'NA50' TO NDBPRHXS-SEND-PRDT-CDE                06820004
CG0114             MOVE '0L00' TO NDBPRHXS-SEND-PRDT-VARN               06810004
CG0114             INITIALIZE WS-IO-PRICE                               06820004
CG0114             PERFORM 01146-PROCESS-TX-PROD THRU 01146-EXIT        06820004
CG0135*=>>    WHEN GA-PROD-WT-GA10-DEF AND SEGMENT-NOT-FOUND            00510004
CG0135*=>>         MOVE 'GA10' TO NDBPRHXS-SEND-PRDT-CDE                06820004
CG0135*=>>         MOVE '0000' TO NDBPRHXS-SEND-PRDT-VARN               06810004
CG0135*=>>         INITIALIZE WS-IO-PRICE                               06820004
CG0135*=>>         PERFORM 01146-PROCESS-TX-PROD THRU 01146-EXIT        06820004
CG0587*=>>    WHEN WS-PROCESS-BOTH-TX                                   06810004
CG0587*=>>         PERFORM 01146-PROCESS-TX-PROD THRU 01146-EXIT        06820004
CG0587*=>>    WHEN WS-PROCESS-INS-FIRST                                 06830004
CG0587*=>>         PERFORM 01149-PROCESS-INS-PROD THRU 01149-EXIT       06840004
              WHEN OTHER                                                06850004
                   IF SEGMENT-NOT-FOUND OR                              06860004
                      SEGMENT-NOT-FOUND-FOR-GN OR                       06870004
                     (WS-IO-PRI-EFF-DTE          =                      06880004
                      WS-IO-PRI-END-DTE)                                06890015
                       PERFORM 01135-PROCESS-ROOT-DEFAULT THRU          06940015
                               01135-EXIT                               06950015
                   END-IF                                               06960004
           END-EVALUATE.                                                06970004
                                                                        06980004
       01130-EXIT.                                                      06990004
           EXIT.                                                        07000004
                                                                        07010004
       01135-PROCESS-ROOT-DEFAULT.                                      07020004
           MOVE '01135'                 TO  WS-ABEND-PARA.              07030004
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCCS-QUAL-HCPCS-CDE      07040004
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCCS-QUAL-PRDT-VARN      07050004
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN      07060004
           EVALUATE TRUE                                                07070004
              WHEN WS-HOLD-SEND-PRDT-CDE = 'LAB2'                       07080004
              WHEN WS-HOLD-SEND-PRDT-CDE = 'LAB3'                       07090004
                 MOVE 'PBP1'           TO NDBPRCCS-QUAL-PRDT-CDE        07100004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = 'MC'                    07110004
                 MOVE 'MCP1'           TO NDBPRCCS-QUAL-PRDT-CDE        07120004
              WHEN WS-HOLD-SEND-PRDT-CDE(1:3) = ('CCN' OR 'CCT')        07110004
PK2966        WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = 'GA'                    07110004
*0243*        WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = ('VA' OR 'NC')          07110004
*3144*        WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = ('OH' OR 'IL')          07110004
*3144*        WHEN WS-HOLD-SEND-PRDT-CDE(1:3) = 'DCA'                   07110004
*3597*        WHEN WS-HOLD-SEND-PRDT-CDE(1:3) = 'WMA'                   07110004
*3979*        WHEN WS-HOLD-SEND-PRDT-CDE(1:3) = 'MNT'                   07110004
*4348*        WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = 'RP'                    07110004
FC355B        WHEN WS-HOLD-SEND-PRDT-CDE(1:2) = 'TN'                    07110004
*4348*        WHEN WS-HOLD-SEND-PRDT-CDE      = 'MCFS'                  07110004
*4689*        WHEN WS-HOLD-SEND-PRDT-CDE      = 'MPAR'                  07110004
*4689*        WHEN WS-HOLD-SEND-PRDT-CDE      = 'MNPR'                  07110004
CG4596        WHEN WS-HOLD-SEND-PRDT-CDE      = 'NA50'                  07110004
*0013*        WHEN WS-HOLD-SEND-PRDT-CDE      = 'NA10'                  07110004
NK0069        WHEN WS-HOLD-SEND-PRDT-CDE      = 'MAHC'
FC0472        WHEN WS-HOLD-SEND-PRDT-CDE      = 'DCHC'
                 GO TO 01135-EXIT                                       07120004
              WHEN OTHER                                                07130004
                MOVE HIGH-VALUES       TO NDBPRCCS-QUAL-PRDT-CDE        07140004
                                          NDBPRCCS-QUAL-PRDT-VARN       07150004
                                          NDBPRCCS-QUAL-PRCNG-RGN       07160004
           END-EVALUATE                                                 07170004
           MOVE NDBPRHXS-SEND-SVC-THRU-DTE TO                           07180004
                NDBPPRIB-QUAL2                                          07190004
           MOVE NDBPRHXS-SEND-SVC-FROM-DTE TO                           07200004
                NDBPPRIB-QUAL3                                          07210004
                                                                        07220004
           PERFORM 08200-CALL-PRICING-ROOT THRU 08200-EXIT              07230004
                                                                        07240004
           IF  CALL-SUCCESSFUL OR                                       07250004
               SEGMENT-NOT-FOUND-FOR-GN                                 07260004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          07270004
              MOVE WS-PCB-KEYFB-AREA (1:18) TO NDBPRCC-IO-AREA          07280011
              PERFORM 01136-CHECK-FOR-ZEROES THRU 01136-EXIT            07290004
           ELSE                                                         07300004
           IF SEGMENT-NOT-FOUND                                         07310004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          07320004
           ELSE                                                         07330004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          07340004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                07350004
                                          WGMAPSYS-STATUS-CODE          07360004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  07370004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             07380004
                                                                        07390004
       01135-EXIT.                                                      07400004
           EXIT.                                                        07410004
                                                                        07420004
       01136-CHECK-FOR-ZEROES.                                          07430004
                                                                        07440004
              MOVE NDBPRCC-PRICNG-PRDT-CDE TO                           07450034
                   WS-HOLD-IO-SEG-PRDT-CDE                              07460004
              IF WS-IO-PRI-EFF-DTE =                                    07470004
                 WS-IO-PRI-END-DTE                                      07480004
                    PERFORM 01137-GET-FIRST-PRODUCT                     07490004
                            UNTIL WS-IO-PRI-EFF-DTE NOT                 07500004
                                = WS-IO-PRI-END-DTE OR                  07510004
                                  SEGMENT-NOT-FOUND-FOR-GN              07520004
              ELSE                                                      07530004
                 IF (NDBPPRI-UNIT-VAL = +0      AND                     07540004
FC0068               NDBPPRI-FAC-UNIT-VAL = +0  AND                     07540004
                     NDBPPRI-ANES-UNIT-VAL = +0 AND                     07550004
                     NDBPPRI-PCU = +0           AND                     07560004
                     NDBPPRI-TCU = +0)          AND                     07570004
                    (VALID-PRODUCT-CDE          AND                     07580004
                     NOT PRICING-IO-PROD-SPACES AND                     07590004
                     NOT PRICING-IO-PROD-HI-VAL)                        07600004
                     MOVE WS-IO-PRI-UNIT-VAL TO                         07610004
                          NDBPPRI-UNIT-VAL                              07620004
FC0068               MOVE WS-IO-FAC-UNIT-VAL TO                         07610004
FC0068                    NDBPPRI-FAC-UNIT-VAL                          07620004
                     MOVE WS-IO-PRI-ANES-UNIT-VAL TO                    07630004
                          NDBPPRI-ANES-UNIT-VAL                         07640004
                     MOVE WS-IO-PRI-PCU TO                              07650004
                          NDBPPRI-PCU                                   07660004
                     MOVE WS-IO-PRI-TCU TO                              07670004
                          NDBPPRI-TCU                                   07680004
                  ELSE                                                  07690004
                    MOVE WS-IO-PRICE         TO NDBPPRI-IO-AREA.        07700004
       01136-EXIT.                                                      07720004
           EXIT.                                                        07730004
                                                                        07740004
       01137-GET-FIRST-PRODUCT.                                         07750004
           MOVE '01137'                TO  WS-ABEND-PARA.               07760004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                07770004
           MOVE HIGH-VALUES            TO NDBPRCCS-QUAL-PRDT-CDE        07780004
                                          NDBPRCCS-QUAL-PRDT-VARN       07790004
                                          NDBPRCCS-QUAL-PRCNG-RGN       07800004
           MOVE 99999999 TO                                             07810004
                NDBPPRIB-QUAL2                                          07820004
           MOVE 00000000 TO                                             07830004
                NDBPPRIB-QUAL3                                          07840004
           MOVE '-'                    TO NDBPPRIB-COMM.                07850004
                                                                        07860004
           INITIALIZE WS-IO-PRICE.                                      07870004
                                                                        07880004
           PERFORM 08200-CALL-PRICING-ROOT THRU 08200-EXIT              07890004
                                                                        07900004
           IF CALL-SUCCESSFUL                                           07910005
              MOVE WS-PCB-KEYFB-AREA (1:18) TO NDBPRCC-IO-AREA          07920011
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          07930011
              IF (WS-IO-PRI-EFF-DTE =                                   07940004
                  WS-IO-PRI-END-DTE AND                                 07950004
                  WS-IO-PRI-EFF-DTE > 0)                                07960004
                          OR                                            07970004
                  WS-IO-PRI-EFF-DTE >                                   07980004
                  NDBPRHXS-SEND-SVC-FROM-DTE                            07990004
                 MOVE GN TO WS-FUNC                                     08000004
              ELSE                                                      08010004
                 PERFORM 01138-CHECK-FOR-ZEROES THRU 01138-EXIT         08020004
           ELSE                                                         08030004
           IF SEGMENT-NOT-FOUND-FOR-GN                                  08040004
              INITIALIZE               NDBPPRI-IO-AREA                  08050036
              MOVE '6'                 TO NDBPRHXS-STATUS-CODE          08060004
           ELSE                                                         08070004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          08080004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                08090004
                                          WGMAPSYS-STATUS-CODE          08100004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  08110004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             08120004
                                                                        08130004
       01137-EXIT.                                                      08140004
           EXIT.                                                        08150004
                                                                        08160004
       01138-CHECK-FOR-ZEROES.                                          08170004
                                                                        08180004
              MOVE NDBPRCC-PRICNG-PRDT-CDE TO                           08190034
                   WS-HOLD-SEND-PRDT-CDE                                08200004
              IF (NDBPPRI-UNIT-VAL = +0      AND                        08210004
FC0068            NDBPPRI-FAC-UNIT-VAL = +0  AND                        08210004
                  NDBPPRI-ANES-UNIT-VAL = +0 AND                        08220004
                  NDBPPRI-PCU = +0           AND                        08230004
                  NDBPPRI-TCU = +0)          AND                        08240004
                 (VALID-PRODUCT-CDE          AND                        08250004
                  NDBPRCC-PRICNG-PRDT-CDE  NOT  =                       08260035
                  HIGH-VALUES)                                          08270004
                     MOVE WS-IO-PRI-UNIT-VAL TO                         08280004
                          NDBPPRI-UNIT-VAL                              08290004
FC0068               MOVE WS-IO-FAC-UNIT-VAL TO                         07610004
FC0068                    NDBPPRI-FAC-UNIT-VAL                          07620004
                     MOVE WS-IO-PRI-ANES-UNIT-VAL TO                    08300004
                          NDBPPRI-ANES-UNIT-VAL                         08310004
                     MOVE WS-IO-PRI-PCU TO                              08320004
                          NDBPPRI-PCU                                   08330004
                     MOVE WS-IO-PRI-TCU TO                              08340004
                          NDBPPRI-TCU                                   08350004
                  ELSE                                                  08360004
                    MOVE WS-IO-PRICE         TO NDBPPRI-IO-AREA.        08370004
                                                                        08380004
       01138-EXIT.                                                      08390004
           EXIT.                                                        08400004
       01146-PROCESS-TX-PROD.                                           08410004
           MOVE '01146'                 TO  WS-ABEND-PARA.              08420004
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCCS-QUAL-HCPCS-CDE      08430004
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCCS-QUAL-PRDT-VARN      08440004
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN      08450004
           MOVE NDBPRHXS-SEND-PRDT-CDE  TO NDBPRCCS-QUAL-PRDT-CDE       08460004
           MOVE NDBPRHXS-SEND-SVC-THRU-DTE TO                           08470004
                NDBPPRIB-QUAL2                                          08480004
           MOVE NDBPRHXS-SEND-SVC-FROM-DTE TO                           08490004
                NDBPPRIB-QUAL3                                          08500004
                                                                        08510004
           PERFORM 08200-CALL-PRICING-ROOT THRU 08200-EXIT              08520004
                                                                        08530004
           IF CALL-SUCCESSFUL                                           08540004
              MOVE WS-PCB-KEYFB-AREA (1:18) TO NDBPRCC-IO-AREA          08550011
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          08560004
              PERFORM 01147-MOVE-TX-VALUES THRU 01147-EXIT              08570004
           ELSE                                                         08580004
           IF SEGMENT-NOT-FOUND                                         08590004
              MOVE '6'                 TO NDBPRHXS-STATUS-CODE          08600031
           ELSE                                                         08610004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          08620004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                08630004
                                          WGMAPSYS-STATUS-CODE          08640004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  08650004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             08660004
                                                                        08670004
       01146-EXIT.                                                      08680004
           EXIT.                                                        08690004
                                                                        08700004
       01147-MOVE-TX-VALUES.                                            08710004
                                                                        08720004
              IF WS-IO-PRI-EFF-DTE =                                    08730004
                 WS-IO-PRI-END-DTE                                      08740004
                 CONTINUE                                               08750004
              ELSE                                                      08760004
                 PERFORM 01148-CHECK-TX-VALUES THRU 01148-EXIT.         08770004
                                                                        08780004
       01147-EXIT.                                                      08790004
           EXIT.                                                        08800004
                                                                        08810004
       01148-CHECK-TX-VALUES.                                           08820004
           IF WS-IO-PRI-UNIT-VAL NOT = 0                                08830004
              MOVE WS-IO-PRI-UNIT-VAL TO                                08840004
                   NDBPPRI-UNIT-VAL.                                    08850004
                                                                        08860004
FC0068     IF WS-IO-FAC-UNIT-VAL NOT = 0                                08830004
FC0068        MOVE WS-IO-FAC-UNIT-VAL TO                                08840004
FC0068             NDBPPRI-FAC-UNIT-VAL.                                08850004
                                                                        08860004
           IF WS-IO-PRI-ANES-UNIT-VAL NOT = 0                           08870004
              MOVE WS-IO-PRI-ANES-UNIT-VAL TO                           08880004
                   NDBPPRI-ANES-UNIT-VAL.                               08890004
                                                                        08900004
           IF WS-IO-PRI-PCU NOT = 0                                     08910004
              MOVE WS-IO-PRI-PCU TO                                     08920004
                   NDBPPRI-PCU.                                         08930004
                                                                        08940004
           IF WS-IO-PRI-TCU NOT = 0                                     08950004
              MOVE WS-IO-PRI-TCU TO                                     08960004
                   NDBPPRI-TCU.                                         08970004
                                                                        08980004
           IF WS-IO-OVR-OVRIDE-PRC NOT = 0                              08990016
              MOVE WS-IO-OVR-OVRIDE-PRC TO                              09000016
                   NDBPPRI-OVR-OVRIDE-PRC                               09010017
                                                                        09020016
           IF WS-IO-OVR-OVRIDE-PRC-ANES NOT = 0                         09030016
              MOVE WS-IO-OVR-OVRIDE-PRC-ANES TO                         09040016
                   NDBPPRI-OVR-OVRIDE-PRC-ANES                          09050016
                                                                        09060016
           IF WS-IO-OVR-OVRIDE-TC NOT = 0                               09070016
              MOVE WS-IO-OVR-OVRIDE-TC TO                               09080017
                   NDBPPRI-OVR-OVRIDE-TC.                               09090016
                                                                        09100016
           IF WS-IO-OVR-OVRIDE-PRC2 NOT = 0                             09110017
              MOVE WS-IO-OVR-OVRIDE-PRC2 TO                             09120017
                   NDBPPRI-OVR-OVRIDE-PRC2.                             09130016
                                                                        09140016
*4908*     MOVE  WS-IO-PAY-TYPE-IND TO NDBPPRI-PAY-TYPE-IND.            01980004

       01148-EXIT.                                                      09150004
           EXIT.                                                        09160004
                                                                        09170004
       01149-PROCESS-INS-PROD.                                          09180004
           MOVE '01149'                TO  WS-ABEND-PARA.               09190004
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCCS-QUAL-HCPCS-CDE      09200004
           MOVE 'PBP1'                  TO NDBPRCCS-QUAL-PRDT-CDE       09210004
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCCS-QUAL-PRDT-VARN      09220004
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN      09230004
           MOVE NDBPRHXS-SEND-SVC-THRU-DTE TO                           09240004
                NDBPPRIB-QUAL2                                          09250004
           MOVE NDBPRHXS-SEND-SVC-FROM-DTE TO                           09260004
                NDBPPRIB-QUAL3                                          09270004
                                                                        09280004
           PERFORM 08200-CALL-PRICING-ROOT THRU 08200-EXIT.             09290004
                                                                        09300004
           IF SEGMENT-NOT-FOUND                                         09310004
              PERFORM 01135-PROCESS-ROOT-DEFAULT THRU                   09320004
                      01135-EXIT                                        09330004
           ELSE                                                         09340004
           IF CALL-SUCCESSFUL                                           09350004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          09360004
              MOVE WS-IO-PRICE TO NDBPPRI-IO-AREA                       09370004
              MOVE WS-PCB-KEYFB-AREA (1:18) TO NDBPRCC-IO-AREA          09380011
           ELSE                                                         09390004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          09400004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                09410004
                                          WGMAPSYS-STATUS-CODE          09420004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  09430004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             09440004
                                                                        09450004
       01149-EXIT.                                                      09460004
           EXIT.                                                        09470004
                                                                        09480004
       01200-PROCESS-SUSP-DENY.                                         09490004
           MOVE '01200'                TO  WS-ABEND-PARA.               09500004
                                                                        09510004
           PERFORM 08100-CALL-IMS      THRU 08100-EXIT.                 09520004
           MOVE '-' TO NDBPRHSS-COMM.                                   09530004
           MOVE '(' TO NDBPRHSS-L-PAR.                                  09540004
                                                                        09550004
           IF CALL-SUCCESSFUL                                           09560004
                MOVE GN                     TO WS-FUNC                  09570004
                MOVE ' '                    TO NDBPRHSS-ASTR            09580004
                PERFORM 01250-CHK-DTE  THRU 01250-EXIT                  09590004
           ELSE                                                         09600004
           IF SEGMENT-NOT-FOUND-FOR-GN  OR                              09610004
              END-OF-DATA-BASE                                          09620004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          09630004
           ELSE                                                         09640004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          09650004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                09660004
                                          WGMAPSYS-STATUS-CODE          09670004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  09680004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             09690004
                                                                        09700004
       01200-EXIT.                                                      09710004
           EXIT.                                                        09720004
         SKIP3                                                          09730004
       01250-CHK-DTE.                                                   09740004
           MOVE '01250'                TO WS-ABEND-PARA.                09750004
                                                                        09760004
           IF (WS-IO-ERR-EOB-EFF-DTE <= NDBPRHXS-SEND-SVC-THRU-DTE      09770004
               AND                                                      09780004
               WS-IO-ERR-EOB-END-DTE >= NDBPRHXS-SEND-SVC-FROM-DTE      09790004
               AND                                                      09800004
               WS-IO-ERR-EOB-EFF-DTE NOT =                              09810004
               WS-IO-ERR-EOB-END-DTE)                                   09820004
               OR                                                       09830004
               NDBPRHXS-HCPCS-ALL-SD                                    09840004
                MOVE '0'               TO NDBPRHXS-STATUS-CODE          09850004
                MOVE WS-IO-SUSP        TO NDBPRHS-IO-AREA (NDB-SD-IDX)  09860004
                ADD +1                 TO NDB-PRHS-CNTR                 09870004
                PERFORM 07200-CALL-TABLE-NDBSUSPT THRU 07200-EXIT       09880004
           ELSE                                                         09890004
                SET NDB-SD-IDX DOWN BY 1                                09900004
                MOVE '0'               TO NDBPRHXS-STATUS-CODE.         09910004
                                                                        09920004
       01250-EXIT.                                                      09930004
           EXIT.                                                        09940004
                                                                        09950004
       01300-ADD-MCP1-BR-SEG.                                           09960004
           IF NDB-PRHS-CNTR = 0                                         09970004
              MOVE 1            TO NDB-PRHS-CNTR                        09980004
              MOVE 'Y'          TO NDBPRHC-SSPND-DENY-IND               09990004
           END-IF                                                       10000004
                                                                        10010004
           IF NDBPRHS-ERR-EOB-SD-CDE (1) = '101' OR '200' OR '201' OR   10020004
                                           '800' OR 'BR ' OR '   '      10030004
              MOVE 80059598     TO NDBPRHS-ERR-EOB-KEY (1)              10040004
              MOVE 'BR'         TO NDBPRHS-ERR-EOB-SD-CDE (1)           10050004
                                   NDBSUSP-SD-CDE (1)                   10060004
              MOVE 19940401     TO NDBPRHS-ERR-EOB-EFF-DTE (1)          10070004
              MOVE 99999999     TO NDBPRHS-ERR-EOB-END-DTE (1)          10080004
              MOVE ZERO         TO NDBPRHS-ERR-EOB-DLR-LMT (1)          10090004
              MOVE 'MNA'        TO NDBPRHS-ERR-EOB-CDE (1)              10100004
              MOVE '0'          TO NDBPRHS-ERR-EOB-MSG-CDE (1)          10110004
              MOVE 'MEDI-CAL BY REPORT'                                 10120004
                                TO NDBPRHS-ERR-EOB-TEXT (1)             10130004
                                   NDBSUSP-SD-DESC (1)                  10140004
              MOVE 19950301     TO NDBPRHS-LAST-UPDT-DTE (1)            10150004
              MOVE 'SYSTEM'     TO NDBPRHS-LAST-USERID (1)              10160004
              MOVE 'S'          TO NDBSUSP-SD-TYPE-CDE (1)              10170004
           END-IF                                                       10180004
           .                                                            10190004
                                                                        10200004
       01300-EXIT.                                                      10210004
            EXIT.                                                       10220004
                                                                        10230004
                                                                        10240004
       01400-PROCESS-BLOCK.                                             10250004
           MOVE '01400'                TO WS-ABEND-PARA.                10260004
                                                                        10270004
           MOVE GN                     TO WS-FUNC.                      10280004
           PERFORM 08300-CALL-IMS      THRU 08300-EXIT.                 10290004
                                                                        10300004
           IF CALL-SUCCESSFUL                                           10310004
              MOVE '0'             TO NDBPRHXS-STATUS-CODE              10320004
              MOVE WS-IO-BLOCK     TO NDBPBLK-IO-AREA (NDB-BLK-IDX)     10330004
              ADD +1               TO NDB-BLK-CNTR                      10340004
           ELSE                                                         10350004
           IF SEGMENT-NOT-FOUND    OR                                   10360004
              END-OF-DATA-BASE                                          10370004
              GO TO 01400-EXIT                                          10380004
           ELSE                                                         10390004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          10400004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                10410004
                                          WGMAPSYS-STATUS-CODE          10420004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  10430004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             10440004
                                                                        10450004
       01400-EXIT.                                                      10460004
            EXIT.                                                       10470004
                                                                        10480004
       01500-PROCESS-INCID.                                             10490004
           MOVE '01500'                TO WS-ABEND-PARA.                10500004
                                                                        10510004
           MOVE GN                     TO WS-FUNC.                      10520004
           PERFORM 08400-CALL-IMS      THRU 08400-EXIT.                 10530004
                                                                        10540004
           IF CALL-SUCCESSFUL                                           10550004
              MOVE '0'             TO NDBPRHXS-STATUS-CODE              10560004
              MOVE WS-IO-INCID     TO NDBPINC-IO-AREA (NDB-INC-IDX)     10570004
              ADD  +1              TO NDB-INC-CNTR                      10580004
           ELSE                                                         10590004
           IF SEGMENT-NOT-FOUND   OR                                    10600004
              END-OF-DATA-BASE                                          10610004
              GO TO 01500-EXIT                                          10620004
           ELSE                                                         10630004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          10640004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                10650004
                                          WGMAPSYS-STATUS-CODE          10660004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  10670004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             10680004
                                                                        10690004
       01500-EXIT.                                                      10700004
            EXIT.                                                       10710004
                                                                        10720004
      ******************************************************************10730004
      ** 02XXX PARAGRAPHS ARE SINGLE FUNCTION ROUTINES USED TO INSERT  *10740004
      **                  A SEGMENT ON THE DATABASE.                   *10750004
      ******************************************************************10760004
       02100-ISRT-ROOT.                                                 10770004
           MOVE '02100'                TO  WS-ABEND-PARA.               10780004
                                                                        10790004
           MOVE ISRT                   TO WS-FUNC.                      10800004
           MOVE NDBPRHC-IO-AREA        TO WS-DB-IO-AREA.                10810004
           MOVE +4                     TO WS-PARM-COUNT.                10820004
           MOVE ' '                    TO NDBPRHCS-ASTR.                10830004
                                                                        10840004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               10850004
                                                                        10860004
           MOVE '*'                    TO NDBPRHCS-ASTR.                10870004
                                                                        10880004
           IF CALL-SUCCESSFUL                                           10890004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          10900004
           ELSE                                                         10910004
           IF SEGMENT-NOT-FOUND                                         10920004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          10930004
           ELSE                                                         10940004
           IF DUPLICATE-SEGMENT                                         10950004
              MOVE '3'                 TO NDBPRHXS-STATUS-CODE          10960004
           ELSE                                                         10970004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          10980004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                10990004
                                          WGMAPSYS-STATUS-CODE          11000004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  11010004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             11020004
                                                                        11030004
       02100-EXIT.                                                      11040004
           EXIT.                                                        11050004
         SKIP3                                                          11060004
       02200-ISRT-SUSP.                                                 11070004
           MOVE '02200'                TO  WS-ABEND-PARA.               11080004
                                                                        11090004
           MOVE ISRT                   TO WS-FUNC.                      11100004
           MOVE NDBPRHS-IO-AREA (1)    TO WS-DB-IO-AREA.                11110004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                11120004
           MOVE +5                     TO WS-PARM-COUNT.                11130004
           MOVE NDBPRHS-SSA            TO WS-DB-SSA-1.                  11140004
                                                                        11150004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               11160004
                                                                        11170004
           IF CALL-SUCCESSFUL                                           11180004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          11190004
           ELSE                                                         11200004
           IF SEGMENT-NOT-FOUND                                         11210004
              MOVE '1'              TO NDBPRHXS-STATUS-CODE             11220004
           ELSE                                                         11230004
           IF DUPLICATE-SEGMENT                                         11240004
              MOVE '3'                 TO NDBPRHXS-STATUS-CODE          11250004
           ELSE                                                         11260004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          11270004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                11280004
                                          WGMAPSYS-STATUS-CODE          11290004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  11300004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             11310004
                                                                        11320004
       02200-EXIT.                                                      11330004
           EXIT.                                                        11340004
         SKIP3                                                          11350004
       02300-ISRT-UNIT.                                                 11360004
           MOVE '02300'                TO  WS-ABEND-PARA.               11370004
                                                                        11380004
           MOVE ISRT                   TO WS-FUNC.                      11390004
           MOVE NDBPPRI-IO-AREA        TO WS-DB-IO-AREA.                11400004
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCCS-QUAL-HCPCS-CDE      11410004
           MOVE NDBPRHXS-SEND-PRDT-CDE  TO NDBPRCCS-QUAL-PRDT-CDE       11420004
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCCS-QUAL-PRDT-VARN      11430005
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN      11440004
           MOVE +5                     TO WS-PARM-COUNT.                11450004
           MOVE NDBPPRI-SSA            TO WS-DB-SSA-1.                  11460004
                                                                        11470004
           PERFORM 11000-UPDATE-CALL-PRIC-UNIT THRU 11000-EXIT.         11480004
                                                                        11490004
           IF CALL-SUCCESSFUL                                           11500004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          11510004
           ELSE                                                         11520004
           IF SEGMENT-NOT-FOUND                                         11530004
              PERFORM 02350-ISRT-UNIT-ROOT  THRU 02350-EXIT             11540004
           ELSE                                                         11550004
           IF DUPLICATE-SEGMENT                                         11560004
              MOVE '3'                 TO NDBPRHXS-STATUS-CODE          11570004
           ELSE                                                         11580004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          11590004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                11600004
                                          WGMAPSYS-STATUS-CODE          11610004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  11620004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             11630004
                                                                        11640004
       02300-EXIT.                                                      11650004
           EXIT.                                                        11660004
         SKIP3                                                          11670004
       02350-ISRT-UNIT-ROOT.                                            11680004
           MOVE '02350'                 TO  WS-ABEND-PARA.              11690004
                                                                        11700004
           MOVE ISRT                    TO WS-FUNC.                     11710004
           MOVE SPACES                  TO NDBPRCC-IO-AREA              11720014
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCC-HCPCS-CDE            11730013
           MOVE NDBPRHXS-SEND-PRDT-CDE  TO NDBPRCC-PRICNG-PRDT-CDE      11740004
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCC-PRICNG-PRDT-VRN      11750004
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCC-RGN-CDE              11760004
                                                                        11770004
           PERFORM 12000-ISRT-CALL-PRIC-ROOT   THRU 12000-EXIT          11780012
                                                                        11790004
           IF CALL-SUCCESSFUL                                           11800004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          11810004
              PERFORM 02360-ISRT-UNIT-AFTER-ROOT THRU 02360-EXIT        11820004
           ELSE                                                         11830004
           IF DUPLICATE-SEGMENT                                         11840004
              MOVE '3'                 TO NDBPRHXS-STATUS-CODE          11850004
           ELSE                                                         11860004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          11870004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                11880004
                                          WGMAPSYS-STATUS-CODE          11890004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  11900004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             11910004
                                                                        11920004
       02350-EXIT.                                                      11930004
           EXIT.                                                        11940004
         SKIP3                                                          11950004
       02360-ISRT-UNIT-AFTER-ROOT.                                      11960004
           MOVE '02360'                TO  WS-ABEND-PARA.               11970004
                                                                        11980004
           MOVE ISRT                   TO WS-FUNC.                      11990004
           MOVE NDBPPRI-IO-AREA        TO WS-DB-IO-AREA.                12000004
           MOVE +5                     TO WS-PARM-COUNT.                12010004
           MOVE NDBPPRI-SSA            TO WS-DB-SSA-1.                  12020004
                                                                        12030004
           PERFORM 11000-UPDATE-CALL-PRIC-UNIT THRU 11000-EXIT.         12040004
                                                                        12050004
           IF CALL-SUCCESSFUL                                           12060004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          12070004
           ELSE                                                         12080004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          12090004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                12100004
                                          WGMAPSYS-STATUS-CODE          12110004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  12120004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             12130004
                                                                        12140004
       02360-EXIT.                                                      12150004
           EXIT.                                                        12160004
         SKIP3                                                          12170004
       02400-ISRT-BLOK.                                                 12180004
           MOVE '02400'                TO  WS-ABEND-PARA.               12190004
                                                                        12200004
           MOVE ISRT                   TO WS-FUNC.                      12210004
           MOVE NDBPBLK-IO-AREA (1)    TO WS-DB-IO-AREA.                12220004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                12230004
           MOVE +5                     TO WS-PARM-COUNT.                12240004
           MOVE NDBPBLK-SSA            TO WS-DB-SSA-1.                  12250004
                                                                        12260004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               12270004
                                                                        12280004
           IF CALL-SUCCESSFUL                                           12290004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          12300004
           ELSE                                                         12310004
           IF SEGMENT-NOT-FOUND                                         12320004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          12330004
           ELSE                                                         12340004
           IF DUPLICATE-SEGMENT                                         12350004
              MOVE '3'                 TO NDBPRHXS-STATUS-CODE          12360004
           ELSE                                                         12370004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          12380004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                12390004
                                          WGMAPSYS-STATUS-CODE          12400004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  12410004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             12420004
                                                                        12430004
       02400-EXIT.                                                      12440004
           EXIT.                                                        12450004
         SKIP3                                                          12460004
       02500-ISRT-INCD.                                                 12470004
           MOVE '02500'                TO  WS-ABEND-PARA.               12480004
                                                                        12490004
           MOVE ISRT                   TO WS-FUNC.                      12500004
           MOVE NDBPINC-IO-AREA (1)    TO WS-DB-IO-AREA.                12510004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                12520004
           MOVE +5                     TO WS-PARM-COUNT.                12530004
           MOVE NDBPINC-SSA            TO WS-DB-SSA-1.                  12540004
                                                                        12550004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               12560004
                                                                        12570004
           IF CALL-SUCCESSFUL                                           12580004
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          12590004
           ELSE                                                         12600004
           IF SEGMENT-NOT-FOUND                                         12610004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          12620004
           ELSE                                                         12630004
           IF DUPLICATE-SEGMENT                                         12640004
              MOVE '3'                 TO NDBPRHXS-STATUS-CODE          12650004
           ELSE                                                         12660004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          12670004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                12680004
                                          WGMAPSYS-STATUS-CODE          12690004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  12700004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE.             12710004
                                                                        12720004
       02500-EXIT.                                                      12730004
           EXIT.                                                        12740004
                                                                        12750004
      ******************************************************************12760004
      ** 03XXX PARAGRAPHS ARE SINGLE FUNCTION ROUTINES USED TO REPLACE *12770004
      **                  A SEGMENT ON THE DATABASE.                   *12780004
      ******************************************************************12790004
       03100-REPL-ROOT.                                                 12800004
           MOVE '03100'                TO  WS-ABEND-PARA.               12810004
                                                                        12820004
           MOVE GHU                    TO WS-FUNC.                      12830004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                12840004
           MOVE SPACES                 TO WS-DB-IO-AREA.                12850004
           MOVE +4                     TO WS-PARM-COUNT.                12860004
                                                                        12870004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               12880004
                                                                        12890004
           EVALUATE TRUE                                                12900004
           WHEN CALL-SUCCESSFUL                                         12910004
              MOVE NDBPRHC-IO-AREA     TO WS-DB-IO-AREA                 12920004
              MOVE REPL                TO WS-FUNC                       12930004
              MOVE +3                  TO WS-PARM-COUNT                 12940004
              PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             12950004
              IF CALL-SUCCESSFUL                                        12960004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          12970004
              ELSE                                                      12980004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       12990004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             13000004
                                             WGMAPSYS-STATUS-CODE       13010004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               13020004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           13030004
              END-IF                                                    13040004
           WHEN SEGMENT-NOT-FOUND                                       13050004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          13060004
           WHEN OTHER                                                   13070004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          13080004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                13090004
                                          WGMAPSYS-STATUS-CODE          13100004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  13110004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              13120004
              END-EVALUATE.                                             13130004
                                                                        13140004
       03100-EXIT.                                                      13150004
           EXIT.                                                        13160004
           SKIP3                                                        13170004
       03200-REPL-SUSP.                                                 13180004
           MOVE '03200'                TO  WS-ABEND-PARA.               13190004
                                                                        13200004
           MOVE GHU                    TO WS-FUNC.                      13210004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                13220004
           MOVE NDBPRHXS-SEND-SUSP-KEY-DTE TO NDBPRHSS-QUAL-DTE         13230004
           MOVE NDBPRHS-IO-AREA (1)    TO WS-DB-IO-AREA.                13240004
           MOVE +5                     TO WS-PARM-COUNT.                13250004
           MOVE '*'                    TO NDBPRHSS-ASTR                 13260004
           MOVE NDBPRHS-SSA-Q          TO WS-DB-SSA-1.                  13270004
                                                                        13280004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               13290004
                                                                        13300004
           EVALUATE TRUE                                                13310004
           WHEN CALL-SUCCESSFUL                                         13320004
              MOVE NDBPRHS-IO-AREA (1) TO WS-DB-IO-AREA                 13330004
              MOVE REPL                TO WS-FUNC                       13340004
              MOVE +3                  TO WS-PARM-COUNT                 13350004
              PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             13360004
              IF CALL-SUCCESSFUL                                        13370004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          13380004
              ELSE                                                      13390004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       13400004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             13410004
                                             WGMAPSYS-STATUS-CODE       13420004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               13430004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           13440004
              END-IF                                                    13450004
           WHEN SEGMENT-NOT-FOUND                                       13460004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          13470004
           WHEN OTHER                                                   13480004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          13490004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                13500004
                                          WGMAPSYS-STATUS-CODE          13510004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  13520004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              13530004
           END-EVALUATE.                                                13540004
                                                                        13550004
       03200-EXIT.                                                      13560004
           EXIT.                                                        13570004
           SKIP3                                                        13580004
       03300-REPL-UNIT.                                                 13590004
           MOVE '03300'                TO  WS-ABEND-PARA.               13600004
                                                                        13610004
           MOVE GHU                    TO WS-FUNC.                      13620004
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCCS-QUAL-HCPCS-CDE      13630004
           MOVE NDBPRHXS-SEND-PRDT-CDE  TO NDBPRCCS-QUAL-PRDT-CDE       13640004
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCCS-QUAL-PRDT-VARN      13650005
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN      13660004
           MOVE '= '                   TO NDBPPRIB-OP2.                 13670004
           MOVE '= '                   TO NDBPPRIB-OP3.                 13680004
           MOVE NDBPRHXS-SEND-SVC-FROM-DTE TO                           13690004
                NDBPPRIB-QUAL2.                                         13700004
           MOVE NDBPRHXS-SEND-SVC-THRU-DTE TO                           13710004
                NDBPPRIB-QUAL3.                                         13720004
           MOVE NDBPPRI-IO-AREA        TO WS-DB-IO-AREA.                13730004
           MOVE +5                     TO WS-PARM-COUNT.                13740004
           MOVE NDBPPRI-SSA-B          TO WS-DB-SSA-1.                  13750004
                                                                        13760004
           PERFORM 11000-UPDATE-CALL-PRIC-UNIT THRU 11000-EXIT.         13770004
           MOVE WS-DB-IO-AREA TO                                        13780004
                WS-IO-PRICE.                                            13790004
                                                                        13800004
           EVALUATE TRUE                                                13810004
           WHEN CALL-SUCCESSFUL                                         13820004
              MOVE NDBPPRI-IO-AREA     TO WS-DB-IO-AREA                 13830004
              MOVE REPL                TO WS-FUNC                       13840004
              MOVE +3                  TO WS-PARM-COUNT                 13850004
              PERFORM 11000-UPDATE-CALL-PRIC-UNIT THRU 11000-EXIT       13860004
              IF CALL-SUCCESSFUL                                        13870004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          13880004
              ELSE                                                      13890004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       13900004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             13910004
                                             WGMAPSYS-STATUS-CODE       13920004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               13930004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           13940004
              END-IF                                                    13950004
           WHEN SEGMENT-NOT-FOUND                                       13960004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          13970004
           WHEN OTHER                                                   13980004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          13990004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                14000004
                                          WGMAPSYS-STATUS-CODE          14010004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  14020004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              14030004
           END-EVALUATE.                                                14040004
                                                                        14050004
       03300-EXIT.                                                      14060004
           EXIT.                                                        14070004
           SKIP3                                                        14080004
       03400-REPL-BLOK.                                                 14090004

           MOVE '03400'                TO  WS-ABEND-PARA                14100004
                                                                        14110004
*0013*     IF NDBPRHXS-SEND-BLK-PROC-CDE = SPACES                       16750004
*0013*        SET NDBPRHXS-MISSING-BLK-DATA TO TRUE
*0013*     ELSE
*0013*        MOVE NDBPRHXS-SEND-BLK-PROC-CDE
*0013*                                    TO NDBPBLKQ-QUAL
*0013*        MOVE GHU                    TO WS-FUNC                    14120004
*0013*        MOVE NDBPBLK-IO-AREA (1)    TO WS-DB-IO-AREA              14130004
*0013*        MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL              14140004
*0013*        MOVE +5                     TO WS-PARM-COUNT              14150004
*0013*        MOVE NDBPBLK-SSA-Q          TO WS-DB-SSA-1                14160004
*0013*                                                                  14170004
*0013*        PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             14180004
*0013*                                                                  14190004
*0013*        EVALUATE TRUE                                             14200004
*0013*            WHEN CALL-SUCCESSFUL                                  14210004
*0013*                 MOVE NDBPBLK-IO-AREA (1) TO WS-DB-IO-AREA        14220004
*0013*                 MOVE REPL                TO WS-FUNC              14230004
*0013*                 MOVE +3                  TO WS-PARM-COUNT        14240004
*0013*                 PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT    14250004
*0013*                 IF CALL-SUCCESSFUL                               14260004
*0013*                    MOVE '0'              TO NDBPRHXS-STATUS-CODE 14270004
*0013*                 ELSE                                             14280004
*0013*                    MOVE '5'              TO NDBPRHXS-STATUS-CODE 14290004
*0013*                    MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS    14300004
*0013*                                             WGMAPSYS-STATUS-CODE 14310004
*0013*                    MOVE WS-ERR-MSG3         TO WS-ABEND-MSG      14320004
*0013*                    MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE  14330004
*0013*                 END-IF                                           14340004
*0013*            WHEN SEGMENT-NOT-FOUND                                14350004
*0013*                 MOVE '1'              TO NDBPRHXS-STATUS-CODE    14360004
*0013*            WHEN OTHER                                            14370004
*0013*                 MOVE '5'              TO NDBPRHXS-STATUS-CODE    14380004
*0013*                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS       14390004
*0013*                                          WGMAPSYS-STATUS-CODE    14400004
*0013*                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG         14410004
*0013*                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE     14420004
*0013*        END-EVALUATE                                              14430004
*0013*     END-IF.
                                                                        14440004
       03400-EXIT.                                                      14450004
           EXIT.                                                        14460004
           SKIP3                                                        14470004
       03500-REPL-INCD.                                                 14480004
           MOVE '03500'                TO  WS-ABEND-PARA.               14490004
                                                                        14500004
           MOVE GHU                    TO WS-FUNC.                      14510004
           MOVE NDBPINC-IO-AREA (1)    TO WS-DB-IO-AREA.                14520004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                14530004
           MOVE NDBPRHXS-SEND-INCD-PROC-CDE TO NDBPINCS-QUAL.           14540004
           MOVE +5                     TO WS-PARM-COUNT.                14550004
           MOVE NDBPINC-SSA-Q          TO WS-DB-SSA-1.                  14560004
                                                                        14570004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               14580004
                                                                        14590004
           EVALUATE TRUE                                                14600004
           WHEN CALL-SUCCESSFUL                                         14610004
              MOVE NDBPINC-IO-AREA (1) TO WS-DB-IO-AREA                 14620004
              MOVE REPL                TO WS-FUNC                       14630004
              MOVE +3                  TO WS-PARM-COUNT                 14640004
              PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             14650004
              IF CALL-SUCCESSFUL                                        14660004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          14670004
              ELSE                                                      14680004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       14690004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             14700004
                                             WGMAPSYS-STATUS-CODE       14710004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               14720004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           14730004
              END-IF                                                    14740004
           WHEN SEGMENT-NOT-FOUND                                       14750004
              MOVE '1'              TO NDBPRHXS-STATUS-CODE             14760004
           WHEN OTHER                                                   14770004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          14780004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                14790004
                                          WGMAPSYS-STATUS-CODE          14800004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  14810004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              14820004
           END-EVALUATE.                                                14830004
                                                                        14840004
       03500-EXIT.                                                      14850004
           EXIT.                                                        14860004
                                                                        14870004
      ******************************************************************14880004
      ** 04XXX PARAGRAPHS ARE SINGLE FUNCTION ROUTINES USED TO DELETE  *14890004
      **                  A SEGMENT ON THE DATABASE.                   *14900004
      ******************************************************************14910004
       04100-DLET-ROOT.                                                 14920004
           MOVE '04100'                TO  WS-ABEND-PARA.               14930004
                                                                        14940004
           MOVE GHU                    TO WS-FUNC.                      14950004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                14960004
           MOVE SPACES                 TO WS-DB-IO-AREA.                14970004
           MOVE +4                     TO WS-PARM-COUNT.                14980004
                                                                        14990004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               15000004
                                                                        15010004
           EVALUATE TRUE                                                15020004
           WHEN CALL-SUCCESSFUL                                         15030004
              MOVE NDBPRHC-IO-AREA     TO WS-DB-IO-AREA                 15040004
              MOVE DLET                TO WS-FUNC                       15050004
              MOVE +3                  TO WS-PARM-COUNT                 15060004
              PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             15070004
              IF CALL-SUCCESSFUL                                        15080004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          15090004
              ELSE                                                      15100004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       15110004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             15120004
                                             WGMAPSYS-STATUS-CODE       15130004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               15140004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           15150004
              END-IF                                                    15160004
           WHEN SEGMENT-NOT-FOUND                                       15170004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          15180004
           WHEN OTHER                                                   15190004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          15200004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                15210004
                                          WGMAPSYS-STATUS-CODE          15220004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  15230004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              15240004
              END-EVALUATE.                                             15250004
                                                                        15260004
       04100-EXIT.                                                      15270004
           EXIT.                                                        15280004
           SKIP3                                                        15290004
       04150-DLET-PRCNG-ROOT.                                           15300008
           MOVE '04150'                TO  WS-ABEND-PARA.               15310008
                                                                        15320008
           MOVE GHU                    TO WS-FUNC.                      15330008
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRCCB-QUAL2                15340008
                                          NDBPRCCB-QUAL3                15350008
           MOVE SPACES                 TO WS-DB-IO-AREA.                15360008
           MOVE +4                     TO WS-PARM-COUNT.                15370008
                                                                        15380008
           PERFORM 10500-UPD-CALL-ALL-PRIC-ROOT THRU 10500-EXIT         15390010
                                                                        15400008
           EVALUATE TRUE                                                15410008
           WHEN CALL-SUCCESSFUL                                         15420008
              MOVE GHN                 TO WS-FUNC                       15430008
              PERFORM 04175-DLET-ALL-PRICING                            15440008
                   UNTIL SEGMENT-NOT-FOUND-FOR-GN                       15450008
                   OR    END-OF-DATA-BASE                               15460008
                   OR    NDBPRHXS-STATUS-CODE = '5'                     15470008
           WHEN SEGMENT-NOT-FOUND                                       15480008
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          15490008
           WHEN OTHER                                                   15500008
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          15510008
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                15520008
                                          WGMAPSYS-STATUS-CODE          15530008
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  15540008
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              15550008
              END-EVALUATE.                                             15560008
                                                                        15570008
       04150-EXIT.                                                      15580008
           EXIT.                                                        15590008
           SKIP3                                                        15600008
       04175-DLET-ALL-PRICING.                                          15610008
                                                                        15620008
           MOVE DLET                TO WS-FUNC                          15630008
                                                                        15640008
           PERFORM 10000-UPDATE-CALL-PRIC-ROOT THRU 10000-EXIT          15650008
                                                                        15660008
           IF CALL-SUCCESSFUL                                           15670008
              MOVE '0'                 TO NDBPRHXS-STATUS-CODE          15680008
              PERFORM 10500-UPD-CALL-ALL-PRIC-ROOT THRU 10500-EXIT      15690010
           ELSE                                                         15700008
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          15710008
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                15720008
                                           WGMAPSYS-STATUS-CODE         15730008
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  15740008
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              15750008
           END-IF                                                       15760008
           .                                                            15770010
                                                                        15780008
       04175-EXIT.                                                      15790008
           EXIT.                                                        15800008
           SKIP3                                                        15810008
       04200-DLET-SUSP.                                                 15820004
           MOVE '04200'                TO  WS-ABEND-PARA.               15830004
                                                                        15840004
           MOVE GHU                    TO WS-FUNC.                      15850004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                15860004
           MOVE NDBPRHXS-SEND-SUSP-KEY-DTE TO NDBPRHSS-QUAL-DTE         15870004
           MOVE NDBPRHS-IO-AREA (1)    TO WS-DB-IO-AREA.                15880004
           MOVE +5                     TO WS-PARM-COUNT.                15890004
           MOVE '*'                    TO NDBPRHSS-ASTR.                15900004
           MOVE NDBPRHS-SSA-Q          TO WS-DB-SSA-1.                  15910004
                                                                        15920004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               15930004
                                                                        15940004
           EVALUATE TRUE                                                15950004
           WHEN CALL-SUCCESSFUL                                         15960004
              MOVE NDBPRHS-IO-AREA (1) TO WS-DB-IO-AREA                 15970004
              MOVE DLET                TO WS-FUNC                       15980004
              MOVE +3                  TO WS-PARM-COUNT                 15990004
              PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             16000004
              IF CALL-SUCCESSFUL                                        16010004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          16020004
              ELSE                                                      16030004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       16040004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             16050004
                                             WGMAPSYS-STATUS-CODE       16060004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               16070004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           16080004
              END-IF                                                    16090004
           WHEN SEGMENT-NOT-FOUND                                       16100004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          16110004
           WHEN OTHER                                                   16120004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          16130004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                16140004
                                          WGMAPSYS-STATUS-CODE          16150004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  16160004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              16170004
           END-EVALUATE.                                                16180004
                                                                        16190004
       04200-EXIT.                                                      16200004
           EXIT.                                                        16210004
           SKIP3                                                        16220004
       04300-DLET-UNIT.                                                 16230004
           MOVE '04300'                TO  WS-ABEND-PARA.               16240004
                                                                        16250004
           MOVE GHU                     TO WS-FUNC.                     16260004
           MOVE NDBPRHXS-SEND-PROC-CDE  TO NDBPRCCS-QUAL-HCPCS-CDE      16270004
           MOVE NDBPRHXS-SEND-PRDT-CDE  TO NDBPRCCS-QUAL-PRDT-CDE       16280004
           MOVE NDBPRHXS-SEND-PRDT-VARN TO NDBPRCCS-QUAL-PRDT-VARN      16290005
           MOVE NDBPRHXS-SEND-RGN-CDE   TO NDBPRCCS-QUAL-PRCNG-RGN      16300004
           MOVE '= '                    TO NDBPPRIB-OP2.                16310004
           MOVE '= '                    TO NDBPPRIB-OP3.                16320004
           MOVE NDBPRHXS-SEND-SVC-FROM-DTE TO                           16330004
                NDBPPRIB-QUAL2.                                         16340004
           MOVE NDBPRHXS-SEND-SVC-THRU-DTE TO                           16350004
                NDBPPRIB-QUAL3.                                         16360004
           MOVE NDBPPRI-IO-AREA        TO WS-DB-IO-AREA.                16370004
           MOVE +5                     TO WS-PARM-COUNT.                16380004
           MOVE NDBPPRI-SSA-B          TO WS-DB-SSA-1.                  16390004
                                                                        16400004
           PERFORM 11000-UPDATE-CALL-PRIC-UNIT THRU 11000-EXIT.         16410004
           MOVE WS-DB-IO-AREA TO                                        16420004
                WS-IO-PRICE.                                            16430004
                                                                        16440004
           EVALUATE TRUE                                                16450004
           WHEN CALL-SUCCESSFUL                                         16460004
              MOVE NDBPPRI-IO-AREA     TO WS-DB-IO-AREA                 16470004
              MOVE DLET                TO WS-FUNC                       16480004
              MOVE +3                  TO WS-PARM-COUNT                 16490004
              PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             16500004
              IF CALL-SUCCESSFUL                                        16510004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          16520004
              ELSE                                                      16530004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       16540004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             16550004
                                             WGMAPSYS-STATUS-CODE       16560004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               16570004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           16580004
              END-IF                                                    16590004
           WHEN SEGMENT-NOT-FOUND                                       16600004
              MOVE '1'                 TO NDBPRHXS-STATUS-CODE          16610004
           WHEN OTHER                                                   16620004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          16630004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                16640004
                                          WGMAPSYS-STATUS-CODE          16650004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  16660004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              16670004
           END-EVALUATE.                                                16680004
                                                                        16690004
       04300-EXIT.                                                      16700004
           EXIT.                                                        16710004
           SKIP3                                                        16720004
       04400-DLET-BLOK.                                                 16730004
           MOVE '04400'                TO  WS-ABEND-PARA.               16740004

*0013*     IF NDBPRHXS-SEND-BLK-PROC-CDE = SPACES                       16750004
*0013*        SET NDBPRHXS-MISSING-BLK-DATA TO TRUE
*0013*     ELSE
*0013*        MOVE NDBPRHXS-SEND-BLK-PROC-CDE
*0013*                                    TO NDBPBLKQ-QUAL
*0013*        MOVE GHU                    TO WS-FUNC                    16760004
*0013*        MOVE NDBPBLK-IO-AREA (1)    TO WS-DB-IO-AREA              16770004
*0013*        MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL              16780004
*0013*        MOVE +5                     TO WS-PARM-COUNT              16790004
*0013*        MOVE NDBPBLK-SSA-Q          TO WS-DB-SSA-1                16800004
*0013*                                                                  16810004
*0013*        PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             16820004
*0013*                                                                  16830004
*0013*        EVALUATE TRUE                                             16840004
*0013*            WHEN CALL-SUCCESSFUL                                  16850004
*0013*                 MOVE DLET                TO WS-FUNC              16860004
*0013*                 MOVE +3                  TO WS-PARM-COUNT        16870004
*0013*                 PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT    16880004
*0013*                 IF CALL-SUCCESSFUL                               16890004
*0013*                    MOVE '0'              TO NDBPRHXS-STATUS-CODE 16900004
*0013*                 ELSE                                             16910004
*0013*                    MOVE '5'     TO NDBPRHXS-STATUS-CODE          16920004
*0013*                    MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS    16930004
*0013*                                       WGMAPSYS-STATUS-CODE       16940004
*0013*                    MOVE WS-ERR-MSG3         TO WS-ABEND-MSG      16950004
*0013*                    MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE  16960004
*0013*                 END-IF                                           16970004
*0013*            WHEN SEGMENT-NOT-FOUND                                16980004
*0013*                 MOVE '1'              TO NDBPRHXS-STATUS-CODE    16990004
*0013*            WHEN OTHER                                            17000004
*0013*                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE 17010004
*0013*                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS       17020004
*0013*                                    WGMAPSYS-STATUS-CODE          17030004
*0013*                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG         17040004
*0013*                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE     17050004
*0013*        END-EVALUATE                                              17060004
*0013*     END-IF.
                                                                        17070004
       04400-EXIT.                                                      17080004
           EXIT.                                                        17090004
           SKIP3                                                        17100004
       04500-DLET-INCD.                                                 17110004
           MOVE '04500'                TO  WS-ABEND-PARA.               17120004
                                                                        17130004
           MOVE GHU                    TO WS-FUNC.                      17140004
           MOVE NDBPINC-IO-AREA (1)    TO WS-DB-IO-AREA.                17150004
           MOVE NDBPRHXS-SEND-PROC-CDE TO NDBPRHCS-QUAL.                17160004
           MOVE NDBPRHXS-SEND-INCD-PROC-CDE TO NDBPINCS-QUAL.           17170004
           MOVE +5                     TO WS-PARM-COUNT.                17180004
           MOVE NDBPINC-SSA-Q          TO WS-DB-SSA-1.                  17190004
                                                                        17200004
           PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT.               17210004
                                                                        17220004
           EVALUATE TRUE                                                17230004
           WHEN CALL-SUCCESSFUL                                         17240004
              MOVE NDBPINC-IO-AREA (1) TO WS-DB-IO-AREA                 17250004
              MOVE DLET                TO WS-FUNC                       17260004
              MOVE +3                  TO WS-PARM-COUNT                 17270004
              PERFORM 09000-UPDATE-CALL-IMS THRU 09000-EXIT             17280004
              IF CALL-SUCCESSFUL                                        17290004
                 MOVE '0'              TO NDBPRHXS-STATUS-CODE          17300004
              ELSE                                                      17310004
                 MOVE '5'                 TO NDBPRHXS-STATUS-CODE       17320004
                 MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS             17330004
                                             WGMAPSYS-STATUS-CODE       17340004
                 MOVE WS-ERR-MSG3         TO WS-ABEND-MSG               17350004
                 MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE           17360004
              END-IF                                                    17370004
           WHEN SEGMENT-NOT-FOUND                                       17380004
              MOVE '1'              TO NDBPRHXS-STATUS-CODE             17390004
           WHEN OTHER                                                   17400004
              MOVE '5'                 TO NDBPRHXS-STATUS-CODE          17410004
              MOVE WS-PCB-STATUS-CODE  TO WS-ERR3-STATUS                17420004
                                          WGMAPSYS-STATUS-CODE          17430004
              MOVE WS-ERR-MSG3         TO WS-ABEND-MSG                  17440004
              MOVE WS-DUMP-MESSAGE     TO WGMAPSYS-MESSAGE              17450004
           END-EVALUATE.                                                17460004
                                                                        17470004
       04500-EXIT.                                                      17480004
           EXIT.                                                        17490004
                                                                        17500004
                                                                        17510004
       05000-PROCESS-NXT-SEQ.                                           17520004
           MOVE '05000'                TO  WS-ABEND-PARA.               17530004
                                                                        17540004
           MOVE GN                     TO  WS-FUNC.                     17550004
           INITIALIZE            NDBPRHXS-IO-AREA.                      17560004
                                                                        17570004
           PERFORM 08500-CALL-IMS      THRU 08500-EXIT.                 17580004
           IF CALL-SUCCESSFUL          OR                               17590004
              HIGHER-LEVEL-SEGMENT     OR                               17600004
              NEW-SEGMENT-TYPE                                          17610004
              SET NDB-SD-IDX           TO +1                            17620004
              SET NDB-BLK-IDX          TO +1                            17630004
              SET NDB-INC-IDX          TO +1                            17640004
              PERFORM 05100-CHECK-PCB-SEG-NAME THRU 05100-EXIT          17650004
              MOVE '0'       TO  NDBPRHXS-STATUS-CODE                   17660004
           ELSE                                                         17670004
           IF END-OF-DATA-BASE                                          17680004
              MOVE '1'       TO  NDBPRHXS-STATUS-CODE.                  17690004
                                                                        17700004
       05000-EXIT.                                                      17710004
            EXIT.                                                       17720004
                                                                        17730004
       05100-CHECK-PCB-SEG-NAME.                                        17740004
           MOVE '05100'            TO  WS-ABEND-PARA.                   17750004
                                                                        17760004
           IF WS-PCB-SEG-NAME  = 'NDBPRHC '                             17770004
              MOVE WS-IO-GN-AREA   TO  NDBPRHC-IO-AREA                  17780004
           ELSE                                                         17790004
           IF WS-PCB-SEG-NAME  = 'NDBPRHS '                             17800004
              MOVE WS-IO-GN-AREA   TO  NDBPRHS-IO-AREA (NDB-SD-IDX)     17810004
              PERFORM 07200-CALL-TABLE-NDBSUSPT THRU 07200-EXIT         17820004
           ELSE                                                         17830004
           IF WS-PCB-SEG-NAME  = 'NDBPBLK '                             17840004
              MOVE WS-IO-GN-AREA   TO  NDBPBLK-IO-AREA (NDB-BLK-IDX)    17850004
           ELSE                                                         17860004
           IF WS-PCB-SEG-NAME  = 'NDBPINC '                             17870004
              MOVE WS-IO-GN-AREA   TO  NDBPINC-IO-AREA (NDB-INC-IDX).   17880004
                                                                        17890004
       05100-EXIT.                                                      17900004
            EXIT.                                                       17910004
                                                                        17920004
       06000-PROCESS-ALL-SD.                                            17930004
           INITIALIZE       NDBPRHXS-IO-AREA.                           17940004
           INITIALIZE       WORK-AREAS.                                 17950004
                                                                        17960004
           PERFORM 01120-PROCESS-MAIN-ROOT       THRU 01120-EXIT.       17970007
           IF NDBPRHXS-STATUS-CODE     =  '1'  OR  '5'                  17980004
              GO TO 06000-EXIT.                                         17990004
                                                                        18000004
           IF NDBPRHC-SSPND-DENY-IND = 'Y'                              18010004
              INITIALIZE  PCB-MASK                                      18020004
              MOVE 'F' TO NDBPRHSS-COMM                                 18030004
              MOVE ' ' TO NDBPRHSS-L-PAR                                18040004
              MOVE GU  TO WS-FUNC                                       18050004
              PERFORM 01200-PROCESS-SUSP-DENY  THRU 01200-EXIT          18060004
                      VARYING NDB-SD-IDX FROM +1 BY +1 UNTIL            18070004
                      SEGMENT-NOT-FOUND-FOR-GN  OR                      18080004
                      NDB-SD-IDX > +5                                   18090004
              IF NDBPRHXS-STATUS-CODE     =  '1'  OR  '5'               18100004
                 GO TO 06000-EXIT.                                      18110004
                                                                        18120004
                                                                        18130004
       06000-EXIT.                                                      18140004
            EXIT.                                                       18150004
                                                                        18160004
       07100-CALL-TABLE-NDBPRODT.                                       18170004
           MOVE '07100'                    TO WS-ABEND-PARA.            18180004
           MOVE TBL-PROD-CD-TBL-NAME       TO TABLEBASE-TABLE-NAME.     18190004
           MOVE FETCH-MATCHING-KEY         TO TABLEBASE-COMMAND-ID.     18200004
           MOVE WS-HOLD-SEND-PRODUCT-VARN  TO NDBXXXXT-TBL-CODE-KEY.    18210004
                                                                        18220004
           PERFORM 07900-TBLBASE-CALL      THRU 07900-EXIT.             18230004
                                                                        18240004
       07100-EXIT.                                                      18250004
           EXIT.                                                        18260004
         SKIP3                                                          18270004
       07200-CALL-TABLE-NDBSUSPT.                                       18280004
           MOVE '07200'                    TO WS-ABEND-PARA.            18290004
                                                                        18300004
           MOVE TBL-SUSP-DENY-TBL-NAME     TO TABLEBASE-TABLE-NAME.     18310004
           MOVE FETCH-MATCHING-KEY         TO TABLEBASE-COMMAND-ID.     18320004
           MOVE NDBPRHS-ERR-EOB-SD-CDE (NDB-SD-IDX)                     18330004
                                           TO NDBXXXXT-TBL-CODE-KEY.    18340004
                                                                        18350004
           PERFORM 07900-TBLBASE-CALL  THRU 07900-EXIT.                 18360004
                                                                        18370004
           IF TABLEBASE-CALL-OK AND TABLE-FOUND                         18380004
                MOVE SUSPEND-DN-TBL-IO-AREA         TO                  18390004
                NDBPRHS-SUSP-DATA (NDB-SD-IDX)                          18400004
           ELSE                                                         18410004
               MOVE '5'  TO NDBPRHXS-STATUS-CODE.                       18420004
                                                                        18430004
       07200-EXIT.                                                      18440004
           EXIT.                                                        18450004
         SKIP3                                                          18460004
       07900-TBLBASE-CALL.                                              18470004
           MOVE '07900'                TO WS-ABEND-PARA.                18480004
                                                                        18490004
NK0021     COPY NDBTBWOP.                                               18500004
                                                                        18510004
                                                                        18520004
       07900-EXIT.                                                      18530004
           EXIT.                                                        18540004
                                                                        18550004
       08000-CALL-MAIN-ROOT.                                            18560004
           CALL 'CBLTDLI' USING WS-FUNC                                 18570004
                                NDBPRHDB-PCB                            18580004
                                WS-IO-ROOT                              18590004
                                NDBPRHC-SSA-Q.                          18600004
                                                                        18610004
           MOVE NDBPRHDB-PCB    TO PCB-MASK.                            18620004
       08000-EXIT.                                                      18630004
           EXIT.                                                        18640004
                                                                        18650004
       08100-CALL-IMS.                                                  18660004
           CALL 'CBLTDLI' USING WS-FUNC                                 18670004
                                NDBPRHDB-PCB                            18680004
                                WS-IO-SUSP                              18690004
                                NDBPRHC-SSA-Q                           18700004
                                NDBPRHS-SSA-Q.                          18710004
                                                                        18720004
           MOVE NDBPRHDB-PCB    TO PCB-MASK.                            18730004
       08100-EXIT.                                                      18740004
           EXIT.                                                        18750004
                                                                        18760004
       08200-CALL-PRICING-ROOT.                                         18770004
           CALL 'CBLTDLI' USING WS-FUNC                                 18780004
                                NDBPRCDB-PCB                            18790004
                                WS-IO-PRICE                             18800004
                                NDBPRCC-SSA                             18810004
                                NDBPPRI-SSA-B.                          18820004
                                                                        18830004
           MOVE NDBPRCDB-PCB    TO PCB-MASK.                            18840004

FC0068     IF WS-IO-FAC-UNIT-VAL NOT NUMERIC
FC0068        MOVE 0            TO WS-IO-FAC-UNIT-VAL
FC0068     END-IF.

       08200-EXIT.                                                      18850004
           EXIT.                                                        18860004
                                                                        18870004
       08300-CALL-IMS.                                                  18880004
           CALL 'CBLTDLI' USING WS-FUNC                                 18890004
                                NDBPRHDB-PCB                            18900004
                                WS-IO-BLOCK                             18910004
                                NDBPRHC-SSA-Q                           18920004
                                NDBPBLK-SSA.                            18930004
                                                                        18940004
           MOVE NDBPRHDB-PCB    TO PCB-MASK.                            18950004
       08300-EXIT.                                                      18960004
           EXIT.                                                        18970004
                                                                        18980004
       08400-CALL-IMS.                                                  18990004
           CALL 'CBLTDLI' USING WS-FUNC                                 19000004
                                NDBPRHDB-PCB                            19010004
                                WS-IO-INCID                             19020004
                                NDBPRHC-SSA-Q                           19030004
                                NDBPINC-SSA.                            19040004
                                                                        19050004
           MOVE NDBPRHDB-PCB    TO PCB-MASK.                            19060004
       08400-EXIT.                                                      19070004
           EXIT.                                                        19080004
       08500-CALL-IMS.                                                  19090004
           CALL 'CBLTDLI' USING WS-FUNC                                 19100004
                                NDBPRHDB-PCB                            19110004
                                WS-IO-GN-AREA.                          19120004
                                                                        19130004
           MOVE NDBPRHDB-PCB    TO PCB-MASK.                            19140004
       08500-EXIT.                                                      19150004
           EXIT.                                                        19160004
                                                                        19170004
       09000-UPDATE-CALL-IMS.                                           19180004
           CALL 'CBLTDLI' USING WS-PARM-COUNT                           19190004
                                WS-FUNC                                 19200004
                                NDBPRHDB-PCB                            19210004
                                WS-DB-IO-AREA                           19220004
                                NDBPRHC-SSA-Q                           19230004
                                WS-DB-SSA-1                             19240004
                                WS-DB-SSA-2.                            19250004
                                                                        19260004
           MOVE NDBPRHDB-PCB    TO PCB-MASK.                            19270004
       09000-EXIT.                                                      19280004
           EXIT.                                                        19290004
                                                                        19300004
       10000-UPDATE-CALL-PRIC-ROOT.                                     19310004
           CALL 'CBLTDLI' USING WS-PARM-COUNT                           19320004
                                WS-FUNC                                 19330004
                                NDBPRCDB-PCB                            19340004
                                WS-DB-IO-AREA                           19350004
                                NDBPRCC-SSA                             19360004
                                                                        19370004
           MOVE NDBPRCDB-PCB    TO PCB-MASK.                            19380004
       10000-EXIT.                                                      19390004
           EXIT.                                                        19400004
       10500-UPD-CALL-ALL-PRIC-ROOT.                                    19410010
           CALL 'CBLTDLI' USING WS-PARM-COUNT                           19420008
                                WS-FUNC                                 19430008
                                NDBPRCDB-PCB                            19440008
                                WS-DB-IO-AREA                           19450008
                                NDBPRCC-SSA-B                           19460008
                                                                        19470008
           MOVE NDBPRCDB-PCB    TO PCB-MASK.                            19480008
       10500-EXIT.                                                      19490008
           EXIT.                                                        19500008
                                                                        19510004
       11000-UPDATE-CALL-PRIC-UNIT.                                     19520004
           CALL 'CBLTDLI' USING WS-PARM-COUNT                           19530004
                                WS-FUNC                                 19540004
                                NDBPRCDB-PCB                            19550004
                                WS-DB-IO-AREA                           19560004
                                NDBPRCC-SSA                             19570004
                                WS-DB-SSA-1.                            19580004
                                                                        19590004
           MOVE NDBPRCDB-PCB    TO PCB-MASK.                            19600004
       11000-EXIT.                                                      19610005
           EXIT.                                                        19620004
                                                                        19630004
       12000-ISRT-CALL-PRIC-ROOT.                                       19640012
           CALL 'CBLTDLI' USING ISRT                                    19650012
                                NDBPRCDB-PCB                            19660012
                                NDBPRCC-IO-AREA                         19670012
                                NDBPRCC-SSA-U.                          19680012
                                                                        19690012
           MOVE NDBPRCDB-PCB    TO PCB-MASK.                            19700012
       12000-EXIT.                                                      19710012
           EXIT.                                                        19720012
                                                                        19730012
       50000-GET-DB2-HCPCS-DATA.                                        02510000
           MOVE '50000'                   TO WS-ABEND-PARA.             02520000
                                                                        02530000
           PERFORM 50030-CHECK-SEND-DATA                                02570000
           PERFORM 50040-CONVERT-NDB-TO-MPR                             02580000
           PERFORM 50050-CALL-MPRHPXS                                   02580000
           IF MPRHPXS-OK                                                02580000
              PERFORM 50060-CONVERT-MPR-BCK-TO-NDB                      02580000
           ELSE                                                         02580000
              MOVE MPRHPXS-STATUS-CODE TO NDBPRHXS-STATUS-CODE          02580000
           END-IF                                                       02580000
           .                                                            02690000
                                                                        02700000
       50030-CHECK-SEND-DATA.                                           02710000
           MOVE '50030'                TO WS-ABEND-PARA.                02720000
                                                                        02730000
           IF NDBPRHXS-SEND-SVC-FROM-DTE NOT NUMERIC                    02760000
              OR                                                        02770000
              NDBPRHXS-SEND-SVC-FROM-DTE = ZEROES                       02780000
              MOVE WS-CURR-DATE    TO NDBPRHXS-SEND-SVC-FROM-DTE        02790000
           END-IF.                                                      02800000
                                                                        02810000
           IF NDBPRHXS-SEND-SVC-THRU-DTE NOT NUMERIC                    02820000
              OR                                                        02830000
              NDBPRHXS-SEND-SVC-THRU-DTE = ZEROES                       02840000
              MOVE WS-CURR-DATE    TO NDBPRHXS-SEND-SVC-THRU-DTE        02850000
           ELSE                                                         02860000
              IF NDBPRHXS-SEND-SVC-THRU-DTE = 999999999                 02820000
                 MOVE NDBPRHXS-SEND-SVC-FROM-DTE                        02780000
                                   TO NDBPRHXS-SEND-SVC-THRU-DTE        02850000
              END-IF                                                    02860000
           END-IF.                                                      02860000
                                                                        02870000
                                                                        02880000
       50040-CONVERT-NDB-TO-MPR.                                        02970000
           MOVE '50040'                TO WS-ABEND-PARA.                02720000
                                                                        03130000
           INITIALIZE MPRHPXS-STATUS-CODE
NK0408**              MPRHPXS-EXCEPTION-KEYS
                      MPRHPXS-KEY-VALUES
                      MPRHPXS-EXCEPTION-IND
                                                                        00908000
NK1186***  MOVE 'NDBPRHXS' TO MPRHPXS-CALLING-PGM
NK1186     MOVE NDBPRHXS-CALLING-PGM TO MPRHPXS-CALLING-PGM
           MOVE 'UNIC'     TO MPRHPXS-COMPANY
           MOVE NDBPRHXS-FUNCTION TO MPRHPXS-FUNCTION
           MOVE NDBPRHXS-SEND-PROC-CDE     TO                           02740000
                MPRHPXS-SEND-PROC-CDE                                   02740000
           MOVE NDBPRHXS-SEND-SVC-FROM-DTE TO                           02840000
                MPRHPXS-SEND-SVC-FROM-DTE                               02840000
           MOVE NDBPRHXS-SEND-SVC-THRU-DTE TO                           02840000
                MPRHPXS-SEND-SVC-THRU-DTE                               02840000
           .                                                            02880000
                                                                        02880000
       50050-CALL-MPRHPXS.                                              02970000
           MOVE '50050'                TO WS-ABEND-PARA.                02720000
                                                                        03130000
           COPY MPRHPXP.                                                00908000
                                                                        00908000
           .                                                            02880000
                                                                        02880000
       50060-CONVERT-MPR-BCK-TO-NDB.                                    02970000
           MOVE '50060'                TO WS-ABEND-PARA.                02720000
                                                                        03130000
           INITIALIZE NDBPRHXS-IO-AREA                                  00908000
                                                                        03130000
           MOVE MPRHPXC-HCPCS-CDE        TO NDBPRHC-HCPCS-CDE           00908000
           MOVE MPRHPXC-DESC-LONG        TO NDBPRHC-DESC-LONG           00920000
           MOVE MPRHPXC-FOL-DAYS         TO NDBPRHC-FOL-DAYS            00910000
           MOVE MPRHPXC-AGE-FROM         TO NDBPRHC-AGE-FROM            00940000
           MOVE MPRHPXC-AGE-THRU         TO NDBPRHC-AGE-THRU            00940000
           MOVE MPRHPXC-SEX-CDE          TO NDBPRHC-SEX-CDE             00940000
           MOVE MPRHPXC-64-BA-UNITS      TO NDBPRHC-64-UNITS            01050000
           MOVE MPRHPXC-64-UNITS         TO NDBPRHC-64-BA-UNITS         01060000
           MOVE MPRHPXC-INCDNTL-IND      TO NDBPRHC-INCDNTL-IND         01070000
           MOVE MPRHPXC-SSPND-DENY-IND   TO NDBPRHC-SSPND-DENY-IND      01080000
           MOVE MPRHPXC-BLOCK-CDE        TO NDBPRHC-BLOCK-CDE           00970000
           MOVE MPRHPXC-ANES-ALLOW-CDE   TO NDBPRHC-ANES-ALLOW-CDE      00980000
           MOVE MPRHPXC-ASSIST-SRG-ALLOW-CDE                            00980000
                                         TO NDBPRHC-ASSIST-SRG-ALLOW-CDE00980000
           MOVE MPRHPXC-EFF-DTE          TO NDBPRHC-EFF-DTE             00980000
           MOVE MPRHPXC-END-DTE          TO NDBPRHC-END-DTE             00980000
           MOVE MPRHPXC-LAST-UPDT-DTE    TO NDBPRHC-LAST-UPDT-DTE       00980000
           MOVE MPRHPXC-LAST-USERID      TO NDBPRHC-LAST-USERID         00980000
           MOVE MPRHPXC-UM-APRVL-IND     TO NDBPRHC-UM-APRVL-IND        00980000
           MOVE MPRHPXC-COPAY-IND        TO NDBPRHC-COPAY-IND           00980000
           MOVE MPRHPXC-100-IND          TO NDBPRHC-100-IND             00980000
           MOVE MPRHPXC-AS-IS-IND        TO NDBPRHC-UNICARE-AS-IS-IND   00980000
FC0146     MOVE MPRHPXC-ASIS-EFF-DTE     TO NDBPRHC-UNI-AS-IS-EFF-DTE   00980000
FC0146     MOVE MPRHPXC-ASIS-END-DTE     TO NDBPRHC-UNI-AS-IS-END-DTE   00980000
           MOVE ' '                      TO NDBPRHC-CCN-AS-IS-IND       00980000
           MOVE MPRHPXC-AMBULANCE-IND    TO NDBPRHC-AMBU-IND            00970000
           MOVE MPRHPXC-HIPAA-COMP-IND   TO NDBPRHC-HIPAA-COMP-IND      01060000
FC0043     MOVE MPRHPXC-COSURG-IND       TO NDBPRHC-COSURG-IND
                                                                        00970000
           MOVE 1 TO SUB                                                00970000
           PERFORM UNTIL SUB = 3                                        00970000
             MOVE MPRHPXC-SVC-CLS-CDE (SUB) TO                          00980000
                                            NDBPRHC-SVC-CLS-CDE (SUB)   00980000
             ADD 1 TO SUB                                               00980000
           END-PERFORM                                                  00970000
                                                                        00970000
           MOVE 1 TO SUB                                                00970000
           PERFORM UNTIL SUB = 6                                        00970000
             MOVE MPRHPXC-PRC-CLS-CDE (SUB) TO                          00980000
                                            NDBPRHC-PRC-CLS-CDE (SUB)   00980000
             ADD 1 TO SUB                                               00980000
           END-PERFORM                                                  00970000
                                                                        00970000
           MOVE 1 TO SUB                                                00970000
           PERFORM UNTIL SUB = 8                                        00970000
               MOVE MPRHPXC-PLC-TRTMT-CDE (SUB) (1:1) TO                01000000
                                          NDBPRHC-PLC-TRTMT-CDE (SUB)   01000000
             ADD 1 TO SUB                                               00980000
           END-PERFORM                                                  00970000
                                                                        00970000
           MOVE 1 TO SUB                                                00970000
           PERFORM UNTIL SUB = 6                                        00970000
               MOVE MPRHPXC-TYPE-TRTMT-CDE (SUB) (1:2) TO               01020000
                                           NDBPRHC-TYPE-TRTMT-CDE (SUB) 01020000
               ADD 1 TO SUB                                             00980000
           END-PERFORM                                                  00970000
NS0788     MOVE MPRHPXC-POS-INCL-EXCL-IND
  |                                  TO  NDBPRHC-POS-EXC-INC-IND
  V        MOVE MPRHPXC-TOT-INCL-EXCL-IND
NS0788                               TO  NDBPRHC-TOT-EXC-INC-IND
                                                                        00970000
           MOVE MPRHPXC-PRHS-CNTR TO NDB-PRHS-CNTR
           PERFORM VARYING SUB FROM 1 BY 1
                               UNTIL SUB > NDB-PRHS-CNTR
              MOVE MPRHPXC-PRHS-IO-AREA (SUB)
                TO NDBPRHS-IO-AREA (SUB)
           END-PERFORM
                                                                        00970000
           MOVE MPRHPXC-BLK-CNTR TO NDB-BLK-CNTR
           PERFORM VARYING SUB FROM 1 BY 1
                               UNTIL SUB > NDB-BLK-CNTR
              MOVE MPRHPXC-PBLK-PRCDR-CDE        (SUB)
                TO NDBPBLK-PRCDR-CDE             (SUB)
              MOVE MPRHPXC-PBLK-PARNT-CHILD-IND  (SUB)
                TO NDBPBLK-PARNT-CHILD-IND       (SUB)
              MOVE MPRHPXC-PBLK-REPETITION-REDUC (SUB)
                TO NDBPBLK-REPETITION-REDUC      (SUB)
              MOVE MPRHPXC-PBLK-REPETITION-COUNT (SUB)
                TO NDBPBLK-REPETITION-COUNT      (SUB)
              MOVE MPRHPXC-PBLK-PARNT-PRCDR-CDE  (SUB)
                TO NDBPBLK-PARNT-PRCDR-CDE       (SUB)
NK0068        MOVE MPRHPXC-LAST-UPDT-DTE                                00980000
NK0068          TO  NDBPBLK-LAST-UPDT-DTE        (SUB)
           END-PERFORM
           .                                                            00970000
           MOVE MPRHPXC-INC-CNTR TO NDB-INC-CNTR
           PERFORM VARYING SUB FROM 1 BY 1
                               UNTIL SUB > NDB-INC-CNTR
              MOVE MPRHPXC-INCDNTL-PRCDR-FROM (SUB)
                TO NDBPINC-INCDNTL-PRCDR-FROM (SUB)
              MOVE MPRHPXC-INCDNTL-PRCDR-THRU (SUB)
                TO NDBPINC-INCDNTL-PRCDR-THRU (SUB)
           END-PERFORM
           .                                                            00970000
           MOVE MPRHPXC-PRHS-CNTR TO NDB-PRHS-CNTR                      00078091
           SET MPRHPXC-SD-IDX TO 1                                      00078092
           SET NDB-SD-IDX TO 1                                          00078093
           PERFORM NDB-PRHS-CNTR TIMES                                  00078094
               INITIALIZE NDBPRHS-ERR-EOB-KEY-MBU(NDB-SD-IDX)
                          NDBPRHS-ERR-EOB-KEY-PRDT-CD(NDB-SD-IDX)
                          NDBPRHS-ERR-EOB-KEY-PRDT-VN(NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-KEY (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-KEY-DTE  (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-SD-CDE (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-SD-CDE   (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-EFF-DTE (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-EFF-DTE (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-END-DTE (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-END-DTE (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-DLR-LMT (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-DLR-LMT (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-CDE (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-CDE      (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-MSG-CDE (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-MSG-CDE (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-ERR-EOB-TEXT (MPRHPXC-SD-IDX)
                 TO NDBPRHS-ERR-EOB-TEXT     (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-LAST-UPDT-DTE (MPRHPXC-SD-IDX)
                 TO NDBPRHS-LAST-UPDT-DTE    (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-LAST-USERID (MPRHPXC-SD-IDX)
                 TO NDBPRHS-LAST-USERID      (NDB-SD-IDX)
               MOVE MPRHPXC-PRHS-SUSP-DATA   (MPRHPXC-SD-IDX)
                 TO NDBPRHS-SUSP-DATA        (NDB-SD-IDX)
NK1622         MOVE MPRHPXC-PRHS-LCD-NCD-IND (MPRHPXC-SD-IDX)
  |              TO NDBPRHS-LCD-NCD-IND      (NDB-SD-IDX)
  |            MOVE MPRHPXC-PRHS-THRESHOLD-IND (MPRHPXC-SD-IDX)
NK1622           TO NDBPRHS-THRESHOLD-IND      (NDB-SD-IDX)
TEMP           DISPLAY' NDBPRHS - THRESH = '
TEMP                NDBPRHS-THRESHOLD-IND      (NDB-SD-IDX)
               SET MPRHPXC-SD-IDX UP BY 1                               00980000
               SET NDB-SD-IDX  UP BY 1                                  00980000
           END-PERFORM                                                  00078099
           .                                                            00078100
                                                                        00078101


