*     ***************************************************************   00001000
*     *                                                             *   00001001
*     *                           NOTICE                            *   00001002
*     *                                                             *   00001003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00001004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00001005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00001006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00001007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00001008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00001009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00001010
*     *                                                             *   00001011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00001012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00001013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00001014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00001015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00001016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00001017
*     *                                                             *   00001018
*     ***************************************************************   00001019
*     *     Infopoint Relationship CIF                              *   00001020
*     *     RF 2.1.06                                               *   00001021
*     ***************************************************************   00001022
A042     TITLE 'RFA042 - ADDRESS LINE DETAIL FORMATTER MODULE'          00001290
RFA042   START 0                                                        00002000
RFA042   AMODE ANY                                                      00003000
RFA042   RMODE ANY                                                      00004000
         SPACE 2                                                        00013000
*---------------------------------------------------------------------* 00014000
*                                                                     * 00015000
*     RFA042 - ADDRESS LINE DETAIL FORMATTER MODULE                   * 00016000
*                                                                     * 00017000
*     THIS ROUTINE ACCEPTS A 40 POSITION LINE OF ADDR DATA FROM THE   * 00018000
*     CALLING PROGRAM AND PARSES THE LINE INTO WORDS, FLAGGING WORDS  * 00019000
*     AS TO THEIR TYPES, AND REBUILDING THE ADDRESS LINE.             * 00020000
*                                                                     * 00021000
*     PARM 1          CL40         ADDR LINE TO BE PARSED / REBUILT.  * 00022000
*                                                                     * 00023000
*     PARM 2          CL250        WORDS PASSED BACK TO THE           * 00024000
*                                      PROGRAM.  CONTAINS TEN 25      * 00025000
*                                      POSITION FIELDS.  WITHIN       * 00026000
*                                      THESE FIELDS, THE FOLLOWING    * 00027000
*                                      DATA OCCURS:                   * 00028000
*                                                                     * 00029000
*                                      POS 1-2   WORD TYPE INDICATOR  * 00030000
*                                                (SEE FOLLOWING PAGE) * 00031000
*                                      POS 3-22  ADDRESS WORD         * 00032000
*                                      POS 23-25 FILLER               * 00033000
*                                                                     * 00034000
*     PARM 3          CL10         RETURN CODES.                      * 00035000
*                                      BLANK = NO ERRORS.             * 00036000
*                     POS 1            'A' = INPUT ADDR LINE IS BLANK * 00037000
*                     POS 2            'B' = MORE THAN 10 ADDR WORDS  * 00038000
*                     POS 3            'C' = WORD LONGER THAN 20 POS  * 00039000
*                     POS 4            RESERVED FOR FUTURE USE.       * 00040000
*                     POS 5            RESERVED FOR FUTURE USE.       * 00041000
*                     POS 6            RESERVED FOR FUTURE USE.       * 00042000
*                     POS 7            RESERVED FOR FUTURE USE.       * 00043000
*                     POS 8            RESERVED FOR FUTURE USE.       * 00044000
*                     POS 9            RESERVED FOR FUTURE USE.       * 00045000
*                     POS 10           RESERVED FOR FUTURE USE.       * 00046000
*                                                                     * 00047000
*     PARM 4          CL750        WORKING STORAGE AREA.              * 00048000
*                                                                     * 00049000
*---------------------------------------------------------------------* 00050000
         EJECT                                                          00051000
*---------------------------------------------------------------------* 00052000
*                                                                     * 00053000
*     RFA042 - ADDRESS LINE DETAIL FORMATTER MODULE                   * 00054000
*                                                                     * 00055000
*     WORD TYPE INDICATOR.                                            * 00056000
*                                                                     * 00057000
*     THE WORD TYPE INDICATOR MAY CONTAIN ONE OF THE FOLLOWING        * 00058000
*     VALUES:                                                         * 00059000
*                                                                     * 00060000
*                                                                     * 00061000
*     CODE    MEANING              EXAMPLES                           * 00062000
*     ----    -----------------    ------------------------------     * 00063000
*                                                                     * 00064000
*     BL      BUILDING             BLDG, APTS, STA                    * 00065000
*                                                                     * 00066000
*     BX      BOX                  BOX, DRAWER, PO                    * 00067000
*                                                                     * 00068000
*     DI      DIRECTIONAL          N, S, E, W, NE, NW, SE, SW         * 00069000
*                                                                     * 00070000
*     MI      MAILING INFO         C/O, ATTN (ENTIRE LINE)            * 00071000
*                                                                     * 00072000
*     NB      BUILDING NUMBER                                         * 00073000
*                                                                     * 00074000
*     NX      BOX NUMBER                                              * 00075000
*                                                                     * 00076000
*     ND      DIRECTIONAL NMBR     1345 N 1232 E                      * 00077000
*                                                                     * 00078000
*     NH      HOUSE NUMBER                                            * 00079000
*                                                                     * 00080000
*     NR      ROUTE NUMBER                                            * 00081000
*                                                                     * 00082000
*     NU      UNIT NUMBER                                             * 00083000
*                                                                     * 00084000
*     RR      RURAL ROUTE          RR, ROUTE, RTE, RFD, RD, HC        * 00085000
*                                                                     * 00086000
*     SN      STREET NAME                                             * 00087000
*                                                                     * 00088000
*     TH      THROUGHFARE          ST, DR, RD, AVE                    * 00089000
*                                                                     * 00090000
*     UN      UNIT                 APT, LOT, ROOM, SUITE              * 00091000
*                                                                     * 00092000
*                                                                     * 00093000
*---------------------------------------------------------------------* 00094000
         EJECT                                                          00095000
*---------------------------------------------------------------------* 00096000
* ***    REGISTER EQUATES                                             * 00097000
*---------------------------------------------------------------------* 00098000
         SPACE 2                                                        00099000
R0       EQU   0                                                        00100000
R1       EQU   1                       PARAMETER LIST                   00101000
R2       EQU   2                       WORKING STORAGE BASE             00102000
R3       EQU   3                                                        00103000
R4       EQU   4                                                        00104000
R5       EQU   5                                                        00105000
R6       EQU   6                                                        00106000
R7       EQU   7                                                        00107000
R8       EQU   8                                                        00108000
R9       EQU   9                                                        00109000
R10      EQU   10                      BASE REGISTER 1                  00110000
R11      EQU   11                      BASE REGISTER 2                  00111000
R12      EQU   12                      BASE REGISTER 3                  00112000
R13      EQU   13                      CALL AREA SAVE ADDRESS           00113000
R14      EQU   14                      RETURN REGISTER                  00114000
R15      EQU   15                                                       00115000
         EJECT                                                          00116000
*---------------------------------------------------------------------* 00117000
* *** HOUSEKEEPING - ESTABLISH BASE REGISTERS                         * 00118000
*---------------------------------------------------------------------* 00119000
         SPACE 1                                                        00120000
         STM   R14,R12,12(R13)         SAVE CALLERS REGISTERS           00121000
         SPACE 1                                                        00122000
CSTART   BALR  R10,0                                                    00123000
         USING CHERE,R10,R11           USING BASE REGISTERS             00124000
         SPACE 1                                                        00125000
CHERE    L     R11,BASE                LOAD BASE REGISTERS              00126000
         B     CBEGIN                                                   00127000
         SPACE 1                                                        00128000
         DC    C'RFA042.BEGIN'         PROGRAM INFORMATION              00129000
         SPACE 1                                                        00130000
BASE     DC    A(CHERE+4096)           BASE REGISTER ADDRESS            00131000
         SPACE 3                                                        00132000
*---------------------------------------------------------------------* 00133000
* *** HOUSEKEEPING - LOAD UP PARAMETER, MOVE TO WORK AREA.            * 00134000
*---------------------------------------------------------------------* 00135000
         SPACE 1                                                        00136000
CBEGIN   DS    0H                                                       00137000
         L     R2,12(R1)               LOAD ADDRESS OF WORKING STORAGE  00138000
         USING WORKSTRG,R2             USING REGISTER 2 FOR W-S         00139000
         MVC   ERR$FLAG,BLANKS         INITIALIZE W-S FIELD ERR$FLAG    00140000
         MVC   STFOUND,BLANKS          INITIALIZE W-S FIELD STFOUND     00141000
         MVC   THFOUND,BLANKS          INITIALIZE W-S FIELD THFOUND     00141500
         MVC   FIRSTWRD,BLANKS         INITIALIZE W-S FIELD FIRSTWRD    00141700
         MVC   DEFAULT,BLANKS          INITIALIZE W-S FIELD DEFAULT     00142000
         MVC   WORDWRKB,BLANKS         INITIALIZE W-S FIELD WORDWRKB    00143000
         MVC   WORDWORK,BLANKS         INITIALIZE W-S FIELD WORDWORK    00144000
         MVC   WORDWRKE,BLANKS         INITIALIZE W-S FIELD WORDWRKE    00145000
         MVC   NEW$ADDR,BLANKS         INITIALIZE W-S FIELD NEW$ADDR    00146000
         MVC   NEW$ADRE,BLANKS         INITIALIZE W-S FIELD NEW$ADRE    00147000
         SPACE 1                                                        00148000
         L     R3,8(R1)                LOAD ADDRESS OF RETURN CODE      00149000
         MVC   0(10,R3),BLANKS         CLEAR OUT RETURN CODE            00150000
         L     R3,0(R1)                LOAD ADDRESS OF ADDR LINE        00151000
         L     R4,4(R1)                LOAD ADDRESS OF WORDS AREA       00152000
         MVI   0(R4),BLANK             MOVE BLANKS TO WORD              00153000
         MVC   1(249,R4),0(R4)             RETURN AREA                  00154000
         CLC   0(40,R3),BLANKS         Q. IS DATA SENT BLANK?           00155000
         BE    CBEG$800                A. YES, RETURN WITH ERROR FLAG   00156000
         LA    R5,40(R3)               A. NO, POST END OF NAME AREA     00157000
         LA    R6,250(R4)              POST END OF WORD WORK AREA       00158000
         SPACE 1                                                        00159000
         B     PASS$000                GO PASS DATA AREA FOR WORDS      00160000
         SPACE 1                                                        00161000
CBEG$800 DS    0H                                                       00162000
         MVI   ERR$FLGA,C'A'           FLAG THIS LINE AS NO WORDS ERROR 00163000
         B     RETN$900                GO RETURN TO CALLING PROGRAM     00164000
         EJECT                                                          00165000
*---------------------------------------------------------------------* 00166000
* *** PASS DATA AREA, MOVING EACH WORD TO A WORK AREA.                * 00167000
*---------------------------------------------------------------------* 00168000
         SPACE 1                                                        00169000
PASS$000 DS    0H                                                       00170000
         CR    R3,R5                   Q. AT END OF THE DATA AREA?      00171000
         BNL   SRCH$000                A. YES, GO SEARCH FOR INVLD WDS  00172000
         CLI   0(R3),BLANK             Q. IS THIS A BLANK SPACE?        00173000
         BE    PASS$005                A. YES, GO BUMP TO NEXT POSITION 00174000
         CLI   0(R3),COMMA             Q. IS THIS A COMMA?              00175000
         BE    PASS$005                A. YES, GO BUMP TO NEXT POSITION 00176000
         CLI   0(R3),PERIOD            Q. IS THIS A PERIOD?             00177000
         BE    PASS$005                A. YES, GO BUMP TO NEXT POSITION 00178000
         CLI   0(R3),POUND             Q. IS THIS A POUND SIGN?         00179000
         BE    PASS$008                A. YES, GO TO SPECIAL TESTS      00180000
         CLI   0(R3),X'00'             Q. IS THIS THE BEGIN OF A WORD?  00181000
         BNE   PASS$010                A. YES, GO MOVE WORD TO WORK     00182000
         SPACE 1                                                        00183000
PASS$005 DS    0H                                                       00184000
         LA    R3,1(R3)                A. NO, BUMP UP REG 3             00185000
         B     PASS$000                GO LOOP TILL WORD BEGIN FOUND    00186000
         SPACE 1                                                        00186080
PASS$008 DS    0H                                                       00186160
*---------------------------------------------------------------------* 00186240
* POUND SIGNS ARE A SPECIAL CASE.  WHEN THEY FOLLOW A THOROUGHFARE    * 00186320
* WORD, THE POUND SIGN IS AN ABBREVIATION FOR UNIT AND WILL BE KEPT.  * 00186400
* IT WILL BE DROPPED WHEN IT APPEARS AT THE FRONT OF THE LINE.  FOR   * 00186480
* NOW, POUND SIGNS APPEARING IN OTHER PARTS OF THE LINE WILL BE KEPT  * 00186560
* AND THE WORD DESIGNATED AS A 'UNIT' DESIGNATION.                    * 00186640
*---------------------------------------------------------------------* 00186720
         CLI   FIRSTWRD,BLANK          Q. IS THIS THE FIRST WORD?       00186800
         BE    PASS$005                A. YES, GO BUMP TO NEXT POSITION 00186880
         SPACE 1                                                        00187000
PASS$010 DS    0H                                                       00188000
         CR    R4,R6                   Q. AT END OF WORD WORK AREA?     00189000
         BNL   PASS$800                A. YES, MORE THN 10 WORDS, ERROR 00190000
         LA    R7,22(R4)               A. NO, LOAD ADDRESS OF NEXT AREA 00191000
         LA    R4,2(R4)                POINT AT BEGIN OF DATA AREA      00192000
PASS$015 DS    0H                                                       00192100
         CLI   0(R3),POUND             Q. IS THIS A POUND SIGN?         00192200
         BNE   PASS$020                A. NO, CONTINUE NORMALLY         00192300
         MVC   0(1,R4),0(R3)           A. NO, MOVE WORD POSITION TO WRK 00192400
         LA    R3,1(R3)                BUMP FROM AREA ADDRESS BY 1      00192500
         LA    R4,3(R7)                SET REG 4 AT NEXT WORD WORK AREA 00192600
         B     PASS$000                GO TO CONTINUE WORD SEARCH       00192700
         SPACE 1                                                        00193000
PASS$020 DS    0H                                                       00194000
         CR    R4,R7                   Q. IS THIS WORD TOO LONG?        00195000
         BNL   PASS$810                A. YES, GO FLAG AS AN ERROR      00196000
         MVC   0(1,R4),0(R3)           A. NO, MOVE WORD POSITION TO WRK 00197000
         LA    R3,1(R3)                BUMP FROM AREA ADDRESS BY 1      00198000
         LA    R4,1(R4)                BUMP TO AREA ADDRESS BY 1        00199000
         CLI   0(R3),BLANK             Q. ARE WE AT END OF WORD?        00200000
         BE    PASS$030                A. YES, DONE, GO BUMP REGS       00201000
         CLI   0(R3),X'00'             Q. ARE WE AT END OF WORD?        00202000
         BE    PASS$030                A. YES, DONE, GO BUMP REGS       00203000
         CLI   0(R3),COMMA             Q. ARE WE AT END OF WORD?        00204000
         BE    PASS$030                A. YES, DONE, GO BUMP REGS       00205000
         CLI   0(R3),PERIOD            Q. ARE WE AT END OF WORD?        00206000
         BE    PASS$030                A. YES, DONE, GO BUMP REGS       00207000
         B     PASS$020                A. NO, LOOP TO MOVE NEXT POSTN   00208000
         SPACE 1                                                        00209000
PASS$030 DS    0H                                                       00210000
         MVI   FIRSTWRD,SENTINEL       SET FIRST WORD FOUND             00210500
         LA    R4,3(R7)                SET REG 4 AT NEXT WORD WORK AREA 00211000
         B     PASS$000                GO TO CONTINUE WORD SEARCH       00212000
         SPACE 1                                                        00213000
PASS$800 DS    0H                                                       00214000
         MVI   ERR$FLGB,C'B'           FLAG THIS LINE AS 10 WORDS ERROR 00215000
         B     SRCH$000                GO SEARCH FOR INVALID WORDS      00216000
         SPACE 1                                                        00217000
PASS$810 DS    0H                                                       00218000
         MVI   ERR$FLGC,C'C'           FLAG THIS LINE AS LONG WORD ERR  00219000
         LA    R4,3(R7)                SET REG 4 AT NEXT WORD WORK AREA 00220000
         SPACE 1                                                        00221000
PASS$815 DS    0H                                                       00222000
         CR    R3,R5                   Q. AT END OF THE DATA AREA?      00223000
         BNL   SRCH$000                A. YES, GO SEARCH FOR INVLD WDS  00224000
         CLI   0(R3),BLANK             Q. IS THIS A BLANK SPACE?        00225000
         BE    PASS$000                A. YES, GO CONTINUE WORD SEARCH  00226000
         CLI   0(R3),X'00'             Q. IS THIS A NULL CHARACTER?     00227000
         BE    PASS$000                A. YES, GO CONTINUE WORD SEARCH  00228000
         LA    R3,1(R3)                A. NO, BUMP UP FROM ADDRESS      00229000
         B     PASS$815                GO LOOP TO END OF WORD           00230000
         EJECT                                                          00231000
*---------------------------------------------------------------------* 00232000
* *** SEARCH WORD WORK AREA, ASSGN WORD TYPES TO EACH WORD AREA       * 00233000
*---------------------------------------------------------------------* 00234000
         SPACE 1                                                        00235000
SRCH$000 DS    0H                                                       00236000
         L     R4,4(R1)                RESET WORDS WORK AREA ADDRESS    00237000
         LA    R7,250(R4)              LOAD ENDING AREA ADDRESS         00238000
         SH    R4,=H'25'               BUMP BACK FOR LOOP AREA          00239000
         LA    R3,WRD$TBLE-42          LOAD ADDRESS OF WORD TABLE       00240000
         MVC   DEFAULT,STREET          SET STREET AS DEFAULT WORD TYPE  00241000
         SPACE 1                                                        00242000
SRCH$001 DS    0H                                                       00243000
         LA    R3,42(R3)               BUMP TO NEXT TABLE ENTRY         00244000
         CLI   00(R3),X'FF'            Q. ARE WE AT END OF TABLE?       00245000
         BE    SRCH$003                A. YES, GO TRY NEXT WORD MATCH   00246000
         CLC   00(02,R3),MAILING       Q. IS THIS A MAILING ENTRY?      00247000
         BNE   SRCH$001                A. NO, LOOP UNTIL MAILING WORD   00248000
         CLC   02(20,R3),27(R4)        Q. IS FIRST WORD MAILING TYPE?   00249000
         BE    SRCH$002                A. YES, SET MAILING AS DEFAULT   00250000
         CLC   22(20,R3),27(R4)        Q. IS FIRST WORD MAILING TYPE?   00251000
         BNE   SRCH$001                A. NO, LOOP UNTIL MAILING WORD   00252000
         SPACE 1                                                        00253000
SRCH$002 DS    0H                                                       00254000
         MVC   DEFAULT,MAILING         SET MAILING INFO AS DEFAULT TYPE 00255000
         SPACE 1                                                        00256000
SRCH$003 DS    0H                                                       00257000
         LA    R4,25(R4)               BUMP TO NEXT DATA ENTRY          00258000
         CR    R4,R7                   Q. ARE WE AT END OF DATA?        00259000
         BNL   SRCH$004                A. YES, GO DO PREFIX SRCH        00260000
         CLC   02(20,R4),BLANKS        Q. ARE WE AT END OF DATA?        00261000
         BE    SRCH$004                A. YES, GO DO PREFIX SRCH        00262000
         MVC   00(02,R4),DEFAULT       A. NO, SET AS DEFAULT TYPE       00263000
         B     SRCH$003                LOOP TO NEXT WORD ENTRY          00264000
         SPACE 1                                                        00265000
SRCH$004 DS    0H                                                       00266000
         L     R4,04(R1)               RESET WORDS WORK AREA ADDR       00267000
         CLI   02(R4),X'F0'            Q. IS THIS HOUSE NUMBER?         00268000
         BL    SRCH$005                A. NO, GO SET FOR SEARCH         00269000
         CLI   02(R4),X'F9'            Q. IS THIS HOUSE NUMBER?         00270000
         BH    SRCH$005                A. NO, GO SET FOR SEARCH         00271000
         MVC   00(02,R4),NUMHSE        A. YES, FLAG AS HOUSE NUMBER     00272000
         B     SRCH$007                GO SEARCH NEXT ENTRY             00273000
         SPACE 1                                                        00274000
SRCH$005 DS    0H                                                       00275000
         SH    R4,=H'25'               DECREMENT REG ADDR FOR LOOP      00276000
         SPACE 1                                                        00277000
*---------------------------------------------------------------------* 00278000
* **  SEARCH TABLE, DETERMINE WORD TYPES.                             * 00279000
*---------------------------------------------------------------------* 00280000
         SPACE 1                                                        00281000
SRCH$007 DS    0H                                                       00282000
         LA    R4,25(R4)               BUMP TO NEXT WORD ENTRY          00283000
         CR    R4,R7                   Q. ARE WE AT END OF WORD WORK?   00284000
         BNL   RESE$000                A. YES, GO RESET ADDRESS WORDS   00285000
         CLC   00(02,R4),BLANKS        Q. ARE WE AT END OF ALL WORDS?   00286000
         BE    RESE$000                A. YES, GO RESET ADDRESS WORDS   00287000
         CLI   02(R4),X'F0'            Q. IS FIRST POSITION NUMERIC?    00288000
         BL    SRCH$009                A. NO, BYPASS DETERMINE TYPE     00289000
         CLI   02(R4),X'F9'            Q. IS FIRST POSITION NUMERIC?    00290000
         BH    SRCH$009                A. NO, BYPASS DETERMINE TYPE     00291000
         LR    R14,R4                  A. YES, POST CURRENT ADDRESS     00292000
         SH    R14,=H'25'              DECREMENT TO PREVIOUS ENTRY      00293000
         SPACE 1                                                        00294000
         MVC   00(02,R4),NUMBOX        A. NO, ASSUME IT IS A BOX NBR    00295000
         CLC   00(02,R14),BOX          Q. IS PREV ENTRY BOX?            00296000
         BE    SRCH$007                A. YES, LOOP TO NEXT ENTRY       00297000
         SPACE 1                                                        00298000
         MVC   00(02,R4),NUMUNT        A. NO, ASSUME IT IS A UNIT NBR   00299000
         CLC   00(02,R14),UNIT         Q. IS PREV ENTRY A UNIT?         00300000
         BE    SRCH$007                A. YES, LOOP TO NEXT ENTRY       00301000
         SPACE 1                                                        00302000
         MVC   00(02,R4),NUMBLD        A. NO, ASSUME IT IS A BLDG NBR   00303000
         CLC   00(02,R14),BUILDING     Q. IS PREV ENTRY A BUILDING?     00304000
         BE    SRCH$007                A. YES, LOOP TO NEXT ENTRY       00305000
         SPACE 1                                                        00306000
         MVC   00(02,R4),NUMRTE        A. NO, ASSUME IT IS A ROUTE NBR  00307000
         CLC   00(02,R14),RR           Q. IS PREV ENTRY A ROUTE?        00308000
         BE    SRCH$007                A. YES, LOOP TO NEXT ENTRY       00309000
         SPACE 1                                                        00310000
         MVC   00(02,R4),NUMUNT        A. NO, ASSUME IT IS A UNIT NBR   00311000
         LA    R15,25(R4)              POST ADDRESS OF NEXT ENTRY       00312000
         CLC   00(02,R14),THFARE       Q. IS PREV ENTRY A THROUGHFARE?  00313000
         BNE   SRCH$008                A. NO, GO RESET AS STREET NAME   00314000
         CR    R15,R7                  Q. ARE WE AT END OF WORD WORK?   00315000
         BNL   SRCH$007                A. YES, LOOP TO NEXT ENTRY       00316000
         CLC   00(02,R15),BLANKS       Q. ARE WE AT END OF WORDS?       00317000
         BE    SRCH$007                A. YES, LOOP TO NEXT ENTRY       00318000
         SPACE 1                                                        00319000
SRCH$008 DS    0H                                                       00320000
         MVC   00(02,R4),DEFAULT       A. NO, RESET AS DEFAULT TYPE     00321000
         SPACE 1                                                        00322000
SRCH$009 DS    0H                                                       00323000
         LA    R3,WRD$TBLE-42          LOAD ADDRESS OF WORD TABLE       00324000
         SPACE 1                                                        00325000
SRCH$010 DS    0H                                                       00326000
         LA    R3,42(R3)               BUMP TO NEXT TABLE ENTRY         00327000
         CLI   00(R3),X'FF'            Q. ARE WE AT END OF TABLE?       00328000
         BE    SRCH$007                A. YES, GO TRY NEXT WORD MATCH   00329000
         CLC   02(20,R4),02(R3)        Q. IS THIS WORD IN TABLE?        00330000
         BE    SRCH$015                A. YES, GO SET TYPE OF WORD      00331000
         CLC   02(20,R4),22(R3)        Q. IS THIS WORD IN TABLE?        00332000
         BE    SRCH$015                A. YES, GO SET TYPE OF WORD      00333000
         B     SRCH$010                A. NO, LOOP TO NEXT ENTRY        00334000
         SPACE 1                                                        00335000
SRCH$015 DS    0H                                                       00336000
         MVC   00(02,R4),00(R3)        SET TYPE OF WORD IN WORK AREA    00337000
         CLC   00(02,R4),THFARE        Q. IS ENTRY A THROUGHFARE?       00337300
         BE    SRCH$016                A. YES, SET THOROUGHFARE FOUND   00337600
         B     SRCH$007                GO TRY TO MATCH NEXT WORD        00338000
SRCH$016 DS    0H                                                       00338200
         MVI   THFOUND,SENTINEL        SET THOROUGHFARE FOUND           00338400
         B     SRCH$007                GO TRY TO MATCH NEXT WORD        00338600
         EJECT                                                          00339000
*---------------------------------------------------------------------* 00340000
* **  RESET ADDRESS WORDS TO TYPES DEPENDING ON OTHER TYPES.          * 00341000
*---------------------------------------------------------------------* 00342000
         SPACE 1                                                        00343000
RESE$000 DS    0H                                                       00344000
         L     R4,04(R1)               RESET WORDS WORK AREA ADDRESS    00345000
         MVC   WORDWORK,00(R4)         MOVE WORD WORK AREA TO PROGRAM   00346000
         MVC   WORDWRKE,BLANKS         POST BLANKS TO END OF AREA       00347000
         L     R12,=F'0'               CLEAR OUT DUAL DIRECTIONAL ADDR  00348000
         LA    R4,WORDWORK             RESET WORDS WORK AREA ADDRESS    00349000
         SH    R4,=H'25'               BUMP BACK FOR LOOP AREA          00350000
         MVI   STFOUND,BLANK           INDICATE NO STREET NAME          00351000
         B     RESE$015                GO CHECK FIRST ENTRY             00352000
         SPACE 1                                                        00353000
RESE$010 DS    0H                                                       00354000
         CLC   00(02,R4),STREET        Q. IS THIS A STREET NAME?        00355000
         BNE   RESE$015                A. NO, BUMP TO NEXT ENTRY        00356000
         MVI   STFOUND,SENTINEL        A. YES, INDICATE STREET FOUND    00357000
         SPACE 1                                                        00358000
RESE$015 DS    0H                                                       00359000
         LA    R4,25(R4)               BUMP TO NEXT DATA ENTRY          00360000
         CLC   00(02,R4),BLANKS        Q. ARE WE AT END OF DATA?        00361000
         BE    STRE$000                A. YES, GO DO STREET CHECK       00362000
         SPACE 1                                                        00363000
         CLC   00(02,R4),DIRECT        Q. IS THIS A DIRECTIONAL?        00364000
         BNE   RESE$020                A. NO, GO CHECK NEXT TYPE        00365000
         CLC   25(02,R4),DIRECT        Q. IS THIS A DIRECTIONAL?        00366000
         BNE   RESE$020                A. NO, GO CHECK NEXT TYPE        00367000
         CLI   THFOUND,SENTINEL        Q. WAS A THROUGHFARE FOUND?      00367100
         BE    RESE$016                A. YES, PROCESS AS DOUBLE DIRECT 00367200
         MVC   25(02,R4),STREET        A. NO, TREAT 2ND AS STREET NAME  00367300
         MVI   STFOUND,SENTINEL        INDICATE STREET FOUND            00367400
         B     RESE$020                GO CHECK NEXT TYPE               00367500
RESE$016 DS    0H                                                       00367600
         CLI   STFOUND,SENTINEL        Q. IS THERE A STREET NAME?       00368000
         BE    RESE$017                A. YES, GO STORE OFF ADDRESS     00369000
         CLC   50(02,R4),DIRECT        Q. IS THIS A DIRECTIONAL?        00370000
         BE    RESE$017                A. YES, GO STORE OFF ADDRESS     00371000
         CLC   50(02,R4),STREET        Q. IS THIS A STREET NAME?        00372000
         BE    RESE$017                A. YES, GO STORE OFF ADDRESS     00373000
         MVC   25(02,R4),STREET        A. YES, DEFAULT TO STREET NAME   00374000
         B     RESE$010                GO LOOP TO NEXT ENTRY            00375000
         SPACE 1                                                        00376000
RESE$017 DS    0H                                                       00377000
         LR    R12,R4                  SAVE OFF REGISTER 4 ADDRESS      00378000
         B     RESE$010                LOOP TO CHECK NEXT WORD          00379000
         SPACE 1                                                        00380000
RESE$020 DS    0H                                                       00381000
         CLC   00(02,R4),THFARE        Q. IS THIS A THROUGHFARE?        00382000
         BNE   RESE$030                A. NO, GO CHECK NEXT TYPE        00383000
         CLC   25(02,R4),THFARE        Q. IS THIS A THROUGHFARE?        00384000
         BNE   RESE$030                A. NO, GO CHECK NEXT TYPE        00385000
         MVC   00(02,R4),STREET        A. YES, DEFAULT TO STREET NAME   00386000
         B     RESE$010                GO LOOP TO NEXT ENTRY            00387000
         SPACE 1                                                        00388000
RESE$030 DS    0H                                                       00389000
         CLC   00(02,R4),DIRECT        Q. IS THIS A DIRECTIONAL?        00390000
         BNE   RESE$040                A. NO, GO CHECK NEXT TYPE        00391000
         CLC   25(02,R4),THFARE        Q. IS THIS A THROUGHFARE?        00392000
         BNE   RESE$040                A. NO, GO CHECK NEXT TYPE        00393000
         CLC   50(02,R4),BLANKS        Q. IS THIS END OF DATA?          00394000
         BNE   RESE$040                A. NO, GO CHECK NEXT TYPE        00395000
         MVC   00(02,R4),STREET        A. YES, DEFAULT TO STREET NAME   00396000
         B     RESE$010                GO LOOP TO NEXT ENTRY            00397000
         SPACE 1                                                        00398000
RESE$040 DS    0H                                                       00399000
         B     RESE$010                GO LOOP TO NEXT ENTRY            00400000
         EJECT                                                          00401000
*---------------------------------------------------------------------* 00402000
* **  ASSURE A STREET NAME IS IN ADDRESS LINE, PLUG IF NEEDED         * 00403000
*---------------------------------------------------------------------* 00404000
         SPACE 1                                                        00405000
STRE$000 DS    0H                                                       00406000
         CLI   STFOUND,SENTINEL        Q. WAS A STREET FOUND?           00407000
         BE    REPL$000                A. YES, GO REPLACE ADDR WORDS    00408000
         CLC   WORDWORK(02),MAILING    Q. IS THIS MAILING INFO LINE?    00409000
         BE    REPL$000                A. YES, GO REPLACE ADDR WORDS    00410000
         LA    R4,WORDWORK+250         A. NO, SET AT END OF DATA        00411000
         MVC   WORDWRKE,BLANKS         POST BLANKS TO END OF AREA       00412000
         MVC   WORDWRKB,BLANKS         POST BLANKS TO BEGINNING OF AREA 00413000
         SPACE 1                                                        00414000
STRE$010 DS    0H                                                       00415000
         SH    R4,=H'25'               BUMP BACK FOR LOOP AREA          00416000
         CLC   00(02,R4),BLANKS        Q. AT LAST WORD ENTRY?           00417000
         BE    STRE$010                A. NO, LOOP UNTIL FOUND          00418000
         SPACE 1                                                        00419000
         SH    R4,=H'50'               BUMP BACK 2 WORDS                00420000
         CLC   00(02,R4),BLANKS        Q. ARE THERE 3 WORDS?            00421000
         BNE   STRE$300                A. YES, GO PROCESS 3 OR MORE     00422000
         CLC   25(02,R4),BLANKS        Q. ARE THERE 2 WORDS?            00423000
         BNE   STRE$200                A. YES, GO PROCESS 2 WORDS       00424000
         MVC   50(02,R4),STREET        A. NO, SET AS STREET NAME        00425000
         B     REPL$000                GO REPLACE ADDRESS WORD DATA     00426000
         SPACE 1                                                        00427000
STRE$200 DS    0H                                                       00428000
         LA    R4,25(R4)               SET TO FIRST SIGNIFICANT WORD    00429000
         CLC   00(02,R4),NUMHSE        Q. IS FIRST WORD A HOUSE NUMBER? 00430000
         BNE   STRE$210                A. NO, GO CHECK FURTHER          00431000
         MVC   25(02,R4),STREET        A. YES, SET NEXT WORD AS STREET  00432000
         B     REPL$000                GO REPLACE ADDRESS WORD DATA     00433000
         SPACE 1                                                        00434000
STRE$210 DS    0H                                                       00435000
         B     REPL$000                GO REPLACE ADDRESS WORD DATA     00436000
         SPACE 1                                                        00437000
STRE$300 DS    0H                                                       00438000
         CLC   00(02,R4),NUMHSE        Q. IS FIRST WORD A HOUSE NUMBER? 00439000
         BNE   STRE$310                A. NO, GO CHECK FURTHER          00440000
         MVC   25(02,R4),STREET        A. YES, SET NEXT WORD AS STREET  00441000
         B     REPL$000                GO REPLACE ADDRESS WORD DATA     00442000
         SPACE 1                                                        00443000
STRE$310 DS    0H                                                       00444000
         B     REPL$000                GO REPLACE ADDRESS WORD DATA     00445000
         EJECT                                                          00446000
*---------------------------------------------------------------------* 00447000
* **  REPLACE ADDRESS WORDS BASED ON THEIR TYPES.                     * 00448000
*---------------------------------------------------------------------* 00449000
         SPACE 1                                                        00450000
REPL$000 DS    0H                                                       00451000
         LA    R4,WORDWORK             RESET WORDS WORK AREA ADDRESS    00452000
         SH    R4,=H'25'               BUMP BACK FOR LOOP AREA          00453000
         MVC   WORDWRKE,BLANKS         POST BLANKS TO END OF AREA       00454000
         SPACE 1                                                        00455000
REPL$010 DS    0H                                                       00456000
         LA    R4,25(R4)               BUMP TO NEXT WORD ENTRY          00457000
         CLC   00(02,R4),BLANKS        Q. ARE WE AT END OF ALL WORDS?   00458000
         BE    REBU$000                A. YES, GO REBUILD ADDRESS LINE  00459000
         LA    R3,WRD$TBLE-42          LOAD ADDRESS OF WORD TABLE       00460000
         SPACE 1                                                        00461000
REPL$020 DS    0H                                                       00462000
         LA    R3,42(R3)               BUMP TO NEXT TABLE ENTRY         00463000
         CLI   00(R3),X'FF'            Q. ARE WE AT END OF TABLE?       00464000
         BE    REPL$010                A. YES, GO TRY NEXT WORD MATCH   00465000
         CLC   00(22,R4),00(R3)        Q. IS THIS TYPE/WORD IN TABLE?   00466000
         BNE   REPL$020                A. NO, LOOP TO NEXT TABLE ENTRY  00467000
         MVC   02(20,R4),22(R3)        A. YES, REPLACE WITH NEW WORD    00468000
         B     REPL$010                LOOP TO NEXT WORD ENTRY          00469000
         EJECT                                                          00470000
*---------------------------------------------------------------------* 00471000
* **  REBUILD OUTPUT DATA LINE.                                       * 00472000
*---------------------------------------------------------------------* 00473000
         SPACE 1                                                        00474000
REBU$000 DS    0H                                                       00475000
         MVC   WORDWRKE,BLANKS         POST BLANKS TO END OF AREA       00476000
         LA    R4,WORDWORK-25          LOAD INITIAL LOOP ADDRESS        00477000
         SPACE 1                                                        00478000
REBU$001 DS    0H                                                       00479000
         LA    R4,25(R4)               BUMP TO NEXT ENTRY AREA          00480000
         CLC   75(02,R4),BLANKS        Q. AT END OF DATA AREA?          00481000
         BE    REBU$002                A. YES, GO REBUILD DATA          00482000
         CLI   02(R4),X'F0'            Q. IS 1ST NUMERIC DESIGNATION?   00483000
         BL    REBU$001                A. NO, DO NOT FLAG NUMBERS       00484000
         CLI   02(R4),X'F9'            Q. IS 1ST NUMERIC DESIGNATION?   00485000
         BH    REBU$001                A. NO, DO NOT FLAG NUMBERS       00486000
         SPACE 1                                                        00487000
         CLC   25(02,R4),DIRECT        Q. IS 2ND A DIRECTIONAL?         00488000
         BNE   REBU$001                A. NO, DO NOT FLAG NUMBERS       00489000
         SPACE 1                                                        00490000
         CLI   52(R4),X'F0'            Q. IS 3RD NUMERIC DESIGNATION?   00491000
         BL    REBU$001                A. NO, DO NOT FLAG NUMBERS       00492000
         CLI   52(R4),X'F9'            Q. IS 3RD NUMERIC DESIGNATION?   00493000
         BH    REBU$001                A. NO, DO NOT FLAG NUMBERS       00494000
         SPACE 1                                                        00495000
         CLC   75(02,R4),DIRECT        Q. IS 4TH A DIRECTIONAL?         00496000
         BNE   REBU$001                A. NO, DO NOT FLAG NUMBERS       00497000
         SPACE 1                                                        00498000
         MVC   00(02,R4),NUMDIR        A. YES, SET 1ST AS NUMBER DIR    00499000
         MVC   50(02,R4),NUMDIR        A. YES, SET 3RD AS NUMBER DIR    00500000
         SPACE 1                                                        00501000
REBU$002 DS    0H                                                       00502000
         C     R12,=F'0'               Q. ANY DOUBLE DIRECTIONALS?      00503000
         BE    REBU$005                A. NO, BYPASS DIRECTIONAL CMBE   00504000
         LR    R4,R12                  A. YES, POST WORK ADDRESS        00505000
         MVC   WORDWRKE,BLANKS         POST BLANKS TO END OF AREA       00506000
         CLC   00(02,R4),DIRECT        Q. IS THIS STILL A DIRECTIONAL?  00507000
         BNE   REBU$005                A. NO, BYPASS COMBINE DIRECTS    00508000
         CLC   25(02,R4),DIRECT        Q. IS THIS STILL A DIRECTIONAL?  00509000
         BNE   REBU$005                A. NO, BYPASS COMBINE DIRECTS    00510000
         CLI   02(R4),C'E'             Q. IS THIS INVALID DIRECTIONAL?  00511000
         BE    REBU$005                A. YES, BYPASS COMBINE DIRECTS   00512000
         CLI   02(R4),C'W'             Q. IS THIS INVALID DIRECTIONAL?  00513000
         BE    REBU$005                A. YES, BYPASS COMBINE DIRECTS   00514000
         CLI   27(R4),C'N'             Q. IS THIS INVALID DIRECTIONAL?  00515000
         BE    REBU$005                A. YES, BYPASS COMBINE DIRECTS   00516000
         CLI   27(R4),C'S'             Q. IS THIS INVALID DIRECTIONAL?  00517000
         BE    REBU$005                A. YES, BYPASS COMBINE DIRECTS   00518000
         MVC   03(01,R4),27(R4)        A. NO, POST DIRECTIONAL TO 1ST   00519000
         SPACE 1                                                        00520000
REBU$003 DS    0H                                                       00521000
         LA    R4,25(R4)               POINT AT NEXT WORD AREA          00522000
         MVC   00(25,R4),25(R4)        SHIFT OVER NEEDLESS WORD         00523000
         CLC   00(02,R4),BLANKS        Q. ARE WE AT END OF WORDS?       00524000
         BNE   REBU$003                A. NO, LOOP TILL ALL SHIFTED     00525000
         SPACE 1                                                        00526000
REBU$005 DS    0H                                                       00527000
         LA    R4,WORDWORK             RESET WORDS WORK AREA ADDRESS    00528000
         SH    R4,=H'25'               BUMP BACK FOR LOOP AREA          00529000
         MVC   WORDWRKE,BLANKS         POST BLANKS TO END OF AREA       00530000
         LA    R3,NEW$ADDR             POST NEW LINE DATA ADDRESS       00531000
         MVI   NEW$ADDR,BLANK          CLEAR OUT NEW ADDRESS LINE       00532000
         MVC   NEW$ADDR+01(249),NEW$ADDR      WORK AREA                 00533000
         SPACE 1                                                        00534000
REBU$010 DS    0H                                                       00535000
         LA    R4,25(R4)               BUMP TO NEXT WORD ENTRY          00536000
         CLC   00(02,R4),BLANKS        Q. ARE WE AT END OF ALL WORDS?   00537000
         BE    REBU$900                A. YES, GO POST AREAS TO USER    00538000
         SPACE 1                                                        00539000
         MVC   00(20,R3),02(R4)        POST WORD TO ADDRESS LINE        00540000
         LA    R3,NEW$ADDR+250         LOAD ENDING AREA ADDRESS         00541000
         SPACE 1                                                        00542000
REBU$020 DS    0H                                                       00543000
         BCTR  R3,R0                   DECREMENT LINE ADDRESS DATA      00544000
         CLI   00(R3),BLANK            Q. ARE WE AT END OF ALL WORDS?   00545000
         BE    REBU$020                A. NO, LOOP TILL END FOUND       00546000
         LA    R3,02(R3)               A. YES, POST NEXT AVAILABLE POS  00547000
         B     REBU$010                LOOP TO GET ALL OF WORDS         00548000
         SPACE 1                                                        00549000
REBU$900 DS    0H                                                       00550000
         L     R4,00(R1)               RESET ADDRESS LINE ADDRESS       00551000
         MVC   00(40,R4),NEW$ADDR      POST UPDATED ADDRESS LINE        00552000
         L     R4,04(R1)               RESET WORDS WORK AREA ADDRESS    00553000
         MVC   00(250,R4),WORDWORK     POST UPDATED WORD WORK AREA      00554000
         EJECT                                                          00555000
*---------------------------------------------------------------------* 00556000
* *** RETURN TO CALLING PROGRAM                                       * 00557000
*---------------------------------------------------------------------* 00558000
         SPACE 1                                                        00559000
RETN$900 DS    0H                                                       00560000
         CLC   ERR$FLAG,BLANKS         Q. WERE THERE ANY ERRORS?        00561000
         BE    RETN$999                A. NO, RETURN TO CALLING PROGRAM 00562000
         L     R3,8(R1)                A. YES, LOAD ADDRESS OF RET CODE 00563000
         MVC   0(10,R3),ERR$FLAG       POST ERROR CODES TO RETURN AREA  00564000
         SPACE 1                                                        00565000
RETN$999 DS    0H                                                       00566000
         LM    R14,R12,12(R13)         RESTORE REGISTERS                00567000
         BR    R14                     RETURN                           00568000
         EJECT                                                          00569000
*---------------------------------------------------------------------* 00570000
* *** WORKING STORAGE                                                 * 00571000
*---------------------------------------------------------------------* 00572000
         SPACE 1                                                        00573000
COMMA    EQU   C','                    COMMA FOR COMPARES               00574000
PERIOD   EQU   C'.'                    PERIOD FOR COMPARES              00575000
POUND    EQU   C'#'                    POUND/NUMBER SIGN                00576000
BLANK    EQU   X'40'                   BLANK FOR COMPARES / CLEARS      00577000
SENTINEL EQU   X'FF'                   HIGH VALUE - COMPARES / CLEARS   00578000
BLANKS   DC    CL255' '                BLANKS FOR COMPARE               00579000
         SPACE 1                                                        00580000
STREET   DC    CL02'SN'                TYPE - STREET NAME               00581000
RR       DC    CL02'RR'                TYPE - RURAL ROUTE               00582000
THFARE   DC    CL02'TH'                TYPE - THROUGHFARE               00583000
UNIT     DC    CL02'UN'                TYPE - UNIT                      00584000
BOX      DC    CL02'BX'                TYPE - BOX                       00585000
DIRECT   DC    CL02'DI'                TYPE - DIRECTIONAL               00586000
BUILDING DC    CL02'BL'                TYPE - BUILDING                  00587000
MAILING  DC    CL02'MI'                TYPE - MAILING INFORMATION       00588000
         SPACE 1                                                        00589000
NUMBLD   DC    CL02'NB'                TYPE - BUILDING NUMBER           00590000
NUMBOX   DC    CL02'NX'                TYPE - BOX NUMBER                00591000
NUMDIR   DC    CL02'ND'                TYPE - DIRECTIONAL NUMBER        00592000
NUMHSE   DC    CL02'NH'                TYPE - HOUSE NUMBER              00593000
NUMRTE   DC    CL02'NR'                TYPE - ROUTE NUMBER              00594000
NUMUNT   DC    CL02'NU'                TYPE - UNIT NUMBER               00595000
         EJECT                                                          00596000
*---------------------------------------------------------------------* 00597000
* *** LITERAL POOL                                                    * 00598000
*---------------------------------------------------------------------* 00599000
         SPACE 1                                                        00600000
         LTORG                                                          00601000
         EJECT                                                          00602000
*---------------------------------------------------------------------* 00603000
*                                                                     * 00604000
* *** ADDRESS WORD TABLE.                                             * 00605000
*                                                                     * 00606000
*     FORMAT IS AS FOLLOWS:                                           * 00607000
*                                                                     * 00608000
*     POS 01 - 02       WORD TYPE INDICATOR                           * 00609000
*                                                                     * 00610000
*     POS 03 - 22       SEARCH WORD VALUE                             * 00611000
*                                                                     * 00612000
*     POS 23 - 42       REPLACEMENT WORD VALUE                        * 00613000
*                                                                     * 00614000
*---------------------------------------------------------------------* 00615000
         SPACE 1                                                        00616000
WRD$TBLE DS    0C                                                       00617000
         SPACE 1                                                        00618000
         DC    CL02'DI'                WORD CODE                        00619000
         DC    CL20'EAST'              SEARCH WORD                      00620000
         DC    CL20'E'                 REPLACE WORD                     00621000
         SPACE 1                                                        00622000
         DC    CL02'DI'                WORD CODE                        00623000
         DC    CL20'NE'                SEARCH WORD                      00624000
         DC    CL20'NE'                REPLACE WORD                     00625000
         SPACE 1                                                        00626000
         DC    CL02'DI'                WORD CODE                        00627000
         DC    CL20'NW'                SEARCH WORD                      00628000
         DC    CL20'NW'                REPLACE WORD                     00629000
         SPACE 1                                                        00630000
         DC    CL02'DI'                WORD CODE                        00631000
         DC    CL20'NORTH'             SEARCH WORD                      00632000
         DC    CL20'N'                 REPLACE WORD                     00633000
         SPACE 1                                                        00634000
         DC    CL02'DI'                WORD CODE                        00635000
         DC    CL20'NORTHEAST'         SEARCH WORD                      00636000
         DC    CL20'NE'                REPLACE WORD                     00637000
         SPACE 1                                                        00638000
         DC    CL02'DI'                WORD CODE                        00639000
         DC    CL20'NORTHWEST'         SEARCH WORD                      00640000
         DC    CL20'NW'                REPLACE WORD                     00641000
         SPACE 1                                                        00642000
         DC    CL02'DI'                WORD CODE                        00643000
         DC    CL20'SE'                SEARCH WORD                      00644000
         DC    CL20'SE'                REPLACE WORD                     00645000
         SPACE 1                                                        00646000
         DC    CL02'DI'                WORD CODE                        00647000
         DC    CL20'SW'                SEARCH WORD                      00648000
         DC    CL20'SW'                REPLACE WORD                     00649000
         SPACE 1                                                        00650000
         DC    CL02'DI'                WORD CODE                        00651000
         DC    CL20'SOUTH'             SEARCH WORD                      00652000
         DC    CL20'S'                 REPLACE WORD                     00653000
         SPACE 1                                                        00654000
         DC    CL02'DI'                WORD CODE                        00655000
         DC    CL20'SOUTHEAST'         SEARCH WORD                      00656000
         DC    CL20'SE'                REPLACE WORD                     00657000
         SPACE 1                                                        00658000
         DC    CL02'DI'                WORD CODE                        00659000
         DC    CL20'SOUTHWEST'         SEARCH WORD                      00660000
         DC    CL20'SW'                REPLACE WORD                     00661000
         SPACE 1                                                        00662000
         DC    CL02'DI'                WORD CODE                        00663000
         DC    CL20'WEST'              SEARCH WORD                      00664000
         DC    CL20'W'                 REPLACE WORD                     00665000
         SPACE 1                                                        00666000
*---------------------------------------------------------------------* 00667000
* *** SPECIAL WORD TABLE.                                             * 00668000
*---------------------------------------------------------------------* 00669000
         SPACE 1                                                        00670000
         DC    CL02'UN'                WORD CODE                        00671000
         DC    CL20'APARTMENT'         SEARCH WORD                      00672000
         DC    CL20'APT'               REPLACE WORD                     00673000
         SPACE 1                                                        00673100
         DC    CL02'UN'                WORD CODE                        00673200
         DC    CL20'#'                 SEARCH WORD                      00673300
         DC    CL20'#'                 REPLACE WORD                     00673400
         SPACE 1                                                        00673500
         DC    CL02'UN'                WORD CODE                        00673600
         DC    CL20'TRAILER'           SEARCH WORD                      00673700
         DC    CL20'TRLR'              REPLACE WORD                     00673800
         SPACE 1                                                        00674000
         DC    CL02'BL'                WORD CODE                        00675000
         DC    CL20'BUILDING'          SEARCH WORD                      00676000
         DC    CL20'BLDG'              REPLACE WORD                     00677000
         SPACE 1                                                        00678000
         DC    CL02'BX'                WORD CODE                        00679000
         DC    CL20'BOX'               SEARCH WORD                      00680000
         DC    CL20'BOX'               REPLACE WORD                     00681000
         SPACE 1                                                        00686000
         DC    CL02'RR'                WORD CODE                        00687000
         DC    CL20'RR'                SEARCH WORD                      00688000
         DC    CL20'RR'                REPLACE WORD                     00689000
         SPACE 1                                                        00690000
         DC    CL02'RR'                WORD CODE                        00691000
         DC    CL20'ROUTE'             SEARCH WORD                      00692000
         DC    CL20'RTE'               REPLACE WORD                     00693000
         SPACE 1                                                        00694000
         DC    CL02'RR'                WORD CODE                        00695000
         DC    CL20'HC'                SEARCH WORD                      00696000
         DC    CL20'HC'                REPLACE WORD                     00697990
         SPACE 1                                                        00702000
         DC    CL02'BX'                WORD CODE                        00703000
         DC    CL20'DRAWER'            SEARCH WORD                      00704000
         DC    CL20'DRAWER'            REPLACE WORD                     00705000
         SPACE 1                                                        00706000
         DC    CL02'BX'                WORD CODE                        00707000
         DC    CL20'PO'                SEARCH WORD                      00708000
         DC    CL20'PO'                REPLACE WORD                     00709000
         SPACE 1                                                        00710000
         DC    CL02'BL'                WORD CODE                        00711000
         DC    CL20'STATION'           SEARCH WORD                      00712000
         DC    CL20'STA'               REPLACE WORD                     00713000
         SPACE 1                                                        00714000
         DC    CL02'BL'                WORD CODE                        00715000
         DC    CL20'APARTMENTS'        SEARCH WORD                      00716000
         DC    CL20'APTS'              REPLACE WORD                     00717000
         SPACE 1                                                        00718000
         DC    CL02'UN'                WORD CODE                        00719000
         DC    CL20'ROOM'              SEARCH WORD                      00720000
         DC    CL20'RM'                REPLACE WORD                     00721000
         SPACE 1                                                        00722000
         DC    CL02'UN'                WORD CODE                        00723000
         DC    CL20'SUITE'             SEARCH WORD                      00724000
         DC    CL20'SUITE'             REPLACE WORD                     00725000
         SPACE 1                                                        00726000
         DC    CL02'UN'                WORD CODE                        00727000
         DC    CL20'LOT'               SEARCH WORD                      00728000
         DC    CL20'LOT'               REPLACE WORD                     00729000
         SPACE 1                                                        00730000
         DC    CL02'MI'                WORD CODE                        00731000
         DC    CL20'C/0'               SEARCH WORD                      00732000
         DC    CL20'C/O'               REPLACE WORD                     00733000
         SPACE 1                                                        00734000
         DC    CL02'MI'                WORD CODE                        00735000
         DC    CL20'ATTN'              SEARCH WORD                      00736000
         DC    CL20'ATTN'              REPLACE WORD                     00737000
         SPACE 1                                                        00738000
*---------------------------------------------------------------------* 00739000
* *** THOROUGHFARE TABLE.                                             * 00740000
*---------------------------------------------------------------------* 00741000
         SPACE 1                                                        00742000
         DC    CL02'TH'                WORD CODE                        00743000
         DC    CL20'STREET'            SEARCH WORD                      00744000
         DC    CL20'ST'                REPLACE WORD                     00745000
         SPACE 1                                                        00746000
         DC    CL02'TH'                WORD CODE                        00747000
         DC    CL20'AVENUE'            SEARCH WORD                      00748000
         DC    CL20'AVE'               REPLACE WORD                     00749000
         SPACE 1                                                        00750000
         DC    CL02'TH'                WORD CODE                        00751000
         DC    CL20'BOULEVARD'         SEARCH WORD                      00752000
         DC    CL20'BLVD'              REPLACE WORD                     00753000
         SPACE 1                                                        00754000
         DC    CL02'TH'                WORD CODE                        00755000
         DC    CL20'EXPRESSWAY'        SEARCH WORD                      00756000
         DC    CL20'EXPY'              REPLACE WORD                     00757000
         SPACE 1                                                        00758000
         DC    CL02'TH'                WORD CODE                        00759000
         DC    CL20'HIGHWAY'           SEARCH WORD                      00760000
         DC    CL20'HWY'               REPLACE WORD                     00761000
         SPACE 1                                                        00762000
         DC    CL02'TH'                WORD CODE                        00763000
         DC    CL20'PARKWAY'           SEARCH WORD                      00764000
         DC    CL20'PKWY'              REPLACE WORD                     00765000
         SPACE 1                                                        00766000
         DC    CL02'TH'                WORD CODE                        00767000
         DC    CL20'TURNPIKE'          SEARCH WORD                      00768000
         DC    CL20'TPKE'              REPLACE WORD                     00769000
         SPACE 1                                                        00770000
         DC    CL02'TH'                WORD CODE                        00771000
         DC    CL20'FREEWAY'           SEARCH WORD                      00772000
         DC    CL20'FWY'               REPLACE WORD                     00773000
         SPACE 1                                                        00774000
         DC    CL02'TH'                WORD CODE                        00775000
         DC    CL20'FRWY'              SEARCH WORD                      00776000
         DC    CL20'FWY'               REPLACE WORD                     00777000
         SPACE 1                                                        00778000
         DC    CL02'TH'                WORD CODE                        00779000
         DC    CL20'ROAD'              SEARCH WORD                      00780000
         DC    CL20'RD'                REPLACE WORD                     00781000
         SPACE 1                                                        00782000
         DC    CL02'TH'                WORD CODE                        00783000
         DC    CL20'DRIVE'             SEARCH WORD                      00784000
         DC    CL20'DR'                REPLACE WORD                     00785000
         SPACE 1                                                        00786000
         DC    CL02'TH'                WORD CODE                        00787000
         DC    CL20'TERRACE'           SEARCH WORD                      00788000
         DC    CL20'TER'               REPLACE WORD                     00789000
         SPACE 1                                                        00790000
         DC    CL02'TH'                WORD CODE                        00791000
         DC    CL20'PLACE'             SEARCH WORD                      00792000
         DC    CL20'PL'                REPLACE WORD                     00793000
         SPACE 1                                                        00794000
         DC    CL02'TH'                WORD CODE                        00795000
         DC    CL20'TRAIL'             SEARCH WORD                      00796000
         DC    CL20'TRL'               REPLACE WORD                     00797000
         SPACE 1                                                        00798000
         DC    CL02'TH'                WORD CODE                        00799000
         DC    CL20'COURT'             SEARCH WORD                      00800000
         DC    CL20'CT'                REPLACE WORD                     00801000
         SPACE 1                                                        00802000
         DC    CL02'TH'                WORD CODE                        00803000
         DC    CL20'CIRCLE'            SEARCH WORD                      00804000
         DC    CL20'CIR'               REPLACE WORD                     00805000
         SPACE 1                                                        00806000
         DC    CL02'TH'                WORD CODE                        00807000
         DC    CL20'LANE'              SEARCH WORD                      00808000
         DC    CL20'LN'                REPLACE WORD                     00809000
         SPACE 1                                                        00810000
         DC    CL02'TH'                WORD CODE                        00811000
         DC    CL20'OVAL'              SEARCH WORD                      00812000
         DC    CL20'OVAL'              REPLACE WORD                     00813000
         SPACE 1                                                        00814000
         DC    CL02'TH'                WORD CODE                        00815000
         DC    CL20'SQUARE'            SEARCH WORD                      00816000
         DC    CL20'SQ'                REPLACE WORD                     00817000
         SPACE 1                                                        00818000
         DC    CL02'TH'                WORD CODE                        00819000
         DC    CL20'STREETS'           SEARCH WORD                      00820000
         DC    CL20'STS'               REPLACE WORD                     00821000
         SPACE 1                                                        00822000
         DC    CL02'TH'                WORD CODE                        00823000
         DC    CL20'WAY'               SEARCH WORD                      00824000
         DC    CL20'WAY'               REPLACE WORD                     00825000
         SPACE 1                                                        00826000
         DC    CL02'TH'                WORD CODE                        00827000
         DC    CL20'PLAZA'             SEARCH WORD                      00828000
         DC    CL20'PLAZA'             REPLACE WORD                     00829000
         SPACE 1                                                        00830000
         DC    CL02'TH'                WORD CODE                        00831000
         DC    CL20'ROW'               SEARCH WORD                      00832000
         DC    CL20'ROW'               REPLACE WORD                     00833000
         SPACE 1                                                        00834000
         DC    CL02'TH'                WORD CODE                        00835000
         DC    CL20'RUN'               SEARCH WORD                      00836000
         DC    CL20'RUN'               REPLACE WORD                     00837000
         SPACE 1                                                        00838000
         DC    20XL01'FF'              END OF TABLE                     00839000
         SPACE 3                                                        00840000
         DC    C'RFA042.V21M00'        PROGRAM VERSION INFO             00841000
         EJECT                                                          00842000
*---------------------------------------------------------------------* 00843000
* *** WORKING STORAGE DSECT - WORD AND ADDRESS WORK AREAS             * 00844000
*---------------------------------------------------------------------* 00845000
         SPACE 1                                                        00846000
WORKSTRG DSECT                         WORKING STORAGE AREA             00847000
         SPACE 1                                                        00848000
ERR$FLAG DS    0CL10                   ERROR FLAG HOLD AREA             00849000
ERR$FLGA DS    CL01                        ERROR FLAG A                 00850000
ERR$FLGB DS    CL01                        ERROR FLAG B                 00851000
ERR$FLGC DS    CL01                        ERROR FLAG C                 00852000
ERR$FLGD DS    CL01                        ERROR FLAG D                 00853000
ERR$FLGE DS    CL01                        ERROR FLAG E                 00854000
ERR$FLGF DS    CL01                        ERROR FLAG F                 00855000
ERR$FLGG DS    CL01                        ERROR FLAG G                 00856000
ERR$FLGH DS    CL01                        ERROR FLAG H                 00857000
ERR$FLGI DS    CL01                        ERROR FLAG I                 00858000
ERR$FLGJ DS    CL01                        ERROR FLAG J                 00859000
         SPACE 1                                                        00860000
DEFAULT  DS    CL02                    TYPE - DEFAULT WORD TYPE CODE    00861000
STFOUND  DS    CL01                    FOUND STREET NAME CONSTANT       00862000
THFOUND  DS    CL01                    FOUND THOROUGHFARE CONSTANT      00862500
FIRSTWRD DS    CL01                    FIRST WORD INDICATOR             00862700
         SPACE 1                                                        00863000
WORDWRKB DS    CL50                    WORD WORK AREA BEGIN             00864000
WORDWORK DS    CL250                   WORD WORK AREA                   00865000
WORDWRKE DS    CL50                    WORD WORK AREA END               00866000
         SPACE 1                                                        00867000
NEW$ADDR DS    CL250                   ADDRESS REBUILD AREA             00868000
NEW$ADRE DS    CL20                    END OF AREA                      00869000
         SPACE 3                                                        00870000
         END                                                            00871000
