**********************************************************************  00001000
*                                                                       00002000
*  S09UDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S09 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
SVCTABLE DS    CL6                                                      00052000
AUDDATE  DS    PL5'0.'                                                  00053000
AUDTIME  DS    PL5'0.'                                                  00054000
AUDUSER  DS    CL8                                                      00055000
AUDORG   DS    CL6                                                      00056000
BALOPT   DS    CL1                                                      00057000
AMTREQ1  DS    PL6'0.00'                                                00058000
DISCPCT1 DS    PL3'0.00000'                                             00059000
DISCAMT1 DS    PL3'0.00'                                                00060000
AMTREQ2  DS    PL6'0.00'                                                00061000
DISCPCT2 DS    PL3'0.00000'                                             00062000
DISCAMT2 DS    PL3'0.00'                                                00063000
AMTREQ3  DS    PL6'0.00'                                                00064000
DISCPCT3 DS    PL3'0.00000'                                             00065000
DISCAMT3 DS    PL3'0.00'                                                00066000
AMTREQ4  DS    PL6'0.00'                                                00067000
DISCPCT4 DS    PL3'0.00000'                                             00068000
DISCAMT4 DS    PL3'0.00'                                                00069000
AMTREQ5  DS    PL6'0.00'                                                00070000
DISCPCT5 DS    PL3'0.00000'                                             00071000
DISCAMT5 DS    PL3'0.00'                                                00072000
AMTREQ6  DS    PL6'0.00'                                                00073000
DISCPCT6 DS    PL3'0.00000'                                             00074000
DISCAMT6 DS    PL3'0.00'                                                00075000
AMTREQ7  DS    PL6'0.00'                                                00076000
DISCPCT7 DS    PL3'0.00000'                                             00077000
DISCAMT7 DS    PL3'0.00'                                                00078000
AMTREQ8  DS    PL6'0.00'                                                00079000
DISCPCT8 DS    PL3'0.00000'                                             00080000
DISCAMT8 DS    PL3'0.00'                                                00081000
AMTREQ9  DS    PL6'0.00'                                                00082000
DISCPCT9 DS    PL3'0.00000'                                             00083000
DISCAMT9 DS    PL3'0.00'                                                00084000
AMTREQ10 DS    PL6'0.00'                                                00085000
RATEPT10 DS    PL3'0.00000'                                             00086000
DISCAM10 DS    PL3'0.00'                                                00087000
*                                                                       00088000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00089000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00090000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00091000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00092000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00093000
         DS    CL97                    RESERVED                         00094000
*                                                                       00095000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00096000
INDVARX  DS    0H                                                       00097000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00098000
*                                                                       00099000
*                                                                       00100000
**********************************************************************  00101000
* PROGRAM TABLE HEADER SECTION:                                         00102000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00103000
**********************************************************************  00104000
*                                                                       00105000
S09UDB   CSECT                         PROGRAM TABLE SECTION            00106000
S09UDB   AMODE ANY                                                      00107000
S09UDB   RMODE ANY                                                      00108000
         DC    CL8'S09UDB  '           PROGRAM ID                       00109000
         DC    CL1' '                                                   00110000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00111000
         DC    CL1' '                                                   00112000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00113000
         DC    CL1' '                                                   00114000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00115000
         DC    5A(0)                   RESERVED                         00116000
         DC    AL2(0)                  RESERVED                         00117000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00118000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00119000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00120000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00121000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00122000
         DC    CL29'WWW.INFOR.COM                '                      00122001
*                                                                       00123000
**********************************************************************  00124000
* STATEMENT TABLE SECTION:                                              00125000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00126000
**********************************************************************  00127000
*                                                                       00128000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00129000
STM#TAB  AMODE ANY                                                      00130000
STM#TAB  RMODE ANY                                                      00131000
         DC    4A(0)                   RDB MODULE VECTORS               00132000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00133000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00134000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00135000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00136000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00137000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00138000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00139000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00140000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00141000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00142000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00143000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00144000
         DC    20A(0)                  RDB MODULE VECTORS               00145000
         DC    A(INSROW)               INSERT STATEMENT                 00146000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00147000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00148000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00149000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00150000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00151000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00152000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00153000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00154000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00155000
         DC    4X'FF'                                                   00156000
*                                                                       00157000
**********************************************************************  00158000
* SQL STATEMENT SECTION:                                                00159000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00160000
*     TO SUPPORT THIS TABLE.                                            00161000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00162000
*     ARE EQUIVALENT.                                                   00163000
**********************************************************************  00164000
*                                                                       00165000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00166000
SQL#STMT AMODE ANY                                                      00167000
SQL#STMT RMODE ANY                                                      00168000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00169000
         USING COM#AREA,11             ADDRESS COMMAREA                 00170000
*                                                                       00171000
**********************************************************************  00172000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00173000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00174000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00175000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00176000
**********************************************************************  00177000
*                                                                       00178000
SELUC0   DS    0H                                                       00179000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00180000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00181000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00182000
         BALR  14,15                   MOVE REQUESTED DATA              00183000
         EXEC  SQL DECLARE S09UPD0 CURSOR                              *00184000
               FOR SELECT                                              *00185000
                   AUDIT_DATE,                                         *00186000
                   AUDIT_TIME,                                         *00187000
                   AUDIT_USER,                                         *00188000
                   AUDIT_ORG,                                          *00189000
                   BAL_OPT,                                            *00190000
                   AMOUNT_REQ_01,                                      *00191000
                   DISC_PCT_1,                                         *00192000
                   DISC_AMT_1,                                         *00193000
                   AMOUNT_REQ_02,                                      *00194000
                   DISC_PCT_2,                                         *00195000
                   DISC_AMT_2,                                         *00196000
                   AMOUNT_REQ_03,                                      *00197000
                   DISC_PCT_3,                                         *00198000
                   DISC_AMT_3,                                         *00199000
                   AMOUNT_REQ_04,                                      *00200000
                   DISC_PCT_4,                                         *00201000
                   DISC_AMT_4,                                         *00202000
                   AMOUNT_REQ_05,                                      *00203000
                   DISC_PCT_5,                                         *00204000
                   DISC_AMT_5,                                         *00205000
                   AMOUNT_REQ_06,                                      *00206000
                   DISC_PCT_6,                                         *00207000
                   DISC_AMT_6,                                         *00208000
                   AMOUNT_REQ_07,                                      *00209000
                   DISC_PCT_7,                                         *00210000
                   DISC_AMT_7,                                         *00211000
                   AMOUNT_REQ_08,                                      *00212000
                   DISC_PCT_8,                                         *00213000
                   DISC_AMT_8,                                         *00214000
                   AMOUNT_REQ_09,                                      *00215000
                   DISC_PCT_9,                                         *00216000
                   DISC_AMT_9,                                         *00217000
                   AMOUNT_REQ_10,                                      *00218000
                   DISC_PCT_10,                                        *00219000
                   DISC_AMT_10                                         *00220000
                 FROM S09                                              *00221000
                 WHERE                                                 *00222000
                   INST_NBR = :INST AND                                *00223000
                   RECORD_NBR = :RECNBR AND                            *00224000
                   SVC_CHG_TABLE = :SVCTABLE                           *00225000
                 FOR UPDATE OF                                         *00226000
                   AUDIT_DATE,                                         *00227000
                   AUDIT_TIME,                                         *00228000
                   AUDIT_USER,                                         *00229000
                   AUDIT_ORG,                                          *00230000
                   BAL_OPT,                                            *00231000
                   AMOUNT_REQ_01,                                      *00232000
                   DISC_PCT_1,                                         *00233000
                   DISC_AMT_1,                                         *00234000
                   AMOUNT_REQ_02,                                      *00235000
                   DISC_PCT_2,                                         *00236000
                   DISC_AMT_2,                                         *00237000
                   AMOUNT_REQ_03,                                      *00238000
                   DISC_PCT_3,                                         *00239000
                   DISC_AMT_3,                                         *00240000
                   AMOUNT_REQ_04,                                      *00241000
                   DISC_PCT_4,                                         *00242000
                   DISC_AMT_4,                                         *00243000
                   AMOUNT_REQ_05,                                      *00244000
                   DISC_PCT_5,                                         *00245000
                   DISC_AMT_5,                                         *00246000
                   AMOUNT_REQ_06,                                      *00247000
                   DISC_PCT_6,                                         *00248000
                   DISC_AMT_6,                                         *00249000
                   AMOUNT_REQ_07,                                      *00250000
                   DISC_PCT_7,                                         *00251000
                   DISC_AMT_7,                                         *00252000
                   AMOUNT_REQ_08,                                      *00253000
                   DISC_PCT_8,                                         *00254000
                   DISC_AMT_8,                                         *00255000
                   AMOUNT_REQ_09,                                      *00256000
                   DISC_PCT_9,                                         *00257000
                   DISC_AMT_9,                                         *00258000
                   AMOUNT_REQ_10,                                      *00259000
                   DISC_PCT_10,                                        *00260000
                   DISC_AMT_10                                         *00261000
                 FETCH FIRST 1 ROW ONLY                                 00262000
         EXEC  SQL OPEN S09UPD0                                         00263000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00264000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00265000
         BR    14                      RETURN TO CALLER                 00266000
         LTORG                                                          00267000
*                                                                       00268000
**********************************************************************  00269000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00270000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00271000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00272000
*     THE ACTUAL ROW.                                                   00273000
**********************************************************************  00274000
*                                                                       00275000
FETUC0   DS    0H                                                       00276000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00277000
         EXEC  SQL FETCH S09UPD0                                       *00278000
                 INTO                                                  *00279000
                   :AUDDATE,                                           *00280000
                   :AUDTIME,                                           *00281000
                   :AUDUSER,                                           *00282000
                   :AUDORG,                                            *00283000
                   :BALOPT,                                            *00284000
                   :AMTREQ1,                                           *00285000
                   :DISCPCT1,                                          *00286000
                   :DISCAMT1,                                          *00287000
                   :AMTREQ2,                                           *00288000
                   :DISCPCT2,                                          *00289000
                   :DISCAMT2,                                          *00290000
                   :AMTREQ3,                                           *00291000
                   :DISCPCT3,                                          *00292000
                   :DISCAMT3,                                          *00293000
                   :AMTREQ4,                                           *00294000
                   :DISCPCT4,                                          *00295000
                   :DISCAMT4,                                          *00296000
                   :AMTREQ5,                                           *00297000
                   :DISCPCT5,                                          *00298000
                   :DISCAMT5,                                          *00299000
                   :AMTREQ6,                                           *00300000
                   :DISCPCT6,                                          *00301000
                   :DISCAMT6,                                          *00302000
                   :AMTREQ7,                                           *00303000
                   :DISCPCT7,                                          *00304000
                   :DISCAMT7,                                          *00305000
                   :AMTREQ8,                                           *00306000
                   :DISCPCT8,                                          *00307000
                   :DISCAMT8,                                          *00308000
                   :AMTREQ9,                                           *00309000
                   :DISCPCT9,                                          *00310000
                   :DISCAMT9,                                          *00311000
                   :AMTREQ10,                                          *00312000
                   :RATEPT10,                                          *00313000
                   :DISCAM10                                            00314000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00315000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00316000
         BALR  14,15                   MOVE REQUESTED DATA              00317000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00318000
         BR    14                      RETURN TO CALLER                 00319000
         LTORG                                                          00320000
*                                                                       00321000
**********************************************************************  00322000
* INSERT STATEMENT:                                                     00323000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00324000
**********************************************************************  00325000
*                                                                       00326000
INSROW   DS    0H                                                       00327000
         USING INSROW,12               ESTABLISH BASE REGISTER          00328000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00329000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00330000
         BALR  14,15                   MOVE REQUESTED DATA              00331000
         EXEC  SQL INSERT INTO S09                                     *00332000
                   (                                                   *00333000
                   INST_NBR,                                           *00334000
                   RECORD_NBR,                                         *00335000
                   SVC_CHG_TABLE,                                      *00336000
                   AUDIT_DATE,                                         *00337000
                   AUDIT_TIME,                                         *00338000
                   AUDIT_USER,                                         *00339000
                   AUDIT_ORG,                                          *00340000
                   BAL_OPT,                                            *00341000
                   AMOUNT_REQ_01,                                      *00342000
                   DISC_PCT_1,                                         *00343000
                   DISC_AMT_1,                                         *00344000
                   AMOUNT_REQ_02,                                      *00345000
                   DISC_PCT_2,                                         *00346000
                   DISC_AMT_2,                                         *00347000
                   AMOUNT_REQ_03,                                      *00348000
                   DISC_PCT_3,                                         *00349000
                   DISC_AMT_3,                                         *00350000
                   AMOUNT_REQ_04,                                      *00351000
                   DISC_PCT_4,                                         *00352000
                   DISC_AMT_4,                                         *00353000
                   AMOUNT_REQ_05,                                      *00354000
                   DISC_PCT_5,                                         *00355000
                   DISC_AMT_5,                                         *00356000
                   AMOUNT_REQ_06,                                      *00357000
                   DISC_PCT_6,                                         *00358000
                   DISC_AMT_6,                                         *00359000
                   AMOUNT_REQ_07,                                      *00360000
                   DISC_PCT_7,                                         *00361000
                   DISC_AMT_7,                                         *00362000
                   AMOUNT_REQ_08,                                      *00363000
                   DISC_PCT_8,                                         *00364000
                   DISC_AMT_8,                                         *00365000
                   AMOUNT_REQ_09,                                      *00366000
                   DISC_PCT_9,                                         *00367000
                   DISC_AMT_9,                                         *00368000
                   AMOUNT_REQ_10,                                      *00369000
                   DISC_PCT_10,                                        *00370000
                   DISC_AMT_10                                         *00371000
                   )                                                   *00372000
                  VALUES                                               *00373000
                   (                                                   *00374000
                   :INST,                                              *00375000
                   :RECNBR,                                            *00376000
                   :SVCTABLE,                                          *00377000
                   :AUDDATE,                                           *00378000
                   :AUDTIME,                                           *00379000
                   :AUDUSER,                                           *00380000
                   :AUDORG,                                            *00381000
                   :BALOPT,                                            *00382000
                   :AMTREQ1,                                           *00383000
                   :DISCPCT1,                                          *00384000
                   :DISCAMT1,                                          *00385000
                   :AMTREQ2,                                           *00386000
                   :DISCPCT2,                                          *00387000
                   :DISCAMT2,                                          *00388000
                   :AMTREQ3,                                           *00389000
                   :DISCPCT3,                                          *00390000
                   :DISCAMT3,                                          *00391000
                   :AMTREQ4,                                           *00392000
                   :DISCPCT4,                                          *00393000
                   :DISCAMT4,                                          *00394000
                   :AMTREQ5,                                           *00395000
                   :DISCPCT5,                                          *00396000
                   :DISCAMT5,                                          *00397000
                   :AMTREQ6,                                           *00398000
                   :DISCPCT6,                                          *00399000
                   :DISCAMT6,                                          *00400000
                   :AMTREQ7,                                           *00401000
                   :DISCPCT7,                                          *00402000
                   :DISCAMT7,                                          *00403000
                   :AMTREQ8,                                           *00404000
                   :DISCPCT8,                                          *00405000
                   :DISCAMT8,                                          *00406000
                   :AMTREQ9,                                           *00407000
                   :DISCPCT9,                                          *00408000
                   :DISCAMT9,                                          *00409000
                   :AMTREQ10,                                          *00410000
                   :RATEPT10,                                          *00411000
                   :DISCAM10                                           *00412000
                   )                                                    00413000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00414000
         BR    14                      RETURN TO CALLER                 00415000
         LTORG                                                          00416000
*                                                                       00417000
**********************************************************************  00418000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00419000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00420000
**********************************************************************  00421000
*                                                                       00422000
UPDUC0   DS    0H                                                       00423000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00424000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00425000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00426000
         BALR  14,15                   MOVE REQUESTED DATA              00427000
         EXEC  SQL UPDATE S09                                          *00428000
                   SET                                                 *00429000
                     AUDIT_DATE = :AUDDATE,                            *00430000
                     AUDIT_TIME = :AUDTIME,                            *00431000
                     AUDIT_USER = :AUDUSER,                            *00432000
                     AUDIT_ORG = :AUDORG,                              *00433000
                     BAL_OPT = :BALOPT,                                *00434000
                     AMOUNT_REQ_01 = :AMTREQ1,                         *00435000
                     DISC_PCT_1 = :DISCPCT1,                           *00436000
                     DISC_AMT_1 = :DISCAMT1,                           *00437000
                     AMOUNT_REQ_02 = :AMTREQ2,                         *00438000
                     DISC_PCT_2 = :DISCPCT2,                           *00439000
                     DISC_AMT_2 = :DISCAMT2,                           *00440000
                     AMOUNT_REQ_03 = :AMTREQ3,                         *00441000
                     DISC_PCT_3 = :DISCPCT3,                           *00442000
                     DISC_AMT_3 = :DISCAMT3,                           *00443000
                     AMOUNT_REQ_04 = :AMTREQ4,                         *00444000
                     DISC_PCT_4 = :DISCPCT4,                           *00445000
                     DISC_AMT_4 = :DISCAMT4,                           *00446000
                     AMOUNT_REQ_05 = :AMTREQ5,                         *00447000
                     DISC_PCT_5 = :DISCPCT5,                           *00448000
                     DISC_AMT_5 = :DISCAMT5,                           *00449000
                     AMOUNT_REQ_06 = :AMTREQ6,                         *00450000
                     DISC_PCT_6 = :DISCPCT6,                           *00451000
                     DISC_AMT_6 = :DISCAMT6,                           *00452000
                     AMOUNT_REQ_07 = :AMTREQ7,                         *00453000
                     DISC_PCT_7 = :DISCPCT7,                           *00454000
                     DISC_AMT_7 = :DISCAMT7,                           *00455000
                     AMOUNT_REQ_08 = :AMTREQ8,                         *00456000
                     DISC_PCT_8 = :DISCPCT8,                           *00457000
                     DISC_AMT_8 = :DISCAMT8,                           *00458000
                     AMOUNT_REQ_09 = :AMTREQ9,                         *00459000
                     DISC_PCT_9 = :DISCPCT9,                           *00460000
                     DISC_AMT_9 = :DISCAMT9,                           *00461000
                     AMOUNT_REQ_10 = :AMTREQ10,                        *00462000
                     DISC_PCT_10 = :RATEPT10,                          *00463000
                     DISC_AMT_10 = :DISCAM10                           *00464000
                 WHERE CURRENT OF S09UPD0                               00465000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00466000
         BR    14                      RETURN TO CALLER                 00467000
         LTORG                                                          00468000
*                                                                       00469000
**********************************************************************  00470000
* DELETE STATEMENT BY PRIMARY KEY:                                      00471000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00472000
**********************************************************************  00473000
*                                                                       00474000
DELUC0   DS    0H                                                       00475000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00476000
         EXEC  SQL DELETE FROM S09                                     *00477000
                 WHERE CURRENT OF S09UPD0                               00478000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00479000
         BR    14                      RETURN TO CALLER                 00480000
         LTORG                                                          00481000
*                                                                       00482000
**********************************************************************  00483000
* DELETE ALL STATEMENT:                                                 00484000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00485000
**********************************************************************  00486000
*                                                                       00487000
DELTBL   DS    0H                                                       00488000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00489000
         EXEC  SQL DELETE FROM S09                                      00490000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00491000
         BR    14                      RETURN TO CALLER                 00492000
         LTORG                                                          00493000
*                                                                       00494000
**********************************************************************  00495000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00496000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00497000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00498000
*     TO CLOSE THE UPDATE CURSOR.                                       00499000
**********************************************************************  00500000
*                                                                       00501000
CLSUC0   DS    0H                                                       00502000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00503000
         EXEC  SQL CLOSE S09UPD0                                        00504000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00505000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00506000
         BR    14                      RETURN TO CALLER                 00507000
         LTORG                                                          00508000
*                                                                       00509000
**********************************************************************  00510000
* ALTERNATE KEY 1 NOT DEFINED                                           00511000
**********************************************************************  00512000
*                                                                       00513000
SELUC1   DS    0H                                                       00514000
FETUC1   DS    0H                                                       00515000
UPDUC1   DS    0H                                                       00516000
DELUC1   DS    0H                                                       00517000
CLSUC1   DS    0H                                                       00518000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00519000
*                                                                       00520000
**********************************************************************  00521000
* ALTERNATE KEY 2 NOT DEFINED                                           00522000
**********************************************************************  00523000
*                                                                       00524000
SELUC2   DS    0H                                                       00525000
FETUC2   DS    0H                                                       00526000
UPDUC2   DS    0H                                                       00527000
DELUC2   DS    0H                                                       00528000
CLSUC2   DS    0H                                                       00529000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00530000
*                                                                       00531000
**********************************************************************  00532000
* ALTERNATE KEY 3 NOT DEFINED                                           00533000
**********************************************************************  00534000
*                                                                       00535000
SELUC3   DS    0H                                                       00536000
FETUC3   DS    0H                                                       00537000
UPDUC3   DS    0H                                                       00538000
DELUC3   DS    0H                                                       00539000
CLSUC3   DS    0H                                                       00540000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00541000
*                                                                       00542000
         DS    0H                      END OF SQL STATEMENTS            00543000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00544000
*                                                                       00545000
**********************************************************************  00546000
* DUMMY ENTRY POINT DSNHLI                                              00547000
**********************************************************************  00548000
*                                                                       00549000
         ENTRY DSNHLI                                                   00550000
DSNHLI   DS    0H                                                       00551000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00552000
         BR    15                      BRANCH TO ATTACH FACILITY        00553000
*                                                                       00554000
**********************************************************************  00555000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00556000
**********************************************************************  00557000
*                                                                       00558000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00559000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00560000
* OR:                                                                   00561000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00562000
* WHERE:                                                                00563000
*   RRRR = RECORD AREA OFFSET                                           00564000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00565000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00566000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00567000
*   KK   = KEY FIELD MASK:                                              00568000
*            80 = KEY 0 FIELD                                           00569000
*            40 = KEY 1 FIELD                                           00570000
*            20 = KEY 2 FIELD                                           00571000
*            10 = KEY 3 FIELD                                           00572000
*   DD   = DATA FIELD MASK:                                             00573000
*            80 = RECORD FIELD IS PACKED                                00574000
*            40 = HOST VARIABLE IS PACKED                               00575000
*            20 = NULLABLE FIELD                                        00576000
*            01 = DATE FIELD                                            00577000
*            02 = TIME FIELD                                            00578000
*                                                                       00579000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00580000
         DC    H'0000',H'0000',H'0014',X'80',X'00'                      00581000
         DC    H'0014',H'0014',H'0145',X'00',X'00'                      00582000
         DC    8X'FF'                                                   00583000
*                                                                       00584000
         LTORG                                                          00585000
         END                                                            00586000
