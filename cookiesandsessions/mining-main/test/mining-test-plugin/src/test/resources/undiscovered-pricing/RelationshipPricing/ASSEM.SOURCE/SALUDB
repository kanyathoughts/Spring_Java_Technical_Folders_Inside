**********************************************************************  00001000
*                                                                       00002000
*  SALUDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAL TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
PRDCDE   DS    CL6                                                      00051000
ACCTNBR  DS    CL18                                                     00052000
MODEL    DS    CL10                                                     00053000
AUDDATE  DS    PL5'0.'                                                  00054000
AUDTIME  DS    PL5'0.'                                                  00055000
AUDUSER  DS    CL8                                                      00056000
AUDORG   DS    CL6                                                      00057000
GRACEDTE DS    PL5'0.'                                                  00058000
TRNDTE01 DS    PL5'0.'                                                  00059000
TRNCNT01 DS    PL3'0.'                                                  00060000
TRNAMT01 DS    PL7'0.00'                                                00061000
TRNDTE02 DS    PL5'0.'                                                  00062000
TRNCNT02 DS    PL3'0.'                                                  00063000
TRNAMT02 DS    PL7'0.00'                                                00064000
TRNDTE03 DS    PL5'0.'                                                  00065000
TRNCNT03 DS    PL3'0.'                                                  00066000
TRNAMT03 DS    PL7'0.00'                                                00067000
TRNDTE04 DS    PL5'0.'                                                  00068000
TRNCNT04 DS    PL3'0.'                                                  00069000
TRNAMT04 DS    PL7'0.00'                                                00070000
TRNDTE05 DS    PL5'0.'                                                  00071000
TRNCNT05 DS    PL3'0.'                                                  00072000
TRNAMT05 DS    PL7'0.00'                                                00073000
TRNDTE06 DS    PL5'0.'                                                  00074000
TRNCNT06 DS    PL3'0.'                                                  00075000
TRNAMT06 DS    PL7'0.00'                                                00076000
TRNDTE07 DS    PL5'0.'                                                  00077000
TRNCNT07 DS    PL3'0.'                                                  00078000
TRNAMT07 DS    PL7'0.00'                                                00079000
TRNDTE08 DS    PL5'0.'                                                  00080000
TRNCNT08 DS    PL3'0.'                                                  00081000
TRNAMT08 DS    PL7'0.00'                                                00082000
TRNDTE09 DS    PL5'0.'                                                  00083000
TRNCNT09 DS    PL3'0.'                                                  00084000
TRNAMT09 DS    PL7'0.00'                                                00085000
TRNDTE10 DS    PL5'0.'                                                  00086000
TRNCNT10 DS    PL3'0.'                                                  00087000
TRNAMT10 DS    PL7'0.00'                                                00088000
TRNDTE11 DS    PL5'0.'                                                  00089000
TRNCNT11 DS    PL3'0.'                                                  00090000
TRNAMT11 DS    PL7'0.00'                                                00091000
TRNDTE12 DS    PL5'0.'                                                  00092000
TRNCNT12 DS    PL3'0.'                                                  00093000
TRNAMT12 DS    PL7'0.00'                                                00094000
RAREA    DS    CL50                                                     00095000
*                                                                       00096000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00097000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00098000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00099000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00100000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00101000
         DS    CL97                    RESERVED                         00102000
*                                                                       00103000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00104000
INDVARX  DS    0H                                                       00105000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00106000
*                                                                       00107000
*                                                                       00108000
**********************************************************************  00109000
* PROGRAM TABLE HEADER SECTION:                                         00110000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00111000
**********************************************************************  00112000
*                                                                       00113000
SALUDB   CSECT                         PROGRAM TABLE SECTION            00114000
SALUDB   AMODE ANY                                                      00115000
SALUDB   RMODE ANY                                                      00116000
         DC    CL8'SALUDB  '           PROGRAM ID                       00117000
         DC    CL1' '                                                   00118000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00119000
         DC    CL1' '                                                   00120000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00121000
         DC    CL1' '                                                   00122000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00123000
         DC    5A(0)                   RESERVED                         00124000
         DC    AL2(0)                  RESERVED                         00125000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00126000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00127000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00128000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00129000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00130000
         DC    CL29'WWW.INFOR.COM                '                      00130001
*                                                                       00131000
**********************************************************************  00132000
* STATEMENT TABLE SECTION:                                              00133000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00134000
**********************************************************************  00135000
*                                                                       00136000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00137000
STM#TAB  AMODE ANY                                                      00138000
STM#TAB  RMODE ANY                                                      00139000
         DC    4A(0)                   RDB MODULE VECTORS               00140000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00141000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00142000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00143000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00144000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00145000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00146000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00147000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00148000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00149000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00150000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00151000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00152000
         DC    20A(0)                  RDB MODULE VECTORS               00153000
         DC    A(INSROW)               INSERT STATEMENT                 00154000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00155000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00156000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00157000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00158000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00159000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00160000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00161000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00162000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00163000
         DC    4X'FF'                                                   00164000
*                                                                       00165000
**********************************************************************  00166000
* SQL STATEMENT SECTION:                                                00167000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00168000
*     TO SUPPORT THIS TABLE.                                            00169000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00170000
*     ARE EQUIVALENT.                                                   00171000
**********************************************************************  00172000
*                                                                       00173000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00174000
SQL#STMT AMODE ANY                                                      00175000
SQL#STMT RMODE ANY                                                      00176000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00177000
         USING COM#AREA,11             ADDRESS COMMAREA                 00178000
*                                                                       00179000
**********************************************************************  00180000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00181000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00182000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00183000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00184000
**********************************************************************  00185000
*                                                                       00186000
SELUC0   DS    0H                                                       00187000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00188000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00189000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00190000
         BALR  14,15                   MOVE REQUESTED DATA              00191000
         B     *+6                     BRANCH AROUND ADCON              00192000
BASSEL0  DC    AL2(4096)                                                00193000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00194000
         AH    3,BASSEL0               ADD 4K                           00195000
         EXEC  SQL DECLARE SALUPD0 CURSOR                              *00196000
               FOR SELECT                                              *00197000
                   AUDIT_DATE,                                         *00198000
                   AUDIT_TIME,                                         *00199000
                   AUDIT_USER,                                         *00200000
                   AUDIT_ORG,                                          *00201000
                   GRACE_EXP_DATE,                                     *00202000
                   TRAN_DATE_01,                                       *00203000
                   TRAN_COUNT_01,                                      *00204000
                   TRAN_AMOUNT_01,                                     *00205000
                   TRAN_DATE_02,                                       *00206000
                   TRAN_COUNT_02,                                      *00207000
                   TRAN_AMOUNT_02,                                     *00208000
                   TRAN_DATE_03,                                       *00209000
                   TRAN_COUNT_03,                                      *00210000
                   TRAN_AMOUNT_03,                                     *00211000
                   TRAN_DATE_04,                                       *00212000
                   TRAN_COUNT_04,                                      *00213000
                   TRAN_AMOUNT_04,                                     *00214000
                   TRAN_DATE_05,                                       *00215000
                   TRAN_COUNT_05,                                      *00216000
                   TRAN_AMOUNT_05,                                     *00217000
                   TRAN_DATE_06,                                       *00218000
                   TRAN_COUNT_06,                                      *00219000
                   TRAN_AMOUNT_06,                                     *00220000
                   TRAN_DATE_07,                                       *00221000
                   TRAN_COUNT_07,                                      *00222000
                   TRAN_AMOUNT_07,                                     *00223000
                   TRAN_DATE_08,                                       *00224000
                   TRAN_COUNT_08,                                      *00225000
                   TRAN_AMOUNT_08,                                     *00226000
                   TRAN_DATE_09,                                       *00227000
                   TRAN_COUNT_09,                                      *00228000
                   TRAN_AMOUNT_09,                                     *00229000
                   TRAN_DATE_10,                                       *00230000
                   TRAN_COUNT_10,                                      *00231000
                   TRAN_AMOUNT_10,                                     *00232000
                   TRAN_DATE_11,                                       *00233000
                   TRAN_COUNT_11,                                      *00234000
                   TRAN_AMOUNT_11,                                     *00235000
                   TRAN_DATE_12,                                       *00236000
                   TRAN_COUNT_12,                                      *00237000
                   TRAN_AMOUNT_12,                                     *00238000
                   RSV_AREA                                            *00239000
                 FROM SAL                                              *00240000
                 WHERE                                                 *00241000
                   INST_NBR = :INST AND                                *00242000
                   PROD_CODE = :PRDCDE AND                             *00243000
                   ACCT_NBR = :ACCTNBR AND                             *00244000
                   MODEL = :MODEL                                      *00245000
                 FOR UPDATE OF                                         *00246000
                   AUDIT_DATE,                                         *00247000
                   AUDIT_TIME,                                         *00248000
                   AUDIT_USER,                                         *00249000
                   AUDIT_ORG,                                          *00250000
                   GRACE_EXP_DATE,                                     *00251000
                   TRAN_DATE_01,                                       *00252000
                   TRAN_COUNT_01,                                      *00253000
                   TRAN_AMOUNT_01,                                     *00254000
                   TRAN_DATE_02,                                       *00255000
                   TRAN_COUNT_02,                                      *00256000
                   TRAN_AMOUNT_02,                                     *00257000
                   TRAN_DATE_03,                                       *00258000
                   TRAN_COUNT_03,                                      *00259000
                   TRAN_AMOUNT_03,                                     *00260000
                   TRAN_DATE_04,                                       *00261000
                   TRAN_COUNT_04,                                      *00262000
                   TRAN_AMOUNT_04,                                     *00263000
                   TRAN_DATE_05,                                       *00264000
                   TRAN_COUNT_05,                                      *00265000
                   TRAN_AMOUNT_05,                                     *00266000
                   TRAN_DATE_06,                                       *00267000
                   TRAN_COUNT_06,                                      *00268000
                   TRAN_AMOUNT_06,                                     *00269000
                   TRAN_DATE_07,                                       *00270000
                   TRAN_COUNT_07,                                      *00271000
                   TRAN_AMOUNT_07,                                     *00272000
                   TRAN_DATE_08,                                       *00273000
                   TRAN_COUNT_08,                                      *00274000
                   TRAN_AMOUNT_08,                                     *00275000
                   TRAN_DATE_09,                                       *00276000
                   TRAN_COUNT_09,                                      *00277000
                   TRAN_AMOUNT_09,                                     *00278000
                   TRAN_DATE_10,                                       *00279000
                   TRAN_COUNT_10,                                      *00280000
                   TRAN_AMOUNT_10,                                     *00281000
                   TRAN_DATE_11,                                       *00282000
                   TRAN_COUNT_11,                                      *00283000
                   TRAN_AMOUNT_11,                                     *00284000
                   TRAN_DATE_12,                                       *00285000
                   TRAN_COUNT_12,                                      *00286000
                   TRAN_AMOUNT_12,                                     *00287000
                   RSV_AREA                                            *00288000
                 FETCH FIRST 1 ROW ONLY                                 00289000
         EXEC  SQL OPEN SALUPD0                                         00290000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00291000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00292000
         BR    14                      RETURN TO CALLER                 00293000
         LTORG                                                          00294000
*                                                                       00295000
**********************************************************************  00296000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00297000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00298000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00299000
*     THE ACTUAL ROW.                                                   00300000
**********************************************************************  00301000
*                                                                       00302000
FETUC0   DS    0H                                                       00303000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00304000
         B     *+6                     BRANCH AROUND ADCON              00305000
BASFET0  DC    AL2(4096)                                                00306000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00307000
         AH    3,BASFET0               ADD 4K                           00308000
         EXEC  SQL FETCH SALUPD0                                       *00309000
                 INTO                                                  *00310000
                   :AUDDATE,                                           *00311000
                   :AUDTIME,                                           *00312000
                   :AUDUSER,                                           *00313000
                   :AUDORG,                                            *00314000
                   :GRACEDTE,                                          *00315000
                   :TRNDTE01,                                          *00316000
                   :TRNCNT01,                                          *00317000
                   :TRNAMT01,                                          *00318000
                   :TRNDTE02,                                          *00319000
                   :TRNCNT02,                                          *00320000
                   :TRNAMT02,                                          *00321000
                   :TRNDTE03,                                          *00322000
                   :TRNCNT03,                                          *00323000
                   :TRNAMT03,                                          *00324000
                   :TRNDTE04,                                          *00325000
                   :TRNCNT04,                                          *00326000
                   :TRNAMT04,                                          *00327000
                   :TRNDTE05,                                          *00328000
                   :TRNCNT05,                                          *00329000
                   :TRNAMT05,                                          *00330000
                   :TRNDTE06,                                          *00331000
                   :TRNCNT06,                                          *00332000
                   :TRNAMT06,                                          *00333000
                   :TRNDTE07,                                          *00334000
                   :TRNCNT07,                                          *00335000
                   :TRNAMT07,                                          *00336000
                   :TRNDTE08,                                          *00337000
                   :TRNCNT08,                                          *00338000
                   :TRNAMT08,                                          *00339000
                   :TRNDTE09,                                          *00340000
                   :TRNCNT09,                                          *00341000
                   :TRNAMT09,                                          *00342000
                   :TRNDTE10,                                          *00343000
                   :TRNCNT10,                                          *00344000
                   :TRNAMT10,                                          *00345000
                   :TRNDTE11,                                          *00346000
                   :TRNCNT11,                                          *00347000
                   :TRNAMT11,                                          *00348000
                   :TRNDTE12,                                          *00349000
                   :TRNCNT12,                                          *00350000
                   :TRNAMT12,                                          *00351000
                   :RAREA                                               00352000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00353000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00354000
         BALR  14,15                   MOVE REQUESTED DATA              00355000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00356000
         BR    14                      RETURN TO CALLER                 00357000
         LTORG                                                          00358000
*                                                                       00359000
**********************************************************************  00360000
* INSERT STATEMENT:                                                     00361000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00362000
**********************************************************************  00363000
*                                                                       00364000
INSROW   DS    0H                                                       00365000
         USING INSROW,12               ESTABLISH BASE REGISTER          00366000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00367000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00368000
         BALR  14,15                   MOVE REQUESTED DATA              00369000
         B     *+6                     BRANCH AROUND ADCON              00370000
BASINS0  DC    AL2(4096)                                                00371000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00372000
         AH    3,BASINS0               ADD 4K                           00373000
         EXEC  SQL INSERT INTO SAL                                     *00374000
                   (                                                   *00375000
                   INST_NBR,                                           *00376000
                   PROD_CODE,                                          *00377000
                   ACCT_NBR,                                           *00378000
                   MODEL,                                              *00379000
                   AUDIT_DATE,                                         *00380000
                   AUDIT_TIME,                                         *00381000
                   AUDIT_USER,                                         *00382000
                   AUDIT_ORG,                                          *00383000
                   GRACE_EXP_DATE,                                     *00384000
                   TRAN_DATE_01,                                       *00385000
                   TRAN_COUNT_01,                                      *00386000
                   TRAN_AMOUNT_01,                                     *00387000
                   TRAN_DATE_02,                                       *00388000
                   TRAN_COUNT_02,                                      *00389000
                   TRAN_AMOUNT_02,                                     *00390000
                   TRAN_DATE_03,                                       *00391000
                   TRAN_COUNT_03,                                      *00392000
                   TRAN_AMOUNT_03,                                     *00393000
                   TRAN_DATE_04,                                       *00394000
                   TRAN_COUNT_04,                                      *00395000
                   TRAN_AMOUNT_04,                                     *00396000
                   TRAN_DATE_05,                                       *00397000
                   TRAN_COUNT_05,                                      *00398000
                   TRAN_AMOUNT_05,                                     *00399000
                   TRAN_DATE_06,                                       *00400000
                   TRAN_COUNT_06,                                      *00401000
                   TRAN_AMOUNT_06,                                     *00402000
                   TRAN_DATE_07,                                       *00403000
                   TRAN_COUNT_07,                                      *00404000
                   TRAN_AMOUNT_07,                                     *00405000
                   TRAN_DATE_08,                                       *00406000
                   TRAN_COUNT_08,                                      *00407000
                   TRAN_AMOUNT_08,                                     *00408000
                   TRAN_DATE_09,                                       *00409000
                   TRAN_COUNT_09,                                      *00410000
                   TRAN_AMOUNT_09,                                     *00411000
                   TRAN_DATE_10,                                       *00412000
                   TRAN_COUNT_10,                                      *00413000
                   TRAN_AMOUNT_10,                                     *00414000
                   TRAN_DATE_11,                                       *00415000
                   TRAN_COUNT_11,                                      *00416000
                   TRAN_AMOUNT_11,                                     *00417000
                   TRAN_DATE_12,                                       *00418000
                   TRAN_COUNT_12,                                      *00419000
                   TRAN_AMOUNT_12,                                     *00420000
                   RSV_AREA                                            *00421000
                   )                                                   *00422000
                  VALUES                                               *00423000
                   (                                                   *00424000
                   :INST,                                              *00425000
                   :PRDCDE,                                            *00426000
                   :ACCTNBR,                                           *00427000
                   :MODEL,                                             *00428000
                   :AUDDATE,                                           *00429000
                   :AUDTIME,                                           *00430000
                   :AUDUSER,                                           *00431000
                   :AUDORG,                                            *00432000
                   :GRACEDTE,                                          *00433000
                   :TRNDTE01,                                          *00434000
                   :TRNCNT01,                                          *00435000
                   :TRNAMT01,                                          *00436000
                   :TRNDTE02,                                          *00437000
                   :TRNCNT02,                                          *00438000
                   :TRNAMT02,                                          *00439000
                   :TRNDTE03,                                          *00440000
                   :TRNCNT03,                                          *00441000
                   :TRNAMT03,                                          *00442000
                   :TRNDTE04,                                          *00443000
                   :TRNCNT04,                                          *00444000
                   :TRNAMT04,                                          *00445000
                   :TRNDTE05,                                          *00446000
                   :TRNCNT05,                                          *00447000
                   :TRNAMT05,                                          *00448000
                   :TRNDTE06,                                          *00449000
                   :TRNCNT06,                                          *00450000
                   :TRNAMT06,                                          *00451000
                   :TRNDTE07,                                          *00452000
                   :TRNCNT07,                                          *00453000
                   :TRNAMT07,                                          *00454000
                   :TRNDTE08,                                          *00455000
                   :TRNCNT08,                                          *00456000
                   :TRNAMT08,                                          *00457000
                   :TRNDTE09,                                          *00458000
                   :TRNCNT09,                                          *00459000
                   :TRNAMT09,                                          *00460000
                   :TRNDTE10,                                          *00461000
                   :TRNCNT10,                                          *00462000
                   :TRNAMT10,                                          *00463000
                   :TRNDTE11,                                          *00464000
                   :TRNCNT11,                                          *00465000
                   :TRNAMT11,                                          *00466000
                   :TRNDTE12,                                          *00467000
                   :TRNCNT12,                                          *00468000
                   :TRNAMT12,                                          *00469000
                   :RAREA                                              *00470000
                   )                                                    00471000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00472000
         BR    14                      RETURN TO CALLER                 00473000
         LTORG                                                          00474000
*                                                                       00475000
**********************************************************************  00476000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00477000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00478000
**********************************************************************  00479000
*                                                                       00480000
UPDUC0   DS    0H                                                       00481000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00482000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00483000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00484000
         BALR  14,15                   MOVE REQUESTED DATA              00485000
         B     *+6                     BRANCH AROUND ADCON              00486000
BASUPD0  DC    AL2(4096)                                                00487000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00488000
         AH    3,BASUPD0               ADD 4K                           00489000
         EXEC  SQL UPDATE SAL                                          *00490000
                   SET                                                 *00491000
                     AUDIT_DATE = :AUDDATE,                            *00492000
                     AUDIT_TIME = :AUDTIME,                            *00493000
                     AUDIT_USER = :AUDUSER,                            *00494000
                     AUDIT_ORG = :AUDORG,                              *00495000
                     GRACE_EXP_DATE = :GRACEDTE,                       *00496000
                     TRAN_DATE_01 = :TRNDTE01,                         *00497000
                     TRAN_COUNT_01 = :TRNCNT01,                        *00498000
                     TRAN_AMOUNT_01 = :TRNAMT01,                       *00499000
                     TRAN_DATE_02 = :TRNDTE02,                         *00500000
                     TRAN_COUNT_02 = :TRNCNT02,                        *00501000
                     TRAN_AMOUNT_02 = :TRNAMT02,                       *00502000
                     TRAN_DATE_03 = :TRNDTE03,                         *00503000
                     TRAN_COUNT_03 = :TRNCNT03,                        *00504000
                     TRAN_AMOUNT_03 = :TRNAMT03,                       *00505000
                     TRAN_DATE_04 = :TRNDTE04,                         *00506000
                     TRAN_COUNT_04 = :TRNCNT04,                        *00507000
                     TRAN_AMOUNT_04 = :TRNAMT04,                       *00508000
                     TRAN_DATE_05 = :TRNDTE05,                         *00509000
                     TRAN_COUNT_05 = :TRNCNT05,                        *00510000
                     TRAN_AMOUNT_05 = :TRNAMT05,                       *00511000
                     TRAN_DATE_06 = :TRNDTE06,                         *00512000
                     TRAN_COUNT_06 = :TRNCNT06,                        *00513000
                     TRAN_AMOUNT_06 = :TRNAMT06,                       *00514000
                     TRAN_DATE_07 = :TRNDTE07,                         *00515000
                     TRAN_COUNT_07 = :TRNCNT07,                        *00516000
                     TRAN_AMOUNT_07 = :TRNAMT07,                       *00517000
                     TRAN_DATE_08 = :TRNDTE08,                         *00518000
                     TRAN_COUNT_08 = :TRNCNT08,                        *00519000
                     TRAN_AMOUNT_08 = :TRNAMT08,                       *00520000
                     TRAN_DATE_09 = :TRNDTE09,                         *00521000
                     TRAN_COUNT_09 = :TRNCNT09,                        *00522000
                     TRAN_AMOUNT_09 = :TRNAMT09,                       *00523000
                     TRAN_DATE_10 = :TRNDTE10,                         *00524000
                     TRAN_COUNT_10 = :TRNCNT10,                        *00525000
                     TRAN_AMOUNT_10 = :TRNAMT10,                       *00526000
                     TRAN_DATE_11 = :TRNDTE11,                         *00527000
                     TRAN_COUNT_11 = :TRNCNT11,                        *00528000
                     TRAN_AMOUNT_11 = :TRNAMT11,                       *00529000
                     TRAN_DATE_12 = :TRNDTE12,                         *00530000
                     TRAN_COUNT_12 = :TRNCNT12,                        *00531000
                     TRAN_AMOUNT_12 = :TRNAMT12,                       *00532000
                     RSV_AREA = :RAREA                                 *00533000
                 WHERE CURRENT OF SALUPD0                               00534000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00535000
         BR    14                      RETURN TO CALLER                 00536000
         LTORG                                                          00537000
*                                                                       00538000
**********************************************************************  00539000
* DELETE STATEMENT BY PRIMARY KEY:                                      00540000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00541000
**********************************************************************  00542000
*                                                                       00543000
DELUC0   DS    0H                                                       00544000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00545000
         EXEC  SQL DELETE FROM SAL                                     *00546000
                 WHERE CURRENT OF SALUPD0                               00547000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00548000
         BR    14                      RETURN TO CALLER                 00549000
         LTORG                                                          00550000
*                                                                       00551000
**********************************************************************  00552000
* DELETE ALL STATEMENT:                                                 00553000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00554000
**********************************************************************  00555000
*                                                                       00556000
DELTBL   DS    0H                                                       00557000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00558000
         EXEC  SQL DELETE FROM SAL                                      00559000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00560000
         BR    14                      RETURN TO CALLER                 00561000
         LTORG                                                          00562000
*                                                                       00563000
**********************************************************************  00564000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00565000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00566000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00567000
*     TO CLOSE THE UPDATE CURSOR.                                       00568000
**********************************************************************  00569000
*                                                                       00570000
CLSUC0   DS    0H                                                       00571000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00572000
         EXEC  SQL CLOSE SALUPD0                                        00573000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00574000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00575000
         BR    14                      RETURN TO CALLER                 00576000
         LTORG                                                          00577000
*                                                                       00578000
**********************************************************************  00579000
* ALTERNATE KEY 1 NOT DEFINED                                           00580000
**********************************************************************  00581000
*                                                                       00582000
SELUC1   DS    0H                                                       00583000
FETUC1   DS    0H                                                       00584000
UPDUC1   DS    0H                                                       00585000
DELUC1   DS    0H                                                       00586000
CLSUC1   DS    0H                                                       00587000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00588000
*                                                                       00589000
**********************************************************************  00590000
* ALTERNATE KEY 2 NOT DEFINED                                           00591000
**********************************************************************  00592000
*                                                                       00593000
SELUC2   DS    0H                                                       00594000
FETUC2   DS    0H                                                       00595000
UPDUC2   DS    0H                                                       00596000
DELUC2   DS    0H                                                       00597000
CLSUC2   DS    0H                                                       00598000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00599000
*                                                                       00600000
**********************************************************************  00601000
* ALTERNATE KEY 3 NOT DEFINED                                           00602000
**********************************************************************  00603000
*                                                                       00604000
SELUC3   DS    0H                                                       00605000
FETUC3   DS    0H                                                       00606000
UPDUC3   DS    0H                                                       00607000
DELUC3   DS    0H                                                       00608000
CLSUC3   DS    0H                                                       00609000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00610000
*                                                                       00611000
         DS    0H                      END OF SQL STATEMENTS            00612000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00613000
*                                                                       00614000
**********************************************************************  00615000
* DUMMY ENTRY POINT DSNHLI                                              00616000
**********************************************************************  00617000
*                                                                       00618000
         ENTRY DSNHLI                                                   00619000
DSNHLI   DS    0H                                                       00620000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00621000
         BR    15                      BRANCH TO ATTACH FACILITY        00622000
*                                                                       00623000
**********************************************************************  00624000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00625000
**********************************************************************  00626000
*                                                                       00627000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00628000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00629000
* OR:                                                                   00630000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00631000
* WHERE:                                                                00632000
*   RRRR = RECORD AREA OFFSET                                           00633000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00634000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00635000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00636000
*   KK   = KEY FIELD MASK:                                              00637000
*            80 = KEY 0 FIELD                                           00638000
*            40 = KEY 1 FIELD                                           00639000
*            20 = KEY 2 FIELD                                           00640000
*            10 = KEY 3 FIELD                                           00641000
*   DD   = DATA FIELD MASK:                                             00642000
*            80 = RECORD FIELD IS PACKED                                00643000
*            40 = HOST VARIABLE IS PACKED                               00644000
*            20 = NULLABLE FIELD                                        00645000
*            01 = DATE FIELD                                            00646000
*            02 = TIME FIELD                                            00647000
*                                                                       00648000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00649000
         DC    H'0000',H'0000',H'0038',X'80',X'00'                      00650000
         DC    H'0038',H'0038',H'0259',X'00',X'00'                      00651000
         DC    8X'FF'                                                   00652000
*                                                                       00653000
         LTORG                                                          00654000
         END                                                            00655000
