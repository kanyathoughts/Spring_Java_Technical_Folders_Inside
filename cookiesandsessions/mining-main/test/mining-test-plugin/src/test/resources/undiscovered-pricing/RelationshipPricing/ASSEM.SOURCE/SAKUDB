**********************************************************************  00001000
*                                                                       00002000
*  SAKUDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAK TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST1    DS    CL4                                                      00050000
PRDCDE1  DS    CL6                                                      00051000
ACCTNBR1 DS    CL18                                                     00052000
MODEL1   DS    CL10                                                     00053000
INST2    DS    CL4                                                      00054000
PRDCDE2  DS    CL6                                                      00055000
ACCTNBR2 DS    CL18                                                     00056000
AUDDATE  DS    PL5'0.'                                                  00057000
AUDTIME  DS    PL5'0.'                                                  00058000
AUDUSER  DS    CL8                                                      00059000
AUDORG   DS    CL6                                                      00060000
IDNBR    DS    CL18                                                     00061000
BALOPT   DS    CL1                                                      00062000
PCTUSED  DS    PL5'0.000000000'                                         00063000
LCMBUSED DS    PL8'0.00'                                                00064000
FREQ     DS    CL1                                                      00065000
TERM     DS    PL2'0.'                                                  00066000
DAYMTH   DS    CL2                                                      00067000
NEXTDATE DS    PL5'0.'                                                  00068000
LASTDATE DS    PL5'0.'                                                  00069000
AMT      DS    PL6'0.00'                                                00070000
LASTAMT  DS    PL6'0.00'                                                00071000
AMTYTD   DS    PL8'0.00'                                                00072000
CMBBAL01 DS    PL8'0.00'                                                00073000
CMBBAL02 DS    PL8'0.00'                                                00074000
CMBBAL03 DS    PL8'0.00'                                                00075000
CMBBAL04 DS    PL8'0.00'                                                00076000
CMBBAL05 DS    PL8'0.00'                                                00077000
CMBBAL06 DS    PL8'0.00'                                                00078000
CMBBAL07 DS    PL8'0.00'                                                00079000
CMBBAL08 DS    PL8'0.00'                                                00080000
CMBBAL09 DS    PL8'0.00'                                                00081000
CMBBAL10 DS    PL8'0.00'                                                00082000
CMBBAL11 DS    PL8'0.00'                                                00083000
CMBBAL12 DS    PL8'0.00'                                                00084000
DATEOPN  DS    PL5'0.'                                                  00085000
RAREA    DS    CL45                                                     00086000
*                                                                       00087000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00088000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00089000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00090000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00091000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00092000
         DS    CL97                    RESERVED                         00093000
*                                                                       00094000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00095000
INDVARX  DS    0H                                                       00096000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00097000
*                                                                       00098000
*                                                                       00099000
**********************************************************************  00100000
* PROGRAM TABLE HEADER SECTION:                                         00101000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00102000
**********************************************************************  00103000
*                                                                       00104000
SAKUDB   CSECT                         PROGRAM TABLE SECTION            00105000
SAKUDB   AMODE ANY                                                      00106000
SAKUDB   RMODE ANY                                                      00107000
         DC    CL8'SAKUDB  '           PROGRAM ID                       00108000
         DC    CL1' '                                                   00109000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00110000
         DC    CL1' '                                                   00111000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00112000
         DC    CL1' '                                                   00113000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00114000
         DC    5A(0)                   RESERVED                         00115000
         DC    AL2(0)                  RESERVED                         00116000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00117000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00118000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00119000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00120000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00121000
         DC    CL29'WWW.INFOR.COM                '                      00121001
*                                                                       00122000
**********************************************************************  00123000
* STATEMENT TABLE SECTION:                                              00124000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00125000
**********************************************************************  00126000
*                                                                       00127000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00128000
STM#TAB  AMODE ANY                                                      00129000
STM#TAB  RMODE ANY                                                      00130000
         DC    4A(0)                   RDB MODULE VECTORS               00131000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00132000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00133000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00134000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00135000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00136000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00137000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00138000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00139000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00140000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00141000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00142000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00143000
         DC    20A(0)                  RDB MODULE VECTORS               00144000
         DC    A(INSROW)               INSERT STATEMENT                 00145000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00146000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00147000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00148000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00149000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00150000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00151000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00152000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00153000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00154000
         DC    4X'FF'                                                   00155000
*                                                                       00156000
**********************************************************************  00157000
* SQL STATEMENT SECTION:                                                00158000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00159000
*     TO SUPPORT THIS TABLE.                                            00160000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00161000
*     ARE EQUIVALENT.                                                   00162000
**********************************************************************  00163000
*                                                                       00164000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00165000
SQL#STMT AMODE ANY                                                      00166000
SQL#STMT RMODE ANY                                                      00167000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00168000
         USING COM#AREA,11             ADDRESS COMMAREA                 00169000
*                                                                       00170000
**********************************************************************  00171000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00172000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00173000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00174000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00175000
**********************************************************************  00176000
*                                                                       00177000
SELUC0   DS    0H                                                       00178000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00179000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00180000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00181000
         BALR  14,15                   MOVE REQUESTED DATA              00182000
         EXEC  SQL DECLARE SAKUPD0 CURSOR                              *00183000
               FOR SELECT                                              *00184000
                   AUDIT_DATE,                                         *00185000
                   AUDIT_TIME,                                         *00186000
                   AUDIT_USER,                                         *00187000
                   AUDIT_ORG,                                          *00188000
                   IDENT_NBR,                                          *00189000
                   BAL_OPT,                                            *00190000
                   PCT_USED,                                           *00191000
                   LST_CMB_BAL_USE,                                    *00192000
                   FREQUENCY,                                          *00193000
                   TERM,                                               *00194000
                   DAY_MONTH,                                          *00195000
                   NEXT_DATE,                                          *00196000
                   LAST_DATE,                                          *00197000
                   AMOUNT,                                             *00198000
                   LAST_AMT,                                           *00199000
                   AMOUNT_YTD,                                         *00200000
                   MTH_CMB_BAL_01,                                     *00201000
                   MTH_CMB_BAL_02,                                     *00202000
                   MTH_CMB_BAL_03,                                     *00203000
                   MTH_CMB_BAL_04,                                     *00204000
                   MTH_CMB_BAL_05,                                     *00205000
                   MTH_CMB_BAL_06,                                     *00206000
                   MTH_CMB_BAL_07,                                     *00207000
                   MTH_CMB_BAL_08,                                     *00208000
                   MTH_CMB_BAL_09,                                     *00209000
                   MTH_CMB_BAL_10,                                     *00210000
                   MTH_CMB_BAL_11,                                     *00211000
                   MTH_CMB_BAL_12,                                     *00212000
                   DATE_OPEN,                                          *00213000
                   RSV_AREA                                            *00214000
                 FROM SAK                                              *00215000
                 WHERE                                                 *00216000
                   ACCT_INST_1 = :INST1 AND                            *00217000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00218000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00219000
                   MODEL_1 = :MODEL1 AND                               *00220000
                   ACCT_INST_2 = :INST2 AND                            *00221000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00222000
                   ACCT_NBR_2 = :ACCTNBR2                              *00223000
                 FOR UPDATE OF                                         *00224000
                   AUDIT_DATE,                                         *00225000
                   AUDIT_TIME,                                         *00226000
                   AUDIT_USER,                                         *00227000
                   AUDIT_ORG,                                          *00228000
                   IDENT_NBR,                                          *00229000
                   BAL_OPT,                                            *00230000
                   PCT_USED,                                           *00231000
                   LST_CMB_BAL_USE,                                    *00232000
                   FREQUENCY,                                          *00233000
                   TERM,                                               *00234000
                   DAY_MONTH,                                          *00235000
                   NEXT_DATE,                                          *00236000
                   LAST_DATE,                                          *00237000
                   AMOUNT,                                             *00238000
                   LAST_AMT,                                           *00239000
                   AMOUNT_YTD,                                         *00240000
                   MTH_CMB_BAL_01,                                     *00241000
                   MTH_CMB_BAL_02,                                     *00242000
                   MTH_CMB_BAL_03,                                     *00243000
                   MTH_CMB_BAL_04,                                     *00244000
                   MTH_CMB_BAL_05,                                     *00245000
                   MTH_CMB_BAL_06,                                     *00246000
                   MTH_CMB_BAL_07,                                     *00247000
                   MTH_CMB_BAL_08,                                     *00248000
                   MTH_CMB_BAL_09,                                     *00249000
                   MTH_CMB_BAL_10,                                     *00250000
                   MTH_CMB_BAL_11,                                     *00251000
                   MTH_CMB_BAL_12,                                     *00252000
                   DATE_OPEN,                                          *00253000
                   RSV_AREA                                            *00254000
                 FETCH FIRST 1 ROW ONLY                                 00255000
         EXEC  SQL OPEN SAKUPD0                                         00256000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00257000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00258000
         BR    14                      RETURN TO CALLER                 00259000
         LTORG                                                          00260000
*                                                                       00261000
**********************************************************************  00262000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00263000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00264000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00265000
*     THE ACTUAL ROW.                                                   00266000
**********************************************************************  00267000
*                                                                       00268000
FETUC0   DS    0H                                                       00269000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00270000
         EXEC  SQL FETCH SAKUPD0                                       *00271000
                 INTO                                                  *00272000
                   :AUDDATE,                                           *00273000
                   :AUDTIME,                                           *00274000
                   :AUDUSER,                                           *00275000
                   :AUDORG,                                            *00276000
                   :IDNBR,                                             *00277000
                   :BALOPT,                                            *00278000
                   :PCTUSED,                                           *00279000
                   :LCMBUSED,                                          *00280000
                   :FREQ,                                              *00281000
                   :TERM,                                              *00282000
                   :DAYMTH,                                            *00283000
                   :NEXTDATE,                                          *00284000
                   :LASTDATE,                                          *00285000
                   :AMT,                                               *00286000
                   :LASTAMT,                                           *00287000
                   :AMTYTD,                                            *00288000
                   :CMBBAL01,                                          *00289000
                   :CMBBAL02,                                          *00290000
                   :CMBBAL03,                                          *00291000
                   :CMBBAL04,                                          *00292000
                   :CMBBAL05,                                          *00293000
                   :CMBBAL06,                                          *00294000
                   :CMBBAL07,                                          *00295000
                   :CMBBAL08,                                          *00296000
                   :CMBBAL09,                                          *00297000
                   :CMBBAL10,                                          *00298000
                   :CMBBAL11,                                          *00299000
                   :CMBBAL12,                                          *00300000
                   :DATEOPN,                                           *00301000
                   :RAREA                                               00302000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00303000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00304000
         BALR  14,15                   MOVE REQUESTED DATA              00305000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00306000
         BR    14                      RETURN TO CALLER                 00307000
         LTORG                                                          00308000
*                                                                       00309000
**********************************************************************  00310000
* INSERT STATEMENT:                                                     00311000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00312000
**********************************************************************  00313000
*                                                                       00314000
INSROW   DS    0H                                                       00315000
         USING INSROW,12               ESTABLISH BASE REGISTER          00316000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00317000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00318000
         BALR  14,15                   MOVE REQUESTED DATA              00319000
         EXEC  SQL INSERT INTO SAK                                     *00320000
                   (                                                   *00321000
                   ACCT_INST_1,                                        *00322000
                   PROD_CODE_1,                                        *00323000
                   ACCT_NBR_1,                                         *00324000
                   MODEL_1,                                            *00325000
                   ACCT_INST_2,                                        *00326000
                   PROD_CODE_2,                                        *00327000
                   ACCT_NBR_2,                                         *00328000
                   AUDIT_DATE,                                         *00329000
                   AUDIT_TIME,                                         *00330000
                   AUDIT_USER,                                         *00331000
                   AUDIT_ORG,                                          *00332000
                   IDENT_NBR,                                          *00333000
                   BAL_OPT,                                            *00334000
                   PCT_USED,                                           *00335000
                   LST_CMB_BAL_USE,                                    *00336000
                   FREQUENCY,                                          *00337000
                   TERM,                                               *00338000
                   DAY_MONTH,                                          *00339000
                   NEXT_DATE,                                          *00340000
                   LAST_DATE,                                          *00341000
                   AMOUNT,                                             *00342000
                   LAST_AMT,                                           *00343000
                   AMOUNT_YTD,                                         *00344000
                   MTH_CMB_BAL_01,                                     *00345000
                   MTH_CMB_BAL_02,                                     *00346000
                   MTH_CMB_BAL_03,                                     *00347000
                   MTH_CMB_BAL_04,                                     *00348000
                   MTH_CMB_BAL_05,                                     *00349000
                   MTH_CMB_BAL_06,                                     *00350000
                   MTH_CMB_BAL_07,                                     *00351000
                   MTH_CMB_BAL_08,                                     *00352000
                   MTH_CMB_BAL_09,                                     *00353000
                   MTH_CMB_BAL_10,                                     *00354000
                   MTH_CMB_BAL_11,                                     *00355000
                   MTH_CMB_BAL_12,                                     *00356000
                   DATE_OPEN,                                          *00357000
                   RSV_AREA                                            *00358000
                   )                                                   *00359000
                  VALUES                                               *00360000
                   (                                                   *00361000
                   :INST1,                                             *00362000
                   :PRDCDE1,                                           *00363000
                   :ACCTNBR1,                                          *00364000
                   :MODEL1,                                            *00365000
                   :INST2,                                             *00366000
                   :PRDCDE2,                                           *00367000
                   :ACCTNBR2,                                          *00368000
                   :AUDDATE,                                           *00369000
                   :AUDTIME,                                           *00370000
                   :AUDUSER,                                           *00371000
                   :AUDORG,                                            *00372000
                   :IDNBR,                                             *00373000
                   :BALOPT,                                            *00374000
                   :PCTUSED,                                           *00375000
                   :LCMBUSED,                                          *00376000
                   :FREQ,                                              *00377000
                   :TERM,                                              *00378000
                   :DAYMTH,                                            *00379000
                   :NEXTDATE,                                          *00380000
                   :LASTDATE,                                          *00381000
                   :AMT,                                               *00382000
                   :LASTAMT,                                           *00383000
                   :AMTYTD,                                            *00384000
                   :CMBBAL01,                                          *00385000
                   :CMBBAL02,                                          *00386000
                   :CMBBAL03,                                          *00387000
                   :CMBBAL04,                                          *00388000
                   :CMBBAL05,                                          *00389000
                   :CMBBAL06,                                          *00390000
                   :CMBBAL07,                                          *00391000
                   :CMBBAL08,                                          *00392000
                   :CMBBAL09,                                          *00393000
                   :CMBBAL10,                                          *00394000
                   :CMBBAL11,                                          *00395000
                   :CMBBAL12,                                          *00396000
                   :DATEOPN,                                           *00397000
                   :RAREA                                              *00398000
                   )                                                    00399000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00400000
         BR    14                      RETURN TO CALLER                 00401000
         LTORG                                                          00402000
*                                                                       00403000
**********************************************************************  00404000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00405000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00406000
**********************************************************************  00407000
*                                                                       00408000
UPDUC0   DS    0H                                                       00409000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00410000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00411000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00412000
         BALR  14,15                   MOVE REQUESTED DATA              00413000
         EXEC  SQL UPDATE SAK                                          *00414000
                   SET                                                 *00415000
                     AUDIT_DATE = :AUDDATE,                            *00416000
                     AUDIT_TIME = :AUDTIME,                            *00417000
                     AUDIT_USER = :AUDUSER,                            *00418000
                     AUDIT_ORG = :AUDORG,                              *00419000
                     IDENT_NBR = :IDNBR,                               *00420000
                     BAL_OPT = :BALOPT,                                *00421000
                     PCT_USED = :PCTUSED,                              *00422000
                     LST_CMB_BAL_USE = :LCMBUSED,                      *00423000
                     FREQUENCY = :FREQ,                                *00424000
                     TERM = :TERM,                                     *00425000
                     DAY_MONTH = :DAYMTH,                              *00426000
                     NEXT_DATE = :NEXTDATE,                            *00427000
                     LAST_DATE = :LASTDATE,                            *00428000
                     AMOUNT = :AMT,                                    *00429000
                     LAST_AMT = :LASTAMT,                              *00430000
                     AMOUNT_YTD = :AMTYTD,                             *00431000
                     MTH_CMB_BAL_01 = :CMBBAL01,                       *00432000
                     MTH_CMB_BAL_02 = :CMBBAL02,                       *00433000
                     MTH_CMB_BAL_03 = :CMBBAL03,                       *00434000
                     MTH_CMB_BAL_04 = :CMBBAL04,                       *00435000
                     MTH_CMB_BAL_05 = :CMBBAL05,                       *00436000
                     MTH_CMB_BAL_06 = :CMBBAL06,                       *00437000
                     MTH_CMB_BAL_07 = :CMBBAL07,                       *00438000
                     MTH_CMB_BAL_08 = :CMBBAL08,                       *00439000
                     MTH_CMB_BAL_09 = :CMBBAL09,                       *00440000
                     MTH_CMB_BAL_10 = :CMBBAL10,                       *00441000
                     MTH_CMB_BAL_11 = :CMBBAL11,                       *00442000
                     MTH_CMB_BAL_12 = :CMBBAL12,                       *00443000
                     DATE_OPEN = :DATEOPN,                             *00444000
                     RSV_AREA = :RAREA                                 *00445000
                 WHERE CURRENT OF SAKUPD0                               00446000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00447000
         BR    14                      RETURN TO CALLER                 00448000
         LTORG                                                          00449000
*                                                                       00450000
**********************************************************************  00451000
* DELETE STATEMENT BY PRIMARY KEY:                                      00452000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00453000
**********************************************************************  00454000
*                                                                       00455000
DELUC0   DS    0H                                                       00456000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00457000
         EXEC  SQL DELETE FROM SAK                                     *00458000
                 WHERE CURRENT OF SAKUPD0                               00459000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00460000
         BR    14                      RETURN TO CALLER                 00461000
         LTORG                                                          00462000
*                                                                       00463000
**********************************************************************  00464000
* DELETE ALL STATEMENT:                                                 00465000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00466000
**********************************************************************  00467000
*                                                                       00468000
DELTBL   DS    0H                                                       00469000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00470000
         EXEC  SQL DELETE FROM SAK                                      00471000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00472000
         BR    14                      RETURN TO CALLER                 00473000
         LTORG                                                          00474000
*                                                                       00475000
**********************************************************************  00476000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00477000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00478000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00479000
*     TO CLOSE THE UPDATE CURSOR.                                       00480000
**********************************************************************  00481000
*                                                                       00482000
CLSUC0   DS    0H                                                       00483000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00484000
         EXEC  SQL CLOSE SAKUPD0                                        00485000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00486000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00487000
         BR    14                      RETURN TO CALLER                 00488000
         LTORG                                                          00489000
*                                                                       00490000
**********************************************************************  00491000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00492000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00493000
**********************************************************************  00494000
*                                                                       00495000
SELUC1   DS    0H                                                       00496000
         USING SELUC1,12               ESTABLISH BASE REGISTER          00497000
         MVI   SQWKMRP,X'40'           MOVE RECORD TO HOST FOR KEY 1    00498000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00499000
         BALR  14,15                   MOVE REQUESTED DATA              00500000
         EXEC  SQL DECLARE SAKUPD1 CURSOR                              *00501000
               FOR SELECT                                              *00502000
                   ACCT_INST_1,                                        *00503000
                   PROD_CODE_1,                                        *00504000
                   ACCT_NBR_1,                                         *00505000
                   MODEL_1,                                            *00506000
                   ACCT_INST_2,                                        *00507000
                   PROD_CODE_2,                                        *00508000
                   ACCT_NBR_2,                                         *00509000
                   AUDIT_DATE,                                         *00510000
                   AUDIT_TIME,                                         *00511000
                   AUDIT_USER,                                         *00512000
                   AUDIT_ORG,                                          *00513000
                   IDENT_NBR,                                          *00514000
                   BAL_OPT,                                            *00515000
                   PCT_USED,                                           *00516000
                   LST_CMB_BAL_USE,                                    *00517000
                   FREQUENCY,                                          *00518000
                   TERM,                                               *00519000
                   DAY_MONTH,                                          *00520000
                   NEXT_DATE,                                          *00521000
                   LAST_DATE,                                          *00522000
                   AMOUNT,                                             *00523000
                   LAST_AMT,                                           *00524000
                   AMOUNT_YTD,                                         *00525000
                   MTH_CMB_BAL_01,                                     *00526000
                   MTH_CMB_BAL_02,                                     *00527000
                   MTH_CMB_BAL_03,                                     *00528000
                   MTH_CMB_BAL_04,                                     *00529000
                   MTH_CMB_BAL_05,                                     *00530000
                   MTH_CMB_BAL_06,                                     *00531000
                   MTH_CMB_BAL_07,                                     *00532000
                   MTH_CMB_BAL_08,                                     *00533000
                   MTH_CMB_BAL_09,                                     *00534000
                   MTH_CMB_BAL_10,                                     *00535000
                   MTH_CMB_BAL_11,                                     *00536000
                   MTH_CMB_BAL_12,                                     *00537000
                   DATE_OPEN,                                          *00538000
                   RSV_AREA                                            *00539000
                 FROM SAK                                              *00540000
                 WHERE                                                 *00541000
                   ACCT_INST_2 = :INST2 AND                            *00542000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00543000
                   ACCT_NBR_2 = :ACCTNBR2                              *00544000
                 FOR UPDATE OF                                         *00545000
                   AUDIT_DATE,                                         *00546000
                   AUDIT_TIME,                                         *00547000
                   AUDIT_USER,                                         *00548000
                   AUDIT_ORG,                                          *00549000
                   IDENT_NBR,                                          *00550000
                   BAL_OPT,                                            *00551000
                   PCT_USED,                                           *00552000
                   LST_CMB_BAL_USE,                                    *00553000
                   FREQUENCY,                                          *00554000
                   TERM,                                               *00555000
                   DAY_MONTH,                                          *00556000
                   NEXT_DATE,                                          *00557000
                   LAST_DATE,                                          *00558000
                   AMOUNT,                                             *00559000
                   LAST_AMT,                                           *00560000
                   AMOUNT_YTD,                                         *00561000
                   MTH_CMB_BAL_01,                                     *00562000
                   MTH_CMB_BAL_02,                                     *00563000
                   MTH_CMB_BAL_03,                                     *00564000
                   MTH_CMB_BAL_04,                                     *00565000
                   MTH_CMB_BAL_05,                                     *00566000
                   MTH_CMB_BAL_06,                                     *00567000
                   MTH_CMB_BAL_07,                                     *00568000
                   MTH_CMB_BAL_08,                                     *00569000
                   MTH_CMB_BAL_09,                                     *00570000
                   MTH_CMB_BAL_10,                                     *00571000
                   MTH_CMB_BAL_11,                                     *00572000
                   MTH_CMB_BAL_12,                                     *00573000
                   DATE_OPEN,                                          *00574000
                   RSV_AREA                                            *00575000
                 FETCH FIRST 1 ROW ONLY                                 00576000
         EXEC  SQL OPEN SAKUPD1                                         00577000
         MVC   SQWCSUCA,=A(CLSUC1)     SET CURSOR CLOSE ROUTINE ADDRESS 00578000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00579000
         BR    14                      RETURN TO CALLER                 00580000
         LTORG                                                          00581000
*                                                                       00582000
**********************************************************************  00583000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00584000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00585000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00586000
*     THE ACTUAL ROW.                                                   00587000
**********************************************************************  00588000
*                                                                       00589000
FETUC1   DS    0H                                                       00590000
         USING FETUC1,12               ESTABLISH BASE REGISTER          00591000
         EXEC  SQL FETCH SAKUPD1                                       *00592000
                 INTO                                                  *00593000
                   :INST1,                                             *00594000
                   :PRDCDE1,                                           *00595000
                   :ACCTNBR1,                                          *00596000
                   :MODEL1,                                            *00597000
                   :INST2,                                             *00598000
                   :PRDCDE2,                                           *00599000
                   :ACCTNBR2,                                          *00600000
                   :AUDDATE,                                           *00601000
                   :AUDTIME,                                           *00602000
                   :AUDUSER,                                           *00603000
                   :AUDORG,                                            *00604000
                   :IDNBR,                                             *00605000
                   :BALOPT,                                            *00606000
                   :PCTUSED,                                           *00607000
                   :LCMBUSED,                                          *00608000
                   :FREQ,                                              *00609000
                   :TERM,                                              *00610000
                   :DAYMTH,                                            *00611000
                   :NEXTDATE,                                          *00612000
                   :LASTDATE,                                          *00613000
                   :AMT,                                               *00614000
                   :LASTAMT,                                           *00615000
                   :AMTYTD,                                            *00616000
                   :CMBBAL01,                                          *00617000
                   :CMBBAL02,                                          *00618000
                   :CMBBAL03,                                          *00619000
                   :CMBBAL04,                                          *00620000
                   :CMBBAL05,                                          *00621000
                   :CMBBAL06,                                          *00622000
                   :CMBBAL07,                                          *00623000
                   :CMBBAL08,                                          *00624000
                   :CMBBAL09,                                          *00625000
                   :CMBBAL10,                                          *00626000
                   :CMBBAL11,                                          *00627000
                   :CMBBAL12,                                          *00628000
                   :DATEOPN,                                           *00629000
                   :RAREA                                               00630000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00631000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00632000
         BALR  14,15                   MOVE REQUESTED DATA              00633000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00634000
         BR    14                      RETURN TO CALLER                 00635000
         LTORG                                                          00636000
*                                                                       00637000
**********************************************************************  00638000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  00639000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00640000
**********************************************************************  00641000
*                                                                       00642000
UPDUC1   DS    0H                                                       00643000
         USING UPDUC1,12               ESTABLISH BASE REGISTER          00644000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00645000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00646000
         BALR  14,15                   MOVE REQUESTED DATA              00647000
         EXEC  SQL UPDATE SAK                                          *00648000
                   SET                                                 *00649000
                     AUDIT_DATE = :AUDDATE,                            *00650000
                     AUDIT_TIME = :AUDTIME,                            *00651000
                     AUDIT_USER = :AUDUSER,                            *00652000
                     AUDIT_ORG = :AUDORG,                              *00653000
                     IDENT_NBR = :IDNBR,                               *00654000
                     BAL_OPT = :BALOPT,                                *00655000
                     PCT_USED = :PCTUSED,                              *00656000
                     LST_CMB_BAL_USE = :LCMBUSED,                      *00657000
                     FREQUENCY = :FREQ,                                *00658000
                     TERM = :TERM,                                     *00659000
                     DAY_MONTH = :DAYMTH,                              *00660000
                     NEXT_DATE = :NEXTDATE,                            *00661000
                     LAST_DATE = :LASTDATE,                            *00662000
                     AMOUNT = :AMT,                                    *00663000
                     LAST_AMT = :LASTAMT,                              *00664000
                     AMOUNT_YTD = :AMTYTD,                             *00665000
                     MTH_CMB_BAL_01 = :CMBBAL01,                       *00666000
                     MTH_CMB_BAL_02 = :CMBBAL02,                       *00667000
                     MTH_CMB_BAL_03 = :CMBBAL03,                       *00668000
                     MTH_CMB_BAL_04 = :CMBBAL04,                       *00669000
                     MTH_CMB_BAL_05 = :CMBBAL05,                       *00670000
                     MTH_CMB_BAL_06 = :CMBBAL06,                       *00671000
                     MTH_CMB_BAL_07 = :CMBBAL07,                       *00672000
                     MTH_CMB_BAL_08 = :CMBBAL08,                       *00673000
                     MTH_CMB_BAL_09 = :CMBBAL09,                       *00674000
                     MTH_CMB_BAL_10 = :CMBBAL10,                       *00675000
                     MTH_CMB_BAL_11 = :CMBBAL11,                       *00676000
                     MTH_CMB_BAL_12 = :CMBBAL12,                       *00677000
                     DATE_OPEN = :DATEOPN,                             *00678000
                     RSV_AREA = :RAREA                                 *00679000
                 WHERE CURRENT OF SAKUPD1                               00680000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00681000
         BR    14                      RETURN TO CALLER                 00682000
         LTORG                                                          00683000
*                                                                       00684000
**********************************************************************  00685000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  00686000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00687000
**********************************************************************  00688000
*                                                                       00689000
DELUC1   DS    0H                                                       00690000
         USING DELUC1,12               ESTABLISH BASE REGISTER          00691000
         EXEC  SQL DELETE FROM SAK                                     *00692000
                 WHERE CURRENT OF SAKUPD1                               00693000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00694000
         BR    14                      RETURN TO CALLER                 00695000
         LTORG                                                          00696000
*                                                                       00697000
**********************************************************************  00698000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00699000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00700000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00701000
*     TO CLOSE THE UPDATE CURSOR.                                       00702000
**********************************************************************  00703000
*                                                                       00704000
CLSUC1   DS    0H                                                       00705000
         USING CLSUC1,12               ESTABLISH BASE REGISTER          00706000
         EXEC  SQL CLOSE SAKUPD1                                        00707000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00708000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00709000
         BR    14                      RETURN TO CALLER                 00710000
         LTORG                                                          00711000
*                                                                       00712000
**********************************************************************  00713000
* ALTERNATE KEY 2 NOT DEFINED                                           00714000
**********************************************************************  00715000
*                                                                       00716000
SELUC2   DS    0H                                                       00717000
FETUC2   DS    0H                                                       00718000
UPDUC2   DS    0H                                                       00719000
DELUC2   DS    0H                                                       00720000
CLSUC2   DS    0H                                                       00721000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00722000
*                                                                       00723000
**********************************************************************  00724000
* ALTERNATE KEY 3 NOT DEFINED                                           00725000
**********************************************************************  00726000
*                                                                       00727000
SELUC3   DS    0H                                                       00728000
FETUC3   DS    0H                                                       00729000
UPDUC3   DS    0H                                                       00730000
DELUC3   DS    0H                                                       00731000
CLSUC3   DS    0H                                                       00732000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00733000
*                                                                       00734000
         DS    0H                      END OF SQL STATEMENTS            00735000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00736000
*                                                                       00737000
**********************************************************************  00738000
* DUMMY ENTRY POINT DSNHLI                                              00739000
**********************************************************************  00740000
*                                                                       00741000
         ENTRY DSNHLI                                                   00742000
DSNHLI   DS    0H                                                       00743000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00744000
         BR    15                      BRANCH TO ATTACH FACILITY        00745000
*                                                                       00746000
**********************************************************************  00747000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00748000
**********************************************************************  00749000
*                                                                       00750000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00751000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00752000
* OR:                                                                   00753000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00754000
* WHERE:                                                                00755000
*   RRRR = RECORD AREA OFFSET                                           00756000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00757000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00758000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00759000
*   KK   = KEY FIELD MASK:                                              00760000
*            80 = KEY 0 FIELD                                           00761000
*            40 = KEY 1 FIELD                                           00762000
*            20 = KEY 2 FIELD                                           00763000
*            10 = KEY 3 FIELD                                           00764000
*   DD   = DATA FIELD MASK:                                             00765000
*            80 = RECORD FIELD IS PACKED                                00766000
*            40 = HOST VARIABLE IS PACKED                               00767000
*            20 = NULLABLE FIELD                                        00768000
*            01 = DATE FIELD                                            00769000
*            02 = TIME FIELD                                            00770000
*                                                                       00771000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00772000
         DC    H'0000',H'0000',H'0038',X'80',X'00'                      00773000
         DC    H'0038',H'0038',H'0028',X'C0',X'00'                      00774000
         DC    H'0066',H'0066',H'0237',X'00',X'00'                      00775000
         DC    8X'FF'                                                   00776000
*                                                                       00777000
         LTORG                                                          00778000
         END                                                            00779000
