**********************************************************************  00001000
*                                                                       00002000
*  SAERDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAE TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
ZERONBR  DS    CL4                                                      00050000
AUDDATK  DS    CL9                                                      00051000
AUDTIMK  DS    CL7                                                      00052000
UNIQCDE  DS    CL4                                                      00053000
AUDTIMS  DS    CL2                                                      00054000
TRANSCD  DS    CL3                                                      00055000
INSTNBR  DS    CL4                                                      00056000
FORMATID DS    CL1                                                      00057000
LOGCODE  DS    CL1                                                      00058000
SEGID    DS    CL3                                                      00059000
FUNCCODE DS    CL1                                                      00060000
AUDUSER  DS    CL8                                                      00061000
RECLEN   DS    H                                                        00062000
TERMID   DS    CL8                                                      00063000
WORKID   DS    CL8                                                      00064000
PANELID  DS    CL8                                                      00065000
TRANBEG  DS    PL4'0.'                                                  00066000
APPLSEQ  DS    PL3'0.'                                                  00067000
DATA1    DS    CL250                                                    00068000
DATA2    DS    CL250                                                    00069000
DATA3    DS    CL12                                                     00070000
*                                                                       00071000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00072000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00073000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00074000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00075000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00076000
         DS    CL97                    RESERVED                         00077000
*                                                                       00078000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00079000
INDVARX  DS    0H                                                       00080000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00081000
*                                                                       00082000
*                                                                       00083000
**********************************************************************  00084000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00085000
**********************************************************************  00086000
*                                                                       00087000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00088000
*                                                                       00089000
**********************************************************************  00090000
* PROGRAM TABLE HEADER SECTION:                                         00091000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00092000
**********************************************************************  00093000
*                                                                       00094000
SAERDB   CSECT                         PROGRAM TABLE SECTION            00095000
SAERDB   AMODE ANY                                                      00096000
SAERDB   RMODE ANY                                                      00097000
         DC    CL8'SAERDB  '           PROGRAM ID                       00098000
         DC    CL1' '                                                   00099000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00100000
         DC    CL1' '                                                   00101000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00102000
         DC    CL1' '                                                   00103000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00104000
         DC    5A(0)                   RESERVED                         00105000
         DC    AL2(0)                  RESERVED                         00106000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00107000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00108000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00109000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00110000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00111000
         DC    CL29'WWW.INFOR.COM                '                      00111001
*                                                                       00112000
**********************************************************************  00113000
* STATEMENT TABLE SECTION:                                              00114000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00115000
**********************************************************************  00116000
*                                                                       00117000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00118000
STM#TAB  AMODE ANY                                                      00119000
STM#TAB  RMODE ANY                                                      00120000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00121000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00122000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00123000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00124000
         DC    12A(0)                  UDB MODULE VECTORS               00125000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00126000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00127000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00128000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00129000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00130000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00131000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00132000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00133000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00134000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00135000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00136000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00137000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00138000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00139000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00140000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00141000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00142000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00143000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00144000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00145000
         DC    10A(0)                  UDB MODULE VECTORS               00146000
         DC    4X'FF'                                                   00147000
*                                                                       00148000
**********************************************************************  00149000
* SQL STATEMENT SECTION:                                                00150000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00151000
*     TO SUPPORT THIS TABLE.                                            00152000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00153000
*     ARE EQUIVALENT.                                                   00154000
**********************************************************************  00155000
*                                                                       00156000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00157000
SQL#STMT AMODE ANY                                                      00158000
SQL#STMT RMODE ANY                                                      00159000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00160000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00161000
         USING COM#AREA,11             ADDRESS COMMAREA                 00162000
*                                                                       00163000
**********************************************************************  00164000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00165000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00166000
**********************************************************************  00167000
*                                                                       00168000
SELIN0   DS    0H                                                       00169000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00170000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00171000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00172000
         BALR  14,15                   MOVE REQUESTED DATA              00173000
         EXEC  SQL SELECT                                              *00174000
                   FUNC_CODE,                                          *00175000
                   AUDIT_USER,                                         *00176000
                   RECORD_LENGTH,                                      *00177000
                   TERMINAL_ID,                                        *00178000
                   WORK_ID,                                            *00179000
                   PANEL_ID,                                           *00180000
                   TRAN_BEGIN,                                         *00181000
                   APPLIC_SEQ,                                         *00182000
                   DATA_1,                                             *00183000
                   DATA_2,                                             *00184000
                   DATA_3                                              *00185000
                 INTO                                                  *00186000
                   :FUNCCODE,                                          *00187000
                   :AUDUSER,                                           *00188000
                   :RECLEN,                                            *00189000
                   :TERMID,                                            *00190000
                   :WORKID,                                            *00191000
                   :PANELID,                                           *00192000
                   :TRANBEG,                                           *00193000
                   :APPLSEQ,                                           *00194000
                   :DATA1,                                             *00195000
                   :DATA2,                                             *00196000
                   :DATA3                                              *00197000
                 FROM SAE                                              *00198000
                 WHERE                                                 *00199000
                   ZERO_NBR = :ZERONBR AND                             *00200000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00201000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00202000
                   UNIQUE_CODE = :UNIQCDE AND                          *00203000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00204000
                   TRAN_CODE = :TRANSCD AND                            *00205000
                   INST_NBR = :INSTNBR AND                             *00206000
                   FORMAT_ID = :FORMATID AND                           *00207000
                   LOG_CODE = :LOGCODE AND                             *00208000
                   SEGM_ID = :SEGID                                    *00209000
                 FETCH FIRST 1 ROW ONLY                                 00210000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00211000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00212000
         BALR  14,15                   MOVE REQUESTED DATA              00213000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00214000
         BR    14                      RETURN TO CALLER                 00215000
         LTORG                                                          00216000
*                                                                       00217000
**********************************************************************  00218000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00219000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00220000
**********************************************************************  00221000
*                                                                       00222000
SELKY0   DS    0H                                                       00223000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00224000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00225000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00226000
         BALR  14,15                   MOVE REQUESTED DATA              00227000
         EXEC  SQL SELECT                                              *00228000
                   COUNT(*)                                            *00229000
                 INTO                                                  *00230000
                   :SQWINTHV                                           *00231000
                 FROM SAE                                              *00232000
                 WHERE                                                 *00233000
                   ZERO_NBR = :ZERONBR AND                             *00234000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00235000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00236000
                   UNIQUE_CODE = :UNIQCDE AND                          *00237000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00238000
                   TRAN_CODE = :TRANSCD AND                            *00239000
                   INST_NBR = :INSTNBR AND                             *00240000
                   FORMAT_ID = :FORMATID AND                           *00241000
                   LOG_CODE = :LOGCODE AND                             *00242000
                   SEGM_ID = :SEGID                                    *00243000
                 FETCH FIRST 1 ROW ONLY                                 00244000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00245000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00246000
         BNER  14                      NO - RETURN TO CALLER            00247000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00248000
         BNER  14                      YES - RETURN ZERO SQLCODE        00249000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00250000
         BR    14                      RETURN TO CALLER                 00251000
         LTORG                                                          00252000
*                                                                       00253000
**********************************************************************  00254000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00255000
* KEY:                                                                  00256000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00257000
*     AND GET-NEXT-LOCK VERBS.                                          00258000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00259000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00260000
**********************************************************************  00261000
*                                                                       00262000
SELXC0   DS    0H                                                       00263000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00264000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00265000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00266000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00267000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00268000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00269000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00270000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00271000
SELXC0P  DC    A(SELGE001)                                              00272000
         DC    (KY0COLMS-01)A(0)                                        00273000
         DC    A(SELGE002)                                              00274000
         DC    (KY0COLMS-02)A(0)                                        00275000
         DC    A(SELGE003)                                              00276000
         DC    (KY0COLMS-03)A(0)                                        00277000
         DC    A(SELGE004)                                              00278000
         DC    (KY0COLMS-04)A(0)                                        00279000
         DC    A(SELGE005)                                              00280000
         DC    (KY0COLMS-05)A(0)                                        00281000
         DC    A(SELGE006)                                              00282000
         DC    (KY0COLMS-06)A(0)                                        00283000
         DC    A(SELGE007)                                              00284000
         DC    (KY0COLMS-07)A(0)                                        00285000
         DC    A(SELGE008)                                              00286000
         DC    (KY0COLMS-08)A(0)                                        00287000
         DC    A(SELGE009)                                              00288000
         DC    (KY0COLMS-09)A(0)                                        00289000
         DC    A(SELGE010)                                              00290000
         LTORG                                                          00291000
*                                                                       00292000
SELGE001 DS    0H                                                       00293000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00294000
         EXEC  SQL DECLARE SAEGE001 CURSOR                             *00295000
               WITH ROWSET POSITIONING                                 *00296000
               FOR SELECT                                              *00297000
                   ZERO_NBR,                                           *00298000
                   AUDIT_DATE_KEY,                                     *00299000
                   AUDIT_TIME_KEY,                                     *00300000
                   UNIQUE_CODE,                                        *00301000
                   AUDIT_TIME_SUBS,                                    *00302000
                   TRAN_CODE,                                          *00303000
                   INST_NBR,                                           *00304000
                   FORMAT_ID,                                          *00305000
                   LOG_CODE,                                           *00306000
                   SEGM_ID,                                            *00307000
                   FUNC_CODE,                                          *00308000
                   AUDIT_USER,                                         *00309000
                   RECORD_LENGTH,                                      *00310000
                   TERMINAL_ID,                                        *00311000
                   WORK_ID,                                            *00312000
                   PANEL_ID,                                           *00313000
                   TRAN_BEGIN,                                         *00314000
                   APPLIC_SEQ,                                         *00315000
                   DATA_1,                                             *00316000
                   DATA_2,                                             *00317000
                   DATA_3                                              *00318000
                 FROM SAE                                              *00319000
                 WHERE                                                 *00320000
                   ZERO_NBR = :ZERONBR AND                             *00321000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00322000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00323000
                   UNIQUE_CODE = :UNIQCDE AND                          *00324000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00325000
                   TRAN_CODE = :TRANSCD AND                            *00326000
                   INST_NBR = :INSTNBR AND                             *00327000
                   FORMAT_ID = :FORMATID AND                           *00328000
                   LOG_CODE = :LOGCODE AND                             *00329000
                   SEGM_ID >=                                          *00330000
                     :SEGID                                            *00331000
                 ORDER BY SEGM_ID ASC                                  *00332000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00333000
         EXEC  SQL OPEN SAEGE001                                        00334000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00336000
         BR    14                      RETURN TO CALLER                 00337000
         LTORG                                                          00338000
*                                                                       00339000
SELGE002 DS    0H                                                       00340000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00341000
         EXEC  SQL DECLARE SAEGE002 CURSOR                             *00342000
               WITH ROWSET POSITIONING                                 *00343000
               FOR SELECT                                              *00344000
                   ZERO_NBR,                                           *00345000
                   AUDIT_DATE_KEY,                                     *00346000
                   AUDIT_TIME_KEY,                                     *00347000
                   UNIQUE_CODE,                                        *00348000
                   AUDIT_TIME_SUBS,                                    *00349000
                   TRAN_CODE,                                          *00350000
                   INST_NBR,                                           *00351000
                   FORMAT_ID,                                          *00352000
                   LOG_CODE,                                           *00353000
                   SEGM_ID,                                            *00354000
                   FUNC_CODE,                                          *00355000
                   AUDIT_USER,                                         *00356000
                   RECORD_LENGTH,                                      *00357000
                   TERMINAL_ID,                                        *00358000
                   WORK_ID,                                            *00359000
                   PANEL_ID,                                           *00360000
                   TRAN_BEGIN,                                         *00361000
                   APPLIC_SEQ,                                         *00362000
                   DATA_1,                                             *00363000
                   DATA_2,                                             *00364000
                   DATA_3                                              *00365000
                 FROM SAE                                              *00366000
                 WHERE                                                 *00367000
                   ZERO_NBR = :ZERONBR AND                             *00368000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00369000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00370000
                   UNIQUE_CODE = :UNIQCDE AND                          *00371000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00372000
                   TRAN_CODE = :TRANSCD AND                            *00373000
                   INST_NBR = :INSTNBR AND                             *00374000
                   FORMAT_ID = :FORMATID AND                           *00375000
                   LOG_CODE >=                                         *00376000
                     :LOGCODE                                          *00377000
                 ORDER BY LOG_CODE ASC,                                *00378000
                   SEGM_ID ASC                                         *00379000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00380000
         EXEC  SQL OPEN SAEGE002                                        00381000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00382000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00383000
         BR    14                      RETURN TO CALLER                 00384000
         LTORG                                                          00385000
*                                                                       00386000
SELGE003 DS    0H                                                       00387000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00388000
         EXEC  SQL DECLARE SAEGE003 CURSOR                             *00389000
               WITH ROWSET POSITIONING                                 *00390000
               FOR SELECT                                              *00391000
                   ZERO_NBR,                                           *00392000
                   AUDIT_DATE_KEY,                                     *00393000
                   AUDIT_TIME_KEY,                                     *00394000
                   UNIQUE_CODE,                                        *00395000
                   AUDIT_TIME_SUBS,                                    *00396000
                   TRAN_CODE,                                          *00397000
                   INST_NBR,                                           *00398000
                   FORMAT_ID,                                          *00399000
                   LOG_CODE,                                           *00400000
                   SEGM_ID,                                            *00401000
                   FUNC_CODE,                                          *00402000
                   AUDIT_USER,                                         *00403000
                   RECORD_LENGTH,                                      *00404000
                   TERMINAL_ID,                                        *00405000
                   WORK_ID,                                            *00406000
                   PANEL_ID,                                           *00407000
                   TRAN_BEGIN,                                         *00408000
                   APPLIC_SEQ,                                         *00409000
                   DATA_1,                                             *00410000
                   DATA_2,                                             *00411000
                   DATA_3                                              *00412000
                 FROM SAE                                              *00413000
                 WHERE                                                 *00414000
                   ZERO_NBR = :ZERONBR AND                             *00415000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00416000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00417000
                   UNIQUE_CODE = :UNIQCDE AND                          *00418000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00419000
                   TRAN_CODE = :TRANSCD AND                            *00420000
                   INST_NBR = :INSTNBR AND                             *00421000
                   FORMAT_ID >=                                        *00422000
                     :FORMATID                                         *00423000
                 ORDER BY FORMAT_ID ASC,                               *00424000
                   LOG_CODE ASC,                                       *00425000
                   SEGM_ID ASC                                         *00426000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00427000
         EXEC  SQL OPEN SAEGE003                                        00428000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00429000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00430000
         BR    14                      RETURN TO CALLER                 00431000
         LTORG                                                          00432000
*                                                                       00433000
SELGE004 DS    0H                                                       00434000
         USING SELGE004,12             ESTABLISH BASE REGISTER          00435000
         EXEC  SQL DECLARE SAEGE004 CURSOR                             *00436000
               WITH ROWSET POSITIONING                                 *00437000
               FOR SELECT                                              *00438000
                   ZERO_NBR,                                           *00439000
                   AUDIT_DATE_KEY,                                     *00440000
                   AUDIT_TIME_KEY,                                     *00441000
                   UNIQUE_CODE,                                        *00442000
                   AUDIT_TIME_SUBS,                                    *00443000
                   TRAN_CODE,                                          *00444000
                   INST_NBR,                                           *00445000
                   FORMAT_ID,                                          *00446000
                   LOG_CODE,                                           *00447000
                   SEGM_ID,                                            *00448000
                   FUNC_CODE,                                          *00449000
                   AUDIT_USER,                                         *00450000
                   RECORD_LENGTH,                                      *00451000
                   TERMINAL_ID,                                        *00452000
                   WORK_ID,                                            *00453000
                   PANEL_ID,                                           *00454000
                   TRAN_BEGIN,                                         *00455000
                   APPLIC_SEQ,                                         *00456000
                   DATA_1,                                             *00457000
                   DATA_2,                                             *00458000
                   DATA_3                                              *00459000
                 FROM SAE                                              *00460000
                 WHERE                                                 *00461000
                   ZERO_NBR = :ZERONBR AND                             *00462000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00463000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00464000
                   UNIQUE_CODE = :UNIQCDE AND                          *00465000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00466000
                   TRAN_CODE = :TRANSCD AND                            *00467000
                   INST_NBR >=                                         *00468000
                     :INSTNBR                                          *00469000
                 ORDER BY INST_NBR ASC,                                *00470000
                   FORMAT_ID ASC,                                      *00471000
                   LOG_CODE ASC,                                       *00472000
                   SEGM_ID ASC                                         *00473000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00474000
         EXEC  SQL OPEN SAEGE004                                        00475000
         MVC   SQWCSRCA,=A(CLSGE004)   SET CURSOR CLOSE ROUTINE ADDRESS 00476000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00477000
         BR    14                      RETURN TO CALLER                 00478000
         LTORG                                                          00479000
*                                                                       00480000
SELGE005 DS    0H                                                       00481000
         USING SELGE005,12             ESTABLISH BASE REGISTER          00482000
         EXEC  SQL DECLARE SAEGE005 CURSOR                             *00483000
               WITH ROWSET POSITIONING                                 *00484000
               FOR SELECT                                              *00485000
                   ZERO_NBR,                                           *00486000
                   AUDIT_DATE_KEY,                                     *00487000
                   AUDIT_TIME_KEY,                                     *00488000
                   UNIQUE_CODE,                                        *00489000
                   AUDIT_TIME_SUBS,                                    *00490000
                   TRAN_CODE,                                          *00491000
                   INST_NBR,                                           *00492000
                   FORMAT_ID,                                          *00493000
                   LOG_CODE,                                           *00494000
                   SEGM_ID,                                            *00495000
                   FUNC_CODE,                                          *00496000
                   AUDIT_USER,                                         *00497000
                   RECORD_LENGTH,                                      *00498000
                   TERMINAL_ID,                                        *00499000
                   WORK_ID,                                            *00500000
                   PANEL_ID,                                           *00501000
                   TRAN_BEGIN,                                         *00502000
                   APPLIC_SEQ,                                         *00503000
                   DATA_1,                                             *00504000
                   DATA_2,                                             *00505000
                   DATA_3                                              *00506000
                 FROM SAE                                              *00507000
                 WHERE                                                 *00508000
                   ZERO_NBR = :ZERONBR AND                             *00509000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00510000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00511000
                   UNIQUE_CODE = :UNIQCDE AND                          *00512000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00513000
                   TRAN_CODE >=                                        *00514000
                     :TRANSCD                                          *00515000
                 ORDER BY TRAN_CODE ASC,                               *00516000
                   INST_NBR ASC,                                       *00517000
                   FORMAT_ID ASC,                                      *00518000
                   LOG_CODE ASC,                                       *00519000
                   SEGM_ID ASC                                         *00520000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00521000
         EXEC  SQL OPEN SAEGE005                                        00522000
         MVC   SQWCSRCA,=A(CLSGE005)   SET CURSOR CLOSE ROUTINE ADDRESS 00523000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00524000
         BR    14                      RETURN TO CALLER                 00525000
         LTORG                                                          00526000
*                                                                       00527000
SELGE006 DS    0H                                                       00528000
         USING SELGE006,12             ESTABLISH BASE REGISTER          00529000
         EXEC  SQL DECLARE SAEGE006 CURSOR                             *00530000
               WITH ROWSET POSITIONING                                 *00531000
               FOR SELECT                                              *00532000
                   ZERO_NBR,                                           *00533000
                   AUDIT_DATE_KEY,                                     *00534000
                   AUDIT_TIME_KEY,                                     *00535000
                   UNIQUE_CODE,                                        *00536000
                   AUDIT_TIME_SUBS,                                    *00537000
                   TRAN_CODE,                                          *00538000
                   INST_NBR,                                           *00539000
                   FORMAT_ID,                                          *00540000
                   LOG_CODE,                                           *00541000
                   SEGM_ID,                                            *00542000
                   FUNC_CODE,                                          *00543000
                   AUDIT_USER,                                         *00544000
                   RECORD_LENGTH,                                      *00545000
                   TERMINAL_ID,                                        *00546000
                   WORK_ID,                                            *00547000
                   PANEL_ID,                                           *00548000
                   TRAN_BEGIN,                                         *00549000
                   APPLIC_SEQ,                                         *00550000
                   DATA_1,                                             *00551000
                   DATA_2,                                             *00552000
                   DATA_3                                              *00553000
                 FROM SAE                                              *00554000
                 WHERE                                                 *00555000
                   ZERO_NBR = :ZERONBR AND                             *00556000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00557000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00558000
                   UNIQUE_CODE = :UNIQCDE AND                          *00559000
                   AUDIT_TIME_SUBS >=                                  *00560000
                     :AUDTIMS                                          *00561000
                 ORDER BY AUDIT_TIME_SUBS ASC,                         *00562000
                   TRAN_CODE ASC,                                      *00563000
                   INST_NBR ASC,                                       *00564000
                   FORMAT_ID ASC,                                      *00565000
                   LOG_CODE ASC,                                       *00566000
                   SEGM_ID ASC                                         *00567000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00568000
         EXEC  SQL OPEN SAEGE006                                        00569000
         MVC   SQWCSRCA,=A(CLSGE006)   SET CURSOR CLOSE ROUTINE ADDRESS 00570000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00571000
         BR    14                      RETURN TO CALLER                 00572000
         LTORG                                                          00573000
*                                                                       00574000
SELGE007 DS    0H                                                       00575000
         USING SELGE007,12             ESTABLISH BASE REGISTER          00576000
         EXEC  SQL DECLARE SAEGE007 CURSOR                             *00577000
               WITH ROWSET POSITIONING                                 *00578000
               FOR SELECT                                              *00579000
                   ZERO_NBR,                                           *00580000
                   AUDIT_DATE_KEY,                                     *00581000
                   AUDIT_TIME_KEY,                                     *00582000
                   UNIQUE_CODE,                                        *00583000
                   AUDIT_TIME_SUBS,                                    *00584000
                   TRAN_CODE,                                          *00585000
                   INST_NBR,                                           *00586000
                   FORMAT_ID,                                          *00587000
                   LOG_CODE,                                           *00588000
                   SEGM_ID,                                            *00589000
                   FUNC_CODE,                                          *00590000
                   AUDIT_USER,                                         *00591000
                   RECORD_LENGTH,                                      *00592000
                   TERMINAL_ID,                                        *00593000
                   WORK_ID,                                            *00594000
                   PANEL_ID,                                           *00595000
                   TRAN_BEGIN,                                         *00596000
                   APPLIC_SEQ,                                         *00597000
                   DATA_1,                                             *00598000
                   DATA_2,                                             *00599000
                   DATA_3                                              *00600000
                 FROM SAE                                              *00601000
                 WHERE                                                 *00602000
                   ZERO_NBR = :ZERONBR AND                             *00603000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00604000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00605000
                   UNIQUE_CODE >=                                      *00606000
                     :UNIQCDE                                          *00607000
                 ORDER BY UNIQUE_CODE ASC,                             *00608000
                   AUDIT_TIME_SUBS ASC,                                *00609000
                   TRAN_CODE ASC,                                      *00610000
                   INST_NBR ASC,                                       *00611000
                   FORMAT_ID ASC,                                      *00612000
                   LOG_CODE ASC,                                       *00613000
                   SEGM_ID ASC                                         *00614000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00615000
         EXEC  SQL OPEN SAEGE007                                        00616000
         MVC   SQWCSRCA,=A(CLSGE007)   SET CURSOR CLOSE ROUTINE ADDRESS 00617000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00618000
         BR    14                      RETURN TO CALLER                 00619000
         LTORG                                                          00620000
*                                                                       00621000
SELGE008 DS    0H                                                       00622000
         USING SELGE008,12             ESTABLISH BASE REGISTER          00623000
         EXEC  SQL DECLARE SAEGE008 CURSOR                             *00624000
               WITH ROWSET POSITIONING                                 *00625000
               FOR SELECT                                              *00626000
                   ZERO_NBR,                                           *00627000
                   AUDIT_DATE_KEY,                                     *00628000
                   AUDIT_TIME_KEY,                                     *00629000
                   UNIQUE_CODE,                                        *00630000
                   AUDIT_TIME_SUBS,                                    *00631000
                   TRAN_CODE,                                          *00632000
                   INST_NBR,                                           *00633000
                   FORMAT_ID,                                          *00634000
                   LOG_CODE,                                           *00635000
                   SEGM_ID,                                            *00636000
                   FUNC_CODE,                                          *00637000
                   AUDIT_USER,                                         *00638000
                   RECORD_LENGTH,                                      *00639000
                   TERMINAL_ID,                                        *00640000
                   WORK_ID,                                            *00641000
                   PANEL_ID,                                           *00642000
                   TRAN_BEGIN,                                         *00643000
                   APPLIC_SEQ,                                         *00644000
                   DATA_1,                                             *00645000
                   DATA_2,                                             *00646000
                   DATA_3                                              *00647000
                 FROM SAE                                              *00648000
                 WHERE                                                 *00649000
                   ZERO_NBR = :ZERONBR AND                             *00650000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00651000
                   AUDIT_TIME_KEY >=                                   *00652000
                     :AUDTIMK                                          *00653000
                 ORDER BY AUDIT_TIME_KEY ASC,                          *00654000
                   UNIQUE_CODE ASC,                                    *00655000
                   AUDIT_TIME_SUBS ASC,                                *00656000
                   TRAN_CODE ASC,                                      *00657000
                   INST_NBR ASC,                                       *00658000
                   FORMAT_ID ASC,                                      *00659000
                   LOG_CODE ASC,                                       *00660000
                   SEGM_ID ASC                                         *00661000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00662000
         EXEC  SQL OPEN SAEGE008                                        00663000
         MVC   SQWCSRCA,=A(CLSGE008)   SET CURSOR CLOSE ROUTINE ADDRESS 00664000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00665000
         BR    14                      RETURN TO CALLER                 00666000
         LTORG                                                          00667000
*                                                                       00668000
SELGE009 DS    0H                                                       00669000
         USING SELGE009,12             ESTABLISH BASE REGISTER          00670000
         EXEC  SQL DECLARE SAEGE009 CURSOR                             *00671000
               WITH ROWSET POSITIONING                                 *00672000
               FOR SELECT                                              *00673000
                   ZERO_NBR,                                           *00674000
                   AUDIT_DATE_KEY,                                     *00675000
                   AUDIT_TIME_KEY,                                     *00676000
                   UNIQUE_CODE,                                        *00677000
                   AUDIT_TIME_SUBS,                                    *00678000
                   TRAN_CODE,                                          *00679000
                   INST_NBR,                                           *00680000
                   FORMAT_ID,                                          *00681000
                   LOG_CODE,                                           *00682000
                   SEGM_ID,                                            *00683000
                   FUNC_CODE,                                          *00684000
                   AUDIT_USER,                                         *00685000
                   RECORD_LENGTH,                                      *00686000
                   TERMINAL_ID,                                        *00687000
                   WORK_ID,                                            *00688000
                   PANEL_ID,                                           *00689000
                   TRAN_BEGIN,                                         *00690000
                   APPLIC_SEQ,                                         *00691000
                   DATA_1,                                             *00692000
                   DATA_2,                                             *00693000
                   DATA_3                                              *00694000
                 FROM SAE                                              *00695000
                 WHERE                                                 *00696000
                   ZERO_NBR = :ZERONBR AND                             *00697000
                   AUDIT_DATE_KEY >=                                   *00698000
                     :AUDDATK                                          *00699000
                 ORDER BY AUDIT_DATE_KEY ASC,                          *00700000
                   AUDIT_TIME_KEY ASC,                                 *00701000
                   UNIQUE_CODE ASC,                                    *00702000
                   AUDIT_TIME_SUBS ASC,                                *00703000
                   TRAN_CODE ASC,                                      *00704000
                   INST_NBR ASC,                                       *00705000
                   FORMAT_ID ASC,                                      *00706000
                   LOG_CODE ASC,                                       *00707000
                   SEGM_ID ASC                                         *00708000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00709000
         EXEC  SQL OPEN SAEGE009                                        00710000
         MVC   SQWCSRCA,=A(CLSGE009)   SET CURSOR CLOSE ROUTINE ADDRESS 00711000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00712000
         BR    14                      RETURN TO CALLER                 00713000
         LTORG                                                          00714000
*                                                                       00715000
SELGE010 DS    0H                                                       00716000
         USING SELGE010,12             ESTABLISH BASE REGISTER          00717000
         EXEC  SQL DECLARE SAEGE010 CURSOR                             *00718000
               WITH ROWSET POSITIONING                                 *00719000
               FOR SELECT                                              *00720000
                   ZERO_NBR,                                           *00721000
                   AUDIT_DATE_KEY,                                     *00722000
                   AUDIT_TIME_KEY,                                     *00723000
                   UNIQUE_CODE,                                        *00724000
                   AUDIT_TIME_SUBS,                                    *00725000
                   TRAN_CODE,                                          *00726000
                   INST_NBR,                                           *00727000
                   FORMAT_ID,                                          *00728000
                   LOG_CODE,                                           *00729000
                   SEGM_ID,                                            *00730000
                   FUNC_CODE,                                          *00731000
                   AUDIT_USER,                                         *00732000
                   RECORD_LENGTH,                                      *00733000
                   TERMINAL_ID,                                        *00734000
                   WORK_ID,                                            *00735000
                   PANEL_ID,                                           *00736000
                   TRAN_BEGIN,                                         *00737000
                   APPLIC_SEQ,                                         *00738000
                   DATA_1,                                             *00739000
                   DATA_2,                                             *00740000
                   DATA_3                                              *00741000
                 FROM SAE                                              *00742000
                 WHERE                                                 *00743000
                   ZERO_NBR >=                                         *00744000
                     :ZERONBR                                          *00745000
                 ORDER BY ZERO_NBR ASC,                                *00746000
                   AUDIT_DATE_KEY ASC,                                 *00747000
                   AUDIT_TIME_KEY ASC,                                 *00748000
                   UNIQUE_CODE ASC,                                    *00749000
                   AUDIT_TIME_SUBS ASC,                                *00750000
                   TRAN_CODE ASC,                                      *00751000
                   INST_NBR ASC,                                       *00752000
                   FORMAT_ID ASC,                                      *00753000
                   LOG_CODE ASC,                                       *00754000
                   SEGM_ID ASC                                         *00755000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00756000
         EXEC  SQL OPEN SAEGE010                                        00757000
         MVC   SQWCSRCA,=A(CLSGE010)   SET CURSOR CLOSE ROUTINE ADDRESS 00758000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00759000
         BR    14                      RETURN TO CALLER                 00760000
         LTORG                                                          00761000
*                                                                       00762000
**********************************************************************  00763000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00764000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00765000
**********************************************************************  00766000
*                                                                       00767000
NXTXC0   DS    0H                                                       00768000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00769000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00770000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00771000
         BALR  14,15                   MOVE REQUESTED DATA              00772000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00773000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00774000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00775000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00776000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00777000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00778000
NXTXC0P  DC    A(0)                                                     00779000
         DC    A(NXTGT002)                                              00780000
         DC    A(NXTGT003)                                              00781000
         DC    A(NXTGT004)                                              00782000
         DC    A(NXTGT005)                                              00783000
         DC    A(NXTGT006)                                              00784000
         DC    A(NXTGT007)                                              00785000
         DC    A(NXTGT008)                                              00786000
         DC    A(NXTGT009)                                              00787000
         DC    A(NXTGT010)                                              00788000
         DC    A(NXTGT099)                                              00789000
         DC    A(NXTGT003)                                              00790000
         DC    A(NXTGT004)                                              00791000
         DC    A(NXTGT005)                                              00792000
         DC    A(NXTGT006)                                              00793000
         DC    A(NXTGT007)                                              00794000
         DC    A(NXTGT008)                                              00795000
         DC    A(NXTGT009)                                              00796000
         DC    A(NXTGT010)                                              00797000
         DC    A(NXTGT099)                                              00798000
         DC    A(NXTGT004)                                              00799000
         DC    A(NXTGT005)                                              00800000
         DC    A(NXTGT006)                                              00801000
         DC    A(NXTGT007)                                              00802000
         DC    A(NXTGT008)                                              00803000
         DC    A(NXTGT009)                                              00804000
         DC    A(NXTGT010)                                              00805000
         DC    A(NXTGT099)                                              00806000
         DC    A(NXTGT005)                                              00807000
         DC    A(NXTGT006)                                              00808000
         DC    A(NXTGT007)                                              00809000
         DC    A(NXTGT008)                                              00810000
         DC    A(NXTGT009)                                              00811000
         DC    A(NXTGT010)                                              00812000
         DC    A(NXTGT099)                                              00813000
         DC    A(NXTGT006)                                              00814000
         DC    A(NXTGT007)                                              00815000
         DC    A(NXTGT008)                                              00816000
         DC    A(NXTGT009)                                              00817000
         DC    A(NXTGT010)                                              00818000
         DC    A(NXTGT099)                                              00819000
         DC    A(NXTGT007)                                              00820000
         DC    A(NXTGT008)                                              00821000
         DC    A(NXTGT009)                                              00822000
         DC    A(NXTGT010)                                              00823000
         DC    A(NXTGT099)                                              00824000
         DC    A(NXTGT008)                                              00825000
         DC    A(NXTGT009)                                              00826000
         DC    A(NXTGT010)                                              00827000
         DC    A(NXTGT099)                                              00828000
         DC    A(NXTGT009)                                              00829000
         DC    A(NXTGT010)                                              00830000
         DC    A(NXTGT099)                                              00831000
         DC    A(NXTGT010)                                              00832000
         DC    A(NXTGT099)                                              00833000
         DC    A(NXTGT099)                                              00834000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00835000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00836000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00837000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00838000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00839000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00840000
         BR    14                      RETURN TO SQI                    00841000
         LTORG                                                          00842000
*                                                                       00843000
NXTGT002 DS    0H                                                       00844000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00845000
         EXEC  SQL DECLARE SAEGT002 CURSOR                             *00846000
               WITH ROWSET POSITIONING                                 *00847000
               FOR SELECT                                              *00848000
                   ZERO_NBR,                                           *00849000
                   AUDIT_DATE_KEY,                                     *00850000
                   AUDIT_TIME_KEY,                                     *00851000
                   UNIQUE_CODE,                                        *00852000
                   AUDIT_TIME_SUBS,                                    *00853000
                   TRAN_CODE,                                          *00854000
                   INST_NBR,                                           *00855000
                   FORMAT_ID,                                          *00856000
                   LOG_CODE,                                           *00857000
                   SEGM_ID,                                            *00858000
                   FUNC_CODE,                                          *00859000
                   AUDIT_USER,                                         *00860000
                   RECORD_LENGTH,                                      *00861000
                   TERMINAL_ID,                                        *00862000
                   WORK_ID,                                            *00863000
                   PANEL_ID,                                           *00864000
                   TRAN_BEGIN,                                         *00865000
                   APPLIC_SEQ,                                         *00866000
                   DATA_1,                                             *00867000
                   DATA_2,                                             *00868000
                   DATA_3                                              *00869000
                 FROM SAE                                              *00870000
                 WHERE                                                 *00871000
                   ZERO_NBR = :ZERONBR AND                             *00872000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00873000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00874000
                   UNIQUE_CODE = :UNIQCDE AND                          *00875000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00876000
                   TRAN_CODE = :TRANSCD AND                            *00877000
                   INST_NBR = :INSTNBR AND                             *00878000
                   FORMAT_ID = :FORMATID AND                           *00879000
                   LOG_CODE >                                          *00880000
                     :LOGCODE                                          *00881000
                 ORDER BY LOG_CODE ASC,                                *00882000
                   SEGM_ID ASC                                         *00883000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00884000
         EXEC  SQL OPEN SAEGT002                                        00885000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00886000
         BNZ   *+14                    NO - RETURN ERROR                00887000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00888000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00889000
         BR    12                      RETURN TO FETCH ROUTINE          00890000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00891000
         BR    14                      RETURN TO CALLER                 00892000
         LTORG                                                          00893000
*                                                                       00894000
NXTGT003 DS    0H                                                       00895000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00896000
         EXEC  SQL DECLARE SAEGT003 CURSOR                             *00897000
               WITH ROWSET POSITIONING                                 *00898000
               FOR SELECT                                              *00899000
                   ZERO_NBR,                                           *00900000
                   AUDIT_DATE_KEY,                                     *00901000
                   AUDIT_TIME_KEY,                                     *00902000
                   UNIQUE_CODE,                                        *00903000
                   AUDIT_TIME_SUBS,                                    *00904000
                   TRAN_CODE,                                          *00905000
                   INST_NBR,                                           *00906000
                   FORMAT_ID,                                          *00907000
                   LOG_CODE,                                           *00908000
                   SEGM_ID,                                            *00909000
                   FUNC_CODE,                                          *00910000
                   AUDIT_USER,                                         *00911000
                   RECORD_LENGTH,                                      *00912000
                   TERMINAL_ID,                                        *00913000
                   WORK_ID,                                            *00914000
                   PANEL_ID,                                           *00915000
                   TRAN_BEGIN,                                         *00916000
                   APPLIC_SEQ,                                         *00917000
                   DATA_1,                                             *00918000
                   DATA_2,                                             *00919000
                   DATA_3                                              *00920000
                 FROM SAE                                              *00921000
                 WHERE                                                 *00922000
                   ZERO_NBR = :ZERONBR AND                             *00923000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00924000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00925000
                   UNIQUE_CODE = :UNIQCDE AND                          *00926000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00927000
                   TRAN_CODE = :TRANSCD AND                            *00928000
                   INST_NBR = :INSTNBR AND                             *00929000
                   FORMAT_ID >                                         *00930000
                     :FORMATID                                         *00931000
                 ORDER BY FORMAT_ID ASC,                               *00932000
                   LOG_CODE ASC,                                       *00933000
                   SEGM_ID ASC                                         *00934000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00935000
         EXEC  SQL OPEN SAEGT003                                        00936000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00937000
         BNZ   *+14                    NO - RETURN ERROR                00938000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00939000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00940000
         BR    12                      RETURN TO FETCH ROUTINE          00941000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00942000
         BR    14                      RETURN TO CALLER                 00943000
         LTORG                                                          00944000
*                                                                       00945000
NXTGT004 DS    0H                                                       00946000
         USING NXTGT004,12             ESTABLISH BASE REGISTER          00947000
         EXEC  SQL DECLARE SAEGT004 CURSOR                             *00948000
               WITH ROWSET POSITIONING                                 *00949000
               FOR SELECT                                              *00950000
                   ZERO_NBR,                                           *00951000
                   AUDIT_DATE_KEY,                                     *00952000
                   AUDIT_TIME_KEY,                                     *00953000
                   UNIQUE_CODE,                                        *00954000
                   AUDIT_TIME_SUBS,                                    *00955000
                   TRAN_CODE,                                          *00956000
                   INST_NBR,                                           *00957000
                   FORMAT_ID,                                          *00958000
                   LOG_CODE,                                           *00959000
                   SEGM_ID,                                            *00960000
                   FUNC_CODE,                                          *00961000
                   AUDIT_USER,                                         *00962000
                   RECORD_LENGTH,                                      *00963000
                   TERMINAL_ID,                                        *00964000
                   WORK_ID,                                            *00965000
                   PANEL_ID,                                           *00966000
                   TRAN_BEGIN,                                         *00967000
                   APPLIC_SEQ,                                         *00968000
                   DATA_1,                                             *00969000
                   DATA_2,                                             *00970000
                   DATA_3                                              *00971000
                 FROM SAE                                              *00972000
                 WHERE                                                 *00973000
                   ZERO_NBR = :ZERONBR AND                             *00974000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *00975000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *00976000
                   UNIQUE_CODE = :UNIQCDE AND                          *00977000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *00978000
                   TRAN_CODE = :TRANSCD AND                            *00979000
                   INST_NBR >                                          *00980000
                     :INSTNBR                                          *00981000
                 ORDER BY INST_NBR ASC,                                *00982000
                   FORMAT_ID ASC,                                      *00983000
                   LOG_CODE ASC,                                       *00984000
                   SEGM_ID ASC                                         *00985000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00986000
         EXEC  SQL OPEN SAEGT004                                        00987000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00988000
         BNZ   *+14                    NO - RETURN ERROR                00989000
         MVC   SQWCSRCA,=A(CLSGT004)   SET CURSOR CLOSE ROUTINE ADDRESS 00990000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00991000
         BR    12                      RETURN TO FETCH ROUTINE          00992000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00993000
         BR    14                      RETURN TO CALLER                 00994000
         LTORG                                                          00995000
*                                                                       00996000
NXTGT005 DS    0H                                                       00997000
         USING NXTGT005,12             ESTABLISH BASE REGISTER          00998000
         EXEC  SQL DECLARE SAEGT005 CURSOR                             *00999000
               WITH ROWSET POSITIONING                                 *01000000
               FOR SELECT                                              *01001000
                   ZERO_NBR,                                           *01002000
                   AUDIT_DATE_KEY,                                     *01003000
                   AUDIT_TIME_KEY,                                     *01004000
                   UNIQUE_CODE,                                        *01005000
                   AUDIT_TIME_SUBS,                                    *01006000
                   TRAN_CODE,                                          *01007000
                   INST_NBR,                                           *01008000
                   FORMAT_ID,                                          *01009000
                   LOG_CODE,                                           *01010000
                   SEGM_ID,                                            *01011000
                   FUNC_CODE,                                          *01012000
                   AUDIT_USER,                                         *01013000
                   RECORD_LENGTH,                                      *01014000
                   TERMINAL_ID,                                        *01015000
                   WORK_ID,                                            *01016000
                   PANEL_ID,                                           *01017000
                   TRAN_BEGIN,                                         *01018000
                   APPLIC_SEQ,                                         *01019000
                   DATA_1,                                             *01020000
                   DATA_2,                                             *01021000
                   DATA_3                                              *01022000
                 FROM SAE                                              *01023000
                 WHERE                                                 *01024000
                   ZERO_NBR = :ZERONBR AND                             *01025000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *01026000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *01027000
                   UNIQUE_CODE = :UNIQCDE AND                          *01028000
                   AUDIT_TIME_SUBS = :AUDTIMS AND                      *01029000
                   TRAN_CODE >                                         *01030000
                     :TRANSCD                                          *01031000
                 ORDER BY TRAN_CODE ASC,                               *01032000
                   INST_NBR ASC,                                       *01033000
                   FORMAT_ID ASC,                                      *01034000
                   LOG_CODE ASC,                                       *01035000
                   SEGM_ID ASC                                         *01036000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01037000
         EXEC  SQL OPEN SAEGT005                                        01038000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01039000
         BNZ   *+14                    NO - RETURN ERROR                01040000
         MVC   SQWCSRCA,=A(CLSGT005)   SET CURSOR CLOSE ROUTINE ADDRESS 01041000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01042000
         BR    12                      RETURN TO FETCH ROUTINE          01043000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01044000
         BR    14                      RETURN TO CALLER                 01045000
         LTORG                                                          01046000
*                                                                       01047000
NXTGT006 DS    0H                                                       01048000
         USING NXTGT006,12             ESTABLISH BASE REGISTER          01049000
         EXEC  SQL DECLARE SAEGT006 CURSOR                             *01050000
               WITH ROWSET POSITIONING                                 *01051000
               FOR SELECT                                              *01052000
                   ZERO_NBR,                                           *01053000
                   AUDIT_DATE_KEY,                                     *01054000
                   AUDIT_TIME_KEY,                                     *01055000
                   UNIQUE_CODE,                                        *01056000
                   AUDIT_TIME_SUBS,                                    *01057000
                   TRAN_CODE,                                          *01058000
                   INST_NBR,                                           *01059000
                   FORMAT_ID,                                          *01060000
                   LOG_CODE,                                           *01061000
                   SEGM_ID,                                            *01062000
                   FUNC_CODE,                                          *01063000
                   AUDIT_USER,                                         *01064000
                   RECORD_LENGTH,                                      *01065000
                   TERMINAL_ID,                                        *01066000
                   WORK_ID,                                            *01067000
                   PANEL_ID,                                           *01068000
                   TRAN_BEGIN,                                         *01069000
                   APPLIC_SEQ,                                         *01070000
                   DATA_1,                                             *01071000
                   DATA_2,                                             *01072000
                   DATA_3                                              *01073000
                 FROM SAE                                              *01074000
                 WHERE                                                 *01075000
                   ZERO_NBR = :ZERONBR AND                             *01076000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *01077000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *01078000
                   UNIQUE_CODE = :UNIQCDE AND                          *01079000
                   AUDIT_TIME_SUBS >                                   *01080000
                     :AUDTIMS                                          *01081000
                 ORDER BY AUDIT_TIME_SUBS ASC,                         *01082000
                   TRAN_CODE ASC,                                      *01083000
                   INST_NBR ASC,                                       *01084000
                   FORMAT_ID ASC,                                      *01085000
                   LOG_CODE ASC,                                       *01086000
                   SEGM_ID ASC                                         *01087000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01088000
         EXEC  SQL OPEN SAEGT006                                        01089000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01090000
         BNZ   *+14                    NO - RETURN ERROR                01091000
         MVC   SQWCSRCA,=A(CLSGT006)   SET CURSOR CLOSE ROUTINE ADDRESS 01092000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01093000
         BR    12                      RETURN TO FETCH ROUTINE          01094000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01095000
         BR    14                      RETURN TO CALLER                 01096000
         LTORG                                                          01097000
*                                                                       01098000
NXTGT007 DS    0H                                                       01099000
         USING NXTGT007,12             ESTABLISH BASE REGISTER          01100000
         EXEC  SQL DECLARE SAEGT007 CURSOR                             *01101000
               WITH ROWSET POSITIONING                                 *01102000
               FOR SELECT                                              *01103000
                   ZERO_NBR,                                           *01104000
                   AUDIT_DATE_KEY,                                     *01105000
                   AUDIT_TIME_KEY,                                     *01106000
                   UNIQUE_CODE,                                        *01107000
                   AUDIT_TIME_SUBS,                                    *01108000
                   TRAN_CODE,                                          *01109000
                   INST_NBR,                                           *01110000
                   FORMAT_ID,                                          *01111000
                   LOG_CODE,                                           *01112000
                   SEGM_ID,                                            *01113000
                   FUNC_CODE,                                          *01114000
                   AUDIT_USER,                                         *01115000
                   RECORD_LENGTH,                                      *01116000
                   TERMINAL_ID,                                        *01117000
                   WORK_ID,                                            *01118000
                   PANEL_ID,                                           *01119000
                   TRAN_BEGIN,                                         *01120000
                   APPLIC_SEQ,                                         *01121000
                   DATA_1,                                             *01122000
                   DATA_2,                                             *01123000
                   DATA_3                                              *01124000
                 FROM SAE                                              *01125000
                 WHERE                                                 *01126000
                   ZERO_NBR = :ZERONBR AND                             *01127000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *01128000
                   AUDIT_TIME_KEY = :AUDTIMK AND                       *01129000
                   UNIQUE_CODE >                                       *01130000
                     :UNIQCDE                                          *01131000
                 ORDER BY UNIQUE_CODE ASC,                             *01132000
                   AUDIT_TIME_SUBS ASC,                                *01133000
                   TRAN_CODE ASC,                                      *01134000
                   INST_NBR ASC,                                       *01135000
                   FORMAT_ID ASC,                                      *01136000
                   LOG_CODE ASC,                                       *01137000
                   SEGM_ID ASC                                         *01138000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01139000
         EXEC  SQL OPEN SAEGT007                                        01140000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01141000
         BNZ   *+14                    NO - RETURN ERROR                01142000
         MVC   SQWCSRCA,=A(CLSGT007)   SET CURSOR CLOSE ROUTINE ADDRESS 01143000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01144000
         BR    12                      RETURN TO FETCH ROUTINE          01145000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01146000
         BR    14                      RETURN TO CALLER                 01147000
         LTORG                                                          01148000
*                                                                       01149000
NXTGT008 DS    0H                                                       01150000
         USING NXTGT008,12             ESTABLISH BASE REGISTER          01151000
         EXEC  SQL DECLARE SAEGT008 CURSOR                             *01152000
               WITH ROWSET POSITIONING                                 *01153000
               FOR SELECT                                              *01154000
                   ZERO_NBR,                                           *01155000
                   AUDIT_DATE_KEY,                                     *01156000
                   AUDIT_TIME_KEY,                                     *01157000
                   UNIQUE_CODE,                                        *01158000
                   AUDIT_TIME_SUBS,                                    *01159000
                   TRAN_CODE,                                          *01160000
                   INST_NBR,                                           *01161000
                   FORMAT_ID,                                          *01162000
                   LOG_CODE,                                           *01163000
                   SEGM_ID,                                            *01164000
                   FUNC_CODE,                                          *01165000
                   AUDIT_USER,                                         *01166000
                   RECORD_LENGTH,                                      *01167000
                   TERMINAL_ID,                                        *01168000
                   WORK_ID,                                            *01169000
                   PANEL_ID,                                           *01170000
                   TRAN_BEGIN,                                         *01171000
                   APPLIC_SEQ,                                         *01172000
                   DATA_1,                                             *01173000
                   DATA_2,                                             *01174000
                   DATA_3                                              *01175000
                 FROM SAE                                              *01176000
                 WHERE                                                 *01177000
                   ZERO_NBR = :ZERONBR AND                             *01178000
                   AUDIT_DATE_KEY = :AUDDATK AND                       *01179000
                   AUDIT_TIME_KEY >                                    *01180000
                     :AUDTIMK                                          *01181000
                 ORDER BY AUDIT_TIME_KEY ASC,                          *01182000
                   UNIQUE_CODE ASC,                                    *01183000
                   AUDIT_TIME_SUBS ASC,                                *01184000
                   TRAN_CODE ASC,                                      *01185000
                   INST_NBR ASC,                                       *01186000
                   FORMAT_ID ASC,                                      *01187000
                   LOG_CODE ASC,                                       *01188000
                   SEGM_ID ASC                                         *01189000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01190000
         EXEC  SQL OPEN SAEGT008                                        01191000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01192000
         BNZ   *+14                    NO - RETURN ERROR                01193000
         MVC   SQWCSRCA,=A(CLSGT008)   SET CURSOR CLOSE ROUTINE ADDRESS 01194000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01195000
         BR    12                      RETURN TO FETCH ROUTINE          01196000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01197000
         BR    14                      RETURN TO CALLER                 01198000
         LTORG                                                          01199000
*                                                                       01200000
NXTGT009 DS    0H                                                       01201000
         USING NXTGT009,12             ESTABLISH BASE REGISTER          01202000
         EXEC  SQL DECLARE SAEGT009 CURSOR                             *01203000
               WITH ROWSET POSITIONING                                 *01204000
               FOR SELECT                                              *01205000
                   ZERO_NBR,                                           *01206000
                   AUDIT_DATE_KEY,                                     *01207000
                   AUDIT_TIME_KEY,                                     *01208000
                   UNIQUE_CODE,                                        *01209000
                   AUDIT_TIME_SUBS,                                    *01210000
                   TRAN_CODE,                                          *01211000
                   INST_NBR,                                           *01212000
                   FORMAT_ID,                                          *01213000
                   LOG_CODE,                                           *01214000
                   SEGM_ID,                                            *01215000
                   FUNC_CODE,                                          *01216000
                   AUDIT_USER,                                         *01217000
                   RECORD_LENGTH,                                      *01218000
                   TERMINAL_ID,                                        *01219000
                   WORK_ID,                                            *01220000
                   PANEL_ID,                                           *01221000
                   TRAN_BEGIN,                                         *01222000
                   APPLIC_SEQ,                                         *01223000
                   DATA_1,                                             *01224000
                   DATA_2,                                             *01225000
                   DATA_3                                              *01226000
                 FROM SAE                                              *01227000
                 WHERE                                                 *01228000
                   ZERO_NBR = :ZERONBR AND                             *01229000
                   AUDIT_DATE_KEY >                                    *01230000
                     :AUDDATK                                          *01231000
                 ORDER BY AUDIT_DATE_KEY ASC,                          *01232000
                   AUDIT_TIME_KEY ASC,                                 *01233000
                   UNIQUE_CODE ASC,                                    *01234000
                   AUDIT_TIME_SUBS ASC,                                *01235000
                   TRAN_CODE ASC,                                      *01236000
                   INST_NBR ASC,                                       *01237000
                   FORMAT_ID ASC,                                      *01238000
                   LOG_CODE ASC,                                       *01239000
                   SEGM_ID ASC                                         *01240000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01241000
         EXEC  SQL OPEN SAEGT009                                        01242000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01243000
         BNZ   *+14                    NO - RETURN ERROR                01244000
         MVC   SQWCSRCA,=A(CLSGT009)   SET CURSOR CLOSE ROUTINE ADDRESS 01245000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01246000
         BR    12                      RETURN TO FETCH ROUTINE          01247000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01248000
         BR    14                      RETURN TO CALLER                 01249000
         LTORG                                                          01250000
*                                                                       01251000
NXTGT010 DS    0H                                                       01252000
         USING NXTGT010,12             ESTABLISH BASE REGISTER          01253000
         EXEC  SQL DECLARE SAEGT010 CURSOR                             *01254000
               WITH ROWSET POSITIONING                                 *01255000
               FOR SELECT                                              *01256000
                   ZERO_NBR,                                           *01257000
                   AUDIT_DATE_KEY,                                     *01258000
                   AUDIT_TIME_KEY,                                     *01259000
                   UNIQUE_CODE,                                        *01260000
                   AUDIT_TIME_SUBS,                                    *01261000
                   TRAN_CODE,                                          *01262000
                   INST_NBR,                                           *01263000
                   FORMAT_ID,                                          *01264000
                   LOG_CODE,                                           *01265000
                   SEGM_ID,                                            *01266000
                   FUNC_CODE,                                          *01267000
                   AUDIT_USER,                                         *01268000
                   RECORD_LENGTH,                                      *01269000
                   TERMINAL_ID,                                        *01270000
                   WORK_ID,                                            *01271000
                   PANEL_ID,                                           *01272000
                   TRAN_BEGIN,                                         *01273000
                   APPLIC_SEQ,                                         *01274000
                   DATA_1,                                             *01275000
                   DATA_2,                                             *01276000
                   DATA_3                                              *01277000
                 FROM SAE                                              *01278000
                 WHERE                                                 *01279000
                   ZERO_NBR >                                          *01280000
                     :ZERONBR                                          *01281000
                 ORDER BY ZERO_NBR ASC,                                *01282000
                   AUDIT_DATE_KEY ASC,                                 *01283000
                   AUDIT_TIME_KEY ASC,                                 *01284000
                   UNIQUE_CODE ASC,                                    *01285000
                   AUDIT_TIME_SUBS ASC,                                *01286000
                   TRAN_CODE ASC,                                      *01287000
                   INST_NBR ASC,                                       *01288000
                   FORMAT_ID ASC,                                      *01289000
                   LOG_CODE ASC,                                       *01290000
                   SEGM_ID ASC                                         *01291000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01292000
         EXEC  SQL OPEN SAEGT010                                        01293000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01294000
         BNZ   *+14                    NO - RETURN ERROR                01295000
         MVC   SQWCSRCA,=A(CLSGT010)   SET CURSOR CLOSE ROUTINE ADDRESS 01296000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01297000
         BR    12                      RETURN TO FETCH ROUTINE          01298000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01299000
         BR    14                      RETURN TO CALLER                 01300000
         LTORG                                                          01301000
*                                                                       01302000
**********************************************************************  01303000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               01304000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01305000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01306000
*     RETRIEVE THE ACTUAL ROW.                                          01307000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01308000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01309000
**********************************************************************  01310000
*                                                                       01311000
FETDC0   DS    0H                                                       01312000
         USING FETDC0,12               ESTABLISH BASE REGISTER          01313000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       01314000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01315000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       01316000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01317000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    01318000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01319000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01320000
FETDC0P  DC    A(FETGE001)                                              01321000
         DC    A(FETGT002)                                              01322000
         DC    A(FETGT003)                                              01323000
         DC    A(FETGT004)                                              01324000
         DC    A(FETGT005)                                              01325000
         DC    A(FETGT006)                                              01326000
         DC    A(FETGT007)                                              01327000
         DC    A(FETGT008)                                              01328000
         DC    A(FETGT009)                                              01329000
         DC    A(FETGT010)                                              01330000
         DC    A(FETGE002)                                              01331000
         DC    A(FETGT003)                                              01332000
         DC    A(FETGT004)                                              01333000
         DC    A(FETGT005)                                              01334000
         DC    A(FETGT006)                                              01335000
         DC    A(FETGT007)                                              01336000
         DC    A(FETGT008)                                              01337000
         DC    A(FETGT009)                                              01338000
         DC    A(FETGT010)                                              01339000
         DC    A(FETGE003)                                              01340000
         DC    A(FETGT004)                                              01341000
         DC    A(FETGT005)                                              01342000
         DC    A(FETGT006)                                              01343000
         DC    A(FETGT007)                                              01344000
         DC    A(FETGT008)                                              01345000
         DC    A(FETGT009)                                              01346000
         DC    A(FETGT010)                                              01347000
         DC    A(FETGE004)                                              01348000
         DC    A(FETGT005)                                              01349000
         DC    A(FETGT006)                                              01350000
         DC    A(FETGT007)                                              01351000
         DC    A(FETGT008)                                              01352000
         DC    A(FETGT009)                                              01353000
         DC    A(FETGT010)                                              01354000
         DC    A(FETGE005)                                              01355000
         DC    A(FETGT006)                                              01356000
         DC    A(FETGT007)                                              01357000
         DC    A(FETGT008)                                              01358000
         DC    A(FETGT009)                                              01359000
         DC    A(FETGT010)                                              01360000
         DC    A(FETGE006)                                              01361000
         DC    A(FETGT007)                                              01362000
         DC    A(FETGT008)                                              01363000
         DC    A(FETGT009)                                              01364000
         DC    A(FETGT010)                                              01365000
         DC    A(FETGE007)                                              01366000
         DC    A(FETGT008)                                              01367000
         DC    A(FETGT009)                                              01368000
         DC    A(FETGT010)                                              01369000
         DC    A(FETGE008)                                              01370000
         DC    A(FETGT009)                                              01371000
         DC    A(FETGT010)                                              01372000
         DC    A(FETGE009)                                              01373000
         DC    A(FETGT010)                                              01374000
         DC    A(FETGE010)                                              01375000
         DC    A(0)                                                     01376000
         LTORG                                                          01377000
*                                                                       01378000
**********************************************************************  01379000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01380000
* THE PRIMARY KEY:                                                      01381000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01382000
*     VERBS.                                                            01383000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01384000
*     RETRIEVE THE ACTUAL ROW.                                          01385000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01386000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01387000
*     WILL BE THRU THE UPDATE CURSOR.                                   01388000
**********************************************************************  01389000
*                                                                       01390000
FETKC0   DS    0H                                                       01391000
         USING FETKC0,12               ESTABLISH BASE REGISTER          01392000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       01393000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01394000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           01395000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01396000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    01397000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01398000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01399000
FETKC0P  DC    A(FETGE001)                                              01400000
         DC    A(FETGT002)                                              01401000
         DC    A(FETGT003)                                              01402000
         DC    A(FETGT004)                                              01403000
         DC    A(FETGT005)                                              01404000
         DC    A(FETGT006)                                              01405000
         DC    A(FETGT007)                                              01406000
         DC    A(FETGT008)                                              01407000
         DC    A(FETGT009)                                              01408000
         DC    A(FETGT010)                                              01409000
         DC    A(FETGE002)                                              01410000
         DC    A(FETGT003)                                              01411000
         DC    A(FETGT004)                                              01412000
         DC    A(FETGT005)                                              01413000
         DC    A(FETGT006)                                              01414000
         DC    A(FETGT007)                                              01415000
         DC    A(FETGT008)                                              01416000
         DC    A(FETGT009)                                              01417000
         DC    A(FETGT010)                                              01418000
         DC    A(FETGE003)                                              01419000
         DC    A(FETGT004)                                              01420000
         DC    A(FETGT005)                                              01421000
         DC    A(FETGT006)                                              01422000
         DC    A(FETGT007)                                              01423000
         DC    A(FETGT008)                                              01424000
         DC    A(FETGT009)                                              01425000
         DC    A(FETGT010)                                              01426000
         DC    A(FETGE004)                                              01427000
         DC    A(FETGT005)                                              01428000
         DC    A(FETGT006)                                              01429000
         DC    A(FETGT007)                                              01430000
         DC    A(FETGT008)                                              01431000
         DC    A(FETGT009)                                              01432000
         DC    A(FETGT010)                                              01433000
         DC    A(FETGE005)                                              01434000
         DC    A(FETGT006)                                              01435000
         DC    A(FETGT007)                                              01436000
         DC    A(FETGT008)                                              01437000
         DC    A(FETGT009)                                              01438000
         DC    A(FETGT010)                                              01439000
         DC    A(FETGE006)                                              01440000
         DC    A(FETGT007)                                              01441000
         DC    A(FETGT008)                                              01442000
         DC    A(FETGT009)                                              01443000
         DC    A(FETGT010)                                              01444000
         DC    A(FETGE007)                                              01445000
         DC    A(FETGT008)                                              01446000
         DC    A(FETGT009)                                              01447000
         DC    A(FETGT010)                                              01448000
         DC    A(FETGE008)                                              01449000
         DC    A(FETGT009)                                              01450000
         DC    A(FETGT010)                                              01451000
         DC    A(FETGE009)                                              01452000
         DC    A(FETGT010)                                              01453000
         DC    A(FETGE010)                                              01454000
         DC    A(0)                                                     01455000
         LTORG                                                          01456000
*                                                                       01457000
FETGE001 DS    0H                                                       01458000
         USING FETGE001,12             ESTABLISH BASE REGISTER          01459000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01460000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01461000
         BALR  14,15                   MOVE REQUESTED DATA              01462000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE001                     *01463000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01464000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01465000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01466000
         BALR  14,15                   MOVE REQUESTED DATA              01467000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01468000
         BR    14                      RETURN TO CALLER                 01469000
         LTORG                                                          01470000
*                                                                       01471000
FETGE002 DS    0H                                                       01472000
         USING FETGE002,12             ESTABLISH BASE REGISTER          01473000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01474000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01475000
         BALR  14,15                   MOVE REQUESTED DATA              01476000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE002                     *01477000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01478000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01479000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01480000
         BALR  14,15                   MOVE REQUESTED DATA              01481000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01482000
         BR    14                      RETURN TO CALLER                 01483000
         LTORG                                                          01484000
*                                                                       01485000
FETGE003 DS    0H                                                       01486000
         USING FETGE003,12             ESTABLISH BASE REGISTER          01487000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01488000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01489000
         BALR  14,15                   MOVE REQUESTED DATA              01490000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE003                     *01491000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01492000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01493000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01494000
         BALR  14,15                   MOVE REQUESTED DATA              01495000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01496000
         BR    14                      RETURN TO CALLER                 01497000
         LTORG                                                          01498000
*                                                                       01499000
FETGE004 DS    0H                                                       01500000
         USING FETGE004,12             ESTABLISH BASE REGISTER          01501000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01502000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01503000
         BALR  14,15                   MOVE REQUESTED DATA              01504000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE004                     *01505000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01506000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01507000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01508000
         BALR  14,15                   MOVE REQUESTED DATA              01509000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01510000
         BR    14                      RETURN TO CALLER                 01511000
         LTORG                                                          01512000
*                                                                       01513000
FETGE005 DS    0H                                                       01514000
         USING FETGE005,12             ESTABLISH BASE REGISTER          01515000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01516000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01517000
         BALR  14,15                   MOVE REQUESTED DATA              01518000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE005                     *01519000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01520000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01521000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01522000
         BALR  14,15                   MOVE REQUESTED DATA              01523000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01524000
         BR    14                      RETURN TO CALLER                 01525000
         LTORG                                                          01526000
*                                                                       01527000
FETGE006 DS    0H                                                       01528000
         USING FETGE006,12             ESTABLISH BASE REGISTER          01529000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01530000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01531000
         BALR  14,15                   MOVE REQUESTED DATA              01532000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE006                     *01533000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01534000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01535000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01536000
         BALR  14,15                   MOVE REQUESTED DATA              01537000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01538000
         BR    14                      RETURN TO CALLER                 01539000
         LTORG                                                          01540000
*                                                                       01541000
FETGE007 DS    0H                                                       01542000
         USING FETGE007,12             ESTABLISH BASE REGISTER          01543000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01544000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01545000
         BALR  14,15                   MOVE REQUESTED DATA              01546000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE007                     *01547000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01548000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01549000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01550000
         BALR  14,15                   MOVE REQUESTED DATA              01551000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01552000
         BR    14                      RETURN TO CALLER                 01553000
         LTORG                                                          01554000
*                                                                       01555000
FETGE008 DS    0H                                                       01556000
         USING FETGE008,12             ESTABLISH BASE REGISTER          01557000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01558000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01559000
         BALR  14,15                   MOVE REQUESTED DATA              01560000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE008                     *01561000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01562000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01563000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01564000
         BALR  14,15                   MOVE REQUESTED DATA              01565000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01566000
         BR    14                      RETURN TO CALLER                 01567000
         LTORG                                                          01568000
*                                                                       01569000
FETGE009 DS    0H                                                       01570000
         USING FETGE009,12             ESTABLISH BASE REGISTER          01571000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01572000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01573000
         BALR  14,15                   MOVE REQUESTED DATA              01574000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE009                     *01575000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01576000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01577000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01578000
         BALR  14,15                   MOVE REQUESTED DATA              01579000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01580000
         BR    14                      RETURN TO CALLER                 01581000
         LTORG                                                          01582000
*                                                                       01583000
FETGE010 DS    0H                                                       01584000
         USING FETGE010,12             ESTABLISH BASE REGISTER          01585000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01586000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01587000
         BALR  14,15                   MOVE REQUESTED DATA              01588000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGE010                     *01589000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01590000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01591000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01592000
         BALR  14,15                   MOVE REQUESTED DATA              01593000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01594000
         BR    14                      RETURN TO CALLER                 01595000
         LTORG                                                          01596000
*                                                                       01597000
FETGT002 DS    0H                                                       01598000
         USING FETGT002,12             ESTABLISH BASE REGISTER          01599000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01600000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01601000
         BALR  14,15                   MOVE REQUESTED DATA              01602000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT002                     *01603000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01604000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01605000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01606000
         BALR  14,15                   MOVE REQUESTED DATA              01607000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01608000
         BR    14                      RETURN TO CALLER                 01609000
         LTORG                                                          01610000
*                                                                       01611000
FETGT003 DS    0H                                                       01612000
         USING FETGT003,12             ESTABLISH BASE REGISTER          01613000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01614000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01615000
         BALR  14,15                   MOVE REQUESTED DATA              01616000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT003                     *01617000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01618000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01619000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01620000
         BALR  14,15                   MOVE REQUESTED DATA              01621000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01622000
         BR    14                      RETURN TO CALLER                 01623000
         LTORG                                                          01624000
*                                                                       01625000
FETGT004 DS    0H                                                       01626000
         USING FETGT004,12             ESTABLISH BASE REGISTER          01627000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01628000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01629000
         BALR  14,15                   MOVE REQUESTED DATA              01630000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT004                     *01631000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01632000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01633000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01634000
         BALR  14,15                   MOVE REQUESTED DATA              01635000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01636000
         BR    14                      RETURN TO CALLER                 01637000
         LTORG                                                          01638000
*                                                                       01639000
FETGT005 DS    0H                                                       01640000
         USING FETGT005,12             ESTABLISH BASE REGISTER          01641000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01642000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01643000
         BALR  14,15                   MOVE REQUESTED DATA              01644000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT005                     *01645000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01646000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01647000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01648000
         BALR  14,15                   MOVE REQUESTED DATA              01649000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01650000
         BR    14                      RETURN TO CALLER                 01651000
         LTORG                                                          01652000
*                                                                       01653000
FETGT006 DS    0H                                                       01654000
         USING FETGT006,12             ESTABLISH BASE REGISTER          01655000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01656000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01657000
         BALR  14,15                   MOVE REQUESTED DATA              01658000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT006                     *01659000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01660000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01661000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01662000
         BALR  14,15                   MOVE REQUESTED DATA              01663000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01664000
         BR    14                      RETURN TO CALLER                 01665000
         LTORG                                                          01666000
*                                                                       01667000
FETGT007 DS    0H                                                       01668000
         USING FETGT007,12             ESTABLISH BASE REGISTER          01669000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01670000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01671000
         BALR  14,15                   MOVE REQUESTED DATA              01672000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT007                     *01673000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01674000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01675000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01676000
         BALR  14,15                   MOVE REQUESTED DATA              01677000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01678000
         BR    14                      RETURN TO CALLER                 01679000
         LTORG                                                          01680000
*                                                                       01681000
FETGT008 DS    0H                                                       01682000
         USING FETGT008,12             ESTABLISH BASE REGISTER          01683000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01684000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01685000
         BALR  14,15                   MOVE REQUESTED DATA              01686000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT008                     *01687000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01688000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01689000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01690000
         BALR  14,15                   MOVE REQUESTED DATA              01691000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01692000
         BR    14                      RETURN TO CALLER                 01693000
         LTORG                                                          01694000
*                                                                       01695000
FETGT009 DS    0H                                                       01696000
         USING FETGT009,12             ESTABLISH BASE REGISTER          01697000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01698000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01699000
         BALR  14,15                   MOVE REQUESTED DATA              01700000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT009                     *01701000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01702000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01703000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01704000
         BALR  14,15                   MOVE REQUESTED DATA              01705000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01706000
         BR    14                      RETURN TO CALLER                 01707000
         LTORG                                                          01708000
*                                                                       01709000
FETGT010 DS    0H                                                       01710000
         USING FETGT010,12             ESTABLISH BASE REGISTER          01711000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01712000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01713000
         BALR  14,15                   MOVE REQUESTED DATA              01714000
         EXEC  SQL FETCH NEXT ROWSET FROM SAEGT010                     *01715000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01716000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01717000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01718000
         BALR  14,15                   MOVE REQUESTED DATA              01719000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01720000
         BR    14                      RETURN TO CALLER                 01721000
         LTORG                                                          01722000
*                                                                       01723000
**********************************************************************  01724000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01725000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01726000
*     AND GET-NEXT-LOCK VERBS.                                          01727000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01728000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01729000
**********************************************************************  01730000
*                                                                       01731000
CLSXC0   DS    0H                                                       01732000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          01733000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 01734000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  01735000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       01736000
         LTORG                                                          01737000
*                                                                       01738000
CLSGE001 DS    0H                                                       01739000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          01740000
         EXEC  SQL CLOSE SAEGE001                                       01741000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01742000
         BR    14                      RETURN TO CALLER                 01743000
         LTORG                                                          01744000
*                                                                       01745000
CLSGE002 DS    0H                                                       01746000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          01747000
         EXEC  SQL CLOSE SAEGE002                                       01748000
         L     14,SQW@RET                                               01749000
         BR    14                                                       01750000
         LTORG                                                          01751000
*                                                                       01752000
CLSGE003 DS    0H                                                       01753000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          01754000
         EXEC  SQL CLOSE SAEGE003                                       01755000
         L     14,SQW@RET                                               01756000
         BR    14                                                       01757000
         LTORG                                                          01758000
*                                                                       01759000
CLSGE004 DS    0H                                                       01760000
         USING CLSGE004,12             ESTABLISH BASE REGISTER          01761000
         EXEC  SQL CLOSE SAEGE004                                       01762000
         L     14,SQW@RET                                               01763000
         BR    14                                                       01764000
         LTORG                                                          01765000
*                                                                       01766000
CLSGE005 DS    0H                                                       01767000
         USING CLSGE005,12             ESTABLISH BASE REGISTER          01768000
         EXEC  SQL CLOSE SAEGE005                                       01769000
         L     14,SQW@RET                                               01770000
         BR    14                                                       01771000
         LTORG                                                          01772000
*                                                                       01773000
CLSGE006 DS    0H                                                       01774000
         USING CLSGE006,12             ESTABLISH BASE REGISTER          01775000
         EXEC  SQL CLOSE SAEGE006                                       01776000
         L     14,SQW@RET                                               01777000
         BR    14                                                       01778000
         LTORG                                                          01779000
*                                                                       01780000
CLSGE007 DS    0H                                                       01781000
         USING CLSGE007,12             ESTABLISH BASE REGISTER          01782000
         EXEC  SQL CLOSE SAEGE007                                       01783000
         L     14,SQW@RET                                               01784000
         BR    14                                                       01785000
         LTORG                                                          01786000
*                                                                       01787000
CLSGE008 DS    0H                                                       01788000
         USING CLSGE008,12             ESTABLISH BASE REGISTER          01789000
         EXEC  SQL CLOSE SAEGE008                                       01790000
         L     14,SQW@RET                                               01791000
         BR    14                                                       01792000
         LTORG                                                          01793000
*                                                                       01794000
CLSGE009 DS    0H                                                       01795000
         USING CLSGE009,12             ESTABLISH BASE REGISTER          01796000
         EXEC  SQL CLOSE SAEGE009                                       01797000
         L     14,SQW@RET                                               01798000
         BR    14                                                       01799000
         LTORG                                                          01800000
*                                                                       01801000
CLSGE010 DS    0H                                                       01802000
         USING CLSGE010,12             ESTABLISH BASE REGISTER          01803000
         EXEC  SQL CLOSE SAEGE010                                       01804000
         L     14,SQW@RET                                               01805000
         BR    14                                                       01806000
         LTORG                                                          01807000
*                                                                       01808000
CLSGT002 DS    0H                                                       01809000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          01810000
         EXEC  SQL CLOSE SAEGT002                                       01811000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01812000
         BR    14                      RETURN TO CALLER                 01813000
         LTORG                                                          01814000
*                                                                       01815000
CLSGT003 DS    0H                                                       01816000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          01817000
         EXEC  SQL CLOSE SAEGT003                                       01818000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01819000
         BR    14                      RETURN TO CALLER                 01820000
         LTORG                                                          01821000
*                                                                       01822000
CLSGT004 DS    0H                                                       01823000
         USING CLSGT004,12             ESTABLISH BASE REGISTER          01824000
         EXEC  SQL CLOSE SAEGT004                                       01825000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01826000
         BR    14                      RETURN TO CALLER                 01827000
         LTORG                                                          01828000
*                                                                       01829000
CLSGT005 DS    0H                                                       01830000
         USING CLSGT005,12             ESTABLISH BASE REGISTER          01831000
         EXEC  SQL CLOSE SAEGT005                                       01832000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01833000
         BR    14                      RETURN TO CALLER                 01834000
         LTORG                                                          01835000
*                                                                       01836000
CLSGT006 DS    0H                                                       01837000
         USING CLSGT006,12             ESTABLISH BASE REGISTER          01838000
         EXEC  SQL CLOSE SAEGT006                                       01839000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01840000
         BR    14                      RETURN TO CALLER                 01841000
         LTORG                                                          01842000
*                                                                       01843000
CLSGT007 DS    0H                                                       01844000
         USING CLSGT007,12             ESTABLISH BASE REGISTER          01845000
         EXEC  SQL CLOSE SAEGT007                                       01846000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01847000
         BR    14                      RETURN TO CALLER                 01848000
         LTORG                                                          01849000
*                                                                       01850000
CLSGT008 DS    0H                                                       01851000
         USING CLSGT008,12             ESTABLISH BASE REGISTER          01852000
         EXEC  SQL CLOSE SAEGT008                                       01853000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01854000
         BR    14                      RETURN TO CALLER                 01855000
         LTORG                                                          01856000
*                                                                       01857000
CLSGT009 DS    0H                                                       01858000
         USING CLSGT009,12             ESTABLISH BASE REGISTER          01859000
         EXEC  SQL CLOSE SAEGT009                                       01860000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01861000
         BR    14                      RETURN TO CALLER                 01862000
         LTORG                                                          01863000
*                                                                       01864000
CLSGT010 DS    0H                                                       01865000
         USING CLSGT010,12             ESTABLISH BASE REGISTER          01866000
         EXEC  SQL CLOSE SAEGT010                                       01867000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01868000
         BR    14                      RETURN TO CALLER                 01869000
         LTORG                                                          01870000
*                                                                       01871000
**********************************************************************  01872000
* ALTERNATE KEY 1 NOT DEFINED                                           01873000
**********************************************************************  01874000
*                                                                       01875000
SELIN1   DS    0H                                                       01876000
SELKY1   DS    0H                                                       01877000
SELXC1   DS    0H                                                       01878000
FETDC1   DS    0H                                                       01879000
FETKC1   DS    0H                                                       01880000
CLSXC1   DS    0H                                                       01881000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 01882000
*                                                                       01883000
**********************************************************************  01884000
* ALTERNATE KEY 2 NOT DEFINED                                           01885000
**********************************************************************  01886000
*                                                                       01887000
SELIN2   DS    0H                                                       01888000
SELKY2   DS    0H                                                       01889000
SELXC2   DS    0H                                                       01890000
FETDC2   DS    0H                                                       01891000
FETKC2   DS    0H                                                       01892000
CLSXC2   DS    0H                                                       01893000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 01894000
*                                                                       01895000
**********************************************************************  01896000
* ALTERNATE KEY 3 NOT DEFINED                                           01897000
**********************************************************************  01898000
*                                                                       01899000
SELIN3   DS    0H                                                       01900000
SELKY3   DS    0H                                                       01901000
SELXC3   DS    0H                                                       01902000
FETDC3   DS    0H                                                       01903000
FETKC3   DS    0H                                                       01904000
CLSXC3   DS    0H                                                       01905000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 01906000
*                                                                       01907000
         DS    0H                      END OF SQL STATEMENTS            01908000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01909000
*                                                                       01910000
**********************************************************************  01911000
* DUMMY ENTRY POINT DSNHLI                                              01912000
**********************************************************************  01913000
*                                                                       01914000
         ENTRY DSNHLI                                                   01915000
DSNHLI   DS    0H                                                       01916000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01917000
         BR    15                      BRANCH TO ATTACH FACILITY        01918000
*                                                                       01919000
**********************************************************************  01920000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01921000
**********************************************************************  01922000
*                                                                       01923000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       01924000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      01925000
* OR:                                                                   01926000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      01927000
* WHERE:                                                                01928000
*   RRRR = RECORD AREA OFFSET                                           01929000
*   VVVV = HOST VARIABLE AREA OFFSET                                    01930000
*   LLLL = HALFWORD LENGTH TO MOVE                                      01931000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       01932000
*   KK   = KEY FIELD MASK:                                              01933000
*            80 = KEY 0 FIELD                                           01934000
*            40 = KEY 1 FIELD                                           01935000
*            20 = KEY 2 FIELD                                           01936000
*            10 = KEY 3 FIELD                                           01937000
*   DD   = DATA FIELD MASK:                                             01938000
*            80 = RECORD FIELD IS PACKED                                01939000
*            40 = HOST VARIABLE IS PACKED                               01940000
*            20 = NULLABLE FIELD                                        01941000
*            01 = DATE FIELD                                            01942000
*            02 = TIME FIELD                                            01943000
*                                                                       01944000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 01945000
         DC    H'0000',H'0000',H'0038',X'80',X'00'                      01946000
         DC    H'0038',H'0038',H'0009',X'00',X'00'                      01947000
         DC    H'0047',H'0048',H'0545',X'00',X'00'                      01948000
         DC    8X'FF'                                                   01949000
*                                                                       01950000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               01951000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  01952000
* OR:                                                                   01953000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  01954000
* WHERE:                                                                01955000
*   RRRR = RECORD AREA OFFSET                                           01956000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     01957000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      01958000
*   TTTT = SQLDA DATA TYPE:                                             01959000
*            452 = CHAR       453 = CHAR NULLABLE                       01960000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    01961000
*            496 = INTEGER    497 = INTEGER NULLABLE                    01962000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   01963000
*                                                                       01964000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      01965000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 01966000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       01967000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    01968000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       01969000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       01970000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       01971000
         DC    AL2(00592)              SUMMATION OF ALL COLUMN LENGTHS  01972000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     01973000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       01974000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       01975000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       01976000
         DC    AL2(00004)              PRIMARY KEY LOW VALUE LEVEL      01977000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        01978000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        01979000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        01980000
CONVDATA DS    0H                                                       01981000
         DC    H'0000',H'0004',H'452'  ZERO_NBR                         01982000
         DC    H'0004',H'0009',H'452'  AUDIT_DATE_KEY                   01983000
         DC    H'0013',H'0007',H'452'  AUDIT_TIME_KEY                   01984000
         DC    H'0020',H'0004',H'452'  UNIQUE_CODE                      01985000
         DC    H'0024',H'0002',H'452'  AUDIT_TIME_SUBS                  01986000
         DC    H'0026',H'0003',H'452'  TRAN_CODE                        01987000
         DC    H'0029',H'0004',H'452'  INST_NBR                         01988000
         DC    H'0033',H'0001',H'452'  FORMAT_ID                        01989000
         DC    H'0034',H'0001',H'452'  LOG_CODE                         01990000
         DC    H'0035',H'0003',H'452'  SEGM_ID                          01991000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   01992000
         DC    H'0038',H'0001',H'452'  FUNC_CODE                        01993000
         DC    H'0039',H'0008',H'452'  AUDIT_USER                       01994000
         DC    H'0047',H'0002',H'500'  RECORD_LENGTH                    01995000
         DC    H'0049',H'0008',H'452'  TERMINAL_ID                      01996000
         DC    H'0057',H'0008',H'452'  WORK_ID                          01997000
         DC    H'0065',H'0008',H'452'  PANEL_ID                         01998000
         DC    H'0073',X'0700',H'484'  TRAN_BEGIN                       01999000
         DC    H'0077',X'0500',H'484'  APPLIC_SEQ                       02000000
         DC    H'0080',H'0250',H'452'  DATA_1                           02001000
         DC    H'0330',H'0250',H'452'  DATA_2                           02002000
         DC    H'0580',H'0012',H'452'  DATA_3                           02003000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       02004000
KY0COLMS EQU   00010                   NUMBER OF PRIMARY KEY COLUMNS    02005000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      02006000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      02007000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      02008000
*                                                                       02009000
         LTORG                                                          02010000
         END                                                            02011000
