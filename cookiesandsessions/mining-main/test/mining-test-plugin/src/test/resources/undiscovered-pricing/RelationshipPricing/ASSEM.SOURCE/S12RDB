**********************************************************************  00001000
*                                                                       00002000
*  S12RDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S12 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
SS_TABLE DS    CL6                                                      00052000
AUDDATE  DS    PL5'0.'                                                  00053000
AUDTIME  DS    PL5'0.'                                                  00054000
AUDUSER  DS    CL8                                                      00055000
AUDORG   DS    CL6                                                      00056000
BALOPT   DS    CL1                                                      00057000
AMOUNT1  DS    PL6'0.00'                                                00058000
SECSERV1 DS    CL6                                                      00059000
AMOUNT2  DS    PL6'0.00'                                                00060000
SECSERV2 DS    CL6                                                      00061000
AMOUNT3  DS    PL6'0.00'                                                00062000
SECSERV3 DS    CL6                                                      00063000
AMOUNT4  DS    PL6'0.00'                                                00064000
SECSERV4 DS    CL6                                                      00065000
AMOUNT5  DS    PL6'0.00'                                                00066000
SECSERV5 DS    CL6                                                      00067000
AMOUNT6  DS    PL6'0.00'                                                00068000
SECSERV6 DS    CL6                                                      00069000
AMOUNT7  DS    PL6'0.00'                                                00070000
SECSERV7 DS    CL6                                                      00071000
AMOUNT8  DS    PL6'0.00'                                                00072000
SECSERV8 DS    CL6                                                      00073000
AMOUNT9  DS    PL6'0.00'                                                00074000
SECSERV9 DS    CL6                                                      00075000
AMOUNT10 DS    PL6'0.00'                                                00076000
SECSER10 DS    CL6                                                      00077000
*                                                                       00078000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00079000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00080000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00081000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00082000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00083000
         DS    CL97                    RESERVED                         00084000
*                                                                       00085000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00086000
INDVARX  DS    0H                                                       00087000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00088000
*                                                                       00089000
*                                                                       00090000
**********************************************************************  00091000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00092000
**********************************************************************  00093000
*                                                                       00094000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00095000
*                                                                       00096000
**********************************************************************  00097000
* PROGRAM TABLE HEADER SECTION:                                         00098000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00099000
**********************************************************************  00100000
*                                                                       00101000
S12RDB   CSECT                         PROGRAM TABLE SECTION            00102000
S12RDB   AMODE ANY                                                      00103000
S12RDB   RMODE ANY                                                      00104000
         DC    CL8'S12RDB  '           PROGRAM ID                       00105000
         DC    CL1' '                                                   00106000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00107000
         DC    CL1' '                                                   00108000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00109000
         DC    CL1' '                                                   00110000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00111000
         DC    5A(0)                   RESERVED                         00112000
         DC    AL2(0)                  RESERVED                         00113000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00114000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00115000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00116000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00117000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00118000
         DC    CL29'WWW.INFOR.COM                '                      00118001
*                                                                       00119000
**********************************************************************  00120000
* STATEMENT TABLE SECTION:                                              00121000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00122000
**********************************************************************  00123000
*                                                                       00124000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00125000
STM#TAB  AMODE ANY                                                      00126000
STM#TAB  RMODE ANY                                                      00127000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00128000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00129000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00130000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00131000
         DC    12A(0)                  UDB MODULE VECTORS               00132000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00133000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00134000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00135000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00136000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00137000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00138000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00139000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00140000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00141000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00142000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00143000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00144000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00145000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00146000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00147000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00148000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00149000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00150000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00151000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00152000
         DC    10A(0)                  UDB MODULE VECTORS               00153000
         DC    4X'FF'                                                   00154000
*                                                                       00155000
**********************************************************************  00156000
* SQL STATEMENT SECTION:                                                00157000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00158000
*     TO SUPPORT THIS TABLE.                                            00159000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00160000
*     ARE EQUIVALENT.                                                   00161000
**********************************************************************  00162000
*                                                                       00163000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00164000
SQL#STMT AMODE ANY                                                      00165000
SQL#STMT RMODE ANY                                                      00166000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00167000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00168000
         USING COM#AREA,11             ADDRESS COMMAREA                 00169000
*                                                                       00170000
**********************************************************************  00171000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00172000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00173000
**********************************************************************  00174000
*                                                                       00175000
SELIN0   DS    0H                                                       00176000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00177000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00178000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00179000
         BALR  14,15                   MOVE REQUESTED DATA              00180000
         EXEC  SQL SELECT                                              *00181000
                   AUDIT_DATE,                                         *00182000
                   AUDIT_TIME,                                         *00183000
                   AUDIT_USER,                                         *00184000
                   AUDIT_ORG,                                          *00185000
                   BAL_OPT,                                            *00186000
                   AMOUNT_01,                                          *00187000
                   SEC_SVC_01,                                         *00188000
                   AMOUNT_02,                                          *00189000
                   SEC_SVC_02,                                         *00190000
                   AMOUNT_03,                                          *00191000
                   SEC_SVC_03,                                         *00192000
                   AMOUNT_04,                                          *00193000
                   SEC_SVC_04,                                         *00194000
                   AMOUNT_05,                                          *00195000
                   SEC_SVC_05,                                         *00196000
                   AMOUNT_06,                                          *00197000
                   SEC_SVC_06,                                         *00198000
                   AMOUNT_07,                                          *00199000
                   SEC_SVC_07,                                         *00200000
                   AMOUNT_08,                                          *00201000
                   SEC_SVC_08,                                         *00202000
                   AMOUNT_09,                                          *00203000
                   SEC_SVC_09,                                         *00204000
                   AMOUNT_10,                                          *00205000
                   SEC_SVC10                                           *00206000
                 INTO                                                  *00207000
                   :AUDDATE,                                           *00208000
                   :AUDTIME,                                           *00209000
                   :AUDUSER,                                           *00210000
                   :AUDORG,                                            *00211000
                   :BALOPT,                                            *00212000
                   :AMOUNT1,                                           *00213000
                   :SECSERV1,                                          *00214000
                   :AMOUNT2,                                           *00215000
                   :SECSERV2,                                          *00216000
                   :AMOUNT3,                                           *00217000
                   :SECSERV3,                                          *00218000
                   :AMOUNT4,                                           *00219000
                   :SECSERV4,                                          *00220000
                   :AMOUNT5,                                           *00221000
                   :SECSERV5,                                          *00222000
                   :AMOUNT6,                                           *00223000
                   :SECSERV6,                                          *00224000
                   :AMOUNT7,                                           *00225000
                   :SECSERV7,                                          *00226000
                   :AMOUNT8,                                           *00227000
                   :SECSERV8,                                          *00228000
                   :AMOUNT9,                                           *00229000
                   :SECSERV9,                                          *00230000
                   :AMOUNT10,                                          *00231000
                   :SECSER10                                           *00232000
                 FROM S12                                              *00233000
                 WHERE                                                 *00234000
                   INST_NBR = :INST AND                                *00235000
                   RECORD_NBR = :RECNBR AND                            *00236000
                   SEC_SVC_TABLE = :SS_TABLE                           *00237000
                 FETCH FIRST 1 ROW ONLY                                 00238000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00239000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00240000
         BALR  14,15                   MOVE REQUESTED DATA              00241000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00242000
         BR    14                      RETURN TO CALLER                 00243000
         LTORG                                                          00244000
*                                                                       00245000
**********************************************************************  00246000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00247000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00248000
**********************************************************************  00249000
*                                                                       00250000
SELKY0   DS    0H                                                       00251000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00252000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00253000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00254000
         BALR  14,15                   MOVE REQUESTED DATA              00255000
         EXEC  SQL SELECT                                              *00256000
                   COUNT(*)                                            *00257000
                 INTO                                                  *00258000
                   :SQWINTHV                                           *00259000
                 FROM S12                                              *00260000
                 WHERE                                                 *00261000
                   INST_NBR = :INST AND                                *00262000
                   RECORD_NBR = :RECNBR AND                            *00263000
                   SEC_SVC_TABLE = :SS_TABLE                           *00264000
                 FETCH FIRST 1 ROW ONLY                                 00265000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00266000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00267000
         BNER  14                      NO - RETURN TO CALLER            00268000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00269000
         BNER  14                      YES - RETURN ZERO SQLCODE        00270000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00271000
         BR    14                      RETURN TO CALLER                 00272000
         LTORG                                                          00273000
*                                                                       00274000
**********************************************************************  00275000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00276000
* KEY:                                                                  00277000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00278000
*     AND GET-NEXT-LOCK VERBS.                                          00279000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00280000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00281000
**********************************************************************  00282000
*                                                                       00283000
SELXC0   DS    0H                                                       00284000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00285000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00286000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00287000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00288000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00289000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00290000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00291000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00292000
SELXC0P  DC    A(SELGE001)                                              00293000
         DC    (KY0COLMS-01)A(0)                                        00294000
         DC    A(SELGE002)                                              00295000
         DC    (KY0COLMS-02)A(0)                                        00296000
         DC    A(SELGE003)                                              00297000
         LTORG                                                          00298000
*                                                                       00299000
SELGE001 DS    0H                                                       00300000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00301000
         EXEC  SQL DECLARE S12GE001 CURSOR                             *00302000
               WITH ROWSET POSITIONING                                 *00303000
               FOR SELECT                                              *00304000
                   INST_NBR,                                           *00305000
                   RECORD_NBR,                                         *00306000
                   SEC_SVC_TABLE,                                      *00307000
                   AUDIT_DATE,                                         *00308000
                   AUDIT_TIME,                                         *00309000
                   AUDIT_USER,                                         *00310000
                   AUDIT_ORG,                                          *00311000
                   BAL_OPT,                                            *00312000
                   AMOUNT_01,                                          *00313000
                   SEC_SVC_01,                                         *00314000
                   AMOUNT_02,                                          *00315000
                   SEC_SVC_02,                                         *00316000
                   AMOUNT_03,                                          *00317000
                   SEC_SVC_03,                                         *00318000
                   AMOUNT_04,                                          *00319000
                   SEC_SVC_04,                                         *00320000
                   AMOUNT_05,                                          *00321000
                   SEC_SVC_05,                                         *00322000
                   AMOUNT_06,                                          *00323000
                   SEC_SVC_06,                                         *00324000
                   AMOUNT_07,                                          *00325000
                   SEC_SVC_07,                                         *00326000
                   AMOUNT_08,                                          *00327000
                   SEC_SVC_08,                                         *00328000
                   AMOUNT_09,                                          *00329000
                   SEC_SVC_09,                                         *00330000
                   AMOUNT_10,                                          *00331000
                   SEC_SVC10                                           *00332000
                 FROM S12                                              *00333000
                 WHERE                                                 *00334000
                   INST_NBR = :INST AND                                *00335000
                   RECORD_NBR = :RECNBR AND                            *00336000
                   SEC_SVC_TABLE >=                                    *00337000
                     :SS_TABLE                                         *00338000
                 ORDER BY SEC_SVC_TABLE ASC                            *00339000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00340000
         EXEC  SQL OPEN S12GE001                                        00341000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00342000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00343000
         BR    14                      RETURN TO CALLER                 00344000
         LTORG                                                          00345000
*                                                                       00346000
SELGE002 DS    0H                                                       00347000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00348000
         EXEC  SQL DECLARE S12GE002 CURSOR                             *00349000
               WITH ROWSET POSITIONING                                 *00350000
               FOR SELECT                                              *00351000
                   INST_NBR,                                           *00352000
                   RECORD_NBR,                                         *00353000
                   SEC_SVC_TABLE,                                      *00354000
                   AUDIT_DATE,                                         *00355000
                   AUDIT_TIME,                                         *00356000
                   AUDIT_USER,                                         *00357000
                   AUDIT_ORG,                                          *00358000
                   BAL_OPT,                                            *00359000
                   AMOUNT_01,                                          *00360000
                   SEC_SVC_01,                                         *00361000
                   AMOUNT_02,                                          *00362000
                   SEC_SVC_02,                                         *00363000
                   AMOUNT_03,                                          *00364000
                   SEC_SVC_03,                                         *00365000
                   AMOUNT_04,                                          *00366000
                   SEC_SVC_04,                                         *00367000
                   AMOUNT_05,                                          *00368000
                   SEC_SVC_05,                                         *00369000
                   AMOUNT_06,                                          *00370000
                   SEC_SVC_06,                                         *00371000
                   AMOUNT_07,                                          *00372000
                   SEC_SVC_07,                                         *00373000
                   AMOUNT_08,                                          *00374000
                   SEC_SVC_08,                                         *00375000
                   AMOUNT_09,                                          *00376000
                   SEC_SVC_09,                                         *00377000
                   AMOUNT_10,                                          *00378000
                   SEC_SVC10                                           *00379000
                 FROM S12                                              *00380000
                 WHERE                                                 *00381000
                   INST_NBR = :INST AND                                *00382000
                   RECORD_NBR >=                                       *00383000
                     :RECNBR                                           *00384000
                 ORDER BY RECORD_NBR ASC,                              *00385000
                   SEC_SVC_TABLE ASC                                   *00386000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00387000
         EXEC  SQL OPEN S12GE002                                        00388000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00389000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00390000
         BR    14                      RETURN TO CALLER                 00391000
         LTORG                                                          00392000
*                                                                       00393000
SELGE003 DS    0H                                                       00394000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00395000
         EXEC  SQL DECLARE S12GE003 CURSOR                             *00396000
               WITH ROWSET POSITIONING                                 *00397000
               FOR SELECT                                              *00398000
                   INST_NBR,                                           *00399000
                   RECORD_NBR,                                         *00400000
                   SEC_SVC_TABLE,                                      *00401000
                   AUDIT_DATE,                                         *00402000
                   AUDIT_TIME,                                         *00403000
                   AUDIT_USER,                                         *00404000
                   AUDIT_ORG,                                          *00405000
                   BAL_OPT,                                            *00406000
                   AMOUNT_01,                                          *00407000
                   SEC_SVC_01,                                         *00408000
                   AMOUNT_02,                                          *00409000
                   SEC_SVC_02,                                         *00410000
                   AMOUNT_03,                                          *00411000
                   SEC_SVC_03,                                         *00412000
                   AMOUNT_04,                                          *00413000
                   SEC_SVC_04,                                         *00414000
                   AMOUNT_05,                                          *00415000
                   SEC_SVC_05,                                         *00416000
                   AMOUNT_06,                                          *00417000
                   SEC_SVC_06,                                         *00418000
                   AMOUNT_07,                                          *00419000
                   SEC_SVC_07,                                         *00420000
                   AMOUNT_08,                                          *00421000
                   SEC_SVC_08,                                         *00422000
                   AMOUNT_09,                                          *00423000
                   SEC_SVC_09,                                         *00424000
                   AMOUNT_10,                                          *00425000
                   SEC_SVC10                                           *00426000
                 FROM S12                                              *00427000
                 WHERE                                                 *00428000
                   INST_NBR >=                                         *00429000
                     :INST                                             *00430000
                 ORDER BY INST_NBR ASC,                                *00431000
                   RECORD_NBR ASC,                                     *00432000
                   SEC_SVC_TABLE ASC                                   *00433000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00434000
         EXEC  SQL OPEN S12GE003                                        00435000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00436000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00437000
         BR    14                      RETURN TO CALLER                 00438000
         LTORG                                                          00439000
*                                                                       00440000
**********************************************************************  00441000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00442000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00443000
**********************************************************************  00444000
*                                                                       00445000
NXTXC0   DS    0H                                                       00446000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00447000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00448000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00449000
         BALR  14,15                   MOVE REQUESTED DATA              00450000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00451000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00452000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00453000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00454000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00455000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00456000
NXTXC0P  DC    A(0)                                                     00457000
         DC    A(NXTGT002)                                              00458000
         DC    A(NXTGT003)                                              00459000
         DC    A(NXTGT099)                                              00460000
         DC    A(NXTGT003)                                              00461000
         DC    A(NXTGT099)                                              00462000
         DC    A(NXTGT099)                                              00463000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00464000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00465000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00466000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00467000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00468000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00469000
         BR    14                      RETURN TO SQI                    00470000
         LTORG                                                          00471000
*                                                                       00472000
NXTGT002 DS    0H                                                       00473000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00474000
         EXEC  SQL DECLARE S12GT002 CURSOR                             *00475000
               WITH ROWSET POSITIONING                                 *00476000
               FOR SELECT                                              *00477000
                   INST_NBR,                                           *00478000
                   RECORD_NBR,                                         *00479000
                   SEC_SVC_TABLE,                                      *00480000
                   AUDIT_DATE,                                         *00481000
                   AUDIT_TIME,                                         *00482000
                   AUDIT_USER,                                         *00483000
                   AUDIT_ORG,                                          *00484000
                   BAL_OPT,                                            *00485000
                   AMOUNT_01,                                          *00486000
                   SEC_SVC_01,                                         *00487000
                   AMOUNT_02,                                          *00488000
                   SEC_SVC_02,                                         *00489000
                   AMOUNT_03,                                          *00490000
                   SEC_SVC_03,                                         *00491000
                   AMOUNT_04,                                          *00492000
                   SEC_SVC_04,                                         *00493000
                   AMOUNT_05,                                          *00494000
                   SEC_SVC_05,                                         *00495000
                   AMOUNT_06,                                          *00496000
                   SEC_SVC_06,                                         *00497000
                   AMOUNT_07,                                          *00498000
                   SEC_SVC_07,                                         *00499000
                   AMOUNT_08,                                          *00500000
                   SEC_SVC_08,                                         *00501000
                   AMOUNT_09,                                          *00502000
                   SEC_SVC_09,                                         *00503000
                   AMOUNT_10,                                          *00504000
                   SEC_SVC10                                           *00505000
                 FROM S12                                              *00506000
                 WHERE                                                 *00507000
                   INST_NBR = :INST AND                                *00508000
                   RECORD_NBR >                                        *00509000
                     :RECNBR                                           *00510000
                 ORDER BY RECORD_NBR ASC,                              *00511000
                   SEC_SVC_TABLE ASC                                   *00512000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00513000
         EXEC  SQL OPEN S12GT002                                        00514000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00515000
         BNZ   *+14                    NO - RETURN ERROR                00516000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00517000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00518000
         BR    12                      RETURN TO FETCH ROUTINE          00519000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00520000
         BR    14                      RETURN TO CALLER                 00521000
         LTORG                                                          00522000
*                                                                       00523000
NXTGT003 DS    0H                                                       00524000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00525000
         EXEC  SQL DECLARE S12GT003 CURSOR                             *00526000
               WITH ROWSET POSITIONING                                 *00527000
               FOR SELECT                                              *00528000
                   INST_NBR,                                           *00529000
                   RECORD_NBR,                                         *00530000
                   SEC_SVC_TABLE,                                      *00531000
                   AUDIT_DATE,                                         *00532000
                   AUDIT_TIME,                                         *00533000
                   AUDIT_USER,                                         *00534000
                   AUDIT_ORG,                                          *00535000
                   BAL_OPT,                                            *00536000
                   AMOUNT_01,                                          *00537000
                   SEC_SVC_01,                                         *00538000
                   AMOUNT_02,                                          *00539000
                   SEC_SVC_02,                                         *00540000
                   AMOUNT_03,                                          *00541000
                   SEC_SVC_03,                                         *00542000
                   AMOUNT_04,                                          *00543000
                   SEC_SVC_04,                                         *00544000
                   AMOUNT_05,                                          *00545000
                   SEC_SVC_05,                                         *00546000
                   AMOUNT_06,                                          *00547000
                   SEC_SVC_06,                                         *00548000
                   AMOUNT_07,                                          *00549000
                   SEC_SVC_07,                                         *00550000
                   AMOUNT_08,                                          *00551000
                   SEC_SVC_08,                                         *00552000
                   AMOUNT_09,                                          *00553000
                   SEC_SVC_09,                                         *00554000
                   AMOUNT_10,                                          *00555000
                   SEC_SVC10                                           *00556000
                 FROM S12                                              *00557000
                 WHERE                                                 *00558000
                   INST_NBR >                                          *00559000
                     :INST                                             *00560000
                 ORDER BY INST_NBR ASC,                                *00561000
                   RECORD_NBR ASC,                                     *00562000
                   SEC_SVC_TABLE ASC                                   *00563000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00564000
         EXEC  SQL OPEN S12GT003                                        00565000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00566000
         BNZ   *+14                    NO - RETURN ERROR                00567000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00568000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00569000
         BR    12                      RETURN TO FETCH ROUTINE          00570000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00571000
         BR    14                      RETURN TO CALLER                 00572000
         LTORG                                                          00573000
*                                                                       00574000
**********************************************************************  00575000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00576000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00577000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00578000
*     RETRIEVE THE ACTUAL ROW.                                          00579000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00580000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00581000
**********************************************************************  00582000
*                                                                       00583000
FETDC0   DS    0H                                                       00584000
         USING FETDC0,12               ESTABLISH BASE REGISTER          00585000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       00586000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00587000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       00588000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00589000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    00590000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00591000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00592000
FETDC0P  DC    A(FETGE001)                                              00593000
         DC    A(FETGT002)                                              00594000
         DC    A(FETGT003)                                              00595000
         DC    A(FETGE002)                                              00596000
         DC    A(FETGT003)                                              00597000
         DC    A(FETGE003)                                              00598000
         DC    A(0)                                                     00599000
         LTORG                                                          00600000
*                                                                       00601000
**********************************************************************  00602000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00603000
* THE PRIMARY KEY:                                                      00604000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00605000
*     VERBS.                                                            00606000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00607000
*     RETRIEVE THE ACTUAL ROW.                                          00608000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00609000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00610000
*     WILL BE THRU THE UPDATE CURSOR.                                   00611000
**********************************************************************  00612000
*                                                                       00613000
FETKC0   DS    0H                                                       00614000
         USING FETKC0,12               ESTABLISH BASE REGISTER          00615000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       00616000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00617000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           00618000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00619000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    00620000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00621000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00622000
FETKC0P  DC    A(FETGE001)                                              00623000
         DC    A(FETGT002)                                              00624000
         DC    A(FETGT003)                                              00625000
         DC    A(FETGE002)                                              00626000
         DC    A(FETGT003)                                              00627000
         DC    A(FETGE003)                                              00628000
         DC    A(0)                                                     00629000
         LTORG                                                          00630000
*                                                                       00631000
FETGE001 DS    0H                                                       00632000
         USING FETGE001,12             ESTABLISH BASE REGISTER          00633000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00634000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00635000
         BALR  14,15                   MOVE REQUESTED DATA              00636000
         EXEC  SQL FETCH NEXT ROWSET FROM S12GE001                     *00637000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00638000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00639000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00640000
         BALR  14,15                   MOVE REQUESTED DATA              00641000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00642000
         BR    14                      RETURN TO CALLER                 00643000
         LTORG                                                          00644000
*                                                                       00645000
FETGE002 DS    0H                                                       00646000
         USING FETGE002,12             ESTABLISH BASE REGISTER          00647000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00648000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00649000
         BALR  14,15                   MOVE REQUESTED DATA              00650000
         EXEC  SQL FETCH NEXT ROWSET FROM S12GE002                     *00651000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00652000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00653000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00654000
         BALR  14,15                   MOVE REQUESTED DATA              00655000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00656000
         BR    14                      RETURN TO CALLER                 00657000
         LTORG                                                          00658000
*                                                                       00659000
FETGE003 DS    0H                                                       00660000
         USING FETGE003,12             ESTABLISH BASE REGISTER          00661000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00662000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00663000
         BALR  14,15                   MOVE REQUESTED DATA              00664000
         EXEC  SQL FETCH NEXT ROWSET FROM S12GE003                     *00665000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00666000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00667000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00668000
         BALR  14,15                   MOVE REQUESTED DATA              00669000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00670000
         BR    14                      RETURN TO CALLER                 00671000
         LTORG                                                          00672000
*                                                                       00673000
FETGT002 DS    0H                                                       00674000
         USING FETGT002,12             ESTABLISH BASE REGISTER          00675000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00676000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00677000
         BALR  14,15                   MOVE REQUESTED DATA              00678000
         EXEC  SQL FETCH NEXT ROWSET FROM S12GT002                     *00679000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00680000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00681000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00682000
         BALR  14,15                   MOVE REQUESTED DATA              00683000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00684000
         BR    14                      RETURN TO CALLER                 00685000
         LTORG                                                          00686000
*                                                                       00687000
FETGT003 DS    0H                                                       00688000
         USING FETGT003,12             ESTABLISH BASE REGISTER          00689000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00690000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00691000
         BALR  14,15                   MOVE REQUESTED DATA              00692000
         EXEC  SQL FETCH NEXT ROWSET FROM S12GT003                     *00693000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00694000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00695000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00696000
         BALR  14,15                   MOVE REQUESTED DATA              00697000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00698000
         BR    14                      RETURN TO CALLER                 00699000
         LTORG                                                          00700000
*                                                                       00701000
**********************************************************************  00702000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    00703000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00704000
*     AND GET-NEXT-LOCK VERBS.                                          00705000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00706000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00707000
**********************************************************************  00708000
*                                                                       00709000
CLSXC0   DS    0H                                                       00710000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          00711000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 00712000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00713000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       00714000
         LTORG                                                          00715000
*                                                                       00716000
CLSGE001 DS    0H                                                       00717000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          00718000
         EXEC  SQL CLOSE S12GE001                                       00719000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00720000
         BR    14                      RETURN TO CALLER                 00721000
         LTORG                                                          00722000
*                                                                       00723000
CLSGE002 DS    0H                                                       00724000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          00725000
         EXEC  SQL CLOSE S12GE002                                       00726000
         L     14,SQW@RET                                               00727000
         BR    14                                                       00728000
         LTORG                                                          00729000
*                                                                       00730000
CLSGE003 DS    0H                                                       00731000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          00732000
         EXEC  SQL CLOSE S12GE003                                       00733000
         L     14,SQW@RET                                               00734000
         BR    14                                                       00735000
         LTORG                                                          00736000
*                                                                       00737000
CLSGT002 DS    0H                                                       00738000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          00739000
         EXEC  SQL CLOSE S12GT002                                       00740000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00741000
         BR    14                      RETURN TO CALLER                 00742000
         LTORG                                                          00743000
*                                                                       00744000
CLSGT003 DS    0H                                                       00745000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          00746000
         EXEC  SQL CLOSE S12GT003                                       00747000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00748000
         BR    14                      RETURN TO CALLER                 00749000
         LTORG                                                          00750000
*                                                                       00751000
**********************************************************************  00752000
* ALTERNATE KEY 1 NOT DEFINED                                           00753000
**********************************************************************  00754000
*                                                                       00755000
SELIN1   DS    0H                                                       00756000
SELKY1   DS    0H                                                       00757000
SELXC1   DS    0H                                                       00758000
FETDC1   DS    0H                                                       00759000
FETKC1   DS    0H                                                       00760000
CLSXC1   DS    0H                                                       00761000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00762000
*                                                                       00763000
**********************************************************************  00764000
* ALTERNATE KEY 2 NOT DEFINED                                           00765000
**********************************************************************  00766000
*                                                                       00767000
SELIN2   DS    0H                                                       00768000
SELKY2   DS    0H                                                       00769000
SELXC2   DS    0H                                                       00770000
FETDC2   DS    0H                                                       00771000
FETKC2   DS    0H                                                       00772000
CLSXC2   DS    0H                                                       00773000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00774000
*                                                                       00775000
**********************************************************************  00776000
* ALTERNATE KEY 3 NOT DEFINED                                           00777000
**********************************************************************  00778000
*                                                                       00779000
SELIN3   DS    0H                                                       00780000
SELKY3   DS    0H                                                       00781000
SELXC3   DS    0H                                                       00782000
FETDC3   DS    0H                                                       00783000
FETKC3   DS    0H                                                       00784000
CLSXC3   DS    0H                                                       00785000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00786000
*                                                                       00787000
         DS    0H                      END OF SQL STATEMENTS            00788000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00789000
*                                                                       00790000
**********************************************************************  00791000
* DUMMY ENTRY POINT DSNHLI                                              00792000
**********************************************************************  00793000
*                                                                       00794000
         ENTRY DSNHLI                                                   00795000
DSNHLI   DS    0H                                                       00796000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00797000
         BR    15                      BRANCH TO ATTACH FACILITY        00798000
*                                                                       00799000
**********************************************************************  00800000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00801000
**********************************************************************  00802000
*                                                                       00803000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00804000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00805000
* OR:                                                                   00806000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00807000
* WHERE:                                                                00808000
*   RRRR = RECORD AREA OFFSET                                           00809000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00810000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00811000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00812000
*   KK   = KEY FIELD MASK:                                              00813000
*            80 = KEY 0 FIELD                                           00814000
*            40 = KEY 1 FIELD                                           00815000
*            20 = KEY 2 FIELD                                           00816000
*            10 = KEY 3 FIELD                                           00817000
*   DD   = DATA FIELD MASK:                                             00818000
*            80 = RECORD FIELD IS PACKED                                00819000
*            40 = HOST VARIABLE IS PACKED                               00820000
*            20 = NULLABLE FIELD                                        00821000
*            01 = DATE FIELD                                            00822000
*            02 = TIME FIELD                                            00823000
*                                                                       00824000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00825000
         DC    H'0000',H'0000',H'0014',X'80',X'00'                      00826000
         DC    H'0014',H'0014',H'0145',X'00',X'00'                      00827000
         DC    8X'FF'                                                   00828000
*                                                                       00829000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               00830000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  00831000
* OR:                                                                   00832000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  00833000
* WHERE:                                                                00834000
*   RRRR = RECORD AREA OFFSET                                           00835000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     00836000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      00837000
*   TTTT = SQLDA DATA TYPE:                                             00838000
*            452 = CHAR       453 = CHAR NULLABLE                       00839000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    00840000
*            496 = INTEGER    497 = INTEGER NULLABLE                    00841000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   00842000
*                                                                       00843000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      00844000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 00845000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       00846000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    00847000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       00848000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       00849000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       00850000
         DC    AL2(00159)              SUMMATION OF ALL COLUMN LENGTHS  00851000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     00852000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       00853000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       00854000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       00855000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      00856000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        00857000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        00858000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        00859000
CONVDATA DS    0H                                                       00860000
         DC    H'0000',H'0004',H'452'  INST_NBR                         00861000
         DC    H'0004',H'0004',H'452'  RECORD_NBR                       00862000
         DC    H'0008',H'0006',H'452'  SEC_SVC_TABLE                    00863000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   00864000
         DC    H'0014',X'0900',H'484'  AUDIT_DATE                       00865000
         DC    H'0019',X'0900',H'484'  AUDIT_TIME                       00866000
         DC    H'0024',H'0008',H'452'  AUDIT_USER                       00867000
         DC    H'0032',H'0006',H'452'  AUDIT_ORG                        00868000
         DC    H'0038',H'0001',H'452'  BAL_OPT                          00869000
         DC    H'0039',X'0B02',H'484'  AMOUNT_01                        00870000
         DC    H'0045',H'0006',H'452'  SEC_SVC_01                       00871000
         DC    H'0051',X'0B02',H'484'  AMOUNT_02                        00872000
         DC    H'0057',H'0006',H'452'  SEC_SVC_02                       00873000
         DC    H'0063',X'0B02',H'484'  AMOUNT_03                        00874000
         DC    H'0069',H'0006',H'452'  SEC_SVC_03                       00875000
         DC    H'0075',X'0B02',H'484'  AMOUNT_04                        00876000
         DC    H'0081',H'0006',H'452'  SEC_SVC_04                       00877000
         DC    H'0087',X'0B02',H'484'  AMOUNT_05                        00878000
         DC    H'0093',H'0006',H'452'  SEC_SVC_05                       00879000
         DC    H'0099',X'0B02',H'484'  AMOUNT_06                        00880000
         DC    H'0105',H'0006',H'452'  SEC_SVC_06                       00881000
         DC    H'0111',X'0B02',H'484'  AMOUNT_07                        00882000
         DC    H'0117',H'0006',H'452'  SEC_SVC_07                       00883000
         DC    H'0123',X'0B02',H'484'  AMOUNT_08                        00884000
         DC    H'0129',H'0006',H'452'  SEC_SVC_08                       00885000
         DC    H'0135',X'0B02',H'484'  AMOUNT_09                        00886000
         DC    H'0141',H'0006',H'452'  SEC_SVC_09                       00887000
         DC    H'0147',X'0B02',H'484'  AMOUNT_10                        00888000
         DC    H'0153',H'0006',H'452'  SEC_SVC10                        00889000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       00890000
KY0COLMS EQU   00003                   NUMBER OF PRIMARY KEY COLUMNS    00891000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      00892000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      00893000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      00894000
*                                                                       00895000
         LTORG                                                          00896000
         END                                                            00897000
