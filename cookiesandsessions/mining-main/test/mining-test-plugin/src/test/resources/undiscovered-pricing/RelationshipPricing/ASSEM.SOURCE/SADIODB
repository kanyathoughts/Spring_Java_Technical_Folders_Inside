* REL=SADIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SADIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAD FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL379                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST1    DS    CL4                                                      00038000
PRDCDE1  DS    CL6                                                      00039000
ACCTNBR1 DS    CL18                                                     00040000
MODEL1   DS    CL10                                                     00041000
INST2    DS    CL4                                                      00042000
PRDCDE2  DS    CL6                                                      00043000
ACCTNBR2 DS    CL18                                                     00044000
AUDDATE  DS    PL5'0.'                                                  00045000
AUDTIME  DS    PL5'0.'                                                  00046000
AUDUSER  DS    CL8                                                      00047000
AUDORG   DS    CL6                                                      00048000
ACCTST   DS    CL1                                                      00049000
STATUS   DS    CL2                                                      00050000
BRANCH   DS    CL5                                                      00051000
ACCTTYPE DS    CL3                                                      00052000
TERM     DS    CL5                                                      00053000
AUTODEBT DS    CL1                                                      00054000
DLNQDAY  DS    CL3                                                      00055000
RCODE    DS    CL1                                                      00056000
CRDTRATG DS    CL5                                                      00057000
DORMCODE DS    CL1                                                      00058000
BLKCODE  DS    CL1                                                      00059000
RAREA1   DS    CL25                                                     00060000
OFCR1    DS    CL9                                                      00061000
OFCR2    DS    CL9                                                      00062000
COSTCNTR DS    CL5                                                      00063000
SVCNEXT  DS    PL5'0.'                                                  00064000
UOPT1    DS    CL1                                                      00065000
UOPT2    DS    CL1                                                      00066000
UOPT3    DS    CL1                                                      00067000
UOPT4    DS    CL1                                                      00068000
RAREA2   DS    CL21                                                     00069000
CURRBAL  DS    PL8'0.00'                                                00070000
CURRCBAL DS    PL8'0.00'                                                00071000
CURRBBAL DS    PL8'0.00'                                                00072000
LOWBAL   DS    PL8'0.00'                                                00073000
AVGBAL   DS    PL8'0.00'                                                00074000
AVGCBAL  DS    PL8'0.00'                                                00075000
CBAL     DS    PL8'0.00'                                                00076000
CRLIMT   DS    PL8'0.00'                                                00077000
RSVBAL1  DS    PL8'0.00'                                                00078000
RSVBAL2  DS    PL8'0.00'                                                00079000
RSVBAL3  DS    PL8'0.00'                                                00080000
RSVBAL4  DS    PL8'0.00'                                                00081000
RSVBAL5  DS    PL8'0.00'                                                00082000
RSVBAL6  DS    PL8'0.00'                                                00083000
RSVBAL7  DS    PL8'0.00'                                                00084000
USRBAL1  DS    PL8'0.00'                                                00085000
USRBAL2  DS    PL8'0.00'                                                00086000
USRBAL3  DS    PL8'0.00'                                                00087000
USRBAL4  DS    PL8'0.00'                                                00088000
USRBAL5  DS    PL8'0.00'                                                00089000
RAREA3   DS    CL23                                                     00090000
*                                                                       00091000
*                                                                       00092000
**********************************************************************  00093000
* PROGRAM TABLE HEADER SECTION:                                         00094000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00095000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00096000
**********************************************************************  00097000
*                                                                       00098000
SADIODB  CSECT                         PROGRAM TABLE SECTION            00099000
SADIODB  AMODE ANY                                                      00100000
SADIODB  RMODE ANY                                                      00101000
         DC    CL9'SADIODB'            PROGRAM ID                       00102000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00103000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00104000
         DC    A(0)                    RESERVED                         00105000
         DC    A(0)                    RESERVED                         00106000
         DC    24CL1' '                RESERVED                         00107000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00108000
*                                                                       00109000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00110000
         DC    CL29'WWW.INFOR.COM                '                      00110001
*                                                                       00111000
*                                                                       00112000
**********************************************************************  00113000
* STATEMENT TABLE SECTION:                                              00114000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00115000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00116000
*   SHOULD NOT BE MODIFIED.                                             00117000
**********************************************************************  00118000
*                                                                       00119000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00120000
STM#TAB  AMODE ANY                                                      00121000
STM#TAB  RMODE ANY                                                      00122000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00123000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00124000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00125000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00126000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00127000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00128000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00129000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00130000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00131000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00132000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00133000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00134000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00135000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00136000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00137000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00138000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00139000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00140000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00141000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00142000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00143000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00144000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00145000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00146000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00147000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00148000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00149000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00150000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00151000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00152000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00153000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00154000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00155000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00156000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00157000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00158000
         DC    A(SQL#0036)             INSERT STATEMENT                 00159000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00160000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00161000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00162000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00163000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00164000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00165000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00166000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00167000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00168000
         DC    4X'FF'                                                   00169000
*                                                                       00170000
*                                                                       00171000
**********************************************************************  00172000
* SQL STATEMENT SECTION:                                                00173000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00174000
*     TO SUPPORT THIS TABLE.                                            00175000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00176000
*     ARE EQUIVALENT.                                                   00177000
**********************************************************************  00178000
*                                                                       00179000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00180000
SQL#STMT AMODE ANY                                                      00181000
SQL#STMT RMODE ANY                                                      00182000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00183000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00184000
         USING COM#AREA,11             ADDRESS COMMAREA                 00185000
*                                                                       00186000
*                                                                       00187000
**********************************************************************  00188000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00189000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00190000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00191000
**********************************************************************  00192000
*                                                                       00193000
SQL#0000 DS    0H                                                       00194000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00195000
         B     *+6                     BRANCH AROUND ADCON              00196000
BASE0000 DC    AL2(4096)                                                00197000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00198000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00199000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00200000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00201000
         AH    3,BASE0000              ADD 4K                           00202000
         EXEC  SQL                                                     *00203000
               SELECT AUDIT_DATE,                                      *00204000
                   AUDIT_TIME,                                         *00205000
                   AUDIT_USER,                                         *00206000
                   AUDIT_ORG,                                          *00207000
                   ACCT_STATUS,                                        *00208000
                   APPL_STATUS,                                        *00209000
                   BRANCH,                                             *00210000
                   ACCT_TYPE,                                          *00211000
                   TERM,                                               *00212000
                   AUTO_DEBIT,                                         *00213000
                   DELINQ_DAY,                                         *00214000
                   RISK_CODE,                                          *00215000
                   CREDIT_RATING,                                      *00216000
                   DORMANT_CODE,                                       *00217000
                   BLOCK_CODE,                                         *00218000
                   RSV_AREA_1,                                         *00219000
                   OFFICER_1,                                          *00220000
                   OFFICER_2,                                          *00221000
                   COST_CENTER,                                        *00222000
                   SVC_NEXT,                                           *00223000
                   USER_OPT_1,                                         *00224000
                   USER_OPT_2,                                         *00225000
                   USER_OPT_3,                                         *00226000
                   USER_OPT_4,                                         *00227000
                   RSV_AREA_2,                                         *00228000
                   CURR_BAL,                                           *00229000
                   CURR_C_BAL,                                         *00230000
                   CURR_B_BAL,                                         *00231000
                   LOW_BAL,                                            *00232000
                   AVG_BAL,                                            *00233000
                   AVG_COL_BAL,                                        *00234000
                   COMMIT_BAL,                                         *00235000
                   CREDIT_LIMIT,                                       *00236000
                   RSV_BAL_1,                                          *00237000
                   RSV_BAL_2,                                          *00238000
                   RSV_BAL_3,                                          *00239000
                   RSV_BAL_4,                                          *00240000
                   RSV_BAL_5,                                          *00241000
                   RSV_BAL_6,                                          *00242000
                   RSV_BAL_7,                                          *00243000
                   USER_BAL_1,                                         *00244000
                   USER_BAL_2,                                         *00245000
                   USER_BAL_3,                                         *00246000
                   USER_BAL_4,                                         *00247000
                   USER_BAL_5,                                         *00248000
                   RSV_AREA_3                                          *00249000
                 INTO :AUDDATE,                                        *00250000
                   :AUDTIME,                                           *00251000
                   :AUDUSER,                                           *00252000
                   :AUDORG,                                            *00253000
                   :ACCTST,                                            *00254000
                   :STATUS,                                            *00255000
                   :BRANCH,                                            *00256000
                   :ACCTTYPE,                                          *00257000
                   :TERM,                                              *00258000
                   :AUTODEBT,                                          *00259000
                   :DLNQDAY,                                           *00260000
                   :RCODE,                                             *00261000
                   :CRDTRATG,                                          *00262000
                   :DORMCODE,                                          *00263000
                   :BLKCODE,                                           *00264000
                   :RAREA1,                                            *00265000
                   :OFCR1,                                             *00266000
                   :OFCR2,                                             *00267000
                   :COSTCNTR,                                          *00268000
                   :SVCNEXT,                                           *00269000
                   :UOPT1,                                             *00270000
                   :UOPT2,                                             *00271000
                   :UOPT3,                                             *00272000
                   :UOPT4,                                             *00273000
                   :RAREA2,                                            *00274000
                   :CURRBAL,                                           *00275000
                   :CURRCBAL,                                          *00276000
                   :CURRBBAL,                                          *00277000
                   :LOWBAL,                                            *00278000
                   :AVGBAL,                                            *00279000
                   :AVGCBAL,                                           *00280000
                   :CBAL,                                              *00281000
                   :CRLIMT,                                            *00282000
                   :RSVBAL1,                                           *00283000
                   :RSVBAL2,                                           *00284000
                   :RSVBAL3,                                           *00285000
                   :RSVBAL4,                                           *00286000
                   :RSVBAL5,                                           *00287000
                   :RSVBAL6,                                           *00288000
                   :RSVBAL7,                                           *00289000
                   :USRBAL1,                                           *00290000
                   :USRBAL2,                                           *00291000
                   :USRBAL3,                                           *00292000
                   :USRBAL4,                                           *00293000
                   :USRBAL5,                                           *00294000
                   :RAREA3                                             *00295000
                 FROM SAD                                              *00296000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00297000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00298000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00299000
                   MODEL_1 = :MODEL1 AND                               *00300000
                   ACCT_INST_2 = :INST2 AND                            *00301000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00302000
                   ACCT_NBR_2 = :ACCTNBR2                              *00303000
                 FETCH FIRST 1 ROW ONLY                                 00304000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00305000
         BALR  4,5                     MOVE INTO RECORD AREA            00306000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00307000
         BR    14                      RETURN TO CALLER                 00308000
         LTORG                                                          00309000
*                                                                       00310000
*                                                                       00311000
**********************************************************************  00312000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00313000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00314000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00315000
**********************************************************************  00316000
*                                                                       00317000
SQL#0001 DS    0H                                                       00318000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00319000
         LA    15,255                  SET RETURN CODE                  00320000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00321000
         BR    14                      RETURN TO CALLER                 00322000
         LTORG                                                          00323000
*                                                                       00324000
*                                                                       00325000
**********************************************************************  00326000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00327000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00328000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00329000
**********************************************************************  00330000
*                                                                       00331000
SQL#0002 DS    0H                                                       00332000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00333000
         LA    15,255                  SET RETURN CODE                  00334000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00335000
         BR    14                      RETURN TO CALLER                 00336000
         LTORG                                                          00337000
*                                                                       00338000
*                                                                       00339000
**********************************************************************  00340000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00341000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00342000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00343000
**********************************************************************  00344000
*                                                                       00345000
SQL#0003 DS    0H                                                       00346000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00347000
         LA    15,255                  SET RETURN CODE                  00348000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00349000
         BR    14                      RETURN TO CALLER                 00350000
         LTORG                                                          00351000
*                                                                       00352000
*                                                                       00353000
**********************************************************************  00354000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00355000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00356000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00357000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00358000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00359000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00360000
*     UPDATE STATEMENT TO MATCH.                                        00361000
**********************************************************************  00362000
*                                                                       00363000
SQL#0004 DS    0H                                                       00364000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00365000
         B     *+6                     BRANCH AROUND ADCON              00366000
BASE0004 DC    AL2(4096)                                                00367000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00368000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00369000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00370000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00371000
         AH    3,BASE0004              ADD 4K                           00372000
         EXEC  SQL                                                     *00373000
               DECLARE SADUPD0 CURSOR FOR                              *00374000
               SELECT AUDIT_DATE,                                      *00375000
                   AUDIT_TIME,                                         *00376000
                   AUDIT_USER,                                         *00377000
                   AUDIT_ORG,                                          *00378000
                   ACCT_STATUS,                                        *00379000
                   APPL_STATUS,                                        *00380000
                   BRANCH,                                             *00381000
                   ACCT_TYPE,                                          *00382000
                   TERM,                                               *00383000
                   AUTO_DEBIT,                                         *00384000
                   DELINQ_DAY,                                         *00385000
                   RISK_CODE,                                          *00386000
                   CREDIT_RATING,                                      *00387000
                   DORMANT_CODE,                                       *00388000
                   BLOCK_CODE,                                         *00389000
                   RSV_AREA_1,                                         *00390000
                   OFFICER_1,                                          *00391000
                   OFFICER_2,                                          *00392000
                   COST_CENTER,                                        *00393000
                   SVC_NEXT,                                           *00394000
                   USER_OPT_1,                                         *00395000
                   USER_OPT_2,                                         *00396000
                   USER_OPT_3,                                         *00397000
                   USER_OPT_4,                                         *00398000
                   RSV_AREA_2,                                         *00399000
                   CURR_BAL,                                           *00400000
                   CURR_C_BAL,                                         *00401000
                   CURR_B_BAL,                                         *00402000
                   LOW_BAL,                                            *00403000
                   AVG_BAL,                                            *00404000
                   AVG_COL_BAL,                                        *00405000
                   COMMIT_BAL,                                         *00406000
                   CREDIT_LIMIT,                                       *00407000
                   RSV_BAL_1,                                          *00408000
                   RSV_BAL_2,                                          *00409000
                   RSV_BAL_3,                                          *00410000
                   RSV_BAL_4,                                          *00411000
                   RSV_BAL_5,                                          *00412000
                   RSV_BAL_6,                                          *00413000
                   RSV_BAL_7,                                          *00414000
                   USER_BAL_1,                                         *00415000
                   USER_BAL_2,                                         *00416000
                   USER_BAL_3,                                         *00417000
                   USER_BAL_4,                                         *00418000
                   USER_BAL_5,                                         *00419000
                   RSV_AREA_3                                          *00420000
                 FROM SAD                                              *00421000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00422000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00423000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00424000
                   MODEL_1 = :MODEL1 AND                               *00425000
                   ACCT_INST_2 = :INST2 AND                            *00426000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00427000
                   ACCT_NBR_2 = :ACCTNBR2                              *00428000
                 FOR UPDATE OF AUDIT_DATE,                             *00429000
                   AUDIT_TIME,                                         *00430000
                   AUDIT_USER,                                         *00431000
                   AUDIT_ORG,                                          *00432000
                   ACCT_STATUS,                                        *00433000
                   APPL_STATUS,                                        *00434000
                   BRANCH,                                             *00435000
                   ACCT_TYPE,                                          *00436000
                   TERM,                                               *00437000
                   AUTO_DEBIT,                                         *00438000
                   DELINQ_DAY,                                         *00439000
                   RISK_CODE,                                          *00440000
                   CREDIT_RATING,                                      *00441000
                   DORMANT_CODE,                                       *00442000
                   BLOCK_CODE,                                         *00443000
                   RSV_AREA_1,                                         *00444000
                   OFFICER_1,                                          *00445000
                   OFFICER_2,                                          *00446000
                   COST_CENTER,                                        *00447000
                   SVC_NEXT,                                           *00448000
                   USER_OPT_1,                                         *00449000
                   USER_OPT_2,                                         *00450000
                   USER_OPT_3,                                         *00451000
                   USER_OPT_4,                                         *00452000
                   RSV_AREA_2,                                         *00453000
                   CURR_BAL,                                           *00454000
                   CURR_C_BAL,                                         *00455000
                   CURR_B_BAL,                                         *00456000
                   LOW_BAL,                                            *00457000
                   AVG_BAL,                                            *00458000
                   AVG_COL_BAL,                                        *00459000
                   COMMIT_BAL,                                         *00460000
                   CREDIT_LIMIT,                                       *00461000
                   RSV_BAL_1,                                          *00462000
                   RSV_BAL_2,                                          *00463000
                   RSV_BAL_3,                                          *00464000
                   RSV_BAL_4,                                          *00465000
                   RSV_BAL_5,                                          *00466000
                   RSV_BAL_6,                                          *00467000
                   RSV_BAL_7,                                          *00468000
                   USER_BAL_1,                                         *00469000
                   USER_BAL_2,                                         *00470000
                   USER_BAL_3,                                         *00471000
                   USER_BAL_4,                                         *00472000
                   USER_BAL_5,                                         *00473000
                   RSV_AREA_3                                          *00474000
                 FETCH FIRST 1 ROW ONLY                                 00475000
         EXEC  SQL                                                     *00476000
               OPEN SADUPD0                                             00477000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00478000
         BR    14                      RETURN TO CALLER                 00479000
         LTORG                                                          00480000
*                                                                       00481000
*                                                                       00482000
**********************************************************************  00483000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00484000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00485000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00486000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00487000
*     UPDATE STATEMENT TO MATCH.                                        00488000
**********************************************************************  00489000
*                                                                       00490000
SQL#0005 DS    0H                                                       00491000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00492000
         LA    15,255                  SET RETURN CODE                  00493000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00494000
         BR    14                      RETURN TO CALLER                 00495000
         LTORG                                                          00496000
*                                                                       00497000
*                                                                       00498000
**********************************************************************  00499000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00500000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00501000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00502000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00503000
*     UPDATE STATEMENT TO MATCH.                                        00504000
**********************************************************************  00505000
*                                                                       00506000
SQL#0006 DS    0H                                                       00507000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00508000
         LA    15,255                  SET RETURN CODE                  00509000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00510000
         BR    14                      RETURN TO CALLER                 00511000
         LTORG                                                          00512000
*                                                                       00513000
*                                                                       00514000
**********************************************************************  00515000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00516000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00517000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00518000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00519000
*     UPDATE STATEMENT TO MATCH.                                        00520000
**********************************************************************  00521000
*                                                                       00522000
SQL#0007 DS    0H                                                       00523000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00524000
         LA    15,255                  SET RETURN CODE                  00525000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00526000
         BR    14                      RETURN TO CALLER                 00527000
         LTORG                                                          00528000
*                                                                       00529000
*                                                                       00530000
**********************************************************************  00531000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00532000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00533000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00534000
*     THE ACTUAL ROW.                                                   00535000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00536000
**********************************************************************  00537000
*                                                                       00538000
SQL#0008 DS    0H                                                       00539000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00540000
         B     *+6                     BRANCH AROUND ADCON              00541000
BASE0008 DC    AL2(4096)                                                00542000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00543000
         AH    3,BASE0008              ADD 4K                           00544000
         EXEC  SQL                                                     *00545000
               FETCH SADUPD0                                           *00546000
                 INTO :AUDDATE,                                        *00547000
                   :AUDTIME,                                           *00548000
                   :AUDUSER,                                           *00549000
                   :AUDORG,                                            *00550000
                   :ACCTST,                                            *00551000
                   :STATUS,                                            *00552000
                   :BRANCH,                                            *00553000
                   :ACCTTYPE,                                          *00554000
                   :TERM,                                              *00555000
                   :AUTODEBT,                                          *00556000
                   :DLNQDAY,                                           *00557000
                   :RCODE,                                             *00558000
                   :CRDTRATG,                                          *00559000
                   :DORMCODE,                                          *00560000
                   :BLKCODE,                                           *00561000
                   :RAREA1,                                            *00562000
                   :OFCR1,                                             *00563000
                   :OFCR2,                                             *00564000
                   :COSTCNTR,                                          *00565000
                   :SVCNEXT,                                           *00566000
                   :UOPT1,                                             *00567000
                   :UOPT2,                                             *00568000
                   :UOPT3,                                             *00569000
                   :UOPT4,                                             *00570000
                   :RAREA2,                                            *00571000
                   :CURRBAL,                                           *00572000
                   :CURRCBAL,                                          *00573000
                   :CURRBBAL,                                          *00574000
                   :LOWBAL,                                            *00575000
                   :AVGBAL,                                            *00576000
                   :AVGCBAL,                                           *00577000
                   :CBAL,                                              *00578000
                   :CRLIMT,                                            *00579000
                   :RSVBAL1,                                           *00580000
                   :RSVBAL2,                                           *00581000
                   :RSVBAL3,                                           *00582000
                   :RSVBAL4,                                           *00583000
                   :RSVBAL5,                                           *00584000
                   :RSVBAL6,                                           *00585000
                   :RSVBAL7,                                           *00586000
                   :USRBAL1,                                           *00587000
                   :USRBAL2,                                           *00588000
                   :USRBAL3,                                           *00589000
                   :USRBAL4,                                           *00590000
                   :USRBAL5,                                           *00591000
                   :RAREA3                                              00592000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00593000
         BALR  4,5                     MOVE INTO RECORD AREA            00594000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00595000
         BR    14                      RETURN TO CALLER                 00596000
         LTORG                                                          00597000
*                                                                       00598000
*                                                                       00599000
**********************************************************************  00600000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00601000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00602000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00603000
*     THE ACTUAL ROW.                                                   00604000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00605000
**********************************************************************  00606000
*                                                                       00607000
SQL#0009 DS    0H                                                       00608000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00609000
         LA    15,255                  SET RETURN CODE                  00610000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00611000
         BR    14                      RETURN TO CALLER                 00612000
         LTORG                                                          00613000
*                                                                       00614000
*                                                                       00615000
**********************************************************************  00616000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00617000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00618000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00619000
*     THE ACTUAL ROW.                                                   00620000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00621000
**********************************************************************  00622000
*                                                                       00623000
SQL#0010 DS    0H                                                       00624000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00625000
         LA    15,255                  SET RETURN CODE                  00626000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00627000
         BR    14                      RETURN TO CALLER                 00628000
         LTORG                                                          00629000
*                                                                       00630000
*                                                                       00631000
**********************************************************************  00632000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00633000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00634000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00635000
*     THE ACTUAL ROW.                                                   00636000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00637000
**********************************************************************  00638000
*                                                                       00639000
SQL#0011 DS    0H                                                       00640000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00641000
         LA    15,255                  SET RETURN CODE                  00642000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00643000
         BR    14                      RETURN TO CALLER                 00644000
         LTORG                                                          00645000
*                                                                       00646000
*                                                                       00647000
**********************************************************************  00648000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00649000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00650000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00651000
*     TO CLOSE THE UPDATE CURSOR.                                       00652000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00653000
**********************************************************************  00654000
*                                                                       00655000
SQL#0012 DS    0H                                                       00656000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00657000
         B     *+6                     BRANCH AROUND ADCON              00658000
BASE0012 DC    AL2(4096)                                                00659000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00660000
         AH    3,BASE0012              ADD 4K                           00661000
         EXEC  SQL                                                     *00662000
               CLOSE SADUPD0                                            00663000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00664000
         BR    14                      RETURN TO CALLER                 00665000
         LTORG                                                          00666000
*                                                                       00667000
*                                                                       00668000
**********************************************************************  00669000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00670000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00671000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00672000
*     TO CLOSE THE UPDATE CURSOR.                                       00673000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00674000
**********************************************************************  00675000
*                                                                       00676000
SQL#0013 DS    0H                                                       00677000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00678000
         LA    15,255                  SET RETURN CODE                  00679000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00680000
         BR    14                      RETURN TO CALLER                 00681000
         LTORG                                                          00682000
*                                                                       00683000
*                                                                       00684000
**********************************************************************  00685000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00686000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00687000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00688000
*     TO CLOSE THE UPDATE CURSOR.                                       00689000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00690000
**********************************************************************  00691000
*                                                                       00692000
SQL#0014 DS    0H                                                       00693000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00694000
         LA    15,255                  SET RETURN CODE                  00695000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00696000
         BR    14                      RETURN TO CALLER                 00697000
         LTORG                                                          00698000
*                                                                       00699000
*                                                                       00700000
**********************************************************************  00701000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00702000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00703000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00704000
*     TO CLOSE THE UPDATE CURSOR.                                       00705000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00706000
**********************************************************************  00707000
*                                                                       00708000
SQL#0015 DS    0H                                                       00709000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00710000
         LA    15,255                  SET RETURN CODE                  00711000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00712000
         BR    14                      RETURN TO CALLER                 00713000
         LTORG                                                          00714000
*                                                                       00715000
*                                                                       00716000
**********************************************************************  00717000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00718000
* KEY:                                                                  00719000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00720000
*     AND GET-NEXT-LOCK VERBS.                                          00721000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00722000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00723000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00724000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00725000
*     ORDER BY CLAUSE.                                                  00726000
**********************************************************************  00727000
*                                                                       00728000
SQL#0016 DS    0H                                                       00729000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00730000
         B     *+6                     BRANCH AROUND ADCON              00731000
BASE0016 DC    AL2(4096)                                                00732000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00733000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00734000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00735000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00736000
         AH    3,BASE0016              ADD 4K                           00737000
         EXEC  SQL                                                     *00738000
               DECLARE SADSQ001 CURSOR FOR                             *00739000
               SELECT ACCT_INST_1,                                     *00740000
                   PROD_CODE_1,                                        *00741000
                   ACCT_NBR_1,                                         *00742000
                   MODEL_1,                                            *00743000
                   ACCT_INST_2,                                        *00744000
                   PROD_CODE_2,                                        *00745000
                   ACCT_NBR_2,                                         *00746000
                   AUDIT_DATE,                                         *00747000
                   AUDIT_TIME,                                         *00748000
                   AUDIT_USER,                                         *00749000
                   AUDIT_ORG,                                          *00750000
                   ACCT_STATUS,                                        *00751000
                   APPL_STATUS,                                        *00752000
                   BRANCH,                                             *00753000
                   ACCT_TYPE,                                          *00754000
                   TERM,                                               *00755000
                   AUTO_DEBIT,                                         *00756000
                   DELINQ_DAY,                                         *00757000
                   RISK_CODE,                                          *00758000
                   CREDIT_RATING,                                      *00759000
                   DORMANT_CODE,                                       *00760000
                   BLOCK_CODE,                                         *00761000
                   RSV_AREA_1,                                         *00762000
                   OFFICER_1,                                          *00763000
                   OFFICER_2,                                          *00764000
                   COST_CENTER,                                        *00765000
                   SVC_NEXT,                                           *00766000
                   USER_OPT_1,                                         *00767000
                   USER_OPT_2,                                         *00768000
                   USER_OPT_3,                                         *00769000
                   USER_OPT_4,                                         *00770000
                   RSV_AREA_2,                                         *00771000
                   CURR_BAL,                                           *00772000
                   CURR_C_BAL,                                         *00773000
                   CURR_B_BAL,                                         *00774000
                   LOW_BAL,                                            *00775000
                   AVG_BAL,                                            *00776000
                   AVG_COL_BAL,                                        *00777000
                   COMMIT_BAL,                                         *00778000
                   CREDIT_LIMIT,                                       *00779000
                   RSV_BAL_1,                                          *00780000
                   RSV_BAL_2,                                          *00781000
                   RSV_BAL_3,                                          *00782000
                   RSV_BAL_4,                                          *00783000
                   RSV_BAL_5,                                          *00784000
                   RSV_BAL_6,                                          *00785000
                   RSV_BAL_7,                                          *00786000
                   USER_BAL_1,                                         *00787000
                   USER_BAL_2,                                         *00788000
                   USER_BAL_3,                                         *00789000
                   USER_BAL_4,                                         *00790000
                   USER_BAL_5,                                         *00791000
                   RSV_AREA_3                                          *00792000
                 FROM SAD                                              *00793000
                 WHERE                                                 *00794000
                    ACCT_INST_1 = :INST1 AND                           *00795000
                    PROD_CODE_1 = :PRDCDE1 AND                         *00796000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *00797000
                    MODEL_1 = :MODEL1 AND                              *00798000
                    ACCT_INST_2 = :INST2 AND                           *00799000
                    PROD_CODE_2 = :PRDCDE2 AND                         *00800000
                    ACCT_NBR_2 >= :ACCTNBR2                            *00801000
                 ORDER BY ACCT_NBR_2                                   *00802000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00803000
         EXEC  SQL                                                     *00804000
               OPEN SADSQ001                                            00805000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00806000
         BR    14                      RETURN TO CALLER                 00807000
         LTORG                                                          00808000
*                                                                       00809000
*                                                                       00810000
**********************************************************************  00811000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00812000
* KEY 1:                                                                00813000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00814000
*     AND GET-NEXT-LOCK VERBS.                                          00815000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00816000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00817000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00818000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00819000
*     ORDER BY CLAUSE.                                                  00820000
**********************************************************************  00821000
*                                                                       00822000
SQL#0017 DS    0H                                                       00823000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00824000
         LA    15,255                  SET RETURN CODE                  00825000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00826000
         BR    14                      RETURN TO CALLER                 00827000
         LTORG                                                          00828000
*                                                                       00829000
*                                                                       00830000
**********************************************************************  00831000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00832000
* KEY 2:                                                                00833000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00834000
*     AND GET-NEXT-LOCK VERBS.                                          00835000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00836000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00837000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00838000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00839000
*     ORDER BY CLAUSE.                                                  00840000
**********************************************************************  00841000
*                                                                       00842000
SQL#0018 DS    0H                                                       00843000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00844000
         LA    15,255                  SET RETURN CODE                  00845000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00846000
         BR    14                      RETURN TO CALLER                 00847000
         LTORG                                                          00848000
*                                                                       00849000
*                                                                       00850000
**********************************************************************  00851000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00852000
* KEY 3:                                                                00853000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00854000
*     AND GET-NEXT-LOCK VERBS.                                          00855000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00856000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00857000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00858000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00859000
*     ORDER BY CLAUSE.                                                  00860000
**********************************************************************  00861000
*                                                                       00862000
SQL#0019 DS    0H                                                       00863000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00864000
         LA    15,255                  SET RETURN CODE                  00865000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00866000
         BR    14                      RETURN TO CALLER                 00867000
         LTORG                                                          00868000
*                                                                       00869000
*                                                                       00870000
**********************************************************************  00871000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00872000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00873000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00874000
*     RETRIEVE THE ACTUAL ROW.                                          00875000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00876000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00877000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00878000
**********************************************************************  00879000
*                                                                       00880000
SQL#0020 DS    0H                                                       00881000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00882000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00883000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00884000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00885000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00886000
VECT0020 DC    A(SQL#0120)                                              00887000
         DC    A(SQL#0220)                                              00888000
         DC    A(SQL#0320)                                              00889000
         DC    A(SQL#0420)                                              00890000
         DC    A(SQL#0520)                                              00891000
         DC    A(SQL#0620)                                              00892000
         DC    A(SQL#0720)                                              00893000
         LTORG                                                          00894000
*                                                                       00895000
SQL#0120 DS    0H                                                       00896000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00897000
         B     *+6                     BRANCH AROUND ADCON              00898000
BASE0120 DC    AL2(4096)                                                00899000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00900000
         AH    3,BASE0120              ADD 4K                           00901000
         EXEC  SQL                                                     *00902000
               FETCH SADSQ001                                          *00903000
                 INTO :INST1,                                          *00904000
                      :PRDCDE1,                                        *00905000
                      :ACCTNBR1,                                       *00906000
                      :MODEL1,                                         *00907000
                      :INST2,                                          *00908000
                      :PRDCDE2,                                        *00909000
                      :ACCTNBR2,                                       *00910000
                      :AUDDATE,                                        *00911000
                      :AUDTIME,                                        *00912000
                      :AUDUSER,                                        *00913000
                      :AUDORG,                                         *00914000
                      :ACCTST,                                         *00915000
                      :STATUS,                                         *00916000
                      :BRANCH,                                         *00917000
                      :ACCTTYPE,                                       *00918000
                      :TERM,                                           *00919000
                      :AUTODEBT,                                       *00920000
                      :DLNQDAY,                                        *00921000
                      :RCODE,                                          *00922000
                      :CRDTRATG,                                       *00923000
                      :DORMCODE,                                       *00924000
                      :BLKCODE,                                        *00925000
                      :RAREA1,                                         *00926000
                      :OFCR1,                                          *00927000
                      :OFCR2,                                          *00928000
                      :COSTCNTR,                                       *00929000
                      :SVCNEXT,                                        *00930000
                      :UOPT1,                                          *00931000
                      :UOPT2,                                          *00932000
                      :UOPT3,                                          *00933000
                      :UOPT4,                                          *00934000
                      :RAREA2,                                         *00935000
                      :CURRBAL,                                        *00936000
                      :CURRCBAL,                                       *00937000
                      :CURRBBAL,                                       *00938000
                      :LOWBAL,                                         *00939000
                      :AVGBAL,                                         *00940000
                      :AVGCBAL,                                        *00941000
                      :CBAL,                                           *00942000
                      :CRLIMT,                                         *00943000
                      :RSVBAL1,                                        *00944000
                      :RSVBAL2,                                        *00945000
                      :RSVBAL3,                                        *00946000
                      :RSVBAL4,                                        *00947000
                      :RSVBAL5,                                        *00948000
                      :RSVBAL6,                                        *00949000
                      :RSVBAL7,                                        *00950000
                      :USRBAL1,                                        *00951000
                      :USRBAL2,                                        *00952000
                      :USRBAL3,                                        *00953000
                      :USRBAL4,                                        *00954000
                      :USRBAL5,                                        *00955000
                      :RAREA3                                           00956000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00957000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00958000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00959000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00960000
         BR    12                      OPEN NEXT CURSOR                 00961000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00962000
         BALR  4,5                     MOVE INTO RECORD AREA            00963000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00964000
         BR    14                      RETURN TO CALLER                 00965000
         LTORG                                                          00966000
*                                                                       00967000
SQL#0220 DS    0H                                                       00968000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00969000
         B     *+6                     BRANCH AROUND ADCON              00970000
BASE0220 DC    AL2(4096)                                                00971000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00972000
         AH    3,BASE0220              ADD 4K                           00973000
         EXEC  SQL                                                     *00974000
               FETCH SADSQ002                                          *00975000
                 INTO :INST1,                                          *00976000
                      :PRDCDE1,                                        *00977000
                      :ACCTNBR1,                                       *00978000
                      :MODEL1,                                         *00979000
                      :INST2,                                          *00980000
                      :PRDCDE2,                                        *00981000
                      :ACCTNBR2,                                       *00982000
                      :AUDDATE,                                        *00983000
                      :AUDTIME,                                        *00984000
                      :AUDUSER,                                        *00985000
                      :AUDORG,                                         *00986000
                      :ACCTST,                                         *00987000
                      :STATUS,                                         *00988000
                      :BRANCH,                                         *00989000
                      :ACCTTYPE,                                       *00990000
                      :TERM,                                           *00991000
                      :AUTODEBT,                                       *00992000
                      :DLNQDAY,                                        *00993000
                      :RCODE,                                          *00994000
                      :CRDTRATG,                                       *00995000
                      :DORMCODE,                                       *00996000
                      :BLKCODE,                                        *00997000
                      :RAREA1,                                         *00998000
                      :OFCR1,                                          *00999000
                      :OFCR2,                                          *01000000
                      :COSTCNTR,                                       *01001000
                      :SVCNEXT,                                        *01002000
                      :UOPT1,                                          *01003000
                      :UOPT2,                                          *01004000
                      :UOPT3,                                          *01005000
                      :UOPT4,                                          *01006000
                      :RAREA2,                                         *01007000
                      :CURRBAL,                                        *01008000
                      :CURRCBAL,                                       *01009000
                      :CURRBBAL,                                       *01010000
                      :LOWBAL,                                         *01011000
                      :AVGBAL,                                         *01012000
                      :AVGCBAL,                                        *01013000
                      :CBAL,                                           *01014000
                      :CRLIMT,                                         *01015000
                      :RSVBAL1,                                        *01016000
                      :RSVBAL2,                                        *01017000
                      :RSVBAL3,                                        *01018000
                      :RSVBAL4,                                        *01019000
                      :RSVBAL5,                                        *01020000
                      :RSVBAL6,                                        *01021000
                      :RSVBAL7,                                        *01022000
                      :USRBAL1,                                        *01023000
                      :USRBAL2,                                        *01024000
                      :USRBAL3,                                        *01025000
                      :USRBAL4,                                        *01026000
                      :USRBAL5,                                        *01027000
                      :RAREA3                                           01028000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01029000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01030000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01031000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01032000
         BR    12                      OPEN NEXT CURSOR                 01033000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01034000
         BALR  4,5                     MOVE INTO RECORD AREA            01035000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01036000
         BR    14                      RETURN TO CALLER                 01037000
         LTORG                                                          01038000
*                                                                       01039000
SQL#0320 DS    0H                                                       01040000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          01041000
         B     *+6                     BRANCH AROUND ADCON              01042000
BASE0320 DC    AL2(4096)                                                01043000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01044000
         AH    3,BASE0320              ADD 4K                           01045000
         EXEC  SQL                                                     *01046000
               FETCH SADSQ003                                          *01047000
                 INTO :INST1,                                          *01048000
                      :PRDCDE1,                                        *01049000
                      :ACCTNBR1,                                       *01050000
                      :MODEL1,                                         *01051000
                      :INST2,                                          *01052000
                      :PRDCDE2,                                        *01053000
                      :ACCTNBR2,                                       *01054000
                      :AUDDATE,                                        *01055000
                      :AUDTIME,                                        *01056000
                      :AUDUSER,                                        *01057000
                      :AUDORG,                                         *01058000
                      :ACCTST,                                         *01059000
                      :STATUS,                                         *01060000
                      :BRANCH,                                         *01061000
                      :ACCTTYPE,                                       *01062000
                      :TERM,                                           *01063000
                      :AUTODEBT,                                       *01064000
                      :DLNQDAY,                                        *01065000
                      :RCODE,                                          *01066000
                      :CRDTRATG,                                       *01067000
                      :DORMCODE,                                       *01068000
                      :BLKCODE,                                        *01069000
                      :RAREA1,                                         *01070000
                      :OFCR1,                                          *01071000
                      :OFCR2,                                          *01072000
                      :COSTCNTR,                                       *01073000
                      :SVCNEXT,                                        *01074000
                      :UOPT1,                                          *01075000
                      :UOPT2,                                          *01076000
                      :UOPT3,                                          *01077000
                      :UOPT4,                                          *01078000
                      :RAREA2,                                         *01079000
                      :CURRBAL,                                        *01080000
                      :CURRCBAL,                                       *01081000
                      :CURRBBAL,                                       *01082000
                      :LOWBAL,                                         *01083000
                      :AVGBAL,                                         *01084000
                      :AVGCBAL,                                        *01085000
                      :CBAL,                                           *01086000
                      :CRLIMT,                                         *01087000
                      :RSVBAL1,                                        *01088000
                      :RSVBAL2,                                        *01089000
                      :RSVBAL3,                                        *01090000
                      :RSVBAL4,                                        *01091000
                      :RSVBAL5,                                        *01092000
                      :RSVBAL6,                                        *01093000
                      :RSVBAL7,                                        *01094000
                      :USRBAL1,                                        *01095000
                      :USRBAL2,                                        *01096000
                      :USRBAL3,                                        *01097000
                      :USRBAL4,                                        *01098000
                      :USRBAL5,                                        *01099000
                      :RAREA3                                           01100000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01101000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01102000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01103000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01104000
         BR    12                      OPEN NEXT CURSOR                 01105000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01106000
         BALR  4,5                     MOVE INTO RECORD AREA            01107000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01108000
         BR    14                      RETURN TO CALLER                 01109000
         LTORG                                                          01110000
*                                                                       01111000
SQL#0420 DS    0H                                                       01112000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          01113000
         B     *+6                     BRANCH AROUND ADCON              01114000
BASE0420 DC    AL2(4096)                                                01115000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01116000
         AH    3,BASE0420              ADD 4K                           01117000
         EXEC  SQL                                                     *01118000
               FETCH SADSQ004                                          *01119000
                 INTO :INST1,                                          *01120000
                      :PRDCDE1,                                        *01121000
                      :ACCTNBR1,                                       *01122000
                      :MODEL1,                                         *01123000
                      :INST2,                                          *01124000
                      :PRDCDE2,                                        *01125000
                      :ACCTNBR2,                                       *01126000
                      :AUDDATE,                                        *01127000
                      :AUDTIME,                                        *01128000
                      :AUDUSER,                                        *01129000
                      :AUDORG,                                         *01130000
                      :ACCTST,                                         *01131000
                      :STATUS,                                         *01132000
                      :BRANCH,                                         *01133000
                      :ACCTTYPE,                                       *01134000
                      :TERM,                                           *01135000
                      :AUTODEBT,                                       *01136000
                      :DLNQDAY,                                        *01137000
                      :RCODE,                                          *01138000
                      :CRDTRATG,                                       *01139000
                      :DORMCODE,                                       *01140000
                      :BLKCODE,                                        *01141000
                      :RAREA1,                                         *01142000
                      :OFCR1,                                          *01143000
                      :OFCR2,                                          *01144000
                      :COSTCNTR,                                       *01145000
                      :SVCNEXT,                                        *01146000
                      :UOPT1,                                          *01147000
                      :UOPT2,                                          *01148000
                      :UOPT3,                                          *01149000
                      :UOPT4,                                          *01150000
                      :RAREA2,                                         *01151000
                      :CURRBAL,                                        *01152000
                      :CURRCBAL,                                       *01153000
                      :CURRBBAL,                                       *01154000
                      :LOWBAL,                                         *01155000
                      :AVGBAL,                                         *01156000
                      :AVGCBAL,                                        *01157000
                      :CBAL,                                           *01158000
                      :CRLIMT,                                         *01159000
                      :RSVBAL1,                                        *01160000
                      :RSVBAL2,                                        *01161000
                      :RSVBAL3,                                        *01162000
                      :RSVBAL4,                                        *01163000
                      :RSVBAL5,                                        *01164000
                      :RSVBAL6,                                        *01165000
                      :RSVBAL7,                                        *01166000
                      :USRBAL1,                                        *01167000
                      :USRBAL2,                                        *01168000
                      :USRBAL3,                                        *01169000
                      :USRBAL4,                                        *01170000
                      :USRBAL5,                                        *01171000
                      :RAREA3                                           01172000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01173000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01174000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01175000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01176000
         BR    12                      OPEN NEXT CURSOR                 01177000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01178000
         BALR  4,5                     MOVE INTO RECORD AREA            01179000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01180000
         BR    14                      RETURN TO CALLER                 01181000
         LTORG                                                          01182000
*                                                                       01183000
SQL#0520 DS    0H                                                       01184000
         USING SQL#0520,12             ESTABLISH BASE REGISTER          01185000
         B     *+6                     BRANCH AROUND ADCON              01186000
BASE0520 DC    AL2(4096)                                                01187000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01188000
         AH    3,BASE0520              ADD 4K                           01189000
         EXEC  SQL                                                     *01190000
               FETCH SADSQ005                                          *01191000
                 INTO :INST1,                                          *01192000
                      :PRDCDE1,                                        *01193000
                      :ACCTNBR1,                                       *01194000
                      :MODEL1,                                         *01195000
                      :INST2,                                          *01196000
                      :PRDCDE2,                                        *01197000
                      :ACCTNBR2,                                       *01198000
                      :AUDDATE,                                        *01199000
                      :AUDTIME,                                        *01200000
                      :AUDUSER,                                        *01201000
                      :AUDORG,                                         *01202000
                      :ACCTST,                                         *01203000
                      :STATUS,                                         *01204000
                      :BRANCH,                                         *01205000
                      :ACCTTYPE,                                       *01206000
                      :TERM,                                           *01207000
                      :AUTODEBT,                                       *01208000
                      :DLNQDAY,                                        *01209000
                      :RCODE,                                          *01210000
                      :CRDTRATG,                                       *01211000
                      :DORMCODE,                                       *01212000
                      :BLKCODE,                                        *01213000
                      :RAREA1,                                         *01214000
                      :OFCR1,                                          *01215000
                      :OFCR2,                                          *01216000
                      :COSTCNTR,                                       *01217000
                      :SVCNEXT,                                        *01218000
                      :UOPT1,                                          *01219000
                      :UOPT2,                                          *01220000
                      :UOPT3,                                          *01221000
                      :UOPT4,                                          *01222000
                      :RAREA2,                                         *01223000
                      :CURRBAL,                                        *01224000
                      :CURRCBAL,                                       *01225000
                      :CURRBBAL,                                       *01226000
                      :LOWBAL,                                         *01227000
                      :AVGBAL,                                         *01228000
                      :AVGCBAL,                                        *01229000
                      :CBAL,                                           *01230000
                      :CRLIMT,                                         *01231000
                      :RSVBAL1,                                        *01232000
                      :RSVBAL2,                                        *01233000
                      :RSVBAL3,                                        *01234000
                      :RSVBAL4,                                        *01235000
                      :RSVBAL5,                                        *01236000
                      :RSVBAL6,                                        *01237000
                      :RSVBAL7,                                        *01238000
                      :USRBAL1,                                        *01239000
                      :USRBAL2,                                        *01240000
                      :USRBAL3,                                        *01241000
                      :USRBAL4,                                        *01242000
                      :USRBAL5,                                        *01243000
                      :RAREA3                                           01244000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01245000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01246000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01247000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01248000
         BR    12                      OPEN NEXT CURSOR                 01249000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01250000
         BALR  4,5                     MOVE INTO RECORD AREA            01251000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01252000
         BR    14                      RETURN TO CALLER                 01253000
         LTORG                                                          01254000
*                                                                       01255000
SQL#0620 DS    0H                                                       01256000
         USING SQL#0620,12             ESTABLISH BASE REGISTER          01257000
         B     *+6                     BRANCH AROUND ADCON              01258000
BASE0620 DC    AL2(4096)                                                01259000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01260000
         AH    3,BASE0620              ADD 4K                           01261000
         EXEC  SQL                                                     *01262000
               FETCH SADSQ006                                          *01263000
                 INTO :INST1,                                          *01264000
                      :PRDCDE1,                                        *01265000
                      :ACCTNBR1,                                       *01266000
                      :MODEL1,                                         *01267000
                      :INST2,                                          *01268000
                      :PRDCDE2,                                        *01269000
                      :ACCTNBR2,                                       *01270000
                      :AUDDATE,                                        *01271000
                      :AUDTIME,                                        *01272000
                      :AUDUSER,                                        *01273000
                      :AUDORG,                                         *01274000
                      :ACCTST,                                         *01275000
                      :STATUS,                                         *01276000
                      :BRANCH,                                         *01277000
                      :ACCTTYPE,                                       *01278000
                      :TERM,                                           *01279000
                      :AUTODEBT,                                       *01280000
                      :DLNQDAY,                                        *01281000
                      :RCODE,                                          *01282000
                      :CRDTRATG,                                       *01283000
                      :DORMCODE,                                       *01284000
                      :BLKCODE,                                        *01285000
                      :RAREA1,                                         *01286000
                      :OFCR1,                                          *01287000
                      :OFCR2,                                          *01288000
                      :COSTCNTR,                                       *01289000
                      :SVCNEXT,                                        *01290000
                      :UOPT1,                                          *01291000
                      :UOPT2,                                          *01292000
                      :UOPT3,                                          *01293000
                      :UOPT4,                                          *01294000
                      :RAREA2,                                         *01295000
                      :CURRBAL,                                        *01296000
                      :CURRCBAL,                                       *01297000
                      :CURRBBAL,                                       *01298000
                      :LOWBAL,                                         *01299000
                      :AVGBAL,                                         *01300000
                      :AVGCBAL,                                        *01301000
                      :CBAL,                                           *01302000
                      :CRLIMT,                                         *01303000
                      :RSVBAL1,                                        *01304000
                      :RSVBAL2,                                        *01305000
                      :RSVBAL3,                                        *01306000
                      :RSVBAL4,                                        *01307000
                      :RSVBAL5,                                        *01308000
                      :RSVBAL6,                                        *01309000
                      :RSVBAL7,                                        *01310000
                      :USRBAL1,                                        *01311000
                      :USRBAL2,                                        *01312000
                      :USRBAL3,                                        *01313000
                      :USRBAL4,                                        *01314000
                      :USRBAL5,                                        *01315000
                      :RAREA3                                           01316000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01317000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01318000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01319000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01320000
         BR    12                      OPEN NEXT CURSOR                 01321000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01322000
         BALR  4,5                     MOVE INTO RECORD AREA            01323000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01324000
         BR    14                      RETURN TO CALLER                 01325000
         LTORG                                                          01326000
*                                                                       01327000
SQL#0720 DS    0H                                                       01328000
         USING SQL#0720,12             ESTABLISH BASE REGISTER          01329000
         B     *+6                     BRANCH AROUND ADCON              01330000
BASE0720 DC    AL2(4096)                                                01331000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01332000
         AH    3,BASE0720              ADD 4K                           01333000
         EXEC  SQL                                                     *01334000
               FETCH SADSQ007                                          *01335000
                 INTO :INST1,                                          *01336000
                      :PRDCDE1,                                        *01337000
                      :ACCTNBR1,                                       *01338000
                      :MODEL1,                                         *01339000
                      :INST2,                                          *01340000
                      :PRDCDE2,                                        *01341000
                      :ACCTNBR2,                                       *01342000
                      :AUDDATE,                                        *01343000
                      :AUDTIME,                                        *01344000
                      :AUDUSER,                                        *01345000
                      :AUDORG,                                         *01346000
                      :ACCTST,                                         *01347000
                      :STATUS,                                         *01348000
                      :BRANCH,                                         *01349000
                      :ACCTTYPE,                                       *01350000
                      :TERM,                                           *01351000
                      :AUTODEBT,                                       *01352000
                      :DLNQDAY,                                        *01353000
                      :RCODE,                                          *01354000
                      :CRDTRATG,                                       *01355000
                      :DORMCODE,                                       *01356000
                      :BLKCODE,                                        *01357000
                      :RAREA1,                                         *01358000
                      :OFCR1,                                          *01359000
                      :OFCR2,                                          *01360000
                      :COSTCNTR,                                       *01361000
                      :SVCNEXT,                                        *01362000
                      :UOPT1,                                          *01363000
                      :UOPT2,                                          *01364000
                      :UOPT3,                                          *01365000
                      :UOPT4,                                          *01366000
                      :RAREA2,                                         *01367000
                      :CURRBAL,                                        *01368000
                      :CURRCBAL,                                       *01369000
                      :CURRBBAL,                                       *01370000
                      :LOWBAL,                                         *01371000
                      :AVGBAL,                                         *01372000
                      :AVGCBAL,                                        *01373000
                      :CBAL,                                           *01374000
                      :CRLIMT,                                         *01375000
                      :RSVBAL1,                                        *01376000
                      :RSVBAL2,                                        *01377000
                      :RSVBAL3,                                        *01378000
                      :RSVBAL4,                                        *01379000
                      :RSVBAL5,                                        *01380000
                      :RSVBAL6,                                        *01381000
                      :RSVBAL7,                                        *01382000
                      :USRBAL1,                                        *01383000
                      :USRBAL2,                                        *01384000
                      :USRBAL3,                                        *01385000
                      :USRBAL4,                                        *01386000
                      :USRBAL5,                                        *01387000
                      :RAREA3                                           01388000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01389000
         BALR  4,5                     MOVE INTO RECORD AREA            01390000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01391000
         BR    14                      RETURN TO CALLER                 01392000
         LTORG                                                          01393000
*                                                                       01394000
*                                                                       01395000
**********************************************************************  01396000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01397000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01398000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01399000
*     RETRIEVE THE ACTUAL ROW.                                          01400000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01401000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01402000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01403000
**********************************************************************  01404000
*                                                                       01405000
SQL#0021 DS    0H                                                       01406000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01407000
         LA    15,255                  SET RETURN CODE                  01408000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01409000
         BR    14                      RETURN TO CALLER                 01410000
         LTORG                                                          01411000
*                                                                       01412000
*                                                                       01413000
**********************************************************************  01414000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01415000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01416000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01417000
*     RETRIEVE THE ACTUAL ROW.                                          01418000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01419000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01420000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01421000
**********************************************************************  01422000
*                                                                       01423000
SQL#0022 DS    0H                                                       01424000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01425000
         LA    15,255                  SET RETURN CODE                  01426000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01427000
         BR    14                      RETURN TO CALLER                 01428000
         LTORG                                                          01429000
*                                                                       01430000
*                                                                       01431000
**********************************************************************  01432000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01433000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01434000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01435000
*     RETRIEVE THE ACTUAL ROW.                                          01436000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01437000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01438000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01439000
**********************************************************************  01440000
*                                                                       01441000
SQL#0023 DS    0H                                                       01442000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01443000
         LA    15,255                  SET RETURN CODE                  01444000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01445000
         BR    14                      RETURN TO CALLER                 01446000
         LTORG                                                          01447000
*                                                                       01448000
*                                                                       01449000
**********************************************************************  01450000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01451000
* THE PRIMARY KEY:                                                      01452000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01453000
*     VERBS.                                                            01454000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01455000
*     RETRIEVE THE ACTUAL ROW.                                          01456000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01457000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01458000
*     WILL BE THRU THE UPDATE CURSOR.                                   01459000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01460000
**********************************************************************  01461000
*                                                                       01462000
SQL#0024 DS    0H                                                       01463000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01464000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01465000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01466000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01467000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01468000
VECT0024 DC    A(SQL#0124)                                              01469000
         DC    A(SQL#0224)                                              01470000
         DC    A(SQL#0324)                                              01471000
         DC    A(SQL#0424)                                              01472000
         DC    A(SQL#0524)                                              01473000
         DC    A(SQL#0624)                                              01474000
         DC    A(SQL#0724)                                              01475000
         LTORG                                                          01476000
*                                                                       01477000
SQL#0124 DS    0H                                                       01478000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01479000
         B     *+6                     BRANCH AROUND ADCON              01480000
BASE0124 DC    AL2(4096)                                                01481000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01482000
         AH    3,BASE0124              ADD 4K                           01483000
         EXEC  SQL                                                     *01484000
               FETCH SADSQ001                                          *01485000
                 INTO :INST1,                                          *01486000
                      :PRDCDE1,                                        *01487000
                      :ACCTNBR1,                                       *01488000
                      :MODEL1,                                         *01489000
                      :INST2,                                          *01490000
                      :PRDCDE2,                                        *01491000
                      :ACCTNBR2                                         01492000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01493000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01494000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01495000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01496000
         BR    12                      OPEN NEXT CURSOR                 01497000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01498000
         BALR  4,5                     MOVE INTO RECORD AREA            01499000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01500000
         BR    14                      RETURN TO CALLER                 01501000
         LTORG                                                          01502000
*                                                                       01503000
SQL#0224 DS    0H                                                       01504000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01505000
         B     *+6                     BRANCH AROUND ADCON              01506000
BASE0224 DC    AL2(4096)                                                01507000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01508000
         AH    3,BASE0224              ADD 4K                           01509000
         EXEC  SQL                                                     *01510000
               FETCH SADSQ002                                          *01511000
                 INTO :INST1,                                          *01512000
                      :PRDCDE1,                                        *01513000
                      :ACCTNBR1,                                       *01514000
                      :MODEL1,                                         *01515000
                      :INST2,                                          *01516000
                      :PRDCDE2,                                        *01517000
                      :ACCTNBR2                                         01518000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01519000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01520000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01521000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01522000
         BR    12                      OPEN NEXT CURSOR                 01523000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01524000
         BALR  4,5                     MOVE INTO RECORD AREA            01525000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01526000
         BR    14                      RETURN TO CALLER                 01527000
         LTORG                                                          01528000
*                                                                       01529000
SQL#0324 DS    0H                                                       01530000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01531000
         B     *+6                     BRANCH AROUND ADCON              01532000
BASE0324 DC    AL2(4096)                                                01533000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01534000
         AH    3,BASE0324              ADD 4K                           01535000
         EXEC  SQL                                                     *01536000
               FETCH SADSQ003                                          *01537000
                 INTO :INST1,                                          *01538000
                      :PRDCDE1,                                        *01539000
                      :ACCTNBR1,                                       *01540000
                      :MODEL1,                                         *01541000
                      :INST2,                                          *01542000
                      :PRDCDE2,                                        *01543000
                      :ACCTNBR2                                         01544000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01545000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01546000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01547000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01548000
         BR    12                      OPEN NEXT CURSOR                 01549000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01550000
         BALR  4,5                     MOVE INTO RECORD AREA            01551000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01552000
         BR    14                      RETURN TO CALLER                 01553000
         LTORG                                                          01554000
*                                                                       01555000
SQL#0424 DS    0H                                                       01556000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          01557000
         B     *+6                     BRANCH AROUND ADCON              01558000
BASE0424 DC    AL2(4096)                                                01559000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01560000
         AH    3,BASE0424              ADD 4K                           01561000
         EXEC  SQL                                                     *01562000
               FETCH SADSQ004                                          *01563000
                 INTO :INST1,                                          *01564000
                      :PRDCDE1,                                        *01565000
                      :ACCTNBR1,                                       *01566000
                      :MODEL1,                                         *01567000
                      :INST2,                                          *01568000
                      :PRDCDE2,                                        *01569000
                      :ACCTNBR2                                         01570000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01571000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01572000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01573000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01574000
         BR    12                      OPEN NEXT CURSOR                 01575000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01576000
         BALR  4,5                     MOVE INTO RECORD AREA            01577000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01578000
         BR    14                      RETURN TO CALLER                 01579000
         LTORG                                                          01580000
*                                                                       01581000
SQL#0524 DS    0H                                                       01582000
         USING SQL#0524,12             ESTABLISH BASE REGISTER          01583000
         B     *+6                     BRANCH AROUND ADCON              01584000
BASE0524 DC    AL2(4096)                                                01585000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01586000
         AH    3,BASE0524              ADD 4K                           01587000
         EXEC  SQL                                                     *01588000
               FETCH SADSQ005                                          *01589000
                 INTO :INST1,                                          *01590000
                      :PRDCDE1,                                        *01591000
                      :ACCTNBR1,                                       *01592000
                      :MODEL1,                                         *01593000
                      :INST2,                                          *01594000
                      :PRDCDE2,                                        *01595000
                      :ACCTNBR2                                         01596000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01597000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01598000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01599000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01600000
         BR    12                      OPEN NEXT CURSOR                 01601000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01602000
         BALR  4,5                     MOVE INTO RECORD AREA            01603000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01604000
         BR    14                      RETURN TO CALLER                 01605000
         LTORG                                                          01606000
*                                                                       01607000
SQL#0624 DS    0H                                                       01608000
         USING SQL#0624,12             ESTABLISH BASE REGISTER          01609000
         B     *+6                     BRANCH AROUND ADCON              01610000
BASE0624 DC    AL2(4096)                                                01611000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01612000
         AH    3,BASE0624              ADD 4K                           01613000
         EXEC  SQL                                                     *01614000
               FETCH SADSQ006                                          *01615000
                 INTO :INST1,                                          *01616000
                      :PRDCDE1,                                        *01617000
                      :ACCTNBR1,                                       *01618000
                      :MODEL1,                                         *01619000
                      :INST2,                                          *01620000
                      :PRDCDE2,                                        *01621000
                      :ACCTNBR2                                         01622000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01623000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01624000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01625000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01626000
         BR    12                      OPEN NEXT CURSOR                 01627000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01628000
         BALR  4,5                     MOVE INTO RECORD AREA            01629000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01630000
         BR    14                      RETURN TO CALLER                 01631000
         LTORG                                                          01632000
*                                                                       01633000
SQL#0724 DS    0H                                                       01634000
         USING SQL#0724,12             ESTABLISH BASE REGISTER          01635000
         B     *+6                     BRANCH AROUND ADCON              01636000
BASE0724 DC    AL2(4096)                                                01637000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01638000
         AH    3,BASE0724              ADD 4K                           01639000
         EXEC  SQL                                                     *01640000
               FETCH SADSQ007                                          *01641000
                 INTO :INST1,                                          *01642000
                      :PRDCDE1,                                        *01643000
                      :ACCTNBR1,                                       *01644000
                      :MODEL1,                                         *01645000
                      :INST2,                                          *01646000
                      :PRDCDE2,                                        *01647000
                      :ACCTNBR2                                         01648000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01649000
         BALR  4,5                     MOVE INTO RECORD AREA            01650000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01651000
         BR    14                      RETURN TO CALLER                 01652000
         LTORG                                                          01653000
*                                                                       01654000
*                                                                       01655000
**********************************************************************  01656000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01657000
* ALTERNATE KEY 1:                                                      01658000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01659000
*     VERBS.                                                            01660000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01661000
*     RETRIEVE THE ACTUAL ROW.                                          01662000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01663000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01664000
*     WILL BE THRU THE UPDATE CURSOR.                                   01665000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01666000
**********************************************************************  01667000
*                                                                       01668000
SQL#0025 DS    0H                                                       01669000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01670000
         LA    15,255                  SET RETURN CODE                  01671000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01672000
         BR    14                      RETURN TO CALLER                 01673000
         LTORG                                                          01674000
*                                                                       01675000
*                                                                       01676000
**********************************************************************  01677000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01678000
* ALTERNATE KEY 2:                                                      01679000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01680000
*     VERBS.                                                            01681000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01682000
*     RETRIEVE THE ACTUAL ROW.                                          01683000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01684000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01685000
*     WILL BE THRU THE UPDATE CURSOR.                                   01686000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01687000
**********************************************************************  01688000
*                                                                       01689000
SQL#0026 DS    0H                                                       01690000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01691000
         LA    15,255                  SET RETURN CODE                  01692000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01693000
         BR    14                      RETURN TO CALLER                 01694000
         LTORG                                                          01695000
*                                                                       01696000
*                                                                       01697000
**********************************************************************  01698000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01699000
* ALTERNATE KEY 3:                                                      01700000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01701000
*     VERBS.                                                            01702000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01703000
*     RETRIEVE THE ACTUAL ROW.                                          01704000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01705000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01706000
*     WILL BE THRU THE UPDATE CURSOR.                                   01707000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01708000
**********************************************************************  01709000
*                                                                       01710000
SQL#0027 DS    0H                                                       01711000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01712000
         LA    15,255                  SET RETURN CODE                  01713000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01714000
         BR    14                      RETURN TO CALLER                 01715000
         LTORG                                                          01716000
*                                                                       01717000
*                                                                       01718000
**********************************************************************  01719000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01720000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01721000
*     AND GET-NEXT-LOCK VERBS.                                          01722000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01723000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01724000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01725000
**********************************************************************  01726000
*                                                                       01727000
SQL#0028 DS    0H                                                       01728000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01729000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01730000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01731000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01732000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01733000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01734000
VECT0028 DC    A(SQL#0128)                                              01735000
         DC    A(SQL#0228)                                              01736000
         DC    A(SQL#0328)                                              01737000
         DC    A(SQL#0428)                                              01738000
         DC    A(SQL#0528)                                              01739000
         DC    A(SQL#0628)                                              01740000
         DC    A(SQL#0728)                                              01741000
         LTORG                                                          01742000
*                                                                       01743000
SQL#0128 DS    0H                                                       01744000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01745000
         B     *+6                     BRANCH AROUND ADCON              01746000
BASE0128 DC    AL2(4096)                                                01747000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01748000
         AH    3,BASE0128              ADD 4K                           01749000
         EXEC  SQL                                                     *01750000
               CLOSE SADSQ001                                           01751000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01752000
         BR    14                      RETURN TO CALLER                 01753000
         LTORG                                                          01754000
*                                                                       01755000
SQL#0228 DS    0H                                                       01756000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01757000
         B     *+6                     BRANCH AROUND ADCON              01758000
BASE0228 DC    AL2(4096)                                                01759000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01760000
         AH    3,BASE0228              ADD 4K                           01761000
         EXEC  SQL                                                     *01762000
               CLOSE SADSQ002                                           01763000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01764000
         BR    14                      RETURN TO CALLER                 01765000
         LTORG                                                          01766000
*                                                                       01767000
SQL#0328 DS    0H                                                       01768000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01769000
         B     *+6                     BRANCH AROUND ADCON              01770000
BASE0328 DC    AL2(4096)                                                01771000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01772000
         AH    3,BASE0328              ADD 4K                           01773000
         EXEC  SQL                                                     *01774000
               CLOSE SADSQ003                                           01775000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01776000
         BR    14                      RETURN TO CALLER                 01777000
         LTORG                                                          01778000
*                                                                       01779000
SQL#0428 DS    0H                                                       01780000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01781000
         B     *+6                     BRANCH AROUND ADCON              01782000
BASE0428 DC    AL2(4096)                                                01783000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01784000
         AH    3,BASE0428              ADD 4K                           01785000
         EXEC  SQL                                                     *01786000
               CLOSE SADSQ004                                           01787000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01788000
         BR    14                      RETURN TO CALLER                 01789000
         LTORG                                                          01790000
*                                                                       01791000
SQL#0528 DS    0H                                                       01792000
         USING SQL#0528,12             ESTABLISH BASE REGISTER          01793000
         B     *+6                     BRANCH AROUND ADCON              01794000
BASE0528 DC    AL2(4096)                                                01795000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01796000
         AH    3,BASE0528              ADD 4K                           01797000
         EXEC  SQL                                                     *01798000
               CLOSE SADSQ005                                           01799000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01800000
         BR    14                      RETURN TO CALLER                 01801000
         LTORG                                                          01802000
*                                                                       01803000
SQL#0628 DS    0H                                                       01804000
         USING SQL#0628,12             ESTABLISH BASE REGISTER          01805000
         B     *+6                     BRANCH AROUND ADCON              01806000
BASE0628 DC    AL2(4096)                                                01807000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01808000
         AH    3,BASE0628              ADD 4K                           01809000
         EXEC  SQL                                                     *01810000
               CLOSE SADSQ006                                           01811000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01812000
         BR    14                      RETURN TO CALLER                 01813000
         LTORG                                                          01814000
*                                                                       01815000
SQL#0728 DS    0H                                                       01816000
         USING SQL#0728,12             ESTABLISH BASE REGISTER          01817000
         B     *+6                     BRANCH AROUND ADCON              01818000
BASE0728 DC    AL2(4096)                                                01819000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01820000
         AH    3,BASE0728              ADD 4K                           01821000
         EXEC  SQL                                                     *01822000
               CLOSE SADSQ007                                           01823000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01824000
         BR    14                      RETURN TO CALLER                 01825000
         LTORG                                                          01826000
*                                                                       01827000
*                                                                       01828000
**********************************************************************  01829000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01830000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01831000
*     AND GET-NEXT-LOCK VERBS.                                          01832000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01833000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01834000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01835000
**********************************************************************  01836000
*                                                                       01837000
SQL#0029 DS    0H                                                       01838000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01839000
         LA    15,255                  SET RETURN CODE                  01840000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01841000
         BR    14                      RETURN TO CALLER                 01842000
         LTORG                                                          01843000
*                                                                       01844000
*                                                                       01845000
**********************************************************************  01846000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01847000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01848000
*     AND GET-NEXT-LOCK VERBS.                                          01849000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01850000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01851000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01852000
**********************************************************************  01853000
*                                                                       01854000
SQL#0030 DS    0H                                                       01855000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01856000
         LA    15,255                  SET RETURN CODE                  01857000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01858000
         BR    14                      RETURN TO CALLER                 01859000
         LTORG                                                          01860000
*                                                                       01861000
*                                                                       01862000
**********************************************************************  01863000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01864000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01865000
*     AND GET-NEXT-LOCK VERBS.                                          01866000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01867000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01868000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01869000
**********************************************************************  01870000
*                                                                       01871000
SQL#0031 DS    0H                                                       01872000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01873000
         LA    15,255                  SET RETURN CODE                  01874000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01875000
         BR    14                      RETURN TO CALLER                 01876000
         LTORG                                                          01877000
*                                                                       01878000
*                                                                       01879000
**********************************************************************  01880000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01881000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01882000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01883000
**********************************************************************  01884000
*                                                                       01885000
SQL#0032 DS    0H                                                       01886000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01887000
         B     *+6                     BRANCH AROUND ADCON              01888000
BASE0032 DC    AL2(4096)                                                01889000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01890000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01891000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01892000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01893000
         AH    3,BASE0032              ADD 4K                           01894000
         EXEC  SQL                                                     *01895000
               SELECT ACCT_INST_1,                                     *01896000
                   PROD_CODE_1,                                        *01897000
                   ACCT_NBR_1,                                         *01898000
                   MODEL_1,                                            *01899000
                   ACCT_INST_2,                                        *01900000
                   PROD_CODE_2,                                        *01901000
                   ACCT_NBR_2                                          *01902000
                 INTO :INST1,                                          *01903000
                   :PRDCDE1,                                           *01904000
                   :ACCTNBR1,                                          *01905000
                   :MODEL1,                                            *01906000
                   :INST2,                                             *01907000
                   :PRDCDE2,                                           *01908000
                   :ACCTNBR2                                           *01909000
                 FROM SAD                                              *01910000
                 WHERE ACCT_INST_1 = :INST1 AND                        *01911000
                   PROD_CODE_1 = :PRDCDE1 AND                          *01912000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *01913000
                   MODEL_1 = :MODEL1 AND                               *01914000
                   ACCT_INST_2 = :INST2 AND                            *01915000
                   PROD_CODE_2 = :PRDCDE2 AND                          *01916000
                   ACCT_NBR_2 = :ACCTNBR2                              *01917000
                 FETCH FIRST 1 ROW ONLY                                 01918000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01919000
         BR    14                      RETURN TO CALLER                 01920000
         LTORG                                                          01921000
*                                                                       01922000
*                                                                       01923000
**********************************************************************  01924000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01925000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01926000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01927000
**********************************************************************  01928000
*                                                                       01929000
SQL#0033 DS    0H                                                       01930000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01931000
         LA    15,255                  SET RETURN CODE                  01932000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01933000
         BR    14                      RETURN TO CALLER                 01934000
         LTORG                                                          01935000
*                                                                       01936000
*                                                                       01937000
**********************************************************************  01938000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01939000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01940000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01941000
**********************************************************************  01942000
*                                                                       01943000
SQL#0034 DS    0H                                                       01944000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01945000
         LA    15,255                  SET RETURN CODE                  01946000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01947000
         BR    14                      RETURN TO CALLER                 01948000
         LTORG                                                          01949000
*                                                                       01950000
*                                                                       01951000
**********************************************************************  01952000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01953000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01954000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01955000
**********************************************************************  01956000
*                                                                       01957000
SQL#0035 DS    0H                                                       01958000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01959000
         LA    15,255                  SET RETURN CODE                  01960000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01961000
         BR    14                      RETURN TO CALLER                 01962000
         LTORG                                                          01963000
*                                                                       01964000
*                                                                       01965000
**********************************************************************  01966000
* INSERT STATEMENT:                                                     01967000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01968000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01969000
**********************************************************************  01970000
*                                                                       01971000
SQL#0036 DS    0H                                                       01972000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01973000
         B     *+6                     BRANCH AROUND ADCON              01974000
BASE0036 DC    AL2(4096)                                                01975000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01976000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01977000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01978000
         AH    3,BASE0036              ADD 4K                           01979000
         EXEC  SQL                                                     *01980000
               INSERT INTO SAD                                         *01981000
                   (ACCT_INST_1,                                       *01982000
                    PROD_CODE_1,                                       *01983000
                    ACCT_NBR_1,                                        *01984000
                    MODEL_1,                                           *01985000
                    ACCT_INST_2,                                       *01986000
                    PROD_CODE_2,                                       *01987000
                    ACCT_NBR_2,                                        *01988000
                    AUDIT_DATE,                                        *01989000
                    AUDIT_TIME,                                        *01990000
                    AUDIT_USER,                                        *01991000
                    AUDIT_ORG,                                         *01992000
                    ACCT_STATUS,                                       *01993000
                    APPL_STATUS,                                       *01994000
                    BRANCH,                                            *01995000
                    ACCT_TYPE,                                         *01996000
                    TERM,                                              *01997000
                    AUTO_DEBIT,                                        *01998000
                    DELINQ_DAY,                                        *01999000
                    RISK_CODE,                                         *02000000
                    CREDIT_RATING,                                     *02001000
                    DORMANT_CODE,                                      *02002000
                    BLOCK_CODE,                                        *02003000
                    RSV_AREA_1,                                        *02004000
                    OFFICER_1,                                         *02005000
                    OFFICER_2,                                         *02006000
                    COST_CENTER,                                       *02007000
                    SVC_NEXT,                                          *02008000
                    USER_OPT_1,                                        *02009000
                    USER_OPT_2,                                        *02010000
                    USER_OPT_3,                                        *02011000
                    USER_OPT_4,                                        *02012000
                    RSV_AREA_2,                                        *02013000
                    CURR_BAL,                                          *02014000
                    CURR_C_BAL,                                        *02015000
                    CURR_B_BAL,                                        *02016000
                    LOW_BAL,                                           *02017000
                    AVG_BAL,                                           *02018000
                    AVG_COL_BAL,                                       *02019000
                    COMMIT_BAL,                                        *02020000
                    CREDIT_LIMIT,                                      *02021000
                    RSV_BAL_1,                                         *02022000
                    RSV_BAL_2,                                         *02023000
                    RSV_BAL_3,                                         *02024000
                    RSV_BAL_4,                                         *02025000
                    RSV_BAL_5,                                         *02026000
                    RSV_BAL_6,                                         *02027000
                    RSV_BAL_7,                                         *02028000
                    USER_BAL_1,                                        *02029000
                    USER_BAL_2,                                        *02030000
                    USER_BAL_3,                                        *02031000
                    USER_BAL_4,                                        *02032000
                    USER_BAL_5,                                        *02033000
                    RSV_AREA_3)                                        *02034000
                  VALUES (:INST1,                                      *02035000
                   :PRDCDE1,                                           *02036000
                   :ACCTNBR1,                                          *02037000
                   :MODEL1,                                            *02038000
                   :INST2,                                             *02039000
                   :PRDCDE2,                                           *02040000
                   :ACCTNBR2,                                          *02041000
                   :AUDDATE,                                           *02042000
                   :AUDTIME,                                           *02043000
                   :AUDUSER,                                           *02044000
                   :AUDORG,                                            *02045000
                   :ACCTST,                                            *02046000
                   :STATUS,                                            *02047000
                   :BRANCH,                                            *02048000
                   :ACCTTYPE,                                          *02049000
                   :TERM,                                              *02050000
                   :AUTODEBT,                                          *02051000
                   :DLNQDAY,                                           *02052000
                   :RCODE,                                             *02053000
                   :CRDTRATG,                                          *02054000
                   :DORMCODE,                                          *02055000
                   :BLKCODE,                                           *02056000
                   :RAREA1,                                            *02057000
                   :OFCR1,                                             *02058000
                   :OFCR2,                                             *02059000
                   :COSTCNTR,                                          *02060000
                   :SVCNEXT,                                           *02061000
                   :UOPT1,                                             *02062000
                   :UOPT2,                                             *02063000
                   :UOPT3,                                             *02064000
                   :UOPT4,                                             *02065000
                   :RAREA2,                                            *02066000
                   :CURRBAL,                                           *02067000
                   :CURRCBAL,                                          *02068000
                   :CURRBBAL,                                          *02069000
                   :LOWBAL,                                            *02070000
                   :AVGBAL,                                            *02071000
                   :AVGCBAL,                                           *02072000
                   :CBAL,                                              *02073000
                   :CRLIMT,                                            *02074000
                   :RSVBAL1,                                           *02075000
                   :RSVBAL2,                                           *02076000
                   :RSVBAL3,                                           *02077000
                   :RSVBAL4,                                           *02078000
                   :RSVBAL5,                                           *02079000
                   :RSVBAL6,                                           *02080000
                   :RSVBAL7,                                           *02081000
                   :USRBAL1,                                           *02082000
                   :USRBAL2,                                           *02083000
                   :USRBAL3,                                           *02084000
                   :USRBAL4,                                           *02085000
                   :USRBAL5,                                           *02086000
                   :RAREA3)                                             02087000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02088000
         BR    14                      RETURN TO CALLER                 02089000
         LTORG                                                          02090000
*                                                                       02091000
*                                                                       02092000
**********************************************************************  02093000
* UPDATE STATEMENT BY PRIMARY KEY:                                      02094000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02095000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02096000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02097000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02098000
*     STATEMENT.                                                        02099000
**********************************************************************  02100000
*                                                                       02101000
SQL#0037 DS    0H                                                       02102000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          02103000
         B     *+6                     BRANCH AROUND ADCON              02104000
BASE0037 DC    AL2(4096)                                                02105000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    02106000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02107000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02108000
         AH    3,BASE0037              ADD 4K                           02109000
         EXEC  SQL                                                     *02110000
               UPDATE SAD                                              *02111000
                   SET AUDIT_DATE = :AUDDATE,                          *02112000
                     AUDIT_TIME = :AUDTIME,                            *02113000
                     AUDIT_USER = :AUDUSER,                            *02114000
                     AUDIT_ORG = :AUDORG,                              *02115000
                     ACCT_STATUS = :ACCTST,                            *02116000
                     APPL_STATUS = :STATUS,                            *02117000
                     BRANCH = :BRANCH,                                 *02118000
                     ACCT_TYPE = :ACCTTYPE,                            *02119000
                     TERM = :TERM,                                     *02120000
                     AUTO_DEBIT = :AUTODEBT,                           *02121000
                     DELINQ_DAY = :DLNQDAY,                            *02122000
                     RISK_CODE = :RCODE,                               *02123000
                     CREDIT_RATING = :CRDTRATG,                        *02124000
                     DORMANT_CODE = :DORMCODE,                         *02125000
                     BLOCK_CODE = :BLKCODE,                            *02126000
                     RSV_AREA_1 = :RAREA1,                             *02127000
                     OFFICER_1 = :OFCR1,                               *02128000
                     OFFICER_2 = :OFCR2,                               *02129000
                     COST_CENTER = :COSTCNTR,                          *02130000
                     SVC_NEXT = :SVCNEXT,                              *02131000
                     USER_OPT_1 = :UOPT1,                              *02132000
                     USER_OPT_2 = :UOPT2,                              *02133000
                     USER_OPT_3 = :UOPT3,                              *02134000
                     USER_OPT_4 = :UOPT4,                              *02135000
                     RSV_AREA_2 = :RAREA2,                             *02136000
                     CURR_BAL = :CURRBAL,                              *02137000
                     CURR_C_BAL = :CURRCBAL,                           *02138000
                     CURR_B_BAL = :CURRBBAL,                           *02139000
                     LOW_BAL = :LOWBAL,                                *02140000
                     AVG_BAL = :AVGBAL,                                *02141000
                     AVG_COL_BAL = :AVGCBAL,                           *02142000
                     COMMIT_BAL = :CBAL,                               *02143000
                     CREDIT_LIMIT = :CRLIMT,                           *02144000
                     RSV_BAL_1 = :RSVBAL1,                             *02145000
                     RSV_BAL_2 = :RSVBAL2,                             *02146000
                     RSV_BAL_3 = :RSVBAL3,                             *02147000
                     RSV_BAL_4 = :RSVBAL4,                             *02148000
                     RSV_BAL_5 = :RSVBAL5,                             *02149000
                     RSV_BAL_6 = :RSVBAL6,                             *02150000
                     RSV_BAL_7 = :RSVBAL7,                             *02151000
                     USER_BAL_1 = :USRBAL1,                            *02152000
                     USER_BAL_2 = :USRBAL2,                            *02153000
                     USER_BAL_3 = :USRBAL3,                            *02154000
                     USER_BAL_4 = :USRBAL4,                            *02155000
                     USER_BAL_5 = :USRBAL5,                            *02156000
                     RSV_AREA_3 = :RAREA3                              *02157000
                 WHERE CURRENT OF SADUPD0                               02158000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02159000
         BR    14                      RETURN TO CALLER                 02160000
         LTORG                                                          02161000
*                                                                       02162000
*                                                                       02163000
**********************************************************************  02164000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  02165000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02166000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02167000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02168000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02169000
*     STATEMENT.                                                        02170000
**********************************************************************  02171000
*                                                                       02172000
SQL#0038 DS    0H                                                       02173000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          02174000
         LA    15,255                  SET RETURN CODE                  02175000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02176000
         BR    14                      RETURN TO CALLER                 02177000
         LTORG                                                          02178000
*                                                                       02179000
*                                                                       02180000
**********************************************************************  02181000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  02182000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02183000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02184000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02185000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02186000
*     STATEMENT.                                                        02187000
**********************************************************************  02188000
*                                                                       02189000
SQL#0039 DS    0H                                                       02190000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          02191000
         LA    15,255                  SET RETURN CODE                  02192000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02193000
         BR    14                      RETURN TO CALLER                 02194000
         LTORG                                                          02195000
*                                                                       02196000
*                                                                       02197000
**********************************************************************  02198000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  02199000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             02200000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        02201000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         02202000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             02203000
*     STATEMENT.                                                        02204000
**********************************************************************  02205000
*                                                                       02206000
SQL#0040 DS    0H                                                       02207000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          02208000
         LA    15,255                  SET RETURN CODE                  02209000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02210000
         BR    14                      RETURN TO CALLER                 02211000
         LTORG                                                          02212000
*                                                                       02213000
*                                                                       02214000
**********************************************************************  02215000
* DELETE STATEMENT BY PRIMARY KEY:                                      02216000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02217000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02218000
**********************************************************************  02219000
*                                                                       02220000
SQL#0041 DS    0H                                                       02221000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          02222000
         B     *+6                     BRANCH AROUND ADCON              02223000
BASE0041 DC    AL2(4096)                                                02224000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02225000
         AH    3,BASE0041              ADD 4K                           02226000
         EXEC  SQL                                                     *02227000
               DELETE FROM SAD                                         *02228000
                 WHERE CURRENT OF SADUPD0                               02229000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02230000
         BR    14                      RETURN TO CALLER                 02231000
         LTORG                                                          02232000
*                                                                       02233000
*                                                                       02234000
**********************************************************************  02235000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  02236000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02237000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02238000
**********************************************************************  02239000
*                                                                       02240000
SQL#0042 DS    0H                                                       02241000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          02242000
         LA    15,255                  SET RETURN CODE                  02243000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02244000
         BR    14                      RETURN TO CALLER                 02245000
         LTORG                                                          02246000
*                                                                       02247000
*                                                                       02248000
**********************************************************************  02249000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  02250000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02251000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02252000
**********************************************************************  02253000
*                                                                       02254000
SQL#0043 DS    0H                                                       02255000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          02256000
         LA    15,255                  SET RETURN CODE                  02257000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02258000
         BR    14                      RETURN TO CALLER                 02259000
         LTORG                                                          02260000
*                                                                       02261000
*                                                                       02262000
**********************************************************************  02263000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  02264000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            02265000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02266000
**********************************************************************  02267000
*                                                                       02268000
SQL#0044 DS    0H                                                       02269000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          02270000
         LA    15,255                  SET RETURN CODE                  02271000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02272000
         BR    14                      RETURN TO CALLER                 02273000
         LTORG                                                          02274000
*                                                                       02275000
*                                                                       02276000
**********************************************************************  02277000
* DELETE ALL STATEMENT:                                                 02278000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       02279000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  02280000
**********************************************************************  02281000
*                                                                       02282000
SQL#0045 DS    0H                                                       02283000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          02284000
         B     *+6                     BRANCH AROUND ADCON              02285000
BASE0045 DC    AL2(4096)                                                02286000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02287000
         AH    3,BASE0045              ADD 4K                           02288000
         EXEC  SQL                                                     *02289000
               DELETE FROM SAD                                          02290000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02291000
         BR    14                      RETURN TO CALLER                 02292000
         LTORG                                                          02293000
*                                                                       02294000
*                                                                       02295000
**********************************************************************  02296000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          02297000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                02298000
**********************************************************************  02299000
*                                                                       02300000
SQL#0046 DS    0H                                                       02301000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          02302000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              02303000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      02304000
         BALR  4,5                     MOVE INTO HOST VARIABLES         02305000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      02306000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         02307000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               02308000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      02309000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      02310000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     02311000
VECT0046 DC    A(0)                                                     02312000
         DC    A(SQL#0246)                                              02313000
         DC    A(SQL#0346)                                              02314000
         DC    A(SQL#0446)                                              02315000
         DC    A(SQL#0546)                                              02316000
         DC    A(SQL#0646)                                              02317000
         DC    A(SQL#0746)                                              02318000
         LTORG                                                          02319000
*                                                                       02320000
SQL#0246 DS    0H                                                       02321000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          02322000
         B     *+6                     BRANCH AROUND ADCON              02323000
BASE0246 DC    AL2(4096)                                                02324000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02325000
         AH    3,BASE0246              ADD 4K                           02326000
         EXEC  SQL                                                     *02327000
               CLOSE SADSQ001                                           02328000
         EXEC  SQL                                                     *02329000
               DECLARE SADSQ002 CURSOR FOR                             *02330000
               SELECT ACCT_INST_1,                                     *02331000
                   PROD_CODE_1,                                        *02332000
                   ACCT_NBR_1,                                         *02333000
                   MODEL_1,                                            *02334000
                   ACCT_INST_2,                                        *02335000
                   PROD_CODE_2,                                        *02336000
                   ACCT_NBR_2,                                         *02337000
                   AUDIT_DATE,                                         *02338000
                   AUDIT_TIME,                                         *02339000
                   AUDIT_USER,                                         *02340000
                   AUDIT_ORG,                                          *02341000
                   ACCT_STATUS,                                        *02342000
                   APPL_STATUS,                                        *02343000
                   BRANCH,                                             *02344000
                   ACCT_TYPE,                                          *02345000
                   TERM,                                               *02346000
                   AUTO_DEBIT,                                         *02347000
                   DELINQ_DAY,                                         *02348000
                   RISK_CODE,                                          *02349000
                   CREDIT_RATING,                                      *02350000
                   DORMANT_CODE,                                       *02351000
                   BLOCK_CODE,                                         *02352000
                   RSV_AREA_1,                                         *02353000
                   OFFICER_1,                                          *02354000
                   OFFICER_2,                                          *02355000
                   COST_CENTER,                                        *02356000
                   SVC_NEXT,                                           *02357000
                   USER_OPT_1,                                         *02358000
                   USER_OPT_2,                                         *02359000
                   USER_OPT_3,                                         *02360000
                   USER_OPT_4,                                         *02361000
                   RSV_AREA_2,                                         *02362000
                   CURR_BAL,                                           *02363000
                   CURR_C_BAL,                                         *02364000
                   CURR_B_BAL,                                         *02365000
                   LOW_BAL,                                            *02366000
                   AVG_BAL,                                            *02367000
                   AVG_COL_BAL,                                        *02368000
                   COMMIT_BAL,                                         *02369000
                   CREDIT_LIMIT,                                       *02370000
                   RSV_BAL_1,                                          *02371000
                   RSV_BAL_2,                                          *02372000
                   RSV_BAL_3,                                          *02373000
                   RSV_BAL_4,                                          *02374000
                   RSV_BAL_5,                                          *02375000
                   RSV_BAL_6,                                          *02376000
                   RSV_BAL_7,                                          *02377000
                   USER_BAL_1,                                         *02378000
                   USER_BAL_2,                                         *02379000
                   USER_BAL_3,                                         *02380000
                   USER_BAL_4,                                         *02381000
                   USER_BAL_5,                                         *02382000
                   RSV_AREA_3                                          *02383000
                 FROM SAD                                              *02384000
                 WHERE                                                 *02385000
                    ACCT_INST_1 = :INST1 AND                           *02386000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02387000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02388000
                    MODEL_1 = :MODEL1 AND                              *02389000
                    ACCT_INST_2 = :INST2 AND                           *02390000
                    PROD_CODE_2 > :PRDCDE2                             *02391000
                 ORDER BY PROD_CODE_2,                                 *02392000
                   ACCT_NBR_2                                          *02393000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02394000
         EXEC  SQL                                                     *02395000
               OPEN SADSQ002                                            02396000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02397000
         BNZ   *+8                     NO - RETURN ERROR                02398000
         LR    12,9                    LOAD RETURN ADDRESS              02399000
         BR    12                      RETURN TO FETCH ROUTINE          02400000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02401000
         BR    14                      RETURN TO CALLER                 02402000
         LTORG                                                          02403000
*                                                                       02404000
SQL#0346 DS    0H                                                       02405000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          02406000
         B     *+6                     BRANCH AROUND ADCON              02407000
BASE0346 DC    AL2(4096)                                                02408000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02409000
         AH    3,BASE0346              ADD 4K                           02410000
         EXEC  SQL                                                     *02411000
               CLOSE SADSQ002                                           02412000
         EXEC  SQL                                                     *02413000
               DECLARE SADSQ003 CURSOR FOR                             *02414000
               SELECT ACCT_INST_1,                                     *02415000
                   PROD_CODE_1,                                        *02416000
                   ACCT_NBR_1,                                         *02417000
                   MODEL_1,                                            *02418000
                   ACCT_INST_2,                                        *02419000
                   PROD_CODE_2,                                        *02420000
                   ACCT_NBR_2,                                         *02421000
                   AUDIT_DATE,                                         *02422000
                   AUDIT_TIME,                                         *02423000
                   AUDIT_USER,                                         *02424000
                   AUDIT_ORG,                                          *02425000
                   ACCT_STATUS,                                        *02426000
                   APPL_STATUS,                                        *02427000
                   BRANCH,                                             *02428000
                   ACCT_TYPE,                                          *02429000
                   TERM,                                               *02430000
                   AUTO_DEBIT,                                         *02431000
                   DELINQ_DAY,                                         *02432000
                   RISK_CODE,                                          *02433000
                   CREDIT_RATING,                                      *02434000
                   DORMANT_CODE,                                       *02435000
                   BLOCK_CODE,                                         *02436000
                   RSV_AREA_1,                                         *02437000
                   OFFICER_1,                                          *02438000
                   OFFICER_2,                                          *02439000
                   COST_CENTER,                                        *02440000
                   SVC_NEXT,                                           *02441000
                   USER_OPT_1,                                         *02442000
                   USER_OPT_2,                                         *02443000
                   USER_OPT_3,                                         *02444000
                   USER_OPT_4,                                         *02445000
                   RSV_AREA_2,                                         *02446000
                   CURR_BAL,                                           *02447000
                   CURR_C_BAL,                                         *02448000
                   CURR_B_BAL,                                         *02449000
                   LOW_BAL,                                            *02450000
                   AVG_BAL,                                            *02451000
                   AVG_COL_BAL,                                        *02452000
                   COMMIT_BAL,                                         *02453000
                   CREDIT_LIMIT,                                       *02454000
                   RSV_BAL_1,                                          *02455000
                   RSV_BAL_2,                                          *02456000
                   RSV_BAL_3,                                          *02457000
                   RSV_BAL_4,                                          *02458000
                   RSV_BAL_5,                                          *02459000
                   RSV_BAL_6,                                          *02460000
                   RSV_BAL_7,                                          *02461000
                   USER_BAL_1,                                         *02462000
                   USER_BAL_2,                                         *02463000
                   USER_BAL_3,                                         *02464000
                   USER_BAL_4,                                         *02465000
                   USER_BAL_5,                                         *02466000
                   RSV_AREA_3                                          *02467000
                 FROM SAD                                              *02468000
                 WHERE                                                 *02469000
                    ACCT_INST_1 = :INST1 AND                           *02470000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02471000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02472000
                    MODEL_1 = :MODEL1 AND                              *02473000
                    ACCT_INST_2 > :INST2                               *02474000
                 ORDER BY ACCT_INST_2,                                 *02475000
                   PROD_CODE_2,                                        *02476000
                   ACCT_NBR_2                                          *02477000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02478000
         EXEC  SQL                                                     *02479000
               OPEN SADSQ003                                            02480000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02481000
         BNZ   *+8                     NO - RETURN ERROR                02482000
         LR    12,9                    LOAD RETURN ADDRESS              02483000
         BR    12                      RETURN TO FETCH ROUTINE          02484000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02485000
         BR    14                      RETURN TO CALLER                 02486000
         LTORG                                                          02487000
*                                                                       02488000
SQL#0446 DS    0H                                                       02489000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          02490000
         B     *+6                     BRANCH AROUND ADCON              02491000
BASE0446 DC    AL2(4096)                                                02492000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02493000
         AH    3,BASE0446              ADD 4K                           02494000
         EXEC  SQL                                                     *02495000
               CLOSE SADSQ003                                           02496000
         EXEC  SQL                                                     *02497000
               DECLARE SADSQ004 CURSOR FOR                             *02498000
               SELECT ACCT_INST_1,                                     *02499000
                   PROD_CODE_1,                                        *02500000
                   ACCT_NBR_1,                                         *02501000
                   MODEL_1,                                            *02502000
                   ACCT_INST_2,                                        *02503000
                   PROD_CODE_2,                                        *02504000
                   ACCT_NBR_2,                                         *02505000
                   AUDIT_DATE,                                         *02506000
                   AUDIT_TIME,                                         *02507000
                   AUDIT_USER,                                         *02508000
                   AUDIT_ORG,                                          *02509000
                   ACCT_STATUS,                                        *02510000
                   APPL_STATUS,                                        *02511000
                   BRANCH,                                             *02512000
                   ACCT_TYPE,                                          *02513000
                   TERM,                                               *02514000
                   AUTO_DEBIT,                                         *02515000
                   DELINQ_DAY,                                         *02516000
                   RISK_CODE,                                          *02517000
                   CREDIT_RATING,                                      *02518000
                   DORMANT_CODE,                                       *02519000
                   BLOCK_CODE,                                         *02520000
                   RSV_AREA_1,                                         *02521000
                   OFFICER_1,                                          *02522000
                   OFFICER_2,                                          *02523000
                   COST_CENTER,                                        *02524000
                   SVC_NEXT,                                           *02525000
                   USER_OPT_1,                                         *02526000
                   USER_OPT_2,                                         *02527000
                   USER_OPT_3,                                         *02528000
                   USER_OPT_4,                                         *02529000
                   RSV_AREA_2,                                         *02530000
                   CURR_BAL,                                           *02531000
                   CURR_C_BAL,                                         *02532000
                   CURR_B_BAL,                                         *02533000
                   LOW_BAL,                                            *02534000
                   AVG_BAL,                                            *02535000
                   AVG_COL_BAL,                                        *02536000
                   COMMIT_BAL,                                         *02537000
                   CREDIT_LIMIT,                                       *02538000
                   RSV_BAL_1,                                          *02539000
                   RSV_BAL_2,                                          *02540000
                   RSV_BAL_3,                                          *02541000
                   RSV_BAL_4,                                          *02542000
                   RSV_BAL_5,                                          *02543000
                   RSV_BAL_6,                                          *02544000
                   RSV_BAL_7,                                          *02545000
                   USER_BAL_1,                                         *02546000
                   USER_BAL_2,                                         *02547000
                   USER_BAL_3,                                         *02548000
                   USER_BAL_4,                                         *02549000
                   USER_BAL_5,                                         *02550000
                   RSV_AREA_3                                          *02551000
                 FROM SAD                                              *02552000
                 WHERE                                                 *02553000
                    ACCT_INST_1 = :INST1 AND                           *02554000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02555000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02556000
                    MODEL_1 > :MODEL1                                  *02557000
                 ORDER BY MODEL_1,                                     *02558000
                   ACCT_INST_2,                                        *02559000
                   PROD_CODE_2,                                        *02560000
                   ACCT_NBR_2                                          *02561000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02562000
         EXEC  SQL                                                     *02563000
               OPEN SADSQ004                                            02564000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02565000
         BNZ   *+8                     NO - RETURN ERROR                02566000
         LR    12,9                    LOAD RETURN ADDRESS              02567000
         BR    12                      RETURN TO FETCH ROUTINE          02568000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02569000
         BR    14                      RETURN TO CALLER                 02570000
         LTORG                                                          02571000
*                                                                       02572000
SQL#0546 DS    0H                                                       02573000
         USING SQL#0546,12             ESTABLISH BASE REGISTER          02574000
         B     *+6                     BRANCH AROUND ADCON              02575000
BASE0546 DC    AL2(4096)                                                02576000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02577000
         AH    3,BASE0546              ADD 4K                           02578000
         EXEC  SQL                                                     *02579000
               CLOSE SADSQ004                                           02580000
         EXEC  SQL                                                     *02581000
               DECLARE SADSQ005 CURSOR FOR                             *02582000
               SELECT ACCT_INST_1,                                     *02583000
                   PROD_CODE_1,                                        *02584000
                   ACCT_NBR_1,                                         *02585000
                   MODEL_1,                                            *02586000
                   ACCT_INST_2,                                        *02587000
                   PROD_CODE_2,                                        *02588000
                   ACCT_NBR_2,                                         *02589000
                   AUDIT_DATE,                                         *02590000
                   AUDIT_TIME,                                         *02591000
                   AUDIT_USER,                                         *02592000
                   AUDIT_ORG,                                          *02593000
                   ACCT_STATUS,                                        *02594000
                   APPL_STATUS,                                        *02595000
                   BRANCH,                                             *02596000
                   ACCT_TYPE,                                          *02597000
                   TERM,                                               *02598000
                   AUTO_DEBIT,                                         *02599000
                   DELINQ_DAY,                                         *02600000
                   RISK_CODE,                                          *02601000
                   CREDIT_RATING,                                      *02602000
                   DORMANT_CODE,                                       *02603000
                   BLOCK_CODE,                                         *02604000
                   RSV_AREA_1,                                         *02605000
                   OFFICER_1,                                          *02606000
                   OFFICER_2,                                          *02607000
                   COST_CENTER,                                        *02608000
                   SVC_NEXT,                                           *02609000
                   USER_OPT_1,                                         *02610000
                   USER_OPT_2,                                         *02611000
                   USER_OPT_3,                                         *02612000
                   USER_OPT_4,                                         *02613000
                   RSV_AREA_2,                                         *02614000
                   CURR_BAL,                                           *02615000
                   CURR_C_BAL,                                         *02616000
                   CURR_B_BAL,                                         *02617000
                   LOW_BAL,                                            *02618000
                   AVG_BAL,                                            *02619000
                   AVG_COL_BAL,                                        *02620000
                   COMMIT_BAL,                                         *02621000
                   CREDIT_LIMIT,                                       *02622000
                   RSV_BAL_1,                                          *02623000
                   RSV_BAL_2,                                          *02624000
                   RSV_BAL_3,                                          *02625000
                   RSV_BAL_4,                                          *02626000
                   RSV_BAL_5,                                          *02627000
                   RSV_BAL_6,                                          *02628000
                   RSV_BAL_7,                                          *02629000
                   USER_BAL_1,                                         *02630000
                   USER_BAL_2,                                         *02631000
                   USER_BAL_3,                                         *02632000
                   USER_BAL_4,                                         *02633000
                   USER_BAL_5,                                         *02634000
                   RSV_AREA_3                                          *02635000
                 FROM SAD                                              *02636000
                 WHERE                                                 *02637000
                    ACCT_INST_1 = :INST1 AND                           *02638000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02639000
                    ACCT_NBR_1 > :ACCTNBR1                             *02640000
                 ORDER BY ACCT_NBR_1,                                  *02641000
                   MODEL_1,                                            *02642000
                   ACCT_INST_2,                                        *02643000
                   PROD_CODE_2,                                        *02644000
                   ACCT_NBR_2                                          *02645000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02646000
         EXEC  SQL                                                     *02647000
               OPEN SADSQ005                                            02648000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02649000
         BNZ   *+8                     NO - RETURN ERROR                02650000
         LR    12,9                    LOAD RETURN ADDRESS              02651000
         BR    12                      RETURN TO FETCH ROUTINE          02652000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02653000
         BR    14                      RETURN TO CALLER                 02654000
         LTORG                                                          02655000
*                                                                       02656000
SQL#0646 DS    0H                                                       02657000
         USING SQL#0646,12             ESTABLISH BASE REGISTER          02658000
         B     *+6                     BRANCH AROUND ADCON              02659000
BASE0646 DC    AL2(4096)                                                02660000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02661000
         AH    3,BASE0646              ADD 4K                           02662000
         EXEC  SQL                                                     *02663000
               CLOSE SADSQ005                                           02664000
         EXEC  SQL                                                     *02665000
               DECLARE SADSQ006 CURSOR FOR                             *02666000
               SELECT ACCT_INST_1,                                     *02667000
                   PROD_CODE_1,                                        *02668000
                   ACCT_NBR_1,                                         *02669000
                   MODEL_1,                                            *02670000
                   ACCT_INST_2,                                        *02671000
                   PROD_CODE_2,                                        *02672000
                   ACCT_NBR_2,                                         *02673000
                   AUDIT_DATE,                                         *02674000
                   AUDIT_TIME,                                         *02675000
                   AUDIT_USER,                                         *02676000
                   AUDIT_ORG,                                          *02677000
                   ACCT_STATUS,                                        *02678000
                   APPL_STATUS,                                        *02679000
                   BRANCH,                                             *02680000
                   ACCT_TYPE,                                          *02681000
                   TERM,                                               *02682000
                   AUTO_DEBIT,                                         *02683000
                   DELINQ_DAY,                                         *02684000
                   RISK_CODE,                                          *02685000
                   CREDIT_RATING,                                      *02686000
                   DORMANT_CODE,                                       *02687000
                   BLOCK_CODE,                                         *02688000
                   RSV_AREA_1,                                         *02689000
                   OFFICER_1,                                          *02690000
                   OFFICER_2,                                          *02691000
                   COST_CENTER,                                        *02692000
                   SVC_NEXT,                                           *02693000
                   USER_OPT_1,                                         *02694000
                   USER_OPT_2,                                         *02695000
                   USER_OPT_3,                                         *02696000
                   USER_OPT_4,                                         *02697000
                   RSV_AREA_2,                                         *02698000
                   CURR_BAL,                                           *02699000
                   CURR_C_BAL,                                         *02700000
                   CURR_B_BAL,                                         *02701000
                   LOW_BAL,                                            *02702000
                   AVG_BAL,                                            *02703000
                   AVG_COL_BAL,                                        *02704000
                   COMMIT_BAL,                                         *02705000
                   CREDIT_LIMIT,                                       *02706000
                   RSV_BAL_1,                                          *02707000
                   RSV_BAL_2,                                          *02708000
                   RSV_BAL_3,                                          *02709000
                   RSV_BAL_4,                                          *02710000
                   RSV_BAL_5,                                          *02711000
                   RSV_BAL_6,                                          *02712000
                   RSV_BAL_7,                                          *02713000
                   USER_BAL_1,                                         *02714000
                   USER_BAL_2,                                         *02715000
                   USER_BAL_3,                                         *02716000
                   USER_BAL_4,                                         *02717000
                   USER_BAL_5,                                         *02718000
                   RSV_AREA_3                                          *02719000
                 FROM SAD                                              *02720000
                 WHERE                                                 *02721000
                    ACCT_INST_1 = :INST1 AND                           *02722000
                    PROD_CODE_1 > :PRDCDE1                             *02723000
                 ORDER BY PROD_CODE_1,                                 *02724000
                   ACCT_NBR_1,                                         *02725000
                   MODEL_1,                                            *02726000
                   ACCT_INST_2,                                        *02727000
                   PROD_CODE_2,                                        *02728000
                   ACCT_NBR_2                                          *02729000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02730000
         EXEC  SQL                                                     *02731000
               OPEN SADSQ006                                            02732000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02733000
         BNZ   *+8                     NO - RETURN ERROR                02734000
         LR    12,9                    LOAD RETURN ADDRESS              02735000
         BR    12                      RETURN TO FETCH ROUTINE          02736000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02737000
         BR    14                      RETURN TO CALLER                 02738000
         LTORG                                                          02739000
*                                                                       02740000
SQL#0746 DS    0H                                                       02741000
         USING SQL#0746,12             ESTABLISH BASE REGISTER          02742000
         B     *+6                     BRANCH AROUND ADCON              02743000
BASE0746 DC    AL2(4096)                                                02744000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02745000
         AH    3,BASE0746              ADD 4K                           02746000
         EXEC  SQL                                                     *02747000
               CLOSE SADSQ006                                           02748000
         EXEC  SQL                                                     *02749000
               DECLARE SADSQ007 CURSOR FOR                             *02750000
               SELECT ACCT_INST_1,                                     *02751000
                   PROD_CODE_1,                                        *02752000
                   ACCT_NBR_1,                                         *02753000
                   MODEL_1,                                            *02754000
                   ACCT_INST_2,                                        *02755000
                   PROD_CODE_2,                                        *02756000
                   ACCT_NBR_2,                                         *02757000
                   AUDIT_DATE,                                         *02758000
                   AUDIT_TIME,                                         *02759000
                   AUDIT_USER,                                         *02760000
                   AUDIT_ORG,                                          *02761000
                   ACCT_STATUS,                                        *02762000
                   APPL_STATUS,                                        *02763000
                   BRANCH,                                             *02764000
                   ACCT_TYPE,                                          *02765000
                   TERM,                                               *02766000
                   AUTO_DEBIT,                                         *02767000
                   DELINQ_DAY,                                         *02768000
                   RISK_CODE,                                          *02769000
                   CREDIT_RATING,                                      *02770000
                   DORMANT_CODE,                                       *02771000
                   BLOCK_CODE,                                         *02772000
                   RSV_AREA_1,                                         *02773000
                   OFFICER_1,                                          *02774000
                   OFFICER_2,                                          *02775000
                   COST_CENTER,                                        *02776000
                   SVC_NEXT,                                           *02777000
                   USER_OPT_1,                                         *02778000
                   USER_OPT_2,                                         *02779000
                   USER_OPT_3,                                         *02780000
                   USER_OPT_4,                                         *02781000
                   RSV_AREA_2,                                         *02782000
                   CURR_BAL,                                           *02783000
                   CURR_C_BAL,                                         *02784000
                   CURR_B_BAL,                                         *02785000
                   LOW_BAL,                                            *02786000
                   AVG_BAL,                                            *02787000
                   AVG_COL_BAL,                                        *02788000
                   COMMIT_BAL,                                         *02789000
                   CREDIT_LIMIT,                                       *02790000
                   RSV_BAL_1,                                          *02791000
                   RSV_BAL_2,                                          *02792000
                   RSV_BAL_3,                                          *02793000
                   RSV_BAL_4,                                          *02794000
                   RSV_BAL_5,                                          *02795000
                   RSV_BAL_6,                                          *02796000
                   RSV_BAL_7,                                          *02797000
                   USER_BAL_1,                                         *02798000
                   USER_BAL_2,                                         *02799000
                   USER_BAL_3,                                         *02800000
                   USER_BAL_4,                                         *02801000
                   USER_BAL_5,                                         *02802000
                   RSV_AREA_3                                          *02803000
                 FROM SAD                                              *02804000
                 WHERE                                                 *02805000
                    ACCT_INST_1 > :INST1                               *02806000
                 ORDER BY ACCT_INST_1,                                 *02807000
                   PROD_CODE_1,                                        *02808000
                   ACCT_NBR_1,                                         *02809000
                   MODEL_1,                                            *02810000
                   ACCT_INST_2,                                        *02811000
                   PROD_CODE_2,                                        *02812000
                   ACCT_NBR_2                                          *02813000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02814000
         EXEC  SQL                                                     *02815000
               OPEN SADSQ007                                            02816000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02817000
         BNZ   *+8                     NO - RETURN ERROR                02818000
         LR    12,9                    LOAD RETURN ADDRESS              02819000
         BR    12                      RETURN TO FETCH ROUTINE          02820000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02821000
         BR    14                      RETURN TO CALLER                 02822000
         LTORG                                                          02823000
*                                                                       02824000
*                                                                       02825000
**********************************************************************  02826000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02827000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02828000
**********************************************************************  02829000
*                                                                       02830000
SQL#0047 DS    0H                                                       02831000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02832000
         LA    15,255                  SET RETURN CODE                  02833000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02834000
         BR    14                      RETURN TO CALLER                 02835000
         LTORG                                                          02836000
*                                                                       02837000
*                                                                       02838000
**********************************************************************  02839000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02840000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02841000
**********************************************************************  02842000
*                                                                       02843000
SQL#0048 DS    0H                                                       02844000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02845000
         LA    15,255                  SET RETURN CODE                  02846000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02847000
         BR    14                      RETURN TO CALLER                 02848000
         LTORG                                                          02849000
*                                                                       02850000
*                                                                       02851000
**********************************************************************  02852000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02853000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02854000
**********************************************************************  02855000
*                                                                       02856000
SQL#0049 DS    0H                                                       02857000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02858000
         LA    15,255                  SET RETURN CODE                  02859000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02860000
         BR    14                      RETURN TO CALLER                 02861000
         LTORG                                                          02862000
*                                                                       02863000
         DS    0H                      END OF SQL STATEMENTS            02864000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02865000
*                                                                       02866000
*                                                                       02867000
**********************************************************************  02868000
* DUMMY ENTRY POINT DSNHLI                                              02869000
*   MUST NOT BE MODIFIED.                                               02870000
**********************************************************************  02871000
*                                                                       02872000
         ENTRY DSNHLI                                                   02873000
DSNHLI   DS    0H                                                       02874000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02875000
         BR    15                      BRANCH TO ATTACH FACILITY        02876000
*                                                                       02877000
*                                                                       02878000
**********************************************************************  02879000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02880000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02881000
*   MUST NOT BE MODIFIED.                                               02882000
**********************************************************************  02883000
*                                                                       02884000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02885000
CONV#RTN AMODE ANY                                                      02886000
CONV#RTN RMODE ANY                                                      02887000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02888000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02889000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02890000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02891000
         BER   4                         YES - RETURN TO SQL            02892000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02893000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02894000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02895000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02896000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02897000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02898000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02899000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02900000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02901000
*                                                                       02902000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02903000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02904000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02905000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02906000
         BER   4                         YES - RETURN TO SQL            02907000
         SLR   0,0                     CLEAR FOR INSERT                 02908000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02909000
         NR    0,3                     FOR THE CURRENT KEY?             02910000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02911000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02912000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02913000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02914000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02915000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02916000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02917000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02918000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02919000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02920000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02921000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02922000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02923000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02924000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02925000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02926000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02927000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02928000
*                                                                       02929000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02930000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02931000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02932000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02933000
         BER   4                         YES - RETURN TO SQL            02934000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02935000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02936000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02937000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02938000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02939000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02940000
         MVCL  0,14                    MOVE TO RECORD AREA              02941000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02942000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02943000
*                                                                       02944000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02945000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02946000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02947000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02948000
         BER   4                         YES - RETURN TO SQL            02949000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02950000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02951000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02952000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02953000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02954000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02955000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02956000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02957000
         MVCL  0,14                    MOVE TO RECORD AREA              02958000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02959000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02960000
*                                                                       02961000
*                                                                       02962000
**********************************************************************  02963000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02964000
*   MUST NOT BE MODIFIED.                                               02965000
**********************************************************************  02966000
*                                                                       02967000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02968000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02969000
         DC    H'0066'                 LENGTH TO MOVE                   02970000
         DC    X'80'                   80 = KEY 0 FIELD                 02971000
*                                      40 = KEY 1 FIELD                 02972000
*                                      20 = KEY 2 FIELD                 02973000
*                                      10 = KEY 3 FIELD                 02974000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02975000
*                                                                       02976000
*                                      REST OF FIELD ENTRIES            02977000
         DC    H'0066',H'0066',H'0313',X'00',X'00'                      02978000
         DC    8X'FF'                  END OF FIELD ENTRIES             02979000
         LTORG                                                          02980000
         END                                                            02981000
