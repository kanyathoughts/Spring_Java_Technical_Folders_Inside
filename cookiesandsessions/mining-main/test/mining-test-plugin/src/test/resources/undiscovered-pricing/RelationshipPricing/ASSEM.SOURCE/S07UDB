**********************************************************************  00001000
*                                                                       00002000
*  S07UDB .... STATIC SQL UPDATE MODULE                                 00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S07 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
BRREGNCD DS    CL6                                                      00052000
AUDDATE  DS    PL5'0.'                                                  00053000
AUDTIME  DS    PL5'0.'                                                  00054000
AUDUSER  DS    CL8                                                      00055000
AUDORG   DS    CL6                                                      00056000
INCLEXCL DS    CL1                                                      00057000
BRREGN01 DS    PL3'0.'                                                  00058000
BRREGN02 DS    PL3'0.'                                                  00059000
BRREGN03 DS    PL3'0.'                                                  00060000
BRREGN04 DS    PL3'0.'                                                  00061000
BRREGN05 DS    PL3'0.'                                                  00062000
BRREGN06 DS    PL3'0.'                                                  00063000
BRREGN07 DS    PL3'0.'                                                  00064000
BRREGN08 DS    PL3'0.'                                                  00065000
BRREGN09 DS    PL3'0.'                                                  00066000
BRREGN10 DS    PL3'0.'                                                  00067000
BRREGN11 DS    PL3'0.'                                                  00068000
BRREGN12 DS    PL3'0.'                                                  00069000
BRREGN13 DS    PL3'0.'                                                  00070000
BRREGN14 DS    PL3'0.'                                                  00071000
BRREGN15 DS    PL3'0.'                                                  00072000
BRREGN16 DS    PL3'0.'                                                  00073000
BRREGN17 DS    PL3'0.'                                                  00074000
BRREGN18 DS    PL3'0.'                                                  00075000
BRREGN19 DS    PL3'0.'                                                  00076000
BRREGN20 DS    PL3'0.'                                                  00077000
BRREGN21 DS    PL3'0.'                                                  00078000
BRREGN22 DS    PL3'0.'                                                  00079000
BRREGN23 DS    PL3'0.'                                                  00080000
BRREGN24 DS    PL3'0.'                                                  00081000
BRREGN25 DS    PL3'0.'                                                  00082000
BRREGN26 DS    PL3'0.'                                                  00083000
BRREGN27 DS    PL3'0.'                                                  00084000
BRREGN28 DS    PL3'0.'                                                  00085000
BRREGN29 DS    PL3'0.'                                                  00086000
BRREGN30 DS    PL3'0.'                                                  00087000
BRREGN31 DS    PL3'0.'                                                  00088000
BRREGN32 DS    PL3'0.'                                                  00089000
BRREGN33 DS    PL3'0.'                                                  00090000
BRREGN34 DS    PL3'0.'                                                  00091000
BRREGN35 DS    PL3'0.'                                                  00092000
BRREGN36 DS    PL3'0.'                                                  00093000
BRREGN37 DS    PL3'0.'                                                  00094000
BRREGN38 DS    PL3'0.'                                                  00095000
BRREGN39 DS    PL3'0.'                                                  00096000
BRREGN40 DS    PL3'0.'                                                  00097000
BRREGN41 DS    PL3'0.'                                                  00098000
BRREGN42 DS    PL3'0.'                                                  00099000
BRREGN43 DS    PL3'0.'                                                  00100000
BRREGN44 DS    PL3'0.'                                                  00101000
BRREGN45 DS    PL3'0.'                                                  00102000
BRREGN46 DS    PL3'0.'                                                  00103000
BRREGN47 DS    PL3'0.'                                                  00104000
BRREGN48 DS    PL3'0.'                                                  00105000
BRREGN49 DS    PL3'0.'                                                  00106000
BRREGN50 DS    PL3'0.'                                                  00107000
TABLETYP DS    CL1                                                      00108000
*                                                                       00109000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00110000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00111000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00112000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00113000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00114000
         DS    CL97                    RESERVED                         00115000
*                                                                       00116000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00117000
INDVARX  DS    0H                                                       00118000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00119000
*                                                                       00120000
*                                                                       00121000
**********************************************************************  00122000
* PROGRAM TABLE HEADER SECTION:                                         00123000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00124000
**********************************************************************  00125000
*                                                                       00126000
S07UDB   CSECT                         PROGRAM TABLE SECTION            00127000
S07UDB   AMODE ANY                                                      00128000
S07UDB   RMODE ANY                                                      00129000
         DC    CL8'S07UDB  '           PROGRAM ID                       00130000
         DC    CL1' '                                                   00131000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00132000
         DC    CL1' '                                                   00133000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00134000
         DC    CL1' '                                                   00135000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00136000
         DC    5A(0)                   RESERVED                         00137000
         DC    AL2(0)                  RESERVED                         00138000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00139000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00140000
         DC    A(0)                    SQLDA DATA TYPE/LENGTH TABLE     00141000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00142000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00143000
         DC    CL29'WWW.INFOR.COM                '                      00143001
*                                                                       00144000
**********************************************************************  00145000
* STATEMENT TABLE SECTION:                                              00146000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00147000
**********************************************************************  00148000
*                                                                       00149000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00150000
STM#TAB  AMODE ANY                                                      00151000
STM#TAB  RMODE ANY                                                      00152000
         DC    4A(0)                   RDB MODULE VECTORS               00153000
         DC    A(SELUC0)               SELECT UPDATE CURSOR (KEY 0)     00154000
         DC    A(SELUC1)               SELECT UPDATE CURSOR (KEY 1)     00155000
         DC    A(SELUC2)               SELECT UPDATE CURSOR (KEY 2)     00156000
         DC    A(SELUC3)               SELECT UPDATE CURSOR (KEY 3)     00157000
         DC    A(FETUC0)               FETCH UPDATE CURSOR (KEY 0)      00158000
         DC    A(FETUC1)               FETCH UPDATE CURSOR (KEY 1)      00159000
         DC    A(FETUC2)               FETCH UPDATE CURSOR (KEY 2)      00160000
         DC    A(FETUC3)               FETCH UPDATE CURSOR (KEY 3)      00161000
         DC    A(CLSUC0)               CLOSE UPDATE CURSOR (KEY 0)      00162000
         DC    A(CLSUC1)               CLOSE UPDATE CURSOR (KEY 1)      00163000
         DC    A(CLSUC2)               CLOSE UPDATE CURSOR (KEY 2)      00164000
         DC    A(CLSUC3)               CLOSE UPDATE CURSOR (KEY 3)      00165000
         DC    20A(0)                  RDB MODULE VECTORS               00166000
         DC    A(INSROW)               INSERT STATEMENT                 00167000
         DC    A(UPDUC0)               UPDATE STATEMENT (KEY 0)         00168000
         DC    A(UPDUC1)               UPDATE STATEMENT (KEY 1)         00169000
         DC    A(UPDUC2)               UPDATE STATEMENT (KEY 2)         00170000
         DC    A(UPDUC3)               UPDATE STATEMENT (KEY 3)         00171000
         DC    A(DELUC0)               DELETE STATEMENT (KEY 0)         00172000
         DC    A(DELUC1)               DELETE STATEMENT (KEY 1)         00173000
         DC    A(DELUC2)               DELETE STATEMENT (KEY 2)         00174000
         DC    A(DELUC3)               DELETE STATEMENT (KEY 3)         00175000
         DC    A(DELTBL)               DELETE ALL STATEMENT             00176000
         DC    4X'FF'                                                   00177000
*                                                                       00178000
**********************************************************************  00179000
* SQL STATEMENT SECTION:                                                00180000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00181000
*     TO SUPPORT THIS TABLE.                                            00182000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00183000
*     ARE EQUIVALENT.                                                   00184000
**********************************************************************  00185000
*                                                                       00186000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00187000
SQL#STMT AMODE ANY                                                      00188000
SQL#STMT RMODE ANY                                                      00189000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00190000
         USING COM#AREA,11             ADDRESS COMMAREA                 00191000
*                                                                       00192000
**********************************************************************  00193000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00194000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00195000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00196000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00197000
**********************************************************************  00198000
*                                                                       00199000
SELUC0   DS    0H                                                       00200000
         USING SELUC0,12               ESTABLISH BASE REGISTER          00201000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00202000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00203000
         BALR  14,15                   MOVE REQUESTED DATA              00204000
         B     *+6                     BRANCH AROUND ADCON              00205000
BASSEL0  DC    AL2(4096)                                                00206000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00207000
         AH    3,BASSEL0               ADD 4K                           00208000
         EXEC  SQL DECLARE S07UPD0 CURSOR                              *00209000
               FOR SELECT                                              *00210000
                   AUDIT_DATE,                                         *00211000
                   AUDIT_TIME,                                         *00212000
                   AUDIT_USER,                                         *00213000
                   AUDIT_ORG,                                          *00214000
                   INCL_EXCL_OPT,                                      *00215000
                   BRCH_REGION_01,                                     *00216000
                   BRCH_REGION_02,                                     *00217000
                   BRCH_REGION_03,                                     *00218000
                   BRCH_REGION_04,                                     *00219000
                   BRCH_REGION_05,                                     *00220000
                   BRCH_REGION_06,                                     *00221000
                   BRCH_REGION_07,                                     *00222000
                   BRCH_REGION_08,                                     *00223000
                   BRCH_REGION_09,                                     *00224000
                   BRCH_REGION_10,                                     *00225000
                   BRCH_REGION_11,                                     *00226000
                   BRCH_REGION_12,                                     *00227000
                   BRCH_REGION_13,                                     *00228000
                   BRCH_REGION_14,                                     *00229000
                   BRCH_REGION_15,                                     *00230000
                   BRCH_REGION_16,                                     *00231000
                   BRCH_REGION_17,                                     *00232000
                   BRCH_REGION_18,                                     *00233000
                   BRCH_REGION_19,                                     *00234000
                   BRCH_REGION_20,                                     *00235000
                   BRCH_REGION_21,                                     *00236000
                   BRCH_REGION_22,                                     *00237000
                   BRCH_REGION_23,                                     *00238000
                   BRCH_REGION_24,                                     *00239000
                   BRCH_REGION_25,                                     *00240000
                   BRCH_REGION_26,                                     *00241000
                   BRCH_REGION_27,                                     *00242000
                   BRCH_REGION_28,                                     *00243000
                   BRCH_REGION_29,                                     *00244000
                   BRCH_REGION_30,                                     *00245000
                   BRCH_REGION_31,                                     *00246000
                   BRCH_REGION_32,                                     *00247000
                   BRCH_REGION_33,                                     *00248000
                   BRCH_REGION_34,                                     *00249000
                   BRCH_REGION_35,                                     *00250000
                   BRCH_REGION_36,                                     *00251000
                   BRCH_REGION_37,                                     *00252000
                   BRCH_REGION_38,                                     *00253000
                   BRCH_REGION_39,                                     *00254000
                   BRCH_REGION_40,                                     *00255000
                   BRCH_REGION_41,                                     *00256000
                   BRCH_REGION_42,                                     *00257000
                   BRCH_REGION_43,                                     *00258000
                   BRCH_REGION_44,                                     *00259000
                   BRCH_REGION_45,                                     *00260000
                   BRCH_REGION_46,                                     *00261000
                   BRCH_REGION_47,                                     *00262000
                   BRCH_REGION_48,                                     *00263000
                   BRCH_REGION_49,                                     *00264000
                   BRCH_REGION_50,                                     *00265000
                   TABLE_TYPE                                          *00266000
                 FROM S07                                              *00267000
                 WHERE                                                 *00268000
                   INST_NBR = :INST AND                                *00269000
                   RECORD_NBR = :RECNBR AND                            *00270000
                   BRCH_REGN_CODE = :BRREGNCD                          *00271000
                 FOR UPDATE OF                                         *00272000
                   AUDIT_DATE,                                         *00273000
                   AUDIT_TIME,                                         *00274000
                   AUDIT_USER,                                         *00275000
                   AUDIT_ORG,                                          *00276000
                   INCL_EXCL_OPT,                                      *00277000
                   BRCH_REGION_01,                                     *00278000
                   BRCH_REGION_02,                                     *00279000
                   BRCH_REGION_03,                                     *00280000
                   BRCH_REGION_04,                                     *00281000
                   BRCH_REGION_05,                                     *00282000
                   BRCH_REGION_06,                                     *00283000
                   BRCH_REGION_07,                                     *00284000
                   BRCH_REGION_08,                                     *00285000
                   BRCH_REGION_09,                                     *00286000
                   BRCH_REGION_10,                                     *00287000
                   BRCH_REGION_11,                                     *00288000
                   BRCH_REGION_12,                                     *00289000
                   BRCH_REGION_13,                                     *00290000
                   BRCH_REGION_14,                                     *00291000
                   BRCH_REGION_15,                                     *00292000
                   BRCH_REGION_16,                                     *00293000
                   BRCH_REGION_17,                                     *00294000
                   BRCH_REGION_18,                                     *00295000
                   BRCH_REGION_19,                                     *00296000
                   BRCH_REGION_20,                                     *00297000
                   BRCH_REGION_21,                                     *00298000
                   BRCH_REGION_22,                                     *00299000
                   BRCH_REGION_23,                                     *00300000
                   BRCH_REGION_24,                                     *00301000
                   BRCH_REGION_25,                                     *00302000
                   BRCH_REGION_26,                                     *00303000
                   BRCH_REGION_27,                                     *00304000
                   BRCH_REGION_28,                                     *00305000
                   BRCH_REGION_29,                                     *00306000
                   BRCH_REGION_30,                                     *00307000
                   BRCH_REGION_31,                                     *00308000
                   BRCH_REGION_32,                                     *00309000
                   BRCH_REGION_33,                                     *00310000
                   BRCH_REGION_34,                                     *00311000
                   BRCH_REGION_35,                                     *00312000
                   BRCH_REGION_36,                                     *00313000
                   BRCH_REGION_37,                                     *00314000
                   BRCH_REGION_38,                                     *00315000
                   BRCH_REGION_39,                                     *00316000
                   BRCH_REGION_40,                                     *00317000
                   BRCH_REGION_41,                                     *00318000
                   BRCH_REGION_42,                                     *00319000
                   BRCH_REGION_43,                                     *00320000
                   BRCH_REGION_44,                                     *00321000
                   BRCH_REGION_45,                                     *00322000
                   BRCH_REGION_46,                                     *00323000
                   BRCH_REGION_47,                                     *00324000
                   BRCH_REGION_48,                                     *00325000
                   BRCH_REGION_49,                                     *00326000
                   BRCH_REGION_50,                                     *00327000
                   TABLE_TYPE                                          *00328000
                 FETCH FIRST 1 ROW ONLY                                 00329000
         EXEC  SQL OPEN S07UPD0                                         00330000
         MVC   SQWCSUCA,=A(CLSUC0)     SET CURSOR CLOSE ROUTINE ADDRESS 00331000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00332000
         BR    14                      RETURN TO CALLER                 00333000
         LTORG                                                          00334000
*                                                                       00335000
**********************************************************************  00336000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00337000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00338000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00339000
*     THE ACTUAL ROW.                                                   00340000
**********************************************************************  00341000
*                                                                       00342000
FETUC0   DS    0H                                                       00343000
         USING FETUC0,12               ESTABLISH BASE REGISTER          00344000
         B     *+6                     BRANCH AROUND ADCON              00345000
BASFET0  DC    AL2(4096)                                                00346000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00347000
         AH    3,BASFET0               ADD 4K                           00348000
         EXEC  SQL FETCH S07UPD0                                       *00349000
                 INTO                                                  *00350000
                   :AUDDATE,                                           *00351000
                   :AUDTIME,                                           *00352000
                   :AUDUSER,                                           *00353000
                   :AUDORG,                                            *00354000
                   :INCLEXCL,                                          *00355000
                   :BRREGN01,                                          *00356000
                   :BRREGN02,                                          *00357000
                   :BRREGN03,                                          *00358000
                   :BRREGN04,                                          *00359000
                   :BRREGN05,                                          *00360000
                   :BRREGN06,                                          *00361000
                   :BRREGN07,                                          *00362000
                   :BRREGN08,                                          *00363000
                   :BRREGN09,                                          *00364000
                   :BRREGN10,                                          *00365000
                   :BRREGN11,                                          *00366000
                   :BRREGN12,                                          *00367000
                   :BRREGN13,                                          *00368000
                   :BRREGN14,                                          *00369000
                   :BRREGN15,                                          *00370000
                   :BRREGN16,                                          *00371000
                   :BRREGN17,                                          *00372000
                   :BRREGN18,                                          *00373000
                   :BRREGN19,                                          *00374000
                   :BRREGN20,                                          *00375000
                   :BRREGN21,                                          *00376000
                   :BRREGN22,                                          *00377000
                   :BRREGN23,                                          *00378000
                   :BRREGN24,                                          *00379000
                   :BRREGN25,                                          *00380000
                   :BRREGN26,                                          *00381000
                   :BRREGN27,                                          *00382000
                   :BRREGN28,                                          *00383000
                   :BRREGN29,                                          *00384000
                   :BRREGN30,                                          *00385000
                   :BRREGN31,                                          *00386000
                   :BRREGN32,                                          *00387000
                   :BRREGN33,                                          *00388000
                   :BRREGN34,                                          *00389000
                   :BRREGN35,                                          *00390000
                   :BRREGN36,                                          *00391000
                   :BRREGN37,                                          *00392000
                   :BRREGN38,                                          *00393000
                   :BRREGN39,                                          *00394000
                   :BRREGN40,                                          *00395000
                   :BRREGN41,                                          *00396000
                   :BRREGN42,                                          *00397000
                   :BRREGN43,                                          *00398000
                   :BRREGN44,                                          *00399000
                   :BRREGN45,                                          *00400000
                   :BRREGN46,                                          *00401000
                   :BRREGN47,                                          *00402000
                   :BRREGN48,                                          *00403000
                   :BRREGN49,                                          *00404000
                   :BRREGN50,                                          *00405000
                   :TABLETYP                                            00406000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00407000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00408000
         BALR  14,15                   MOVE REQUESTED DATA              00409000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00410000
         BR    14                      RETURN TO CALLER                 00411000
         LTORG                                                          00412000
*                                                                       00413000
**********************************************************************  00414000
* INSERT STATEMENT:                                                     00415000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               00416000
**********************************************************************  00417000
*                                                                       00418000
INSROW   DS    0H                                                       00419000
         USING INSROW,12               ESTABLISH BASE REGISTER          00420000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00421000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00422000
         BALR  14,15                   MOVE REQUESTED DATA              00423000
         B     *+6                     BRANCH AROUND ADCON              00424000
BASINS0  DC    AL2(4096)                                                00425000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00426000
         AH    3,BASINS0               ADD 4K                           00427000
         EXEC  SQL INSERT INTO S07                                     *00428000
                   (                                                   *00429000
                   INST_NBR,                                           *00430000
                   RECORD_NBR,                                         *00431000
                   BRCH_REGN_CODE,                                     *00432000
                   AUDIT_DATE,                                         *00433000
                   AUDIT_TIME,                                         *00434000
                   AUDIT_USER,                                         *00435000
                   AUDIT_ORG,                                          *00436000
                   INCL_EXCL_OPT,                                      *00437000
                   BRCH_REGION_01,                                     *00438000
                   BRCH_REGION_02,                                     *00439000
                   BRCH_REGION_03,                                     *00440000
                   BRCH_REGION_04,                                     *00441000
                   BRCH_REGION_05,                                     *00442000
                   BRCH_REGION_06,                                     *00443000
                   BRCH_REGION_07,                                     *00444000
                   BRCH_REGION_08,                                     *00445000
                   BRCH_REGION_09,                                     *00446000
                   BRCH_REGION_10,                                     *00447000
                   BRCH_REGION_11,                                     *00448000
                   BRCH_REGION_12,                                     *00449000
                   BRCH_REGION_13,                                     *00450000
                   BRCH_REGION_14,                                     *00451000
                   BRCH_REGION_15,                                     *00452000
                   BRCH_REGION_16,                                     *00453000
                   BRCH_REGION_17,                                     *00454000
                   BRCH_REGION_18,                                     *00455000
                   BRCH_REGION_19,                                     *00456000
                   BRCH_REGION_20,                                     *00457000
                   BRCH_REGION_21,                                     *00458000
                   BRCH_REGION_22,                                     *00459000
                   BRCH_REGION_23,                                     *00460000
                   BRCH_REGION_24,                                     *00461000
                   BRCH_REGION_25,                                     *00462000
                   BRCH_REGION_26,                                     *00463000
                   BRCH_REGION_27,                                     *00464000
                   BRCH_REGION_28,                                     *00465000
                   BRCH_REGION_29,                                     *00466000
                   BRCH_REGION_30,                                     *00467000
                   BRCH_REGION_31,                                     *00468000
                   BRCH_REGION_32,                                     *00469000
                   BRCH_REGION_33,                                     *00470000
                   BRCH_REGION_34,                                     *00471000
                   BRCH_REGION_35,                                     *00472000
                   BRCH_REGION_36,                                     *00473000
                   BRCH_REGION_37,                                     *00474000
                   BRCH_REGION_38,                                     *00475000
                   BRCH_REGION_39,                                     *00476000
                   BRCH_REGION_40,                                     *00477000
                   BRCH_REGION_41,                                     *00478000
                   BRCH_REGION_42,                                     *00479000
                   BRCH_REGION_43,                                     *00480000
                   BRCH_REGION_44,                                     *00481000
                   BRCH_REGION_45,                                     *00482000
                   BRCH_REGION_46,                                     *00483000
                   BRCH_REGION_47,                                     *00484000
                   BRCH_REGION_48,                                     *00485000
                   BRCH_REGION_49,                                     *00486000
                   BRCH_REGION_50,                                     *00487000
                   TABLE_TYPE                                          *00488000
                   )                                                   *00489000
                  VALUES                                               *00490000
                   (                                                   *00491000
                   :INST,                                              *00492000
                   :RECNBR,                                            *00493000
                   :BRREGNCD,                                          *00494000
                   :AUDDATE,                                           *00495000
                   :AUDTIME,                                           *00496000
                   :AUDUSER,                                           *00497000
                   :AUDORG,                                            *00498000
                   :INCLEXCL,                                          *00499000
                   :BRREGN01,                                          *00500000
                   :BRREGN02,                                          *00501000
                   :BRREGN03,                                          *00502000
                   :BRREGN04,                                          *00503000
                   :BRREGN05,                                          *00504000
                   :BRREGN06,                                          *00505000
                   :BRREGN07,                                          *00506000
                   :BRREGN08,                                          *00507000
                   :BRREGN09,                                          *00508000
                   :BRREGN10,                                          *00509000
                   :BRREGN11,                                          *00510000
                   :BRREGN12,                                          *00511000
                   :BRREGN13,                                          *00512000
                   :BRREGN14,                                          *00513000
                   :BRREGN15,                                          *00514000
                   :BRREGN16,                                          *00515000
                   :BRREGN17,                                          *00516000
                   :BRREGN18,                                          *00517000
                   :BRREGN19,                                          *00518000
                   :BRREGN20,                                          *00519000
                   :BRREGN21,                                          *00520000
                   :BRREGN22,                                          *00521000
                   :BRREGN23,                                          *00522000
                   :BRREGN24,                                          *00523000
                   :BRREGN25,                                          *00524000
                   :BRREGN26,                                          *00525000
                   :BRREGN27,                                          *00526000
                   :BRREGN28,                                          *00527000
                   :BRREGN29,                                          *00528000
                   :BRREGN30,                                          *00529000
                   :BRREGN31,                                          *00530000
                   :BRREGN32,                                          *00531000
                   :BRREGN33,                                          *00532000
                   :BRREGN34,                                          *00533000
                   :BRREGN35,                                          *00534000
                   :BRREGN36,                                          *00535000
                   :BRREGN37,                                          *00536000
                   :BRREGN38,                                          *00537000
                   :BRREGN39,                                          *00538000
                   :BRREGN40,                                          *00539000
                   :BRREGN41,                                          *00540000
                   :BRREGN42,                                          *00541000
                   :BRREGN43,                                          *00542000
                   :BRREGN44,                                          *00543000
                   :BRREGN45,                                          *00544000
                   :BRREGN46,                                          *00545000
                   :BRREGN47,                                          *00546000
                   :BRREGN48,                                          *00547000
                   :BRREGN49,                                          *00548000
                   :BRREGN50,                                          *00549000
                   :TABLETYP                                           *00550000
                   )                                                    00551000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00552000
         BR    14                      RETURN TO CALLER                 00553000
         LTORG                                                          00554000
*                                                                       00555000
**********************************************************************  00556000
* UPDATE STATEMENT BY PRIMARY KEY:                                      00557000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             00558000
**********************************************************************  00559000
*                                                                       00560000
UPDUC0   DS    0H                                                       00561000
         USING UPDUC0,12               ESTABLISH BASE REGISTER          00562000
         MVI   SQWKMRP,X'01'           MOVE RECORD TO HOST VARIABLES    00563000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00564000
         BALR  14,15                   MOVE REQUESTED DATA              00565000
         B     *+6                     BRANCH AROUND ADCON              00566000
BASUPD0  DC    AL2(4096)                                                00567000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00568000
         AH    3,BASUPD0               ADD 4K                           00569000
         EXEC  SQL UPDATE S07                                          *00570000
                   SET                                                 *00571000
                     AUDIT_DATE = :AUDDATE,                            *00572000
                     AUDIT_TIME = :AUDTIME,                            *00573000
                     AUDIT_USER = :AUDUSER,                            *00574000
                     AUDIT_ORG = :AUDORG,                              *00575000
                     INCL_EXCL_OPT = :INCLEXCL,                        *00576000
                     BRCH_REGION_01 = :BRREGN01,                       *00577000
                     BRCH_REGION_02 = :BRREGN02,                       *00578000
                     BRCH_REGION_03 = :BRREGN03,                       *00579000
                     BRCH_REGION_04 = :BRREGN04,                       *00580000
                     BRCH_REGION_05 = :BRREGN05,                       *00581000
                     BRCH_REGION_06 = :BRREGN06,                       *00582000
                     BRCH_REGION_07 = :BRREGN07,                       *00583000
                     BRCH_REGION_08 = :BRREGN08,                       *00584000
                     BRCH_REGION_09 = :BRREGN09,                       *00585000
                     BRCH_REGION_10 = :BRREGN10,                       *00586000
                     BRCH_REGION_11 = :BRREGN11,                       *00587000
                     BRCH_REGION_12 = :BRREGN12,                       *00588000
                     BRCH_REGION_13 = :BRREGN13,                       *00589000
                     BRCH_REGION_14 = :BRREGN14,                       *00590000
                     BRCH_REGION_15 = :BRREGN15,                       *00591000
                     BRCH_REGION_16 = :BRREGN16,                       *00592000
                     BRCH_REGION_17 = :BRREGN17,                       *00593000
                     BRCH_REGION_18 = :BRREGN18,                       *00594000
                     BRCH_REGION_19 = :BRREGN19,                       *00595000
                     BRCH_REGION_20 = :BRREGN20,                       *00596000
                     BRCH_REGION_21 = :BRREGN21,                       *00597000
                     BRCH_REGION_22 = :BRREGN22,                       *00598000
                     BRCH_REGION_23 = :BRREGN23,                       *00599000
                     BRCH_REGION_24 = :BRREGN24,                       *00600000
                     BRCH_REGION_25 = :BRREGN25,                       *00601000
                     BRCH_REGION_26 = :BRREGN26,                       *00602000
                     BRCH_REGION_27 = :BRREGN27,                       *00603000
                     BRCH_REGION_28 = :BRREGN28,                       *00604000
                     BRCH_REGION_29 = :BRREGN29,                       *00605000
                     BRCH_REGION_30 = :BRREGN30,                       *00606000
                     BRCH_REGION_31 = :BRREGN31,                       *00607000
                     BRCH_REGION_32 = :BRREGN32,                       *00608000
                     BRCH_REGION_33 = :BRREGN33,                       *00609000
                     BRCH_REGION_34 = :BRREGN34,                       *00610000
                     BRCH_REGION_35 = :BRREGN35,                       *00611000
                     BRCH_REGION_36 = :BRREGN36,                       *00612000
                     BRCH_REGION_37 = :BRREGN37,                       *00613000
                     BRCH_REGION_38 = :BRREGN38,                       *00614000
                     BRCH_REGION_39 = :BRREGN39,                       *00615000
                     BRCH_REGION_40 = :BRREGN40,                       *00616000
                     BRCH_REGION_41 = :BRREGN41,                       *00617000
                     BRCH_REGION_42 = :BRREGN42,                       *00618000
                     BRCH_REGION_43 = :BRREGN43,                       *00619000
                     BRCH_REGION_44 = :BRREGN44,                       *00620000
                     BRCH_REGION_45 = :BRREGN45,                       *00621000
                     BRCH_REGION_46 = :BRREGN46,                       *00622000
                     BRCH_REGION_47 = :BRREGN47,                       *00623000
                     BRCH_REGION_48 = :BRREGN48,                       *00624000
                     BRCH_REGION_49 = :BRREGN49,                       *00625000
                     BRCH_REGION_50 = :BRREGN50,                       *00626000
                     TABLE_TYPE = :TABLETYP                            *00627000
                 WHERE CURRENT OF S07UPD0                               00628000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00629000
         BR    14                      RETURN TO CALLER                 00630000
         LTORG                                                          00631000
*                                                                       00632000
**********************************************************************  00633000
* DELETE STATEMENT BY PRIMARY KEY:                                      00634000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            00635000
**********************************************************************  00636000
*                                                                       00637000
DELUC0   DS    0H                                                       00638000
         USING DELUC0,12               ESTABLISH BASE REGISTER          00639000
         EXEC  SQL DELETE FROM S07                                     *00640000
                 WHERE CURRENT OF S07UPD0                               00641000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00642000
         BR    14                      RETURN TO CALLER                 00643000
         LTORG                                                          00644000
*                                                                       00645000
**********************************************************************  00646000
* DELETE ALL STATEMENT:                                                 00647000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       00648000
**********************************************************************  00649000
*                                                                       00650000
DELTBL   DS    0H                                                       00651000
         USING DELTBL,12               ESTABLISH BASE REGISTER          00652000
         EXEC  SQL DELETE FROM S07                                      00653000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00654000
         BR    14                      RETURN TO CALLER                 00655000
         LTORG                                                          00656000
*                                                                       00657000
**********************************************************************  00658000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00659000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00660000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00661000
*     TO CLOSE THE UPDATE CURSOR.                                       00662000
**********************************************************************  00663000
*                                                                       00664000
CLSUC0   DS    0H                                                       00665000
         USING CLSUC0,12               ESTABLISH BASE REGISTER          00666000
         EXEC  SQL CLOSE S07UPD0                                        00667000
         XC    SQWCSUCA,SQWCSUCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00668000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00669000
         BR    14                      RETURN TO CALLER                 00670000
         LTORG                                                          00671000
*                                                                       00672000
**********************************************************************  00673000
* ALTERNATE KEY 1 NOT DEFINED                                           00674000
**********************************************************************  00675000
*                                                                       00676000
SELUC1   DS    0H                                                       00677000
FETUC1   DS    0H                                                       00678000
UPDUC1   DS    0H                                                       00679000
DELUC1   DS    0H                                                       00680000
CLSUC1   DS    0H                                                       00681000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 00682000
*                                                                       00683000
**********************************************************************  00684000
* ALTERNATE KEY 2 NOT DEFINED                                           00685000
**********************************************************************  00686000
*                                                                       00687000
SELUC2   DS    0H                                                       00688000
FETUC2   DS    0H                                                       00689000
UPDUC2   DS    0H                                                       00690000
DELUC2   DS    0H                                                       00691000
CLSUC2   DS    0H                                                       00692000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 00693000
*                                                                       00694000
**********************************************************************  00695000
* ALTERNATE KEY 3 NOT DEFINED                                           00696000
**********************************************************************  00697000
*                                                                       00698000
SELUC3   DS    0H                                                       00699000
FETUC3   DS    0H                                                       00700000
UPDUC3   DS    0H                                                       00701000
DELUC3   DS    0H                                                       00702000
CLSUC3   DS    0H                                                       00703000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 00704000
*                                                                       00705000
         DS    0H                      END OF SQL STATEMENTS            00706000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   00707000
*                                                                       00708000
**********************************************************************  00709000
* DUMMY ENTRY POINT DSNHLI                                              00710000
**********************************************************************  00711000
*                                                                       00712000
         ENTRY DSNHLI                                                   00713000
DSNHLI   DS    0H                                                       00714000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       00715000
         BR    15                      BRANCH TO ATTACH FACILITY        00716000
*                                                                       00717000
**********************************************************************  00718000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  00719000
**********************************************************************  00720000
*                                                                       00721000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       00722000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      00723000
* OR:                                                                   00724000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      00725000
* WHERE:                                                                00726000
*   RRRR = RECORD AREA OFFSET                                           00727000
*   VVVV = HOST VARIABLE AREA OFFSET                                    00728000
*   LLLL = HALFWORD LENGTH TO MOVE                                      00729000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       00730000
*   KK   = KEY FIELD MASK:                                              00731000
*            80 = KEY 0 FIELD                                           00732000
*            40 = KEY 1 FIELD                                           00733000
*            20 = KEY 2 FIELD                                           00734000
*            10 = KEY 3 FIELD                                           00735000
*   DD   = DATA FIELD MASK:                                             00736000
*            80 = RECORD FIELD IS PACKED                                00737000
*            40 = HOST VARIABLE IS PACKED                               00738000
*            20 = NULLABLE FIELD                                        00739000
*            01 = DATE FIELD                                            00740000
*            02 = TIME FIELD                                            00741000
*                                                                       00742000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 00743000
         DC    H'0000',H'0000',H'0014',X'80',X'00'                      00744000
         DC    H'0014',H'0014',H'0176',X'00',X'00'                      00745000
         DC    8X'FF'                                                   00746000
*                                                                       00747000
         LTORG                                                          00748000
         END                                                            00749000
