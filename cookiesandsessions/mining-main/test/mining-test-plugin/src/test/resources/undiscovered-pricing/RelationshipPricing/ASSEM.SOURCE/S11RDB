**********************************************************************  00001000
*                                                                       00002000
*  S11RDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S11 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
TRANPROF DS    CL6                                                      00052000
TRANPLAN DS    CL3                                                      00053000
TRANEXTL DS    CL4                                                      00054000
INTLTCD  DS    CL4                                                      00055000
AUDDATE  DS    PL5'0.'                                                  00056000
AUDTIME  DS    PL5'0.'                                                  00057000
AUDUSER  DS    CL8                                                      00058000
AUDORG   DS    CL6                                                      00059000
TRANDESC DS    CL30                                                     00060000
TRANSIGN DS    CL1                                                      00061000
ACCOPT01 DS    CL1                                                      00062000
MINAMT01 DS    PL5'0.'                                                  00063000
ACCOPT02 DS    CL1                                                      00064000
MINAMT02 DS    PL5'0.'                                                  00065000
ACCOPT03 DS    CL1                                                      00066000
MINAMT03 DS    PL5'0.'                                                  00067000
ACCOPT04 DS    CL1                                                      00068000
MINAMT04 DS    PL5'0.'                                                  00069000
ACCOPT05 DS    CL1                                                      00070000
MINAMT05 DS    PL5'0.'                                                  00071000
ACCOPT06 DS    CL1                                                      00072000
MINAMT06 DS    PL5'0.'                                                  00073000
ACCOPT07 DS    CL1                                                      00074000
MINAMT07 DS    PL5'0.'                                                  00075000
ACCOPT08 DS    CL1                                                      00076000
MINAMT08 DS    PL5'0.'                                                  00077000
ACCOPT09 DS    CL1                                                      00078000
MINAMT09 DS    PL5'0.'                                                  00079000
ACCOPT10 DS    CL1                                                      00080000
MINAMT10 DS    PL5'0.'                                                  00081000
ACCOPT11 DS    CL1                                                      00082000
MINAMT11 DS    PL5'0.'                                                  00083000
ACCOPT12 DS    CL1                                                      00084000
MINAMT12 DS    PL5'0.'                                                  00085000
*                                                                       00086000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00087000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00088000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00089000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00090000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00091000
         DS    CL97                    RESERVED                         00092000
*                                                                       00093000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00094000
INDVARX  DS    0H                                                       00095000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00096000
*                                                                       00097000
*                                                                       00098000
**********************************************************************  00099000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00100000
**********************************************************************  00101000
*                                                                       00102000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00103000
*                                                                       00104000
**********************************************************************  00105000
* PROGRAM TABLE HEADER SECTION:                                         00106000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00107000
**********************************************************************  00108000
*                                                                       00109000
S11RDB   CSECT                         PROGRAM TABLE SECTION            00110000
S11RDB   AMODE ANY                                                      00111000
S11RDB   RMODE ANY                                                      00112000
         DC    CL8'S11RDB  '           PROGRAM ID                       00113000
         DC    CL1' '                                                   00114000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00115000
         DC    CL1' '                                                   00116000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00117000
         DC    CL1' '                                                   00118000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00119000
         DC    5A(0)                   RESERVED                         00120000
         DC    AL2(0)                  RESERVED                         00121000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00122000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00123000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00124000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00125000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00126000
         DC    CL29'WWW.INFOR.COM                '                      00126001
*                                                                       00127000
**********************************************************************  00128000
* STATEMENT TABLE SECTION:                                              00129000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00130000
**********************************************************************  00131000
*                                                                       00132000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00133000
STM#TAB  AMODE ANY                                                      00134000
STM#TAB  RMODE ANY                                                      00135000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00136000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00137000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00138000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00139000
         DC    12A(0)                  UDB MODULE VECTORS               00140000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00141000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00142000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00143000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00144000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00145000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00146000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00147000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00148000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00149000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00150000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00151000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00152000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00153000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00154000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00155000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00156000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00157000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00158000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00159000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00160000
         DC    10A(0)                  UDB MODULE VECTORS               00161000
         DC    4X'FF'                                                   00162000
*                                                                       00163000
**********************************************************************  00164000
* SQL STATEMENT SECTION:                                                00165000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00166000
*     TO SUPPORT THIS TABLE.                                            00167000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00168000
*     ARE EQUIVALENT.                                                   00169000
**********************************************************************  00170000
*                                                                       00171000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00172000
SQL#STMT AMODE ANY                                                      00173000
SQL#STMT RMODE ANY                                                      00174000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00175000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00176000
         USING COM#AREA,11             ADDRESS COMMAREA                 00177000
*                                                                       00178000
**********************************************************************  00179000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00180000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00181000
**********************************************************************  00182000
*                                                                       00183000
SELIN0   DS    0H                                                       00184000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00185000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00186000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00187000
         BALR  14,15                   MOVE REQUESTED DATA              00188000
         EXEC  SQL SELECT                                              *00189000
                   AUDIT_DATE,                                         *00190000
                   AUDIT_TIME,                                         *00191000
                   AUDIT_USER,                                         *00192000
                   AUDIT_ORG,                                          *00193000
                   TRAN_DESC,                                          *00194000
                   TRAN_SIGN,                                          *00195000
                   ACCUM_OPTION_01,                                    *00196000
                   MIN_AMOUNT_01,                                      *00197000
                   ACCUM_OPTION_02,                                    *00198000
                   MIN_AMOUNT_02,                                      *00199000
                   ACCUM_OPTION_03,                                    *00200000
                   MIN_AMOUNT_03,                                      *00201000
                   ACCUM_OPTION_04,                                    *00202000
                   MIN_AMOUNT_04,                                      *00203000
                   ACCUM_OPTION_05,                                    *00204000
                   MIN_AMOUNT_05,                                      *00205000
                   ACCUM_OPTION_06,                                    *00206000
                   MIN_AMOUNT_06,                                      *00207000
                   ACCUM_OPTION_07,                                    *00208000
                   MIN_AMOUNT_07,                                      *00209000
                   ACCUM_OPTION_08,                                    *00210000
                   MIN_AMOUNT_08,                                      *00211000
                   ACCUM_OPTION_09,                                    *00212000
                   MIN_AMOUNT_09,                                      *00213000
                   ACCUM_OPTION_10,                                    *00214000
                   MIN_AMOUNT_10,                                      *00215000
                   ACCUM_OPTION_11,                                    *00216000
                   MIN_AMOUNT_11,                                      *00217000
                   ACCUM_OPTION_12,                                    *00218000
                   MIN_AMOUNT_12                                       *00219000
                 INTO                                                  *00220000
                   :AUDDATE,                                           *00221000
                   :AUDTIME,                                           *00222000
                   :AUDUSER,                                           *00223000
                   :AUDORG,                                            *00224000
                   :TRANDESC,                                          *00225000
                   :TRANSIGN,                                          *00226000
                   :ACCOPT01,                                          *00227000
                   :MINAMT01,                                          *00228000
                   :ACCOPT02,                                          *00229000
                   :MINAMT02,                                          *00230000
                   :ACCOPT03,                                          *00231000
                   :MINAMT03,                                          *00232000
                   :ACCOPT04,                                          *00233000
                   :MINAMT04,                                          *00234000
                   :ACCOPT05,                                          *00235000
                   :MINAMT05,                                          *00236000
                   :ACCOPT06,                                          *00237000
                   :MINAMT06,                                          *00238000
                   :ACCOPT07,                                          *00239000
                   :MINAMT07,                                          *00240000
                   :ACCOPT08,                                          *00241000
                   :MINAMT08,                                          *00242000
                   :ACCOPT09,                                          *00243000
                   :MINAMT09,                                          *00244000
                   :ACCOPT10,                                          *00245000
                   :MINAMT10,                                          *00246000
                   :ACCOPT11,                                          *00247000
                   :MINAMT11,                                          *00248000
                   :ACCOPT12,                                          *00249000
                   :MINAMT12                                           *00250000
                 FROM S11                                              *00251000
                 WHERE                                                 *00252000
                   INST_NBR = :INST AND                                *00253000
                   RECORD_NBR = :RECNBR AND                            *00254000
                   TRAN_PROFILE = :TRANPROF AND                        *00255000
                   TRAN_PLAN = :TRANPLAN AND                           *00256000
                   EXTL_TRAN_CODE = :TRANEXTL AND                      *00257000
                   INTL_TRAN_CODE = :INTLTCD                           *00258000
                 FETCH FIRST 1 ROW ONLY                                 00259000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00260000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00261000
         BALR  14,15                   MOVE REQUESTED DATA              00262000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00263000
         BR    14                      RETURN TO CALLER                 00264000
         LTORG                                                          00265000
*                                                                       00266000
**********************************************************************  00267000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00268000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00269000
**********************************************************************  00270000
*                                                                       00271000
SELKY0   DS    0H                                                       00272000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00273000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00274000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00275000
         BALR  14,15                   MOVE REQUESTED DATA              00276000
         EXEC  SQL SELECT                                              *00277000
                   COUNT(*)                                            *00278000
                 INTO                                                  *00279000
                   :SQWINTHV                                           *00280000
                 FROM S11                                              *00281000
                 WHERE                                                 *00282000
                   INST_NBR = :INST AND                                *00283000
                   RECORD_NBR = :RECNBR AND                            *00284000
                   TRAN_PROFILE = :TRANPROF AND                        *00285000
                   TRAN_PLAN = :TRANPLAN AND                           *00286000
                   EXTL_TRAN_CODE = :TRANEXTL AND                      *00287000
                   INTL_TRAN_CODE = :INTLTCD                           *00288000
                 FETCH FIRST 1 ROW ONLY                                 00289000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00290000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00291000
         BNER  14                      NO - RETURN TO CALLER            00292000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00293000
         BNER  14                      YES - RETURN ZERO SQLCODE        00294000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00295000
         BR    14                      RETURN TO CALLER                 00296000
         LTORG                                                          00297000
*                                                                       00298000
**********************************************************************  00299000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00300000
* KEY:                                                                  00301000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00302000
*     AND GET-NEXT-LOCK VERBS.                                          00303000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00304000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00305000
**********************************************************************  00306000
*                                                                       00307000
SELXC0   DS    0H                                                       00308000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00309000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00310000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00311000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00312000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00313000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00314000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00315000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00316000
SELXC0P  DC    A(SELGE001)                                              00317000
         DC    (KY0COLMS-01)A(0)                                        00318000
         DC    A(SELGE002)                                              00319000
         DC    (KY0COLMS-02)A(0)                                        00320000
         DC    A(SELGE003)                                              00321000
         DC    (KY0COLMS-03)A(0)                                        00322000
         DC    A(SELGE004)                                              00323000
         DC    (KY0COLMS-04)A(0)                                        00324000
         DC    A(SELGE005)                                              00325000
         DC    (KY0COLMS-05)A(0)                                        00326000
         DC    A(SELGE006)                                              00327000
         LTORG                                                          00328000
*                                                                       00329000
SELGE001 DS    0H                                                       00330000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00331000
         EXEC  SQL DECLARE S11GE001 CURSOR                             *00332000
               WITH ROWSET POSITIONING                                 *00333000
               FOR SELECT                                              *00334000
                   INST_NBR,                                           *00335000
                   RECORD_NBR,                                         *00336000
                   TRAN_PROFILE,                                       *00337000
                   TRAN_PLAN,                                          *00338000
                   EXTL_TRAN_CODE,                                     *00339000
                   INTL_TRAN_CODE,                                     *00340000
                   AUDIT_DATE,                                         *00341000
                   AUDIT_TIME,                                         *00342000
                   AUDIT_USER,                                         *00343000
                   AUDIT_ORG,                                          *00344000
                   TRAN_DESC,                                          *00345000
                   TRAN_SIGN,                                          *00346000
                   ACCUM_OPTION_01,                                    *00347000
                   MIN_AMOUNT_01,                                      *00348000
                   ACCUM_OPTION_02,                                    *00349000
                   MIN_AMOUNT_02,                                      *00350000
                   ACCUM_OPTION_03,                                    *00351000
                   MIN_AMOUNT_03,                                      *00352000
                   ACCUM_OPTION_04,                                    *00353000
                   MIN_AMOUNT_04,                                      *00354000
                   ACCUM_OPTION_05,                                    *00355000
                   MIN_AMOUNT_05,                                      *00356000
                   ACCUM_OPTION_06,                                    *00357000
                   MIN_AMOUNT_06,                                      *00358000
                   ACCUM_OPTION_07,                                    *00359000
                   MIN_AMOUNT_07,                                      *00360000
                   ACCUM_OPTION_08,                                    *00361000
                   MIN_AMOUNT_08,                                      *00362000
                   ACCUM_OPTION_09,                                    *00363000
                   MIN_AMOUNT_09,                                      *00364000
                   ACCUM_OPTION_10,                                    *00365000
                   MIN_AMOUNT_10,                                      *00366000
                   ACCUM_OPTION_11,                                    *00367000
                   MIN_AMOUNT_11,                                      *00368000
                   ACCUM_OPTION_12,                                    *00369000
                   MIN_AMOUNT_12                                       *00370000
                 FROM S11                                              *00371000
                 WHERE                                                 *00372000
                   INST_NBR = :INST AND                                *00373000
                   RECORD_NBR = :RECNBR AND                            *00374000
                   TRAN_PROFILE = :TRANPROF AND                        *00375000
                   TRAN_PLAN = :TRANPLAN AND                           *00376000
                   EXTL_TRAN_CODE = :TRANEXTL AND                      *00377000
                   INTL_TRAN_CODE >=                                   *00378000
                     :INTLTCD                                          *00379000
                 ORDER BY INTL_TRAN_CODE ASC                           *00380000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00381000
         EXEC  SQL OPEN S11GE001                                        00382000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00383000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00384000
         BR    14                      RETURN TO CALLER                 00385000
         LTORG                                                          00386000
*                                                                       00387000
SELGE002 DS    0H                                                       00388000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00389000
         EXEC  SQL DECLARE S11GE002 CURSOR                             *00390000
               WITH ROWSET POSITIONING                                 *00391000
               FOR SELECT                                              *00392000
                   INST_NBR,                                           *00393000
                   RECORD_NBR,                                         *00394000
                   TRAN_PROFILE,                                       *00395000
                   TRAN_PLAN,                                          *00396000
                   EXTL_TRAN_CODE,                                     *00397000
                   INTL_TRAN_CODE,                                     *00398000
                   AUDIT_DATE,                                         *00399000
                   AUDIT_TIME,                                         *00400000
                   AUDIT_USER,                                         *00401000
                   AUDIT_ORG,                                          *00402000
                   TRAN_DESC,                                          *00403000
                   TRAN_SIGN,                                          *00404000
                   ACCUM_OPTION_01,                                    *00405000
                   MIN_AMOUNT_01,                                      *00406000
                   ACCUM_OPTION_02,                                    *00407000
                   MIN_AMOUNT_02,                                      *00408000
                   ACCUM_OPTION_03,                                    *00409000
                   MIN_AMOUNT_03,                                      *00410000
                   ACCUM_OPTION_04,                                    *00411000
                   MIN_AMOUNT_04,                                      *00412000
                   ACCUM_OPTION_05,                                    *00413000
                   MIN_AMOUNT_05,                                      *00414000
                   ACCUM_OPTION_06,                                    *00415000
                   MIN_AMOUNT_06,                                      *00416000
                   ACCUM_OPTION_07,                                    *00417000
                   MIN_AMOUNT_07,                                      *00418000
                   ACCUM_OPTION_08,                                    *00419000
                   MIN_AMOUNT_08,                                      *00420000
                   ACCUM_OPTION_09,                                    *00421000
                   MIN_AMOUNT_09,                                      *00422000
                   ACCUM_OPTION_10,                                    *00423000
                   MIN_AMOUNT_10,                                      *00424000
                   ACCUM_OPTION_11,                                    *00425000
                   MIN_AMOUNT_11,                                      *00426000
                   ACCUM_OPTION_12,                                    *00427000
                   MIN_AMOUNT_12                                       *00428000
                 FROM S11                                              *00429000
                 WHERE                                                 *00430000
                   INST_NBR = :INST AND                                *00431000
                   RECORD_NBR = :RECNBR AND                            *00432000
                   TRAN_PROFILE = :TRANPROF AND                        *00433000
                   TRAN_PLAN = :TRANPLAN AND                           *00434000
                   EXTL_TRAN_CODE >=                                   *00435000
                     :TRANEXTL                                         *00436000
                 ORDER BY EXTL_TRAN_CODE ASC,                          *00437000
                   INTL_TRAN_CODE ASC                                  *00438000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00439000
         EXEC  SQL OPEN S11GE002                                        00440000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00441000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00442000
         BR    14                      RETURN TO CALLER                 00443000
         LTORG                                                          00444000
*                                                                       00445000
SELGE003 DS    0H                                                       00446000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00447000
         EXEC  SQL DECLARE S11GE003 CURSOR                             *00448000
               WITH ROWSET POSITIONING                                 *00449000
               FOR SELECT                                              *00450000
                   INST_NBR,                                           *00451000
                   RECORD_NBR,                                         *00452000
                   TRAN_PROFILE,                                       *00453000
                   TRAN_PLAN,                                          *00454000
                   EXTL_TRAN_CODE,                                     *00455000
                   INTL_TRAN_CODE,                                     *00456000
                   AUDIT_DATE,                                         *00457000
                   AUDIT_TIME,                                         *00458000
                   AUDIT_USER,                                         *00459000
                   AUDIT_ORG,                                          *00460000
                   TRAN_DESC,                                          *00461000
                   TRAN_SIGN,                                          *00462000
                   ACCUM_OPTION_01,                                    *00463000
                   MIN_AMOUNT_01,                                      *00464000
                   ACCUM_OPTION_02,                                    *00465000
                   MIN_AMOUNT_02,                                      *00466000
                   ACCUM_OPTION_03,                                    *00467000
                   MIN_AMOUNT_03,                                      *00468000
                   ACCUM_OPTION_04,                                    *00469000
                   MIN_AMOUNT_04,                                      *00470000
                   ACCUM_OPTION_05,                                    *00471000
                   MIN_AMOUNT_05,                                      *00472000
                   ACCUM_OPTION_06,                                    *00473000
                   MIN_AMOUNT_06,                                      *00474000
                   ACCUM_OPTION_07,                                    *00475000
                   MIN_AMOUNT_07,                                      *00476000
                   ACCUM_OPTION_08,                                    *00477000
                   MIN_AMOUNT_08,                                      *00478000
                   ACCUM_OPTION_09,                                    *00479000
                   MIN_AMOUNT_09,                                      *00480000
                   ACCUM_OPTION_10,                                    *00481000
                   MIN_AMOUNT_10,                                      *00482000
                   ACCUM_OPTION_11,                                    *00483000
                   MIN_AMOUNT_11,                                      *00484000
                   ACCUM_OPTION_12,                                    *00485000
                   MIN_AMOUNT_12                                       *00486000
                 FROM S11                                              *00487000
                 WHERE                                                 *00488000
                   INST_NBR = :INST AND                                *00489000
                   RECORD_NBR = :RECNBR AND                            *00490000
                   TRAN_PROFILE = :TRANPROF AND                        *00491000
                   TRAN_PLAN >=                                        *00492000
                     :TRANPLAN                                         *00493000
                 ORDER BY TRAN_PLAN ASC,                               *00494000
                   EXTL_TRAN_CODE ASC,                                 *00495000
                   INTL_TRAN_CODE ASC                                  *00496000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00497000
         EXEC  SQL OPEN S11GE003                                        00498000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00499000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00500000
         BR    14                      RETURN TO CALLER                 00501000
         LTORG                                                          00502000
*                                                                       00503000
SELGE004 DS    0H                                                       00504000
         USING SELGE004,12             ESTABLISH BASE REGISTER          00505000
         EXEC  SQL DECLARE S11GE004 CURSOR                             *00506000
               WITH ROWSET POSITIONING                                 *00507000
               FOR SELECT                                              *00508000
                   INST_NBR,                                           *00509000
                   RECORD_NBR,                                         *00510000
                   TRAN_PROFILE,                                       *00511000
                   TRAN_PLAN,                                          *00512000
                   EXTL_TRAN_CODE,                                     *00513000
                   INTL_TRAN_CODE,                                     *00514000
                   AUDIT_DATE,                                         *00515000
                   AUDIT_TIME,                                         *00516000
                   AUDIT_USER,                                         *00517000
                   AUDIT_ORG,                                          *00518000
                   TRAN_DESC,                                          *00519000
                   TRAN_SIGN,                                          *00520000
                   ACCUM_OPTION_01,                                    *00521000
                   MIN_AMOUNT_01,                                      *00522000
                   ACCUM_OPTION_02,                                    *00523000
                   MIN_AMOUNT_02,                                      *00524000
                   ACCUM_OPTION_03,                                    *00525000
                   MIN_AMOUNT_03,                                      *00526000
                   ACCUM_OPTION_04,                                    *00527000
                   MIN_AMOUNT_04,                                      *00528000
                   ACCUM_OPTION_05,                                    *00529000
                   MIN_AMOUNT_05,                                      *00530000
                   ACCUM_OPTION_06,                                    *00531000
                   MIN_AMOUNT_06,                                      *00532000
                   ACCUM_OPTION_07,                                    *00533000
                   MIN_AMOUNT_07,                                      *00534000
                   ACCUM_OPTION_08,                                    *00535000
                   MIN_AMOUNT_08,                                      *00536000
                   ACCUM_OPTION_09,                                    *00537000
                   MIN_AMOUNT_09,                                      *00538000
                   ACCUM_OPTION_10,                                    *00539000
                   MIN_AMOUNT_10,                                      *00540000
                   ACCUM_OPTION_11,                                    *00541000
                   MIN_AMOUNT_11,                                      *00542000
                   ACCUM_OPTION_12,                                    *00543000
                   MIN_AMOUNT_12                                       *00544000
                 FROM S11                                              *00545000
                 WHERE                                                 *00546000
                   INST_NBR = :INST AND                                *00547000
                   RECORD_NBR = :RECNBR AND                            *00548000
                   TRAN_PROFILE >=                                     *00549000
                     :TRANPROF                                         *00550000
                 ORDER BY TRAN_PROFILE ASC,                            *00551000
                   TRAN_PLAN ASC,                                      *00552000
                   EXTL_TRAN_CODE ASC,                                 *00553000
                   INTL_TRAN_CODE ASC                                  *00554000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00555000
         EXEC  SQL OPEN S11GE004                                        00556000
         MVC   SQWCSRCA,=A(CLSGE004)   SET CURSOR CLOSE ROUTINE ADDRESS 00557000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00558000
         BR    14                      RETURN TO CALLER                 00559000
         LTORG                                                          00560000
*                                                                       00561000
SELGE005 DS    0H                                                       00562000
         USING SELGE005,12             ESTABLISH BASE REGISTER          00563000
         EXEC  SQL DECLARE S11GE005 CURSOR                             *00564000
               WITH ROWSET POSITIONING                                 *00565000
               FOR SELECT                                              *00566000
                   INST_NBR,                                           *00567000
                   RECORD_NBR,                                         *00568000
                   TRAN_PROFILE,                                       *00569000
                   TRAN_PLAN,                                          *00570000
                   EXTL_TRAN_CODE,                                     *00571000
                   INTL_TRAN_CODE,                                     *00572000
                   AUDIT_DATE,                                         *00573000
                   AUDIT_TIME,                                         *00574000
                   AUDIT_USER,                                         *00575000
                   AUDIT_ORG,                                          *00576000
                   TRAN_DESC,                                          *00577000
                   TRAN_SIGN,                                          *00578000
                   ACCUM_OPTION_01,                                    *00579000
                   MIN_AMOUNT_01,                                      *00580000
                   ACCUM_OPTION_02,                                    *00581000
                   MIN_AMOUNT_02,                                      *00582000
                   ACCUM_OPTION_03,                                    *00583000
                   MIN_AMOUNT_03,                                      *00584000
                   ACCUM_OPTION_04,                                    *00585000
                   MIN_AMOUNT_04,                                      *00586000
                   ACCUM_OPTION_05,                                    *00587000
                   MIN_AMOUNT_05,                                      *00588000
                   ACCUM_OPTION_06,                                    *00589000
                   MIN_AMOUNT_06,                                      *00590000
                   ACCUM_OPTION_07,                                    *00591000
                   MIN_AMOUNT_07,                                      *00592000
                   ACCUM_OPTION_08,                                    *00593000
                   MIN_AMOUNT_08,                                      *00594000
                   ACCUM_OPTION_09,                                    *00595000
                   MIN_AMOUNT_09,                                      *00596000
                   ACCUM_OPTION_10,                                    *00597000
                   MIN_AMOUNT_10,                                      *00598000
                   ACCUM_OPTION_11,                                    *00599000
                   MIN_AMOUNT_11,                                      *00600000
                   ACCUM_OPTION_12,                                    *00601000
                   MIN_AMOUNT_12                                       *00602000
                 FROM S11                                              *00603000
                 WHERE                                                 *00604000
                   INST_NBR = :INST AND                                *00605000
                   RECORD_NBR >=                                       *00606000
                     :RECNBR                                           *00607000
                 ORDER BY RECORD_NBR ASC,                              *00608000
                   TRAN_PROFILE ASC,                                   *00609000
                   TRAN_PLAN ASC,                                      *00610000
                   EXTL_TRAN_CODE ASC,                                 *00611000
                   INTL_TRAN_CODE ASC                                  *00612000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00613000
         EXEC  SQL OPEN S11GE005                                        00614000
         MVC   SQWCSRCA,=A(CLSGE005)   SET CURSOR CLOSE ROUTINE ADDRESS 00615000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00616000
         BR    14                      RETURN TO CALLER                 00617000
         LTORG                                                          00618000
*                                                                       00619000
SELGE006 DS    0H                                                       00620000
         USING SELGE006,12             ESTABLISH BASE REGISTER          00621000
         EXEC  SQL DECLARE S11GE006 CURSOR                             *00622000
               WITH ROWSET POSITIONING                                 *00623000
               FOR SELECT                                              *00624000
                   INST_NBR,                                           *00625000
                   RECORD_NBR,                                         *00626000
                   TRAN_PROFILE,                                       *00627000
                   TRAN_PLAN,                                          *00628000
                   EXTL_TRAN_CODE,                                     *00629000
                   INTL_TRAN_CODE,                                     *00630000
                   AUDIT_DATE,                                         *00631000
                   AUDIT_TIME,                                         *00632000
                   AUDIT_USER,                                         *00633000
                   AUDIT_ORG,                                          *00634000
                   TRAN_DESC,                                          *00635000
                   TRAN_SIGN,                                          *00636000
                   ACCUM_OPTION_01,                                    *00637000
                   MIN_AMOUNT_01,                                      *00638000
                   ACCUM_OPTION_02,                                    *00639000
                   MIN_AMOUNT_02,                                      *00640000
                   ACCUM_OPTION_03,                                    *00641000
                   MIN_AMOUNT_03,                                      *00642000
                   ACCUM_OPTION_04,                                    *00643000
                   MIN_AMOUNT_04,                                      *00644000
                   ACCUM_OPTION_05,                                    *00645000
                   MIN_AMOUNT_05,                                      *00646000
                   ACCUM_OPTION_06,                                    *00647000
                   MIN_AMOUNT_06,                                      *00648000
                   ACCUM_OPTION_07,                                    *00649000
                   MIN_AMOUNT_07,                                      *00650000
                   ACCUM_OPTION_08,                                    *00651000
                   MIN_AMOUNT_08,                                      *00652000
                   ACCUM_OPTION_09,                                    *00653000
                   MIN_AMOUNT_09,                                      *00654000
                   ACCUM_OPTION_10,                                    *00655000
                   MIN_AMOUNT_10,                                      *00656000
                   ACCUM_OPTION_11,                                    *00657000
                   MIN_AMOUNT_11,                                      *00658000
                   ACCUM_OPTION_12,                                    *00659000
                   MIN_AMOUNT_12                                       *00660000
                 FROM S11                                              *00661000
                 WHERE                                                 *00662000
                   INST_NBR >=                                         *00663000
                     :INST                                             *00664000
                 ORDER BY INST_NBR ASC,                                *00665000
                   RECORD_NBR ASC,                                     *00666000
                   TRAN_PROFILE ASC,                                   *00667000
                   TRAN_PLAN ASC,                                      *00668000
                   EXTL_TRAN_CODE ASC,                                 *00669000
                   INTL_TRAN_CODE ASC                                  *00670000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00671000
         EXEC  SQL OPEN S11GE006                                        00672000
         MVC   SQWCSRCA,=A(CLSGE006)   SET CURSOR CLOSE ROUTINE ADDRESS 00673000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00674000
         BR    14                      RETURN TO CALLER                 00675000
         LTORG                                                          00676000
*                                                                       00677000
**********************************************************************  00678000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00679000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00680000
**********************************************************************  00681000
*                                                                       00682000
NXTXC0   DS    0H                                                       00683000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00684000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00685000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00686000
         BALR  14,15                   MOVE REQUESTED DATA              00687000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00688000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00689000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00690000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00691000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00692000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00693000
NXTXC0P  DC    A(0)                                                     00694000
         DC    A(NXTGT002)                                              00695000
         DC    A(NXTGT003)                                              00696000
         DC    A(NXTGT004)                                              00697000
         DC    A(NXTGT005)                                              00698000
         DC    A(NXTGT006)                                              00699000
         DC    A(NXTGT099)                                              00700000
         DC    A(NXTGT003)                                              00701000
         DC    A(NXTGT004)                                              00702000
         DC    A(NXTGT005)                                              00703000
         DC    A(NXTGT006)                                              00704000
         DC    A(NXTGT099)                                              00705000
         DC    A(NXTGT004)                                              00706000
         DC    A(NXTGT005)                                              00707000
         DC    A(NXTGT006)                                              00708000
         DC    A(NXTGT099)                                              00709000
         DC    A(NXTGT005)                                              00710000
         DC    A(NXTGT006)                                              00711000
         DC    A(NXTGT099)                                              00712000
         DC    A(NXTGT006)                                              00713000
         DC    A(NXTGT099)                                              00714000
         DC    A(NXTGT099)                                              00715000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00716000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00717000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00718000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00719000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00720000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00721000
         BR    14                      RETURN TO SQI                    00722000
         LTORG                                                          00723000
*                                                                       00724000
NXTGT002 DS    0H                                                       00725000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00726000
         EXEC  SQL DECLARE S11GT002 CURSOR                             *00727000
               WITH ROWSET POSITIONING                                 *00728000
               FOR SELECT                                              *00729000
                   INST_NBR,                                           *00730000
                   RECORD_NBR,                                         *00731000
                   TRAN_PROFILE,                                       *00732000
                   TRAN_PLAN,                                          *00733000
                   EXTL_TRAN_CODE,                                     *00734000
                   INTL_TRAN_CODE,                                     *00735000
                   AUDIT_DATE,                                         *00736000
                   AUDIT_TIME,                                         *00737000
                   AUDIT_USER,                                         *00738000
                   AUDIT_ORG,                                          *00739000
                   TRAN_DESC,                                          *00740000
                   TRAN_SIGN,                                          *00741000
                   ACCUM_OPTION_01,                                    *00742000
                   MIN_AMOUNT_01,                                      *00743000
                   ACCUM_OPTION_02,                                    *00744000
                   MIN_AMOUNT_02,                                      *00745000
                   ACCUM_OPTION_03,                                    *00746000
                   MIN_AMOUNT_03,                                      *00747000
                   ACCUM_OPTION_04,                                    *00748000
                   MIN_AMOUNT_04,                                      *00749000
                   ACCUM_OPTION_05,                                    *00750000
                   MIN_AMOUNT_05,                                      *00751000
                   ACCUM_OPTION_06,                                    *00752000
                   MIN_AMOUNT_06,                                      *00753000
                   ACCUM_OPTION_07,                                    *00754000
                   MIN_AMOUNT_07,                                      *00755000
                   ACCUM_OPTION_08,                                    *00756000
                   MIN_AMOUNT_08,                                      *00757000
                   ACCUM_OPTION_09,                                    *00758000
                   MIN_AMOUNT_09,                                      *00759000
                   ACCUM_OPTION_10,                                    *00760000
                   MIN_AMOUNT_10,                                      *00761000
                   ACCUM_OPTION_11,                                    *00762000
                   MIN_AMOUNT_11,                                      *00763000
                   ACCUM_OPTION_12,                                    *00764000
                   MIN_AMOUNT_12                                       *00765000
                 FROM S11                                              *00766000
                 WHERE                                                 *00767000
                   INST_NBR = :INST AND                                *00768000
                   RECORD_NBR = :RECNBR AND                            *00769000
                   TRAN_PROFILE = :TRANPROF AND                        *00770000
                   TRAN_PLAN = :TRANPLAN AND                           *00771000
                   EXTL_TRAN_CODE >                                    *00772000
                     :TRANEXTL                                         *00773000
                 ORDER BY EXTL_TRAN_CODE ASC,                          *00774000
                   INTL_TRAN_CODE ASC                                  *00775000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00776000
         EXEC  SQL OPEN S11GT002                                        00777000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00778000
         BNZ   *+14                    NO - RETURN ERROR                00779000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00780000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00781000
         BR    12                      RETURN TO FETCH ROUTINE          00782000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00783000
         BR    14                      RETURN TO CALLER                 00784000
         LTORG                                                          00785000
*                                                                       00786000
NXTGT003 DS    0H                                                       00787000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00788000
         EXEC  SQL DECLARE S11GT003 CURSOR                             *00789000
               WITH ROWSET POSITIONING                                 *00790000
               FOR SELECT                                              *00791000
                   INST_NBR,                                           *00792000
                   RECORD_NBR,                                         *00793000
                   TRAN_PROFILE,                                       *00794000
                   TRAN_PLAN,                                          *00795000
                   EXTL_TRAN_CODE,                                     *00796000
                   INTL_TRAN_CODE,                                     *00797000
                   AUDIT_DATE,                                         *00798000
                   AUDIT_TIME,                                         *00799000
                   AUDIT_USER,                                         *00800000
                   AUDIT_ORG,                                          *00801000
                   TRAN_DESC,                                          *00802000
                   TRAN_SIGN,                                          *00803000
                   ACCUM_OPTION_01,                                    *00804000
                   MIN_AMOUNT_01,                                      *00805000
                   ACCUM_OPTION_02,                                    *00806000
                   MIN_AMOUNT_02,                                      *00807000
                   ACCUM_OPTION_03,                                    *00808000
                   MIN_AMOUNT_03,                                      *00809000
                   ACCUM_OPTION_04,                                    *00810000
                   MIN_AMOUNT_04,                                      *00811000
                   ACCUM_OPTION_05,                                    *00812000
                   MIN_AMOUNT_05,                                      *00813000
                   ACCUM_OPTION_06,                                    *00814000
                   MIN_AMOUNT_06,                                      *00815000
                   ACCUM_OPTION_07,                                    *00816000
                   MIN_AMOUNT_07,                                      *00817000
                   ACCUM_OPTION_08,                                    *00818000
                   MIN_AMOUNT_08,                                      *00819000
                   ACCUM_OPTION_09,                                    *00820000
                   MIN_AMOUNT_09,                                      *00821000
                   ACCUM_OPTION_10,                                    *00822000
                   MIN_AMOUNT_10,                                      *00823000
                   ACCUM_OPTION_11,                                    *00824000
                   MIN_AMOUNT_11,                                      *00825000
                   ACCUM_OPTION_12,                                    *00826000
                   MIN_AMOUNT_12                                       *00827000
                 FROM S11                                              *00828000
                 WHERE                                                 *00829000
                   INST_NBR = :INST AND                                *00830000
                   RECORD_NBR = :RECNBR AND                            *00831000
                   TRAN_PROFILE = :TRANPROF AND                        *00832000
                   TRAN_PLAN >                                         *00833000
                     :TRANPLAN                                         *00834000
                 ORDER BY TRAN_PLAN ASC,                               *00835000
                   EXTL_TRAN_CODE ASC,                                 *00836000
                   INTL_TRAN_CODE ASC                                  *00837000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00838000
         EXEC  SQL OPEN S11GT003                                        00839000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00840000
         BNZ   *+14                    NO - RETURN ERROR                00841000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00842000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00843000
         BR    12                      RETURN TO FETCH ROUTINE          00844000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00845000
         BR    14                      RETURN TO CALLER                 00846000
         LTORG                                                          00847000
*                                                                       00848000
NXTGT004 DS    0H                                                       00849000
         USING NXTGT004,12             ESTABLISH BASE REGISTER          00850000
         EXEC  SQL DECLARE S11GT004 CURSOR                             *00851000
               WITH ROWSET POSITIONING                                 *00852000
               FOR SELECT                                              *00853000
                   INST_NBR,                                           *00854000
                   RECORD_NBR,                                         *00855000
                   TRAN_PROFILE,                                       *00856000
                   TRAN_PLAN,                                          *00857000
                   EXTL_TRAN_CODE,                                     *00858000
                   INTL_TRAN_CODE,                                     *00859000
                   AUDIT_DATE,                                         *00860000
                   AUDIT_TIME,                                         *00861000
                   AUDIT_USER,                                         *00862000
                   AUDIT_ORG,                                          *00863000
                   TRAN_DESC,                                          *00864000
                   TRAN_SIGN,                                          *00865000
                   ACCUM_OPTION_01,                                    *00866000
                   MIN_AMOUNT_01,                                      *00867000
                   ACCUM_OPTION_02,                                    *00868000
                   MIN_AMOUNT_02,                                      *00869000
                   ACCUM_OPTION_03,                                    *00870000
                   MIN_AMOUNT_03,                                      *00871000
                   ACCUM_OPTION_04,                                    *00872000
                   MIN_AMOUNT_04,                                      *00873000
                   ACCUM_OPTION_05,                                    *00874000
                   MIN_AMOUNT_05,                                      *00875000
                   ACCUM_OPTION_06,                                    *00876000
                   MIN_AMOUNT_06,                                      *00877000
                   ACCUM_OPTION_07,                                    *00878000
                   MIN_AMOUNT_07,                                      *00879000
                   ACCUM_OPTION_08,                                    *00880000
                   MIN_AMOUNT_08,                                      *00881000
                   ACCUM_OPTION_09,                                    *00882000
                   MIN_AMOUNT_09,                                      *00883000
                   ACCUM_OPTION_10,                                    *00884000
                   MIN_AMOUNT_10,                                      *00885000
                   ACCUM_OPTION_11,                                    *00886000
                   MIN_AMOUNT_11,                                      *00887000
                   ACCUM_OPTION_12,                                    *00888000
                   MIN_AMOUNT_12                                       *00889000
                 FROM S11                                              *00890000
                 WHERE                                                 *00891000
                   INST_NBR = :INST AND                                *00892000
                   RECORD_NBR = :RECNBR AND                            *00893000
                   TRAN_PROFILE >                                      *00894000
                     :TRANPROF                                         *00895000
                 ORDER BY TRAN_PROFILE ASC,                            *00896000
                   TRAN_PLAN ASC,                                      *00897000
                   EXTL_TRAN_CODE ASC,                                 *00898000
                   INTL_TRAN_CODE ASC                                  *00899000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00900000
         EXEC  SQL OPEN S11GT004                                        00901000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00902000
         BNZ   *+14                    NO - RETURN ERROR                00903000
         MVC   SQWCSRCA,=A(CLSGT004)   SET CURSOR CLOSE ROUTINE ADDRESS 00904000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00905000
         BR    12                      RETURN TO FETCH ROUTINE          00906000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00907000
         BR    14                      RETURN TO CALLER                 00908000
         LTORG                                                          00909000
*                                                                       00910000
NXTGT005 DS    0H                                                       00911000
         USING NXTGT005,12             ESTABLISH BASE REGISTER          00912000
         EXEC  SQL DECLARE S11GT005 CURSOR                             *00913000
               WITH ROWSET POSITIONING                                 *00914000
               FOR SELECT                                              *00915000
                   INST_NBR,                                           *00916000
                   RECORD_NBR,                                         *00917000
                   TRAN_PROFILE,                                       *00918000
                   TRAN_PLAN,                                          *00919000
                   EXTL_TRAN_CODE,                                     *00920000
                   INTL_TRAN_CODE,                                     *00921000
                   AUDIT_DATE,                                         *00922000
                   AUDIT_TIME,                                         *00923000
                   AUDIT_USER,                                         *00924000
                   AUDIT_ORG,                                          *00925000
                   TRAN_DESC,                                          *00926000
                   TRAN_SIGN,                                          *00927000
                   ACCUM_OPTION_01,                                    *00928000
                   MIN_AMOUNT_01,                                      *00929000
                   ACCUM_OPTION_02,                                    *00930000
                   MIN_AMOUNT_02,                                      *00931000
                   ACCUM_OPTION_03,                                    *00932000
                   MIN_AMOUNT_03,                                      *00933000
                   ACCUM_OPTION_04,                                    *00934000
                   MIN_AMOUNT_04,                                      *00935000
                   ACCUM_OPTION_05,                                    *00936000
                   MIN_AMOUNT_05,                                      *00937000
                   ACCUM_OPTION_06,                                    *00938000
                   MIN_AMOUNT_06,                                      *00939000
                   ACCUM_OPTION_07,                                    *00940000
                   MIN_AMOUNT_07,                                      *00941000
                   ACCUM_OPTION_08,                                    *00942000
                   MIN_AMOUNT_08,                                      *00943000
                   ACCUM_OPTION_09,                                    *00944000
                   MIN_AMOUNT_09,                                      *00945000
                   ACCUM_OPTION_10,                                    *00946000
                   MIN_AMOUNT_10,                                      *00947000
                   ACCUM_OPTION_11,                                    *00948000
                   MIN_AMOUNT_11,                                      *00949000
                   ACCUM_OPTION_12,                                    *00950000
                   MIN_AMOUNT_12                                       *00951000
                 FROM S11                                              *00952000
                 WHERE                                                 *00953000
                   INST_NBR = :INST AND                                *00954000
                   RECORD_NBR >                                        *00955000
                     :RECNBR                                           *00956000
                 ORDER BY RECORD_NBR ASC,                              *00957000
                   TRAN_PROFILE ASC,                                   *00958000
                   TRAN_PLAN ASC,                                      *00959000
                   EXTL_TRAN_CODE ASC,                                 *00960000
                   INTL_TRAN_CODE ASC                                  *00961000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00962000
         EXEC  SQL OPEN S11GT005                                        00963000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00964000
         BNZ   *+14                    NO - RETURN ERROR                00965000
         MVC   SQWCSRCA,=A(CLSGT005)   SET CURSOR CLOSE ROUTINE ADDRESS 00966000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00967000
         BR    12                      RETURN TO FETCH ROUTINE          00968000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00969000
         BR    14                      RETURN TO CALLER                 00970000
         LTORG                                                          00971000
*                                                                       00972000
NXTGT006 DS    0H                                                       00973000
         USING NXTGT006,12             ESTABLISH BASE REGISTER          00974000
         EXEC  SQL DECLARE S11GT006 CURSOR                             *00975000
               WITH ROWSET POSITIONING                                 *00976000
               FOR SELECT                                              *00977000
                   INST_NBR,                                           *00978000
                   RECORD_NBR,                                         *00979000
                   TRAN_PROFILE,                                       *00980000
                   TRAN_PLAN,                                          *00981000
                   EXTL_TRAN_CODE,                                     *00982000
                   INTL_TRAN_CODE,                                     *00983000
                   AUDIT_DATE,                                         *00984000
                   AUDIT_TIME,                                         *00985000
                   AUDIT_USER,                                         *00986000
                   AUDIT_ORG,                                          *00987000
                   TRAN_DESC,                                          *00988000
                   TRAN_SIGN,                                          *00989000
                   ACCUM_OPTION_01,                                    *00990000
                   MIN_AMOUNT_01,                                      *00991000
                   ACCUM_OPTION_02,                                    *00992000
                   MIN_AMOUNT_02,                                      *00993000
                   ACCUM_OPTION_03,                                    *00994000
                   MIN_AMOUNT_03,                                      *00995000
                   ACCUM_OPTION_04,                                    *00996000
                   MIN_AMOUNT_04,                                      *00997000
                   ACCUM_OPTION_05,                                    *00998000
                   MIN_AMOUNT_05,                                      *00999000
                   ACCUM_OPTION_06,                                    *01000000
                   MIN_AMOUNT_06,                                      *01001000
                   ACCUM_OPTION_07,                                    *01002000
                   MIN_AMOUNT_07,                                      *01003000
                   ACCUM_OPTION_08,                                    *01004000
                   MIN_AMOUNT_08,                                      *01005000
                   ACCUM_OPTION_09,                                    *01006000
                   MIN_AMOUNT_09,                                      *01007000
                   ACCUM_OPTION_10,                                    *01008000
                   MIN_AMOUNT_10,                                      *01009000
                   ACCUM_OPTION_11,                                    *01010000
                   MIN_AMOUNT_11,                                      *01011000
                   ACCUM_OPTION_12,                                    *01012000
                   MIN_AMOUNT_12                                       *01013000
                 FROM S11                                              *01014000
                 WHERE                                                 *01015000
                   INST_NBR >                                          *01016000
                     :INST                                             *01017000
                 ORDER BY INST_NBR ASC,                                *01018000
                   RECORD_NBR ASC,                                     *01019000
                   TRAN_PROFILE ASC,                                   *01020000
                   TRAN_PLAN ASC,                                      *01021000
                   EXTL_TRAN_CODE ASC,                                 *01022000
                   INTL_TRAN_CODE ASC                                  *01023000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01024000
         EXEC  SQL OPEN S11GT006                                        01025000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01026000
         BNZ   *+14                    NO - RETURN ERROR                01027000
         MVC   SQWCSRCA,=A(CLSGT006)   SET CURSOR CLOSE ROUTINE ADDRESS 01028000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01029000
         BR    12                      RETURN TO FETCH ROUTINE          01030000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01031000
         BR    14                      RETURN TO CALLER                 01032000
         LTORG                                                          01033000
*                                                                       01034000
**********************************************************************  01035000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               01036000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01037000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01038000
*     RETRIEVE THE ACTUAL ROW.                                          01039000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01040000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01041000
**********************************************************************  01042000
*                                                                       01043000
FETDC0   DS    0H                                                       01044000
         USING FETDC0,12               ESTABLISH BASE REGISTER          01045000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       01046000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01047000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       01048000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01049000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    01050000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01051000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01052000
FETDC0P  DC    A(FETGE001)                                              01053000
         DC    A(FETGT002)                                              01054000
         DC    A(FETGT003)                                              01055000
         DC    A(FETGT004)                                              01056000
         DC    A(FETGT005)                                              01057000
         DC    A(FETGT006)                                              01058000
         DC    A(FETGE002)                                              01059000
         DC    A(FETGT003)                                              01060000
         DC    A(FETGT004)                                              01061000
         DC    A(FETGT005)                                              01062000
         DC    A(FETGT006)                                              01063000
         DC    A(FETGE003)                                              01064000
         DC    A(FETGT004)                                              01065000
         DC    A(FETGT005)                                              01066000
         DC    A(FETGT006)                                              01067000
         DC    A(FETGE004)                                              01068000
         DC    A(FETGT005)                                              01069000
         DC    A(FETGT006)                                              01070000
         DC    A(FETGE005)                                              01071000
         DC    A(FETGT006)                                              01072000
         DC    A(FETGE006)                                              01073000
         DC    A(0)                                                     01074000
         LTORG                                                          01075000
*                                                                       01076000
**********************************************************************  01077000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01078000
* THE PRIMARY KEY:                                                      01079000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01080000
*     VERBS.                                                            01081000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01082000
*     RETRIEVE THE ACTUAL ROW.                                          01083000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01084000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01085000
*     WILL BE THRU THE UPDATE CURSOR.                                   01086000
**********************************************************************  01087000
*                                                                       01088000
FETKC0   DS    0H                                                       01089000
         USING FETKC0,12               ESTABLISH BASE REGISTER          01090000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       01091000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01092000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           01093000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01094000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    01095000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01096000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01097000
FETKC0P  DC    A(FETGE001)                                              01098000
         DC    A(FETGT002)                                              01099000
         DC    A(FETGT003)                                              01100000
         DC    A(FETGT004)                                              01101000
         DC    A(FETGT005)                                              01102000
         DC    A(FETGT006)                                              01103000
         DC    A(FETGE002)                                              01104000
         DC    A(FETGT003)                                              01105000
         DC    A(FETGT004)                                              01106000
         DC    A(FETGT005)                                              01107000
         DC    A(FETGT006)                                              01108000
         DC    A(FETGE003)                                              01109000
         DC    A(FETGT004)                                              01110000
         DC    A(FETGT005)                                              01111000
         DC    A(FETGT006)                                              01112000
         DC    A(FETGE004)                                              01113000
         DC    A(FETGT005)                                              01114000
         DC    A(FETGT006)                                              01115000
         DC    A(FETGE005)                                              01116000
         DC    A(FETGT006)                                              01117000
         DC    A(FETGE006)                                              01118000
         DC    A(0)                                                     01119000
         LTORG                                                          01120000
*                                                                       01121000
FETGE001 DS    0H                                                       01122000
         USING FETGE001,12             ESTABLISH BASE REGISTER          01123000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01124000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01125000
         BALR  14,15                   MOVE REQUESTED DATA              01126000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GE001                     *01127000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01128000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01129000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01130000
         BALR  14,15                   MOVE REQUESTED DATA              01131000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01132000
         BR    14                      RETURN TO CALLER                 01133000
         LTORG                                                          01134000
*                                                                       01135000
FETGE002 DS    0H                                                       01136000
         USING FETGE002,12             ESTABLISH BASE REGISTER          01137000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01138000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01139000
         BALR  14,15                   MOVE REQUESTED DATA              01140000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GE002                     *01141000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01142000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01143000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01144000
         BALR  14,15                   MOVE REQUESTED DATA              01145000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01146000
         BR    14                      RETURN TO CALLER                 01147000
         LTORG                                                          01148000
*                                                                       01149000
FETGE003 DS    0H                                                       01150000
         USING FETGE003,12             ESTABLISH BASE REGISTER          01151000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01152000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01153000
         BALR  14,15                   MOVE REQUESTED DATA              01154000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GE003                     *01155000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01156000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01157000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01158000
         BALR  14,15                   MOVE REQUESTED DATA              01159000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01160000
         BR    14                      RETURN TO CALLER                 01161000
         LTORG                                                          01162000
*                                                                       01163000
FETGE004 DS    0H                                                       01164000
         USING FETGE004,12             ESTABLISH BASE REGISTER          01165000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01166000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01167000
         BALR  14,15                   MOVE REQUESTED DATA              01168000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GE004                     *01169000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01170000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01171000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01172000
         BALR  14,15                   MOVE REQUESTED DATA              01173000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01174000
         BR    14                      RETURN TO CALLER                 01175000
         LTORG                                                          01176000
*                                                                       01177000
FETGE005 DS    0H                                                       01178000
         USING FETGE005,12             ESTABLISH BASE REGISTER          01179000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01180000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01181000
         BALR  14,15                   MOVE REQUESTED DATA              01182000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GE005                     *01183000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01184000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01185000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01186000
         BALR  14,15                   MOVE REQUESTED DATA              01187000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01188000
         BR    14                      RETURN TO CALLER                 01189000
         LTORG                                                          01190000
*                                                                       01191000
FETGE006 DS    0H                                                       01192000
         USING FETGE006,12             ESTABLISH BASE REGISTER          01193000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01194000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01195000
         BALR  14,15                   MOVE REQUESTED DATA              01196000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GE006                     *01197000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01198000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01199000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01200000
         BALR  14,15                   MOVE REQUESTED DATA              01201000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01202000
         BR    14                      RETURN TO CALLER                 01203000
         LTORG                                                          01204000
*                                                                       01205000
FETGT002 DS    0H                                                       01206000
         USING FETGT002,12             ESTABLISH BASE REGISTER          01207000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01208000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01209000
         BALR  14,15                   MOVE REQUESTED DATA              01210000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GT002                     *01211000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01212000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01213000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01214000
         BALR  14,15                   MOVE REQUESTED DATA              01215000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01216000
         BR    14                      RETURN TO CALLER                 01217000
         LTORG                                                          01218000
*                                                                       01219000
FETGT003 DS    0H                                                       01220000
         USING FETGT003,12             ESTABLISH BASE REGISTER          01221000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01222000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01223000
         BALR  14,15                   MOVE REQUESTED DATA              01224000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GT003                     *01225000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01226000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01227000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01228000
         BALR  14,15                   MOVE REQUESTED DATA              01229000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01230000
         BR    14                      RETURN TO CALLER                 01231000
         LTORG                                                          01232000
*                                                                       01233000
FETGT004 DS    0H                                                       01234000
         USING FETGT004,12             ESTABLISH BASE REGISTER          01235000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01236000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01237000
         BALR  14,15                   MOVE REQUESTED DATA              01238000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GT004                     *01239000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01240000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01241000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01242000
         BALR  14,15                   MOVE REQUESTED DATA              01243000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01244000
         BR    14                      RETURN TO CALLER                 01245000
         LTORG                                                          01246000
*                                                                       01247000
FETGT005 DS    0H                                                       01248000
         USING FETGT005,12             ESTABLISH BASE REGISTER          01249000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01250000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01251000
         BALR  14,15                   MOVE REQUESTED DATA              01252000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GT005                     *01253000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01254000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01255000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01256000
         BALR  14,15                   MOVE REQUESTED DATA              01257000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01258000
         BR    14                      RETURN TO CALLER                 01259000
         LTORG                                                          01260000
*                                                                       01261000
FETGT006 DS    0H                                                       01262000
         USING FETGT006,12             ESTABLISH BASE REGISTER          01263000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01264000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01265000
         BALR  14,15                   MOVE REQUESTED DATA              01266000
         EXEC  SQL FETCH NEXT ROWSET FROM S11GT006                     *01267000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01268000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01269000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01270000
         BALR  14,15                   MOVE REQUESTED DATA              01271000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01272000
         BR    14                      RETURN TO CALLER                 01273000
         LTORG                                                          01274000
*                                                                       01275000
**********************************************************************  01276000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01277000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01278000
*     AND GET-NEXT-LOCK VERBS.                                          01279000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01280000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01281000
**********************************************************************  01282000
*                                                                       01283000
CLSXC0   DS    0H                                                       01284000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          01285000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 01286000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  01287000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       01288000
         LTORG                                                          01289000
*                                                                       01290000
CLSGE001 DS    0H                                                       01291000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          01292000
         EXEC  SQL CLOSE S11GE001                                       01293000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01294000
         BR    14                      RETURN TO CALLER                 01295000
         LTORG                                                          01296000
*                                                                       01297000
CLSGE002 DS    0H                                                       01298000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          01299000
         EXEC  SQL CLOSE S11GE002                                       01300000
         L     14,SQW@RET                                               01301000
         BR    14                                                       01302000
         LTORG                                                          01303000
*                                                                       01304000
CLSGE003 DS    0H                                                       01305000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          01306000
         EXEC  SQL CLOSE S11GE003                                       01307000
         L     14,SQW@RET                                               01308000
         BR    14                                                       01309000
         LTORG                                                          01310000
*                                                                       01311000
CLSGE004 DS    0H                                                       01312000
         USING CLSGE004,12             ESTABLISH BASE REGISTER          01313000
         EXEC  SQL CLOSE S11GE004                                       01314000
         L     14,SQW@RET                                               01315000
         BR    14                                                       01316000
         LTORG                                                          01317000
*                                                                       01318000
CLSGE005 DS    0H                                                       01319000
         USING CLSGE005,12             ESTABLISH BASE REGISTER          01320000
         EXEC  SQL CLOSE S11GE005                                       01321000
         L     14,SQW@RET                                               01322000
         BR    14                                                       01323000
         LTORG                                                          01324000
*                                                                       01325000
CLSGE006 DS    0H                                                       01326000
         USING CLSGE006,12             ESTABLISH BASE REGISTER          01327000
         EXEC  SQL CLOSE S11GE006                                       01328000
         L     14,SQW@RET                                               01329000
         BR    14                                                       01330000
         LTORG                                                          01331000
*                                                                       01332000
CLSGT002 DS    0H                                                       01333000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          01334000
         EXEC  SQL CLOSE S11GT002                                       01335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01336000
         BR    14                      RETURN TO CALLER                 01337000
         LTORG                                                          01338000
*                                                                       01339000
CLSGT003 DS    0H                                                       01340000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          01341000
         EXEC  SQL CLOSE S11GT003                                       01342000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01343000
         BR    14                      RETURN TO CALLER                 01344000
         LTORG                                                          01345000
*                                                                       01346000
CLSGT004 DS    0H                                                       01347000
         USING CLSGT004,12             ESTABLISH BASE REGISTER          01348000
         EXEC  SQL CLOSE S11GT004                                       01349000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01350000
         BR    14                      RETURN TO CALLER                 01351000
         LTORG                                                          01352000
*                                                                       01353000
CLSGT005 DS    0H                                                       01354000
         USING CLSGT005,12             ESTABLISH BASE REGISTER          01355000
         EXEC  SQL CLOSE S11GT005                                       01356000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01357000
         BR    14                      RETURN TO CALLER                 01358000
         LTORG                                                          01359000
*                                                                       01360000
CLSGT006 DS    0H                                                       01361000
         USING CLSGT006,12             ESTABLISH BASE REGISTER          01362000
         EXEC  SQL CLOSE S11GT006                                       01363000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01364000
         BR    14                      RETURN TO CALLER                 01365000
         LTORG                                                          01366000
*                                                                       01367000
**********************************************************************  01368000
* ALTERNATE KEY 1 NOT DEFINED                                           01369000
**********************************************************************  01370000
*                                                                       01371000
SELIN1   DS    0H                                                       01372000
SELKY1   DS    0H                                                       01373000
SELXC1   DS    0H                                                       01374000
FETDC1   DS    0H                                                       01375000
FETKC1   DS    0H                                                       01376000
CLSXC1   DS    0H                                                       01377000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 01378000
*                                                                       01379000
**********************************************************************  01380000
* ALTERNATE KEY 2 NOT DEFINED                                           01381000
**********************************************************************  01382000
*                                                                       01383000
SELIN2   DS    0H                                                       01384000
SELKY2   DS    0H                                                       01385000
SELXC2   DS    0H                                                       01386000
FETDC2   DS    0H                                                       01387000
FETKC2   DS    0H                                                       01388000
CLSXC2   DS    0H                                                       01389000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 01390000
*                                                                       01391000
**********************************************************************  01392000
* ALTERNATE KEY 3 NOT DEFINED                                           01393000
**********************************************************************  01394000
*                                                                       01395000
SELIN3   DS    0H                                                       01396000
SELKY3   DS    0H                                                       01397000
SELXC3   DS    0H                                                       01398000
FETDC3   DS    0H                                                       01399000
FETKC3   DS    0H                                                       01400000
CLSXC3   DS    0H                                                       01401000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 01402000
*                                                                       01403000
         DS    0H                      END OF SQL STATEMENTS            01404000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01405000
*                                                                       01406000
**********************************************************************  01407000
* DUMMY ENTRY POINT DSNHLI                                              01408000
**********************************************************************  01409000
*                                                                       01410000
         ENTRY DSNHLI                                                   01411000
DSNHLI   DS    0H                                                       01412000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01413000
         BR    15                      BRANCH TO ATTACH FACILITY        01414000
*                                                                       01415000
**********************************************************************  01416000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01417000
**********************************************************************  01418000
*                                                                       01419000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       01420000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      01421000
* OR:                                                                   01422000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      01423000
* WHERE:                                                                01424000
*   RRRR = RECORD AREA OFFSET                                           01425000
*   VVVV = HOST VARIABLE AREA OFFSET                                    01426000
*   LLLL = HALFWORD LENGTH TO MOVE                                      01427000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       01428000
*   KK   = KEY FIELD MASK:                                              01429000
*            80 = KEY 0 FIELD                                           01430000
*            40 = KEY 1 FIELD                                           01431000
*            20 = KEY 2 FIELD                                           01432000
*            10 = KEY 3 FIELD                                           01433000
*   DD   = DATA FIELD MASK:                                             01434000
*            80 = RECORD FIELD IS PACKED                                01435000
*            40 = HOST VARIABLE IS PACKED                               01436000
*            20 = NULLABLE FIELD                                        01437000
*            01 = DATE FIELD                                            01438000
*            02 = TIME FIELD                                            01439000
*                                                                       01440000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 01441000
         DC    H'0000',H'0000',H'0025',X'80',X'00'                      01442000
         DC    H'0025',H'0025',H'0127',X'00',X'00'                      01443000
         DC    8X'FF'                                                   01444000
*                                                                       01445000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               01446000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  01447000
* OR:                                                                   01448000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  01449000
* WHERE:                                                                01450000
*   RRRR = RECORD AREA OFFSET                                           01451000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     01452000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      01453000
*   TTTT = SQLDA DATA TYPE:                                             01454000
*            452 = CHAR       453 = CHAR NULLABLE                       01455000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    01456000
*            496 = INTEGER    497 = INTEGER NULLABLE                    01457000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   01458000
*                                                                       01459000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      01460000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 01461000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       01462000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    01463000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       01464000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       01465000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       01466000
         DC    AL2(00152)              SUMMATION OF ALL COLUMN LENGTHS  01467000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     01468000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       01469000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       01470000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       01471000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      01472000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        01473000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        01474000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        01475000
CONVDATA DS    0H                                                       01476000
         DC    H'0000',H'0004',H'452'  INST_NBR                         01477000
         DC    H'0004',H'0004',H'452'  RECORD_NBR                       01478000
         DC    H'0008',H'0006',H'452'  TRAN_PROFILE                     01479000
         DC    H'0014',H'0003',H'452'  TRAN_PLAN                        01480000
         DC    H'0017',H'0004',H'452'  EXTL_TRAN_CODE                   01481000
         DC    H'0021',H'0004',H'452'  INTL_TRAN_CODE                   01482000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   01483000
         DC    H'0025',X'0900',H'484'  AUDIT_DATE                       01484000
         DC    H'0030',X'0900',H'484'  AUDIT_TIME                       01485000
         DC    H'0035',H'0008',H'452'  AUDIT_USER                       01486000
         DC    H'0043',H'0006',H'452'  AUDIT_ORG                        01487000
         DC    H'0049',H'0030',H'452'  TRAN_DESC                        01488000
         DC    H'0079',H'0001',H'452'  TRAN_SIGN                        01489000
         DC    H'0080',H'0001',H'452'  ACCUM_OPTION_01                  01490000
         DC    H'0081',X'0900',H'484'  MIN_AMOUNT_01                    01491000
         DC    H'0086',H'0001',H'452'  ACCUM_OPTION_02                  01492000
         DC    H'0087',X'0900',H'484'  MIN_AMOUNT_02                    01493000
         DC    H'0092',H'0001',H'452'  ACCUM_OPTION_03                  01494000
         DC    H'0093',X'0900',H'484'  MIN_AMOUNT_03                    01495000
         DC    H'0098',H'0001',H'452'  ACCUM_OPTION_04                  01496000
         DC    H'0099',X'0900',H'484'  MIN_AMOUNT_04                    01497000
         DC    H'0104',H'0001',H'452'  ACCUM_OPTION_05                  01498000
         DC    H'0105',X'0900',H'484'  MIN_AMOUNT_05                    01499000
         DC    H'0110',H'0001',H'452'  ACCUM_OPTION_06                  01500000
         DC    H'0111',X'0900',H'484'  MIN_AMOUNT_06                    01501000
         DC    H'0116',H'0001',H'452'  ACCUM_OPTION_07                  01502000
         DC    H'0117',X'0900',H'484'  MIN_AMOUNT_07                    01503000
         DC    H'0122',H'0001',H'452'  ACCUM_OPTION_08                  01504000
         DC    H'0123',X'0900',H'484'  MIN_AMOUNT_08                    01505000
         DC    H'0128',H'0001',H'452'  ACCUM_OPTION_09                  01506000
         DC    H'0129',X'0900',H'484'  MIN_AMOUNT_09                    01507000
         DC    H'0134',H'0001',H'452'  ACCUM_OPTION_10                  01508000
         DC    H'0135',X'0900',H'484'  MIN_AMOUNT_10                    01509000
         DC    H'0140',H'0001',H'452'  ACCUM_OPTION_11                  01510000
         DC    H'0141',X'0900',H'484'  MIN_AMOUNT_11                    01511000
         DC    H'0146',H'0001',H'452'  ACCUM_OPTION_12                  01512000
         DC    H'0147',X'0900',H'484'  MIN_AMOUNT_12                    01513000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       01514000
KY0COLMS EQU   00006                   NUMBER OF PRIMARY KEY COLUMNS    01515000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      01516000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      01517000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      01518000
*                                                                       01519000
         LTORG                                                          01520000
         END                                                            01521000
