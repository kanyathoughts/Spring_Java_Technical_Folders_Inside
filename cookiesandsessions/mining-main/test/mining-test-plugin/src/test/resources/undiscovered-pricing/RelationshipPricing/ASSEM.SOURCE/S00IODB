* REL=S00IODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  S00IODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S00 FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL62                    COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
RECNBR   DS    CL4                                                      00039000
AUDDATE  DS    PL5'0.'                                                  00040000
AUDTIME  DS    PL5'0.'                                                  00041000
AUDUSER  DS    CL8                                                      00042000
AUDORG   DS    CL6                                                      00043000
ACCTLIMT DS    CL1                                                      00044000
CUSTLIMT DS    CL1                                                      00045000
EXPRDAY  DS    CL3                                                      00046000
AINCOPT  DS    CL1                                                      00047000
SECSVOPT DS    CL1                                                      00048000
VALIDOPT DS    CL1                                                      00049000
MAXRETDY DS    CL3                                                      00050000
MAXEXTN  DS    CL2                                                      00051000
RATEOPT  DS    CL1                                                      00052000
ENTPROPT DS    CL1                                                      00053000
ENTPINST DS    CL4                                                      00054000
DUPINCOP DS    CL1                                                      00055000
DUPINRUL DS    CL1                                                      00056000
MAXMODEL DS    CL2                                                      00057000
MAXACCTS DS    CL3                                                      00058000
EVHSTOPT DS    CL1                                                      00059000
EVHSTDYS DS    CL3                                                      00060000
*                                                                       00061000
*                                                                       00062000
**********************************************************************  00063000
* PROGRAM TABLE HEADER SECTION:                                         00064000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00065000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00066000
**********************************************************************  00067000
*                                                                       00068000
S00IODB  CSECT                         PROGRAM TABLE SECTION            00069000
S00IODB  AMODE ANY                                                      00070000
S00IODB  RMODE ANY                                                      00071000
         DC    CL9'S00IODB'            PROGRAM ID                       00072000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00073000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00074000
         DC    A(0)                    RESERVED                         00075000
         DC    A(0)                    RESERVED                         00076000
         DC    24CL1' '                RESERVED                         00077000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00078000
*                                                                       00079000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00080000
         DC    CL29'WWW.INFOR.COM                '                      00080001
*                                                                       00081000
*                                                                       00082000
**********************************************************************  00083000
* STATEMENT TABLE SECTION:                                              00084000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00085000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00086000
*   SHOULD NOT BE MODIFIED.                                             00087000
**********************************************************************  00088000
*                                                                       00089000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00090000
STM#TAB  AMODE ANY                                                      00091000
STM#TAB  RMODE ANY                                                      00092000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00093000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00094000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00095000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00096000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00097000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00098000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00099000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00100000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00101000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00102000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00103000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00104000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00105000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00106000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00107000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00108000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00109000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00110000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00111000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00112000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00113000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00114000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00115000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00116000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00117000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00118000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00119000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00120000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00121000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00122000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00123000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00124000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00125000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00126000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00127000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00128000
         DC    A(SQL#0036)             INSERT STATEMENT                 00129000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00130000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00131000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00132000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00133000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00134000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00135000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00136000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00137000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00138000
         DC    4X'FF'                                                   00139000
*                                                                       00140000
*                                                                       00141000
**********************************************************************  00142000
* SQL STATEMENT SECTION:                                                00143000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00144000
*     TO SUPPORT THIS TABLE.                                            00145000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00146000
*     ARE EQUIVALENT.                                                   00147000
**********************************************************************  00148000
*                                                                       00149000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00150000
SQL#STMT AMODE ANY                                                      00151000
SQL#STMT RMODE ANY                                                      00152000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00153000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00154000
         USING COM#AREA,11             ADDRESS COMMAREA                 00155000
*                                                                       00156000
*                                                                       00157000
**********************************************************************  00158000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00159000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00160000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00161000
**********************************************************************  00162000
*                                                                       00163000
SQL#0000 DS    0H                                                       00164000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00165000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00166000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00167000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00168000
         EXEC  SQL                                                     *00169000
               SELECT AUDIT_DATE,                                      *00170000
                   AUDIT_TIME,                                         *00171000
                   AUDIT_USER,                                         *00172000
                   AUDIT_ORG,                                          *00173000
                   ACCT_LIMIT_OPT,                                     *00174000
                   CUST_LIMIT_OPT,                                     *00175000
                   MAX_EXPIRE_DAY,                                     *00176000
                   ADD_INC_OPT,                                        *00177000
                   SEC_SVC_OPT,                                        *00178000
                   VALID_OPT,                                          *00179000
                   MAX_RETN_DAYS,                                      *00180000
                   MAX_EXTN,                                           *00181000
                   RATE_OPTION,                                        *00182000
                   ENTERPRISE_OPT,                                     *00183000
                   ENTERPRISE_INST,                                    *00184000
                   DUP_INC_OPT,                                        *00185000
                   DUP_INC_RULE,                                       *00186000
                   MODEL_LIMIT,                                        *00187000
                   ACCOUNT_LIMIT,                                      *00188000
                   EVENT_HST_OPT,                                      *00189000
                   EVENT_HST_DAYS                                      *00190000
                 INTO :AUDDATE,                                        *00191000
                   :AUDTIME,                                           *00192000
                   :AUDUSER,                                           *00193000
                   :AUDORG,                                            *00194000
                   :ACCTLIMT,                                          *00195000
                   :CUSTLIMT,                                          *00196000
                   :EXPRDAY,                                           *00197000
                   :AINCOPT,                                           *00198000
                   :SECSVOPT,                                          *00199000
                   :VALIDOPT,                                          *00200000
                   :MAXRETDY,                                          *00201000
                   :MAXEXTN,                                           *00202000
                   :RATEOPT,                                           *00203000
                   :ENTPROPT,                                          *00204000
                   :ENTPINST,                                          *00205000
                   :DUPINCOP,                                          *00206000
                   :DUPINRUL,                                          *00207000
                   :MAXMODEL,                                          *00208000
                   :MAXACCTS,                                          *00209000
                   :EVHSTOPT,                                          *00210000
                   :EVHSTDYS                                           *00211000
                 FROM S00                                              *00212000
                 WHERE INST_NBR = :INST AND                            *00213000
                   RECORD_NBR = :RECNBR                                *00214000
                 FETCH FIRST 1 ROW ONLY                                 00215000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00216000
         BALR  4,5                     MOVE INTO RECORD AREA            00217000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00218000
         BR    14                      RETURN TO CALLER                 00219000
         LTORG                                                          00220000
*                                                                       00221000
*                                                                       00222000
**********************************************************************  00223000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00224000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00225000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00226000
**********************************************************************  00227000
*                                                                       00228000
SQL#0001 DS    0H                                                       00229000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00230000
         LA    15,255                  SET RETURN CODE                  00231000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00232000
         BR    14                      RETURN TO CALLER                 00233000
         LTORG                                                          00234000
*                                                                       00235000
*                                                                       00236000
**********************************************************************  00237000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00238000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00239000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00240000
**********************************************************************  00241000
*                                                                       00242000
SQL#0002 DS    0H                                                       00243000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00244000
         LA    15,255                  SET RETURN CODE                  00245000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00246000
         BR    14                      RETURN TO CALLER                 00247000
         LTORG                                                          00248000
*                                                                       00249000
*                                                                       00250000
**********************************************************************  00251000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00252000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00253000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00254000
**********************************************************************  00255000
*                                                                       00256000
SQL#0003 DS    0H                                                       00257000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00258000
         LA    15,255                  SET RETURN CODE                  00259000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00260000
         BR    14                      RETURN TO CALLER                 00261000
         LTORG                                                          00262000
*                                                                       00263000
*                                                                       00264000
**********************************************************************  00265000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00266000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00267000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00268000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00269000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00270000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00271000
*     UPDATE STATEMENT TO MATCH.                                        00272000
**********************************************************************  00273000
*                                                                       00274000
SQL#0004 DS    0H                                                       00275000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00276000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00277000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00278000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00279000
         EXEC  SQL                                                     *00280000
               DECLARE S00UPD0 CURSOR FOR                              *00281000
               SELECT AUDIT_DATE,                                      *00282000
                   AUDIT_TIME,                                         *00283000
                   AUDIT_USER,                                         *00284000
                   AUDIT_ORG,                                          *00285000
                   ACCT_LIMIT_OPT,                                     *00286000
                   CUST_LIMIT_OPT,                                     *00287000
                   MAX_EXPIRE_DAY,                                     *00288000
                   ADD_INC_OPT,                                        *00289000
                   SEC_SVC_OPT,                                        *00290000
                   VALID_OPT,                                          *00291000
                   MAX_RETN_DAYS,                                      *00292000
                   MAX_EXTN,                                           *00293000
                   RATE_OPTION,                                        *00294000
                   ENTERPRISE_OPT,                                     *00295000
                   ENTERPRISE_INST,                                    *00296000
                   DUP_INC_OPT,                                        *00297000
                   DUP_INC_RULE,                                       *00298000
                   MODEL_LIMIT,                                        *00299000
                   ACCOUNT_LIMIT,                                      *00300000
                   EVENT_HST_OPT,                                      *00301000
                   EVENT_HST_DAYS                                      *00302000
                 FROM S00                                              *00303000
                 WHERE INST_NBR = :INST AND                            *00304000
                   RECORD_NBR = :RECNBR                                *00305000
                 FOR UPDATE OF AUDIT_DATE,                             *00306000
                   AUDIT_TIME,                                         *00307000
                   AUDIT_USER,                                         *00308000
                   AUDIT_ORG,                                          *00309000
                   ACCT_LIMIT_OPT,                                     *00310000
                   CUST_LIMIT_OPT,                                     *00311000
                   MAX_EXPIRE_DAY,                                     *00312000
                   ADD_INC_OPT,                                        *00313000
                   SEC_SVC_OPT,                                        *00314000
                   VALID_OPT,                                          *00315000
                   MAX_RETN_DAYS,                                      *00316000
                   MAX_EXTN,                                           *00317000
                   RATE_OPTION,                                        *00318000
                   ENTERPRISE_OPT,                                     *00319000
                   ENTERPRISE_INST,                                    *00320000
                   DUP_INC_OPT,                                        *00321000
                   DUP_INC_RULE,                                       *00322000
                   MODEL_LIMIT,                                        *00323000
                   ACCOUNT_LIMIT,                                      *00324000
                   EVENT_HST_OPT,                                      *00325000
                   EVENT_HST_DAYS                                      *00326000
                 FETCH FIRST 1 ROW ONLY                                 00327000
         EXEC  SQL                                                     *00328000
               OPEN S00UPD0                                             00329000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00330000
         BR    14                      RETURN TO CALLER                 00331000
         LTORG                                                          00332000
*                                                                       00333000
*                                                                       00334000
**********************************************************************  00335000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00336000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00337000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00338000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00339000
*     UPDATE STATEMENT TO MATCH.                                        00340000
**********************************************************************  00341000
*                                                                       00342000
SQL#0005 DS    0H                                                       00343000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00344000
         LA    15,255                  SET RETURN CODE                  00345000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00346000
         BR    14                      RETURN TO CALLER                 00347000
         LTORG                                                          00348000
*                                                                       00349000
*                                                                       00350000
**********************************************************************  00351000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00352000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00353000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00354000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00355000
*     UPDATE STATEMENT TO MATCH.                                        00356000
**********************************************************************  00357000
*                                                                       00358000
SQL#0006 DS    0H                                                       00359000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00360000
         LA    15,255                  SET RETURN CODE                  00361000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00362000
         BR    14                      RETURN TO CALLER                 00363000
         LTORG                                                          00364000
*                                                                       00365000
*                                                                       00366000
**********************************************************************  00367000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00368000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00369000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00370000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00371000
*     UPDATE STATEMENT TO MATCH.                                        00372000
**********************************************************************  00373000
*                                                                       00374000
SQL#0007 DS    0H                                                       00375000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00376000
         LA    15,255                  SET RETURN CODE                  00377000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00378000
         BR    14                      RETURN TO CALLER                 00379000
         LTORG                                                          00380000
*                                                                       00381000
*                                                                       00382000
**********************************************************************  00383000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00384000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00385000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00386000
*     THE ACTUAL ROW.                                                   00387000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00388000
**********************************************************************  00389000
*                                                                       00390000
SQL#0008 DS    0H                                                       00391000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00392000
         EXEC  SQL                                                     *00393000
               FETCH S00UPD0                                           *00394000
                 INTO :AUDDATE,                                        *00395000
                   :AUDTIME,                                           *00396000
                   :AUDUSER,                                           *00397000
                   :AUDORG,                                            *00398000
                   :ACCTLIMT,                                          *00399000
                   :CUSTLIMT,                                          *00400000
                   :EXPRDAY,                                           *00401000
                   :AINCOPT,                                           *00402000
                   :SECSVOPT,                                          *00403000
                   :VALIDOPT,                                          *00404000
                   :MAXRETDY,                                          *00405000
                   :MAXEXTN,                                           *00406000
                   :RATEOPT,                                           *00407000
                   :ENTPROPT,                                          *00408000
                   :ENTPINST,                                          *00409000
                   :DUPINCOP,                                          *00410000
                   :DUPINRUL,                                          *00411000
                   :MAXMODEL,                                          *00412000
                   :MAXACCTS,                                          *00413000
                   :EVHSTOPT,                                          *00414000
                   :EVHSTDYS                                            00415000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00416000
         BALR  4,5                     MOVE INTO RECORD AREA            00417000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00418000
         BR    14                      RETURN TO CALLER                 00419000
         LTORG                                                          00420000
*                                                                       00421000
*                                                                       00422000
**********************************************************************  00423000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00424000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00425000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00426000
*     THE ACTUAL ROW.                                                   00427000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00428000
**********************************************************************  00429000
*                                                                       00430000
SQL#0009 DS    0H                                                       00431000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00432000
         LA    15,255                  SET RETURN CODE                  00433000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00434000
         BR    14                      RETURN TO CALLER                 00435000
         LTORG                                                          00436000
*                                                                       00437000
*                                                                       00438000
**********************************************************************  00439000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00440000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00441000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00442000
*     THE ACTUAL ROW.                                                   00443000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00444000
**********************************************************************  00445000
*                                                                       00446000
SQL#0010 DS    0H                                                       00447000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00448000
         LA    15,255                  SET RETURN CODE                  00449000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00450000
         BR    14                      RETURN TO CALLER                 00451000
         LTORG                                                          00452000
*                                                                       00453000
*                                                                       00454000
**********************************************************************  00455000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00456000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00457000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00458000
*     THE ACTUAL ROW.                                                   00459000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00460000
**********************************************************************  00461000
*                                                                       00462000
SQL#0011 DS    0H                                                       00463000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00464000
         LA    15,255                  SET RETURN CODE                  00465000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00466000
         BR    14                      RETURN TO CALLER                 00467000
         LTORG                                                          00468000
*                                                                       00469000
*                                                                       00470000
**********************************************************************  00471000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00472000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00473000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00474000
*     TO CLOSE THE UPDATE CURSOR.                                       00475000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00476000
**********************************************************************  00477000
*                                                                       00478000
SQL#0012 DS    0H                                                       00479000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00480000
         EXEC  SQL                                                     *00481000
               CLOSE S00UPD0                                            00482000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00483000
         BR    14                      RETURN TO CALLER                 00484000
         LTORG                                                          00485000
*                                                                       00486000
*                                                                       00487000
**********************************************************************  00488000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00489000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00490000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00491000
*     TO CLOSE THE UPDATE CURSOR.                                       00492000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00493000
**********************************************************************  00494000
*                                                                       00495000
SQL#0013 DS    0H                                                       00496000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00497000
         LA    15,255                  SET RETURN CODE                  00498000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00499000
         BR    14                      RETURN TO CALLER                 00500000
         LTORG                                                          00501000
*                                                                       00502000
*                                                                       00503000
**********************************************************************  00504000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00505000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00506000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00507000
*     TO CLOSE THE UPDATE CURSOR.                                       00508000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00509000
**********************************************************************  00510000
*                                                                       00511000
SQL#0014 DS    0H                                                       00512000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00513000
         LA    15,255                  SET RETURN CODE                  00514000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00515000
         BR    14                      RETURN TO CALLER                 00516000
         LTORG                                                          00517000
*                                                                       00518000
*                                                                       00519000
**********************************************************************  00520000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00521000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00522000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00523000
*     TO CLOSE THE UPDATE CURSOR.                                       00524000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00525000
**********************************************************************  00526000
*                                                                       00527000
SQL#0015 DS    0H                                                       00528000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00529000
         LA    15,255                  SET RETURN CODE                  00530000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00531000
         BR    14                      RETURN TO CALLER                 00532000
         LTORG                                                          00533000
*                                                                       00534000
*                                                                       00535000
**********************************************************************  00536000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00537000
* KEY:                                                                  00538000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00539000
*     AND GET-NEXT-LOCK VERBS.                                          00540000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00541000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00542000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00543000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00544000
*     ORDER BY CLAUSE.                                                  00545000
**********************************************************************  00546000
*                                                                       00547000
SQL#0016 DS    0H                                                       00548000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00549000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00550000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00551000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00552000
         EXEC  SQL                                                     *00553000
               DECLARE S00SQ001 CURSOR FOR                             *00554000
               SELECT INST_NBR,                                        *00555000
                   RECORD_NBR,                                         *00556000
                   AUDIT_DATE,                                         *00557000
                   AUDIT_TIME,                                         *00558000
                   AUDIT_USER,                                         *00559000
                   AUDIT_ORG,                                          *00560000
                   ACCT_LIMIT_OPT,                                     *00561000
                   CUST_LIMIT_OPT,                                     *00562000
                   MAX_EXPIRE_DAY,                                     *00563000
                   ADD_INC_OPT,                                        *00564000
                   SEC_SVC_OPT,                                        *00565000
                   VALID_OPT,                                          *00566000
                   MAX_RETN_DAYS,                                      *00567000
                   MAX_EXTN,                                           *00568000
                   RATE_OPTION,                                        *00569000
                   ENTERPRISE_OPT,                                     *00570000
                   ENTERPRISE_INST,                                    *00571000
                   DUP_INC_OPT,                                        *00572000
                   DUP_INC_RULE,                                       *00573000
                   MODEL_LIMIT,                                        *00574000
                   ACCOUNT_LIMIT,                                      *00575000
                   EVENT_HST_OPT,                                      *00576000
                   EVENT_HST_DAYS                                      *00577000
                 FROM S00                                              *00578000
                 WHERE                                                 *00579000
                    INST_NBR = :INST AND                               *00580000
                    RECORD_NBR >= :RECNBR                              *00581000
                 ORDER BY RECORD_NBR                                   *00582000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00583000
         EXEC  SQL                                                     *00584000
               OPEN S00SQ001                                            00585000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00586000
         BR    14                      RETURN TO CALLER                 00587000
         LTORG                                                          00588000
*                                                                       00589000
*                                                                       00590000
**********************************************************************  00591000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00592000
* KEY 1:                                                                00593000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00594000
*     AND GET-NEXT-LOCK VERBS.                                          00595000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00596000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00597000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00598000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00599000
*     ORDER BY CLAUSE.                                                  00600000
**********************************************************************  00601000
*                                                                       00602000
SQL#0017 DS    0H                                                       00603000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00604000
         LA    15,255                  SET RETURN CODE                  00605000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00606000
         BR    14                      RETURN TO CALLER                 00607000
         LTORG                                                          00608000
*                                                                       00609000
*                                                                       00610000
**********************************************************************  00611000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00612000
* KEY 2:                                                                00613000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00614000
*     AND GET-NEXT-LOCK VERBS.                                          00615000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00616000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00617000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00618000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00619000
*     ORDER BY CLAUSE.                                                  00620000
**********************************************************************  00621000
*                                                                       00622000
SQL#0018 DS    0H                                                       00623000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00624000
         LA    15,255                  SET RETURN CODE                  00625000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00626000
         BR    14                      RETURN TO CALLER                 00627000
         LTORG                                                          00628000
*                                                                       00629000
*                                                                       00630000
**********************************************************************  00631000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00632000
* KEY 3:                                                                00633000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00634000
*     AND GET-NEXT-LOCK VERBS.                                          00635000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00636000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00637000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00638000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00639000
*     ORDER BY CLAUSE.                                                  00640000
**********************************************************************  00641000
*                                                                       00642000
SQL#0019 DS    0H                                                       00643000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00644000
         LA    15,255                  SET RETURN CODE                  00645000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00646000
         BR    14                      RETURN TO CALLER                 00647000
         LTORG                                                          00648000
*                                                                       00649000
*                                                                       00650000
**********************************************************************  00651000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00652000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00653000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00654000
*     RETRIEVE THE ACTUAL ROW.                                          00655000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00656000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00657000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00658000
**********************************************************************  00659000
*                                                                       00660000
SQL#0020 DS    0H                                                       00661000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00662000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00663000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00664000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00665000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00666000
VECT0020 DC    A(SQL#0120)                                              00667000
         DC    A(SQL#0220)                                              00668000
         LTORG                                                          00669000
*                                                                       00670000
SQL#0120 DS    0H                                                       00671000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00672000
         EXEC  SQL                                                     *00673000
               FETCH S00SQ001                                          *00674000
                 INTO :INST,                                           *00675000
                      :RECNBR,                                         *00676000
                      :AUDDATE,                                        *00677000
                      :AUDTIME,                                        *00678000
                      :AUDUSER,                                        *00679000
                      :AUDORG,                                         *00680000
                      :ACCTLIMT,                                       *00681000
                      :CUSTLIMT,                                       *00682000
                      :EXPRDAY,                                        *00683000
                      :AINCOPT,                                        *00684000
                      :SECSVOPT,                                       *00685000
                      :VALIDOPT,                                       *00686000
                      :MAXRETDY,                                       *00687000
                      :MAXEXTN,                                        *00688000
                      :RATEOPT,                                        *00689000
                      :ENTPROPT,                                       *00690000
                      :ENTPINST,                                       *00691000
                      :DUPINCOP,                                       *00692000
                      :DUPINRUL,                                       *00693000
                      :MAXMODEL,                                       *00694000
                      :MAXACCTS,                                       *00695000
                      :EVHSTOPT,                                       *00696000
                      :EVHSTDYS                                         00697000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00698000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00699000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00700000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00701000
         BR    12                      OPEN NEXT CURSOR                 00702000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00703000
         BALR  4,5                     MOVE INTO RECORD AREA            00704000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00705000
         BR    14                      RETURN TO CALLER                 00706000
         LTORG                                                          00707000
*                                                                       00708000
SQL#0220 DS    0H                                                       00709000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00710000
         EXEC  SQL                                                     *00711000
               FETCH S00SQ002                                          *00712000
                 INTO :INST,                                           *00713000
                      :RECNBR,                                         *00714000
                      :AUDDATE,                                        *00715000
                      :AUDTIME,                                        *00716000
                      :AUDUSER,                                        *00717000
                      :AUDORG,                                         *00718000
                      :ACCTLIMT,                                       *00719000
                      :CUSTLIMT,                                       *00720000
                      :EXPRDAY,                                        *00721000
                      :AINCOPT,                                        *00722000
                      :SECSVOPT,                                       *00723000
                      :VALIDOPT,                                       *00724000
                      :MAXRETDY,                                       *00725000
                      :MAXEXTN,                                        *00726000
                      :RATEOPT,                                        *00727000
                      :ENTPROPT,                                       *00728000
                      :ENTPINST,                                       *00729000
                      :DUPINCOP,                                       *00730000
                      :DUPINRUL,                                       *00731000
                      :MAXMODEL,                                       *00732000
                      :MAXACCTS,                                       *00733000
                      :EVHSTOPT,                                       *00734000
                      :EVHSTDYS                                         00735000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00736000
         BALR  4,5                     MOVE INTO RECORD AREA            00737000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00738000
         BR    14                      RETURN TO CALLER                 00739000
         LTORG                                                          00740000
*                                                                       00741000
*                                                                       00742000
**********************************************************************  00743000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00744000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00745000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00746000
*     RETRIEVE THE ACTUAL ROW.                                          00747000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00748000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00749000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00750000
**********************************************************************  00751000
*                                                                       00752000
SQL#0021 DS    0H                                                       00753000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00754000
         LA    15,255                  SET RETURN CODE                  00755000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00756000
         BR    14                      RETURN TO CALLER                 00757000
         LTORG                                                          00758000
*                                                                       00759000
*                                                                       00760000
**********************************************************************  00761000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           00762000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00763000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00764000
*     RETRIEVE THE ACTUAL ROW.                                          00765000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00766000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00767000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00768000
**********************************************************************  00769000
*                                                                       00770000
SQL#0022 DS    0H                                                       00771000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          00772000
         LA    15,255                  SET RETURN CODE                  00773000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00774000
         BR    14                      RETURN TO CALLER                 00775000
         LTORG                                                          00776000
*                                                                       00777000
*                                                                       00778000
**********************************************************************  00779000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           00780000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00781000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00782000
*     RETRIEVE THE ACTUAL ROW.                                          00783000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00784000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00785000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00786000
**********************************************************************  00787000
*                                                                       00788000
SQL#0023 DS    0H                                                       00789000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          00790000
         LA    15,255                  SET RETURN CODE                  00791000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00792000
         BR    14                      RETURN TO CALLER                 00793000
         LTORG                                                          00794000
*                                                                       00795000
*                                                                       00796000
**********************************************************************  00797000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00798000
* THE PRIMARY KEY:                                                      00799000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00800000
*     VERBS.                                                            00801000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00802000
*     RETRIEVE THE ACTUAL ROW.                                          00803000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00804000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00805000
*     WILL BE THRU THE UPDATE CURSOR.                                   00806000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00807000
**********************************************************************  00808000
*                                                                       00809000
SQL#0024 DS    0H                                                       00810000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          00811000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00812000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    00813000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00814000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00815000
VECT0024 DC    A(SQL#0124)                                              00816000
         DC    A(SQL#0224)                                              00817000
         LTORG                                                          00818000
*                                                                       00819000
SQL#0124 DS    0H                                                       00820000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          00821000
         EXEC  SQL                                                     *00822000
               FETCH S00SQ001                                          *00823000
                 INTO :INST,                                           *00824000
                      :RECNBR                                           00825000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00826000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00827000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00828000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00829000
         BR    12                      OPEN NEXT CURSOR                 00830000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00831000
         BALR  4,5                     MOVE INTO RECORD AREA            00832000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00833000
         BR    14                      RETURN TO CALLER                 00834000
         LTORG                                                          00835000
*                                                                       00836000
SQL#0224 DS    0H                                                       00837000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          00838000
         EXEC  SQL                                                     *00839000
               FETCH S00SQ002                                          *00840000
                 INTO :INST,                                           *00841000
                      :RECNBR                                           00842000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00843000
         BALR  4,5                     MOVE INTO RECORD AREA            00844000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00845000
         BR    14                      RETURN TO CALLER                 00846000
         LTORG                                                          00847000
*                                                                       00848000
*                                                                       00849000
**********************************************************************  00850000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00851000
* ALTERNATE KEY 1:                                                      00852000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00853000
*     VERBS.                                                            00854000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00855000
*     RETRIEVE THE ACTUAL ROW.                                          00856000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00857000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00858000
*     WILL BE THRU THE UPDATE CURSOR.                                   00859000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00860000
**********************************************************************  00861000
*                                                                       00862000
SQL#0025 DS    0H                                                       00863000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          00864000
         LA    15,255                  SET RETURN CODE                  00865000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00866000
         BR    14                      RETURN TO CALLER                 00867000
         LTORG                                                          00868000
*                                                                       00869000
*                                                                       00870000
**********************************************************************  00871000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00872000
* ALTERNATE KEY 2:                                                      00873000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00874000
*     VERBS.                                                            00875000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00876000
*     RETRIEVE THE ACTUAL ROW.                                          00877000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00878000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00879000
*     WILL BE THRU THE UPDATE CURSOR.                                   00880000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00881000
**********************************************************************  00882000
*                                                                       00883000
SQL#0026 DS    0H                                                       00884000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          00885000
         LA    15,255                  SET RETURN CODE                  00886000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00887000
         BR    14                      RETURN TO CALLER                 00888000
         LTORG                                                          00889000
*                                                                       00890000
*                                                                       00891000
**********************************************************************  00892000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00893000
* ALTERNATE KEY 3:                                                      00894000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00895000
*     VERBS.                                                            00896000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00897000
*     RETRIEVE THE ACTUAL ROW.                                          00898000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00899000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00900000
*     WILL BE THRU THE UPDATE CURSOR.                                   00901000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00902000
**********************************************************************  00903000
*                                                                       00904000
SQL#0027 DS    0H                                                       00905000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          00906000
         LA    15,255                  SET RETURN CODE                  00907000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00908000
         BR    14                      RETURN TO CALLER                 00909000
         LTORG                                                          00910000
*                                                                       00911000
*                                                                       00912000
**********************************************************************  00913000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    00914000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00915000
*     AND GET-NEXT-LOCK VERBS.                                          00916000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00917000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00918000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00919000
**********************************************************************  00920000
*                                                                       00921000
SQL#0028 DS    0H                                                       00922000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          00923000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00924000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     00925000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    00926000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       00927000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      00928000
VECT0028 DC    A(SQL#0128)                                              00929000
         DC    A(SQL#0228)                                              00930000
         LTORG                                                          00931000
*                                                                       00932000
SQL#0128 DS    0H                                                       00933000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          00934000
         EXEC  SQL                                                     *00935000
               CLOSE S00SQ001                                           00936000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00937000
         BR    14                      RETURN TO CALLER                 00938000
         LTORG                                                          00939000
*                                                                       00940000
SQL#0228 DS    0H                                                       00941000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          00942000
         EXEC  SQL                                                     *00943000
               CLOSE S00SQ002                                           00944000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00945000
         BR    14                      RETURN TO CALLER                 00946000
         LTORG                                                          00947000
*                                                                       00948000
*                                                                       00949000
**********************************************************************  00950000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                00951000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00952000
*     AND GET-NEXT-LOCK VERBS.                                          00953000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00954000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00955000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00956000
**********************************************************************  00957000
*                                                                       00958000
SQL#0029 DS    0H                                                       00959000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          00960000
         LA    15,255                  SET RETURN CODE                  00961000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00962000
         BR    14                      RETURN TO CALLER                 00963000
         LTORG                                                          00964000
*                                                                       00965000
*                                                                       00966000
**********************************************************************  00967000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                00968000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00969000
*     AND GET-NEXT-LOCK VERBS.                                          00970000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00971000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00972000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00973000
**********************************************************************  00974000
*                                                                       00975000
SQL#0030 DS    0H                                                       00976000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          00977000
         LA    15,255                  SET RETURN CODE                  00978000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00979000
         BR    14                      RETURN TO CALLER                 00980000
         LTORG                                                          00981000
*                                                                       00982000
*                                                                       00983000
**********************************************************************  00984000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                00985000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00986000
*     AND GET-NEXT-LOCK VERBS.                                          00987000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00988000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00989000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00990000
**********************************************************************  00991000
*                                                                       00992000
SQL#0031 DS    0H                                                       00993000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          00994000
         LA    15,255                  SET RETURN CODE                  00995000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00996000
         BR    14                      RETURN TO CALLER                 00997000
         LTORG                                                          00998000
*                                                                       00999000
*                                                                       01000000
**********************************************************************  01001000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01002000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01003000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01004000
**********************************************************************  01005000
*                                                                       01006000
SQL#0032 DS    0H                                                       01007000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01008000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01009000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01010000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01011000
         EXEC  SQL                                                     *01012000
               SELECT INST_NBR,                                        *01013000
                   RECORD_NBR                                          *01014000
                 INTO :INST,                                           *01015000
                   :RECNBR                                             *01016000
                 FROM S00                                              *01017000
                 WHERE INST_NBR = :INST AND                            *01018000
                   RECORD_NBR = :RECNBR                                *01019000
                 FETCH FIRST 1 ROW ONLY                                 01020000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01021000
         BR    14                      RETURN TO CALLER                 01022000
         LTORG                                                          01023000
*                                                                       01024000
*                                                                       01025000
**********************************************************************  01026000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01027000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01028000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01029000
**********************************************************************  01030000
*                                                                       01031000
SQL#0033 DS    0H                                                       01032000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01033000
         LA    15,255                  SET RETURN CODE                  01034000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01035000
         BR    14                      RETURN TO CALLER                 01036000
         LTORG                                                          01037000
*                                                                       01038000
*                                                                       01039000
**********************************************************************  01040000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01041000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01042000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01043000
**********************************************************************  01044000
*                                                                       01045000
SQL#0034 DS    0H                                                       01046000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01047000
         LA    15,255                  SET RETURN CODE                  01048000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01049000
         BR    14                      RETURN TO CALLER                 01050000
         LTORG                                                          01051000
*                                                                       01052000
*                                                                       01053000
**********************************************************************  01054000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01055000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01056000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01057000
**********************************************************************  01058000
*                                                                       01059000
SQL#0035 DS    0H                                                       01060000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01061000
         LA    15,255                  SET RETURN CODE                  01062000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01063000
         BR    14                      RETURN TO CALLER                 01064000
         LTORG                                                          01065000
*                                                                       01066000
*                                                                       01067000
**********************************************************************  01068000
* INSERT STATEMENT:                                                     01069000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01070000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01071000
**********************************************************************  01072000
*                                                                       01073000
SQL#0036 DS    0H                                                       01074000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01075000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01076000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01077000
         EXEC  SQL                                                     *01078000
               INSERT INTO S00                                         *01079000
                   (INST_NBR,                                          *01080000
                    RECORD_NBR,                                        *01081000
                    AUDIT_DATE,                                        *01082000
                    AUDIT_TIME,                                        *01083000
                    AUDIT_USER,                                        *01084000
                    AUDIT_ORG,                                         *01085000
                    ACCT_LIMIT_OPT,                                    *01086000
                    CUST_LIMIT_OPT,                                    *01087000
                    MAX_EXPIRE_DAY,                                    *01088000
                    ADD_INC_OPT,                                       *01089000
                    SEC_SVC_OPT,                                       *01090000
                    VALID_OPT,                                         *01091000
                    MAX_RETN_DAYS,                                     *01092000
                    MAX_EXTN,                                          *01093000
                    RATE_OPTION,                                       *01094000
                    ENTERPRISE_OPT,                                    *01095000
                    ENTERPRISE_INST,                                   *01096000
                    DUP_INC_OPT,                                       *01097000
                    DUP_INC_RULE,                                      *01098000
                    MODEL_LIMIT,                                       *01099000
                    ACCOUNT_LIMIT,                                     *01100000
                    EVENT_HST_OPT,                                     *01101000
                    EVENT_HST_DAYS)                                    *01102000
                  VALUES (:INST,                                       *01103000
                   :RECNBR,                                            *01104000
                   :AUDDATE,                                           *01105000
                   :AUDTIME,                                           *01106000
                   :AUDUSER,                                           *01107000
                   :AUDORG,                                            *01108000
                   :ACCTLIMT,                                          *01109000
                   :CUSTLIMT,                                          *01110000
                   :EXPRDAY,                                           *01111000
                   :AINCOPT,                                           *01112000
                   :SECSVOPT,                                          *01113000
                   :VALIDOPT,                                          *01114000
                   :MAXRETDY,                                          *01115000
                   :MAXEXTN,                                           *01116000
                   :RATEOPT,                                           *01117000
                   :ENTPROPT,                                          *01118000
                   :ENTPINST,                                          *01119000
                   :DUPINCOP,                                          *01120000
                   :DUPINRUL,                                          *01121000
                   :MAXMODEL,                                          *01122000
                   :MAXACCTS,                                          *01123000
                   :EVHSTOPT,                                          *01124000
                   :EVHSTDYS)                                           01125000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01126000
         BR    14                      RETURN TO CALLER                 01127000
         LTORG                                                          01128000
*                                                                       01129000
*                                                                       01130000
**********************************************************************  01131000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01132000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01133000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01134000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01135000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01136000
*     STATEMENT.                                                        01137000
**********************************************************************  01138000
*                                                                       01139000
SQL#0037 DS    0H                                                       01140000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01141000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01142000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01143000
         EXEC  SQL                                                     *01144000
               UPDATE S00                                              *01145000
                   SET AUDIT_DATE = :AUDDATE,                          *01146000
                     AUDIT_TIME = :AUDTIME,                            *01147000
                     AUDIT_USER = :AUDUSER,                            *01148000
                     AUDIT_ORG = :AUDORG,                              *01149000
                     ACCT_LIMIT_OPT = :ACCTLIMT,                       *01150000
                     CUST_LIMIT_OPT = :CUSTLIMT,                       *01151000
                     MAX_EXPIRE_DAY = :EXPRDAY,                        *01152000
                     ADD_INC_OPT = :AINCOPT,                           *01153000
                     SEC_SVC_OPT = :SECSVOPT,                          *01154000
                     VALID_OPT = :VALIDOPT,                            *01155000
                     MAX_RETN_DAYS = :MAXRETDY,                        *01156000
                     MAX_EXTN = :MAXEXTN,                              *01157000
                     RATE_OPTION = :RATEOPT,                           *01158000
                     ENTERPRISE_OPT = :ENTPROPT,                       *01159000
                     ENTERPRISE_INST = :ENTPINST,                      *01160000
                     DUP_INC_OPT = :DUPINCOP,                          *01161000
                     DUP_INC_RULE = :DUPINRUL,                         *01162000
                     MODEL_LIMIT = :MAXMODEL,                          *01163000
                     ACCOUNT_LIMIT = :MAXACCTS,                        *01164000
                     EVENT_HST_OPT = :EVHSTOPT,                        *01165000
                     EVENT_HST_DAYS = :EVHSTDYS                        *01166000
                 WHERE CURRENT OF S00UPD0                               01167000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01168000
         BR    14                      RETURN TO CALLER                 01169000
         LTORG                                                          01170000
*                                                                       01171000
*                                                                       01172000
**********************************************************************  01173000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01174000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01175000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01176000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01177000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01178000
*     STATEMENT.                                                        01179000
**********************************************************************  01180000
*                                                                       01181000
SQL#0038 DS    0H                                                       01182000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01183000
         LA    15,255                  SET RETURN CODE                  01184000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01185000
         BR    14                      RETURN TO CALLER                 01186000
         LTORG                                                          01187000
*                                                                       01188000
*                                                                       01189000
**********************************************************************  01190000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01191000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01192000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01193000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01194000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01195000
*     STATEMENT.                                                        01196000
**********************************************************************  01197000
*                                                                       01198000
SQL#0039 DS    0H                                                       01199000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01200000
         LA    15,255                  SET RETURN CODE                  01201000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01202000
         BR    14                      RETURN TO CALLER                 01203000
         LTORG                                                          01204000
*                                                                       01205000
*                                                                       01206000
**********************************************************************  01207000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01208000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01209000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01210000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01211000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01212000
*     STATEMENT.                                                        01213000
**********************************************************************  01214000
*                                                                       01215000
SQL#0040 DS    0H                                                       01216000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01217000
         LA    15,255                  SET RETURN CODE                  01218000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01219000
         BR    14                      RETURN TO CALLER                 01220000
         LTORG                                                          01221000
*                                                                       01222000
*                                                                       01223000
**********************************************************************  01224000
* DELETE STATEMENT BY PRIMARY KEY:                                      01225000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01226000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01227000
**********************************************************************  01228000
*                                                                       01229000
SQL#0041 DS    0H                                                       01230000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01231000
         EXEC  SQL                                                     *01232000
               DELETE FROM S00                                         *01233000
                 WHERE CURRENT OF S00UPD0                               01234000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01235000
         BR    14                      RETURN TO CALLER                 01236000
         LTORG                                                          01237000
*                                                                       01238000
*                                                                       01239000
**********************************************************************  01240000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01241000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01242000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01243000
**********************************************************************  01244000
*                                                                       01245000
SQL#0042 DS    0H                                                       01246000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01247000
         LA    15,255                  SET RETURN CODE                  01248000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01249000
         BR    14                      RETURN TO CALLER                 01250000
         LTORG                                                          01251000
*                                                                       01252000
*                                                                       01253000
**********************************************************************  01254000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01255000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01256000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01257000
**********************************************************************  01258000
*                                                                       01259000
SQL#0043 DS    0H                                                       01260000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01261000
         LA    15,255                  SET RETURN CODE                  01262000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01263000
         BR    14                      RETURN TO CALLER                 01264000
         LTORG                                                          01265000
*                                                                       01266000
*                                                                       01267000
**********************************************************************  01268000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01269000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01270000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01271000
**********************************************************************  01272000
*                                                                       01273000
SQL#0044 DS    0H                                                       01274000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01275000
         LA    15,255                  SET RETURN CODE                  01276000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01277000
         BR    14                      RETURN TO CALLER                 01278000
         LTORG                                                          01279000
*                                                                       01280000
*                                                                       01281000
**********************************************************************  01282000
* DELETE ALL STATEMENT:                                                 01283000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01284000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01285000
**********************************************************************  01286000
*                                                                       01287000
SQL#0045 DS    0H                                                       01288000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01289000
         EXEC  SQL                                                     *01290000
               DELETE FROM S00                                          01291000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01292000
         BR    14                      RETURN TO CALLER                 01293000
         LTORG                                                          01294000
*                                                                       01295000
*                                                                       01296000
**********************************************************************  01297000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01298000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01299000
**********************************************************************  01300000
*                                                                       01301000
SQL#0046 DS    0H                                                       01302000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01303000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01304000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01305000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01306000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01307000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01308000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01309000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01310000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01311000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01312000
VECT0046 DC    A(0)                                                     01313000
         DC    A(SQL#0246)                                              01314000
         LTORG                                                          01315000
*                                                                       01316000
SQL#0246 DS    0H                                                       01317000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01318000
         EXEC  SQL                                                     *01319000
               CLOSE S00SQ001                                           01320000
         EXEC  SQL                                                     *01321000
               DECLARE S00SQ002 CURSOR FOR                             *01322000
               SELECT INST_NBR,                                        *01323000
                   RECORD_NBR,                                         *01324000
                   AUDIT_DATE,                                         *01325000
                   AUDIT_TIME,                                         *01326000
                   AUDIT_USER,                                         *01327000
                   AUDIT_ORG,                                          *01328000
                   ACCT_LIMIT_OPT,                                     *01329000
                   CUST_LIMIT_OPT,                                     *01330000
                   MAX_EXPIRE_DAY,                                     *01331000
                   ADD_INC_OPT,                                        *01332000
                   SEC_SVC_OPT,                                        *01333000
                   VALID_OPT,                                          *01334000
                   MAX_RETN_DAYS,                                      *01335000
                   MAX_EXTN,                                           *01336000
                   RATE_OPTION,                                        *01337000
                   ENTERPRISE_OPT,                                     *01338000
                   ENTERPRISE_INST,                                    *01339000
                   DUP_INC_OPT,                                        *01340000
                   DUP_INC_RULE,                                       *01341000
                   MODEL_LIMIT,                                        *01342000
                   ACCOUNT_LIMIT,                                      *01343000
                   EVENT_HST_OPT,                                      *01344000
                   EVENT_HST_DAYS                                      *01345000
                 FROM S00                                              *01346000
                 WHERE                                                 *01347000
                    INST_NBR > :INST                                   *01348000
                 ORDER BY INST_NBR,                                    *01349000
                   RECORD_NBR                                          *01350000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01351000
         EXEC  SQL                                                     *01352000
               OPEN S00SQ002                                            01353000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01354000
         BNZ   *+8                     NO - RETURN ERROR                01355000
         LR    12,9                    LOAD RETURN ADDRESS              01356000
         BR    12                      RETURN TO FETCH ROUTINE          01357000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01358000
         BR    14                      RETURN TO CALLER                 01359000
         LTORG                                                          01360000
*                                                                       01361000
*                                                                       01362000
**********************************************************************  01363000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01364000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01365000
**********************************************************************  01366000
*                                                                       01367000
SQL#0047 DS    0H                                                       01368000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01369000
         LA    15,255                  SET RETURN CODE                  01370000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01371000
         BR    14                      RETURN TO CALLER                 01372000
         LTORG                                                          01373000
*                                                                       01374000
*                                                                       01375000
**********************************************************************  01376000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01377000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01378000
**********************************************************************  01379000
*                                                                       01380000
SQL#0048 DS    0H                                                       01381000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01382000
         LA    15,255                  SET RETURN CODE                  01383000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01384000
         BR    14                      RETURN TO CALLER                 01385000
         LTORG                                                          01386000
*                                                                       01387000
*                                                                       01388000
**********************************************************************  01389000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01390000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01391000
**********************************************************************  01392000
*                                                                       01393000
SQL#0049 DS    0H                                                       01394000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01395000
         LA    15,255                  SET RETURN CODE                  01396000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01397000
         BR    14                      RETURN TO CALLER                 01398000
         LTORG                                                          01399000
*                                                                       01400000
         DS    0H                      END OF SQL STATEMENTS            01401000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01402000
*                                                                       01403000
*                                                                       01404000
**********************************************************************  01405000
* DUMMY ENTRY POINT DSNHLI                                              01406000
*   MUST NOT BE MODIFIED.                                               01407000
**********************************************************************  01408000
*                                                                       01409000
         ENTRY DSNHLI                                                   01410000
DSNHLI   DS    0H                                                       01411000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01412000
         BR    15                      BRANCH TO ATTACH FACILITY        01413000
*                                                                       01414000
*                                                                       01415000
**********************************************************************  01416000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01417000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01418000
*   MUST NOT BE MODIFIED.                                               01419000
**********************************************************************  01420000
*                                                                       01421000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01422000
CONV#RTN AMODE ANY                                                      01423000
CONV#RTN RMODE ANY                                                      01424000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01425000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01426000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01427000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01428000
         BER   4                         YES - RETURN TO SQL            01429000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01430000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01431000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01432000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01433000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01434000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01435000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01436000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01437000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01438000
*                                                                       01439000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01440000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01441000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01442000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01443000
         BER   4                         YES - RETURN TO SQL            01444000
         SLR   0,0                     CLEAR FOR INSERT                 01445000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01446000
         NR    0,3                     FOR THE CURRENT KEY?             01447000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01448000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01449000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01450000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01451000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01452000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01453000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01454000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01455000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01456000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01457000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01458000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01459000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01460000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01461000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01462000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01463000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01464000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01465000
*                                                                       01466000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01467000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01468000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01469000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01470000
         BER   4                         YES - RETURN TO SQL            01471000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01472000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01473000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01474000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01475000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01476000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01477000
         MVCL  0,14                    MOVE TO RECORD AREA              01478000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01479000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01480000
*                                                                       01481000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01482000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01483000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01484000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01485000
         BER   4                         YES - RETURN TO SQL            01486000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01487000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01488000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01489000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01490000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01491000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01492000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01493000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01494000
         MVCL  0,14                    MOVE TO RECORD AREA              01495000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01496000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01497000
*                                                                       01498000
*                                                                       01499000
**********************************************************************  01500000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01501000
*   MUST NOT BE MODIFIED.                                               01502000
**********************************************************************  01503000
*                                                                       01504000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01505000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01506000
         DC    H'0008'                 LENGTH TO MOVE                   01507000
         DC    X'80'                   80 = KEY 0 FIELD                 01508000
*                                      40 = KEY 1 FIELD                 01509000
*                                      20 = KEY 2 FIELD                 01510000
*                                      10 = KEY 3 FIELD                 01511000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        01512000
*                                                                       01513000
*                                      REST OF FIELD ENTRIES            01514000
         DC    H'0008',H'0008',H'0054',X'00',X'00'                      01515000
         DC    8X'FF'                  END OF FIELD ENTRIES             01516000
         LTORG                                                          01517000
         END                                                            01518000
