**********************************************************************  00001000
*                                                                       00002000
*  S14RDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/25/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S14 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
RATETABL DS    CL6                                                      00052000
TERM     DS    CL5                                                      00053000
AUDDATE  DS    PL5'0.'                                                  00054000
AUDTIME  DS    PL5'0.'                                                  00055000
AUDUSER  DS    CL8                                                      00056000
AUDORG   DS    CL6                                                      00057000
RATEAMT1 DS    PL5'0.'                                                  00058000
RATEPCT1 DS    PL5'0.000000000'                                         00059000
RATEAMT2 DS    PL5'0.'                                                  00060000
RATEPCT2 DS    PL5'0.000000000'                                         00061000
RATEAMT3 DS    PL5'0.'                                                  00062000
RATEPCT3 DS    PL5'0.000000000'                                         00063000
RATEAMT4 DS    PL5'0.'                                                  00064000
RATEPCT4 DS    PL5'0.000000000'                                         00065000
RATEAMT5 DS    PL5'0.'                                                  00066000
RATEPCT5 DS    PL5'0.000000000'                                         00067000
RATEAMT6 DS    PL5'0.'                                                  00068000
RATEPCT6 DS    PL5'0.000000000'                                         00069000
RATEAMT7 DS    PL5'0.'                                                  00070000
RATEPCT7 DS    PL5'0.000000000'                                         00071000
RATEAMT8 DS    PL5'0.'                                                  00072000
RATEPCT8 DS    PL5'0.000000000'                                         00073000
RATEAMT9 DS    PL5'0.'                                                  00074000
RATEPCT9 DS    PL5'0.000000000'                                         00075000
RATEAT10 DS    PL5'0.'                                                  00076000
RATEPT10 DS    PL5'0.000000000'                                         00077000
RATEAT11 DS    PL5'0.'                                                  00078000
RATEPT11 DS    PL5'0.000000000'                                         00079000
RATEAT12 DS    PL5'0.'                                                  00080000
RATEPT12 DS    PL5'0.000000000'                                         00081000
RATEAT13 DS    PL5'0.'                                                  00082000
RATEPT13 DS    PL5'0.000000000'                                         00083000
RATEAT14 DS    PL5'0.'                                                  00084000
RATEPT14 DS    PL5'0.000000000'                                         00085000
RATEAT15 DS    PL5'0.'                                                  00086000
RATEPT15 DS    PL5'0.000000000'                                         00087000
*                                                                       00088000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00089000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00090000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00091000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00092000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00093000
         DS    CL97                    RESERVED                         00094000
*                                                                       00095000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00096000
INDVARX  DS    0H                                                       00097000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00098000
*                                                                       00099000
*                                                                       00100000
**********************************************************************  00101000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00102000
**********************************************************************  00103000
*                                                                       00104000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00105000
*                                                                       00106000
**********************************************************************  00107000
* PROGRAM TABLE HEADER SECTION:                                         00108000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00109000
**********************************************************************  00110000
*                                                                       00111000
S14RDB   CSECT                         PROGRAM TABLE SECTION            00112000
S14RDB   AMODE ANY                                                      00113000
S14RDB   RMODE ANY                                                      00114000
         DC    CL8'S14RDB  '           PROGRAM ID                       00115000
         DC    CL1' '                                                   00116000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00117000
         DC    CL1' '                                                   00118000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00119000
         DC    CL1' '                                                   00120000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00121000
         DC    5A(0)                   RESERVED                         00122000
         DC    AL2(0)                  RESERVED                         00123000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00124000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00125000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00126000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00127000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00128000
         DC    CL29'WWW.INFOR.COM                '                      00128001
*                                                                       00129000
**********************************************************************  00130000
* STATEMENT TABLE SECTION:                                              00131000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00132000
**********************************************************************  00133000
*                                                                       00134000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00135000
STM#TAB  AMODE ANY                                                      00136000
STM#TAB  RMODE ANY                                                      00137000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00138000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00139000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00140000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00141000
         DC    12A(0)                  UDB MODULE VECTORS               00142000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00143000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00144000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00145000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00146000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00147000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00148000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00149000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00150000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00151000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00152000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00153000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00154000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00155000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00156000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00157000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00158000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00159000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00160000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00161000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00162000
         DC    10A(0)                  UDB MODULE VECTORS               00163000
         DC    4X'FF'                                                   00164000
*                                                                       00165000
**********************************************************************  00166000
* SQL STATEMENT SECTION:                                                00167000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00168000
*     TO SUPPORT THIS TABLE.                                            00169000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00170000
*     ARE EQUIVALENT.                                                   00171000
**********************************************************************  00172000
*                                                                       00173000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00174000
SQL#STMT AMODE ANY                                                      00175000
SQL#STMT RMODE ANY                                                      00176000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00177000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00178000
         USING COM#AREA,11             ADDRESS COMMAREA                 00179000
*                                                                       00180000
**********************************************************************  00181000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00182000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00183000
**********************************************************************  00184000
*                                                                       00185000
SELIN0   DS    0H                                                       00186000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00187000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00188000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00189000
         BALR  14,15                   MOVE REQUESTED DATA              00190000
         EXEC  SQL SELECT                                              *00191000
                   AUDIT_DATE,                                         *00192000
                   AUDIT_TIME,                                         *00193000
                   AUDIT_USER,                                         *00194000
                   AUDIT_ORG,                                          *00195000
                   RATE_AMT_1,                                         *00196000
                   RATE_PCT_1,                                         *00197000
                   RATE_AMT_2,                                         *00198000
                   RATE_PCT_2,                                         *00199000
                   RATE_AMT_3,                                         *00200000
                   RATE_PCT_3,                                         *00201000
                   RATE_AMT_4,                                         *00202000
                   RATE_PCT_4,                                         *00203000
                   RATE_AMT_5,                                         *00204000
                   RATE_PCT_5,                                         *00205000
                   RATE_AMT_6,                                         *00206000
                   RATE_PCT_6,                                         *00207000
                   RATE_AMT_7,                                         *00208000
                   RATE_PCT_7,                                         *00209000
                   RATE_AMT_8,                                         *00210000
                   RATE_PCT_8,                                         *00211000
                   RATE_AMT_9,                                         *00212000
                   RATE_PCT_9,                                         *00213000
                   RATE_AMT_10,                                        *00214000
                   RATE_PCT_10,                                        *00215000
                   RATE_AMT_11,                                        *00216000
                   RATE_PCT_11,                                        *00217000
                   RATE_AMT_12,                                        *00218000
                   RATE_PCT_12,                                        *00219000
                   RATE_AMT_13,                                        *00220000
                   RATE_PCT_13,                                        *00221000
                   RATE_AMT_14,                                        *00222000
                   RATE_PCT_14,                                        *00223000
                   RATE_AMT_15,                                        *00224000
                   RATE_PCT_15                                         *00225000
                 INTO                                                  *00226000
                   :AUDDATE,                                           *00227000
                   :AUDTIME,                                           *00228000
                   :AUDUSER,                                           *00229000
                   :AUDORG,                                            *00230000
                   :RATEAMT1,                                          *00231000
                   :RATEPCT1,                                          *00232000
                   :RATEAMT2,                                          *00233000
                   :RATEPCT2,                                          *00234000
                   :RATEAMT3,                                          *00235000
                   :RATEPCT3,                                          *00236000
                   :RATEAMT4,                                          *00237000
                   :RATEPCT4,                                          *00238000
                   :RATEAMT5,                                          *00239000
                   :RATEPCT5,                                          *00240000
                   :RATEAMT6,                                          *00241000
                   :RATEPCT6,                                          *00242000
                   :RATEAMT7,                                          *00243000
                   :RATEPCT7,                                          *00244000
                   :RATEAMT8,                                          *00245000
                   :RATEPCT8,                                          *00246000
                   :RATEAMT9,                                          *00247000
                   :RATEPCT9,                                          *00248000
                   :RATEAT10,                                          *00249000
                   :RATEPT10,                                          *00250000
                   :RATEAT11,                                          *00251000
                   :RATEPT11,                                          *00252000
                   :RATEAT12,                                          *00253000
                   :RATEPT12,                                          *00254000
                   :RATEAT13,                                          *00255000
                   :RATEPT13,                                          *00256000
                   :RATEAT14,                                          *00257000
                   :RATEPT14,                                          *00258000
                   :RATEAT15,                                          *00259000
                   :RATEPT15                                           *00260000
                 FROM S14                                              *00261000
                 WHERE                                                 *00262000
                   INST_NBR = :INST AND                                *00263000
                   RECORD_NBR = :RECNBR AND                            *00264000
                   RATE_TABLE = :RATETABL AND                          *00265000
                   TERM = :TERM                                        *00266000
                 FETCH FIRST 1 ROW ONLY                                 00267000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00268000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00269000
         BALR  14,15                   MOVE REQUESTED DATA              00270000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00271000
         BR    14                      RETURN TO CALLER                 00272000
         LTORG                                                          00273000
*                                                                       00274000
**********************************************************************  00275000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00276000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00277000
**********************************************************************  00278000
*                                                                       00279000
SELKY0   DS    0H                                                       00280000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00281000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00282000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00283000
         BALR  14,15                   MOVE REQUESTED DATA              00284000
         EXEC  SQL SELECT                                              *00285000
                   COUNT(*)                                            *00286000
                 INTO                                                  *00287000
                   :SQWINTHV                                           *00288000
                 FROM S14                                              *00289000
                 WHERE                                                 *00290000
                   INST_NBR = :INST AND                                *00291000
                   RECORD_NBR = :RECNBR AND                            *00292000
                   RATE_TABLE = :RATETABL AND                          *00293000
                   TERM = :TERM                                        *00294000
                 FETCH FIRST 1 ROW ONLY                                 00295000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00296000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00297000
         BNER  14                      NO - RETURN TO CALLER            00298000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00299000
         BNER  14                      YES - RETURN ZERO SQLCODE        00300000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00301000
         BR    14                      RETURN TO CALLER                 00302000
         LTORG                                                          00303000
*                                                                       00304000
**********************************************************************  00305000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00306000
* KEY:                                                                  00307000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00308000
*     AND GET-NEXT-LOCK VERBS.                                          00309000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00310000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00311000
**********************************************************************  00312000
*                                                                       00313000
SELXC0   DS    0H                                                       00314000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00315000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00316000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00317000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00318000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00319000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00320000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00321000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00322000
SELXC0P  DC    A(SELGE001)                                              00323000
         DC    (KY0COLMS-01)A(0)                                        00324000
         DC    A(SELGE002)                                              00325000
         DC    (KY0COLMS-02)A(0)                                        00326000
         DC    A(SELGE003)                                              00327000
         DC    (KY0COLMS-03)A(0)                                        00328000
         DC    A(SELGE004)                                              00329000
         LTORG                                                          00330000
*                                                                       00331000
SELGE001 DS    0H                                                       00332000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00333000
         EXEC  SQL DECLARE S14GE001 CURSOR                             *00334000
               WITH ROWSET POSITIONING                                 *00335000
               FOR SELECT                                              *00336000
                   INST_NBR,                                           *00337000
                   RECORD_NBR,                                         *00338000
                   RATE_TABLE,                                         *00339000
                   TERM,                                               *00340000
                   AUDIT_DATE,                                         *00341000
                   AUDIT_TIME,                                         *00342000
                   AUDIT_USER,                                         *00343000
                   AUDIT_ORG,                                          *00344000
                   RATE_AMT_1,                                         *00345000
                   RATE_PCT_1,                                         *00346000
                   RATE_AMT_2,                                         *00347000
                   RATE_PCT_2,                                         *00348000
                   RATE_AMT_3,                                         *00349000
                   RATE_PCT_3,                                         *00350000
                   RATE_AMT_4,                                         *00351000
                   RATE_PCT_4,                                         *00352000
                   RATE_AMT_5,                                         *00353000
                   RATE_PCT_5,                                         *00354000
                   RATE_AMT_6,                                         *00355000
                   RATE_PCT_6,                                         *00356000
                   RATE_AMT_7,                                         *00357000
                   RATE_PCT_7,                                         *00358000
                   RATE_AMT_8,                                         *00359000
                   RATE_PCT_8,                                         *00360000
                   RATE_AMT_9,                                         *00361000
                   RATE_PCT_9,                                         *00362000
                   RATE_AMT_10,                                        *00363000
                   RATE_PCT_10,                                        *00364000
                   RATE_AMT_11,                                        *00365000
                   RATE_PCT_11,                                        *00366000
                   RATE_AMT_12,                                        *00367000
                   RATE_PCT_12,                                        *00368000
                   RATE_AMT_13,                                        *00369000
                   RATE_PCT_13,                                        *00370000
                   RATE_AMT_14,                                        *00371000
                   RATE_PCT_14,                                        *00372000
                   RATE_AMT_15,                                        *00373000
                   RATE_PCT_15                                         *00374000
                 FROM S14                                              *00375000
                 WHERE                                                 *00376000
                   INST_NBR = :INST AND                                *00377000
                   RECORD_NBR = :RECNBR AND                            *00378000
                   RATE_TABLE = :RATETABL AND                          *00379000
                   TERM >=                                             *00380000
                     :TERM                                             *00381000
                 ORDER BY TERM ASC                                     *00382000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00383000
         EXEC  SQL OPEN S14GE001                                        00384000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00385000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00386000
         BR    14                      RETURN TO CALLER                 00387000
         LTORG                                                          00388000
*                                                                       00389000
SELGE002 DS    0H                                                       00390000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00391000
         EXEC  SQL DECLARE S14GE002 CURSOR                             *00392000
               WITH ROWSET POSITIONING                                 *00393000
               FOR SELECT                                              *00394000
                   INST_NBR,                                           *00395000
                   RECORD_NBR,                                         *00396000
                   RATE_TABLE,                                         *00397000
                   TERM,                                               *00398000
                   AUDIT_DATE,                                         *00399000
                   AUDIT_TIME,                                         *00400000
                   AUDIT_USER,                                         *00401000
                   AUDIT_ORG,                                          *00402000
                   RATE_AMT_1,                                         *00403000
                   RATE_PCT_1,                                         *00404000
                   RATE_AMT_2,                                         *00405000
                   RATE_PCT_2,                                         *00406000
                   RATE_AMT_3,                                         *00407000
                   RATE_PCT_3,                                         *00408000
                   RATE_AMT_4,                                         *00409000
                   RATE_PCT_4,                                         *00410000
                   RATE_AMT_5,                                         *00411000
                   RATE_PCT_5,                                         *00412000
                   RATE_AMT_6,                                         *00413000
                   RATE_PCT_6,                                         *00414000
                   RATE_AMT_7,                                         *00415000
                   RATE_PCT_7,                                         *00416000
                   RATE_AMT_8,                                         *00417000
                   RATE_PCT_8,                                         *00418000
                   RATE_AMT_9,                                         *00419000
                   RATE_PCT_9,                                         *00420000
                   RATE_AMT_10,                                        *00421000
                   RATE_PCT_10,                                        *00422000
                   RATE_AMT_11,                                        *00423000
                   RATE_PCT_11,                                        *00424000
                   RATE_AMT_12,                                        *00425000
                   RATE_PCT_12,                                        *00426000
                   RATE_AMT_13,                                        *00427000
                   RATE_PCT_13,                                        *00428000
                   RATE_AMT_14,                                        *00429000
                   RATE_PCT_14,                                        *00430000
                   RATE_AMT_15,                                        *00431000
                   RATE_PCT_15                                         *00432000
                 FROM S14                                              *00433000
                 WHERE                                                 *00434000
                   INST_NBR = :INST AND                                *00435000
                   RECORD_NBR = :RECNBR AND                            *00436000
                   RATE_TABLE >=                                       *00437000
                     :RATETABL                                         *00438000
                 ORDER BY RATE_TABLE ASC,                              *00439000
                   TERM ASC                                            *00440000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00441000
         EXEC  SQL OPEN S14GE002                                        00442000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00443000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00444000
         BR    14                      RETURN TO CALLER                 00445000
         LTORG                                                          00446000
*                                                                       00447000
SELGE003 DS    0H                                                       00448000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00449000
         EXEC  SQL DECLARE S14GE003 CURSOR                             *00450000
               WITH ROWSET POSITIONING                                 *00451000
               FOR SELECT                                              *00452000
                   INST_NBR,                                           *00453000
                   RECORD_NBR,                                         *00454000
                   RATE_TABLE,                                         *00455000
                   TERM,                                               *00456000
                   AUDIT_DATE,                                         *00457000
                   AUDIT_TIME,                                         *00458000
                   AUDIT_USER,                                         *00459000
                   AUDIT_ORG,                                          *00460000
                   RATE_AMT_1,                                         *00461000
                   RATE_PCT_1,                                         *00462000
                   RATE_AMT_2,                                         *00463000
                   RATE_PCT_2,                                         *00464000
                   RATE_AMT_3,                                         *00465000
                   RATE_PCT_3,                                         *00466000
                   RATE_AMT_4,                                         *00467000
                   RATE_PCT_4,                                         *00468000
                   RATE_AMT_5,                                         *00469000
                   RATE_PCT_5,                                         *00470000
                   RATE_AMT_6,                                         *00471000
                   RATE_PCT_6,                                         *00472000
                   RATE_AMT_7,                                         *00473000
                   RATE_PCT_7,                                         *00474000
                   RATE_AMT_8,                                         *00475000
                   RATE_PCT_8,                                         *00476000
                   RATE_AMT_9,                                         *00477000
                   RATE_PCT_9,                                         *00478000
                   RATE_AMT_10,                                        *00479000
                   RATE_PCT_10,                                        *00480000
                   RATE_AMT_11,                                        *00481000
                   RATE_PCT_11,                                        *00482000
                   RATE_AMT_12,                                        *00483000
                   RATE_PCT_12,                                        *00484000
                   RATE_AMT_13,                                        *00485000
                   RATE_PCT_13,                                        *00486000
                   RATE_AMT_14,                                        *00487000
                   RATE_PCT_14,                                        *00488000
                   RATE_AMT_15,                                        *00489000
                   RATE_PCT_15                                         *00490000
                 FROM S14                                              *00491000
                 WHERE                                                 *00492000
                   INST_NBR = :INST AND                                *00493000
                   RECORD_NBR >=                                       *00494000
                     :RECNBR                                           *00495000
                 ORDER BY RECORD_NBR ASC,                              *00496000
                   RATE_TABLE ASC,                                     *00497000
                   TERM ASC                                            *00498000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00499000
         EXEC  SQL OPEN S14GE003                                        00500000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00501000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00502000
         BR    14                      RETURN TO CALLER                 00503000
         LTORG                                                          00504000
*                                                                       00505000
SELGE004 DS    0H                                                       00506000
         USING SELGE004,12             ESTABLISH BASE REGISTER          00507000
         EXEC  SQL DECLARE S14GE004 CURSOR                             *00508000
               WITH ROWSET POSITIONING                                 *00509000
               FOR SELECT                                              *00510000
                   INST_NBR,                                           *00511000
                   RECORD_NBR,                                         *00512000
                   RATE_TABLE,                                         *00513000
                   TERM,                                               *00514000
                   AUDIT_DATE,                                         *00515000
                   AUDIT_TIME,                                         *00516000
                   AUDIT_USER,                                         *00517000
                   AUDIT_ORG,                                          *00518000
                   RATE_AMT_1,                                         *00519000
                   RATE_PCT_1,                                         *00520000
                   RATE_AMT_2,                                         *00521000
                   RATE_PCT_2,                                         *00522000
                   RATE_AMT_3,                                         *00523000
                   RATE_PCT_3,                                         *00524000
                   RATE_AMT_4,                                         *00525000
                   RATE_PCT_4,                                         *00526000
                   RATE_AMT_5,                                         *00527000
                   RATE_PCT_5,                                         *00528000
                   RATE_AMT_6,                                         *00529000
                   RATE_PCT_6,                                         *00530000
                   RATE_AMT_7,                                         *00531000
                   RATE_PCT_7,                                         *00532000
                   RATE_AMT_8,                                         *00533000
                   RATE_PCT_8,                                         *00534000
                   RATE_AMT_9,                                         *00535000
                   RATE_PCT_9,                                         *00536000
                   RATE_AMT_10,                                        *00537000
                   RATE_PCT_10,                                        *00538000
                   RATE_AMT_11,                                        *00539000
                   RATE_PCT_11,                                        *00540000
                   RATE_AMT_12,                                        *00541000
                   RATE_PCT_12,                                        *00542000
                   RATE_AMT_13,                                        *00543000
                   RATE_PCT_13,                                        *00544000
                   RATE_AMT_14,                                        *00545000
                   RATE_PCT_14,                                        *00546000
                   RATE_AMT_15,                                        *00547000
                   RATE_PCT_15                                         *00548000
                 FROM S14                                              *00549000
                 WHERE                                                 *00550000
                   INST_NBR >=                                         *00551000
                     :INST                                             *00552000
                 ORDER BY INST_NBR ASC,                                *00553000
                   RECORD_NBR ASC,                                     *00554000
                   RATE_TABLE ASC,                                     *00555000
                   TERM ASC                                            *00556000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00557000
         EXEC  SQL OPEN S14GE004                                        00558000
         MVC   SQWCSRCA,=A(CLSGE004)   SET CURSOR CLOSE ROUTINE ADDRESS 00559000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00560000
         BR    14                      RETURN TO CALLER                 00561000
         LTORG                                                          00562000
*                                                                       00563000
**********************************************************************  00564000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00565000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00566000
**********************************************************************  00567000
*                                                                       00568000
NXTXC0   DS    0H                                                       00569000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00570000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00571000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00572000
         BALR  14,15                   MOVE REQUESTED DATA              00573000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00574000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00575000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00576000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00577000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00578000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00579000
NXTXC0P  DC    A(0)                                                     00580000
         DC    A(NXTGT002)                                              00581000
         DC    A(NXTGT003)                                              00582000
         DC    A(NXTGT004)                                              00583000
         DC    A(NXTGT099)                                              00584000
         DC    A(NXTGT003)                                              00585000
         DC    A(NXTGT004)                                              00586000
         DC    A(NXTGT099)                                              00587000
         DC    A(NXTGT004)                                              00588000
         DC    A(NXTGT099)                                              00589000
         DC    A(NXTGT099)                                              00590000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00591000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00592000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00593000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00594000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00595000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00596000
         BR    14                      RETURN TO SQI                    00597000
         LTORG                                                          00598000
*                                                                       00599000
NXTGT002 DS    0H                                                       00600000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00601000
         EXEC  SQL DECLARE S14GT002 CURSOR                             *00602000
               WITH ROWSET POSITIONING                                 *00603000
               FOR SELECT                                              *00604000
                   INST_NBR,                                           *00605000
                   RECORD_NBR,                                         *00606000
                   RATE_TABLE,                                         *00607000
                   TERM,                                               *00608000
                   AUDIT_DATE,                                         *00609000
                   AUDIT_TIME,                                         *00610000
                   AUDIT_USER,                                         *00611000
                   AUDIT_ORG,                                          *00612000
                   RATE_AMT_1,                                         *00613000
                   RATE_PCT_1,                                         *00614000
                   RATE_AMT_2,                                         *00615000
                   RATE_PCT_2,                                         *00616000
                   RATE_AMT_3,                                         *00617000
                   RATE_PCT_3,                                         *00618000
                   RATE_AMT_4,                                         *00619000
                   RATE_PCT_4,                                         *00620000
                   RATE_AMT_5,                                         *00621000
                   RATE_PCT_5,                                         *00622000
                   RATE_AMT_6,                                         *00623000
                   RATE_PCT_6,                                         *00624000
                   RATE_AMT_7,                                         *00625000
                   RATE_PCT_7,                                         *00626000
                   RATE_AMT_8,                                         *00627000
                   RATE_PCT_8,                                         *00628000
                   RATE_AMT_9,                                         *00629000
                   RATE_PCT_9,                                         *00630000
                   RATE_AMT_10,                                        *00631000
                   RATE_PCT_10,                                        *00632000
                   RATE_AMT_11,                                        *00633000
                   RATE_PCT_11,                                        *00634000
                   RATE_AMT_12,                                        *00635000
                   RATE_PCT_12,                                        *00636000
                   RATE_AMT_13,                                        *00637000
                   RATE_PCT_13,                                        *00638000
                   RATE_AMT_14,                                        *00639000
                   RATE_PCT_14,                                        *00640000
                   RATE_AMT_15,                                        *00641000
                   RATE_PCT_15                                         *00642000
                 FROM S14                                              *00643000
                 WHERE                                                 *00644000
                   INST_NBR = :INST AND                                *00645000
                   RECORD_NBR = :RECNBR AND                            *00646000
                   RATE_TABLE >                                        *00647000
                     :RATETABL                                         *00648000
                 ORDER BY RATE_TABLE ASC,                              *00649000
                   TERM ASC                                            *00650000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00651000
         EXEC  SQL OPEN S14GT002                                        00652000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00653000
         BNZ   *+14                    NO - RETURN ERROR                00654000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 00655000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00656000
         BR    12                      RETURN TO FETCH ROUTINE          00657000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00658000
         BR    14                      RETURN TO CALLER                 00659000
         LTORG                                                          00660000
*                                                                       00661000
NXTGT003 DS    0H                                                       00662000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          00663000
         EXEC  SQL DECLARE S14GT003 CURSOR                             *00664000
               WITH ROWSET POSITIONING                                 *00665000
               FOR SELECT                                              *00666000
                   INST_NBR,                                           *00667000
                   RECORD_NBR,                                         *00668000
                   RATE_TABLE,                                         *00669000
                   TERM,                                               *00670000
                   AUDIT_DATE,                                         *00671000
                   AUDIT_TIME,                                         *00672000
                   AUDIT_USER,                                         *00673000
                   AUDIT_ORG,                                          *00674000
                   RATE_AMT_1,                                         *00675000
                   RATE_PCT_1,                                         *00676000
                   RATE_AMT_2,                                         *00677000
                   RATE_PCT_2,                                         *00678000
                   RATE_AMT_3,                                         *00679000
                   RATE_PCT_3,                                         *00680000
                   RATE_AMT_4,                                         *00681000
                   RATE_PCT_4,                                         *00682000
                   RATE_AMT_5,                                         *00683000
                   RATE_PCT_5,                                         *00684000
                   RATE_AMT_6,                                         *00685000
                   RATE_PCT_6,                                         *00686000
                   RATE_AMT_7,                                         *00687000
                   RATE_PCT_7,                                         *00688000
                   RATE_AMT_8,                                         *00689000
                   RATE_PCT_8,                                         *00690000
                   RATE_AMT_9,                                         *00691000
                   RATE_PCT_9,                                         *00692000
                   RATE_AMT_10,                                        *00693000
                   RATE_PCT_10,                                        *00694000
                   RATE_AMT_11,                                        *00695000
                   RATE_PCT_11,                                        *00696000
                   RATE_AMT_12,                                        *00697000
                   RATE_PCT_12,                                        *00698000
                   RATE_AMT_13,                                        *00699000
                   RATE_PCT_13,                                        *00700000
                   RATE_AMT_14,                                        *00701000
                   RATE_PCT_14,                                        *00702000
                   RATE_AMT_15,                                        *00703000
                   RATE_PCT_15                                         *00704000
                 FROM S14                                              *00705000
                 WHERE                                                 *00706000
                   INST_NBR = :INST AND                                *00707000
                   RECORD_NBR >                                        *00708000
                     :RECNBR                                           *00709000
                 ORDER BY RECORD_NBR ASC,                              *00710000
                   RATE_TABLE ASC,                                     *00711000
                   TERM ASC                                            *00712000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00713000
         EXEC  SQL OPEN S14GT003                                        00714000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00715000
         BNZ   *+14                    NO - RETURN ERROR                00716000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 00717000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00718000
         BR    12                      RETURN TO FETCH ROUTINE          00719000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00720000
         BR    14                      RETURN TO CALLER                 00721000
         LTORG                                                          00722000
*                                                                       00723000
NXTGT004 DS    0H                                                       00724000
         USING NXTGT004,12             ESTABLISH BASE REGISTER          00725000
         EXEC  SQL DECLARE S14GT004 CURSOR                             *00726000
               WITH ROWSET POSITIONING                                 *00727000
               FOR SELECT                                              *00728000
                   INST_NBR,                                           *00729000
                   RECORD_NBR,                                         *00730000
                   RATE_TABLE,                                         *00731000
                   TERM,                                               *00732000
                   AUDIT_DATE,                                         *00733000
                   AUDIT_TIME,                                         *00734000
                   AUDIT_USER,                                         *00735000
                   AUDIT_ORG,                                          *00736000
                   RATE_AMT_1,                                         *00737000
                   RATE_PCT_1,                                         *00738000
                   RATE_AMT_2,                                         *00739000
                   RATE_PCT_2,                                         *00740000
                   RATE_AMT_3,                                         *00741000
                   RATE_PCT_3,                                         *00742000
                   RATE_AMT_4,                                         *00743000
                   RATE_PCT_4,                                         *00744000
                   RATE_AMT_5,                                         *00745000
                   RATE_PCT_5,                                         *00746000
                   RATE_AMT_6,                                         *00747000
                   RATE_PCT_6,                                         *00748000
                   RATE_AMT_7,                                         *00749000
                   RATE_PCT_7,                                         *00750000
                   RATE_AMT_8,                                         *00751000
                   RATE_PCT_8,                                         *00752000
                   RATE_AMT_9,                                         *00753000
                   RATE_PCT_9,                                         *00754000
                   RATE_AMT_10,                                        *00755000
                   RATE_PCT_10,                                        *00756000
                   RATE_AMT_11,                                        *00757000
                   RATE_PCT_11,                                        *00758000
                   RATE_AMT_12,                                        *00759000
                   RATE_PCT_12,                                        *00760000
                   RATE_AMT_13,                                        *00761000
                   RATE_PCT_13,                                        *00762000
                   RATE_AMT_14,                                        *00763000
                   RATE_PCT_14,                                        *00764000
                   RATE_AMT_15,                                        *00765000
                   RATE_PCT_15                                         *00766000
                 FROM S14                                              *00767000
                 WHERE                                                 *00768000
                   INST_NBR >                                          *00769000
                     :INST                                             *00770000
                 ORDER BY INST_NBR ASC,                                *00771000
                   RECORD_NBR ASC,                                     *00772000
                   RATE_TABLE ASC,                                     *00773000
                   TERM ASC                                            *00774000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00775000
         EXEC  SQL OPEN S14GT004                                        00776000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            00777000
         BNZ   *+14                    NO - RETURN ERROR                00778000
         MVC   SQWCSRCA,=A(CLSGT004)   SET CURSOR CLOSE ROUTINE ADDRESS 00779000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              00780000
         BR    12                      RETURN TO FETCH ROUTINE          00781000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00782000
         BR    14                      RETURN TO CALLER                 00783000
         LTORG                                                          00784000
*                                                                       00785000
**********************************************************************  00786000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00787000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00788000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00789000
*     RETRIEVE THE ACTUAL ROW.                                          00790000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00791000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00792000
**********************************************************************  00793000
*                                                                       00794000
FETDC0   DS    0H                                                       00795000
         USING FETDC0,12               ESTABLISH BASE REGISTER          00796000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       00797000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00798000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       00799000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00800000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    00801000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00802000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00803000
FETDC0P  DC    A(FETGE001)                                              00804000
         DC    A(FETGT002)                                              00805000
         DC    A(FETGT003)                                              00806000
         DC    A(FETGT004)                                              00807000
         DC    A(FETGE002)                                              00808000
         DC    A(FETGT003)                                              00809000
         DC    A(FETGT004)                                              00810000
         DC    A(FETGE003)                                              00811000
         DC    A(FETGT004)                                              00812000
         DC    A(FETGE004)                                              00813000
         DC    A(0)                                                     00814000
         LTORG                                                          00815000
*                                                                       00816000
**********************************************************************  00817000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00818000
* THE PRIMARY KEY:                                                      00819000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00820000
*     VERBS.                                                            00821000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00822000
*     RETRIEVE THE ACTUAL ROW.                                          00823000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00824000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00825000
*     WILL BE THRU THE UPDATE CURSOR.                                   00826000
**********************************************************************  00827000
*                                                                       00828000
FETKC0   DS    0H                                                       00829000
         USING FETKC0,12               ESTABLISH BASE REGISTER          00830000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       00831000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       00832000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           00833000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00834000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    00835000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00836000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00837000
FETKC0P  DC    A(FETGE001)                                              00838000
         DC    A(FETGT002)                                              00839000
         DC    A(FETGT003)                                              00840000
         DC    A(FETGT004)                                              00841000
         DC    A(FETGE002)                                              00842000
         DC    A(FETGT003)                                              00843000
         DC    A(FETGT004)                                              00844000
         DC    A(FETGE003)                                              00845000
         DC    A(FETGT004)                                              00846000
         DC    A(FETGE004)                                              00847000
         DC    A(0)                                                     00848000
         LTORG                                                          00849000
*                                                                       00850000
FETGE001 DS    0H                                                       00851000
         USING FETGE001,12             ESTABLISH BASE REGISTER          00852000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00853000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00854000
         BALR  14,15                   MOVE REQUESTED DATA              00855000
         EXEC  SQL FETCH NEXT ROWSET FROM S14GE001                     *00856000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00857000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00858000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00859000
         BALR  14,15                   MOVE REQUESTED DATA              00860000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00861000
         BR    14                      RETURN TO CALLER                 00862000
         LTORG                                                          00863000
*                                                                       00864000
FETGE002 DS    0H                                                       00865000
         USING FETGE002,12             ESTABLISH BASE REGISTER          00866000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00867000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00868000
         BALR  14,15                   MOVE REQUESTED DATA              00869000
         EXEC  SQL FETCH NEXT ROWSET FROM S14GE002                     *00870000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00871000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00872000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00873000
         BALR  14,15                   MOVE REQUESTED DATA              00874000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00875000
         BR    14                      RETURN TO CALLER                 00876000
         LTORG                                                          00877000
*                                                                       00878000
FETGE003 DS    0H                                                       00879000
         USING FETGE003,12             ESTABLISH BASE REGISTER          00880000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00881000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00882000
         BALR  14,15                   MOVE REQUESTED DATA              00883000
         EXEC  SQL FETCH NEXT ROWSET FROM S14GE003                     *00884000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00885000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00886000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00887000
         BALR  14,15                   MOVE REQUESTED DATA              00888000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00889000
         BR    14                      RETURN TO CALLER                 00890000
         LTORG                                                          00891000
*                                                                       00892000
FETGE004 DS    0H                                                       00893000
         USING FETGE004,12             ESTABLISH BASE REGISTER          00894000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00895000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00896000
         BALR  14,15                   MOVE REQUESTED DATA              00897000
         EXEC  SQL FETCH NEXT ROWSET FROM S14GE004                     *00898000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00899000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00900000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00901000
         BALR  14,15                   MOVE REQUESTED DATA              00902000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00903000
         BR    14                      RETURN TO CALLER                 00904000
         LTORG                                                          00905000
*                                                                       00906000
FETGT002 DS    0H                                                       00907000
         USING FETGT002,12             ESTABLISH BASE REGISTER          00908000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00909000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00910000
         BALR  14,15                   MOVE REQUESTED DATA              00911000
         EXEC  SQL FETCH NEXT ROWSET FROM S14GT002                     *00912000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00913000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00914000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00915000
         BALR  14,15                   MOVE REQUESTED DATA              00916000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00917000
         BR    14                      RETURN TO CALLER                 00918000
         LTORG                                                          00919000
*                                                                       00920000
FETGT003 DS    0H                                                       00921000
         USING FETGT003,12             ESTABLISH BASE REGISTER          00922000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00923000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00924000
         BALR  14,15                   MOVE REQUESTED DATA              00925000
         EXEC  SQL FETCH NEXT ROWSET FROM S14GT003                     *00926000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00927000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00928000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00929000
         BALR  14,15                   MOVE REQUESTED DATA              00930000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00931000
         BR    14                      RETURN TO CALLER                 00932000
         LTORG                                                          00933000
*                                                                       00934000
FETGT004 DS    0H                                                       00935000
         USING FETGT004,12             ESTABLISH BASE REGISTER          00936000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    00937000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00938000
         BALR  14,15                   MOVE REQUESTED DATA              00939000
         EXEC  SQL FETCH NEXT ROWSET FROM S14GT004                     *00940000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             00941000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   00942000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00943000
         BALR  14,15                   MOVE REQUESTED DATA              00944000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00945000
         BR    14                      RETURN TO CALLER                 00946000
         LTORG                                                          00947000
*                                                                       00948000
**********************************************************************  00949000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    00950000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00951000
*     AND GET-NEXT-LOCK VERBS.                                          00952000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00953000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00954000
**********************************************************************  00955000
*                                                                       00956000
CLSXC0   DS    0H                                                       00957000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          00958000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 00959000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  00960000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       00961000
         LTORG                                                          00962000
*                                                                       00963000
CLSGE001 DS    0H                                                       00964000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          00965000
         EXEC  SQL CLOSE S14GE001                                       00966000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00967000
         BR    14                      RETURN TO CALLER                 00968000
         LTORG                                                          00969000
*                                                                       00970000
CLSGE002 DS    0H                                                       00971000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          00972000
         EXEC  SQL CLOSE S14GE002                                       00973000
         L     14,SQW@RET                                               00974000
         BR    14                                                       00975000
         LTORG                                                          00976000
*                                                                       00977000
CLSGE003 DS    0H                                                       00978000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          00979000
         EXEC  SQL CLOSE S14GE003                                       00980000
         L     14,SQW@RET                                               00981000
         BR    14                                                       00982000
         LTORG                                                          00983000
*                                                                       00984000
CLSGE004 DS    0H                                                       00985000
         USING CLSGE004,12             ESTABLISH BASE REGISTER          00986000
         EXEC  SQL CLOSE S14GE004                                       00987000
         L     14,SQW@RET                                               00988000
         BR    14                                                       00989000
         LTORG                                                          00990000
*                                                                       00991000
CLSGT002 DS    0H                                                       00992000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          00993000
         EXEC  SQL CLOSE S14GT002                                       00994000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00995000
         BR    14                      RETURN TO CALLER                 00996000
         LTORG                                                          00997000
*                                                                       00998000
CLSGT003 DS    0H                                                       00999000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          01000000
         EXEC  SQL CLOSE S14GT003                                       01001000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01002000
         BR    14                      RETURN TO CALLER                 01003000
         LTORG                                                          01004000
*                                                                       01005000
CLSGT004 DS    0H                                                       01006000
         USING CLSGT004,12             ESTABLISH BASE REGISTER          01007000
         EXEC  SQL CLOSE S14GT004                                       01008000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01009000
         BR    14                      RETURN TO CALLER                 01010000
         LTORG                                                          01011000
*                                                                       01012000
**********************************************************************  01013000
* ALTERNATE KEY 1 NOT DEFINED                                           01014000
**********************************************************************  01015000
*                                                                       01016000
SELIN1   DS    0H                                                       01017000
SELKY1   DS    0H                                                       01018000
SELXC1   DS    0H                                                       01019000
FETDC1   DS    0H                                                       01020000
FETKC1   DS    0H                                                       01021000
CLSXC1   DS    0H                                                       01022000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 01023000
*                                                                       01024000
**********************************************************************  01025000
* ALTERNATE KEY 2 NOT DEFINED                                           01026000
**********************************************************************  01027000
*                                                                       01028000
SELIN2   DS    0H                                                       01029000
SELKY2   DS    0H                                                       01030000
SELXC2   DS    0H                                                       01031000
FETDC2   DS    0H                                                       01032000
FETKC2   DS    0H                                                       01033000
CLSXC2   DS    0H                                                       01034000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 01035000
*                                                                       01036000
**********************************************************************  01037000
* ALTERNATE KEY 3 NOT DEFINED                                           01038000
**********************************************************************  01039000
*                                                                       01040000
SELIN3   DS    0H                                                       01041000
SELKY3   DS    0H                                                       01042000
SELXC3   DS    0H                                                       01043000
FETDC3   DS    0H                                                       01044000
FETKC3   DS    0H                                                       01045000
CLSXC3   DS    0H                                                       01046000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 01047000
*                                                                       01048000
         DS    0H                      END OF SQL STATEMENTS            01049000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01050000
*                                                                       01051000
**********************************************************************  01052000
* DUMMY ENTRY POINT DSNHLI                                              01053000
**********************************************************************  01054000
*                                                                       01055000
         ENTRY DSNHLI                                                   01056000
DSNHLI   DS    0H                                                       01057000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01058000
         BR    15                      BRANCH TO ATTACH FACILITY        01059000
*                                                                       01060000
**********************************************************************  01061000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01062000
**********************************************************************  01063000
*                                                                       01064000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       01065000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      01066000
* OR:                                                                   01067000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      01068000
* WHERE:                                                                01069000
*   RRRR = RECORD AREA OFFSET                                           01070000
*   VVVV = HOST VARIABLE AREA OFFSET                                    01071000
*   LLLL = HALFWORD LENGTH TO MOVE                                      01072000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       01073000
*   KK   = KEY FIELD MASK:                                              01074000
*            80 = KEY 0 FIELD                                           01075000
*            40 = KEY 1 FIELD                                           01076000
*            20 = KEY 2 FIELD                                           01077000
*            10 = KEY 3 FIELD                                           01078000
*   DD   = DATA FIELD MASK:                                             01079000
*            80 = RECORD FIELD IS PACKED                                01080000
*            40 = HOST VARIABLE IS PACKED                               01081000
*            20 = NULLABLE FIELD                                        01082000
*            01 = DATE FIELD                                            01083000
*            02 = TIME FIELD                                            01084000
*                                                                       01085000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 01086000
         DC    H'0000',H'0000',H'0019',X'80',X'00'                      01087000
         DC    H'0019',H'0019',H'0174',X'00',X'00'                      01088000
         DC    8X'FF'                                                   01089000
*                                                                       01090000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               01091000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  01092000
* OR:                                                                   01093000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  01094000
* WHERE:                                                                01095000
*   RRRR = RECORD AREA OFFSET                                           01096000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     01097000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      01098000
*   TTTT = SQLDA DATA TYPE:                                             01099000
*            452 = CHAR       453 = CHAR NULLABLE                       01100000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    01101000
*            496 = INTEGER    497 = INTEGER NULLABLE                    01102000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   01103000
*                                                                       01104000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      01105000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 01106000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       01107000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    01108000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       01109000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       01110000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       01111000
         DC    AL2(00193)              SUMMATION OF ALL COLUMN LENGTHS  01112000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     01113000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       01114000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       01115000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       01116000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      01117000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        01118000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        01119000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        01120000
CONVDATA DS    0H                                                       01121000
         DC    H'0000',H'0004',H'452'  INST_NBR                         01122000
         DC    H'0004',H'0004',H'452'  RECORD_NBR                       01123000
         DC    H'0008',H'0006',H'452'  RATE_TABLE                       01124000
         DC    H'0014',H'0005',H'452'  TERM                             01125000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   01126000
         DC    H'0019',X'0900',H'484'  AUDIT_DATE                       01127000
         DC    H'0024',X'0900',H'484'  AUDIT_TIME                       01128000
         DC    H'0029',H'0008',H'452'  AUDIT_USER                       01129000
         DC    H'0037',H'0006',H'452'  AUDIT_ORG                        01130000
         DC    H'0043',X'0900',H'484'  RATE_AMT_1                       01131000
         DC    H'0048',X'0909',H'484'  RATE_PCT_1                       01132000
         DC    H'0053',X'0900',H'484'  RATE_AMT_2                       01133000
         DC    H'0058',X'0909',H'484'  RATE_PCT_2                       01134000
         DC    H'0063',X'0900',H'484'  RATE_AMT_3                       01135000
         DC    H'0068',X'0909',H'484'  RATE_PCT_3                       01136000
         DC    H'0073',X'0900',H'484'  RATE_AMT_4                       01137000
         DC    H'0078',X'0909',H'484'  RATE_PCT_4                       01138000
         DC    H'0083',X'0900',H'484'  RATE_AMT_5                       01139000
         DC    H'0088',X'0909',H'484'  RATE_PCT_5                       01140000
         DC    H'0093',X'0900',H'484'  RATE_AMT_6                       01141000
         DC    H'0098',X'0909',H'484'  RATE_PCT_6                       01142000
         DC    H'0103',X'0900',H'484'  RATE_AMT_7                       01143000
         DC    H'0108',X'0909',H'484'  RATE_PCT_7                       01144000
         DC    H'0113',X'0900',H'484'  RATE_AMT_8                       01145000
         DC    H'0118',X'0909',H'484'  RATE_PCT_8                       01146000
         DC    H'0123',X'0900',H'484'  RATE_AMT_9                       01147000
         DC    H'0128',X'0909',H'484'  RATE_PCT_9                       01148000
         DC    H'0133',X'0900',H'484'  RATE_AMT_10                      01149000
         DC    H'0138',X'0909',H'484'  RATE_PCT_10                      01150000
         DC    H'0143',X'0900',H'484'  RATE_AMT_11                      01151000
         DC    H'0148',X'0909',H'484'  RATE_PCT_11                      01152000
         DC    H'0153',X'0900',H'484'  RATE_AMT_12                      01153000
         DC    H'0158',X'0909',H'484'  RATE_PCT_12                      01154000
         DC    H'0163',X'0900',H'484'  RATE_AMT_13                      01155000
         DC    H'0168',X'0909',H'484'  RATE_PCT_13                      01156000
         DC    H'0173',X'0900',H'484'  RATE_AMT_14                      01157000
         DC    H'0178',X'0909',H'484'  RATE_PCT_14                      01158000
         DC    H'0183',X'0900',H'484'  RATE_AMT_15                      01159000
         DC    H'0188',X'0909',H'484'  RATE_PCT_15                      01160000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       01161000
KY0COLMS EQU   00004                   NUMBER OF PRIMARY KEY COLUMNS    01162000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      01163000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      01164000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      01165000
*                                                                       01166000
         LTORG                                                          01167000
         END                                                            01168000
