* REL=SAMIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SAMIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/27/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAM FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL164                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST1    DS    CL4                                                      00038000
PRDCDE1  DS    CL6                                                      00039000
ACCTNBR1 DS    CL18                                                     00040000
EVNTDATE DS    CL8                                                      00041000
INST2    DS    CL4                                                      00042000
PRDCDE2  DS    CL6                                                      00043000
ACCTNBR2 DS    CL18                                                     00044000
MODEL2   DS    CL10                                                     00045000
RECSEQ   DS    CL3                                                      00046000
AUDDATE  DS    PL5'0.'                                                  00047000
AUDTIME  DS    PL5'0.'                                                  00048000
AUDUSER  DS    CL8                                                      00049000
AUDORG   DS    CL6                                                      00050000
EVTCODE  DS    CL2                                                      00051000
SCINCENO DS    CL1                                                      00052000
INCENQ   DS    CL1                                                      00053000
DISCAMT  DS    PL6'0.00'                                                00054000
DISCPCT  DS    PL3'0.00000'                                             00055000
RINCENO  DS    CL1                                                      00056000
RINCENQ  DS    CL1                                                      00057000
RATOPT   DS    CL1                                                      00058000
RATTYP   DS    CL1                                                      00059000
RATEPCT  DS    PL5'0.000000000'                                         00060000
MSGNBR   DS    CL4                                                      00061000
IDNBR    DS    CL18                                                     00062000
MODULE   DS    CL8                                                      00063000
RAREA    DS    CL11                                                     00064000
*                                                                       00065000
*                                                                       00066000
**********************************************************************  00067000
* PROGRAM TABLE HEADER SECTION:                                         00068000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00069000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00070000
**********************************************************************  00071000
*                                                                       00072000
SAMIODB  CSECT                         PROGRAM TABLE SECTION            00073000
SAMIODB  AMODE ANY                                                      00074000
SAMIODB  RMODE ANY                                                      00075000
         DC    CL9'SAMIODB'            PROGRAM ID                       00076000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00077000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00078000
         DC    A(0)                    RESERVED                         00079000
         DC    A(0)                    RESERVED                         00080000
         DC    24CL1' '                RESERVED                         00081000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00082000
*                                                                       00083000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00084000
         DC    CL29'WWW.INFOR.COM                '                      00084001
*                                                                       00085000
*                                                                       00086000
**********************************************************************  00087000
* STATEMENT TABLE SECTION:                                              00088000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00089000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00090000
*   SHOULD NOT BE MODIFIED.                                             00091000
**********************************************************************  00092000
*                                                                       00093000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00094000
STM#TAB  AMODE ANY                                                      00095000
STM#TAB  RMODE ANY                                                      00096000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00097000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00098000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00099000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00100000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00101000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00102000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00103000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00104000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00105000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00106000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00107000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00108000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00109000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00110000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00111000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00112000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00113000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00114000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00115000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00116000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00117000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00118000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00119000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00120000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00121000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00122000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00123000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00124000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00125000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00126000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00127000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00128000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00129000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00130000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00131000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00132000
         DC    A(SQL#0036)             INSERT STATEMENT                 00133000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00134000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00135000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00136000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00137000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00138000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00139000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00140000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00141000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00142000
         DC    4X'FF'                                                   00143000
*                                                                       00144000
*                                                                       00145000
**********************************************************************  00146000
* SQL STATEMENT SECTION:                                                00147000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00148000
*     TO SUPPORT THIS TABLE.                                            00149000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00150000
*     ARE EQUIVALENT.                                                   00151000
**********************************************************************  00152000
*                                                                       00153000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00154000
SQL#STMT AMODE ANY                                                      00155000
SQL#STMT RMODE ANY                                                      00156000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00157000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00158000
         USING COM#AREA,11             ADDRESS COMMAREA                 00159000
*                                                                       00160000
*                                                                       00161000
**********************************************************************  00162000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00163000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00164000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00165000
**********************************************************************  00166000
*                                                                       00167000
SQL#0000 DS    0H                                                       00168000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00169000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00170000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00171000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00172000
         EXEC  SQL                                                     *00173000
               SELECT AUDIT_DATE,                                      *00174000
                   AUDIT_TIME,                                         *00175000
                   AUDIT_USER,                                         *00176000
                   AUDIT_ORG,                                          *00177000
                   EVENT_CODE,                                         *00178000
                   SVC_INCEN_OPT,                                      *00179000
                   SVC_INCEN_QLFY,                                     *00180000
                   DISC_AMT,                                           *00181000
                   DISC_PERCENT,                                       *00182000
                   RATE_INCEN_OPT,                                     *00183000
                   RATE_INCEN_QLFY,                                    *00184000
                   RATE_OPTION,                                        *00185000
                   RATE_TYPE,                                          *00186000
                   RATE_PCT,                                           *00187000
                   MESSAGE_NBR,                                        *00188000
                   IDENT_NBR,                                          *00189000
                   MODULE,                                             *00190000
                   RSV_AREA                                            *00191000
                 INTO :AUDDATE,                                        *00192000
                   :AUDTIME,                                           *00193000
                   :AUDUSER,                                           *00194000
                   :AUDORG,                                            *00195000
                   :EVTCODE,                                           *00196000
                   :SCINCENO,                                          *00197000
                   :INCENQ,                                            *00198000
                   :DISCAMT,                                           *00199000
                   :DISCPCT,                                           *00200000
                   :RINCENO,                                           *00201000
                   :RINCENQ,                                           *00202000
                   :RATOPT,                                            *00203000
                   :RATTYP,                                            *00204000
                   :RATEPCT,                                           *00205000
                   :MSGNBR,                                            *00206000
                   :IDNBR,                                             *00207000
                   :MODULE,                                            *00208000
                   :RAREA                                              *00209000
                 FROM SAM                                              *00210000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00211000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00212000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00213000
                   EVENT_DATE = :EVNTDATE AND                          *00214000
                   ACCT_INST_2 = :INST2 AND                            *00215000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00216000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00217000
                   MODEL_2 = :MODEL2 AND                               *00218000
                   RECORD_SEQ = :RECSEQ                                *00219000
                 FETCH FIRST 1 ROW ONLY                                 00220000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00221000
         BALR  4,5                     MOVE INTO RECORD AREA            00222000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00223000
         BR    14                      RETURN TO CALLER                 00224000
         LTORG                                                          00225000
*                                                                       00226000
*                                                                       00227000
**********************************************************************  00228000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00229000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00230000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00231000
**********************************************************************  00232000
*                                                                       00233000
SQL#0001 DS    0H                                                       00234000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00235000
         LA    15,255                  SET RETURN CODE                  00236000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00237000
         BR    14                      RETURN TO CALLER                 00238000
         LTORG                                                          00239000
*                                                                       00240000
*                                                                       00241000
**********************************************************************  00242000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00243000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00244000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00245000
**********************************************************************  00246000
*                                                                       00247000
SQL#0002 DS    0H                                                       00248000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00249000
         LA    15,255                  SET RETURN CODE                  00250000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00251000
         BR    14                      RETURN TO CALLER                 00252000
         LTORG                                                          00253000
*                                                                       00254000
*                                                                       00255000
**********************************************************************  00256000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00257000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00258000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00259000
**********************************************************************  00260000
*                                                                       00261000
SQL#0003 DS    0H                                                       00262000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00263000
         LA    15,255                  SET RETURN CODE                  00264000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00265000
         BR    14                      RETURN TO CALLER                 00266000
         LTORG                                                          00267000
*                                                                       00268000
*                                                                       00269000
**********************************************************************  00270000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00271000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00272000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00273000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00274000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00275000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00276000
*     UPDATE STATEMENT TO MATCH.                                        00277000
**********************************************************************  00278000
*                                                                       00279000
SQL#0004 DS    0H                                                       00280000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00281000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00282000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00283000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00284000
         EXEC  SQL                                                     *00285000
               DECLARE SAMUPD0 CURSOR FOR                              *00286000
               SELECT AUDIT_DATE,                                      *00287000
                   AUDIT_TIME,                                         *00288000
                   AUDIT_USER,                                         *00289000
                   AUDIT_ORG,                                          *00290000
                   EVENT_CODE,                                         *00291000
                   SVC_INCEN_OPT,                                      *00292000
                   SVC_INCEN_QLFY,                                     *00293000
                   DISC_AMT,                                           *00294000
                   DISC_PERCENT,                                       *00295000
                   RATE_INCEN_OPT,                                     *00296000
                   RATE_INCEN_QLFY,                                    *00297000
                   RATE_OPTION,                                        *00298000
                   RATE_TYPE,                                          *00299000
                   RATE_PCT,                                           *00300000
                   MESSAGE_NBR,                                        *00301000
                   IDENT_NBR,                                          *00302000
                   MODULE,                                             *00303000
                   RSV_AREA                                            *00304000
                 FROM SAM                                              *00305000
                 WHERE ACCT_INST_1 = :INST1 AND                        *00306000
                   PROD_CODE_1 = :PRDCDE1 AND                          *00307000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *00308000
                   EVENT_DATE = :EVNTDATE AND                          *00309000
                   ACCT_INST_2 = :INST2 AND                            *00310000
                   PROD_CODE_2 = :PRDCDE2 AND                          *00311000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *00312000
                   MODEL_2 = :MODEL2 AND                               *00313000
                   RECORD_SEQ = :RECSEQ                                *00314000
                 FOR UPDATE OF AUDIT_DATE,                             *00315000
                   AUDIT_TIME,                                         *00316000
                   AUDIT_USER,                                         *00317000
                   AUDIT_ORG,                                          *00318000
                   EVENT_CODE,                                         *00319000
                   SVC_INCEN_OPT,                                      *00320000
                   SVC_INCEN_QLFY,                                     *00321000
                   DISC_AMT,                                           *00322000
                   DISC_PERCENT,                                       *00323000
                   RATE_INCEN_OPT,                                     *00324000
                   RATE_INCEN_QLFY,                                    *00325000
                   RATE_OPTION,                                        *00326000
                   RATE_TYPE,                                          *00327000
                   RATE_PCT,                                           *00328000
                   MESSAGE_NBR,                                        *00329000
                   IDENT_NBR,                                          *00330000
                   MODULE,                                             *00331000
                   RSV_AREA                                            *00332000
                 FETCH FIRST 1 ROW ONLY                                 00333000
         EXEC  SQL                                                     *00334000
               OPEN SAMUPD0                                             00335000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00336000
         BR    14                      RETURN TO CALLER                 00337000
         LTORG                                                          00338000
*                                                                       00339000
*                                                                       00340000
**********************************************************************  00341000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00342000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00343000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00344000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00345000
*     UPDATE STATEMENT TO MATCH.                                        00346000
**********************************************************************  00347000
*                                                                       00348000
SQL#0005 DS    0H                                                       00349000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00350000
         LA    15,255                  SET RETURN CODE                  00351000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00352000
         BR    14                      RETURN TO CALLER                 00353000
         LTORG                                                          00354000
*                                                                       00355000
*                                                                       00356000
**********************************************************************  00357000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00358000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00359000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00360000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00361000
*     UPDATE STATEMENT TO MATCH.                                        00362000
**********************************************************************  00363000
*                                                                       00364000
SQL#0006 DS    0H                                                       00365000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00366000
         LA    15,255                  SET RETURN CODE                  00367000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00368000
         BR    14                      RETURN TO CALLER                 00369000
         LTORG                                                          00370000
*                                                                       00371000
*                                                                       00372000
**********************************************************************  00373000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00374000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00375000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00376000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00377000
*     UPDATE STATEMENT TO MATCH.                                        00378000
**********************************************************************  00379000
*                                                                       00380000
SQL#0007 DS    0H                                                       00381000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00382000
         LA    15,255                  SET RETURN CODE                  00383000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00384000
         BR    14                      RETURN TO CALLER                 00385000
         LTORG                                                          00386000
*                                                                       00387000
*                                                                       00388000
**********************************************************************  00389000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00390000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00391000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00392000
*     THE ACTUAL ROW.                                                   00393000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00394000
**********************************************************************  00395000
*                                                                       00396000
SQL#0008 DS    0H                                                       00397000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00398000
         EXEC  SQL                                                     *00399000
               FETCH SAMUPD0                                           *00400000
                 INTO :AUDDATE,                                        *00401000
                   :AUDTIME,                                           *00402000
                   :AUDUSER,                                           *00403000
                   :AUDORG,                                            *00404000
                   :EVTCODE,                                           *00405000
                   :SCINCENO,                                          *00406000
                   :INCENQ,                                            *00407000
                   :DISCAMT,                                           *00408000
                   :DISCPCT,                                           *00409000
                   :RINCENO,                                           *00410000
                   :RINCENQ,                                           *00411000
                   :RATOPT,                                            *00412000
                   :RATTYP,                                            *00413000
                   :RATEPCT,                                           *00414000
                   :MSGNBR,                                            *00415000
                   :IDNBR,                                             *00416000
                   :MODULE,                                            *00417000
                   :RAREA                                               00418000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00419000
         BALR  4,5                     MOVE INTO RECORD AREA            00420000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00421000
         BR    14                      RETURN TO CALLER                 00422000
         LTORG                                                          00423000
*                                                                       00424000
*                                                                       00425000
**********************************************************************  00426000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00427000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00428000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00429000
*     THE ACTUAL ROW.                                                   00430000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00431000
**********************************************************************  00432000
*                                                                       00433000
SQL#0009 DS    0H                                                       00434000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00435000
         LA    15,255                  SET RETURN CODE                  00436000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00437000
         BR    14                      RETURN TO CALLER                 00438000
         LTORG                                                          00439000
*                                                                       00440000
*                                                                       00441000
**********************************************************************  00442000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00443000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00444000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00445000
*     THE ACTUAL ROW.                                                   00446000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00447000
**********************************************************************  00448000
*                                                                       00449000
SQL#0010 DS    0H                                                       00450000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00451000
         LA    15,255                  SET RETURN CODE                  00452000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00453000
         BR    14                      RETURN TO CALLER                 00454000
         LTORG                                                          00455000
*                                                                       00456000
*                                                                       00457000
**********************************************************************  00458000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00459000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00460000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00461000
*     THE ACTUAL ROW.                                                   00462000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00463000
**********************************************************************  00464000
*                                                                       00465000
SQL#0011 DS    0H                                                       00466000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00467000
         LA    15,255                  SET RETURN CODE                  00468000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00469000
         BR    14                      RETURN TO CALLER                 00470000
         LTORG                                                          00471000
*                                                                       00472000
*                                                                       00473000
**********************************************************************  00474000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00475000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00476000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00477000
*     TO CLOSE THE UPDATE CURSOR.                                       00478000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00479000
**********************************************************************  00480000
*                                                                       00481000
SQL#0012 DS    0H                                                       00482000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00483000
         EXEC  SQL                                                     *00484000
               CLOSE SAMUPD0                                            00485000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00486000
         BR    14                      RETURN TO CALLER                 00487000
         LTORG                                                          00488000
*                                                                       00489000
*                                                                       00490000
**********************************************************************  00491000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00492000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00493000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00494000
*     TO CLOSE THE UPDATE CURSOR.                                       00495000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00496000
**********************************************************************  00497000
*                                                                       00498000
SQL#0013 DS    0H                                                       00499000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00500000
         LA    15,255                  SET RETURN CODE                  00501000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00502000
         BR    14                      RETURN TO CALLER                 00503000
         LTORG                                                          00504000
*                                                                       00505000
*                                                                       00506000
**********************************************************************  00507000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00508000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00509000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00510000
*     TO CLOSE THE UPDATE CURSOR.                                       00511000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00512000
**********************************************************************  00513000
*                                                                       00514000
SQL#0014 DS    0H                                                       00515000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00516000
         LA    15,255                  SET RETURN CODE                  00517000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00518000
         BR    14                      RETURN TO CALLER                 00519000
         LTORG                                                          00520000
*                                                                       00521000
*                                                                       00522000
**********************************************************************  00523000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00524000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00525000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00526000
*     TO CLOSE THE UPDATE CURSOR.                                       00527000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00528000
**********************************************************************  00529000
*                                                                       00530000
SQL#0015 DS    0H                                                       00531000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00532000
         LA    15,255                  SET RETURN CODE                  00533000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00534000
         BR    14                      RETURN TO CALLER                 00535000
         LTORG                                                          00536000
*                                                                       00537000
*                                                                       00538000
**********************************************************************  00539000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00540000
* KEY:                                                                  00541000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00542000
*     AND GET-NEXT-LOCK VERBS.                                          00543000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00544000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00545000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00546000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00547000
*     ORDER BY CLAUSE.                                                  00548000
**********************************************************************  00549000
*                                                                       00550000
SQL#0016 DS    0H                                                       00551000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00552000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00553000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00554000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00555000
         EXEC  SQL                                                     *00556000
               DECLARE SAMSQ001 CURSOR FOR                             *00557000
               SELECT ACCT_INST_1,                                     *00558000
                   PROD_CODE_1,                                        *00559000
                   ACCT_NBR_1,                                         *00560000
                   EVENT_DATE,                                         *00561000
                   ACCT_INST_2,                                        *00562000
                   PROD_CODE_2,                                        *00563000
                   ACCT_NBR_2,                                         *00564000
                   MODEL_2,                                            *00565000
                   RECORD_SEQ,                                         *00566000
                   AUDIT_DATE,                                         *00567000
                   AUDIT_TIME,                                         *00568000
                   AUDIT_USER,                                         *00569000
                   AUDIT_ORG,                                          *00570000
                   EVENT_CODE,                                         *00571000
                   SVC_INCEN_OPT,                                      *00572000
                   SVC_INCEN_QLFY,                                     *00573000
                   DISC_AMT,                                           *00574000
                   DISC_PERCENT,                                       *00575000
                   RATE_INCEN_OPT,                                     *00576000
                   RATE_INCEN_QLFY,                                    *00577000
                   RATE_OPTION,                                        *00578000
                   RATE_TYPE,                                          *00579000
                   RATE_PCT,                                           *00580000
                   MESSAGE_NBR,                                        *00581000
                   IDENT_NBR,                                          *00582000
                   MODULE,                                             *00583000
                   RSV_AREA                                            *00584000
                 FROM SAM                                              *00585000
                 WHERE                                                 *00586000
                    ACCT_INST_1 = :INST1 AND                           *00587000
                    PROD_CODE_1 = :PRDCDE1 AND                         *00588000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *00589000
                    EVENT_DATE = :EVNTDATE AND                         *00590000
                    ACCT_INST_2 = :INST2 AND                           *00591000
                    PROD_CODE_2 = :PRDCDE2 AND                         *00592000
                    ACCT_NBR_2 = :ACCTNBR2 AND                         *00593000
                    MODEL_2 = :MODEL2 AND                              *00594000
                    RECORD_SEQ >= :RECSEQ                              *00595000
                 ORDER BY RECORD_SEQ                                   *00596000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00597000
         EXEC  SQL                                                     *00598000
               OPEN SAMSQ001                                            00599000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00600000
         BR    14                      RETURN TO CALLER                 00601000
         LTORG                                                          00602000
*                                                                       00603000
*                                                                       00604000
**********************************************************************  00605000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00606000
* KEY 1:                                                                00607000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00608000
*     AND GET-NEXT-LOCK VERBS.                                          00609000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00610000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00611000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00612000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00613000
*     ORDER BY CLAUSE.                                                  00614000
**********************************************************************  00615000
*                                                                       00616000
SQL#0017 DS    0H                                                       00617000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00618000
         LA    15,255                  SET RETURN CODE                  00619000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00620000
         BR    14                      RETURN TO CALLER                 00621000
         LTORG                                                          00622000
*                                                                       00623000
*                                                                       00624000
**********************************************************************  00625000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00626000
* KEY 2:                                                                00627000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00628000
*     AND GET-NEXT-LOCK VERBS.                                          00629000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00630000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00631000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00632000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00633000
*     ORDER BY CLAUSE.                                                  00634000
**********************************************************************  00635000
*                                                                       00636000
SQL#0018 DS    0H                                                       00637000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00638000
         LA    15,255                  SET RETURN CODE                  00639000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00640000
         BR    14                      RETURN TO CALLER                 00641000
         LTORG                                                          00642000
*                                                                       00643000
*                                                                       00644000
**********************************************************************  00645000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00646000
* KEY 3:                                                                00647000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00648000
*     AND GET-NEXT-LOCK VERBS.                                          00649000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00650000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00651000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00652000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00653000
*     ORDER BY CLAUSE.                                                  00654000
**********************************************************************  00655000
*                                                                       00656000
SQL#0019 DS    0H                                                       00657000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00658000
         LA    15,255                  SET RETURN CODE                  00659000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00660000
         BR    14                      RETURN TO CALLER                 00661000
         LTORG                                                          00662000
*                                                                       00663000
*                                                                       00664000
**********************************************************************  00665000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00666000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00667000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00668000
*     RETRIEVE THE ACTUAL ROW.                                          00669000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00670000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00671000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00672000
**********************************************************************  00673000
*                                                                       00674000
SQL#0020 DS    0H                                                       00675000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00676000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00677000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00678000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00679000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00680000
VECT0020 DC    A(SQL#0120)                                              00681000
         DC    A(SQL#0220)                                              00682000
         DC    A(SQL#0320)                                              00683000
         DC    A(SQL#0420)                                              00684000
         DC    A(SQL#0520)                                              00685000
         DC    A(SQL#0620)                                              00686000
         DC    A(SQL#0720)                                              00687000
         DC    A(SQL#0820)                                              00688000
         DC    A(SQL#0920)                                              00689000
         LTORG                                                          00690000
*                                                                       00691000
SQL#0120 DS    0H                                                       00692000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00693000
         EXEC  SQL                                                     *00694000
               FETCH SAMSQ001                                          *00695000
                 INTO :INST1,                                          *00696000
                      :PRDCDE1,                                        *00697000
                      :ACCTNBR1,                                       *00698000
                      :EVNTDATE,                                       *00699000
                      :INST2,                                          *00700000
                      :PRDCDE2,                                        *00701000
                      :ACCTNBR2,                                       *00702000
                      :MODEL2,                                         *00703000
                      :RECSEQ,                                         *00704000
                      :AUDDATE,                                        *00705000
                      :AUDTIME,                                        *00706000
                      :AUDUSER,                                        *00707000
                      :AUDORG,                                         *00708000
                      :EVTCODE,                                        *00709000
                      :SCINCENO,                                       *00710000
                      :INCENQ,                                         *00711000
                      :DISCAMT,                                        *00712000
                      :DISCPCT,                                        *00713000
                      :RINCENO,                                        *00714000
                      :RINCENQ,                                        *00715000
                      :RATOPT,                                         *00716000
                      :RATTYP,                                         *00717000
                      :RATEPCT,                                        *00718000
                      :MSGNBR,                                         *00719000
                      :IDNBR,                                          *00720000
                      :MODULE,                                         *00721000
                      :RAREA                                            00722000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00723000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00724000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00725000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00726000
         BR    12                      OPEN NEXT CURSOR                 00727000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00728000
         BALR  4,5                     MOVE INTO RECORD AREA            00729000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00730000
         BR    14                      RETURN TO CALLER                 00731000
         LTORG                                                          00732000
*                                                                       00733000
SQL#0220 DS    0H                                                       00734000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00735000
         EXEC  SQL                                                     *00736000
               FETCH SAMSQ002                                          *00737000
                 INTO :INST1,                                          *00738000
                      :PRDCDE1,                                        *00739000
                      :ACCTNBR1,                                       *00740000
                      :EVNTDATE,                                       *00741000
                      :INST2,                                          *00742000
                      :PRDCDE2,                                        *00743000
                      :ACCTNBR2,                                       *00744000
                      :MODEL2,                                         *00745000
                      :RECSEQ,                                         *00746000
                      :AUDDATE,                                        *00747000
                      :AUDTIME,                                        *00748000
                      :AUDUSER,                                        *00749000
                      :AUDORG,                                         *00750000
                      :EVTCODE,                                        *00751000
                      :SCINCENO,                                       *00752000
                      :INCENQ,                                         *00753000
                      :DISCAMT,                                        *00754000
                      :DISCPCT,                                        *00755000
                      :RINCENO,                                        *00756000
                      :RINCENQ,                                        *00757000
                      :RATOPT,                                         *00758000
                      :RATTYP,                                         *00759000
                      :RATEPCT,                                        *00760000
                      :MSGNBR,                                         *00761000
                      :IDNBR,                                          *00762000
                      :MODULE,                                         *00763000
                      :RAREA                                            00764000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00765000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00766000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00767000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00768000
         BR    12                      OPEN NEXT CURSOR                 00769000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00770000
         BALR  4,5                     MOVE INTO RECORD AREA            00771000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00772000
         BR    14                      RETURN TO CALLER                 00773000
         LTORG                                                          00774000
*                                                                       00775000
SQL#0320 DS    0H                                                       00776000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00777000
         EXEC  SQL                                                     *00778000
               FETCH SAMSQ003                                          *00779000
                 INTO :INST1,                                          *00780000
                      :PRDCDE1,                                        *00781000
                      :ACCTNBR1,                                       *00782000
                      :EVNTDATE,                                       *00783000
                      :INST2,                                          *00784000
                      :PRDCDE2,                                        *00785000
                      :ACCTNBR2,                                       *00786000
                      :MODEL2,                                         *00787000
                      :RECSEQ,                                         *00788000
                      :AUDDATE,                                        *00789000
                      :AUDTIME,                                        *00790000
                      :AUDUSER,                                        *00791000
                      :AUDORG,                                         *00792000
                      :EVTCODE,                                        *00793000
                      :SCINCENO,                                       *00794000
                      :INCENQ,                                         *00795000
                      :DISCAMT,                                        *00796000
                      :DISCPCT,                                        *00797000
                      :RINCENO,                                        *00798000
                      :RINCENQ,                                        *00799000
                      :RATOPT,                                         *00800000
                      :RATTYP,                                         *00801000
                      :RATEPCT,                                        *00802000
                      :MSGNBR,                                         *00803000
                      :IDNBR,                                          *00804000
                      :MODULE,                                         *00805000
                      :RAREA                                            00806000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00807000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00808000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00809000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00810000
         BR    12                      OPEN NEXT CURSOR                 00811000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00812000
         BALR  4,5                     MOVE INTO RECORD AREA            00813000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00814000
         BR    14                      RETURN TO CALLER                 00815000
         LTORG                                                          00816000
*                                                                       00817000
SQL#0420 DS    0H                                                       00818000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          00819000
         EXEC  SQL                                                     *00820000
               FETCH SAMSQ004                                          *00821000
                 INTO :INST1,                                          *00822000
                      :PRDCDE1,                                        *00823000
                      :ACCTNBR1,                                       *00824000
                      :EVNTDATE,                                       *00825000
                      :INST2,                                          *00826000
                      :PRDCDE2,                                        *00827000
                      :ACCTNBR2,                                       *00828000
                      :MODEL2,                                         *00829000
                      :RECSEQ,                                         *00830000
                      :AUDDATE,                                        *00831000
                      :AUDTIME,                                        *00832000
                      :AUDUSER,                                        *00833000
                      :AUDORG,                                         *00834000
                      :EVTCODE,                                        *00835000
                      :SCINCENO,                                       *00836000
                      :INCENQ,                                         *00837000
                      :DISCAMT,                                        *00838000
                      :DISCPCT,                                        *00839000
                      :RINCENO,                                        *00840000
                      :RINCENQ,                                        *00841000
                      :RATOPT,                                         *00842000
                      :RATTYP,                                         *00843000
                      :RATEPCT,                                        *00844000
                      :MSGNBR,                                         *00845000
                      :IDNBR,                                          *00846000
                      :MODULE,                                         *00847000
                      :RAREA                                            00848000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00849000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00850000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00851000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00852000
         BR    12                      OPEN NEXT CURSOR                 00853000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00854000
         BALR  4,5                     MOVE INTO RECORD AREA            00855000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00856000
         BR    14                      RETURN TO CALLER                 00857000
         LTORG                                                          00858000
*                                                                       00859000
SQL#0520 DS    0H                                                       00860000
         USING SQL#0520,12             ESTABLISH BASE REGISTER          00861000
         EXEC  SQL                                                     *00862000
               FETCH SAMSQ005                                          *00863000
                 INTO :INST1,                                          *00864000
                      :PRDCDE1,                                        *00865000
                      :ACCTNBR1,                                       *00866000
                      :EVNTDATE,                                       *00867000
                      :INST2,                                          *00868000
                      :PRDCDE2,                                        *00869000
                      :ACCTNBR2,                                       *00870000
                      :MODEL2,                                         *00871000
                      :RECSEQ,                                         *00872000
                      :AUDDATE,                                        *00873000
                      :AUDTIME,                                        *00874000
                      :AUDUSER,                                        *00875000
                      :AUDORG,                                         *00876000
                      :EVTCODE,                                        *00877000
                      :SCINCENO,                                       *00878000
                      :INCENQ,                                         *00879000
                      :DISCAMT,                                        *00880000
                      :DISCPCT,                                        *00881000
                      :RINCENO,                                        *00882000
                      :RINCENQ,                                        *00883000
                      :RATOPT,                                         *00884000
                      :RATTYP,                                         *00885000
                      :RATEPCT,                                        *00886000
                      :MSGNBR,                                         *00887000
                      :IDNBR,                                          *00888000
                      :MODULE,                                         *00889000
                      :RAREA                                            00890000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00891000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00892000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00893000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00894000
         BR    12                      OPEN NEXT CURSOR                 00895000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00896000
         BALR  4,5                     MOVE INTO RECORD AREA            00897000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00898000
         BR    14                      RETURN TO CALLER                 00899000
         LTORG                                                          00900000
*                                                                       00901000
SQL#0620 DS    0H                                                       00902000
         USING SQL#0620,12             ESTABLISH BASE REGISTER          00903000
         EXEC  SQL                                                     *00904000
               FETCH SAMSQ006                                          *00905000
                 INTO :INST1,                                          *00906000
                      :PRDCDE1,                                        *00907000
                      :ACCTNBR1,                                       *00908000
                      :EVNTDATE,                                       *00909000
                      :INST2,                                          *00910000
                      :PRDCDE2,                                        *00911000
                      :ACCTNBR2,                                       *00912000
                      :MODEL2,                                         *00913000
                      :RECSEQ,                                         *00914000
                      :AUDDATE,                                        *00915000
                      :AUDTIME,                                        *00916000
                      :AUDUSER,                                        *00917000
                      :AUDORG,                                         *00918000
                      :EVTCODE,                                        *00919000
                      :SCINCENO,                                       *00920000
                      :INCENQ,                                         *00921000
                      :DISCAMT,                                        *00922000
                      :DISCPCT,                                        *00923000
                      :RINCENO,                                        *00924000
                      :RINCENQ,                                        *00925000
                      :RATOPT,                                         *00926000
                      :RATTYP,                                         *00927000
                      :RATEPCT,                                        *00928000
                      :MSGNBR,                                         *00929000
                      :IDNBR,                                          *00930000
                      :MODULE,                                         *00931000
                      :RAREA                                            00932000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00933000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00934000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00935000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00936000
         BR    12                      OPEN NEXT CURSOR                 00937000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00938000
         BALR  4,5                     MOVE INTO RECORD AREA            00939000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00940000
         BR    14                      RETURN TO CALLER                 00941000
         LTORG                                                          00942000
*                                                                       00943000
SQL#0720 DS    0H                                                       00944000
         USING SQL#0720,12             ESTABLISH BASE REGISTER          00945000
         EXEC  SQL                                                     *00946000
               FETCH SAMSQ007                                          *00947000
                 INTO :INST1,                                          *00948000
                      :PRDCDE1,                                        *00949000
                      :ACCTNBR1,                                       *00950000
                      :EVNTDATE,                                       *00951000
                      :INST2,                                          *00952000
                      :PRDCDE2,                                        *00953000
                      :ACCTNBR2,                                       *00954000
                      :MODEL2,                                         *00955000
                      :RECSEQ,                                         *00956000
                      :AUDDATE,                                        *00957000
                      :AUDTIME,                                        *00958000
                      :AUDUSER,                                        *00959000
                      :AUDORG,                                         *00960000
                      :EVTCODE,                                        *00961000
                      :SCINCENO,                                       *00962000
                      :INCENQ,                                         *00963000
                      :DISCAMT,                                        *00964000
                      :DISCPCT,                                        *00965000
                      :RINCENO,                                        *00966000
                      :RINCENQ,                                        *00967000
                      :RATOPT,                                         *00968000
                      :RATTYP,                                         *00969000
                      :RATEPCT,                                        *00970000
                      :MSGNBR,                                         *00971000
                      :IDNBR,                                          *00972000
                      :MODULE,                                         *00973000
                      :RAREA                                            00974000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00975000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00976000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00977000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00978000
         BR    12                      OPEN NEXT CURSOR                 00979000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00980000
         BALR  4,5                     MOVE INTO RECORD AREA            00981000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00982000
         BR    14                      RETURN TO CALLER                 00983000
         LTORG                                                          00984000
*                                                                       00985000
SQL#0820 DS    0H                                                       00986000
         USING SQL#0820,12             ESTABLISH BASE REGISTER          00987000
         EXEC  SQL                                                     *00988000
               FETCH SAMSQ008                                          *00989000
                 INTO :INST1,                                          *00990000
                      :PRDCDE1,                                        *00991000
                      :ACCTNBR1,                                       *00992000
                      :EVNTDATE,                                       *00993000
                      :INST2,                                          *00994000
                      :PRDCDE2,                                        *00995000
                      :ACCTNBR2,                                       *00996000
                      :MODEL2,                                         *00997000
                      :RECSEQ,                                         *00998000
                      :AUDDATE,                                        *00999000
                      :AUDTIME,                                        *01000000
                      :AUDUSER,                                        *01001000
                      :AUDORG,                                         *01002000
                      :EVTCODE,                                        *01003000
                      :SCINCENO,                                       *01004000
                      :INCENQ,                                         *01005000
                      :DISCAMT,                                        *01006000
                      :DISCPCT,                                        *01007000
                      :RINCENO,                                        *01008000
                      :RINCENQ,                                        *01009000
                      :RATOPT,                                         *01010000
                      :RATTYP,                                         *01011000
                      :RATEPCT,                                        *01012000
                      :MSGNBR,                                         *01013000
                      :IDNBR,                                          *01014000
                      :MODULE,                                         *01015000
                      :RAREA                                            01016000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01017000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01018000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01019000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01020000
         BR    12                      OPEN NEXT CURSOR                 01021000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01022000
         BALR  4,5                     MOVE INTO RECORD AREA            01023000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01024000
         BR    14                      RETURN TO CALLER                 01025000
         LTORG                                                          01026000
*                                                                       01027000
SQL#0920 DS    0H                                                       01028000
         USING SQL#0920,12             ESTABLISH BASE REGISTER          01029000
         EXEC  SQL                                                     *01030000
               FETCH SAMSQ009                                          *01031000
                 INTO :INST1,                                          *01032000
                      :PRDCDE1,                                        *01033000
                      :ACCTNBR1,                                       *01034000
                      :EVNTDATE,                                       *01035000
                      :INST2,                                          *01036000
                      :PRDCDE2,                                        *01037000
                      :ACCTNBR2,                                       *01038000
                      :MODEL2,                                         *01039000
                      :RECSEQ,                                         *01040000
                      :AUDDATE,                                        *01041000
                      :AUDTIME,                                        *01042000
                      :AUDUSER,                                        *01043000
                      :AUDORG,                                         *01044000
                      :EVTCODE,                                        *01045000
                      :SCINCENO,                                       *01046000
                      :INCENQ,                                         *01047000
                      :DISCAMT,                                        *01048000
                      :DISCPCT,                                        *01049000
                      :RINCENO,                                        *01050000
                      :RINCENQ,                                        *01051000
                      :RATOPT,                                         *01052000
                      :RATTYP,                                         *01053000
                      :RATEPCT,                                        *01054000
                      :MSGNBR,                                         *01055000
                      :IDNBR,                                          *01056000
                      :MODULE,                                         *01057000
                      :RAREA                                            01058000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01059000
         BALR  4,5                     MOVE INTO RECORD AREA            01060000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01061000
         BR    14                      RETURN TO CALLER                 01062000
         LTORG                                                          01063000
*                                                                       01064000
*                                                                       01065000
**********************************************************************  01066000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01067000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01068000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01069000
*     RETRIEVE THE ACTUAL ROW.                                          01070000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01071000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01072000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01073000
**********************************************************************  01074000
*                                                                       01075000
SQL#0021 DS    0H                                                       01076000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01077000
         LA    15,255                  SET RETURN CODE                  01078000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01079000
         BR    14                      RETURN TO CALLER                 01080000
         LTORG                                                          01081000
*                                                                       01082000
*                                                                       01083000
**********************************************************************  01084000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01085000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01086000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01087000
*     RETRIEVE THE ACTUAL ROW.                                          01088000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01089000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01090000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01091000
**********************************************************************  01092000
*                                                                       01093000
SQL#0022 DS    0H                                                       01094000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01095000
         LA    15,255                  SET RETURN CODE                  01096000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01097000
         BR    14                      RETURN TO CALLER                 01098000
         LTORG                                                          01099000
*                                                                       01100000
*                                                                       01101000
**********************************************************************  01102000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01103000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01104000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01105000
*     RETRIEVE THE ACTUAL ROW.                                          01106000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01107000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01108000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01109000
**********************************************************************  01110000
*                                                                       01111000
SQL#0023 DS    0H                                                       01112000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01113000
         LA    15,255                  SET RETURN CODE                  01114000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01115000
         BR    14                      RETURN TO CALLER                 01116000
         LTORG                                                          01117000
*                                                                       01118000
*                                                                       01119000
**********************************************************************  01120000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01121000
* THE PRIMARY KEY:                                                      01122000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01123000
*     VERBS.                                                            01124000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01125000
*     RETRIEVE THE ACTUAL ROW.                                          01126000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01127000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01128000
*     WILL BE THRU THE UPDATE CURSOR.                                   01129000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01130000
**********************************************************************  01131000
*                                                                       01132000
SQL#0024 DS    0H                                                       01133000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01134000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01135000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01136000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01137000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01138000
VECT0024 DC    A(SQL#0124)                                              01139000
         DC    A(SQL#0224)                                              01140000
         DC    A(SQL#0324)                                              01141000
         DC    A(SQL#0424)                                              01142000
         DC    A(SQL#0524)                                              01143000
         DC    A(SQL#0624)                                              01144000
         DC    A(SQL#0724)                                              01145000
         DC    A(SQL#0824)                                              01146000
         DC    A(SQL#0924)                                              01147000
         LTORG                                                          01148000
*                                                                       01149000
SQL#0124 DS    0H                                                       01150000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01151000
         EXEC  SQL                                                     *01152000
               FETCH SAMSQ001                                          *01153000
                 INTO :INST1,                                          *01154000
                      :PRDCDE1,                                        *01155000
                      :ACCTNBR1,                                       *01156000
                      :EVNTDATE,                                       *01157000
                      :INST2,                                          *01158000
                      :PRDCDE2,                                        *01159000
                      :ACCTNBR2,                                       *01160000
                      :MODEL2,                                         *01161000
                      :RECSEQ                                           01162000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01163000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01164000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01165000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01166000
         BR    12                      OPEN NEXT CURSOR                 01167000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01168000
         BALR  4,5                     MOVE INTO RECORD AREA            01169000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01170000
         BR    14                      RETURN TO CALLER                 01171000
         LTORG                                                          01172000
*                                                                       01173000
SQL#0224 DS    0H                                                       01174000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01175000
         EXEC  SQL                                                     *01176000
               FETCH SAMSQ002                                          *01177000
                 INTO :INST1,                                          *01178000
                      :PRDCDE1,                                        *01179000
                      :ACCTNBR1,                                       *01180000
                      :EVNTDATE,                                       *01181000
                      :INST2,                                          *01182000
                      :PRDCDE2,                                        *01183000
                      :ACCTNBR2,                                       *01184000
                      :MODEL2,                                         *01185000
                      :RECSEQ                                           01186000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01187000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01188000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01189000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01190000
         BR    12                      OPEN NEXT CURSOR                 01191000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01192000
         BALR  4,5                     MOVE INTO RECORD AREA            01193000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01194000
         BR    14                      RETURN TO CALLER                 01195000
         LTORG                                                          01196000
*                                                                       01197000
SQL#0324 DS    0H                                                       01198000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01199000
         EXEC  SQL                                                     *01200000
               FETCH SAMSQ003                                          *01201000
                 INTO :INST1,                                          *01202000
                      :PRDCDE1,                                        *01203000
                      :ACCTNBR1,                                       *01204000
                      :EVNTDATE,                                       *01205000
                      :INST2,                                          *01206000
                      :PRDCDE2,                                        *01207000
                      :ACCTNBR2,                                       *01208000
                      :MODEL2,                                         *01209000
                      :RECSEQ                                           01210000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01211000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01212000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01213000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01214000
         BR    12                      OPEN NEXT CURSOR                 01215000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01216000
         BALR  4,5                     MOVE INTO RECORD AREA            01217000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01218000
         BR    14                      RETURN TO CALLER                 01219000
         LTORG                                                          01220000
*                                                                       01221000
SQL#0424 DS    0H                                                       01222000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          01223000
         EXEC  SQL                                                     *01224000
               FETCH SAMSQ004                                          *01225000
                 INTO :INST1,                                          *01226000
                      :PRDCDE1,                                        *01227000
                      :ACCTNBR1,                                       *01228000
                      :EVNTDATE,                                       *01229000
                      :INST2,                                          *01230000
                      :PRDCDE2,                                        *01231000
                      :ACCTNBR2,                                       *01232000
                      :MODEL2,                                         *01233000
                      :RECSEQ                                           01234000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01235000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01236000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01237000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01238000
         BR    12                      OPEN NEXT CURSOR                 01239000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01240000
         BALR  4,5                     MOVE INTO RECORD AREA            01241000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01242000
         BR    14                      RETURN TO CALLER                 01243000
         LTORG                                                          01244000
*                                                                       01245000
SQL#0524 DS    0H                                                       01246000
         USING SQL#0524,12             ESTABLISH BASE REGISTER          01247000
         EXEC  SQL                                                     *01248000
               FETCH SAMSQ005                                          *01249000
                 INTO :INST1,                                          *01250000
                      :PRDCDE1,                                        *01251000
                      :ACCTNBR1,                                       *01252000
                      :EVNTDATE,                                       *01253000
                      :INST2,                                          *01254000
                      :PRDCDE2,                                        *01255000
                      :ACCTNBR2,                                       *01256000
                      :MODEL2,                                         *01257000
                      :RECSEQ                                           01258000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01259000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01260000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01261000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01262000
         BR    12                      OPEN NEXT CURSOR                 01263000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01264000
         BALR  4,5                     MOVE INTO RECORD AREA            01265000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01266000
         BR    14                      RETURN TO CALLER                 01267000
         LTORG                                                          01268000
*                                                                       01269000
SQL#0624 DS    0H                                                       01270000
         USING SQL#0624,12             ESTABLISH BASE REGISTER          01271000
         EXEC  SQL                                                     *01272000
               FETCH SAMSQ006                                          *01273000
                 INTO :INST1,                                          *01274000
                      :PRDCDE1,                                        *01275000
                      :ACCTNBR1,                                       *01276000
                      :EVNTDATE,                                       *01277000
                      :INST2,                                          *01278000
                      :PRDCDE2,                                        *01279000
                      :ACCTNBR2,                                       *01280000
                      :MODEL2,                                         *01281000
                      :RECSEQ                                           01282000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01283000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01284000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01285000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01286000
         BR    12                      OPEN NEXT CURSOR                 01287000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01288000
         BALR  4,5                     MOVE INTO RECORD AREA            01289000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01290000
         BR    14                      RETURN TO CALLER                 01291000
         LTORG                                                          01292000
*                                                                       01293000
SQL#0724 DS    0H                                                       01294000
         USING SQL#0724,12             ESTABLISH BASE REGISTER          01295000
         EXEC  SQL                                                     *01296000
               FETCH SAMSQ007                                          *01297000
                 INTO :INST1,                                          *01298000
                      :PRDCDE1,                                        *01299000
                      :ACCTNBR1,                                       *01300000
                      :EVNTDATE,                                       *01301000
                      :INST2,                                          *01302000
                      :PRDCDE2,                                        *01303000
                      :ACCTNBR2,                                       *01304000
                      :MODEL2,                                         *01305000
                      :RECSEQ                                           01306000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01307000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01308000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01309000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01310000
         BR    12                      OPEN NEXT CURSOR                 01311000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01312000
         BALR  4,5                     MOVE INTO RECORD AREA            01313000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01314000
         BR    14                      RETURN TO CALLER                 01315000
         LTORG                                                          01316000
*                                                                       01317000
SQL#0824 DS    0H                                                       01318000
         USING SQL#0824,12             ESTABLISH BASE REGISTER          01319000
         EXEC  SQL                                                     *01320000
               FETCH SAMSQ008                                          *01321000
                 INTO :INST1,                                          *01322000
                      :PRDCDE1,                                        *01323000
                      :ACCTNBR1,                                       *01324000
                      :EVNTDATE,                                       *01325000
                      :INST2,                                          *01326000
                      :PRDCDE2,                                        *01327000
                      :ACCTNBR2,                                       *01328000
                      :MODEL2,                                         *01329000
                      :RECSEQ                                           01330000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01331000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01332000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01333000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01334000
         BR    12                      OPEN NEXT CURSOR                 01335000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01336000
         BALR  4,5                     MOVE INTO RECORD AREA            01337000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01338000
         BR    14                      RETURN TO CALLER                 01339000
         LTORG                                                          01340000
*                                                                       01341000
SQL#0924 DS    0H                                                       01342000
         USING SQL#0924,12             ESTABLISH BASE REGISTER          01343000
         EXEC  SQL                                                     *01344000
               FETCH SAMSQ009                                          *01345000
                 INTO :INST1,                                          *01346000
                      :PRDCDE1,                                        *01347000
                      :ACCTNBR1,                                       *01348000
                      :EVNTDATE,                                       *01349000
                      :INST2,                                          *01350000
                      :PRDCDE2,                                        *01351000
                      :ACCTNBR2,                                       *01352000
                      :MODEL2,                                         *01353000
                      :RECSEQ                                           01354000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01355000
         BALR  4,5                     MOVE INTO RECORD AREA            01356000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01357000
         BR    14                      RETURN TO CALLER                 01358000
         LTORG                                                          01359000
*                                                                       01360000
*                                                                       01361000
**********************************************************************  01362000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01363000
* ALTERNATE KEY 1:                                                      01364000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01365000
*     VERBS.                                                            01366000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01367000
*     RETRIEVE THE ACTUAL ROW.                                          01368000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01369000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01370000
*     WILL BE THRU THE UPDATE CURSOR.                                   01371000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01372000
**********************************************************************  01373000
*                                                                       01374000
SQL#0025 DS    0H                                                       01375000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01376000
         LA    15,255                  SET RETURN CODE                  01377000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01378000
         BR    14                      RETURN TO CALLER                 01379000
         LTORG                                                          01380000
*                                                                       01381000
*                                                                       01382000
**********************************************************************  01383000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01384000
* ALTERNATE KEY 2:                                                      01385000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01386000
*     VERBS.                                                            01387000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01388000
*     RETRIEVE THE ACTUAL ROW.                                          01389000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01390000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01391000
*     WILL BE THRU THE UPDATE CURSOR.                                   01392000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01393000
**********************************************************************  01394000
*                                                                       01395000
SQL#0026 DS    0H                                                       01396000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01397000
         LA    15,255                  SET RETURN CODE                  01398000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01399000
         BR    14                      RETURN TO CALLER                 01400000
         LTORG                                                          01401000
*                                                                       01402000
*                                                                       01403000
**********************************************************************  01404000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01405000
* ALTERNATE KEY 3:                                                      01406000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01407000
*     VERBS.                                                            01408000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01409000
*     RETRIEVE THE ACTUAL ROW.                                          01410000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01411000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01412000
*     WILL BE THRU THE UPDATE CURSOR.                                   01413000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01414000
**********************************************************************  01415000
*                                                                       01416000
SQL#0027 DS    0H                                                       01417000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01418000
         LA    15,255                  SET RETURN CODE                  01419000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01420000
         BR    14                      RETURN TO CALLER                 01421000
         LTORG                                                          01422000
*                                                                       01423000
*                                                                       01424000
**********************************************************************  01425000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01426000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01427000
*     AND GET-NEXT-LOCK VERBS.                                          01428000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01429000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01430000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01431000
**********************************************************************  01432000
*                                                                       01433000
SQL#0028 DS    0H                                                       01434000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01435000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01436000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01437000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01438000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01439000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01440000
VECT0028 DC    A(SQL#0128)                                              01441000
         DC    A(SQL#0228)                                              01442000
         DC    A(SQL#0328)                                              01443000
         DC    A(SQL#0428)                                              01444000
         DC    A(SQL#0528)                                              01445000
         DC    A(SQL#0628)                                              01446000
         DC    A(SQL#0728)                                              01447000
         DC    A(SQL#0828)                                              01448000
         DC    A(SQL#0928)                                              01449000
         LTORG                                                          01450000
*                                                                       01451000
SQL#0128 DS    0H                                                       01452000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01453000
         EXEC  SQL                                                     *01454000
               CLOSE SAMSQ001                                           01455000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01456000
         BR    14                      RETURN TO CALLER                 01457000
         LTORG                                                          01458000
*                                                                       01459000
SQL#0228 DS    0H                                                       01460000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01461000
         EXEC  SQL                                                     *01462000
               CLOSE SAMSQ002                                           01463000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01464000
         BR    14                      RETURN TO CALLER                 01465000
         LTORG                                                          01466000
*                                                                       01467000
SQL#0328 DS    0H                                                       01468000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01469000
         EXEC  SQL                                                     *01470000
               CLOSE SAMSQ003                                           01471000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01472000
         BR    14                      RETURN TO CALLER                 01473000
         LTORG                                                          01474000
*                                                                       01475000
SQL#0428 DS    0H                                                       01476000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01477000
         EXEC  SQL                                                     *01478000
               CLOSE SAMSQ004                                           01479000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01480000
         BR    14                      RETURN TO CALLER                 01481000
         LTORG                                                          01482000
*                                                                       01483000
SQL#0528 DS    0H                                                       01484000
         USING SQL#0528,12             ESTABLISH BASE REGISTER          01485000
         EXEC  SQL                                                     *01486000
               CLOSE SAMSQ005                                           01487000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01488000
         BR    14                      RETURN TO CALLER                 01489000
         LTORG                                                          01490000
*                                                                       01491000
SQL#0628 DS    0H                                                       01492000
         USING SQL#0628,12             ESTABLISH BASE REGISTER          01493000
         EXEC  SQL                                                     *01494000
               CLOSE SAMSQ006                                           01495000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01496000
         BR    14                      RETURN TO CALLER                 01497000
         LTORG                                                          01498000
*                                                                       01499000
SQL#0728 DS    0H                                                       01500000
         USING SQL#0728,12             ESTABLISH BASE REGISTER          01501000
         EXEC  SQL                                                     *01502000
               CLOSE SAMSQ007                                           01503000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01504000
         BR    14                      RETURN TO CALLER                 01505000
         LTORG                                                          01506000
*                                                                       01507000
SQL#0828 DS    0H                                                       01508000
         USING SQL#0828,12             ESTABLISH BASE REGISTER          01509000
         EXEC  SQL                                                     *01510000
               CLOSE SAMSQ008                                           01511000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01512000
         BR    14                      RETURN TO CALLER                 01513000
         LTORG                                                          01514000
*                                                                       01515000
SQL#0928 DS    0H                                                       01516000
         USING SQL#0928,12             ESTABLISH BASE REGISTER          01517000
         EXEC  SQL                                                     *01518000
               CLOSE SAMSQ009                                           01519000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01520000
         BR    14                      RETURN TO CALLER                 01521000
         LTORG                                                          01522000
*                                                                       01523000
*                                                                       01524000
**********************************************************************  01525000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01526000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01527000
*     AND GET-NEXT-LOCK VERBS.                                          01528000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01529000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01530000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01531000
**********************************************************************  01532000
*                                                                       01533000
SQL#0029 DS    0H                                                       01534000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01535000
         LA    15,255                  SET RETURN CODE                  01536000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01537000
         BR    14                      RETURN TO CALLER                 01538000
         LTORG                                                          01539000
*                                                                       01540000
*                                                                       01541000
**********************************************************************  01542000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01543000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01544000
*     AND GET-NEXT-LOCK VERBS.                                          01545000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01546000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01547000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01548000
**********************************************************************  01549000
*                                                                       01550000
SQL#0030 DS    0H                                                       01551000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01552000
         LA    15,255                  SET RETURN CODE                  01553000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01554000
         BR    14                      RETURN TO CALLER                 01555000
         LTORG                                                          01556000
*                                                                       01557000
*                                                                       01558000
**********************************************************************  01559000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01560000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01561000
*     AND GET-NEXT-LOCK VERBS.                                          01562000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01563000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01564000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01565000
**********************************************************************  01566000
*                                                                       01567000
SQL#0031 DS    0H                                                       01568000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01569000
         LA    15,255                  SET RETURN CODE                  01570000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01571000
         BR    14                      RETURN TO CALLER                 01572000
         LTORG                                                          01573000
*                                                                       01574000
*                                                                       01575000
**********************************************************************  01576000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01577000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01578000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01579000
**********************************************************************  01580000
*                                                                       01581000
SQL#0032 DS    0H                                                       01582000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01583000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01584000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01585000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01586000
         EXEC  SQL                                                     *01587000
               SELECT ACCT_INST_1,                                     *01588000
                   PROD_CODE_1,                                        *01589000
                   ACCT_NBR_1,                                         *01590000
                   EVENT_DATE,                                         *01591000
                   ACCT_INST_2,                                        *01592000
                   PROD_CODE_2,                                        *01593000
                   ACCT_NBR_2,                                         *01594000
                   MODEL_2,                                            *01595000
                   RECORD_SEQ                                          *01596000
                 INTO :INST1,                                          *01597000
                   :PRDCDE1,                                           *01598000
                   :ACCTNBR1,                                          *01599000
                   :EVNTDATE,                                          *01600000
                   :INST2,                                             *01601000
                   :PRDCDE2,                                           *01602000
                   :ACCTNBR2,                                          *01603000
                   :MODEL2,                                            *01604000
                   :RECSEQ                                             *01605000
                 FROM SAM                                              *01606000
                 WHERE ACCT_INST_1 = :INST1 AND                        *01607000
                   PROD_CODE_1 = :PRDCDE1 AND                          *01608000
                   ACCT_NBR_1 = :ACCTNBR1 AND                          *01609000
                   EVENT_DATE = :EVNTDATE AND                          *01610000
                   ACCT_INST_2 = :INST2 AND                            *01611000
                   PROD_CODE_2 = :PRDCDE2 AND                          *01612000
                   ACCT_NBR_2 = :ACCTNBR2 AND                          *01613000
                   MODEL_2 = :MODEL2 AND                               *01614000
                   RECORD_SEQ = :RECSEQ                                *01615000
                 FETCH FIRST 1 ROW ONLY                                 01616000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01617000
         BR    14                      RETURN TO CALLER                 01618000
         LTORG                                                          01619000
*                                                                       01620000
*                                                                       01621000
**********************************************************************  01622000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01623000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01624000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01625000
**********************************************************************  01626000
*                                                                       01627000
SQL#0033 DS    0H                                                       01628000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01629000
         LA    15,255                  SET RETURN CODE                  01630000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01631000
         BR    14                      RETURN TO CALLER                 01632000
         LTORG                                                          01633000
*                                                                       01634000
*                                                                       01635000
**********************************************************************  01636000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01637000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01638000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01639000
**********************************************************************  01640000
*                                                                       01641000
SQL#0034 DS    0H                                                       01642000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01643000
         LA    15,255                  SET RETURN CODE                  01644000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01645000
         BR    14                      RETURN TO CALLER                 01646000
         LTORG                                                          01647000
*                                                                       01648000
*                                                                       01649000
**********************************************************************  01650000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01651000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01652000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01653000
**********************************************************************  01654000
*                                                                       01655000
SQL#0035 DS    0H                                                       01656000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01657000
         LA    15,255                  SET RETURN CODE                  01658000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01659000
         BR    14                      RETURN TO CALLER                 01660000
         LTORG                                                          01661000
*                                                                       01662000
*                                                                       01663000
**********************************************************************  01664000
* INSERT STATEMENT:                                                     01665000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01666000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01667000
**********************************************************************  01668000
*                                                                       01669000
SQL#0036 DS    0H                                                       01670000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01671000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01672000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01673000
         EXEC  SQL                                                     *01674000
               INSERT INTO SAM                                         *01675000
                   (ACCT_INST_1,                                       *01676000
                    PROD_CODE_1,                                       *01677000
                    ACCT_NBR_1,                                        *01678000
                    EVENT_DATE,                                        *01679000
                    ACCT_INST_2,                                       *01680000
                    PROD_CODE_2,                                       *01681000
                    ACCT_NBR_2,                                        *01682000
                    MODEL_2,                                           *01683000
                    RECORD_SEQ,                                        *01684000
                    AUDIT_DATE,                                        *01685000
                    AUDIT_TIME,                                        *01686000
                    AUDIT_USER,                                        *01687000
                    AUDIT_ORG,                                         *01688000
                    EVENT_CODE,                                        *01689000
                    SVC_INCEN_OPT,                                     *01690000
                    SVC_INCEN_QLFY,                                    *01691000
                    DISC_AMT,                                          *01692000
                    DISC_PERCENT,                                      *01693000
                    RATE_INCEN_OPT,                                    *01694000
                    RATE_INCEN_QLFY,                                   *01695000
                    RATE_OPTION,                                       *01696000
                    RATE_TYPE,                                         *01697000
                    RATE_PCT,                                          *01698000
                    MESSAGE_NBR,                                       *01699000
                    IDENT_NBR,                                         *01700000
                    MODULE,                                            *01701000
                    RSV_AREA)                                          *01702000
                  VALUES (:INST1,                                      *01703000
                   :PRDCDE1,                                           *01704000
                   :ACCTNBR1,                                          *01705000
                   :EVNTDATE,                                          *01706000
                   :INST2,                                             *01707000
                   :PRDCDE2,                                           *01708000
                   :ACCTNBR2,                                          *01709000
                   :MODEL2,                                            *01710000
                   :RECSEQ,                                            *01711000
                   :AUDDATE,                                           *01712000
                   :AUDTIME,                                           *01713000
                   :AUDUSER,                                           *01714000
                   :AUDORG,                                            *01715000
                   :EVTCODE,                                           *01716000
                   :SCINCENO,                                          *01717000
                   :INCENQ,                                            *01718000
                   :DISCAMT,                                           *01719000
                   :DISCPCT,                                           *01720000
                   :RINCENO,                                           *01721000
                   :RINCENQ,                                           *01722000
                   :RATOPT,                                            *01723000
                   :RATTYP,                                            *01724000
                   :RATEPCT,                                           *01725000
                   :MSGNBR,                                            *01726000
                   :IDNBR,                                             *01727000
                   :MODULE,                                            *01728000
                   :RAREA)                                              01729000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01730000
         BR    14                      RETURN TO CALLER                 01731000
         LTORG                                                          01732000
*                                                                       01733000
*                                                                       01734000
**********************************************************************  01735000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01736000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01737000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01738000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01739000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01740000
*     STATEMENT.                                                        01741000
**********************************************************************  01742000
*                                                                       01743000
SQL#0037 DS    0H                                                       01744000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01745000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01746000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01747000
         EXEC  SQL                                                     *01748000
               UPDATE SAM                                              *01749000
                   SET AUDIT_DATE = :AUDDATE,                          *01750000
                     AUDIT_TIME = :AUDTIME,                            *01751000
                     AUDIT_USER = :AUDUSER,                            *01752000
                     AUDIT_ORG = :AUDORG,                              *01753000
                     EVENT_CODE = :EVTCODE,                            *01754000
                     SVC_INCEN_OPT = :SCINCENO,                        *01755000
                     SVC_INCEN_QLFY = :INCENQ,                         *01756000
                     DISC_AMT = :DISCAMT,                              *01757000
                     DISC_PERCENT = :DISCPCT,                          *01758000
                     RATE_INCEN_OPT = :RINCENO,                        *01759000
                     RATE_INCEN_QLFY = :RINCENQ,                       *01760000
                     RATE_OPTION = :RATOPT,                            *01761000
                     RATE_TYPE = :RATTYP,                              *01762000
                     RATE_PCT = :RATEPCT,                              *01763000
                     MESSAGE_NBR = :MSGNBR,                            *01764000
                     IDENT_NBR = :IDNBR,                               *01765000
                     MODULE = :MODULE,                                 *01766000
                     RSV_AREA = :RAREA                                 *01767000
                 WHERE CURRENT OF SAMUPD0                               01768000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01769000
         BR    14                      RETURN TO CALLER                 01770000
         LTORG                                                          01771000
*                                                                       01772000
*                                                                       01773000
**********************************************************************  01774000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01775000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01776000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01777000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01778000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01779000
*     STATEMENT.                                                        01780000
**********************************************************************  01781000
*                                                                       01782000
SQL#0038 DS    0H                                                       01783000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01784000
         LA    15,255                  SET RETURN CODE                  01785000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01786000
         BR    14                      RETURN TO CALLER                 01787000
         LTORG                                                          01788000
*                                                                       01789000
*                                                                       01790000
**********************************************************************  01791000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01792000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01793000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01794000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01795000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01796000
*     STATEMENT.                                                        01797000
**********************************************************************  01798000
*                                                                       01799000
SQL#0039 DS    0H                                                       01800000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01801000
         LA    15,255                  SET RETURN CODE                  01802000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01803000
         BR    14                      RETURN TO CALLER                 01804000
         LTORG                                                          01805000
*                                                                       01806000
*                                                                       01807000
**********************************************************************  01808000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01809000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01810000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01811000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01812000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01813000
*     STATEMENT.                                                        01814000
**********************************************************************  01815000
*                                                                       01816000
SQL#0040 DS    0H                                                       01817000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01818000
         LA    15,255                  SET RETURN CODE                  01819000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01820000
         BR    14                      RETURN TO CALLER                 01821000
         LTORG                                                          01822000
*                                                                       01823000
*                                                                       01824000
**********************************************************************  01825000
* DELETE STATEMENT BY PRIMARY KEY:                                      01826000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01827000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01828000
**********************************************************************  01829000
*                                                                       01830000
SQL#0041 DS    0H                                                       01831000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01832000
         EXEC  SQL                                                     *01833000
               DELETE FROM SAM                                         *01834000
                 WHERE CURRENT OF SAMUPD0                               01835000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01836000
         BR    14                      RETURN TO CALLER                 01837000
         LTORG                                                          01838000
*                                                                       01839000
*                                                                       01840000
**********************************************************************  01841000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01842000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01843000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01844000
**********************************************************************  01845000
*                                                                       01846000
SQL#0042 DS    0H                                                       01847000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01848000
         LA    15,255                  SET RETURN CODE                  01849000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01850000
         BR    14                      RETURN TO CALLER                 01851000
         LTORG                                                          01852000
*                                                                       01853000
*                                                                       01854000
**********************************************************************  01855000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01856000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01857000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01858000
**********************************************************************  01859000
*                                                                       01860000
SQL#0043 DS    0H                                                       01861000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01862000
         LA    15,255                  SET RETURN CODE                  01863000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01864000
         BR    14                      RETURN TO CALLER                 01865000
         LTORG                                                          01866000
*                                                                       01867000
*                                                                       01868000
**********************************************************************  01869000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01870000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01871000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01872000
**********************************************************************  01873000
*                                                                       01874000
SQL#0044 DS    0H                                                       01875000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01876000
         LA    15,255                  SET RETURN CODE                  01877000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01878000
         BR    14                      RETURN TO CALLER                 01879000
         LTORG                                                          01880000
*                                                                       01881000
*                                                                       01882000
**********************************************************************  01883000
* DELETE ALL STATEMENT:                                                 01884000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01885000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01886000
**********************************************************************  01887000
*                                                                       01888000
SQL#0045 DS    0H                                                       01889000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01890000
         EXEC  SQL                                                     *01891000
               DELETE FROM SAM                                          01892000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01893000
         BR    14                      RETURN TO CALLER                 01894000
         LTORG                                                          01895000
*                                                                       01896000
*                                                                       01897000
**********************************************************************  01898000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01899000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01900000
**********************************************************************  01901000
*                                                                       01902000
SQL#0046 DS    0H                                                       01903000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01904000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01905000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01906000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01907000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01908000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01909000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01910000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01911000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01912000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01913000
VECT0046 DC    A(0)                                                     01914000
         DC    A(SQL#0246)                                              01915000
         DC    A(SQL#0346)                                              01916000
         DC    A(SQL#0446)                                              01917000
         DC    A(SQL#0546)                                              01918000
         DC    A(SQL#0646)                                              01919000
         DC    A(SQL#0746)                                              01920000
         DC    A(SQL#0846)                                              01921000
         DC    A(SQL#0946)                                              01922000
         LTORG                                                          01923000
*                                                                       01924000
SQL#0246 DS    0H                                                       01925000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01926000
         EXEC  SQL                                                     *01927000
               CLOSE SAMSQ001                                           01928000
         EXEC  SQL                                                     *01929000
               DECLARE SAMSQ002 CURSOR FOR                             *01930000
               SELECT ACCT_INST_1,                                     *01931000
                   PROD_CODE_1,                                        *01932000
                   ACCT_NBR_1,                                         *01933000
                   EVENT_DATE,                                         *01934000
                   ACCT_INST_2,                                        *01935000
                   PROD_CODE_2,                                        *01936000
                   ACCT_NBR_2,                                         *01937000
                   MODEL_2,                                            *01938000
                   RECORD_SEQ,                                         *01939000
                   AUDIT_DATE,                                         *01940000
                   AUDIT_TIME,                                         *01941000
                   AUDIT_USER,                                         *01942000
                   AUDIT_ORG,                                          *01943000
                   EVENT_CODE,                                         *01944000
                   SVC_INCEN_OPT,                                      *01945000
                   SVC_INCEN_QLFY,                                     *01946000
                   DISC_AMT,                                           *01947000
                   DISC_PERCENT,                                       *01948000
                   RATE_INCEN_OPT,                                     *01949000
                   RATE_INCEN_QLFY,                                    *01950000
                   RATE_OPTION,                                        *01951000
                   RATE_TYPE,                                          *01952000
                   RATE_PCT,                                           *01953000
                   MESSAGE_NBR,                                        *01954000
                   IDENT_NBR,                                          *01955000
                   MODULE,                                             *01956000
                   RSV_AREA                                            *01957000
                 FROM SAM                                              *01958000
                 WHERE                                                 *01959000
                    ACCT_INST_1 = :INST1 AND                           *01960000
                    PROD_CODE_1 = :PRDCDE1 AND                         *01961000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *01962000
                    EVENT_DATE = :EVNTDATE AND                         *01963000
                    ACCT_INST_2 = :INST2 AND                           *01964000
                    PROD_CODE_2 = :PRDCDE2 AND                         *01965000
                    ACCT_NBR_2 = :ACCTNBR2 AND                         *01966000
                    MODEL_2 > :MODEL2                                  *01967000
                 ORDER BY MODEL_2,                                     *01968000
                   RECORD_SEQ                                          *01969000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01970000
         EXEC  SQL                                                     *01971000
               OPEN SAMSQ002                                            01972000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01973000
         BNZ   *+8                     NO - RETURN ERROR                01974000
         LR    12,9                    LOAD RETURN ADDRESS              01975000
         BR    12                      RETURN TO FETCH ROUTINE          01976000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01977000
         BR    14                      RETURN TO CALLER                 01978000
         LTORG                                                          01979000
*                                                                       01980000
SQL#0346 DS    0H                                                       01981000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01982000
         EXEC  SQL                                                     *01983000
               CLOSE SAMSQ002                                           01984000
         EXEC  SQL                                                     *01985000
               DECLARE SAMSQ003 CURSOR FOR                             *01986000
               SELECT ACCT_INST_1,                                     *01987000
                   PROD_CODE_1,                                        *01988000
                   ACCT_NBR_1,                                         *01989000
                   EVENT_DATE,                                         *01990000
                   ACCT_INST_2,                                        *01991000
                   PROD_CODE_2,                                        *01992000
                   ACCT_NBR_2,                                         *01993000
                   MODEL_2,                                            *01994000
                   RECORD_SEQ,                                         *01995000
                   AUDIT_DATE,                                         *01996000
                   AUDIT_TIME,                                         *01997000
                   AUDIT_USER,                                         *01998000
                   AUDIT_ORG,                                          *01999000
                   EVENT_CODE,                                         *02000000
                   SVC_INCEN_OPT,                                      *02001000
                   SVC_INCEN_QLFY,                                     *02002000
                   DISC_AMT,                                           *02003000
                   DISC_PERCENT,                                       *02004000
                   RATE_INCEN_OPT,                                     *02005000
                   RATE_INCEN_QLFY,                                    *02006000
                   RATE_OPTION,                                        *02007000
                   RATE_TYPE,                                          *02008000
                   RATE_PCT,                                           *02009000
                   MESSAGE_NBR,                                        *02010000
                   IDENT_NBR,                                          *02011000
                   MODULE,                                             *02012000
                   RSV_AREA                                            *02013000
                 FROM SAM                                              *02014000
                 WHERE                                                 *02015000
                    ACCT_INST_1 = :INST1 AND                           *02016000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02017000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02018000
                    EVENT_DATE = :EVNTDATE AND                         *02019000
                    ACCT_INST_2 = :INST2 AND                           *02020000
                    PROD_CODE_2 = :PRDCDE2 AND                         *02021000
                    ACCT_NBR_2 > :ACCTNBR2                             *02022000
                 ORDER BY ACCT_NBR_2,                                  *02023000
                   MODEL_2,                                            *02024000
                   RECORD_SEQ                                          *02025000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02026000
         EXEC  SQL                                                     *02027000
               OPEN SAMSQ003                                            02028000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02029000
         BNZ   *+8                     NO - RETURN ERROR                02030000
         LR    12,9                    LOAD RETURN ADDRESS              02031000
         BR    12                      RETURN TO FETCH ROUTINE          02032000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02033000
         BR    14                      RETURN TO CALLER                 02034000
         LTORG                                                          02035000
*                                                                       02036000
SQL#0446 DS    0H                                                       02037000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          02038000
         EXEC  SQL                                                     *02039000
               CLOSE SAMSQ003                                           02040000
         EXEC  SQL                                                     *02041000
               DECLARE SAMSQ004 CURSOR FOR                             *02042000
               SELECT ACCT_INST_1,                                     *02043000
                   PROD_CODE_1,                                        *02044000
                   ACCT_NBR_1,                                         *02045000
                   EVENT_DATE,                                         *02046000
                   ACCT_INST_2,                                        *02047000
                   PROD_CODE_2,                                        *02048000
                   ACCT_NBR_2,                                         *02049000
                   MODEL_2,                                            *02050000
                   RECORD_SEQ,                                         *02051000
                   AUDIT_DATE,                                         *02052000
                   AUDIT_TIME,                                         *02053000
                   AUDIT_USER,                                         *02054000
                   AUDIT_ORG,                                          *02055000
                   EVENT_CODE,                                         *02056000
                   SVC_INCEN_OPT,                                      *02057000
                   SVC_INCEN_QLFY,                                     *02058000
                   DISC_AMT,                                           *02059000
                   DISC_PERCENT,                                       *02060000
                   RATE_INCEN_OPT,                                     *02061000
                   RATE_INCEN_QLFY,                                    *02062000
                   RATE_OPTION,                                        *02063000
                   RATE_TYPE,                                          *02064000
                   RATE_PCT,                                           *02065000
                   MESSAGE_NBR,                                        *02066000
                   IDENT_NBR,                                          *02067000
                   MODULE,                                             *02068000
                   RSV_AREA                                            *02069000
                 FROM SAM                                              *02070000
                 WHERE                                                 *02071000
                    ACCT_INST_1 = :INST1 AND                           *02072000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02073000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02074000
                    EVENT_DATE = :EVNTDATE AND                         *02075000
                    ACCT_INST_2 = :INST2 AND                           *02076000
                    PROD_CODE_2 > :PRDCDE2                             *02077000
                 ORDER BY PROD_CODE_2,                                 *02078000
                   ACCT_NBR_2,                                         *02079000
                   MODEL_2,                                            *02080000
                   RECORD_SEQ                                          *02081000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02082000
         EXEC  SQL                                                     *02083000
               OPEN SAMSQ004                                            02084000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02085000
         BNZ   *+8                     NO - RETURN ERROR                02086000
         LR    12,9                    LOAD RETURN ADDRESS              02087000
         BR    12                      RETURN TO FETCH ROUTINE          02088000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02089000
         BR    14                      RETURN TO CALLER                 02090000
         LTORG                                                          02091000
*                                                                       02092000
SQL#0546 DS    0H                                                       02093000
         USING SQL#0546,12             ESTABLISH BASE REGISTER          02094000
         EXEC  SQL                                                     *02095000
               CLOSE SAMSQ004                                           02096000
         EXEC  SQL                                                     *02097000
               DECLARE SAMSQ005 CURSOR FOR                             *02098000
               SELECT ACCT_INST_1,                                     *02099000
                   PROD_CODE_1,                                        *02100000
                   ACCT_NBR_1,                                         *02101000
                   EVENT_DATE,                                         *02102000
                   ACCT_INST_2,                                        *02103000
                   PROD_CODE_2,                                        *02104000
                   ACCT_NBR_2,                                         *02105000
                   MODEL_2,                                            *02106000
                   RECORD_SEQ,                                         *02107000
                   AUDIT_DATE,                                         *02108000
                   AUDIT_TIME,                                         *02109000
                   AUDIT_USER,                                         *02110000
                   AUDIT_ORG,                                          *02111000
                   EVENT_CODE,                                         *02112000
                   SVC_INCEN_OPT,                                      *02113000
                   SVC_INCEN_QLFY,                                     *02114000
                   DISC_AMT,                                           *02115000
                   DISC_PERCENT,                                       *02116000
                   RATE_INCEN_OPT,                                     *02117000
                   RATE_INCEN_QLFY,                                    *02118000
                   RATE_OPTION,                                        *02119000
                   RATE_TYPE,                                          *02120000
                   RATE_PCT,                                           *02121000
                   MESSAGE_NBR,                                        *02122000
                   IDENT_NBR,                                          *02123000
                   MODULE,                                             *02124000
                   RSV_AREA                                            *02125000
                 FROM SAM                                              *02126000
                 WHERE                                                 *02127000
                    ACCT_INST_1 = :INST1 AND                           *02128000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02129000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02130000
                    EVENT_DATE = :EVNTDATE AND                         *02131000
                    ACCT_INST_2 > :INST2                               *02132000
                 ORDER BY ACCT_INST_2,                                 *02133000
                   PROD_CODE_2,                                        *02134000
                   ACCT_NBR_2,                                         *02135000
                   MODEL_2,                                            *02136000
                   RECORD_SEQ                                          *02137000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02138000
         EXEC  SQL                                                     *02139000
               OPEN SAMSQ005                                            02140000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02141000
         BNZ   *+8                     NO - RETURN ERROR                02142000
         LR    12,9                    LOAD RETURN ADDRESS              02143000
         BR    12                      RETURN TO FETCH ROUTINE          02144000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02145000
         BR    14                      RETURN TO CALLER                 02146000
         LTORG                                                          02147000
*                                                                       02148000
SQL#0646 DS    0H                                                       02149000
         USING SQL#0646,12             ESTABLISH BASE REGISTER          02150000
         EXEC  SQL                                                     *02151000
               CLOSE SAMSQ005                                           02152000
         EXEC  SQL                                                     *02153000
               DECLARE SAMSQ006 CURSOR FOR                             *02154000
               SELECT ACCT_INST_1,                                     *02155000
                   PROD_CODE_1,                                        *02156000
                   ACCT_NBR_1,                                         *02157000
                   EVENT_DATE,                                         *02158000
                   ACCT_INST_2,                                        *02159000
                   PROD_CODE_2,                                        *02160000
                   ACCT_NBR_2,                                         *02161000
                   MODEL_2,                                            *02162000
                   RECORD_SEQ,                                         *02163000
                   AUDIT_DATE,                                         *02164000
                   AUDIT_TIME,                                         *02165000
                   AUDIT_USER,                                         *02166000
                   AUDIT_ORG,                                          *02167000
                   EVENT_CODE,                                         *02168000
                   SVC_INCEN_OPT,                                      *02169000
                   SVC_INCEN_QLFY,                                     *02170000
                   DISC_AMT,                                           *02171000
                   DISC_PERCENT,                                       *02172000
                   RATE_INCEN_OPT,                                     *02173000
                   RATE_INCEN_QLFY,                                    *02174000
                   RATE_OPTION,                                        *02175000
                   RATE_TYPE,                                          *02176000
                   RATE_PCT,                                           *02177000
                   MESSAGE_NBR,                                        *02178000
                   IDENT_NBR,                                          *02179000
                   MODULE,                                             *02180000
                   RSV_AREA                                            *02181000
                 FROM SAM                                              *02182000
                 WHERE                                                 *02183000
                    ACCT_INST_1 = :INST1 AND                           *02184000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02185000
                    ACCT_NBR_1 = :ACCTNBR1 AND                         *02186000
                    EVENT_DATE > :EVNTDATE                             *02187000
                 ORDER BY EVENT_DATE,                                  *02188000
                   ACCT_INST_2,                                        *02189000
                   PROD_CODE_2,                                        *02190000
                   ACCT_NBR_2,                                         *02191000
                   MODEL_2,                                            *02192000
                   RECORD_SEQ                                          *02193000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02194000
         EXEC  SQL                                                     *02195000
               OPEN SAMSQ006                                            02196000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02197000
         BNZ   *+8                     NO - RETURN ERROR                02198000
         LR    12,9                    LOAD RETURN ADDRESS              02199000
         BR    12                      RETURN TO FETCH ROUTINE          02200000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02201000
         BR    14                      RETURN TO CALLER                 02202000
         LTORG                                                          02203000
*                                                                       02204000
SQL#0746 DS    0H                                                       02205000
         USING SQL#0746,12             ESTABLISH BASE REGISTER          02206000
         EXEC  SQL                                                     *02207000
               CLOSE SAMSQ006                                           02208000
         EXEC  SQL                                                     *02209000
               DECLARE SAMSQ007 CURSOR FOR                             *02210000
               SELECT ACCT_INST_1,                                     *02211000
                   PROD_CODE_1,                                        *02212000
                   ACCT_NBR_1,                                         *02213000
                   EVENT_DATE,                                         *02214000
                   ACCT_INST_2,                                        *02215000
                   PROD_CODE_2,                                        *02216000
                   ACCT_NBR_2,                                         *02217000
                   MODEL_2,                                            *02218000
                   RECORD_SEQ,                                         *02219000
                   AUDIT_DATE,                                         *02220000
                   AUDIT_TIME,                                         *02221000
                   AUDIT_USER,                                         *02222000
                   AUDIT_ORG,                                          *02223000
                   EVENT_CODE,                                         *02224000
                   SVC_INCEN_OPT,                                      *02225000
                   SVC_INCEN_QLFY,                                     *02226000
                   DISC_AMT,                                           *02227000
                   DISC_PERCENT,                                       *02228000
                   RATE_INCEN_OPT,                                     *02229000
                   RATE_INCEN_QLFY,                                    *02230000
                   RATE_OPTION,                                        *02231000
                   RATE_TYPE,                                          *02232000
                   RATE_PCT,                                           *02233000
                   MESSAGE_NBR,                                        *02234000
                   IDENT_NBR,                                          *02235000
                   MODULE,                                             *02236000
                   RSV_AREA                                            *02237000
                 FROM SAM                                              *02238000
                 WHERE                                                 *02239000
                    ACCT_INST_1 = :INST1 AND                           *02240000
                    PROD_CODE_1 = :PRDCDE1 AND                         *02241000
                    ACCT_NBR_1 > :ACCTNBR1                             *02242000
                 ORDER BY ACCT_NBR_1,                                  *02243000
                   EVENT_DATE,                                         *02244000
                   ACCT_INST_2,                                        *02245000
                   PROD_CODE_2,                                        *02246000
                   ACCT_NBR_2,                                         *02247000
                   MODEL_2,                                            *02248000
                   RECORD_SEQ                                          *02249000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02250000
         EXEC  SQL                                                     *02251000
               OPEN SAMSQ007                                            02252000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02253000
         BNZ   *+8                     NO - RETURN ERROR                02254000
         LR    12,9                    LOAD RETURN ADDRESS              02255000
         BR    12                      RETURN TO FETCH ROUTINE          02256000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02257000
         BR    14                      RETURN TO CALLER                 02258000
         LTORG                                                          02259000
*                                                                       02260000
SQL#0846 DS    0H                                                       02261000
         USING SQL#0846,12             ESTABLISH BASE REGISTER          02262000
         EXEC  SQL                                                     *02263000
               CLOSE SAMSQ007                                           02264000
         EXEC  SQL                                                     *02265000
               DECLARE SAMSQ008 CURSOR FOR                             *02266000
               SELECT ACCT_INST_1,                                     *02267000
                   PROD_CODE_1,                                        *02268000
                   ACCT_NBR_1,                                         *02269000
                   EVENT_DATE,                                         *02270000
                   ACCT_INST_2,                                        *02271000
                   PROD_CODE_2,                                        *02272000
                   ACCT_NBR_2,                                         *02273000
                   MODEL_2,                                            *02274000
                   RECORD_SEQ,                                         *02275000
                   AUDIT_DATE,                                         *02276000
                   AUDIT_TIME,                                         *02277000
                   AUDIT_USER,                                         *02278000
                   AUDIT_ORG,                                          *02279000
                   EVENT_CODE,                                         *02280000
                   SVC_INCEN_OPT,                                      *02281000
                   SVC_INCEN_QLFY,                                     *02282000
                   DISC_AMT,                                           *02283000
                   DISC_PERCENT,                                       *02284000
                   RATE_INCEN_OPT,                                     *02285000
                   RATE_INCEN_QLFY,                                    *02286000
                   RATE_OPTION,                                        *02287000
                   RATE_TYPE,                                          *02288000
                   RATE_PCT,                                           *02289000
                   MESSAGE_NBR,                                        *02290000
                   IDENT_NBR,                                          *02291000
                   MODULE,                                             *02292000
                   RSV_AREA                                            *02293000
                 FROM SAM                                              *02294000
                 WHERE                                                 *02295000
                    ACCT_INST_1 = :INST1 AND                           *02296000
                    PROD_CODE_1 > :PRDCDE1                             *02297000
                 ORDER BY PROD_CODE_1,                                 *02298000
                   ACCT_NBR_1,                                         *02299000
                   EVENT_DATE,                                         *02300000
                   ACCT_INST_2,                                        *02301000
                   PROD_CODE_2,                                        *02302000
                   ACCT_NBR_2,                                         *02303000
                   MODEL_2,                                            *02304000
                   RECORD_SEQ                                          *02305000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02306000
         EXEC  SQL                                                     *02307000
               OPEN SAMSQ008                                            02308000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02309000
         BNZ   *+8                     NO - RETURN ERROR                02310000
         LR    12,9                    LOAD RETURN ADDRESS              02311000
         BR    12                      RETURN TO FETCH ROUTINE          02312000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02313000
         BR    14                      RETURN TO CALLER                 02314000
         LTORG                                                          02315000
*                                                                       02316000
SQL#0946 DS    0H                                                       02317000
         USING SQL#0946,12             ESTABLISH BASE REGISTER          02318000
         EXEC  SQL                                                     *02319000
               CLOSE SAMSQ008                                           02320000
         EXEC  SQL                                                     *02321000
               DECLARE SAMSQ009 CURSOR FOR                             *02322000
               SELECT ACCT_INST_1,                                     *02323000
                   PROD_CODE_1,                                        *02324000
                   ACCT_NBR_1,                                         *02325000
                   EVENT_DATE,                                         *02326000
                   ACCT_INST_2,                                        *02327000
                   PROD_CODE_2,                                        *02328000
                   ACCT_NBR_2,                                         *02329000
                   MODEL_2,                                            *02330000
                   RECORD_SEQ,                                         *02331000
                   AUDIT_DATE,                                         *02332000
                   AUDIT_TIME,                                         *02333000
                   AUDIT_USER,                                         *02334000
                   AUDIT_ORG,                                          *02335000
                   EVENT_CODE,                                         *02336000
                   SVC_INCEN_OPT,                                      *02337000
                   SVC_INCEN_QLFY,                                     *02338000
                   DISC_AMT,                                           *02339000
                   DISC_PERCENT,                                       *02340000
                   RATE_INCEN_OPT,                                     *02341000
                   RATE_INCEN_QLFY,                                    *02342000
                   RATE_OPTION,                                        *02343000
                   RATE_TYPE,                                          *02344000
                   RATE_PCT,                                           *02345000
                   MESSAGE_NBR,                                        *02346000
                   IDENT_NBR,                                          *02347000
                   MODULE,                                             *02348000
                   RSV_AREA                                            *02349000
                 FROM SAM                                              *02350000
                 WHERE                                                 *02351000
                    ACCT_INST_1 > :INST1                               *02352000
                 ORDER BY ACCT_INST_1,                                 *02353000
                   PROD_CODE_1,                                        *02354000
                   ACCT_NBR_1,                                         *02355000
                   EVENT_DATE,                                         *02356000
                   ACCT_INST_2,                                        *02357000
                   PROD_CODE_2,                                        *02358000
                   ACCT_NBR_2,                                         *02359000
                   MODEL_2,                                            *02360000
                   RECORD_SEQ                                          *02361000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02362000
         EXEC  SQL                                                     *02363000
               OPEN SAMSQ009                                            02364000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02365000
         BNZ   *+8                     NO - RETURN ERROR                02366000
         LR    12,9                    LOAD RETURN ADDRESS              02367000
         BR    12                      RETURN TO FETCH ROUTINE          02368000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02369000
         BR    14                      RETURN TO CALLER                 02370000
         LTORG                                                          02371000
*                                                                       02372000
*                                                                       02373000
**********************************************************************  02374000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02375000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02376000
**********************************************************************  02377000
*                                                                       02378000
SQL#0047 DS    0H                                                       02379000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02380000
         LA    15,255                  SET RETURN CODE                  02381000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02382000
         BR    14                      RETURN TO CALLER                 02383000
         LTORG                                                          02384000
*                                                                       02385000
*                                                                       02386000
**********************************************************************  02387000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02388000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02389000
**********************************************************************  02390000
*                                                                       02391000
SQL#0048 DS    0H                                                       02392000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02393000
         LA    15,255                  SET RETURN CODE                  02394000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02395000
         BR    14                      RETURN TO CALLER                 02396000
         LTORG                                                          02397000
*                                                                       02398000
*                                                                       02399000
**********************************************************************  02400000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02401000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02402000
**********************************************************************  02403000
*                                                                       02404000
SQL#0049 DS    0H                                                       02405000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02406000
         LA    15,255                  SET RETURN CODE                  02407000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02408000
         BR    14                      RETURN TO CALLER                 02409000
         LTORG                                                          02410000
*                                                                       02411000
         DS    0H                      END OF SQL STATEMENTS            02412000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02413000
*                                                                       02414000
*                                                                       02415000
**********************************************************************  02416000
* DUMMY ENTRY POINT DSNHLI                                              02417000
*   MUST NOT BE MODIFIED.                                               02418000
**********************************************************************  02419000
*                                                                       02420000
         ENTRY DSNHLI                                                   02421000
DSNHLI   DS    0H                                                       02422000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02423000
         BR    15                      BRANCH TO ATTACH FACILITY        02424000
*                                                                       02425000
*                                                                       02426000
**********************************************************************  02427000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02428000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02429000
*   MUST NOT BE MODIFIED.                                               02430000
**********************************************************************  02431000
*                                                                       02432000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02433000
CONV#RTN AMODE ANY                                                      02434000
CONV#RTN RMODE ANY                                                      02435000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02436000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02437000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02438000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02439000
         BER   4                         YES - RETURN TO SQL            02440000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02441000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02442000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02443000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02444000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02445000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02446000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02447000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02448000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02449000
*                                                                       02450000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02451000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02452000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02453000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02454000
         BER   4                         YES - RETURN TO SQL            02455000
         SLR   0,0                     CLEAR FOR INSERT                 02456000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02457000
         NR    0,3                     FOR THE CURRENT KEY?             02458000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02459000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02460000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02461000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02462000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02463000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02464000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02465000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02466000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02467000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02468000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02469000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02470000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02471000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02472000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02473000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02474000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02475000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02476000
*                                                                       02477000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02478000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02479000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02480000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02481000
         BER   4                         YES - RETURN TO SQL            02482000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02483000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02484000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02485000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02486000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02487000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02488000
         MVCL  0,14                    MOVE TO RECORD AREA              02489000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02490000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02491000
*                                                                       02492000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02493000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02494000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02495000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02496000
         BER   4                         YES - RETURN TO SQL            02497000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02498000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02499000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02500000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02501000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02502000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02503000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02504000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02505000
         MVCL  0,14                    MOVE TO RECORD AREA              02506000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02507000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02508000
*                                                                       02509000
*                                                                       02510000
**********************************************************************  02511000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02512000
*   MUST NOT BE MODIFIED.                                               02513000
**********************************************************************  02514000
*                                                                       02515000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02516000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02517000
         DC    H'0077'                 LENGTH TO MOVE                   02518000
         DC    X'80'                   80 = KEY 0 FIELD                 02519000
*                                      40 = KEY 1 FIELD                 02520000
*                                      20 = KEY 2 FIELD                 02521000
*                                      10 = KEY 3 FIELD                 02522000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02523000
*                                                                       02524000
*                                      REST OF FIELD ENTRIES            02525000
         DC    H'0077',H'0077',H'0087',X'00',X'00'                      02526000
         DC    8X'FF'                  END OF FIELD ENTRIES             02527000
         LTORG                                                          02528000
         END                                                            02529000
