**********************************************************************  00001000
*                                                                       00002000
*  S10RDB .... STATIC SQL READ MODULE                                   00003000
*                                                                       00004000
*  CREATION DATE: 04/28/16                                              00005000
*                                                                       00006000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00007000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S10 TABLE.  IT IS LOADED      00008000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00009000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00010000
*  AND VOID OF SVC CALLS.                                               00011000
*                                                                       00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
*                                                                       00014000
**********************************************************************  00015000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF CALL ATTACH FACILITY  00020000
SQW@RET  DS    F                       RETURN TO THIS SQI ADDRESS       00021000
SQWSQLCA DS    XL136                   SQLCA FOR I/O MODULE USE         00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
SQWSQLDL DS    F                       LENGTH OF DYNAMIC SQLDSECT       00025000
SQWSQLD  DS    F                       DYNAMIC SQLDSECT                 00026000
SQW@SQRX DS    F                       SQI INTERFACE ROUTINE ADDRESS    00027000
SQWPARM1 DS    F                       SQI PARAMETER 1 (MODULE ADDRESS) 00028000
SQWINTHV DS    F                       INTEGER HOST VARIABLE            00029000
SQWCSRBR DS    F                       CURSOR ROUTINE BASE REGISTER     00030000
SQWCSRRA DS    F                       CURSOR ROUTINE RETURN ADDRESS    00031000
SQWRSFVC DS    H                       ROWSET FETCH SQLVAR COUNT        00032000
SQWKMRP  DS    CL1                     SQI KEY MASK / ROUTINE POINTER   00033000
         DS    CL5                     RESERVED                         00034000
SQWIOSI  DS    0CL24                   I/O MODULE STATE INFORMATION     00035000
SQWSQLDA DS    F                       ROWSET SQLDA STORAGE ADDRESS     00036000
SQWRSRMX DS    H                       ROWSET MAX NUMBER OF ROWS        00037000
SQWRSRCT DS    H                       ROWSET RETURNED ROW COUNT        00038000
SQWRSROC DS    H                       ROWSET ROW OCCURS COUNT          00039000
SQWRSFCD DS    H                       ROWSET FETCH SQLCODE             00040000
SQWCSRCA DS    F                       READ CURSOR CLOSE ROUTINE ADDR   00041000
SQWCSUCA DS    F                       UPDATE CURSOR CLOSE ROUTINE ADDR 00042000
SQWCSRLV DS    CL1                     CURSOR CASCADE LEVEL LIMIT       00043000
SQWCSRCC DS    CL1                     CURSOR CASCADE COUNT             00044000
SQWCSRSP DS    H                       CURSOR ROUTINE POINTER           00045000
         DS    CL4                     RESERVED                         00046000
SQWCMD   DS    CL2                     DBS COMMAND CODE                 00047000
SQWORG   DS    CL6                     RECORD ORG CODE                  00048000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00049000
INST     DS    CL4                                                      00050000
RECNBR   DS    CL4                                                      00051000
TRANPROF DS    CL6                                                      00052000
AUDDATE  DS    PL5'0.'                                                  00053000
AUDTIME  DS    PL5'0.'                                                  00054000
AUDUSER  DS    CL8                                                      00055000
AUDORG   DS    CL6                                                      00056000
DESC     DS    CL30                                                     00057000
GRACEDAY DS    CL2                                                      00058000
ACCOND01 DS    CL1                                                      00059000
ACCUM01  DS    CL2                                                      00060000
RELCD01  DS    CL2                                                      00061000
REQOPT01 DS    CL1                                                      00062000
TRNCNT01 DS    PL3'0.'                                                  00063000
TRNAMT01 DS    PL6'0.00'                                                00064000
ACDESC01 DS    CL15                                                     00065000
ACCOND02 DS    CL1                                                      00066000
ACCUM02  DS    CL2                                                      00067000
RELCD02  DS    CL2                                                      00068000
REQOPT02 DS    CL1                                                      00069000
TRNCNT02 DS    PL3'0.'                                                  00070000
TRNAMT02 DS    PL6'0.00'                                                00071000
ACDESC02 DS    CL15                                                     00072000
ACCOND03 DS    CL1                                                      00073000
ACCUM03  DS    CL2                                                      00074000
RELCD03  DS    CL2                                                      00075000
REQOPT03 DS    CL1                                                      00076000
TRNCNT03 DS    PL3'0.'                                                  00077000
TRNAMT03 DS    PL6'0.00'                                                00078000
ACDESC03 DS    CL15                                                     00079000
ACCOND04 DS    CL1                                                      00080000
ACCUM04  DS    CL2                                                      00081000
RELCD04  DS    CL2                                                      00082000
REQOPT04 DS    CL1                                                      00083000
TRNCNT04 DS    PL3'0.'                                                  00084000
TRNAMT04 DS    PL6'0.00'                                                00085000
ACDESC04 DS    CL15                                                     00086000
ACCOND05 DS    CL1                                                      00087000
ACCUM05  DS    CL2                                                      00088000
RELCD05  DS    CL2                                                      00089000
REQOPT05 DS    CL1                                                      00090000
TRNCNT05 DS    PL3'0.'                                                  00091000
TRNAMT05 DS    PL6'0.00'                                                00092000
ACDESC05 DS    CL15                                                     00093000
ACCOND06 DS    CL1                                                      00094000
ACCUM06  DS    CL2                                                      00095000
RELCD06  DS    CL2                                                      00096000
REQOPT06 DS    CL1                                                      00097000
TRNCNT06 DS    PL3'0.'                                                  00098000
TRNAMT06 DS    PL6'0.00'                                                00099000
ACDESC06 DS    CL15                                                     00100000
ACCOND07 DS    CL1                                                      00101000
ACCUM07  DS    CL2                                                      00102000
RELCD07  DS    CL2                                                      00103000
REQOPT07 DS    CL1                                                      00104000
TRNCNT07 DS    PL3'0.'                                                  00105000
TRNAMT07 DS    PL6'0.00'                                                00106000
ACDESC07 DS    CL15                                                     00107000
ACCOND08 DS    CL1                                                      00108000
ACCUM08  DS    CL2                                                      00109000
RELCD08  DS    CL2                                                      00110000
REQOPT08 DS    CL1                                                      00111000
TRNCNT08 DS    PL3'0.'                                                  00112000
TRNAMT08 DS    PL6'0.00'                                                00113000
ACDESC08 DS    CL15                                                     00114000
ACCOND09 DS    CL1                                                      00115000
ACCUM09  DS    CL2                                                      00116000
RELCD09  DS    CL2                                                      00117000
REQOPT09 DS    CL1                                                      00118000
TRNCNT09 DS    PL3'0.'                                                  00119000
TRNAMT09 DS    PL6'0.00'                                                00120000
ACDESC09 DS    CL15                                                     00121000
ACCOND10 DS    CL1                                                      00122000
ACCUM10  DS    CL2                                                      00123000
RELCD10  DS    CL2                                                      00124000
REQOPT10 DS    CL1                                                      00125000
TRNCNT10 DS    PL3'0.'                                                  00126000
TRNAMT10 DS    PL6'0.00'                                                00127000
ACDESC10 DS    CL15                                                     00128000
ACCOND11 DS    CL1                                                      00129000
ACCUM11  DS    CL2                                                      00130000
RELCD11  DS    CL2                                                      00131000
REQOPT11 DS    CL1                                                      00132000
TRNCNT11 DS    PL3'0.'                                                  00133000
TRNAMT11 DS    PL6'0.00'                                                00134000
ACDESC11 DS    CL15                                                     00135000
ACCOND12 DS    CL1                                                      00136000
ACCUM12  DS    CL2                                                      00137000
RELCD12  DS    CL2                                                      00138000
REQOPT12 DS    CL1                                                      00139000
TRNCNT12 DS    PL3'0.'                                                  00140000
TRNAMT12 DS    PL6'0.00'                                                00141000
ACDESC12 DS    CL15                                                     00142000
*                                                                       00143000
         ORG   ASMREC+(2000-L'SQWADATA) POINT TO ADDITIONAL DATA        00144000
SQWADATA DS    0CL400                  ADDITIONAL DATA PASSED TO MODULE 00145000
SQWSEGF  DS    CL102                   SEGMENTED FROM KEY VALUE         00146000
SQWSEGT  DS    CL102                   SEGMENTED TO KEY VALUE           00147000
SQWAUDIT DS    CL99                    CALLERS AUDIT DATA               00148000
         DS    CL97                    RESERVED                         00149000
*                                                                       00150000
INDVARS  DS    0H                      NULL INDICATOR VARIABLES         00151000
INDVARX  DS    0H                                                       00152000
INDVARL  EQU   INDVARX-INDVARS         NULL INDICATOR AREA LENGTH       00153000
*                                                                       00154000
*                                                                       00155000
**********************************************************************  00156000
* ROWSET SQLDA AREA ADDRESSED BY REGISTER 2                             00157000
**********************************************************************  00158000
*                                                                       00159000
SQDSQLDA DSECT                         ROWSET SQLDA AREA                00160000
*                                                                       00161000
**********************************************************************  00162000
* PROGRAM TABLE HEADER SECTION:                                         00163000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00164000
**********************************************************************  00165000
*                                                                       00166000
S10RDB   CSECT                         PROGRAM TABLE SECTION            00167000
S10RDB   AMODE ANY                                                      00168000
S10RDB   RMODE ANY                                                      00169000
         DC    CL8'S10RDB  '           PROGRAM ID                       00170000
         DC    CL1' '                                                   00171000
         DC    CL8'&SYSDATE'           ASSEMBLY DATE                    00172000
         DC    CL1' '                                                   00173000
         DC    CL5'&SYSTIME'           ASSEMBLY TIME                    00174000
         DC    CL1' '                                                   00175000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00176000
         DC    5A(0)                   RESERVED                         00177000
         DC    AL2(0)                  RESERVED                         00178000
         DC    AL2(INDVARL)            NULL INDICATOR AREA LENGTH       00179000
         DC    A(CONVTAB1)             RECORD/HOST CONVERSION TABLE     00180000
         DC    A(CONVTAB2)             SQLDA DATA TYPE/LENGTH TABLE     00181000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00182000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00183000
         DC    CL29'WWW.INFOR.COM                '                      00183001
*                                                                       00184000
**********************************************************************  00185000
* STATEMENT TABLE SECTION:                                              00186000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00187000
**********************************************************************  00188000
*                                                                       00189000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00190000
STM#TAB  AMODE ANY                                                      00191000
STM#TAB  RMODE ANY                                                      00192000
         DC    A(SELIN0)               SELECT INTO (KEY 0)              00193000
         DC    A(SELIN1)               SELECT INTO (KEY 1)              00194000
         DC    A(SELIN2)               SELECT INTO (KEY 2)              00195000
         DC    A(SELIN3)               SELECT INTO (KEY 3)              00196000
         DC    12A(0)                  UDB MODULE VECTORS               00197000
         DC    A(SELXC0)               SELECT SEQ CURSOR (KEY 0)        00198000
         DC    A(SELXC1)               SELECT SEQ CURSOR (KEY 1)        00199000
         DC    A(SELXC2)               SELECT SEQ CURSOR (KEY 2)        00200000
         DC    A(SELXC3)               SELECT SEQ CURSOR (KEY 3)        00201000
         DC    A(FETDC0)               FETCH SEQ DATA CURSOR (KEY 0)    00202000
         DC    A(FETDC1)               FETCH SEQ DATA CURSOR (KEY 1)    00203000
         DC    A(FETDC2)               FETCH SEQ DATA CURSOR (KEY 2)    00204000
         DC    A(FETDC3)               FETCH SEQ DATA CURSOR (KEY 3)    00205000
         DC    A(FETKC0)               FETCH SEQ KEY CURSOR (KEY 0)     00206000
         DC    A(FETKC1)               FETCH SEQ KEY CURSOR (KEY 1)     00207000
         DC    A(FETKC2)               FETCH SEQ KEY CURSOR (KEY 2)     00208000
         DC    A(FETKC3)               FETCH SEQ KEY CURSOR (KEY 3)     00209000
         DC    A(CLSXC0)               CLOSE SEQ CURSOR (KEY 0)         00210000
         DC    A(CLSXC1)               CLOSE SEQ CURSOR (KEY 1)         00211000
         DC    A(CLSXC2)               CLOSE SEQ CURSOR (KEY 2)         00212000
         DC    A(CLSXC3)               CLOSE SEQ CURSOR (KEY 3)         00213000
         DC    A(SELKY0)               SELECT KEY (KEY 0)               00214000
         DC    A(SELKY1)               SELECT KEY (KEY 1)               00215000
         DC    A(SELKY2)               SELECT KEY (KEY 2)               00216000
         DC    A(SELKY3)               SELECT KEY (KEY 3)               00217000
         DC    10A(0)                  UDB MODULE VECTORS               00218000
         DC    4X'FF'                                                   00219000
*                                                                       00220000
**********************************************************************  00221000
* SQL STATEMENT SECTION:                                                00222000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00223000
*     TO SUPPORT THIS TABLE.                                            00224000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00225000
*     ARE EQUIVALENT.                                                   00226000
**********************************************************************  00227000
*                                                                       00228000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00229000
SQL#STMT AMODE ANY                                                      00230000
SQL#STMT RMODE ANY                                                      00231000
         USING SQDSQLDA,2              ADDRESS ROWSET SQLDA AREA        00232000
         USING SQLDSECT,10,3,4         ADDRESS SQLDSECT                 00233000
         USING COM#AREA,11             ADDRESS COMMAREA                 00234000
*                                                                       00235000
**********************************************************************  00236000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00237000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00238000
**********************************************************************  00239000
*                                                                       00240000
SELIN0   DS    0H                                                       00241000
         USING SELIN0,12               ESTABLISH BASE REGISTER          00242000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00243000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00244000
         BALR  14,15                   MOVE REQUESTED DATA              00245000
         B     *+6                     BRANCH AROUND ADCON              00246000
BASIN0   DC    AL2(4096)                                                00247000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00248000
         AH    3,BASIN0                ADD 4K                           00249000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00250000
         AH    4,BASIN0                ADD 4K                           00251000
         EXEC  SQL SELECT                                              *00252000
                   AUDIT_DATE,                                         *00253000
                   AUDIT_TIME,                                         *00254000
                   AUDIT_USER,                                         *00255000
                   AUDIT_ORG,                                          *00256000
                   DESCRIPTION,                                        *00257000
                   GRACE_DAYS,                                         *00258000
                   ACCUM_COND_01,                                      *00259000
                   ACCUM_01,                                           *00260000
                   REL_CODE_01,                                        *00261000
                   REQM_OPTION_01,                                     *00262000
                   TRAN_COUNT_01,                                      *00263000
                   TRAN_AMOUNT_01,                                     *00264000
                   ACCUM_DESC_01,                                      *00265000
                   ACCUM_COND_02,                                      *00266000
                   ACCUM_02,                                           *00267000
                   REL_CODE_02,                                        *00268000
                   REQM_OPTION_02,                                     *00269000
                   TRAN_COUNT_02,                                      *00270000
                   TRAN_AMOUNT_02,                                     *00271000
                   ACCUM_DESC_02,                                      *00272000
                   ACCUM_COND_03,                                      *00273000
                   ACCUM_03,                                           *00274000
                   REL_CODE_03,                                        *00275000
                   REQM_OPTION_03,                                     *00276000
                   TRAN_COUNT_03,                                      *00277000
                   TRAN_AMOUNT_03,                                     *00278000
                   ACCUM_DESC_03,                                      *00279000
                   ACCUM_COND_04,                                      *00280000
                   ACCUM_04,                                           *00281000
                   REL_CODE_04,                                        *00282000
                   REQM_OPTION_04,                                     *00283000
                   TRAN_COUNT_04,                                      *00284000
                   TRAN_AMOUNT_04,                                     *00285000
                   ACCUM_DESC_04,                                      *00286000
                   ACCUM_COND_05,                                      *00287000
                   ACCUM_05,                                           *00288000
                   REL_CODE_05,                                        *00289000
                   REQM_OPTION_05,                                     *00290000
                   TRAN_COUNT_05,                                      *00291000
                   TRAN_AMOUNT_05,                                     *00292000
                   ACCUM_DESC_05,                                      *00293000
                   ACCUM_COND_06,                                      *00294000
                   ACCUM_06,                                           *00295000
                   REL_CODE_06,                                        *00296000
                   REQM_OPTION_06,                                     *00297000
                   TRAN_COUNT_06,                                      *00298000
                   TRAN_AMOUNT_06,                                     *00299000
                   ACCUM_DESC_06,                                      *00300000
                   ACCUM_COND_07,                                      *00301000
                   ACCUM_07,                                           *00302000
                   REL_CODE_07,                                        *00303000
                   REQM_OPTION_07,                                     *00304000
                   TRAN_COUNT_07,                                      *00305000
                   TRAN_AMOUNT_07,                                     *00306000
                   ACCUM_DESC_07,                                      *00307000
                   ACCUM_COND_08,                                      *00308000
                   ACCUM_08,                                           *00309000
                   REL_CODE_08,                                        *00310000
                   REQM_OPTION_08,                                     *00311000
                   TRAN_COUNT_08,                                      *00312000
                   TRAN_AMOUNT_08,                                     *00313000
                   ACCUM_DESC_08,                                      *00314000
                   ACCUM_COND_09,                                      *00315000
                   ACCUM_09,                                           *00316000
                   REL_CODE_09,                                        *00317000
                   REQM_OPTION_09,                                     *00318000
                   TRAN_COUNT_09,                                      *00319000
                   TRAN_AMOUNT_09,                                     *00320000
                   ACCUM_DESC_09,                                      *00321000
                   ACCUM_COND_10,                                      *00322000
                   ACCUM_10,                                           *00323000
                   REL_CODE_10,                                        *00324000
                   REQM_OPTION_10,                                     *00325000
                   TRAN_COUNT_10,                                      *00326000
                   TRAN_AMOUNT_10,                                     *00327000
                   ACCUM_DESC_10,                                      *00328000
                   ACCUM_COND_11,                                      *00329000
                   ACCUM_11,                                           *00330000
                   REL_CODE_11,                                        *00331000
                   REQM_OPTION_11,                                     *00332000
                   TRAN_COUNT_11,                                      *00333000
                   TRAN_AMOUNT_11,                                     *00334000
                   ACCUM_DESC_11,                                      *00335000
                   ACCUM_COND_12,                                      *00336000
                   ACCUM_12,                                           *00337000
                   REL_CODE_12,                                        *00338000
                   REQM_OPTION_12,                                     *00339000
                   TRAN_COUNT_12,                                      *00340000
                   TRAN_AMOUNT_12,                                     *00341000
                   ACCUM_DESC_12                                       *00342000
                 INTO                                                  *00343000
                   :AUDDATE,                                           *00344000
                   :AUDTIME,                                           *00345000
                   :AUDUSER,                                           *00346000
                   :AUDORG,                                            *00347000
                   :DESC,                                              *00348000
                   :GRACEDAY,                                          *00349000
                   :ACCOND01,                                          *00350000
                   :ACCUM01,                                           *00351000
                   :RELCD01,                                           *00352000
                   :REQOPT01,                                          *00353000
                   :TRNCNT01,                                          *00354000
                   :TRNAMT01,                                          *00355000
                   :ACDESC01,                                          *00356000
                   :ACCOND02,                                          *00357000
                   :ACCUM02,                                           *00358000
                   :RELCD02,                                           *00359000
                   :REQOPT02,                                          *00360000
                   :TRNCNT02,                                          *00361000
                   :TRNAMT02,                                          *00362000
                   :ACDESC02,                                          *00363000
                   :ACCOND03,                                          *00364000
                   :ACCUM03,                                           *00365000
                   :RELCD03,                                           *00366000
                   :REQOPT03,                                          *00367000
                   :TRNCNT03,                                          *00368000
                   :TRNAMT03,                                          *00369000
                   :ACDESC03,                                          *00370000
                   :ACCOND04,                                          *00371000
                   :ACCUM04,                                           *00372000
                   :RELCD04,                                           *00373000
                   :REQOPT04,                                          *00374000
                   :TRNCNT04,                                          *00375000
                   :TRNAMT04,                                          *00376000
                   :ACDESC04,                                          *00377000
                   :ACCOND05,                                          *00378000
                   :ACCUM05,                                           *00379000
                   :RELCD05,                                           *00380000
                   :REQOPT05,                                          *00381000
                   :TRNCNT05,                                          *00382000
                   :TRNAMT05,                                          *00383000
                   :ACDESC05,                                          *00384000
                   :ACCOND06,                                          *00385000
                   :ACCUM06,                                           *00386000
                   :RELCD06,                                           *00387000
                   :REQOPT06,                                          *00388000
                   :TRNCNT06,                                          *00389000
                   :TRNAMT06,                                          *00390000
                   :ACDESC06,                                          *00391000
                   :ACCOND07,                                          *00392000
                   :ACCUM07,                                           *00393000
                   :RELCD07,                                           *00394000
                   :REQOPT07,                                          *00395000
                   :TRNCNT07,                                          *00396000
                   :TRNAMT07,                                          *00397000
                   :ACDESC07,                                          *00398000
                   :ACCOND08,                                          *00399000
                   :ACCUM08,                                           *00400000
                   :RELCD08,                                           *00401000
                   :REQOPT08,                                          *00402000
                   :TRNCNT08,                                          *00403000
                   :TRNAMT08,                                          *00404000
                   :ACDESC08,                                          *00405000
                   :ACCOND09,                                          *00406000
                   :ACCUM09,                                           *00407000
                   :RELCD09,                                           *00408000
                   :REQOPT09,                                          *00409000
                   :TRNCNT09,                                          *00410000
                   :TRNAMT09,                                          *00411000
                   :ACDESC09,                                          *00412000
                   :ACCOND10,                                          *00413000
                   :ACCUM10,                                           *00414000
                   :RELCD10,                                           *00415000
                   :REQOPT10,                                          *00416000
                   :TRNCNT10,                                          *00417000
                   :TRNAMT10,                                          *00418000
                   :ACDESC10,                                          *00419000
                   :ACCOND11,                                          *00420000
                   :ACCUM11,                                           *00421000
                   :RELCD11,                                           *00422000
                   :REQOPT11,                                          *00423000
                   :TRNCNT11,                                          *00424000
                   :TRNAMT11,                                          *00425000
                   :ACDESC11,                                          *00426000
                   :ACCOND12,                                          *00427000
                   :ACCUM12,                                           *00428000
                   :RELCD12,                                           *00429000
                   :REQOPT12,                                          *00430000
                   :TRNCNT12,                                          *00431000
                   :TRNAMT12,                                          *00432000
                   :ACDESC12                                           *00433000
                 FROM S10                                              *00434000
                 WHERE                                                 *00435000
                   INST_NBR = :INST AND                                *00436000
                   RECORD_NBR = :RECNBR AND                            *00437000
                   TRAN_PROFILE = :TRANPROF                            *00438000
                 FETCH FIRST 1 ROW ONLY                                 00439000
         MVI   SQWKMRP,X'03'           MOVE HOST VARIABLES TO RECORD    00440000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00441000
         BALR  14,15                   MOVE REQUESTED DATA              00442000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00443000
         BR    14                      RETURN TO CALLER                 00444000
         LTORG                                                          00445000
*                                                                       00446000
**********************************************************************  00447000
* SELECT COUNT STATEMENT BY PRIMARY KEY:                                00448000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00449000
**********************************************************************  00450000
*                                                                       00451000
SELKY0   DS    0H                                                       00452000
         USING SELKY0,12               ESTABLISH BASE REGISTER          00453000
         MVI   SQWKMRP,X'80'           MOVE RECORD TO HOST FOR KEY 0    00454000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00455000
         BALR  14,15                   MOVE REQUESTED DATA              00456000
         B     *+6                     BRANCH AROUND ADCON              00457000
BASKY0   DC    AL2(4096)                                                00458000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00459000
         AH    3,BASKY0                ADD 4K                           00460000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00461000
         AH    4,BASKY0                ADD 4K                           00462000
         EXEC  SQL SELECT                                              *00463000
                   COUNT(*)                                            *00464000
                 INTO                                                  *00465000
                   :SQWINTHV                                           *00466000
                 FROM S10                                              *00467000
                 WHERE                                                 *00468000
                   INST_NBR = :INST AND                                *00469000
                   RECORD_NBR = :RECNBR AND                            *00470000
                   TRAN_PROFILE = :TRANPROF                            *00471000
                 FETCH FIRST 1 ROW ONLY                                 00472000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00473000
         CLC   SQLCODE,=F'0'           GOOD RETURN FROM SQL?            00474000
         BNER  14                      NO - RETURN TO CALLER            00475000
         CLC   SQWINTHV,=F'0'          ANY ROWS MATCH WHERE CLAUSE?     00476000
         BNER  14                      YES - RETURN ZERO SQLCODE        00477000
         MVC   SQLCODE,=F'+100'        SET SQLCODE TO ROW NOT FOUND     00478000
         BR    14                      RETURN TO CALLER                 00479000
         LTORG                                                          00480000
*                                                                       00481000
**********************************************************************  00482000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00483000
* KEY:                                                                  00484000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00485000
*     AND GET-NEXT-LOCK VERBS.                                          00486000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00487000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00488000
**********************************************************************  00489000
*                                                                       00490000
SELXC0   DS    0H                                                       00491000
         USING SELXC0,12               ESTABLISH BASE REGISTER          00492000
         MVI   SQWKMRP,X'86'           SET HOST KEY 0 & CURSOR POINTER  00493000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00494000
         BALR  14,15                   MOVE DATA & SET CURSOR POINTER   00495000
         LA    12,SELXC0P              LOAD VECTOR TABLE ADDRESS        00496000
         AH    12,SQWCSRSP             COMPUTE POINTER TO OPEN ROUTINE  00497000
         L     12,0(12)                LOAD OPEN ROUTINE ADDRESS        00498000
         BR    12                      GO TO CURSOR OPEN ROUTINE        00499000
SELXC0P  DC    A(SELGE001)                                              00500000
         DC    (KY0COLMS-01)A(0)                                        00501000
         DC    A(SELGE002)                                              00502000
         DC    (KY0COLMS-02)A(0)                                        00503000
         DC    A(SELGE003)                                              00504000
         LTORG                                                          00505000
*                                                                       00506000
SELGE001 DS    0H                                                       00507000
         USING SELGE001,12             ESTABLISH BASE REGISTER          00508000
         B     *+6                     BRANCH AROUND ADCON              00509000
BASGE001 DC    AL2(4096)                                                00510000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00511000
         AH    3,BASGE001              ADD 4K                           00512000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00513000
         AH    4,BASGE001              ADD 4K                           00514000
         EXEC  SQL DECLARE S10GE001 CURSOR                             *00515000
               WITH ROWSET POSITIONING                                 *00516000
               FOR SELECT                                              *00517000
                   INST_NBR,                                           *00518000
                   RECORD_NBR,                                         *00519000
                   TRAN_PROFILE,                                       *00520000
                   AUDIT_DATE,                                         *00521000
                   AUDIT_TIME,                                         *00522000
                   AUDIT_USER,                                         *00523000
                   AUDIT_ORG,                                          *00524000
                   DESCRIPTION,                                        *00525000
                   GRACE_DAYS,                                         *00526000
                   ACCUM_COND_01,                                      *00527000
                   ACCUM_01,                                           *00528000
                   REL_CODE_01,                                        *00529000
                   REQM_OPTION_01,                                     *00530000
                   TRAN_COUNT_01,                                      *00531000
                   TRAN_AMOUNT_01,                                     *00532000
                   ACCUM_DESC_01,                                      *00533000
                   ACCUM_COND_02,                                      *00534000
                   ACCUM_02,                                           *00535000
                   REL_CODE_02,                                        *00536000
                   REQM_OPTION_02,                                     *00537000
                   TRAN_COUNT_02,                                      *00538000
                   TRAN_AMOUNT_02,                                     *00539000
                   ACCUM_DESC_02,                                      *00540000
                   ACCUM_COND_03,                                      *00541000
                   ACCUM_03,                                           *00542000
                   REL_CODE_03,                                        *00543000
                   REQM_OPTION_03,                                     *00544000
                   TRAN_COUNT_03,                                      *00545000
                   TRAN_AMOUNT_03,                                     *00546000
                   ACCUM_DESC_03,                                      *00547000
                   ACCUM_COND_04,                                      *00548000
                   ACCUM_04,                                           *00549000
                   REL_CODE_04,                                        *00550000
                   REQM_OPTION_04,                                     *00551000
                   TRAN_COUNT_04,                                      *00552000
                   TRAN_AMOUNT_04,                                     *00553000
                   ACCUM_DESC_04,                                      *00554000
                   ACCUM_COND_05,                                      *00555000
                   ACCUM_05,                                           *00556000
                   REL_CODE_05,                                        *00557000
                   REQM_OPTION_05,                                     *00558000
                   TRAN_COUNT_05,                                      *00559000
                   TRAN_AMOUNT_05,                                     *00560000
                   ACCUM_DESC_05,                                      *00561000
                   ACCUM_COND_06,                                      *00562000
                   ACCUM_06,                                           *00563000
                   REL_CODE_06,                                        *00564000
                   REQM_OPTION_06,                                     *00565000
                   TRAN_COUNT_06,                                      *00566000
                   TRAN_AMOUNT_06,                                     *00567000
                   ACCUM_DESC_06,                                      *00568000
                   ACCUM_COND_07,                                      *00569000
                   ACCUM_07,                                           *00570000
                   REL_CODE_07,                                        *00571000
                   REQM_OPTION_07,                                     *00572000
                   TRAN_COUNT_07,                                      *00573000
                   TRAN_AMOUNT_07,                                     *00574000
                   ACCUM_DESC_07,                                      *00575000
                   ACCUM_COND_08,                                      *00576000
                   ACCUM_08,                                           *00577000
                   REL_CODE_08,                                        *00578000
                   REQM_OPTION_08,                                     *00579000
                   TRAN_COUNT_08,                                      *00580000
                   TRAN_AMOUNT_08,                                     *00581000
                   ACCUM_DESC_08,                                      *00582000
                   ACCUM_COND_09,                                      *00583000
                   ACCUM_09,                                           *00584000
                   REL_CODE_09,                                        *00585000
                   REQM_OPTION_09,                                     *00586000
                   TRAN_COUNT_09,                                      *00587000
                   TRAN_AMOUNT_09,                                     *00588000
                   ACCUM_DESC_09,                                      *00589000
                   ACCUM_COND_10,                                      *00590000
                   ACCUM_10,                                           *00591000
                   REL_CODE_10,                                        *00592000
                   REQM_OPTION_10,                                     *00593000
                   TRAN_COUNT_10,                                      *00594000
                   TRAN_AMOUNT_10,                                     *00595000
                   ACCUM_DESC_10,                                      *00596000
                   ACCUM_COND_11,                                      *00597000
                   ACCUM_11,                                           *00598000
                   REL_CODE_11,                                        *00599000
                   REQM_OPTION_11,                                     *00600000
                   TRAN_COUNT_11,                                      *00601000
                   TRAN_AMOUNT_11,                                     *00602000
                   ACCUM_DESC_11,                                      *00603000
                   ACCUM_COND_12,                                      *00604000
                   ACCUM_12,                                           *00605000
                   REL_CODE_12,                                        *00606000
                   REQM_OPTION_12,                                     *00607000
                   TRAN_COUNT_12,                                      *00608000
                   TRAN_AMOUNT_12,                                     *00609000
                   ACCUM_DESC_12                                       *00610000
                 FROM S10                                              *00611000
                 WHERE                                                 *00612000
                   INST_NBR = :INST AND                                *00613000
                   RECORD_NBR = :RECNBR AND                            *00614000
                   TRAN_PROFILE >=                                     *00615000
                     :TRANPROF                                         *00616000
                 ORDER BY TRAN_PROFILE ASC                             *00617000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00618000
         EXEC  SQL OPEN S10GE001                                        00619000
         MVC   SQWCSRCA,=A(CLSGE001)   SET CURSOR CLOSE ROUTINE ADDRESS 00620000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00621000
         BR    14                      RETURN TO CALLER                 00622000
         LTORG                                                          00623000
*                                                                       00624000
SELGE002 DS    0H                                                       00625000
         USING SELGE002,12             ESTABLISH BASE REGISTER          00626000
         B     *+6                     BRANCH AROUND ADCON              00627000
BASGE002 DC    AL2(4096)                                                00628000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00629000
         AH    3,BASGE002              ADD 4K                           00630000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00631000
         AH    4,BASGE002              ADD 4K                           00632000
         EXEC  SQL DECLARE S10GE002 CURSOR                             *00633000
               WITH ROWSET POSITIONING                                 *00634000
               FOR SELECT                                              *00635000
                   INST_NBR,                                           *00636000
                   RECORD_NBR,                                         *00637000
                   TRAN_PROFILE,                                       *00638000
                   AUDIT_DATE,                                         *00639000
                   AUDIT_TIME,                                         *00640000
                   AUDIT_USER,                                         *00641000
                   AUDIT_ORG,                                          *00642000
                   DESCRIPTION,                                        *00643000
                   GRACE_DAYS,                                         *00644000
                   ACCUM_COND_01,                                      *00645000
                   ACCUM_01,                                           *00646000
                   REL_CODE_01,                                        *00647000
                   REQM_OPTION_01,                                     *00648000
                   TRAN_COUNT_01,                                      *00649000
                   TRAN_AMOUNT_01,                                     *00650000
                   ACCUM_DESC_01,                                      *00651000
                   ACCUM_COND_02,                                      *00652000
                   ACCUM_02,                                           *00653000
                   REL_CODE_02,                                        *00654000
                   REQM_OPTION_02,                                     *00655000
                   TRAN_COUNT_02,                                      *00656000
                   TRAN_AMOUNT_02,                                     *00657000
                   ACCUM_DESC_02,                                      *00658000
                   ACCUM_COND_03,                                      *00659000
                   ACCUM_03,                                           *00660000
                   REL_CODE_03,                                        *00661000
                   REQM_OPTION_03,                                     *00662000
                   TRAN_COUNT_03,                                      *00663000
                   TRAN_AMOUNT_03,                                     *00664000
                   ACCUM_DESC_03,                                      *00665000
                   ACCUM_COND_04,                                      *00666000
                   ACCUM_04,                                           *00667000
                   REL_CODE_04,                                        *00668000
                   REQM_OPTION_04,                                     *00669000
                   TRAN_COUNT_04,                                      *00670000
                   TRAN_AMOUNT_04,                                     *00671000
                   ACCUM_DESC_04,                                      *00672000
                   ACCUM_COND_05,                                      *00673000
                   ACCUM_05,                                           *00674000
                   REL_CODE_05,                                        *00675000
                   REQM_OPTION_05,                                     *00676000
                   TRAN_COUNT_05,                                      *00677000
                   TRAN_AMOUNT_05,                                     *00678000
                   ACCUM_DESC_05,                                      *00679000
                   ACCUM_COND_06,                                      *00680000
                   ACCUM_06,                                           *00681000
                   REL_CODE_06,                                        *00682000
                   REQM_OPTION_06,                                     *00683000
                   TRAN_COUNT_06,                                      *00684000
                   TRAN_AMOUNT_06,                                     *00685000
                   ACCUM_DESC_06,                                      *00686000
                   ACCUM_COND_07,                                      *00687000
                   ACCUM_07,                                           *00688000
                   REL_CODE_07,                                        *00689000
                   REQM_OPTION_07,                                     *00690000
                   TRAN_COUNT_07,                                      *00691000
                   TRAN_AMOUNT_07,                                     *00692000
                   ACCUM_DESC_07,                                      *00693000
                   ACCUM_COND_08,                                      *00694000
                   ACCUM_08,                                           *00695000
                   REL_CODE_08,                                        *00696000
                   REQM_OPTION_08,                                     *00697000
                   TRAN_COUNT_08,                                      *00698000
                   TRAN_AMOUNT_08,                                     *00699000
                   ACCUM_DESC_08,                                      *00700000
                   ACCUM_COND_09,                                      *00701000
                   ACCUM_09,                                           *00702000
                   REL_CODE_09,                                        *00703000
                   REQM_OPTION_09,                                     *00704000
                   TRAN_COUNT_09,                                      *00705000
                   TRAN_AMOUNT_09,                                     *00706000
                   ACCUM_DESC_09,                                      *00707000
                   ACCUM_COND_10,                                      *00708000
                   ACCUM_10,                                           *00709000
                   REL_CODE_10,                                        *00710000
                   REQM_OPTION_10,                                     *00711000
                   TRAN_COUNT_10,                                      *00712000
                   TRAN_AMOUNT_10,                                     *00713000
                   ACCUM_DESC_10,                                      *00714000
                   ACCUM_COND_11,                                      *00715000
                   ACCUM_11,                                           *00716000
                   REL_CODE_11,                                        *00717000
                   REQM_OPTION_11,                                     *00718000
                   TRAN_COUNT_11,                                      *00719000
                   TRAN_AMOUNT_11,                                     *00720000
                   ACCUM_DESC_11,                                      *00721000
                   ACCUM_COND_12,                                      *00722000
                   ACCUM_12,                                           *00723000
                   REL_CODE_12,                                        *00724000
                   REQM_OPTION_12,                                     *00725000
                   TRAN_COUNT_12,                                      *00726000
                   TRAN_AMOUNT_12,                                     *00727000
                   ACCUM_DESC_12                                       *00728000
                 FROM S10                                              *00729000
                 WHERE                                                 *00730000
                   INST_NBR = :INST AND                                *00731000
                   RECORD_NBR >=                                       *00732000
                     :RECNBR                                           *00733000
                 ORDER BY RECORD_NBR ASC,                              *00734000
                   TRAN_PROFILE ASC                                    *00735000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00736000
         EXEC  SQL OPEN S10GE002                                        00737000
         MVC   SQWCSRCA,=A(CLSGE002)   SET CURSOR CLOSE ROUTINE ADDRESS 00738000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00739000
         BR    14                      RETURN TO CALLER                 00740000
         LTORG                                                          00741000
*                                                                       00742000
SELGE003 DS    0H                                                       00743000
         USING SELGE003,12             ESTABLISH BASE REGISTER          00744000
         B     *+6                     BRANCH AROUND ADCON              00745000
BASGE003 DC    AL2(4096)                                                00746000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00747000
         AH    3,BASGE003              ADD 4K                           00748000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00749000
         AH    4,BASGE003              ADD 4K                           00750000
         EXEC  SQL DECLARE S10GE003 CURSOR                             *00751000
               WITH ROWSET POSITIONING                                 *00752000
               FOR SELECT                                              *00753000
                   INST_NBR,                                           *00754000
                   RECORD_NBR,                                         *00755000
                   TRAN_PROFILE,                                       *00756000
                   AUDIT_DATE,                                         *00757000
                   AUDIT_TIME,                                         *00758000
                   AUDIT_USER,                                         *00759000
                   AUDIT_ORG,                                          *00760000
                   DESCRIPTION,                                        *00761000
                   GRACE_DAYS,                                         *00762000
                   ACCUM_COND_01,                                      *00763000
                   ACCUM_01,                                           *00764000
                   REL_CODE_01,                                        *00765000
                   REQM_OPTION_01,                                     *00766000
                   TRAN_COUNT_01,                                      *00767000
                   TRAN_AMOUNT_01,                                     *00768000
                   ACCUM_DESC_01,                                      *00769000
                   ACCUM_COND_02,                                      *00770000
                   ACCUM_02,                                           *00771000
                   REL_CODE_02,                                        *00772000
                   REQM_OPTION_02,                                     *00773000
                   TRAN_COUNT_02,                                      *00774000
                   TRAN_AMOUNT_02,                                     *00775000
                   ACCUM_DESC_02,                                      *00776000
                   ACCUM_COND_03,                                      *00777000
                   ACCUM_03,                                           *00778000
                   REL_CODE_03,                                        *00779000
                   REQM_OPTION_03,                                     *00780000
                   TRAN_COUNT_03,                                      *00781000
                   TRAN_AMOUNT_03,                                     *00782000
                   ACCUM_DESC_03,                                      *00783000
                   ACCUM_COND_04,                                      *00784000
                   ACCUM_04,                                           *00785000
                   REL_CODE_04,                                        *00786000
                   REQM_OPTION_04,                                     *00787000
                   TRAN_COUNT_04,                                      *00788000
                   TRAN_AMOUNT_04,                                     *00789000
                   ACCUM_DESC_04,                                      *00790000
                   ACCUM_COND_05,                                      *00791000
                   ACCUM_05,                                           *00792000
                   REL_CODE_05,                                        *00793000
                   REQM_OPTION_05,                                     *00794000
                   TRAN_COUNT_05,                                      *00795000
                   TRAN_AMOUNT_05,                                     *00796000
                   ACCUM_DESC_05,                                      *00797000
                   ACCUM_COND_06,                                      *00798000
                   ACCUM_06,                                           *00799000
                   REL_CODE_06,                                        *00800000
                   REQM_OPTION_06,                                     *00801000
                   TRAN_COUNT_06,                                      *00802000
                   TRAN_AMOUNT_06,                                     *00803000
                   ACCUM_DESC_06,                                      *00804000
                   ACCUM_COND_07,                                      *00805000
                   ACCUM_07,                                           *00806000
                   REL_CODE_07,                                        *00807000
                   REQM_OPTION_07,                                     *00808000
                   TRAN_COUNT_07,                                      *00809000
                   TRAN_AMOUNT_07,                                     *00810000
                   ACCUM_DESC_07,                                      *00811000
                   ACCUM_COND_08,                                      *00812000
                   ACCUM_08,                                           *00813000
                   REL_CODE_08,                                        *00814000
                   REQM_OPTION_08,                                     *00815000
                   TRAN_COUNT_08,                                      *00816000
                   TRAN_AMOUNT_08,                                     *00817000
                   ACCUM_DESC_08,                                      *00818000
                   ACCUM_COND_09,                                      *00819000
                   ACCUM_09,                                           *00820000
                   REL_CODE_09,                                        *00821000
                   REQM_OPTION_09,                                     *00822000
                   TRAN_COUNT_09,                                      *00823000
                   TRAN_AMOUNT_09,                                     *00824000
                   ACCUM_DESC_09,                                      *00825000
                   ACCUM_COND_10,                                      *00826000
                   ACCUM_10,                                           *00827000
                   REL_CODE_10,                                        *00828000
                   REQM_OPTION_10,                                     *00829000
                   TRAN_COUNT_10,                                      *00830000
                   TRAN_AMOUNT_10,                                     *00831000
                   ACCUM_DESC_10,                                      *00832000
                   ACCUM_COND_11,                                      *00833000
                   ACCUM_11,                                           *00834000
                   REL_CODE_11,                                        *00835000
                   REQM_OPTION_11,                                     *00836000
                   TRAN_COUNT_11,                                      *00837000
                   TRAN_AMOUNT_11,                                     *00838000
                   ACCUM_DESC_11,                                      *00839000
                   ACCUM_COND_12,                                      *00840000
                   ACCUM_12,                                           *00841000
                   REL_CODE_12,                                        *00842000
                   REQM_OPTION_12,                                     *00843000
                   TRAN_COUNT_12,                                      *00844000
                   TRAN_AMOUNT_12,                                     *00845000
                   ACCUM_DESC_12                                       *00846000
                 FROM S10                                              *00847000
                 WHERE                                                 *00848000
                   INST_NBR >=                                         *00849000
                     :INST                                             *00850000
                 ORDER BY INST_NBR ASC,                                *00851000
                   RECORD_NBR ASC,                                     *00852000
                   TRAN_PROFILE ASC                                    *00853000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00854000
         EXEC  SQL OPEN S10GE003                                        00855000
         MVC   SQWCSRCA,=A(CLSGE003)   SET CURSOR CLOSE ROUTINE ADDRESS 00856000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00857000
         BR    14                      RETURN TO CALLER                 00858000
         LTORG                                                          00859000
*                                                                       00860000
**********************************************************************  00861000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          00862000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                00863000
**********************************************************************  00864000
*                                                                       00865000
NXTXC0   DS    0H                                                       00866000
         USING NXTXC0,12               ESTABLISH BASE REGISTER          00867000
         MVI   SQWKMRP,X'87'           CLOSE CURSOR & SET HOST KEY 0    00868000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   00869000
         BALR  14,15                   MOVE REQUESTED DATA              00870000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      00871000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         00872000
         STH   1,SQWCSRSP              SAVE POINTER FOR NEXT CALL       00873000
         LA    12,NXTXC0P(1)           LOAD POINTER TO NEXT CURSOR      00874000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      00875000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     00876000
NXTXC0P  DC    A(0)                                                     00877000
         DC    A(NXTGT002)                                              00878000
         DC    A(NXTGT003)                                              00879000
         DC    A(NXTGT099)                                              00880000
         DC    A(NXTGT003)                                              00881000
         DC    A(NXTGT099)                                              00882000
         DC    A(NXTGT099)                                              00883000
NXTGT099 LA    0,4                     LOAD VALUE 4 IN REGISTER 0       00884000
         SR    1,0                     ADJUST BACK TO CURRENT POINTER   00885000
         STH   1,SQWCSRSP              SAVE POINTER FOR CURSOR CLOSE    00886000
         LA    0,100                   LOAD VALUE 100 IN REGISTER 0     00887000
         ST    0,SQLCODE               SET SQLCODE TO NO MORE ROWS      00888000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00889000
         BR    14                      RETURN TO SQI                    00890000
         LTORG                                                          00891000
*                                                                       00892000
NXTGT002 DS    0H                                                       00893000
         USING NXTGT002,12             ESTABLISH BASE REGISTER          00894000
         B     *+6                     BRANCH AROUND ADCON              00895000
BASGT002 DC    AL2(4096)                                                00896000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00897000
         AH    3,BASGT002              ADD 4K                           00898000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    00899000
         AH    4,BASGT002              ADD 4K                           00900000
         EXEC  SQL DECLARE S10GT002 CURSOR                             *00901000
               WITH ROWSET POSITIONING                                 *00902000
               FOR SELECT                                              *00903000
                   INST_NBR,                                           *00904000
                   RECORD_NBR,                                         *00905000
                   TRAN_PROFILE,                                       *00906000
                   AUDIT_DATE,                                         *00907000
                   AUDIT_TIME,                                         *00908000
                   AUDIT_USER,                                         *00909000
                   AUDIT_ORG,                                          *00910000
                   DESCRIPTION,                                        *00911000
                   GRACE_DAYS,                                         *00912000
                   ACCUM_COND_01,                                      *00913000
                   ACCUM_01,                                           *00914000
                   REL_CODE_01,                                        *00915000
                   REQM_OPTION_01,                                     *00916000
                   TRAN_COUNT_01,                                      *00917000
                   TRAN_AMOUNT_01,                                     *00918000
                   ACCUM_DESC_01,                                      *00919000
                   ACCUM_COND_02,                                      *00920000
                   ACCUM_02,                                           *00921000
                   REL_CODE_02,                                        *00922000
                   REQM_OPTION_02,                                     *00923000
                   TRAN_COUNT_02,                                      *00924000
                   TRAN_AMOUNT_02,                                     *00925000
                   ACCUM_DESC_02,                                      *00926000
                   ACCUM_COND_03,                                      *00927000
                   ACCUM_03,                                           *00928000
                   REL_CODE_03,                                        *00929000
                   REQM_OPTION_03,                                     *00930000
                   TRAN_COUNT_03,                                      *00931000
                   TRAN_AMOUNT_03,                                     *00932000
                   ACCUM_DESC_03,                                      *00933000
                   ACCUM_COND_04,                                      *00934000
                   ACCUM_04,                                           *00935000
                   REL_CODE_04,                                        *00936000
                   REQM_OPTION_04,                                     *00937000
                   TRAN_COUNT_04,                                      *00938000
                   TRAN_AMOUNT_04,                                     *00939000
                   ACCUM_DESC_04,                                      *00940000
                   ACCUM_COND_05,                                      *00941000
                   ACCUM_05,                                           *00942000
                   REL_CODE_05,                                        *00943000
                   REQM_OPTION_05,                                     *00944000
                   TRAN_COUNT_05,                                      *00945000
                   TRAN_AMOUNT_05,                                     *00946000
                   ACCUM_DESC_05,                                      *00947000
                   ACCUM_COND_06,                                      *00948000
                   ACCUM_06,                                           *00949000
                   REL_CODE_06,                                        *00950000
                   REQM_OPTION_06,                                     *00951000
                   TRAN_COUNT_06,                                      *00952000
                   TRAN_AMOUNT_06,                                     *00953000
                   ACCUM_DESC_06,                                      *00954000
                   ACCUM_COND_07,                                      *00955000
                   ACCUM_07,                                           *00956000
                   REL_CODE_07,                                        *00957000
                   REQM_OPTION_07,                                     *00958000
                   TRAN_COUNT_07,                                      *00959000
                   TRAN_AMOUNT_07,                                     *00960000
                   ACCUM_DESC_07,                                      *00961000
                   ACCUM_COND_08,                                      *00962000
                   ACCUM_08,                                           *00963000
                   REL_CODE_08,                                        *00964000
                   REQM_OPTION_08,                                     *00965000
                   TRAN_COUNT_08,                                      *00966000
                   TRAN_AMOUNT_08,                                     *00967000
                   ACCUM_DESC_08,                                      *00968000
                   ACCUM_COND_09,                                      *00969000
                   ACCUM_09,                                           *00970000
                   REL_CODE_09,                                        *00971000
                   REQM_OPTION_09,                                     *00972000
                   TRAN_COUNT_09,                                      *00973000
                   TRAN_AMOUNT_09,                                     *00974000
                   ACCUM_DESC_09,                                      *00975000
                   ACCUM_COND_10,                                      *00976000
                   ACCUM_10,                                           *00977000
                   REL_CODE_10,                                        *00978000
                   REQM_OPTION_10,                                     *00979000
                   TRAN_COUNT_10,                                      *00980000
                   TRAN_AMOUNT_10,                                     *00981000
                   ACCUM_DESC_10,                                      *00982000
                   ACCUM_COND_11,                                      *00983000
                   ACCUM_11,                                           *00984000
                   REL_CODE_11,                                        *00985000
                   REQM_OPTION_11,                                     *00986000
                   TRAN_COUNT_11,                                      *00987000
                   TRAN_AMOUNT_11,                                     *00988000
                   ACCUM_DESC_11,                                      *00989000
                   ACCUM_COND_12,                                      *00990000
                   ACCUM_12,                                           *00991000
                   REL_CODE_12,                                        *00992000
                   REQM_OPTION_12,                                     *00993000
                   TRAN_COUNT_12,                                      *00994000
                   TRAN_AMOUNT_12,                                     *00995000
                   ACCUM_DESC_12                                       *00996000
                 FROM S10                                              *00997000
                 WHERE                                                 *00998000
                   INST_NBR = :INST AND                                *00999000
                   RECORD_NBR >                                        *01000000
                     :RECNBR                                           *01001000
                 ORDER BY RECORD_NBR ASC,                              *01002000
                   TRAN_PROFILE ASC                                    *01003000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01004000
         EXEC  SQL OPEN S10GT002                                        01005000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01006000
         BNZ   *+14                    NO - RETURN ERROR                01007000
         MVC   SQWCSRCA,=A(CLSGT002)   SET CURSOR CLOSE ROUTINE ADDRESS 01008000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01009000
         BR    12                      RETURN TO FETCH ROUTINE          01010000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01011000
         BR    14                      RETURN TO CALLER                 01012000
         LTORG                                                          01013000
*                                                                       01014000
NXTGT003 DS    0H                                                       01015000
         USING NXTGT003,12             ESTABLISH BASE REGISTER          01016000
         B     *+6                     BRANCH AROUND ADCON              01017000
BASGT003 DC    AL2(4096)                                                01018000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01019000
         AH    3,BASGT003              ADD 4K                           01020000
         LR    4,3                     LOAD THIRD  BASE FOR SQLDSECT    01021000
         AH    4,BASGT003              ADD 4K                           01022000
         EXEC  SQL DECLARE S10GT003 CURSOR                             *01023000
               WITH ROWSET POSITIONING                                 *01024000
               FOR SELECT                                              *01025000
                   INST_NBR,                                           *01026000
                   RECORD_NBR,                                         *01027000
                   TRAN_PROFILE,                                       *01028000
                   AUDIT_DATE,                                         *01029000
                   AUDIT_TIME,                                         *01030000
                   AUDIT_USER,                                         *01031000
                   AUDIT_ORG,                                          *01032000
                   DESCRIPTION,                                        *01033000
                   GRACE_DAYS,                                         *01034000
                   ACCUM_COND_01,                                      *01035000
                   ACCUM_01,                                           *01036000
                   REL_CODE_01,                                        *01037000
                   REQM_OPTION_01,                                     *01038000
                   TRAN_COUNT_01,                                      *01039000
                   TRAN_AMOUNT_01,                                     *01040000
                   ACCUM_DESC_01,                                      *01041000
                   ACCUM_COND_02,                                      *01042000
                   ACCUM_02,                                           *01043000
                   REL_CODE_02,                                        *01044000
                   REQM_OPTION_02,                                     *01045000
                   TRAN_COUNT_02,                                      *01046000
                   TRAN_AMOUNT_02,                                     *01047000
                   ACCUM_DESC_02,                                      *01048000
                   ACCUM_COND_03,                                      *01049000
                   ACCUM_03,                                           *01050000
                   REL_CODE_03,                                        *01051000
                   REQM_OPTION_03,                                     *01052000
                   TRAN_COUNT_03,                                      *01053000
                   TRAN_AMOUNT_03,                                     *01054000
                   ACCUM_DESC_03,                                      *01055000
                   ACCUM_COND_04,                                      *01056000
                   ACCUM_04,                                           *01057000
                   REL_CODE_04,                                        *01058000
                   REQM_OPTION_04,                                     *01059000
                   TRAN_COUNT_04,                                      *01060000
                   TRAN_AMOUNT_04,                                     *01061000
                   ACCUM_DESC_04,                                      *01062000
                   ACCUM_COND_05,                                      *01063000
                   ACCUM_05,                                           *01064000
                   REL_CODE_05,                                        *01065000
                   REQM_OPTION_05,                                     *01066000
                   TRAN_COUNT_05,                                      *01067000
                   TRAN_AMOUNT_05,                                     *01068000
                   ACCUM_DESC_05,                                      *01069000
                   ACCUM_COND_06,                                      *01070000
                   ACCUM_06,                                           *01071000
                   REL_CODE_06,                                        *01072000
                   REQM_OPTION_06,                                     *01073000
                   TRAN_COUNT_06,                                      *01074000
                   TRAN_AMOUNT_06,                                     *01075000
                   ACCUM_DESC_06,                                      *01076000
                   ACCUM_COND_07,                                      *01077000
                   ACCUM_07,                                           *01078000
                   REL_CODE_07,                                        *01079000
                   REQM_OPTION_07,                                     *01080000
                   TRAN_COUNT_07,                                      *01081000
                   TRAN_AMOUNT_07,                                     *01082000
                   ACCUM_DESC_07,                                      *01083000
                   ACCUM_COND_08,                                      *01084000
                   ACCUM_08,                                           *01085000
                   REL_CODE_08,                                        *01086000
                   REQM_OPTION_08,                                     *01087000
                   TRAN_COUNT_08,                                      *01088000
                   TRAN_AMOUNT_08,                                     *01089000
                   ACCUM_DESC_08,                                      *01090000
                   ACCUM_COND_09,                                      *01091000
                   ACCUM_09,                                           *01092000
                   REL_CODE_09,                                        *01093000
                   REQM_OPTION_09,                                     *01094000
                   TRAN_COUNT_09,                                      *01095000
                   TRAN_AMOUNT_09,                                     *01096000
                   ACCUM_DESC_09,                                      *01097000
                   ACCUM_COND_10,                                      *01098000
                   ACCUM_10,                                           *01099000
                   REL_CODE_10,                                        *01100000
                   REQM_OPTION_10,                                     *01101000
                   TRAN_COUNT_10,                                      *01102000
                   TRAN_AMOUNT_10,                                     *01103000
                   ACCUM_DESC_10,                                      *01104000
                   ACCUM_COND_11,                                      *01105000
                   ACCUM_11,                                           *01106000
                   REL_CODE_11,                                        *01107000
                   REQM_OPTION_11,                                     *01108000
                   TRAN_COUNT_11,                                      *01109000
                   TRAN_AMOUNT_11,                                     *01110000
                   ACCUM_DESC_11,                                      *01111000
                   ACCUM_COND_12,                                      *01112000
                   ACCUM_12,                                           *01113000
                   REL_CODE_12,                                        *01114000
                   REQM_OPTION_12,                                     *01115000
                   TRAN_COUNT_12,                                      *01116000
                   TRAN_AMOUNT_12,                                     *01117000
                   ACCUM_DESC_12                                       *01118000
                 FROM S10                                              *01119000
                 WHERE                                                 *01120000
                   INST_NBR >                                          *01121000
                     :INST                                             *01122000
                 ORDER BY INST_NBR ASC,                                *01123000
                   RECORD_NBR ASC,                                     *01124000
                   TRAN_PROFILE ASC                                    *01125000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01126000
         EXEC  SQL OPEN S10GT003                                        01127000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01128000
         BNZ   *+14                    NO - RETURN ERROR                01129000
         MVC   SQWCSRCA,=A(CLSGT003)   SET CURSOR CLOSE ROUTINE ADDRESS 01130000
         L     12,SQWCSRRA             LOAD RETURN ADDRESS              01131000
         BR    12                      RETURN TO FETCH ROUTINE          01132000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01133000
         BR    14                      RETURN TO CALLER                 01134000
         LTORG                                                          01135000
*                                                                       01136000
**********************************************************************  01137000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               01138000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01139000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01140000
*     RETRIEVE THE ACTUAL ROW.                                          01141000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01142000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01143000
**********************************************************************  01144000
*                                                                       01145000
FETDC0   DS    0H                                                       01146000
         USING FETDC0,12               ESTABLISH BASE REGISTER          01147000
         MVC   SQWCSRRA,=A(FETDC0)     SET RETURN ROUTINE ADDRESS       01148000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01149000
         MVC   SQWRSFVC,=AL2(TBLCOLMS) FETCH ALL COLUMNS IN TABLE       01150000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01151000
         LA    12,FETDC0P(1)           LOAD POINTER TO FETCH ROUTINE    01152000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01153000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01154000
FETDC0P  DC    A(FETGE001)                                              01155000
         DC    A(FETGT002)                                              01156000
         DC    A(FETGT003)                                              01157000
         DC    A(FETGE002)                                              01158000
         DC    A(FETGT003)                                              01159000
         DC    A(FETGE003)                                              01160000
         DC    A(0)                                                     01161000
         LTORG                                                          01162000
*                                                                       01163000
**********************************************************************  01164000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01165000
* THE PRIMARY KEY:                                                      01166000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01167000
*     VERBS.                                                            01168000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01169000
*     RETRIEVE THE ACTUAL ROW.                                          01170000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01171000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01172000
*     WILL BE THRU THE UPDATE CURSOR.                                   01173000
**********************************************************************  01174000
*                                                                       01175000
FETKC0   DS    0H                                                       01176000
         USING FETKC0,12               ESTABLISH BASE REGISTER          01177000
         MVC   SQWCSRRA,=A(FETKC0)     SET RETURN ROUTINE ADDRESS       01178000
         MVC   SQWCSRBR,=A(NXTXC0)     SET CURSOR ROUTINE ADDRESS       01179000
         MVC   SQWRSFVC,=AL2(KY0COLMS) ONLY FETCH KEY COLUMNS           01180000
         LH    1,SQWCSRSP              LOAD CURRENT CURSOR POINTER      01181000
         LA    12,FETKC0P(1)           LOAD POINTER TO FETCH ROUTINE    01182000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01183000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01184000
FETKC0P  DC    A(FETGE001)                                              01185000
         DC    A(FETGT002)                                              01186000
         DC    A(FETGT003)                                              01187000
         DC    A(FETGE002)                                              01188000
         DC    A(FETGT003)                                              01189000
         DC    A(FETGE003)                                              01190000
         DC    A(0)                                                     01191000
         LTORG                                                          01192000
*                                                                       01193000
FETGE001 DS    0H                                                       01194000
         USING FETGE001,12             ESTABLISH BASE REGISTER          01195000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01196000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01197000
         BALR  14,15                   MOVE REQUESTED DATA              01198000
         EXEC  SQL FETCH NEXT ROWSET FROM S10GE001                     *01199000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01200000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01201000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01202000
         BALR  14,15                   MOVE REQUESTED DATA              01203000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01204000
         BR    14                      RETURN TO CALLER                 01205000
         LTORG                                                          01206000
*                                                                       01207000
FETGE002 DS    0H                                                       01208000
         USING FETGE002,12             ESTABLISH BASE REGISTER          01209000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01210000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01211000
         BALR  14,15                   MOVE REQUESTED DATA              01212000
         EXEC  SQL FETCH NEXT ROWSET FROM S10GE002                     *01213000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01214000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01215000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01216000
         BALR  14,15                   MOVE REQUESTED DATA              01217000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01218000
         BR    14                      RETURN TO CALLER                 01219000
         LTORG                                                          01220000
*                                                                       01221000
FETGE003 DS    0H                                                       01222000
         USING FETGE003,12             ESTABLISH BASE REGISTER          01223000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01224000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01225000
         BALR  14,15                   MOVE REQUESTED DATA              01226000
         EXEC  SQL FETCH NEXT ROWSET FROM S10GE003                     *01227000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01228000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01229000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01230000
         BALR  14,15                   MOVE REQUESTED DATA              01231000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01232000
         BR    14                      RETURN TO CALLER                 01233000
         LTORG                                                          01234000
*                                                                       01235000
FETGT002 DS    0H                                                       01236000
         USING FETGT002,12             ESTABLISH BASE REGISTER          01237000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01238000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01239000
         BALR  14,15                   MOVE REQUESTED DATA              01240000
         EXEC  SQL FETCH NEXT ROWSET FROM S10GT002                     *01241000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01242000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01243000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01244000
         BALR  14,15                   MOVE REQUESTED DATA              01245000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01246000
         BR    14                      RETURN TO CALLER                 01247000
         LTORG                                                          01248000
*                                                                       01249000
FETGT003 DS    0H                                                       01250000
         USING FETGT003,12             ESTABLISH BASE REGISTER          01251000
         MVI   SQWKMRP,X'04'           CHECK FOR MORE ROWS IN ROWSET    01252000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01253000
         BALR  14,15                   MOVE REQUESTED DATA              01254000
         EXEC  SQL FETCH NEXT ROWSET FROM S10GT003                     *01255000
               FOR :SQWRSRMX ROWS INTO DESCRIPTOR :SQDSQLDA             01256000
         MVI   SQWKMRP,X'05'           MOVE HOST ARRAY DATA TO RECORD   01257000
         L     15,SQW@SQRX             LOAD INTERFACE ROUTINE ADDRESS   01258000
         BALR  14,15                   MOVE REQUESTED DATA              01259000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01260000
         BR    14                      RETURN TO CALLER                 01261000
         LTORG                                                          01262000
*                                                                       01263000
**********************************************************************  01264000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01265000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01266000
*     AND GET-NEXT-LOCK VERBS.                                          01267000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01268000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01269000
**********************************************************************  01270000
*                                                                       01271000
CLSXC0   DS    0H                                                       01272000
         USING CLSXC0,12               ESTABLISH BASE REGISTER          01273000
         L     12,SQWCSRCA             SET CURSOR CLOSE ROUTINE ADDRESS 01274000
         XC    SQWCSRCA,SQWCSRCA       CLEAR CURSOR CLOSE ROUTINE ADDR  01275000
         BR    12                      GO TO CURSOR CLOSE ROUTINE       01276000
         LTORG                                                          01277000
*                                                                       01278000
CLSGE001 DS    0H                                                       01279000
         USING CLSGE001,12             ESTABLISH BASE REGISTER          01280000
         EXEC  SQL CLOSE S10GE001                                       01281000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01282000
         BR    14                      RETURN TO CALLER                 01283000
         LTORG                                                          01284000
*                                                                       01285000
CLSGE002 DS    0H                                                       01286000
         USING CLSGE002,12             ESTABLISH BASE REGISTER          01287000
         EXEC  SQL CLOSE S10GE002                                       01288000
         L     14,SQW@RET                                               01289000
         BR    14                                                       01290000
         LTORG                                                          01291000
*                                                                       01292000
CLSGE003 DS    0H                                                       01293000
         USING CLSGE003,12             ESTABLISH BASE REGISTER          01294000
         EXEC  SQL CLOSE S10GE003                                       01295000
         L     14,SQW@RET                                               01296000
         BR    14                                                       01297000
         LTORG                                                          01298000
*                                                                       01299000
CLSGT002 DS    0H                                                       01300000
         USING CLSGT002,12             ESTABLISH BASE REGISTER          01301000
         EXEC  SQL CLOSE S10GT002                                       01302000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01303000
         BR    14                      RETURN TO CALLER                 01304000
         LTORG                                                          01305000
*                                                                       01306000
CLSGT003 DS    0H                                                       01307000
         USING CLSGT003,12             ESTABLISH BASE REGISTER          01308000
         EXEC  SQL CLOSE S10GT003                                       01309000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01310000
         BR    14                      RETURN TO CALLER                 01311000
         LTORG                                                          01312000
*                                                                       01313000
**********************************************************************  01314000
* ALTERNATE KEY 1 NOT DEFINED                                           01315000
**********************************************************************  01316000
*                                                                       01317000
SELIN1   DS    0H                                                       01318000
SELKY1   DS    0H                                                       01319000
SELXC1   DS    0H                                                       01320000
FETDC1   DS    0H                                                       01321000
FETKC1   DS    0H                                                       01322000
CLSXC1   DS    0H                                                       01323000
         DC    X'00DEAD01'             FORCE S0C1 ABEND                 01324000
*                                                                       01325000
**********************************************************************  01326000
* ALTERNATE KEY 2 NOT DEFINED                                           01327000
**********************************************************************  01328000
*                                                                       01329000
SELIN2   DS    0H                                                       01330000
SELKY2   DS    0H                                                       01331000
SELXC2   DS    0H                                                       01332000
FETDC2   DS    0H                                                       01333000
FETKC2   DS    0H                                                       01334000
CLSXC2   DS    0H                                                       01335000
         DC    X'00DEAD02'             FORCE S0C1 ABEND                 01336000
*                                                                       01337000
**********************************************************************  01338000
* ALTERNATE KEY 3 NOT DEFINED                                           01339000
**********************************************************************  01340000
*                                                                       01341000
SELIN3   DS    0H                                                       01342000
SELKY3   DS    0H                                                       01343000
SELXC3   DS    0H                                                       01344000
FETDC3   DS    0H                                                       01345000
FETKC3   DS    0H                                                       01346000
CLSXC3   DS    0H                                                       01347000
         DC    X'00DEAD03'             FORCE S0C1 ABEND                 01348000
*                                                                       01349000
         DS    0H                      END OF SQL STATEMENTS            01350000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01351000
*                                                                       01352000
**********************************************************************  01353000
* DUMMY ENTRY POINT DSNHLI                                              01354000
**********************************************************************  01355000
*                                                                       01356000
         ENTRY DSNHLI                                                   01357000
DSNHLI   DS    0H                                                       01358000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01359000
         BR    15                      BRANCH TO ATTACH FACILITY        01360000
*                                                                       01361000
**********************************************************************  01362000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01363000
**********************************************************************  01364000
*                                                                       01365000
* CONVTAB1 TABLE ENTRY FORMAT IS:                                       01366000
*        DC    H'RRRR',H'VVVV',H'LLLL',X'KK',X'DD'                      01367000
* OR:                                                                   01368000
*        DC    H'RRRR',H'VVVV',X'ZZPP',X'KK',X'DD'                      01369000
* WHERE:                                                                01370000
*   RRRR = RECORD AREA OFFSET                                           01371000
*   VVVV = HOST VARIABLE AREA OFFSET                                    01372000
*   LLLL = HALFWORD LENGTH TO MOVE                                      01373000
*   ZZPP = CONVERT ZONED/PACKED LENGTHS (MINUS 1)                       01374000
*   KK   = KEY FIELD MASK:                                              01375000
*            80 = KEY 0 FIELD                                           01376000
*            40 = KEY 1 FIELD                                           01377000
*            20 = KEY 2 FIELD                                           01378000
*            10 = KEY 3 FIELD                                           01379000
*   DD   = DATA FIELD MASK:                                             01380000
*            80 = RECORD FIELD IS PACKED                                01381000
*            40 = HOST VARIABLE IS PACKED                               01382000
*            20 = NULLABLE FIELD                                        01383000
*            01 = DATE FIELD                                            01384000
*            02 = TIME FIELD                                            01385000
*                                                                       01386000
CONVTAB1 DS    0H                      RECORD/HOST VARIABLE CONVERSIONS 01387000
         DC    H'0000',H'0000',H'0014',X'80',X'00'                      01388000
         DC    H'0014',H'0014',H'0416',X'00',X'00'                      01389000
         DC    8X'FF'                                                   01390000
*                                                                       01391000
* CONVTAB2 TABLE COLUMNS ENTRY FORMAT IS:                               01392000
*        DC    H'RRRR',H'LLLL',H'TTTT'                                  01393000
* OR:                                                                   01394000
*        DC    H'RRRR',X'PPSS',H'TTTT'                                  01395000
* WHERE:                                                                01396000
*   RRRR = RECORD AREA OFFSET                                           01397000
*   LLLL = HALFWORD LENGTH OF HOST VARIABLE (NON-DECIMAL DATA TYPE)     01398000
*   PPSS = PRECISION AND SCALE (DECIMAL DATA TYPE)                      01399000
*   TTTT = SQLDA DATA TYPE:                                             01400000
*            452 = CHAR       453 = CHAR NULLABLE                       01401000
*            484 = DECIMAL    485 = DECIMAL NULLABLE                    01402000
*            496 = INTEGER    497 = INTEGER NULLABLE                    01403000
*            500 = SMALLINT   501 = SMALLINT NULLABLE                   01404000
*                                                                       01405000
CONVTAB2 DS    0F                      RECORD DATA ATTRIBUTE TABLE      01406000
         DC    AL4(TBLCOLMS*44+16)     TOTAL SQLDA SIZE                 01407000
         DC    AL2(TBLCOLMS)           NUMBER OF COLUMNS IN TABLE       01408000
         DC    AL2(KY0COLMS)           NUMBER OF PRIMARY KEY COLUMNS    01409000
         DC    AL2(KY1COLMS)           NUMBER OF ALT1 KEY COLUMNS       01410000
         DC    AL2(KY2COLMS)           NUMBER OF ALT2 KEY COLUMNS       01411000
         DC    AL2(KY3COLMS)           NUMBER OF ALT3 KEY COLUMNS       01412000
         DC    AL2(00430)              SUMMATION OF ALL COLUMN LENGTHS  01413000
         DC    AL2(01000)              PRIMARY MULTIROW FETCH ARRAY     01414000
         DC    AL2(00000)              ALT 1 MULTIROW FETCH ARRAY       01415000
         DC    AL2(00000)              ALT 2 MULTIROW FETCH ARRAY       01416000
         DC    AL2(00000)              ALT 3 MULTIROW FETCH ARRAY       01417000
         DC    AL2(00000)              PRIMARY KEY LOW VALUE LEVEL      01418000
         DC    AL2(00000)              ALT 1 KEY LOW VALUE LEVEL        01419000
         DC    AL2(00000)              ALT 2 KEY LOW VALUE LEVEL        01420000
         DC    AL2(00000)              ALT 3 KEY LOW VALUE LEVEL        01421000
CONVDATA DS    0H                                                       01422000
         DC    H'0000',H'0004',H'452'  INST_NBR                         01423000
         DC    H'0004',H'0004',H'452'  RECORD_NBR                       01424000
         DC    H'0008',H'0006',H'452'  TRAN_PROFILE                     01425000
KEYCOLMS EQU   (*-CONVDATA)/6          NUMBER OF KEY COLUMNS IN TABLE   01426000
         DC    H'0014',X'0900',H'484'  AUDIT_DATE                       01427000
         DC    H'0019',X'0900',H'484'  AUDIT_TIME                       01428000
         DC    H'0024',H'0008',H'452'  AUDIT_USER                       01429000
         DC    H'0032',H'0006',H'452'  AUDIT_ORG                        01430000
         DC    H'0038',H'0030',H'452'  DESCRIPTION                      01431000
         DC    H'0068',H'0002',H'452'  GRACE_DAYS                       01432000
         DC    H'0070',H'0001',H'452'  ACCUM_COND_01                    01433000
         DC    H'0071',H'0002',H'452'  ACCUM_01                         01434000
         DC    H'0073',H'0002',H'452'  REL_CODE_01                      01435000
         DC    H'0075',H'0001',H'452'  REQM_OPTION_01                   01436000
         DC    H'0076',X'0500',H'484'  TRAN_COUNT_01                    01437000
         DC    H'0079',X'0B02',H'484'  TRAN_AMOUNT_01                   01438000
         DC    H'0085',H'0015',H'452'  ACCUM_DESC_01                    01439000
         DC    H'0100',H'0001',H'452'  ACCUM_COND_02                    01440000
         DC    H'0101',H'0002',H'452'  ACCUM_02                         01441000
         DC    H'0103',H'0002',H'452'  REL_CODE_02                      01442000
         DC    H'0105',H'0001',H'452'  REQM_OPTION_02                   01443000
         DC    H'0106',X'0500',H'484'  TRAN_COUNT_02                    01444000
         DC    H'0109',X'0B02',H'484'  TRAN_AMOUNT_02                   01445000
         DC    H'0115',H'0015',H'452'  ACCUM_DESC_02                    01446000
         DC    H'0130',H'0001',H'452'  ACCUM_COND_03                    01447000
         DC    H'0131',H'0002',H'452'  ACCUM_03                         01448000
         DC    H'0133',H'0002',H'452'  REL_CODE_03                      01449000
         DC    H'0135',H'0001',H'452'  REQM_OPTION_03                   01450000
         DC    H'0136',X'0500',H'484'  TRAN_COUNT_03                    01451000
         DC    H'0139',X'0B02',H'484'  TRAN_AMOUNT_03                   01452000
         DC    H'0145',H'0015',H'452'  ACCUM_DESC_03                    01453000
         DC    H'0160',H'0001',H'452'  ACCUM_COND_04                    01454000
         DC    H'0161',H'0002',H'452'  ACCUM_04                         01455000
         DC    H'0163',H'0002',H'452'  REL_CODE_04                      01456000
         DC    H'0165',H'0001',H'452'  REQM_OPTION_04                   01457000
         DC    H'0166',X'0500',H'484'  TRAN_COUNT_04                    01458000
         DC    H'0169',X'0B02',H'484'  TRAN_AMOUNT_04                   01459000
         DC    H'0175',H'0015',H'452'  ACCUM_DESC_04                    01460000
         DC    H'0190',H'0001',H'452'  ACCUM_COND_05                    01461000
         DC    H'0191',H'0002',H'452'  ACCUM_05                         01462000
         DC    H'0193',H'0002',H'452'  REL_CODE_05                      01463000
         DC    H'0195',H'0001',H'452'  REQM_OPTION_05                   01464000
         DC    H'0196',X'0500',H'484'  TRAN_COUNT_05                    01465000
         DC    H'0199',X'0B02',H'484'  TRAN_AMOUNT_05                   01466000
         DC    H'0205',H'0015',H'452'  ACCUM_DESC_05                    01467000
         DC    H'0220',H'0001',H'452'  ACCUM_COND_06                    01468000
         DC    H'0221',H'0002',H'452'  ACCUM_06                         01469000
         DC    H'0223',H'0002',H'452'  REL_CODE_06                      01470000
         DC    H'0225',H'0001',H'452'  REQM_OPTION_06                   01471000
         DC    H'0226',X'0500',H'484'  TRAN_COUNT_06                    01472000
         DC    H'0229',X'0B02',H'484'  TRAN_AMOUNT_06                   01473000
         DC    H'0235',H'0015',H'452'  ACCUM_DESC_06                    01474000
         DC    H'0250',H'0001',H'452'  ACCUM_COND_07                    01475000
         DC    H'0251',H'0002',H'452'  ACCUM_07                         01476000
         DC    H'0253',H'0002',H'452'  REL_CODE_07                      01477000
         DC    H'0255',H'0001',H'452'  REQM_OPTION_07                   01478000
         DC    H'0256',X'0500',H'484'  TRAN_COUNT_07                    01479000
         DC    H'0259',X'0B02',H'484'  TRAN_AMOUNT_07                   01480000
         DC    H'0265',H'0015',H'452'  ACCUM_DESC_07                    01481000
         DC    H'0280',H'0001',H'452'  ACCUM_COND_08                    01482000
         DC    H'0281',H'0002',H'452'  ACCUM_08                         01483000
         DC    H'0283',H'0002',H'452'  REL_CODE_08                      01484000
         DC    H'0285',H'0001',H'452'  REQM_OPTION_08                   01485000
         DC    H'0286',X'0500',H'484'  TRAN_COUNT_08                    01486000
         DC    H'0289',X'0B02',H'484'  TRAN_AMOUNT_08                   01487000
         DC    H'0295',H'0015',H'452'  ACCUM_DESC_08                    01488000
         DC    H'0310',H'0001',H'452'  ACCUM_COND_09                    01489000
         DC    H'0311',H'0002',H'452'  ACCUM_09                         01490000
         DC    H'0313',H'0002',H'452'  REL_CODE_09                      01491000
         DC    H'0315',H'0001',H'452'  REQM_OPTION_09                   01492000
         DC    H'0316',X'0500',H'484'  TRAN_COUNT_09                    01493000
         DC    H'0319',X'0B02',H'484'  TRAN_AMOUNT_09                   01494000
         DC    H'0325',H'0015',H'452'  ACCUM_DESC_09                    01495000
         DC    H'0340',H'0001',H'452'  ACCUM_COND_10                    01496000
         DC    H'0341',H'0002',H'452'  ACCUM_10                         01497000
         DC    H'0343',H'0002',H'452'  REL_CODE_10                      01498000
         DC    H'0345',H'0001',H'452'  REQM_OPTION_10                   01499000
         DC    H'0346',X'0500',H'484'  TRAN_COUNT_10                    01500000
         DC    H'0349',X'0B02',H'484'  TRAN_AMOUNT_10                   01501000
         DC    H'0355',H'0015',H'452'  ACCUM_DESC_10                    01502000
         DC    H'0370',H'0001',H'452'  ACCUM_COND_11                    01503000
         DC    H'0371',H'0002',H'452'  ACCUM_11                         01504000
         DC    H'0373',H'0002',H'452'  REL_CODE_11                      01505000
         DC    H'0375',H'0001',H'452'  REQM_OPTION_11                   01506000
         DC    H'0376',X'0500',H'484'  TRAN_COUNT_11                    01507000
         DC    H'0379',X'0B02',H'484'  TRAN_AMOUNT_11                   01508000
         DC    H'0385',H'0015',H'452'  ACCUM_DESC_11                    01509000
         DC    H'0400',H'0001',H'452'  ACCUM_COND_12                    01510000
         DC    H'0401',H'0002',H'452'  ACCUM_12                         01511000
         DC    H'0403',H'0002',H'452'  REL_CODE_12                      01512000
         DC    H'0405',H'0001',H'452'  REQM_OPTION_12                   01513000
         DC    H'0406',X'0500',H'484'  TRAN_COUNT_12                    01514000
         DC    H'0409',X'0B02',H'484'  TRAN_AMOUNT_12                   01515000
         DC    H'0415',H'0015',H'452'  ACCUM_DESC_12                    01516000
TBLCOLMS EQU   (*-CONVDATA)/6          NUMBER OF COLUMNS IN TABLE       01517000
KY0COLMS EQU   00003                   NUMBER OF PRIMARY KEY COLUMNS    01518000
KY1COLMS EQU   00000                   NUMBER OF ALT 1 KEY COLUMNS      01519000
KY2COLMS EQU   00000                   NUMBER OF ALT 2 KEY COLUMNS      01520000
KY3COLMS EQU   00000                   NUMBER OF ALT 3 KEY COLUMNS      01521000
*                                                                       01522000
         LTORG                                                          01523000
         END                                                            01524000
