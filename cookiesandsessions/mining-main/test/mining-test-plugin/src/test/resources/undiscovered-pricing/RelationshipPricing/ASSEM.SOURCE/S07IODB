* REL=S07IODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  S07IODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE S07 FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL190                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
RECNBR   DS    CL4                                                      00039000
BRREGNCD DS    CL6                                                      00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
INCLEXCL DS    CL1                                                      00045000
BRREGN01 DS    PL3'0.'                                                  00046000
BRREGN02 DS    PL3'0.'                                                  00047000
BRREGN03 DS    PL3'0.'                                                  00048000
BRREGN04 DS    PL3'0.'                                                  00049000
BRREGN05 DS    PL3'0.'                                                  00050000
BRREGN06 DS    PL3'0.'                                                  00051000
BRREGN07 DS    PL3'0.'                                                  00052000
BRREGN08 DS    PL3'0.'                                                  00053000
BRREGN09 DS    PL3'0.'                                                  00054000
BRREGN10 DS    PL3'0.'                                                  00055000
BRREGN11 DS    PL3'0.'                                                  00056000
BRREGN12 DS    PL3'0.'                                                  00057000
BRREGN13 DS    PL3'0.'                                                  00058000
BRREGN14 DS    PL3'0.'                                                  00059000
BRREGN15 DS    PL3'0.'                                                  00060000
BRREGN16 DS    PL3'0.'                                                  00061000
BRREGN17 DS    PL3'0.'                                                  00062000
BRREGN18 DS    PL3'0.'                                                  00063000
BRREGN19 DS    PL3'0.'                                                  00064000
BRREGN20 DS    PL3'0.'                                                  00065000
BRREGN21 DS    PL3'0.'                                                  00066000
BRREGN22 DS    PL3'0.'                                                  00067000
BRREGN23 DS    PL3'0.'                                                  00068000
BRREGN24 DS    PL3'0.'                                                  00069000
BRREGN25 DS    PL3'0.'                                                  00070000
BRREGN26 DS    PL3'0.'                                                  00071000
BRREGN27 DS    PL3'0.'                                                  00072000
BRREGN28 DS    PL3'0.'                                                  00073000
BRREGN29 DS    PL3'0.'                                                  00074000
BRREGN30 DS    PL3'0.'                                                  00075000
BRREGN31 DS    PL3'0.'                                                  00076000
BRREGN32 DS    PL3'0.'                                                  00077000
BRREGN33 DS    PL3'0.'                                                  00078000
BRREGN34 DS    PL3'0.'                                                  00079000
BRREGN35 DS    PL3'0.'                                                  00080000
BRREGN36 DS    PL3'0.'                                                  00081000
BRREGN37 DS    PL3'0.'                                                  00082000
BRREGN38 DS    PL3'0.'                                                  00083000
BRREGN39 DS    PL3'0.'                                                  00084000
BRREGN40 DS    PL3'0.'                                                  00085000
BRREGN41 DS    PL3'0.'                                                  00086000
BRREGN42 DS    PL3'0.'                                                  00087000
BRREGN43 DS    PL3'0.'                                                  00088000
BRREGN44 DS    PL3'0.'                                                  00089000
BRREGN45 DS    PL3'0.'                                                  00090000
BRREGN46 DS    PL3'0.'                                                  00091000
BRREGN47 DS    PL3'0.'                                                  00092000
BRREGN48 DS    PL3'0.'                                                  00093000
BRREGN49 DS    PL3'0.'                                                  00094000
BRREGN50 DS    PL3'0.'                                                  00095000
TABLETYP DS    CL1                                                      00096000
*                                                                       00097000
*                                                                       00098000
**********************************************************************  00099000
* PROGRAM TABLE HEADER SECTION:                                         00100000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00101000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00102000
**********************************************************************  00103000
*                                                                       00104000
S07IODB  CSECT                         PROGRAM TABLE SECTION            00105000
S07IODB  AMODE ANY                                                      00106000
S07IODB  RMODE ANY                                                      00107000
         DC    CL9'S07IODB'            PROGRAM ID                       00108000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00109000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00110000
         DC    A(0)                    RESERVED                         00111000
         DC    A(0)                    RESERVED                         00112000
         DC    24CL1' '                RESERVED                         00113000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00114000
*                                                                       00115000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00116000
         DC    CL29'WWW.INFOR.COM                '                      00116001
*                                                                       00117000
*                                                                       00118000
**********************************************************************  00119000
* STATEMENT TABLE SECTION:                                              00120000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00121000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00122000
*   SHOULD NOT BE MODIFIED.                                             00123000
**********************************************************************  00124000
*                                                                       00125000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00126000
STM#TAB  AMODE ANY                                                      00127000
STM#TAB  RMODE ANY                                                      00128000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00129000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00130000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00131000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00132000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00133000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00134000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00135000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00136000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00137000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00138000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00139000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00140000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00141000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00142000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00143000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00144000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00145000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00146000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00147000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00148000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00149000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00150000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00151000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00152000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00153000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00154000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00155000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00156000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00157000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00158000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00159000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00160000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00161000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00162000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00163000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00164000
         DC    A(SQL#0036)             INSERT STATEMENT                 00165000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00166000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00167000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00168000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00169000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00170000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00171000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00172000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00173000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00174000
         DC    4X'FF'                                                   00175000
*                                                                       00176000
*                                                                       00177000
**********************************************************************  00178000
* SQL STATEMENT SECTION:                                                00179000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00180000
*     TO SUPPORT THIS TABLE.                                            00181000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00182000
*     ARE EQUIVALENT.                                                   00183000
**********************************************************************  00184000
*                                                                       00185000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00186000
SQL#STMT AMODE ANY                                                      00187000
SQL#STMT RMODE ANY                                                      00188000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00189000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00190000
         USING COM#AREA,11             ADDRESS COMMAREA                 00191000
*                                                                       00192000
*                                                                       00193000
**********************************************************************  00194000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00195000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00196000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00197000
**********************************************************************  00198000
*                                                                       00199000
SQL#0000 DS    0H                                                       00200000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00201000
         B     *+6                     BRANCH AROUND ADCON              00202000
BASE0000 DC    AL2(4096)                                                00203000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00204000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00205000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00206000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00207000
         AH    3,BASE0000              ADD 4K                           00208000
         EXEC  SQL                                                     *00209000
               SELECT AUDIT_DATE,                                      *00210000
                   AUDIT_TIME,                                         *00211000
                   AUDIT_USER,                                         *00212000
                   AUDIT_ORG,                                          *00213000
                   INCL_EXCL_OPT,                                      *00214000
                   BRCH_REGION_01,                                     *00215000
                   BRCH_REGION_02,                                     *00216000
                   BRCH_REGION_03,                                     *00217000
                   BRCH_REGION_04,                                     *00218000
                   BRCH_REGION_05,                                     *00219000
                   BRCH_REGION_06,                                     *00220000
                   BRCH_REGION_07,                                     *00221000
                   BRCH_REGION_08,                                     *00222000
                   BRCH_REGION_09,                                     *00223000
                   BRCH_REGION_10,                                     *00224000
                   BRCH_REGION_11,                                     *00225000
                   BRCH_REGION_12,                                     *00226000
                   BRCH_REGION_13,                                     *00227000
                   BRCH_REGION_14,                                     *00228000
                   BRCH_REGION_15,                                     *00229000
                   BRCH_REGION_16,                                     *00230000
                   BRCH_REGION_17,                                     *00231000
                   BRCH_REGION_18,                                     *00232000
                   BRCH_REGION_19,                                     *00233000
                   BRCH_REGION_20,                                     *00234000
                   BRCH_REGION_21,                                     *00235000
                   BRCH_REGION_22,                                     *00236000
                   BRCH_REGION_23,                                     *00237000
                   BRCH_REGION_24,                                     *00238000
                   BRCH_REGION_25,                                     *00239000
                   BRCH_REGION_26,                                     *00240000
                   BRCH_REGION_27,                                     *00241000
                   BRCH_REGION_28,                                     *00242000
                   BRCH_REGION_29,                                     *00243000
                   BRCH_REGION_30,                                     *00244000
                   BRCH_REGION_31,                                     *00245000
                   BRCH_REGION_32,                                     *00246000
                   BRCH_REGION_33,                                     *00247000
                   BRCH_REGION_34,                                     *00248000
                   BRCH_REGION_35,                                     *00249000
                   BRCH_REGION_36,                                     *00250000
                   BRCH_REGION_37,                                     *00251000
                   BRCH_REGION_38,                                     *00252000
                   BRCH_REGION_39,                                     *00253000
                   BRCH_REGION_40,                                     *00254000
                   BRCH_REGION_41,                                     *00255000
                   BRCH_REGION_42,                                     *00256000
                   BRCH_REGION_43,                                     *00257000
                   BRCH_REGION_44,                                     *00258000
                   BRCH_REGION_45,                                     *00259000
                   BRCH_REGION_46,                                     *00260000
                   BRCH_REGION_47,                                     *00261000
                   BRCH_REGION_48,                                     *00262000
                   BRCH_REGION_49,                                     *00263000
                   BRCH_REGION_50,                                     *00264000
                   TABLE_TYPE                                          *00265000
                 INTO :AUDDATE,                                        *00266000
                   :AUDTIME,                                           *00267000
                   :AUDUSER,                                           *00268000
                   :AUDORG,                                            *00269000
                   :INCLEXCL,                                          *00270000
                   :BRREGN01,                                          *00271000
                   :BRREGN02,                                          *00272000
                   :BRREGN03,                                          *00273000
                   :BRREGN04,                                          *00274000
                   :BRREGN05,                                          *00275000
                   :BRREGN06,                                          *00276000
                   :BRREGN07,                                          *00277000
                   :BRREGN08,                                          *00278000
                   :BRREGN09,                                          *00279000
                   :BRREGN10,                                          *00280000
                   :BRREGN11,                                          *00281000
                   :BRREGN12,                                          *00282000
                   :BRREGN13,                                          *00283000
                   :BRREGN14,                                          *00284000
                   :BRREGN15,                                          *00285000
                   :BRREGN16,                                          *00286000
                   :BRREGN17,                                          *00287000
                   :BRREGN18,                                          *00288000
                   :BRREGN19,                                          *00289000
                   :BRREGN20,                                          *00290000
                   :BRREGN21,                                          *00291000
                   :BRREGN22,                                          *00292000
                   :BRREGN23,                                          *00293000
                   :BRREGN24,                                          *00294000
                   :BRREGN25,                                          *00295000
                   :BRREGN26,                                          *00296000
                   :BRREGN27,                                          *00297000
                   :BRREGN28,                                          *00298000
                   :BRREGN29,                                          *00299000
                   :BRREGN30,                                          *00300000
                   :BRREGN31,                                          *00301000
                   :BRREGN32,                                          *00302000
                   :BRREGN33,                                          *00303000
                   :BRREGN34,                                          *00304000
                   :BRREGN35,                                          *00305000
                   :BRREGN36,                                          *00306000
                   :BRREGN37,                                          *00307000
                   :BRREGN38,                                          *00308000
                   :BRREGN39,                                          *00309000
                   :BRREGN40,                                          *00310000
                   :BRREGN41,                                          *00311000
                   :BRREGN42,                                          *00312000
                   :BRREGN43,                                          *00313000
                   :BRREGN44,                                          *00314000
                   :BRREGN45,                                          *00315000
                   :BRREGN46,                                          *00316000
                   :BRREGN47,                                          *00317000
                   :BRREGN48,                                          *00318000
                   :BRREGN49,                                          *00319000
                   :BRREGN50,                                          *00320000
                   :TABLETYP                                           *00321000
                 FROM S07                                              *00322000
                 WHERE INST_NBR = :INST AND                            *00323000
                   RECORD_NBR = :RECNBR AND                            *00324000
                   BRCH_REGN_CODE = :BRREGNCD                          *00325000
                 FETCH FIRST 1 ROW ONLY                                 00326000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00327000
         BALR  4,5                     MOVE INTO RECORD AREA            00328000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00329000
         BR    14                      RETURN TO CALLER                 00330000
         LTORG                                                          00331000
*                                                                       00332000
*                                                                       00333000
**********************************************************************  00334000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00335000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00336000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00337000
**********************************************************************  00338000
*                                                                       00339000
SQL#0001 DS    0H                                                       00340000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00341000
         LA    15,255                  SET RETURN CODE                  00342000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00343000
         BR    14                      RETURN TO CALLER                 00344000
         LTORG                                                          00345000
*                                                                       00346000
*                                                                       00347000
**********************************************************************  00348000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00349000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00350000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00351000
**********************************************************************  00352000
*                                                                       00353000
SQL#0002 DS    0H                                                       00354000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00355000
         LA    15,255                  SET RETURN CODE                  00356000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00357000
         BR    14                      RETURN TO CALLER                 00358000
         LTORG                                                          00359000
*                                                                       00360000
*                                                                       00361000
**********************************************************************  00362000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00363000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00364000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00365000
**********************************************************************  00366000
*                                                                       00367000
SQL#0003 DS    0H                                                       00368000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00369000
         LA    15,255                  SET RETURN CODE                  00370000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00371000
         BR    14                      RETURN TO CALLER                 00372000
         LTORG                                                          00373000
*                                                                       00374000
*                                                                       00375000
**********************************************************************  00376000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00377000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00378000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00379000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00380000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00381000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00382000
*     UPDATE STATEMENT TO MATCH.                                        00383000
**********************************************************************  00384000
*                                                                       00385000
SQL#0004 DS    0H                                                       00386000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00387000
         B     *+6                     BRANCH AROUND ADCON              00388000
BASE0004 DC    AL2(4096)                                                00389000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00390000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00391000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00392000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00393000
         AH    3,BASE0004              ADD 4K                           00394000
         EXEC  SQL                                                     *00395000
               DECLARE S07UPD0 CURSOR FOR                              *00396000
               SELECT AUDIT_DATE,                                      *00397000
                   AUDIT_TIME,                                         *00398000
                   AUDIT_USER,                                         *00399000
                   AUDIT_ORG,                                          *00400000
                   INCL_EXCL_OPT,                                      *00401000
                   BRCH_REGION_01,                                     *00402000
                   BRCH_REGION_02,                                     *00403000
                   BRCH_REGION_03,                                     *00404000
                   BRCH_REGION_04,                                     *00405000
                   BRCH_REGION_05,                                     *00406000
                   BRCH_REGION_06,                                     *00407000
                   BRCH_REGION_07,                                     *00408000
                   BRCH_REGION_08,                                     *00409000
                   BRCH_REGION_09,                                     *00410000
                   BRCH_REGION_10,                                     *00411000
                   BRCH_REGION_11,                                     *00412000
                   BRCH_REGION_12,                                     *00413000
                   BRCH_REGION_13,                                     *00414000
                   BRCH_REGION_14,                                     *00415000
                   BRCH_REGION_15,                                     *00416000
                   BRCH_REGION_16,                                     *00417000
                   BRCH_REGION_17,                                     *00418000
                   BRCH_REGION_18,                                     *00419000
                   BRCH_REGION_19,                                     *00420000
                   BRCH_REGION_20,                                     *00421000
                   BRCH_REGION_21,                                     *00422000
                   BRCH_REGION_22,                                     *00423000
                   BRCH_REGION_23,                                     *00424000
                   BRCH_REGION_24,                                     *00425000
                   BRCH_REGION_25,                                     *00426000
                   BRCH_REGION_26,                                     *00427000
                   BRCH_REGION_27,                                     *00428000
                   BRCH_REGION_28,                                     *00429000
                   BRCH_REGION_29,                                     *00430000
                   BRCH_REGION_30,                                     *00431000
                   BRCH_REGION_31,                                     *00432000
                   BRCH_REGION_32,                                     *00433000
                   BRCH_REGION_33,                                     *00434000
                   BRCH_REGION_34,                                     *00435000
                   BRCH_REGION_35,                                     *00436000
                   BRCH_REGION_36,                                     *00437000
                   BRCH_REGION_37,                                     *00438000
                   BRCH_REGION_38,                                     *00439000
                   BRCH_REGION_39,                                     *00440000
                   BRCH_REGION_40,                                     *00441000
                   BRCH_REGION_41,                                     *00442000
                   BRCH_REGION_42,                                     *00443000
                   BRCH_REGION_43,                                     *00444000
                   BRCH_REGION_44,                                     *00445000
                   BRCH_REGION_45,                                     *00446000
                   BRCH_REGION_46,                                     *00447000
                   BRCH_REGION_47,                                     *00448000
                   BRCH_REGION_48,                                     *00449000
                   BRCH_REGION_49,                                     *00450000
                   BRCH_REGION_50,                                     *00451000
                   TABLE_TYPE                                          *00452000
                 FROM S07                                              *00453000
                 WHERE INST_NBR = :INST AND                            *00454000
                   RECORD_NBR = :RECNBR AND                            *00455000
                   BRCH_REGN_CODE = :BRREGNCD                          *00456000
                 FOR UPDATE OF AUDIT_DATE,                             *00457000
                   AUDIT_TIME,                                         *00458000
                   AUDIT_USER,                                         *00459000
                   AUDIT_ORG,                                          *00460000
                   INCL_EXCL_OPT,                                      *00461000
                   BRCH_REGION_01,                                     *00462000
                   BRCH_REGION_02,                                     *00463000
                   BRCH_REGION_03,                                     *00464000
                   BRCH_REGION_04,                                     *00465000
                   BRCH_REGION_05,                                     *00466000
                   BRCH_REGION_06,                                     *00467000
                   BRCH_REGION_07,                                     *00468000
                   BRCH_REGION_08,                                     *00469000
                   BRCH_REGION_09,                                     *00470000
                   BRCH_REGION_10,                                     *00471000
                   BRCH_REGION_11,                                     *00472000
                   BRCH_REGION_12,                                     *00473000
                   BRCH_REGION_13,                                     *00474000
                   BRCH_REGION_14,                                     *00475000
                   BRCH_REGION_15,                                     *00476000
                   BRCH_REGION_16,                                     *00477000
                   BRCH_REGION_17,                                     *00478000
                   BRCH_REGION_18,                                     *00479000
                   BRCH_REGION_19,                                     *00480000
                   BRCH_REGION_20,                                     *00481000
                   BRCH_REGION_21,                                     *00482000
                   BRCH_REGION_22,                                     *00483000
                   BRCH_REGION_23,                                     *00484000
                   BRCH_REGION_24,                                     *00485000
                   BRCH_REGION_25,                                     *00486000
                   BRCH_REGION_26,                                     *00487000
                   BRCH_REGION_27,                                     *00488000
                   BRCH_REGION_28,                                     *00489000
                   BRCH_REGION_29,                                     *00490000
                   BRCH_REGION_30,                                     *00491000
                   BRCH_REGION_31,                                     *00492000
                   BRCH_REGION_32,                                     *00493000
                   BRCH_REGION_33,                                     *00494000
                   BRCH_REGION_34,                                     *00495000
                   BRCH_REGION_35,                                     *00496000
                   BRCH_REGION_36,                                     *00497000
                   BRCH_REGION_37,                                     *00498000
                   BRCH_REGION_38,                                     *00499000
                   BRCH_REGION_39,                                     *00500000
                   BRCH_REGION_40,                                     *00501000
                   BRCH_REGION_41,                                     *00502000
                   BRCH_REGION_42,                                     *00503000
                   BRCH_REGION_43,                                     *00504000
                   BRCH_REGION_44,                                     *00505000
                   BRCH_REGION_45,                                     *00506000
                   BRCH_REGION_46,                                     *00507000
                   BRCH_REGION_47,                                     *00508000
                   BRCH_REGION_48,                                     *00509000
                   BRCH_REGION_49,                                     *00510000
                   BRCH_REGION_50,                                     *00511000
                   TABLE_TYPE                                          *00512000
                 FETCH FIRST 1 ROW ONLY                                 00513000
         EXEC  SQL                                                     *00514000
               OPEN S07UPD0                                             00515000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00516000
         BR    14                      RETURN TO CALLER                 00517000
         LTORG                                                          00518000
*                                                                       00519000
*                                                                       00520000
**********************************************************************  00521000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00522000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00523000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00524000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00525000
*     UPDATE STATEMENT TO MATCH.                                        00526000
**********************************************************************  00527000
*                                                                       00528000
SQL#0005 DS    0H                                                       00529000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00530000
         LA    15,255                  SET RETURN CODE                  00531000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00532000
         BR    14                      RETURN TO CALLER                 00533000
         LTORG                                                          00534000
*                                                                       00535000
*                                                                       00536000
**********************************************************************  00537000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00538000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00539000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00540000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00541000
*     UPDATE STATEMENT TO MATCH.                                        00542000
**********************************************************************  00543000
*                                                                       00544000
SQL#0006 DS    0H                                                       00545000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00546000
         LA    15,255                  SET RETURN CODE                  00547000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00548000
         BR    14                      RETURN TO CALLER                 00549000
         LTORG                                                          00550000
*                                                                       00551000
*                                                                       00552000
**********************************************************************  00553000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00554000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00555000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00556000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00557000
*     UPDATE STATEMENT TO MATCH.                                        00558000
**********************************************************************  00559000
*                                                                       00560000
SQL#0007 DS    0H                                                       00561000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00562000
         LA    15,255                  SET RETURN CODE                  00563000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00564000
         BR    14                      RETURN TO CALLER                 00565000
         LTORG                                                          00566000
*                                                                       00567000
*                                                                       00568000
**********************************************************************  00569000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00570000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00571000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00572000
*     THE ACTUAL ROW.                                                   00573000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00574000
**********************************************************************  00575000
*                                                                       00576000
SQL#0008 DS    0H                                                       00577000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00578000
         B     *+6                     BRANCH AROUND ADCON              00579000
BASE0008 DC    AL2(4096)                                                00580000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00581000
         AH    3,BASE0008              ADD 4K                           00582000
         EXEC  SQL                                                     *00583000
               FETCH S07UPD0                                           *00584000
                 INTO :AUDDATE,                                        *00585000
                   :AUDTIME,                                           *00586000
                   :AUDUSER,                                           *00587000
                   :AUDORG,                                            *00588000
                   :INCLEXCL,                                          *00589000
                   :BRREGN01,                                          *00590000
                   :BRREGN02,                                          *00591000
                   :BRREGN03,                                          *00592000
                   :BRREGN04,                                          *00593000
                   :BRREGN05,                                          *00594000
                   :BRREGN06,                                          *00595000
                   :BRREGN07,                                          *00596000
                   :BRREGN08,                                          *00597000
                   :BRREGN09,                                          *00598000
                   :BRREGN10,                                          *00599000
                   :BRREGN11,                                          *00600000
                   :BRREGN12,                                          *00601000
                   :BRREGN13,                                          *00602000
                   :BRREGN14,                                          *00603000
                   :BRREGN15,                                          *00604000
                   :BRREGN16,                                          *00605000
                   :BRREGN17,                                          *00606000
                   :BRREGN18,                                          *00607000
                   :BRREGN19,                                          *00608000
                   :BRREGN20,                                          *00609000
                   :BRREGN21,                                          *00610000
                   :BRREGN22,                                          *00611000
                   :BRREGN23,                                          *00612000
                   :BRREGN24,                                          *00613000
                   :BRREGN25,                                          *00614000
                   :BRREGN26,                                          *00615000
                   :BRREGN27,                                          *00616000
                   :BRREGN28,                                          *00617000
                   :BRREGN29,                                          *00618000
                   :BRREGN30,                                          *00619000
                   :BRREGN31,                                          *00620000
                   :BRREGN32,                                          *00621000
                   :BRREGN33,                                          *00622000
                   :BRREGN34,                                          *00623000
                   :BRREGN35,                                          *00624000
                   :BRREGN36,                                          *00625000
                   :BRREGN37,                                          *00626000
                   :BRREGN38,                                          *00627000
                   :BRREGN39,                                          *00628000
                   :BRREGN40,                                          *00629000
                   :BRREGN41,                                          *00630000
                   :BRREGN42,                                          *00631000
                   :BRREGN43,                                          *00632000
                   :BRREGN44,                                          *00633000
                   :BRREGN45,                                          *00634000
                   :BRREGN46,                                          *00635000
                   :BRREGN47,                                          *00636000
                   :BRREGN48,                                          *00637000
                   :BRREGN49,                                          *00638000
                   :BRREGN50,                                          *00639000
                   :TABLETYP                                            00640000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00641000
         BALR  4,5                     MOVE INTO RECORD AREA            00642000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00643000
         BR    14                      RETURN TO CALLER                 00644000
         LTORG                                                          00645000
*                                                                       00646000
*                                                                       00647000
**********************************************************************  00648000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00649000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00650000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00651000
*     THE ACTUAL ROW.                                                   00652000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00653000
**********************************************************************  00654000
*                                                                       00655000
SQL#0009 DS    0H                                                       00656000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00657000
         LA    15,255                  SET RETURN CODE                  00658000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00659000
         BR    14                      RETURN TO CALLER                 00660000
         LTORG                                                          00661000
*                                                                       00662000
*                                                                       00663000
**********************************************************************  00664000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00665000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00666000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00667000
*     THE ACTUAL ROW.                                                   00668000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00669000
**********************************************************************  00670000
*                                                                       00671000
SQL#0010 DS    0H                                                       00672000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00673000
         LA    15,255                  SET RETURN CODE                  00674000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00675000
         BR    14                      RETURN TO CALLER                 00676000
         LTORG                                                          00677000
*                                                                       00678000
*                                                                       00679000
**********************************************************************  00680000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00681000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00682000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00683000
*     THE ACTUAL ROW.                                                   00684000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00685000
**********************************************************************  00686000
*                                                                       00687000
SQL#0011 DS    0H                                                       00688000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00689000
         LA    15,255                  SET RETURN CODE                  00690000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00691000
         BR    14                      RETURN TO CALLER                 00692000
         LTORG                                                          00693000
*                                                                       00694000
*                                                                       00695000
**********************************************************************  00696000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00697000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00698000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00699000
*     TO CLOSE THE UPDATE CURSOR.                                       00700000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00701000
**********************************************************************  00702000
*                                                                       00703000
SQL#0012 DS    0H                                                       00704000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00705000
         B     *+6                     BRANCH AROUND ADCON              00706000
BASE0012 DC    AL2(4096)                                                00707000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00708000
         AH    3,BASE0012              ADD 4K                           00709000
         EXEC  SQL                                                     *00710000
               CLOSE S07UPD0                                            00711000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00712000
         BR    14                      RETURN TO CALLER                 00713000
         LTORG                                                          00714000
*                                                                       00715000
*                                                                       00716000
**********************************************************************  00717000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00718000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00719000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00720000
*     TO CLOSE THE UPDATE CURSOR.                                       00721000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00722000
**********************************************************************  00723000
*                                                                       00724000
SQL#0013 DS    0H                                                       00725000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00726000
         LA    15,255                  SET RETURN CODE                  00727000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00728000
         BR    14                      RETURN TO CALLER                 00729000
         LTORG                                                          00730000
*                                                                       00731000
*                                                                       00732000
**********************************************************************  00733000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00734000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00735000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00736000
*     TO CLOSE THE UPDATE CURSOR.                                       00737000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00738000
**********************************************************************  00739000
*                                                                       00740000
SQL#0014 DS    0H                                                       00741000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00742000
         LA    15,255                  SET RETURN CODE                  00743000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00744000
         BR    14                      RETURN TO CALLER                 00745000
         LTORG                                                          00746000
*                                                                       00747000
*                                                                       00748000
**********************************************************************  00749000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00750000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00751000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00752000
*     TO CLOSE THE UPDATE CURSOR.                                       00753000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00754000
**********************************************************************  00755000
*                                                                       00756000
SQL#0015 DS    0H                                                       00757000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00758000
         LA    15,255                  SET RETURN CODE                  00759000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00760000
         BR    14                      RETURN TO CALLER                 00761000
         LTORG                                                          00762000
*                                                                       00763000
*                                                                       00764000
**********************************************************************  00765000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00766000
* KEY:                                                                  00767000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00768000
*     AND GET-NEXT-LOCK VERBS.                                          00769000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00770000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00771000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00772000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00773000
*     ORDER BY CLAUSE.                                                  00774000
**********************************************************************  00775000
*                                                                       00776000
SQL#0016 DS    0H                                                       00777000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00778000
         B     *+6                     BRANCH AROUND ADCON              00779000
BASE0016 DC    AL2(4096)                                                00780000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00781000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00782000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00783000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00784000
         AH    3,BASE0016              ADD 4K                           00785000
         EXEC  SQL                                                     *00786000
               DECLARE S07SQ001 CURSOR FOR                             *00787000
               SELECT INST_NBR,                                        *00788000
                   RECORD_NBR,                                         *00789000
                   BRCH_REGN_CODE,                                     *00790000
                   AUDIT_DATE,                                         *00791000
                   AUDIT_TIME,                                         *00792000
                   AUDIT_USER,                                         *00793000
                   AUDIT_ORG,                                          *00794000
                   INCL_EXCL_OPT,                                      *00795000
                   BRCH_REGION_01,                                     *00796000
                   BRCH_REGION_02,                                     *00797000
                   BRCH_REGION_03,                                     *00798000
                   BRCH_REGION_04,                                     *00799000
                   BRCH_REGION_05,                                     *00800000
                   BRCH_REGION_06,                                     *00801000
                   BRCH_REGION_07,                                     *00802000
                   BRCH_REGION_08,                                     *00803000
                   BRCH_REGION_09,                                     *00804000
                   BRCH_REGION_10,                                     *00805000
                   BRCH_REGION_11,                                     *00806000
                   BRCH_REGION_12,                                     *00807000
                   BRCH_REGION_13,                                     *00808000
                   BRCH_REGION_14,                                     *00809000
                   BRCH_REGION_15,                                     *00810000
                   BRCH_REGION_16,                                     *00811000
                   BRCH_REGION_17,                                     *00812000
                   BRCH_REGION_18,                                     *00813000
                   BRCH_REGION_19,                                     *00814000
                   BRCH_REGION_20,                                     *00815000
                   BRCH_REGION_21,                                     *00816000
                   BRCH_REGION_22,                                     *00817000
                   BRCH_REGION_23,                                     *00818000
                   BRCH_REGION_24,                                     *00819000
                   BRCH_REGION_25,                                     *00820000
                   BRCH_REGION_26,                                     *00821000
                   BRCH_REGION_27,                                     *00822000
                   BRCH_REGION_28,                                     *00823000
                   BRCH_REGION_29,                                     *00824000
                   BRCH_REGION_30,                                     *00825000
                   BRCH_REGION_31,                                     *00826000
                   BRCH_REGION_32,                                     *00827000
                   BRCH_REGION_33,                                     *00828000
                   BRCH_REGION_34,                                     *00829000
                   BRCH_REGION_35,                                     *00830000
                   BRCH_REGION_36,                                     *00831000
                   BRCH_REGION_37,                                     *00832000
                   BRCH_REGION_38,                                     *00833000
                   BRCH_REGION_39,                                     *00834000
                   BRCH_REGION_40,                                     *00835000
                   BRCH_REGION_41,                                     *00836000
                   BRCH_REGION_42,                                     *00837000
                   BRCH_REGION_43,                                     *00838000
                   BRCH_REGION_44,                                     *00839000
                   BRCH_REGION_45,                                     *00840000
                   BRCH_REGION_46,                                     *00841000
                   BRCH_REGION_47,                                     *00842000
                   BRCH_REGION_48,                                     *00843000
                   BRCH_REGION_49,                                     *00844000
                   BRCH_REGION_50,                                     *00845000
                   TABLE_TYPE                                          *00846000
                 FROM S07                                              *00847000
                 WHERE                                                 *00848000
                    INST_NBR = :INST AND                               *00849000
                    RECORD_NBR = :RECNBR AND                           *00850000
                    BRCH_REGN_CODE >= :BRREGNCD                        *00851000
                 ORDER BY BRCH_REGN_CODE                               *00852000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00853000
         EXEC  SQL                                                     *00854000
               OPEN S07SQ001                                            00855000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00856000
         BR    14                      RETURN TO CALLER                 00857000
         LTORG                                                          00858000
*                                                                       00859000
*                                                                       00860000
**********************************************************************  00861000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00862000
* KEY 1:                                                                00863000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00864000
*     AND GET-NEXT-LOCK VERBS.                                          00865000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00866000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00867000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00868000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00869000
*     ORDER BY CLAUSE.                                                  00870000
**********************************************************************  00871000
*                                                                       00872000
SQL#0017 DS    0H                                                       00873000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00874000
         LA    15,255                  SET RETURN CODE                  00875000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00876000
         BR    14                      RETURN TO CALLER                 00877000
         LTORG                                                          00878000
*                                                                       00879000
*                                                                       00880000
**********************************************************************  00881000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00882000
* KEY 2:                                                                00883000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00884000
*     AND GET-NEXT-LOCK VERBS.                                          00885000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00886000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00887000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00888000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00889000
*     ORDER BY CLAUSE.                                                  00890000
**********************************************************************  00891000
*                                                                       00892000
SQL#0018 DS    0H                                                       00893000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00894000
         LA    15,255                  SET RETURN CODE                  00895000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00896000
         BR    14                      RETURN TO CALLER                 00897000
         LTORG                                                          00898000
*                                                                       00899000
*                                                                       00900000
**********************************************************************  00901000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00902000
* KEY 3:                                                                00903000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00904000
*     AND GET-NEXT-LOCK VERBS.                                          00905000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00906000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00907000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00908000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00909000
*     ORDER BY CLAUSE.                                                  00910000
**********************************************************************  00911000
*                                                                       00912000
SQL#0019 DS    0H                                                       00913000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00914000
         LA    15,255                  SET RETURN CODE                  00915000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00916000
         BR    14                      RETURN TO CALLER                 00917000
         LTORG                                                          00918000
*                                                                       00919000
*                                                                       00920000
**********************************************************************  00921000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00922000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00923000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00924000
*     RETRIEVE THE ACTUAL ROW.                                          00925000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00926000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00927000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00928000
**********************************************************************  00929000
*                                                                       00930000
SQL#0020 DS    0H                                                       00931000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00932000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00933000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00934000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00935000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00936000
VECT0020 DC    A(SQL#0120)                                              00937000
         DC    A(SQL#0220)                                              00938000
         DC    A(SQL#0320)                                              00939000
         LTORG                                                          00940000
*                                                                       00941000
SQL#0120 DS    0H                                                       00942000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00943000
         B     *+6                     BRANCH AROUND ADCON              00944000
BASE0120 DC    AL2(4096)                                                00945000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00946000
         AH    3,BASE0120              ADD 4K                           00947000
         EXEC  SQL                                                     *00948000
               FETCH S07SQ001                                          *00949000
                 INTO :INST,                                           *00950000
                      :RECNBR,                                         *00951000
                      :BRREGNCD,                                       *00952000
                      :AUDDATE,                                        *00953000
                      :AUDTIME,                                        *00954000
                      :AUDUSER,                                        *00955000
                      :AUDORG,                                         *00956000
                      :INCLEXCL,                                       *00957000
                      :BRREGN01,                                       *00958000
                      :BRREGN02,                                       *00959000
                      :BRREGN03,                                       *00960000
                      :BRREGN04,                                       *00961000
                      :BRREGN05,                                       *00962000
                      :BRREGN06,                                       *00963000
                      :BRREGN07,                                       *00964000
                      :BRREGN08,                                       *00965000
                      :BRREGN09,                                       *00966000
                      :BRREGN10,                                       *00967000
                      :BRREGN11,                                       *00968000
                      :BRREGN12,                                       *00969000
                      :BRREGN13,                                       *00970000
                      :BRREGN14,                                       *00971000
                      :BRREGN15,                                       *00972000
                      :BRREGN16,                                       *00973000
                      :BRREGN17,                                       *00974000
                      :BRREGN18,                                       *00975000
                      :BRREGN19,                                       *00976000
                      :BRREGN20,                                       *00977000
                      :BRREGN21,                                       *00978000
                      :BRREGN22,                                       *00979000
                      :BRREGN23,                                       *00980000
                      :BRREGN24,                                       *00981000
                      :BRREGN25,                                       *00982000
                      :BRREGN26,                                       *00983000
                      :BRREGN27,                                       *00984000
                      :BRREGN28,                                       *00985000
                      :BRREGN29,                                       *00986000
                      :BRREGN30,                                       *00987000
                      :BRREGN31,                                       *00988000
                      :BRREGN32,                                       *00989000
                      :BRREGN33,                                       *00990000
                      :BRREGN34,                                       *00991000
                      :BRREGN35,                                       *00992000
                      :BRREGN36,                                       *00993000
                      :BRREGN37,                                       *00994000
                      :BRREGN38,                                       *00995000
                      :BRREGN39,                                       *00996000
                      :BRREGN40,                                       *00997000
                      :BRREGN41,                                       *00998000
                      :BRREGN42,                                       *00999000
                      :BRREGN43,                                       *01000000
                      :BRREGN44,                                       *01001000
                      :BRREGN45,                                       *01002000
                      :BRREGN46,                                       *01003000
                      :BRREGN47,                                       *01004000
                      :BRREGN48,                                       *01005000
                      :BRREGN49,                                       *01006000
                      :BRREGN50,                                       *01007000
                      :TABLETYP                                         01008000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01009000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01010000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01011000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01012000
         BR    12                      OPEN NEXT CURSOR                 01013000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01014000
         BALR  4,5                     MOVE INTO RECORD AREA            01015000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01016000
         BR    14                      RETURN TO CALLER                 01017000
         LTORG                                                          01018000
*                                                                       01019000
SQL#0220 DS    0H                                                       01020000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          01021000
         B     *+6                     BRANCH AROUND ADCON              01022000
BASE0220 DC    AL2(4096)                                                01023000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01024000
         AH    3,BASE0220              ADD 4K                           01025000
         EXEC  SQL                                                     *01026000
               FETCH S07SQ002                                          *01027000
                 INTO :INST,                                           *01028000
                      :RECNBR,                                         *01029000
                      :BRREGNCD,                                       *01030000
                      :AUDDATE,                                        *01031000
                      :AUDTIME,                                        *01032000
                      :AUDUSER,                                        *01033000
                      :AUDORG,                                         *01034000
                      :INCLEXCL,                                       *01035000
                      :BRREGN01,                                       *01036000
                      :BRREGN02,                                       *01037000
                      :BRREGN03,                                       *01038000
                      :BRREGN04,                                       *01039000
                      :BRREGN05,                                       *01040000
                      :BRREGN06,                                       *01041000
                      :BRREGN07,                                       *01042000
                      :BRREGN08,                                       *01043000
                      :BRREGN09,                                       *01044000
                      :BRREGN10,                                       *01045000
                      :BRREGN11,                                       *01046000
                      :BRREGN12,                                       *01047000
                      :BRREGN13,                                       *01048000
                      :BRREGN14,                                       *01049000
                      :BRREGN15,                                       *01050000
                      :BRREGN16,                                       *01051000
                      :BRREGN17,                                       *01052000
                      :BRREGN18,                                       *01053000
                      :BRREGN19,                                       *01054000
                      :BRREGN20,                                       *01055000
                      :BRREGN21,                                       *01056000
                      :BRREGN22,                                       *01057000
                      :BRREGN23,                                       *01058000
                      :BRREGN24,                                       *01059000
                      :BRREGN25,                                       *01060000
                      :BRREGN26,                                       *01061000
                      :BRREGN27,                                       *01062000
                      :BRREGN28,                                       *01063000
                      :BRREGN29,                                       *01064000
                      :BRREGN30,                                       *01065000
                      :BRREGN31,                                       *01066000
                      :BRREGN32,                                       *01067000
                      :BRREGN33,                                       *01068000
                      :BRREGN34,                                       *01069000
                      :BRREGN35,                                       *01070000
                      :BRREGN36,                                       *01071000
                      :BRREGN37,                                       *01072000
                      :BRREGN38,                                       *01073000
                      :BRREGN39,                                       *01074000
                      :BRREGN40,                                       *01075000
                      :BRREGN41,                                       *01076000
                      :BRREGN42,                                       *01077000
                      :BRREGN43,                                       *01078000
                      :BRREGN44,                                       *01079000
                      :BRREGN45,                                       *01080000
                      :BRREGN46,                                       *01081000
                      :BRREGN47,                                       *01082000
                      :BRREGN48,                                       *01083000
                      :BRREGN49,                                       *01084000
                      :BRREGN50,                                       *01085000
                      :TABLETYP                                         01086000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01087000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01088000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01089000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01090000
         BR    12                      OPEN NEXT CURSOR                 01091000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01092000
         BALR  4,5                     MOVE INTO RECORD AREA            01093000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01094000
         BR    14                      RETURN TO CALLER                 01095000
         LTORG                                                          01096000
*                                                                       01097000
SQL#0320 DS    0H                                                       01098000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          01099000
         B     *+6                     BRANCH AROUND ADCON              01100000
BASE0320 DC    AL2(4096)                                                01101000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01102000
         AH    3,BASE0320              ADD 4K                           01103000
         EXEC  SQL                                                     *01104000
               FETCH S07SQ003                                          *01105000
                 INTO :INST,                                           *01106000
                      :RECNBR,                                         *01107000
                      :BRREGNCD,                                       *01108000
                      :AUDDATE,                                        *01109000
                      :AUDTIME,                                        *01110000
                      :AUDUSER,                                        *01111000
                      :AUDORG,                                         *01112000
                      :INCLEXCL,                                       *01113000
                      :BRREGN01,                                       *01114000
                      :BRREGN02,                                       *01115000
                      :BRREGN03,                                       *01116000
                      :BRREGN04,                                       *01117000
                      :BRREGN05,                                       *01118000
                      :BRREGN06,                                       *01119000
                      :BRREGN07,                                       *01120000
                      :BRREGN08,                                       *01121000
                      :BRREGN09,                                       *01122000
                      :BRREGN10,                                       *01123000
                      :BRREGN11,                                       *01124000
                      :BRREGN12,                                       *01125000
                      :BRREGN13,                                       *01126000
                      :BRREGN14,                                       *01127000
                      :BRREGN15,                                       *01128000
                      :BRREGN16,                                       *01129000
                      :BRREGN17,                                       *01130000
                      :BRREGN18,                                       *01131000
                      :BRREGN19,                                       *01132000
                      :BRREGN20,                                       *01133000
                      :BRREGN21,                                       *01134000
                      :BRREGN22,                                       *01135000
                      :BRREGN23,                                       *01136000
                      :BRREGN24,                                       *01137000
                      :BRREGN25,                                       *01138000
                      :BRREGN26,                                       *01139000
                      :BRREGN27,                                       *01140000
                      :BRREGN28,                                       *01141000
                      :BRREGN29,                                       *01142000
                      :BRREGN30,                                       *01143000
                      :BRREGN31,                                       *01144000
                      :BRREGN32,                                       *01145000
                      :BRREGN33,                                       *01146000
                      :BRREGN34,                                       *01147000
                      :BRREGN35,                                       *01148000
                      :BRREGN36,                                       *01149000
                      :BRREGN37,                                       *01150000
                      :BRREGN38,                                       *01151000
                      :BRREGN39,                                       *01152000
                      :BRREGN40,                                       *01153000
                      :BRREGN41,                                       *01154000
                      :BRREGN42,                                       *01155000
                      :BRREGN43,                                       *01156000
                      :BRREGN44,                                       *01157000
                      :BRREGN45,                                       *01158000
                      :BRREGN46,                                       *01159000
                      :BRREGN47,                                       *01160000
                      :BRREGN48,                                       *01161000
                      :BRREGN49,                                       *01162000
                      :BRREGN50,                                       *01163000
                      :TABLETYP                                         01164000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01165000
         BALR  4,5                     MOVE INTO RECORD AREA            01166000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01167000
         BR    14                      RETURN TO CALLER                 01168000
         LTORG                                                          01169000
*                                                                       01170000
*                                                                       01171000
**********************************************************************  01172000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01173000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01174000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01175000
*     RETRIEVE THE ACTUAL ROW.                                          01176000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01177000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01178000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01179000
**********************************************************************  01180000
*                                                                       01181000
SQL#0021 DS    0H                                                       01182000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01183000
         LA    15,255                  SET RETURN CODE                  01184000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01185000
         BR    14                      RETURN TO CALLER                 01186000
         LTORG                                                          01187000
*                                                                       01188000
*                                                                       01189000
**********************************************************************  01190000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01191000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01192000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01193000
*     RETRIEVE THE ACTUAL ROW.                                          01194000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01195000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01196000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01197000
**********************************************************************  01198000
*                                                                       01199000
SQL#0022 DS    0H                                                       01200000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01201000
         LA    15,255                  SET RETURN CODE                  01202000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01203000
         BR    14                      RETURN TO CALLER                 01204000
         LTORG                                                          01205000
*                                                                       01206000
*                                                                       01207000
**********************************************************************  01208000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01209000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01210000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01211000
*     RETRIEVE THE ACTUAL ROW.                                          01212000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01213000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01214000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01215000
**********************************************************************  01216000
*                                                                       01217000
SQL#0023 DS    0H                                                       01218000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01219000
         LA    15,255                  SET RETURN CODE                  01220000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01221000
         BR    14                      RETURN TO CALLER                 01222000
         LTORG                                                          01223000
*                                                                       01224000
*                                                                       01225000
**********************************************************************  01226000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01227000
* THE PRIMARY KEY:                                                      01228000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01229000
*     VERBS.                                                            01230000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01231000
*     RETRIEVE THE ACTUAL ROW.                                          01232000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01233000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01234000
*     WILL BE THRU THE UPDATE CURSOR.                                   01235000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01236000
**********************************************************************  01237000
*                                                                       01238000
SQL#0024 DS    0H                                                       01239000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01240000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01241000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01242000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01243000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01244000
VECT0024 DC    A(SQL#0124)                                              01245000
         DC    A(SQL#0224)                                              01246000
         DC    A(SQL#0324)                                              01247000
         LTORG                                                          01248000
*                                                                       01249000
SQL#0124 DS    0H                                                       01250000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01251000
         B     *+6                     BRANCH AROUND ADCON              01252000
BASE0124 DC    AL2(4096)                                                01253000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01254000
         AH    3,BASE0124              ADD 4K                           01255000
         EXEC  SQL                                                     *01256000
               FETCH S07SQ001                                          *01257000
                 INTO :INST,                                           *01258000
                      :RECNBR,                                         *01259000
                      :BRREGNCD                                         01260000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01261000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01262000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01263000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01264000
         BR    12                      OPEN NEXT CURSOR                 01265000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01266000
         BALR  4,5                     MOVE INTO RECORD AREA            01267000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01268000
         BR    14                      RETURN TO CALLER                 01269000
         LTORG                                                          01270000
*                                                                       01271000
SQL#0224 DS    0H                                                       01272000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01273000
         B     *+6                     BRANCH AROUND ADCON              01274000
BASE0224 DC    AL2(4096)                                                01275000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01276000
         AH    3,BASE0224              ADD 4K                           01277000
         EXEC  SQL                                                     *01278000
               FETCH S07SQ002                                          *01279000
                 INTO :INST,                                           *01280000
                      :RECNBR,                                         *01281000
                      :BRREGNCD                                         01282000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01283000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01284000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01285000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01286000
         BR    12                      OPEN NEXT CURSOR                 01287000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01288000
         BALR  4,5                     MOVE INTO RECORD AREA            01289000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01290000
         BR    14                      RETURN TO CALLER                 01291000
         LTORG                                                          01292000
*                                                                       01293000
SQL#0324 DS    0H                                                       01294000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01295000
         B     *+6                     BRANCH AROUND ADCON              01296000
BASE0324 DC    AL2(4096)                                                01297000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01298000
         AH    3,BASE0324              ADD 4K                           01299000
         EXEC  SQL                                                     *01300000
               FETCH S07SQ003                                          *01301000
                 INTO :INST,                                           *01302000
                      :RECNBR,                                         *01303000
                      :BRREGNCD                                         01304000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01305000
         BALR  4,5                     MOVE INTO RECORD AREA            01306000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01307000
         BR    14                      RETURN TO CALLER                 01308000
         LTORG                                                          01309000
*                                                                       01310000
*                                                                       01311000
**********************************************************************  01312000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01313000
* ALTERNATE KEY 1:                                                      01314000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01315000
*     VERBS.                                                            01316000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01317000
*     RETRIEVE THE ACTUAL ROW.                                          01318000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01319000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01320000
*     WILL BE THRU THE UPDATE CURSOR.                                   01321000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01322000
**********************************************************************  01323000
*                                                                       01324000
SQL#0025 DS    0H                                                       01325000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01326000
         LA    15,255                  SET RETURN CODE                  01327000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01328000
         BR    14                      RETURN TO CALLER                 01329000
         LTORG                                                          01330000
*                                                                       01331000
*                                                                       01332000
**********************************************************************  01333000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01334000
* ALTERNATE KEY 2:                                                      01335000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01336000
*     VERBS.                                                            01337000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01338000
*     RETRIEVE THE ACTUAL ROW.                                          01339000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01340000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01341000
*     WILL BE THRU THE UPDATE CURSOR.                                   01342000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01343000
**********************************************************************  01344000
*                                                                       01345000
SQL#0026 DS    0H                                                       01346000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01347000
         LA    15,255                  SET RETURN CODE                  01348000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01349000
         BR    14                      RETURN TO CALLER                 01350000
         LTORG                                                          01351000
*                                                                       01352000
*                                                                       01353000
**********************************************************************  01354000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01355000
* ALTERNATE KEY 3:                                                      01356000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01357000
*     VERBS.                                                            01358000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01359000
*     RETRIEVE THE ACTUAL ROW.                                          01360000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01361000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01362000
*     WILL BE THRU THE UPDATE CURSOR.                                   01363000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01364000
**********************************************************************  01365000
*                                                                       01366000
SQL#0027 DS    0H                                                       01367000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01368000
         LA    15,255                  SET RETURN CODE                  01369000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01370000
         BR    14                      RETURN TO CALLER                 01371000
         LTORG                                                          01372000
*                                                                       01373000
*                                                                       01374000
**********************************************************************  01375000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01376000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01377000
*     AND GET-NEXT-LOCK VERBS.                                          01378000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01379000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01380000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01381000
**********************************************************************  01382000
*                                                                       01383000
SQL#0028 DS    0H                                                       01384000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01385000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01386000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01387000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01388000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01389000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01390000
VECT0028 DC    A(SQL#0128)                                              01391000
         DC    A(SQL#0228)                                              01392000
         DC    A(SQL#0328)                                              01393000
         LTORG                                                          01394000
*                                                                       01395000
SQL#0128 DS    0H                                                       01396000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01397000
         B     *+6                     BRANCH AROUND ADCON              01398000
BASE0128 DC    AL2(4096)                                                01399000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01400000
         AH    3,BASE0128              ADD 4K                           01401000
         EXEC  SQL                                                     *01402000
               CLOSE S07SQ001                                           01403000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01404000
         BR    14                      RETURN TO CALLER                 01405000
         LTORG                                                          01406000
*                                                                       01407000
SQL#0228 DS    0H                                                       01408000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01409000
         B     *+6                     BRANCH AROUND ADCON              01410000
BASE0228 DC    AL2(4096)                                                01411000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01412000
         AH    3,BASE0228              ADD 4K                           01413000
         EXEC  SQL                                                     *01414000
               CLOSE S07SQ002                                           01415000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01416000
         BR    14                      RETURN TO CALLER                 01417000
         LTORG                                                          01418000
*                                                                       01419000
SQL#0328 DS    0H                                                       01420000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01421000
         B     *+6                     BRANCH AROUND ADCON              01422000
BASE0328 DC    AL2(4096)                                                01423000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01424000
         AH    3,BASE0328              ADD 4K                           01425000
         EXEC  SQL                                                     *01426000
               CLOSE S07SQ003                                           01427000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01428000
         BR    14                      RETURN TO CALLER                 01429000
         LTORG                                                          01430000
*                                                                       01431000
*                                                                       01432000
**********************************************************************  01433000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01434000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01435000
*     AND GET-NEXT-LOCK VERBS.                                          01436000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01437000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01438000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01439000
**********************************************************************  01440000
*                                                                       01441000
SQL#0029 DS    0H                                                       01442000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01443000
         LA    15,255                  SET RETURN CODE                  01444000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01445000
         BR    14                      RETURN TO CALLER                 01446000
         LTORG                                                          01447000
*                                                                       01448000
*                                                                       01449000
**********************************************************************  01450000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01451000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01452000
*     AND GET-NEXT-LOCK VERBS.                                          01453000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01454000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01455000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01456000
**********************************************************************  01457000
*                                                                       01458000
SQL#0030 DS    0H                                                       01459000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01460000
         LA    15,255                  SET RETURN CODE                  01461000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01462000
         BR    14                      RETURN TO CALLER                 01463000
         LTORG                                                          01464000
*                                                                       01465000
*                                                                       01466000
**********************************************************************  01467000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01468000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01469000
*     AND GET-NEXT-LOCK VERBS.                                          01470000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01471000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01472000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01473000
**********************************************************************  01474000
*                                                                       01475000
SQL#0031 DS    0H                                                       01476000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01477000
         LA    15,255                  SET RETURN CODE                  01478000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01479000
         BR    14                      RETURN TO CALLER                 01480000
         LTORG                                                          01481000
*                                                                       01482000
*                                                                       01483000
**********************************************************************  01484000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01485000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01486000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01487000
**********************************************************************  01488000
*                                                                       01489000
SQL#0032 DS    0H                                                       01490000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01491000
         B     *+6                     BRANCH AROUND ADCON              01492000
BASE0032 DC    AL2(4096)                                                01493000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01494000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01495000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01496000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01497000
         AH    3,BASE0032              ADD 4K                           01498000
         EXEC  SQL                                                     *01499000
               SELECT INST_NBR,                                        *01500000
                   RECORD_NBR,                                         *01501000
                   BRCH_REGN_CODE                                      *01502000
                 INTO :INST,                                           *01503000
                   :RECNBR,                                            *01504000
                   :BRREGNCD                                           *01505000
                 FROM S07                                              *01506000
                 WHERE INST_NBR = :INST AND                            *01507000
                   RECORD_NBR = :RECNBR AND                            *01508000
                   BRCH_REGN_CODE = :BRREGNCD                          *01509000
                 FETCH FIRST 1 ROW ONLY                                 01510000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01511000
         BR    14                      RETURN TO CALLER                 01512000
         LTORG                                                          01513000
*                                                                       01514000
*                                                                       01515000
**********************************************************************  01516000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01517000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01518000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01519000
**********************************************************************  01520000
*                                                                       01521000
SQL#0033 DS    0H                                                       01522000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01523000
         LA    15,255                  SET RETURN CODE                  01524000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01525000
         BR    14                      RETURN TO CALLER                 01526000
         LTORG                                                          01527000
*                                                                       01528000
*                                                                       01529000
**********************************************************************  01530000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01531000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01532000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01533000
**********************************************************************  01534000
*                                                                       01535000
SQL#0034 DS    0H                                                       01536000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01537000
         LA    15,255                  SET RETURN CODE                  01538000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01539000
         BR    14                      RETURN TO CALLER                 01540000
         LTORG                                                          01541000
*                                                                       01542000
*                                                                       01543000
**********************************************************************  01544000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01545000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01546000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01547000
**********************************************************************  01548000
*                                                                       01549000
SQL#0035 DS    0H                                                       01550000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01551000
         LA    15,255                  SET RETURN CODE                  01552000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01553000
         BR    14                      RETURN TO CALLER                 01554000
         LTORG                                                          01555000
*                                                                       01556000
*                                                                       01557000
**********************************************************************  01558000
* INSERT STATEMENT:                                                     01559000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01560000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01561000
**********************************************************************  01562000
*                                                                       01563000
SQL#0036 DS    0H                                                       01564000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01565000
         B     *+6                     BRANCH AROUND ADCON              01566000
BASE0036 DC    AL2(4096)                                                01567000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01568000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01569000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01570000
         AH    3,BASE0036              ADD 4K                           01571000
         EXEC  SQL                                                     *01572000
               INSERT INTO S07                                         *01573000
                   (INST_NBR,                                          *01574000
                    RECORD_NBR,                                        *01575000
                    BRCH_REGN_CODE,                                    *01576000
                    AUDIT_DATE,                                        *01577000
                    AUDIT_TIME,                                        *01578000
                    AUDIT_USER,                                        *01579000
                    AUDIT_ORG,                                         *01580000
                    INCL_EXCL_OPT,                                     *01581000
                    BRCH_REGION_01,                                    *01582000
                    BRCH_REGION_02,                                    *01583000
                    BRCH_REGION_03,                                    *01584000
                    BRCH_REGION_04,                                    *01585000
                    BRCH_REGION_05,                                    *01586000
                    BRCH_REGION_06,                                    *01587000
                    BRCH_REGION_07,                                    *01588000
                    BRCH_REGION_08,                                    *01589000
                    BRCH_REGION_09,                                    *01590000
                    BRCH_REGION_10,                                    *01591000
                    BRCH_REGION_11,                                    *01592000
                    BRCH_REGION_12,                                    *01593000
                    BRCH_REGION_13,                                    *01594000
                    BRCH_REGION_14,                                    *01595000
                    BRCH_REGION_15,                                    *01596000
                    BRCH_REGION_16,                                    *01597000
                    BRCH_REGION_17,                                    *01598000
                    BRCH_REGION_18,                                    *01599000
                    BRCH_REGION_19,                                    *01600000
                    BRCH_REGION_20,                                    *01601000
                    BRCH_REGION_21,                                    *01602000
                    BRCH_REGION_22,                                    *01603000
                    BRCH_REGION_23,                                    *01604000
                    BRCH_REGION_24,                                    *01605000
                    BRCH_REGION_25,                                    *01606000
                    BRCH_REGION_26,                                    *01607000
                    BRCH_REGION_27,                                    *01608000
                    BRCH_REGION_28,                                    *01609000
                    BRCH_REGION_29,                                    *01610000
                    BRCH_REGION_30,                                    *01611000
                    BRCH_REGION_31,                                    *01612000
                    BRCH_REGION_32,                                    *01613000
                    BRCH_REGION_33,                                    *01614000
                    BRCH_REGION_34,                                    *01615000
                    BRCH_REGION_35,                                    *01616000
                    BRCH_REGION_36,                                    *01617000
                    BRCH_REGION_37,                                    *01618000
                    BRCH_REGION_38,                                    *01619000
                    BRCH_REGION_39,                                    *01620000
                    BRCH_REGION_40,                                    *01621000
                    BRCH_REGION_41,                                    *01622000
                    BRCH_REGION_42,                                    *01623000
                    BRCH_REGION_43,                                    *01624000
                    BRCH_REGION_44,                                    *01625000
                    BRCH_REGION_45,                                    *01626000
                    BRCH_REGION_46,                                    *01627000
                    BRCH_REGION_47,                                    *01628000
                    BRCH_REGION_48,                                    *01629000
                    BRCH_REGION_49,                                    *01630000
                    BRCH_REGION_50,                                    *01631000
                    TABLE_TYPE)                                        *01632000
                  VALUES (:INST,                                       *01633000
                   :RECNBR,                                            *01634000
                   :BRREGNCD,                                          *01635000
                   :AUDDATE,                                           *01636000
                   :AUDTIME,                                           *01637000
                   :AUDUSER,                                           *01638000
                   :AUDORG,                                            *01639000
                   :INCLEXCL,                                          *01640000
                   :BRREGN01,                                          *01641000
                   :BRREGN02,                                          *01642000
                   :BRREGN03,                                          *01643000
                   :BRREGN04,                                          *01644000
                   :BRREGN05,                                          *01645000
                   :BRREGN06,                                          *01646000
                   :BRREGN07,                                          *01647000
                   :BRREGN08,                                          *01648000
                   :BRREGN09,                                          *01649000
                   :BRREGN10,                                          *01650000
                   :BRREGN11,                                          *01651000
                   :BRREGN12,                                          *01652000
                   :BRREGN13,                                          *01653000
                   :BRREGN14,                                          *01654000
                   :BRREGN15,                                          *01655000
                   :BRREGN16,                                          *01656000
                   :BRREGN17,                                          *01657000
                   :BRREGN18,                                          *01658000
                   :BRREGN19,                                          *01659000
                   :BRREGN20,                                          *01660000
                   :BRREGN21,                                          *01661000
                   :BRREGN22,                                          *01662000
                   :BRREGN23,                                          *01663000
                   :BRREGN24,                                          *01664000
                   :BRREGN25,                                          *01665000
                   :BRREGN26,                                          *01666000
                   :BRREGN27,                                          *01667000
                   :BRREGN28,                                          *01668000
                   :BRREGN29,                                          *01669000
                   :BRREGN30,                                          *01670000
                   :BRREGN31,                                          *01671000
                   :BRREGN32,                                          *01672000
                   :BRREGN33,                                          *01673000
                   :BRREGN34,                                          *01674000
                   :BRREGN35,                                          *01675000
                   :BRREGN36,                                          *01676000
                   :BRREGN37,                                          *01677000
                   :BRREGN38,                                          *01678000
                   :BRREGN39,                                          *01679000
                   :BRREGN40,                                          *01680000
                   :BRREGN41,                                          *01681000
                   :BRREGN42,                                          *01682000
                   :BRREGN43,                                          *01683000
                   :BRREGN44,                                          *01684000
                   :BRREGN45,                                          *01685000
                   :BRREGN46,                                          *01686000
                   :BRREGN47,                                          *01687000
                   :BRREGN48,                                          *01688000
                   :BRREGN49,                                          *01689000
                   :BRREGN50,                                          *01690000
                   :TABLETYP)                                           01691000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01692000
         BR    14                      RETURN TO CALLER                 01693000
         LTORG                                                          01694000
*                                                                       01695000
*                                                                       01696000
**********************************************************************  01697000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01698000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01699000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01700000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01701000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01702000
*     STATEMENT.                                                        01703000
**********************************************************************  01704000
*                                                                       01705000
SQL#0037 DS    0H                                                       01706000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01707000
         B     *+6                     BRANCH AROUND ADCON              01708000
BASE0037 DC    AL2(4096)                                                01709000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01710000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01711000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01712000
         AH    3,BASE0037              ADD 4K                           01713000
         EXEC  SQL                                                     *01714000
               UPDATE S07                                              *01715000
                   SET AUDIT_DATE = :AUDDATE,                          *01716000
                     AUDIT_TIME = :AUDTIME,                            *01717000
                     AUDIT_USER = :AUDUSER,                            *01718000
                     AUDIT_ORG = :AUDORG,                              *01719000
                     INCL_EXCL_OPT = :INCLEXCL,                        *01720000
                     BRCH_REGION_01 = :BRREGN01,                       *01721000
                     BRCH_REGION_02 = :BRREGN02,                       *01722000
                     BRCH_REGION_03 = :BRREGN03,                       *01723000
                     BRCH_REGION_04 = :BRREGN04,                       *01724000
                     BRCH_REGION_05 = :BRREGN05,                       *01725000
                     BRCH_REGION_06 = :BRREGN06,                       *01726000
                     BRCH_REGION_07 = :BRREGN07,                       *01727000
                     BRCH_REGION_08 = :BRREGN08,                       *01728000
                     BRCH_REGION_09 = :BRREGN09,                       *01729000
                     BRCH_REGION_10 = :BRREGN10,                       *01730000
                     BRCH_REGION_11 = :BRREGN11,                       *01731000
                     BRCH_REGION_12 = :BRREGN12,                       *01732000
                     BRCH_REGION_13 = :BRREGN13,                       *01733000
                     BRCH_REGION_14 = :BRREGN14,                       *01734000
                     BRCH_REGION_15 = :BRREGN15,                       *01735000
                     BRCH_REGION_16 = :BRREGN16,                       *01736000
                     BRCH_REGION_17 = :BRREGN17,                       *01737000
                     BRCH_REGION_18 = :BRREGN18,                       *01738000
                     BRCH_REGION_19 = :BRREGN19,                       *01739000
                     BRCH_REGION_20 = :BRREGN20,                       *01740000
                     BRCH_REGION_21 = :BRREGN21,                       *01741000
                     BRCH_REGION_22 = :BRREGN22,                       *01742000
                     BRCH_REGION_23 = :BRREGN23,                       *01743000
                     BRCH_REGION_24 = :BRREGN24,                       *01744000
                     BRCH_REGION_25 = :BRREGN25,                       *01745000
                     BRCH_REGION_26 = :BRREGN26,                       *01746000
                     BRCH_REGION_27 = :BRREGN27,                       *01747000
                     BRCH_REGION_28 = :BRREGN28,                       *01748000
                     BRCH_REGION_29 = :BRREGN29,                       *01749000
                     BRCH_REGION_30 = :BRREGN30,                       *01750000
                     BRCH_REGION_31 = :BRREGN31,                       *01751000
                     BRCH_REGION_32 = :BRREGN32,                       *01752000
                     BRCH_REGION_33 = :BRREGN33,                       *01753000
                     BRCH_REGION_34 = :BRREGN34,                       *01754000
                     BRCH_REGION_35 = :BRREGN35,                       *01755000
                     BRCH_REGION_36 = :BRREGN36,                       *01756000
                     BRCH_REGION_37 = :BRREGN37,                       *01757000
                     BRCH_REGION_38 = :BRREGN38,                       *01758000
                     BRCH_REGION_39 = :BRREGN39,                       *01759000
                     BRCH_REGION_40 = :BRREGN40,                       *01760000
                     BRCH_REGION_41 = :BRREGN41,                       *01761000
                     BRCH_REGION_42 = :BRREGN42,                       *01762000
                     BRCH_REGION_43 = :BRREGN43,                       *01763000
                     BRCH_REGION_44 = :BRREGN44,                       *01764000
                     BRCH_REGION_45 = :BRREGN45,                       *01765000
                     BRCH_REGION_46 = :BRREGN46,                       *01766000
                     BRCH_REGION_47 = :BRREGN47,                       *01767000
                     BRCH_REGION_48 = :BRREGN48,                       *01768000
                     BRCH_REGION_49 = :BRREGN49,                       *01769000
                     BRCH_REGION_50 = :BRREGN50,                       *01770000
                     TABLE_TYPE = :TABLETYP                            *01771000
                 WHERE CURRENT OF S07UPD0                               01772000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01773000
         BR    14                      RETURN TO CALLER                 01774000
         LTORG                                                          01775000
*                                                                       01776000
*                                                                       01777000
**********************************************************************  01778000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01779000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01780000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01781000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01782000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01783000
*     STATEMENT.                                                        01784000
**********************************************************************  01785000
*                                                                       01786000
SQL#0038 DS    0H                                                       01787000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01788000
         LA    15,255                  SET RETURN CODE                  01789000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01790000
         BR    14                      RETURN TO CALLER                 01791000
         LTORG                                                          01792000
*                                                                       01793000
*                                                                       01794000
**********************************************************************  01795000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01796000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01797000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01798000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01799000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01800000
*     STATEMENT.                                                        01801000
**********************************************************************  01802000
*                                                                       01803000
SQL#0039 DS    0H                                                       01804000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01805000
         LA    15,255                  SET RETURN CODE                  01806000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01807000
         BR    14                      RETURN TO CALLER                 01808000
         LTORG                                                          01809000
*                                                                       01810000
*                                                                       01811000
**********************************************************************  01812000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01813000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01814000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01815000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01816000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01817000
*     STATEMENT.                                                        01818000
**********************************************************************  01819000
*                                                                       01820000
SQL#0040 DS    0H                                                       01821000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01822000
         LA    15,255                  SET RETURN CODE                  01823000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01824000
         BR    14                      RETURN TO CALLER                 01825000
         LTORG                                                          01826000
*                                                                       01827000
*                                                                       01828000
**********************************************************************  01829000
* DELETE STATEMENT BY PRIMARY KEY:                                      01830000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01831000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01832000
**********************************************************************  01833000
*                                                                       01834000
SQL#0041 DS    0H                                                       01835000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01836000
         B     *+6                     BRANCH AROUND ADCON              01837000
BASE0041 DC    AL2(4096)                                                01838000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01839000
         AH    3,BASE0041              ADD 4K                           01840000
         EXEC  SQL                                                     *01841000
               DELETE FROM S07                                         *01842000
                 WHERE CURRENT OF S07UPD0                               01843000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01844000
         BR    14                      RETURN TO CALLER                 01845000
         LTORG                                                          01846000
*                                                                       01847000
*                                                                       01848000
**********************************************************************  01849000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01850000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01851000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01852000
**********************************************************************  01853000
*                                                                       01854000
SQL#0042 DS    0H                                                       01855000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01856000
         LA    15,255                  SET RETURN CODE                  01857000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01858000
         BR    14                      RETURN TO CALLER                 01859000
         LTORG                                                          01860000
*                                                                       01861000
*                                                                       01862000
**********************************************************************  01863000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01864000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01865000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01866000
**********************************************************************  01867000
*                                                                       01868000
SQL#0043 DS    0H                                                       01869000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01870000
         LA    15,255                  SET RETURN CODE                  01871000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01872000
         BR    14                      RETURN TO CALLER                 01873000
         LTORG                                                          01874000
*                                                                       01875000
*                                                                       01876000
**********************************************************************  01877000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01878000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01879000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01880000
**********************************************************************  01881000
*                                                                       01882000
SQL#0044 DS    0H                                                       01883000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01884000
         LA    15,255                  SET RETURN CODE                  01885000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01886000
         BR    14                      RETURN TO CALLER                 01887000
         LTORG                                                          01888000
*                                                                       01889000
*                                                                       01890000
**********************************************************************  01891000
* DELETE ALL STATEMENT:                                                 01892000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01893000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01894000
**********************************************************************  01895000
*                                                                       01896000
SQL#0045 DS    0H                                                       01897000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01898000
         B     *+6                     BRANCH AROUND ADCON              01899000
BASE0045 DC    AL2(4096)                                                01900000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01901000
         AH    3,BASE0045              ADD 4K                           01902000
         EXEC  SQL                                                     *01903000
               DELETE FROM S07                                          01904000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01905000
         BR    14                      RETURN TO CALLER                 01906000
         LTORG                                                          01907000
*                                                                       01908000
*                                                                       01909000
**********************************************************************  01910000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01911000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01912000
**********************************************************************  01913000
*                                                                       01914000
SQL#0046 DS    0H                                                       01915000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01916000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01917000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01918000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01919000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01920000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01921000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01922000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01923000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01924000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01925000
VECT0046 DC    A(0)                                                     01926000
         DC    A(SQL#0246)                                              01927000
         DC    A(SQL#0346)                                              01928000
         LTORG                                                          01929000
*                                                                       01930000
SQL#0246 DS    0H                                                       01931000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01932000
         B     *+6                     BRANCH AROUND ADCON              01933000
BASE0246 DC    AL2(4096)                                                01934000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01935000
         AH    3,BASE0246              ADD 4K                           01936000
         EXEC  SQL                                                     *01937000
               CLOSE S07SQ001                                           01938000
         EXEC  SQL                                                     *01939000
               DECLARE S07SQ002 CURSOR FOR                             *01940000
               SELECT INST_NBR,                                        *01941000
                   RECORD_NBR,                                         *01942000
                   BRCH_REGN_CODE,                                     *01943000
                   AUDIT_DATE,                                         *01944000
                   AUDIT_TIME,                                         *01945000
                   AUDIT_USER,                                         *01946000
                   AUDIT_ORG,                                          *01947000
                   INCL_EXCL_OPT,                                      *01948000
                   BRCH_REGION_01,                                     *01949000
                   BRCH_REGION_02,                                     *01950000
                   BRCH_REGION_03,                                     *01951000
                   BRCH_REGION_04,                                     *01952000
                   BRCH_REGION_05,                                     *01953000
                   BRCH_REGION_06,                                     *01954000
                   BRCH_REGION_07,                                     *01955000
                   BRCH_REGION_08,                                     *01956000
                   BRCH_REGION_09,                                     *01957000
                   BRCH_REGION_10,                                     *01958000
                   BRCH_REGION_11,                                     *01959000
                   BRCH_REGION_12,                                     *01960000
                   BRCH_REGION_13,                                     *01961000
                   BRCH_REGION_14,                                     *01962000
                   BRCH_REGION_15,                                     *01963000
                   BRCH_REGION_16,                                     *01964000
                   BRCH_REGION_17,                                     *01965000
                   BRCH_REGION_18,                                     *01966000
                   BRCH_REGION_19,                                     *01967000
                   BRCH_REGION_20,                                     *01968000
                   BRCH_REGION_21,                                     *01969000
                   BRCH_REGION_22,                                     *01970000
                   BRCH_REGION_23,                                     *01971000
                   BRCH_REGION_24,                                     *01972000
                   BRCH_REGION_25,                                     *01973000
                   BRCH_REGION_26,                                     *01974000
                   BRCH_REGION_27,                                     *01975000
                   BRCH_REGION_28,                                     *01976000
                   BRCH_REGION_29,                                     *01977000
                   BRCH_REGION_30,                                     *01978000
                   BRCH_REGION_31,                                     *01979000
                   BRCH_REGION_32,                                     *01980000
                   BRCH_REGION_33,                                     *01981000
                   BRCH_REGION_34,                                     *01982000
                   BRCH_REGION_35,                                     *01983000
                   BRCH_REGION_36,                                     *01984000
                   BRCH_REGION_37,                                     *01985000
                   BRCH_REGION_38,                                     *01986000
                   BRCH_REGION_39,                                     *01987000
                   BRCH_REGION_40,                                     *01988000
                   BRCH_REGION_41,                                     *01989000
                   BRCH_REGION_42,                                     *01990000
                   BRCH_REGION_43,                                     *01991000
                   BRCH_REGION_44,                                     *01992000
                   BRCH_REGION_45,                                     *01993000
                   BRCH_REGION_46,                                     *01994000
                   BRCH_REGION_47,                                     *01995000
                   BRCH_REGION_48,                                     *01996000
                   BRCH_REGION_49,                                     *01997000
                   BRCH_REGION_50,                                     *01998000
                   TABLE_TYPE                                          *01999000
                 FROM S07                                              *02000000
                 WHERE                                                 *02001000
                    INST_NBR = :INST AND                               *02002000
                    RECORD_NBR > :RECNBR                               *02003000
                 ORDER BY RECORD_NBR,                                  *02004000
                   BRCH_REGN_CODE                                      *02005000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02006000
         EXEC  SQL                                                     *02007000
               OPEN S07SQ002                                            02008000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02009000
         BNZ   *+8                     NO - RETURN ERROR                02010000
         LR    12,9                    LOAD RETURN ADDRESS              02011000
         BR    12                      RETURN TO FETCH ROUTINE          02012000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02013000
         BR    14                      RETURN TO CALLER                 02014000
         LTORG                                                          02015000
*                                                                       02016000
SQL#0346 DS    0H                                                       02017000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          02018000
         B     *+6                     BRANCH AROUND ADCON              02019000
BASE0346 DC    AL2(4096)                                                02020000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02021000
         AH    3,BASE0346              ADD 4K                           02022000
         EXEC  SQL                                                     *02023000
               CLOSE S07SQ002                                           02024000
         EXEC  SQL                                                     *02025000
               DECLARE S07SQ003 CURSOR FOR                             *02026000
               SELECT INST_NBR,                                        *02027000
                   RECORD_NBR,                                         *02028000
                   BRCH_REGN_CODE,                                     *02029000
                   AUDIT_DATE,                                         *02030000
                   AUDIT_TIME,                                         *02031000
                   AUDIT_USER,                                         *02032000
                   AUDIT_ORG,                                          *02033000
                   INCL_EXCL_OPT,                                      *02034000
                   BRCH_REGION_01,                                     *02035000
                   BRCH_REGION_02,                                     *02036000
                   BRCH_REGION_03,                                     *02037000
                   BRCH_REGION_04,                                     *02038000
                   BRCH_REGION_05,                                     *02039000
                   BRCH_REGION_06,                                     *02040000
                   BRCH_REGION_07,                                     *02041000
                   BRCH_REGION_08,                                     *02042000
                   BRCH_REGION_09,                                     *02043000
                   BRCH_REGION_10,                                     *02044000
                   BRCH_REGION_11,                                     *02045000
                   BRCH_REGION_12,                                     *02046000
                   BRCH_REGION_13,                                     *02047000
                   BRCH_REGION_14,                                     *02048000
                   BRCH_REGION_15,                                     *02049000
                   BRCH_REGION_16,                                     *02050000
                   BRCH_REGION_17,                                     *02051000
                   BRCH_REGION_18,                                     *02052000
                   BRCH_REGION_19,                                     *02053000
                   BRCH_REGION_20,                                     *02054000
                   BRCH_REGION_21,                                     *02055000
                   BRCH_REGION_22,                                     *02056000
                   BRCH_REGION_23,                                     *02057000
                   BRCH_REGION_24,                                     *02058000
                   BRCH_REGION_25,                                     *02059000
                   BRCH_REGION_26,                                     *02060000
                   BRCH_REGION_27,                                     *02061000
                   BRCH_REGION_28,                                     *02062000
                   BRCH_REGION_29,                                     *02063000
                   BRCH_REGION_30,                                     *02064000
                   BRCH_REGION_31,                                     *02065000
                   BRCH_REGION_32,                                     *02066000
                   BRCH_REGION_33,                                     *02067000
                   BRCH_REGION_34,                                     *02068000
                   BRCH_REGION_35,                                     *02069000
                   BRCH_REGION_36,                                     *02070000
                   BRCH_REGION_37,                                     *02071000
                   BRCH_REGION_38,                                     *02072000
                   BRCH_REGION_39,                                     *02073000
                   BRCH_REGION_40,                                     *02074000
                   BRCH_REGION_41,                                     *02075000
                   BRCH_REGION_42,                                     *02076000
                   BRCH_REGION_43,                                     *02077000
                   BRCH_REGION_44,                                     *02078000
                   BRCH_REGION_45,                                     *02079000
                   BRCH_REGION_46,                                     *02080000
                   BRCH_REGION_47,                                     *02081000
                   BRCH_REGION_48,                                     *02082000
                   BRCH_REGION_49,                                     *02083000
                   BRCH_REGION_50,                                     *02084000
                   TABLE_TYPE                                          *02085000
                 FROM S07                                              *02086000
                 WHERE                                                 *02087000
                    INST_NBR > :INST                                   *02088000
                 ORDER BY INST_NBR,                                    *02089000
                   RECORD_NBR,                                         *02090000
                   BRCH_REGN_CODE                                      *02091000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02092000
         EXEC  SQL                                                     *02093000
               OPEN S07SQ003                                            02094000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02095000
         BNZ   *+8                     NO - RETURN ERROR                02096000
         LR    12,9                    LOAD RETURN ADDRESS              02097000
         BR    12                      RETURN TO FETCH ROUTINE          02098000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02099000
         BR    14                      RETURN TO CALLER                 02100000
         LTORG                                                          02101000
*                                                                       02102000
*                                                                       02103000
**********************************************************************  02104000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02105000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02106000
**********************************************************************  02107000
*                                                                       02108000
SQL#0047 DS    0H                                                       02109000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02110000
         LA    15,255                  SET RETURN CODE                  02111000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02112000
         BR    14                      RETURN TO CALLER                 02113000
         LTORG                                                          02114000
*                                                                       02115000
*                                                                       02116000
**********************************************************************  02117000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02118000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02119000
**********************************************************************  02120000
*                                                                       02121000
SQL#0048 DS    0H                                                       02122000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02123000
         LA    15,255                  SET RETURN CODE                  02124000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02125000
         BR    14                      RETURN TO CALLER                 02126000
         LTORG                                                          02127000
*                                                                       02128000
*                                                                       02129000
**********************************************************************  02130000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02131000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02132000
**********************************************************************  02133000
*                                                                       02134000
SQL#0049 DS    0H                                                       02135000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02136000
         LA    15,255                  SET RETURN CODE                  02137000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02138000
         BR    14                      RETURN TO CALLER                 02139000
         LTORG                                                          02140000
*                                                                       02141000
         DS    0H                      END OF SQL STATEMENTS            02142000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02143000
*                                                                       02144000
*                                                                       02145000
**********************************************************************  02146000
* DUMMY ENTRY POINT DSNHLI                                              02147000
*   MUST NOT BE MODIFIED.                                               02148000
**********************************************************************  02149000
*                                                                       02150000
         ENTRY DSNHLI                                                   02151000
DSNHLI   DS    0H                                                       02152000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02153000
         BR    15                      BRANCH TO ATTACH FACILITY        02154000
*                                                                       02155000
*                                                                       02156000
**********************************************************************  02157000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02158000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02159000
*   MUST NOT BE MODIFIED.                                               02160000
**********************************************************************  02161000
*                                                                       02162000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02163000
CONV#RTN AMODE ANY                                                      02164000
CONV#RTN RMODE ANY                                                      02165000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02166000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02167000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02168000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02169000
         BER   4                         YES - RETURN TO SQL            02170000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02171000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02172000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02173000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02174000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02175000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02176000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02177000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02178000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02179000
*                                                                       02180000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02181000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02182000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02183000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02184000
         BER   4                         YES - RETURN TO SQL            02185000
         SLR   0,0                     CLEAR FOR INSERT                 02186000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02187000
         NR    0,3                     FOR THE CURRENT KEY?             02188000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02189000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02190000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02191000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02192000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02193000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02194000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02195000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02196000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02197000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02198000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02199000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02200000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02201000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02202000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02203000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02204000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02205000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02206000
*                                                                       02207000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02208000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02209000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02210000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02211000
         BER   4                         YES - RETURN TO SQL            02212000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02213000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02214000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02215000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02216000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02217000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02218000
         MVCL  0,14                    MOVE TO RECORD AREA              02219000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02220000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02221000
*                                                                       02222000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02223000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02224000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02225000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02226000
         BER   4                         YES - RETURN TO SQL            02227000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02228000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02229000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02230000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02231000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02232000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02233000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02234000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02235000
         MVCL  0,14                    MOVE TO RECORD AREA              02236000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02237000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02238000
*                                                                       02239000
*                                                                       02240000
**********************************************************************  02241000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02242000
*   MUST NOT BE MODIFIED.                                               02243000
**********************************************************************  02244000
*                                                                       02245000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02246000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02247000
         DC    H'0014'                 LENGTH TO MOVE                   02248000
         DC    X'80'                   80 = KEY 0 FIELD                 02249000
*                                      40 = KEY 1 FIELD                 02250000
*                                      20 = KEY 2 FIELD                 02251000
*                                      10 = KEY 3 FIELD                 02252000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02253000
*                                                                       02254000
*                                      REST OF FIELD ENTRIES            02255000
         DC    H'0014',H'0014',H'0176',X'00',X'00'                      02256000
         DC    8X'FF'                  END OF FIELD ENTRIES             02257000
         LTORG                                                          02258000
         END                                                            02259000
