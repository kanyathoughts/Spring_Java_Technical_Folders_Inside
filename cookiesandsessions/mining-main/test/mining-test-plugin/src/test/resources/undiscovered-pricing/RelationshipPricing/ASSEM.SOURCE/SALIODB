* REL=SALIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SALIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAL FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL297                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
PRDCDE   DS    CL6                                                      00039000
ACCTNBR  DS    CL18                                                     00040000
MODEL    DS    CL10                                                     00041000
AUDDATE  DS    PL5'0.'                                                  00042000
AUDTIME  DS    PL5'0.'                                                  00043000
AUDUSER  DS    CL8                                                      00044000
AUDORG   DS    CL6                                                      00045000
GRACEDTE DS    PL5'0.'                                                  00046000
TRNDTE01 DS    PL5'0.'                                                  00047000
TRNCNT01 DS    PL3'0.'                                                  00048000
TRNAMT01 DS    PL7'0.00'                                                00049000
TRNDTE02 DS    PL5'0.'                                                  00050000
TRNCNT02 DS    PL3'0.'                                                  00051000
TRNAMT02 DS    PL7'0.00'                                                00052000
TRNDTE03 DS    PL5'0.'                                                  00053000
TRNCNT03 DS    PL3'0.'                                                  00054000
TRNAMT03 DS    PL7'0.00'                                                00055000
TRNDTE04 DS    PL5'0.'                                                  00056000
TRNCNT04 DS    PL3'0.'                                                  00057000
TRNAMT04 DS    PL7'0.00'                                                00058000
TRNDTE05 DS    PL5'0.'                                                  00059000
TRNCNT05 DS    PL3'0.'                                                  00060000
TRNAMT05 DS    PL7'0.00'                                                00061000
TRNDTE06 DS    PL5'0.'                                                  00062000
TRNCNT06 DS    PL3'0.'                                                  00063000
TRNAMT06 DS    PL7'0.00'                                                00064000
TRNDTE07 DS    PL5'0.'                                                  00065000
TRNCNT07 DS    PL3'0.'                                                  00066000
TRNAMT07 DS    PL7'0.00'                                                00067000
TRNDTE08 DS    PL5'0.'                                                  00068000
TRNCNT08 DS    PL3'0.'                                                  00069000
TRNAMT08 DS    PL7'0.00'                                                00070000
TRNDTE09 DS    PL5'0.'                                                  00071000
TRNCNT09 DS    PL3'0.'                                                  00072000
TRNAMT09 DS    PL7'0.00'                                                00073000
TRNDTE10 DS    PL5'0.'                                                  00074000
TRNCNT10 DS    PL3'0.'                                                  00075000
TRNAMT10 DS    PL7'0.00'                                                00076000
TRNDTE11 DS    PL5'0.'                                                  00077000
TRNCNT11 DS    PL3'0.'                                                  00078000
TRNAMT11 DS    PL7'0.00'                                                00079000
TRNDTE12 DS    PL5'0.'                                                  00080000
TRNCNT12 DS    PL3'0.'                                                  00081000
TRNAMT12 DS    PL7'0.00'                                                00082000
RAREA    DS    CL50                                                     00083000
*                                                                       00084000
*                                                                       00085000
**********************************************************************  00086000
* PROGRAM TABLE HEADER SECTION:                                         00087000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00088000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00089000
**********************************************************************  00090000
*                                                                       00091000
SALIODB  CSECT                         PROGRAM TABLE SECTION            00092000
SALIODB  AMODE ANY                                                      00093000
SALIODB  RMODE ANY                                                      00094000
         DC    CL9'SALIODB'            PROGRAM ID                       00095000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00096000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00097000
         DC    A(0)                    RESERVED                         00098000
         DC    A(0)                    RESERVED                         00099000
         DC    24CL1' '                RESERVED                         00100000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00101000
*                                                                       00102000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00103000
         DC    CL29'WWW.INFOR.COM                '                      00103001
*                                                                       00104000
*                                                                       00105000
**********************************************************************  00106000
* STATEMENT TABLE SECTION:                                              00107000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00108000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00109000
*   SHOULD NOT BE MODIFIED.                                             00110000
**********************************************************************  00111000
*                                                                       00112000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00113000
STM#TAB  AMODE ANY                                                      00114000
STM#TAB  RMODE ANY                                                      00115000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00116000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00117000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00118000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00119000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00120000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00121000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00122000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00123000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00124000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00125000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00126000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00127000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00128000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00129000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00130000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00131000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00132000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00133000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00134000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00135000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00136000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00137000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00138000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00139000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00140000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00141000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00142000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00143000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00144000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00145000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00146000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00147000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00148000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00149000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00150000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00151000
         DC    A(SQL#0036)             INSERT STATEMENT                 00152000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00153000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00154000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00155000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00156000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00157000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00158000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00159000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00160000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00161000
         DC    4X'FF'                                                   00162000
*                                                                       00163000
*                                                                       00164000
**********************************************************************  00165000
* SQL STATEMENT SECTION:                                                00166000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00167000
*     TO SUPPORT THIS TABLE.                                            00168000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00169000
*     ARE EQUIVALENT.                                                   00170000
**********************************************************************  00171000
*                                                                       00172000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00173000
SQL#STMT AMODE ANY                                                      00174000
SQL#STMT RMODE ANY                                                      00175000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00176000
         USING SQLDSECT,10,3           ADDRESS SQLDSECT                 00177000
         USING COM#AREA,11             ADDRESS COMMAREA                 00178000
*                                                                       00179000
*                                                                       00180000
**********************************************************************  00181000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00182000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00183000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00184000
**********************************************************************  00185000
*                                                                       00186000
SQL#0000 DS    0H                                                       00187000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00188000
         B     *+6                     BRANCH AROUND ADCON              00189000
BASE0000 DC    AL2(4096)                                                00190000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00191000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00192000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00193000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00194000
         AH    3,BASE0000              ADD 4K                           00195000
         EXEC  SQL                                                     *00196000
               SELECT AUDIT_DATE,                                      *00197000
                   AUDIT_TIME,                                         *00198000
                   AUDIT_USER,                                         *00199000
                   AUDIT_ORG,                                          *00200000
                   GRACE_EXP_DATE,                                     *00201000
                   TRAN_DATE_01,                                       *00202000
                   TRAN_COUNT_01,                                      *00203000
                   TRAN_AMOUNT_01,                                     *00204000
                   TRAN_DATE_02,                                       *00205000
                   TRAN_COUNT_02,                                      *00206000
                   TRAN_AMOUNT_02,                                     *00207000
                   TRAN_DATE_03,                                       *00208000
                   TRAN_COUNT_03,                                      *00209000
                   TRAN_AMOUNT_03,                                     *00210000
                   TRAN_DATE_04,                                       *00211000
                   TRAN_COUNT_04,                                      *00212000
                   TRAN_AMOUNT_04,                                     *00213000
                   TRAN_DATE_05,                                       *00214000
                   TRAN_COUNT_05,                                      *00215000
                   TRAN_AMOUNT_05,                                     *00216000
                   TRAN_DATE_06,                                       *00217000
                   TRAN_COUNT_06,                                      *00218000
                   TRAN_AMOUNT_06,                                     *00219000
                   TRAN_DATE_07,                                       *00220000
                   TRAN_COUNT_07,                                      *00221000
                   TRAN_AMOUNT_07,                                     *00222000
                   TRAN_DATE_08,                                       *00223000
                   TRAN_COUNT_08,                                      *00224000
                   TRAN_AMOUNT_08,                                     *00225000
                   TRAN_DATE_09,                                       *00226000
                   TRAN_COUNT_09,                                      *00227000
                   TRAN_AMOUNT_09,                                     *00228000
                   TRAN_DATE_10,                                       *00229000
                   TRAN_COUNT_10,                                      *00230000
                   TRAN_AMOUNT_10,                                     *00231000
                   TRAN_DATE_11,                                       *00232000
                   TRAN_COUNT_11,                                      *00233000
                   TRAN_AMOUNT_11,                                     *00234000
                   TRAN_DATE_12,                                       *00235000
                   TRAN_COUNT_12,                                      *00236000
                   TRAN_AMOUNT_12,                                     *00237000
                   RSV_AREA                                            *00238000
                 INTO :AUDDATE,                                        *00239000
                   :AUDTIME,                                           *00240000
                   :AUDUSER,                                           *00241000
                   :AUDORG,                                            *00242000
                   :GRACEDTE,                                          *00243000
                   :TRNDTE01,                                          *00244000
                   :TRNCNT01,                                          *00245000
                   :TRNAMT01,                                          *00246000
                   :TRNDTE02,                                          *00247000
                   :TRNCNT02,                                          *00248000
                   :TRNAMT02,                                          *00249000
                   :TRNDTE03,                                          *00250000
                   :TRNCNT03,                                          *00251000
                   :TRNAMT03,                                          *00252000
                   :TRNDTE04,                                          *00253000
                   :TRNCNT04,                                          *00254000
                   :TRNAMT04,                                          *00255000
                   :TRNDTE05,                                          *00256000
                   :TRNCNT05,                                          *00257000
                   :TRNAMT05,                                          *00258000
                   :TRNDTE06,                                          *00259000
                   :TRNCNT06,                                          *00260000
                   :TRNAMT06,                                          *00261000
                   :TRNDTE07,                                          *00262000
                   :TRNCNT07,                                          *00263000
                   :TRNAMT07,                                          *00264000
                   :TRNDTE08,                                          *00265000
                   :TRNCNT08,                                          *00266000
                   :TRNAMT08,                                          *00267000
                   :TRNDTE09,                                          *00268000
                   :TRNCNT09,                                          *00269000
                   :TRNAMT09,                                          *00270000
                   :TRNDTE10,                                          *00271000
                   :TRNCNT10,                                          *00272000
                   :TRNAMT10,                                          *00273000
                   :TRNDTE11,                                          *00274000
                   :TRNCNT11,                                          *00275000
                   :TRNAMT11,                                          *00276000
                   :TRNDTE12,                                          *00277000
                   :TRNCNT12,                                          *00278000
                   :TRNAMT12,                                          *00279000
                   :RAREA                                              *00280000
                 FROM SAL                                              *00281000
                 WHERE INST_NBR = :INST AND                            *00282000
                   PROD_CODE = :PRDCDE AND                             *00283000
                   ACCT_NBR = :ACCTNBR AND                             *00284000
                   MODEL = :MODEL                                      *00285000
                 FETCH FIRST 1 ROW ONLY                                 00286000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00287000
         BALR  4,5                     MOVE INTO RECORD AREA            00288000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00289000
         BR    14                      RETURN TO CALLER                 00290000
         LTORG                                                          00291000
*                                                                       00292000
*                                                                       00293000
**********************************************************************  00294000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00295000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00296000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00297000
**********************************************************************  00298000
*                                                                       00299000
SQL#0001 DS    0H                                                       00300000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00301000
         LA    15,255                  SET RETURN CODE                  00302000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00303000
         BR    14                      RETURN TO CALLER                 00304000
         LTORG                                                          00305000
*                                                                       00306000
*                                                                       00307000
**********************************************************************  00308000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00309000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00310000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00311000
**********************************************************************  00312000
*                                                                       00313000
SQL#0002 DS    0H                                                       00314000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00315000
         LA    15,255                  SET RETURN CODE                  00316000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00317000
         BR    14                      RETURN TO CALLER                 00318000
         LTORG                                                          00319000
*                                                                       00320000
*                                                                       00321000
**********************************************************************  00322000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00323000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00324000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00325000
**********************************************************************  00326000
*                                                                       00327000
SQL#0003 DS    0H                                                       00328000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00329000
         LA    15,255                  SET RETURN CODE                  00330000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00331000
         BR    14                      RETURN TO CALLER                 00332000
         LTORG                                                          00333000
*                                                                       00334000
*                                                                       00335000
**********************************************************************  00336000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00337000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00338000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00339000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00340000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00341000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00342000
*     UPDATE STATEMENT TO MATCH.                                        00343000
**********************************************************************  00344000
*                                                                       00345000
SQL#0004 DS    0H                                                       00346000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00347000
         B     *+6                     BRANCH AROUND ADCON              00348000
BASE0004 DC    AL2(4096)                                                00349000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00350000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00351000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00352000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00353000
         AH    3,BASE0004              ADD 4K                           00354000
         EXEC  SQL                                                     *00355000
               DECLARE SALUPD0 CURSOR FOR                              *00356000
               SELECT AUDIT_DATE,                                      *00357000
                   AUDIT_TIME,                                         *00358000
                   AUDIT_USER,                                         *00359000
                   AUDIT_ORG,                                          *00360000
                   GRACE_EXP_DATE,                                     *00361000
                   TRAN_DATE_01,                                       *00362000
                   TRAN_COUNT_01,                                      *00363000
                   TRAN_AMOUNT_01,                                     *00364000
                   TRAN_DATE_02,                                       *00365000
                   TRAN_COUNT_02,                                      *00366000
                   TRAN_AMOUNT_02,                                     *00367000
                   TRAN_DATE_03,                                       *00368000
                   TRAN_COUNT_03,                                      *00369000
                   TRAN_AMOUNT_03,                                     *00370000
                   TRAN_DATE_04,                                       *00371000
                   TRAN_COUNT_04,                                      *00372000
                   TRAN_AMOUNT_04,                                     *00373000
                   TRAN_DATE_05,                                       *00374000
                   TRAN_COUNT_05,                                      *00375000
                   TRAN_AMOUNT_05,                                     *00376000
                   TRAN_DATE_06,                                       *00377000
                   TRAN_COUNT_06,                                      *00378000
                   TRAN_AMOUNT_06,                                     *00379000
                   TRAN_DATE_07,                                       *00380000
                   TRAN_COUNT_07,                                      *00381000
                   TRAN_AMOUNT_07,                                     *00382000
                   TRAN_DATE_08,                                       *00383000
                   TRAN_COUNT_08,                                      *00384000
                   TRAN_AMOUNT_08,                                     *00385000
                   TRAN_DATE_09,                                       *00386000
                   TRAN_COUNT_09,                                      *00387000
                   TRAN_AMOUNT_09,                                     *00388000
                   TRAN_DATE_10,                                       *00389000
                   TRAN_COUNT_10,                                      *00390000
                   TRAN_AMOUNT_10,                                     *00391000
                   TRAN_DATE_11,                                       *00392000
                   TRAN_COUNT_11,                                      *00393000
                   TRAN_AMOUNT_11,                                     *00394000
                   TRAN_DATE_12,                                       *00395000
                   TRAN_COUNT_12,                                      *00396000
                   TRAN_AMOUNT_12,                                     *00397000
                   RSV_AREA                                            *00398000
                 FROM SAL                                              *00399000
                 WHERE INST_NBR = :INST AND                            *00400000
                   PROD_CODE = :PRDCDE AND                             *00401000
                   ACCT_NBR = :ACCTNBR AND                             *00402000
                   MODEL = :MODEL                                      *00403000
                 FOR UPDATE OF AUDIT_DATE,                             *00404000
                   AUDIT_TIME,                                         *00405000
                   AUDIT_USER,                                         *00406000
                   AUDIT_ORG,                                          *00407000
                   GRACE_EXP_DATE,                                     *00408000
                   TRAN_DATE_01,                                       *00409000
                   TRAN_COUNT_01,                                      *00410000
                   TRAN_AMOUNT_01,                                     *00411000
                   TRAN_DATE_02,                                       *00412000
                   TRAN_COUNT_02,                                      *00413000
                   TRAN_AMOUNT_02,                                     *00414000
                   TRAN_DATE_03,                                       *00415000
                   TRAN_COUNT_03,                                      *00416000
                   TRAN_AMOUNT_03,                                     *00417000
                   TRAN_DATE_04,                                       *00418000
                   TRAN_COUNT_04,                                      *00419000
                   TRAN_AMOUNT_04,                                     *00420000
                   TRAN_DATE_05,                                       *00421000
                   TRAN_COUNT_05,                                      *00422000
                   TRAN_AMOUNT_05,                                     *00423000
                   TRAN_DATE_06,                                       *00424000
                   TRAN_COUNT_06,                                      *00425000
                   TRAN_AMOUNT_06,                                     *00426000
                   TRAN_DATE_07,                                       *00427000
                   TRAN_COUNT_07,                                      *00428000
                   TRAN_AMOUNT_07,                                     *00429000
                   TRAN_DATE_08,                                       *00430000
                   TRAN_COUNT_08,                                      *00431000
                   TRAN_AMOUNT_08,                                     *00432000
                   TRAN_DATE_09,                                       *00433000
                   TRAN_COUNT_09,                                      *00434000
                   TRAN_AMOUNT_09,                                     *00435000
                   TRAN_DATE_10,                                       *00436000
                   TRAN_COUNT_10,                                      *00437000
                   TRAN_AMOUNT_10,                                     *00438000
                   TRAN_DATE_11,                                       *00439000
                   TRAN_COUNT_11,                                      *00440000
                   TRAN_AMOUNT_11,                                     *00441000
                   TRAN_DATE_12,                                       *00442000
                   TRAN_COUNT_12,                                      *00443000
                   TRAN_AMOUNT_12,                                     *00444000
                   RSV_AREA                                            *00445000
                 FETCH FIRST 1 ROW ONLY                                 00446000
         EXEC  SQL                                                     *00447000
               OPEN SALUPD0                                             00448000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00449000
         BR    14                      RETURN TO CALLER                 00450000
         LTORG                                                          00451000
*                                                                       00452000
*                                                                       00453000
**********************************************************************  00454000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00455000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00456000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00457000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00458000
*     UPDATE STATEMENT TO MATCH.                                        00459000
**********************************************************************  00460000
*                                                                       00461000
SQL#0005 DS    0H                                                       00462000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00463000
         LA    15,255                  SET RETURN CODE                  00464000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00465000
         BR    14                      RETURN TO CALLER                 00466000
         LTORG                                                          00467000
*                                                                       00468000
*                                                                       00469000
**********************************************************************  00470000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00471000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00472000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00473000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00474000
*     UPDATE STATEMENT TO MATCH.                                        00475000
**********************************************************************  00476000
*                                                                       00477000
SQL#0006 DS    0H                                                       00478000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00479000
         LA    15,255                  SET RETURN CODE                  00480000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00481000
         BR    14                      RETURN TO CALLER                 00482000
         LTORG                                                          00483000
*                                                                       00484000
*                                                                       00485000
**********************************************************************  00486000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00487000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00488000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00489000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00490000
*     UPDATE STATEMENT TO MATCH.                                        00491000
**********************************************************************  00492000
*                                                                       00493000
SQL#0007 DS    0H                                                       00494000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00495000
         LA    15,255                  SET RETURN CODE                  00496000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00497000
         BR    14                      RETURN TO CALLER                 00498000
         LTORG                                                          00499000
*                                                                       00500000
*                                                                       00501000
**********************************************************************  00502000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00503000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00504000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00505000
*     THE ACTUAL ROW.                                                   00506000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00507000
**********************************************************************  00508000
*                                                                       00509000
SQL#0008 DS    0H                                                       00510000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00511000
         B     *+6                     BRANCH AROUND ADCON              00512000
BASE0008 DC    AL2(4096)                                                00513000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00514000
         AH    3,BASE0008              ADD 4K                           00515000
         EXEC  SQL                                                     *00516000
               FETCH SALUPD0                                           *00517000
                 INTO :AUDDATE,                                        *00518000
                   :AUDTIME,                                           *00519000
                   :AUDUSER,                                           *00520000
                   :AUDORG,                                            *00521000
                   :GRACEDTE,                                          *00522000
                   :TRNDTE01,                                          *00523000
                   :TRNCNT01,                                          *00524000
                   :TRNAMT01,                                          *00525000
                   :TRNDTE02,                                          *00526000
                   :TRNCNT02,                                          *00527000
                   :TRNAMT02,                                          *00528000
                   :TRNDTE03,                                          *00529000
                   :TRNCNT03,                                          *00530000
                   :TRNAMT03,                                          *00531000
                   :TRNDTE04,                                          *00532000
                   :TRNCNT04,                                          *00533000
                   :TRNAMT04,                                          *00534000
                   :TRNDTE05,                                          *00535000
                   :TRNCNT05,                                          *00536000
                   :TRNAMT05,                                          *00537000
                   :TRNDTE06,                                          *00538000
                   :TRNCNT06,                                          *00539000
                   :TRNAMT06,                                          *00540000
                   :TRNDTE07,                                          *00541000
                   :TRNCNT07,                                          *00542000
                   :TRNAMT07,                                          *00543000
                   :TRNDTE08,                                          *00544000
                   :TRNCNT08,                                          *00545000
                   :TRNAMT08,                                          *00546000
                   :TRNDTE09,                                          *00547000
                   :TRNCNT09,                                          *00548000
                   :TRNAMT09,                                          *00549000
                   :TRNDTE10,                                          *00550000
                   :TRNCNT10,                                          *00551000
                   :TRNAMT10,                                          *00552000
                   :TRNDTE11,                                          *00553000
                   :TRNCNT11,                                          *00554000
                   :TRNAMT11,                                          *00555000
                   :TRNDTE12,                                          *00556000
                   :TRNCNT12,                                          *00557000
                   :TRNAMT12,                                          *00558000
                   :RAREA                                               00559000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00560000
         BALR  4,5                     MOVE INTO RECORD AREA            00561000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00562000
         BR    14                      RETURN TO CALLER                 00563000
         LTORG                                                          00564000
*                                                                       00565000
*                                                                       00566000
**********************************************************************  00567000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00568000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00569000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00570000
*     THE ACTUAL ROW.                                                   00571000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00572000
**********************************************************************  00573000
*                                                                       00574000
SQL#0009 DS    0H                                                       00575000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00576000
         LA    15,255                  SET RETURN CODE                  00577000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00578000
         BR    14                      RETURN TO CALLER                 00579000
         LTORG                                                          00580000
*                                                                       00581000
*                                                                       00582000
**********************************************************************  00583000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00584000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00585000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00586000
*     THE ACTUAL ROW.                                                   00587000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00588000
**********************************************************************  00589000
*                                                                       00590000
SQL#0010 DS    0H                                                       00591000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00592000
         LA    15,255                  SET RETURN CODE                  00593000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00594000
         BR    14                      RETURN TO CALLER                 00595000
         LTORG                                                          00596000
*                                                                       00597000
*                                                                       00598000
**********************************************************************  00599000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00600000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00601000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00602000
*     THE ACTUAL ROW.                                                   00603000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00604000
**********************************************************************  00605000
*                                                                       00606000
SQL#0011 DS    0H                                                       00607000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00608000
         LA    15,255                  SET RETURN CODE                  00609000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00610000
         BR    14                      RETURN TO CALLER                 00611000
         LTORG                                                          00612000
*                                                                       00613000
*                                                                       00614000
**********************************************************************  00615000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00616000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00617000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00618000
*     TO CLOSE THE UPDATE CURSOR.                                       00619000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00620000
**********************************************************************  00621000
*                                                                       00622000
SQL#0012 DS    0H                                                       00623000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00624000
         B     *+6                     BRANCH AROUND ADCON              00625000
BASE0012 DC    AL2(4096)                                                00626000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00627000
         AH    3,BASE0012              ADD 4K                           00628000
         EXEC  SQL                                                     *00629000
               CLOSE SALUPD0                                            00630000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00631000
         BR    14                      RETURN TO CALLER                 00632000
         LTORG                                                          00633000
*                                                                       00634000
*                                                                       00635000
**********************************************************************  00636000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00637000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00638000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00639000
*     TO CLOSE THE UPDATE CURSOR.                                       00640000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00641000
**********************************************************************  00642000
*                                                                       00643000
SQL#0013 DS    0H                                                       00644000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00645000
         LA    15,255                  SET RETURN CODE                  00646000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00647000
         BR    14                      RETURN TO CALLER                 00648000
         LTORG                                                          00649000
*                                                                       00650000
*                                                                       00651000
**********************************************************************  00652000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00653000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00654000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00655000
*     TO CLOSE THE UPDATE CURSOR.                                       00656000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00657000
**********************************************************************  00658000
*                                                                       00659000
SQL#0014 DS    0H                                                       00660000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00661000
         LA    15,255                  SET RETURN CODE                  00662000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00663000
         BR    14                      RETURN TO CALLER                 00664000
         LTORG                                                          00665000
*                                                                       00666000
*                                                                       00667000
**********************************************************************  00668000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00669000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00670000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00671000
*     TO CLOSE THE UPDATE CURSOR.                                       00672000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00673000
**********************************************************************  00674000
*                                                                       00675000
SQL#0015 DS    0H                                                       00676000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00677000
         LA    15,255                  SET RETURN CODE                  00678000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00679000
         BR    14                      RETURN TO CALLER                 00680000
         LTORG                                                          00681000
*                                                                       00682000
*                                                                       00683000
**********************************************************************  00684000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00685000
* KEY:                                                                  00686000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00687000
*     AND GET-NEXT-LOCK VERBS.                                          00688000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00689000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00690000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00691000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00692000
*     ORDER BY CLAUSE.                                                  00693000
**********************************************************************  00694000
*                                                                       00695000
SQL#0016 DS    0H                                                       00696000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00697000
         B     *+6                     BRANCH AROUND ADCON              00698000
BASE0016 DC    AL2(4096)                                                00699000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00700000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00701000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00702000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00703000
         AH    3,BASE0016              ADD 4K                           00704000
         EXEC  SQL                                                     *00705000
               DECLARE SALSQ001 CURSOR FOR                             *00706000
               SELECT INST_NBR,                                        *00707000
                   PROD_CODE,                                          *00708000
                   ACCT_NBR,                                           *00709000
                   MODEL,                                              *00710000
                   AUDIT_DATE,                                         *00711000
                   AUDIT_TIME,                                         *00712000
                   AUDIT_USER,                                         *00713000
                   AUDIT_ORG,                                          *00714000
                   GRACE_EXP_DATE,                                     *00715000
                   TRAN_DATE_01,                                       *00716000
                   TRAN_COUNT_01,                                      *00717000
                   TRAN_AMOUNT_01,                                     *00718000
                   TRAN_DATE_02,                                       *00719000
                   TRAN_COUNT_02,                                      *00720000
                   TRAN_AMOUNT_02,                                     *00721000
                   TRAN_DATE_03,                                       *00722000
                   TRAN_COUNT_03,                                      *00723000
                   TRAN_AMOUNT_03,                                     *00724000
                   TRAN_DATE_04,                                       *00725000
                   TRAN_COUNT_04,                                      *00726000
                   TRAN_AMOUNT_04,                                     *00727000
                   TRAN_DATE_05,                                       *00728000
                   TRAN_COUNT_05,                                      *00729000
                   TRAN_AMOUNT_05,                                     *00730000
                   TRAN_DATE_06,                                       *00731000
                   TRAN_COUNT_06,                                      *00732000
                   TRAN_AMOUNT_06,                                     *00733000
                   TRAN_DATE_07,                                       *00734000
                   TRAN_COUNT_07,                                      *00735000
                   TRAN_AMOUNT_07,                                     *00736000
                   TRAN_DATE_08,                                       *00737000
                   TRAN_COUNT_08,                                      *00738000
                   TRAN_AMOUNT_08,                                     *00739000
                   TRAN_DATE_09,                                       *00740000
                   TRAN_COUNT_09,                                      *00741000
                   TRAN_AMOUNT_09,                                     *00742000
                   TRAN_DATE_10,                                       *00743000
                   TRAN_COUNT_10,                                      *00744000
                   TRAN_AMOUNT_10,                                     *00745000
                   TRAN_DATE_11,                                       *00746000
                   TRAN_COUNT_11,                                      *00747000
                   TRAN_AMOUNT_11,                                     *00748000
                   TRAN_DATE_12,                                       *00749000
                   TRAN_COUNT_12,                                      *00750000
                   TRAN_AMOUNT_12,                                     *00751000
                   RSV_AREA                                            *00752000
                 FROM SAL                                              *00753000
                 WHERE                                                 *00754000
                    INST_NBR = :INST AND                               *00755000
                    PROD_CODE = :PRDCDE AND                            *00756000
                    ACCT_NBR = :ACCTNBR AND                            *00757000
                    MODEL >= :MODEL                                    *00758000
                 ORDER BY MODEL                                        *00759000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00760000
         EXEC  SQL                                                     *00761000
               OPEN SALSQ001                                            00762000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00763000
         BR    14                      RETURN TO CALLER                 00764000
         LTORG                                                          00765000
*                                                                       00766000
*                                                                       00767000
**********************************************************************  00768000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00769000
* KEY 1:                                                                00770000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00771000
*     AND GET-NEXT-LOCK VERBS.                                          00772000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00773000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00774000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00775000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00776000
*     ORDER BY CLAUSE.                                                  00777000
**********************************************************************  00778000
*                                                                       00779000
SQL#0017 DS    0H                                                       00780000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00781000
         LA    15,255                  SET RETURN CODE                  00782000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00783000
         BR    14                      RETURN TO CALLER                 00784000
         LTORG                                                          00785000
*                                                                       00786000
*                                                                       00787000
**********************************************************************  00788000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00789000
* KEY 2:                                                                00790000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00791000
*     AND GET-NEXT-LOCK VERBS.                                          00792000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00793000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00794000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00795000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00796000
*     ORDER BY CLAUSE.                                                  00797000
**********************************************************************  00798000
*                                                                       00799000
SQL#0018 DS    0H                                                       00800000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00801000
         LA    15,255                  SET RETURN CODE                  00802000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00803000
         BR    14                      RETURN TO CALLER                 00804000
         LTORG                                                          00805000
*                                                                       00806000
*                                                                       00807000
**********************************************************************  00808000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00809000
* KEY 3:                                                                00810000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00811000
*     AND GET-NEXT-LOCK VERBS.                                          00812000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00813000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00814000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00815000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00816000
*     ORDER BY CLAUSE.                                                  00817000
**********************************************************************  00818000
*                                                                       00819000
SQL#0019 DS    0H                                                       00820000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00821000
         LA    15,255                  SET RETURN CODE                  00822000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00823000
         BR    14                      RETURN TO CALLER                 00824000
         LTORG                                                          00825000
*                                                                       00826000
*                                                                       00827000
**********************************************************************  00828000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00829000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00830000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00831000
*     RETRIEVE THE ACTUAL ROW.                                          00832000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00833000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00834000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00835000
**********************************************************************  00836000
*                                                                       00837000
SQL#0020 DS    0H                                                       00838000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00839000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00840000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00841000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00842000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00843000
VECT0020 DC    A(SQL#0120)                                              00844000
         DC    A(SQL#0220)                                              00845000
         DC    A(SQL#0320)                                              00846000
         DC    A(SQL#0420)                                              00847000
         LTORG                                                          00848000
*                                                                       00849000
SQL#0120 DS    0H                                                       00850000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00851000
         B     *+6                     BRANCH AROUND ADCON              00852000
BASE0120 DC    AL2(4096)                                                00853000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00854000
         AH    3,BASE0120              ADD 4K                           00855000
         EXEC  SQL                                                     *00856000
               FETCH SALSQ001                                          *00857000
                 INTO :INST,                                           *00858000
                      :PRDCDE,                                         *00859000
                      :ACCTNBR,                                        *00860000
                      :MODEL,                                          *00861000
                      :AUDDATE,                                        *00862000
                      :AUDTIME,                                        *00863000
                      :AUDUSER,                                        *00864000
                      :AUDORG,                                         *00865000
                      :GRACEDTE,                                       *00866000
                      :TRNDTE01,                                       *00867000
                      :TRNCNT01,                                       *00868000
                      :TRNAMT01,                                       *00869000
                      :TRNDTE02,                                       *00870000
                      :TRNCNT02,                                       *00871000
                      :TRNAMT02,                                       *00872000
                      :TRNDTE03,                                       *00873000
                      :TRNCNT03,                                       *00874000
                      :TRNAMT03,                                       *00875000
                      :TRNDTE04,                                       *00876000
                      :TRNCNT04,                                       *00877000
                      :TRNAMT04,                                       *00878000
                      :TRNDTE05,                                       *00879000
                      :TRNCNT05,                                       *00880000
                      :TRNAMT05,                                       *00881000
                      :TRNDTE06,                                       *00882000
                      :TRNCNT06,                                       *00883000
                      :TRNAMT06,                                       *00884000
                      :TRNDTE07,                                       *00885000
                      :TRNCNT07,                                       *00886000
                      :TRNAMT07,                                       *00887000
                      :TRNDTE08,                                       *00888000
                      :TRNCNT08,                                       *00889000
                      :TRNAMT08,                                       *00890000
                      :TRNDTE09,                                       *00891000
                      :TRNCNT09,                                       *00892000
                      :TRNAMT09,                                       *00893000
                      :TRNDTE10,                                       *00894000
                      :TRNCNT10,                                       *00895000
                      :TRNAMT10,                                       *00896000
                      :TRNDTE11,                                       *00897000
                      :TRNCNT11,                                       *00898000
                      :TRNAMT11,                                       *00899000
                      :TRNDTE12,                                       *00900000
                      :TRNCNT12,                                       *00901000
                      :TRNAMT12,                                       *00902000
                      :RAREA                                            00903000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00904000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00905000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00906000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00907000
         BR    12                      OPEN NEXT CURSOR                 00908000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00909000
         BALR  4,5                     MOVE INTO RECORD AREA            00910000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00911000
         BR    14                      RETURN TO CALLER                 00912000
         LTORG                                                          00913000
*                                                                       00914000
SQL#0220 DS    0H                                                       00915000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00916000
         B     *+6                     BRANCH AROUND ADCON              00917000
BASE0220 DC    AL2(4096)                                                00918000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00919000
         AH    3,BASE0220              ADD 4K                           00920000
         EXEC  SQL                                                     *00921000
               FETCH SALSQ002                                          *00922000
                 INTO :INST,                                           *00923000
                      :PRDCDE,                                         *00924000
                      :ACCTNBR,                                        *00925000
                      :MODEL,                                          *00926000
                      :AUDDATE,                                        *00927000
                      :AUDTIME,                                        *00928000
                      :AUDUSER,                                        *00929000
                      :AUDORG,                                         *00930000
                      :GRACEDTE,                                       *00931000
                      :TRNDTE01,                                       *00932000
                      :TRNCNT01,                                       *00933000
                      :TRNAMT01,                                       *00934000
                      :TRNDTE02,                                       *00935000
                      :TRNCNT02,                                       *00936000
                      :TRNAMT02,                                       *00937000
                      :TRNDTE03,                                       *00938000
                      :TRNCNT03,                                       *00939000
                      :TRNAMT03,                                       *00940000
                      :TRNDTE04,                                       *00941000
                      :TRNCNT04,                                       *00942000
                      :TRNAMT04,                                       *00943000
                      :TRNDTE05,                                       *00944000
                      :TRNCNT05,                                       *00945000
                      :TRNAMT05,                                       *00946000
                      :TRNDTE06,                                       *00947000
                      :TRNCNT06,                                       *00948000
                      :TRNAMT06,                                       *00949000
                      :TRNDTE07,                                       *00950000
                      :TRNCNT07,                                       *00951000
                      :TRNAMT07,                                       *00952000
                      :TRNDTE08,                                       *00953000
                      :TRNCNT08,                                       *00954000
                      :TRNAMT08,                                       *00955000
                      :TRNDTE09,                                       *00956000
                      :TRNCNT09,                                       *00957000
                      :TRNAMT09,                                       *00958000
                      :TRNDTE10,                                       *00959000
                      :TRNCNT10,                                       *00960000
                      :TRNAMT10,                                       *00961000
                      :TRNDTE11,                                       *00962000
                      :TRNCNT11,                                       *00963000
                      :TRNAMT11,                                       *00964000
                      :TRNDTE12,                                       *00965000
                      :TRNCNT12,                                       *00966000
                      :TRNAMT12,                                       *00967000
                      :RAREA                                            00968000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00969000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00970000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00971000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00972000
         BR    12                      OPEN NEXT CURSOR                 00973000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00974000
         BALR  4,5                     MOVE INTO RECORD AREA            00975000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00976000
         BR    14                      RETURN TO CALLER                 00977000
         LTORG                                                          00978000
*                                                                       00979000
SQL#0320 DS    0H                                                       00980000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00981000
         B     *+6                     BRANCH AROUND ADCON              00982000
BASE0320 DC    AL2(4096)                                                00983000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    00984000
         AH    3,BASE0320              ADD 4K                           00985000
         EXEC  SQL                                                     *00986000
               FETCH SALSQ003                                          *00987000
                 INTO :INST,                                           *00988000
                      :PRDCDE,                                         *00989000
                      :ACCTNBR,                                        *00990000
                      :MODEL,                                          *00991000
                      :AUDDATE,                                        *00992000
                      :AUDTIME,                                        *00993000
                      :AUDUSER,                                        *00994000
                      :AUDORG,                                         *00995000
                      :GRACEDTE,                                       *00996000
                      :TRNDTE01,                                       *00997000
                      :TRNCNT01,                                       *00998000
                      :TRNAMT01,                                       *00999000
                      :TRNDTE02,                                       *01000000
                      :TRNCNT02,                                       *01001000
                      :TRNAMT02,                                       *01002000
                      :TRNDTE03,                                       *01003000
                      :TRNCNT03,                                       *01004000
                      :TRNAMT03,                                       *01005000
                      :TRNDTE04,                                       *01006000
                      :TRNCNT04,                                       *01007000
                      :TRNAMT04,                                       *01008000
                      :TRNDTE05,                                       *01009000
                      :TRNCNT05,                                       *01010000
                      :TRNAMT05,                                       *01011000
                      :TRNDTE06,                                       *01012000
                      :TRNCNT06,                                       *01013000
                      :TRNAMT06,                                       *01014000
                      :TRNDTE07,                                       *01015000
                      :TRNCNT07,                                       *01016000
                      :TRNAMT07,                                       *01017000
                      :TRNDTE08,                                       *01018000
                      :TRNCNT08,                                       *01019000
                      :TRNAMT08,                                       *01020000
                      :TRNDTE09,                                       *01021000
                      :TRNCNT09,                                       *01022000
                      :TRNAMT09,                                       *01023000
                      :TRNDTE10,                                       *01024000
                      :TRNCNT10,                                       *01025000
                      :TRNAMT10,                                       *01026000
                      :TRNDTE11,                                       *01027000
                      :TRNCNT11,                                       *01028000
                      :TRNAMT11,                                       *01029000
                      :TRNDTE12,                                       *01030000
                      :TRNCNT12,                                       *01031000
                      :TRNAMT12,                                       *01032000
                      :RAREA                                            01033000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01034000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01035000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      01036000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01037000
         BR    12                      OPEN NEXT CURSOR                 01038000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01039000
         BALR  4,5                     MOVE INTO RECORD AREA            01040000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01041000
         BR    14                      RETURN TO CALLER                 01042000
         LTORG                                                          01043000
*                                                                       01044000
SQL#0420 DS    0H                                                       01045000
         USING SQL#0420,12             ESTABLISH BASE REGISTER          01046000
         B     *+6                     BRANCH AROUND ADCON              01047000
BASE0420 DC    AL2(4096)                                                01048000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01049000
         AH    3,BASE0420              ADD 4K                           01050000
         EXEC  SQL                                                     *01051000
               FETCH SALSQ004                                          *01052000
                 INTO :INST,                                           *01053000
                      :PRDCDE,                                         *01054000
                      :ACCTNBR,                                        *01055000
                      :MODEL,                                          *01056000
                      :AUDDATE,                                        *01057000
                      :AUDTIME,                                        *01058000
                      :AUDUSER,                                        *01059000
                      :AUDORG,                                         *01060000
                      :GRACEDTE,                                       *01061000
                      :TRNDTE01,                                       *01062000
                      :TRNCNT01,                                       *01063000
                      :TRNAMT01,                                       *01064000
                      :TRNDTE02,                                       *01065000
                      :TRNCNT02,                                       *01066000
                      :TRNAMT02,                                       *01067000
                      :TRNDTE03,                                       *01068000
                      :TRNCNT03,                                       *01069000
                      :TRNAMT03,                                       *01070000
                      :TRNDTE04,                                       *01071000
                      :TRNCNT04,                                       *01072000
                      :TRNAMT04,                                       *01073000
                      :TRNDTE05,                                       *01074000
                      :TRNCNT05,                                       *01075000
                      :TRNAMT05,                                       *01076000
                      :TRNDTE06,                                       *01077000
                      :TRNCNT06,                                       *01078000
                      :TRNAMT06,                                       *01079000
                      :TRNDTE07,                                       *01080000
                      :TRNCNT07,                                       *01081000
                      :TRNAMT07,                                       *01082000
                      :TRNDTE08,                                       *01083000
                      :TRNCNT08,                                       *01084000
                      :TRNAMT08,                                       *01085000
                      :TRNDTE09,                                       *01086000
                      :TRNCNT09,                                       *01087000
                      :TRNAMT09,                                       *01088000
                      :TRNDTE10,                                       *01089000
                      :TRNCNT10,                                       *01090000
                      :TRNAMT10,                                       *01091000
                      :TRNDTE11,                                       *01092000
                      :TRNCNT11,                                       *01093000
                      :TRNAMT11,                                       *01094000
                      :TRNDTE12,                                       *01095000
                      :TRNCNT12,                                       *01096000
                      :TRNAMT12,                                       *01097000
                      :RAREA                                            01098000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   01099000
         BALR  4,5                     MOVE INTO RECORD AREA            01100000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01101000
         BR    14                      RETURN TO CALLER                 01102000
         LTORG                                                          01103000
*                                                                       01104000
*                                                                       01105000
**********************************************************************  01106000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           01107000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01108000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01109000
*     RETRIEVE THE ACTUAL ROW.                                          01110000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01111000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01112000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01113000
**********************************************************************  01114000
*                                                                       01115000
SQL#0021 DS    0H                                                       01116000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          01117000
         LA    15,255                  SET RETURN CODE                  01118000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01119000
         BR    14                      RETURN TO CALLER                 01120000
         LTORG                                                          01121000
*                                                                       01122000
*                                                                       01123000
**********************************************************************  01124000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           01125000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01126000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01127000
*     RETRIEVE THE ACTUAL ROW.                                          01128000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01129000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01130000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01131000
**********************************************************************  01132000
*                                                                       01133000
SQL#0022 DS    0H                                                       01134000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          01135000
         LA    15,255                  SET RETURN CODE                  01136000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01137000
         BR    14                      RETURN TO CALLER                 01138000
         LTORG                                                          01139000
*                                                                       01140000
*                                                                       01141000
**********************************************************************  01142000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           01143000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              01144000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01145000
*     RETRIEVE THE ACTUAL ROW.                                          01146000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             01147000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                01148000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01149000
**********************************************************************  01150000
*                                                                       01151000
SQL#0023 DS    0H                                                       01152000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          01153000
         LA    15,255                  SET RETURN CODE                  01154000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01155000
         BR    14                      RETURN TO CALLER                 01156000
         LTORG                                                          01157000
*                                                                       01158000
*                                                                       01159000
**********************************************************************  01160000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01161000
* THE PRIMARY KEY:                                                      01162000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01163000
*     VERBS.                                                            01164000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01165000
*     RETRIEVE THE ACTUAL ROW.                                          01166000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01167000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01168000
*     WILL BE THRU THE UPDATE CURSOR.                                   01169000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01170000
**********************************************************************  01171000
*                                                                       01172000
SQL#0024 DS    0H                                                       01173000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          01174000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01175000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    01176000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       01177000
         BR    12                      GO TO CURRENT FETCH ROUTINE      01178000
VECT0024 DC    A(SQL#0124)                                              01179000
         DC    A(SQL#0224)                                              01180000
         DC    A(SQL#0324)                                              01181000
         DC    A(SQL#0424)                                              01182000
         LTORG                                                          01183000
*                                                                       01184000
SQL#0124 DS    0H                                                       01185000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          01186000
         B     *+6                     BRANCH AROUND ADCON              01187000
BASE0124 DC    AL2(4096)                                                01188000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01189000
         AH    3,BASE0124              ADD 4K                           01190000
         EXEC  SQL                                                     *01191000
               FETCH SALSQ001                                          *01192000
                 INTO :INST,                                           *01193000
                      :PRDCDE,                                         *01194000
                      :ACCTNBR,                                        *01195000
                      :MODEL                                            01196000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01197000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01198000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01199000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01200000
         BR    12                      OPEN NEXT CURSOR                 01201000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01202000
         BALR  4,5                     MOVE INTO RECORD AREA            01203000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01204000
         BR    14                      RETURN TO CALLER                 01205000
         LTORG                                                          01206000
*                                                                       01207000
SQL#0224 DS    0H                                                       01208000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          01209000
         B     *+6                     BRANCH AROUND ADCON              01210000
BASE0224 DC    AL2(4096)                                                01211000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01212000
         AH    3,BASE0224              ADD 4K                           01213000
         EXEC  SQL                                                     *01214000
               FETCH SALSQ002                                          *01215000
                 INTO :INST,                                           *01216000
                      :PRDCDE,                                         *01217000
                      :ACCTNBR,                                        *01218000
                      :MODEL                                            01219000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01220000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01221000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01222000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01223000
         BR    12                      OPEN NEXT CURSOR                 01224000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01225000
         BALR  4,5                     MOVE INTO RECORD AREA            01226000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01227000
         BR    14                      RETURN TO CALLER                 01228000
         LTORG                                                          01229000
*                                                                       01230000
SQL#0324 DS    0H                                                       01231000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          01232000
         B     *+6                     BRANCH AROUND ADCON              01233000
BASE0324 DC    AL2(4096)                                                01234000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01235000
         AH    3,BASE0324              ADD 4K                           01236000
         EXEC  SQL                                                     *01237000
               FETCH SALSQ003                                          *01238000
                 INTO :INST,                                           *01239000
                      :PRDCDE,                                         *01240000
                      :ACCTNBR,                                        *01241000
                      :MODEL                                            01242000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          01243000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       01244000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      01245000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     01246000
         BR    12                      OPEN NEXT CURSOR                 01247000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01248000
         BALR  4,5                     MOVE INTO RECORD AREA            01249000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01250000
         BR    14                      RETURN TO CALLER                 01251000
         LTORG                                                          01252000
*                                                                       01253000
SQL#0424 DS    0H                                                       01254000
         USING SQL#0424,12             ESTABLISH BASE REGISTER          01255000
         B     *+6                     BRANCH AROUND ADCON              01256000
BASE0424 DC    AL2(4096)                                                01257000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01258000
         AH    3,BASE0424              ADD 4K                           01259000
         EXEC  SQL                                                     *01260000
               FETCH SALSQ004                                          *01261000
                 INTO :INST,                                           *01262000
                      :PRDCDE,                                         *01263000
                      :ACCTNBR,                                        *01264000
                      :MODEL                                            01265000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   01266000
         BALR  4,5                     MOVE INTO RECORD AREA            01267000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01268000
         BR    14                      RETURN TO CALLER                 01269000
         LTORG                                                          01270000
*                                                                       01271000
*                                                                       01272000
**********************************************************************  01273000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01274000
* ALTERNATE KEY 1:                                                      01275000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01276000
*     VERBS.                                                            01277000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01278000
*     RETRIEVE THE ACTUAL ROW.                                          01279000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01280000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01281000
*     WILL BE THRU THE UPDATE CURSOR.                                   01282000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01283000
**********************************************************************  01284000
*                                                                       01285000
SQL#0025 DS    0H                                                       01286000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          01287000
         LA    15,255                  SET RETURN CODE                  01288000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01289000
         BR    14                      RETURN TO CALLER                 01290000
         LTORG                                                          01291000
*                                                                       01292000
*                                                                       01293000
**********************************************************************  01294000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01295000
* ALTERNATE KEY 2:                                                      01296000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01297000
*     VERBS.                                                            01298000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01299000
*     RETRIEVE THE ACTUAL ROW.                                          01300000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01301000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01302000
*     WILL BE THRU THE UPDATE CURSOR.                                   01303000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01304000
**********************************************************************  01305000
*                                                                       01306000
SQL#0026 DS    0H                                                       01307000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          01308000
         LA    15,255                  SET RETURN CODE                  01309000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01310000
         BR    14                      RETURN TO CALLER                 01311000
         LTORG                                                          01312000
*                                                                       01313000
*                                                                       01314000
**********************************************************************  01315000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        01316000
* ALTERNATE KEY 3:                                                      01317000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           01318000
*     VERBS.                                                            01319000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          01320000
*     RETRIEVE THE ACTUAL ROW.                                          01321000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    01322000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             01323000
*     WILL BE THRU THE UPDATE CURSOR.                                   01324000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01325000
**********************************************************************  01326000
*                                                                       01327000
SQL#0027 DS    0H                                                       01328000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          01329000
         LA    15,255                  SET RETURN CODE                  01330000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01331000
         BR    14                      RETURN TO CALLER                 01332000
         LTORG                                                          01333000
*                                                                       01334000
*                                                                       01335000
**********************************************************************  01336000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    01337000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01338000
*     AND GET-NEXT-LOCK VERBS.                                          01339000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01340000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01341000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01342000
**********************************************************************  01343000
*                                                                       01344000
SQL#0028 DS    0H                                                       01345000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          01346000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01347000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     01348000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    01349000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       01350000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      01351000
VECT0028 DC    A(SQL#0128)                                              01352000
         DC    A(SQL#0228)                                              01353000
         DC    A(SQL#0328)                                              01354000
         DC    A(SQL#0428)                                              01355000
         LTORG                                                          01356000
*                                                                       01357000
SQL#0128 DS    0H                                                       01358000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          01359000
         B     *+6                     BRANCH AROUND ADCON              01360000
BASE0128 DC    AL2(4096)                                                01361000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01362000
         AH    3,BASE0128              ADD 4K                           01363000
         EXEC  SQL                                                     *01364000
               CLOSE SALSQ001                                           01365000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01366000
         BR    14                      RETURN TO CALLER                 01367000
         LTORG                                                          01368000
*                                                                       01369000
SQL#0228 DS    0H                                                       01370000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          01371000
         B     *+6                     BRANCH AROUND ADCON              01372000
BASE0228 DC    AL2(4096)                                                01373000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01374000
         AH    3,BASE0228              ADD 4K                           01375000
         EXEC  SQL                                                     *01376000
               CLOSE SALSQ002                                           01377000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01378000
         BR    14                      RETURN TO CALLER                 01379000
         LTORG                                                          01380000
*                                                                       01381000
SQL#0328 DS    0H                                                       01382000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          01383000
         B     *+6                     BRANCH AROUND ADCON              01384000
BASE0328 DC    AL2(4096)                                                01385000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01386000
         AH    3,BASE0328              ADD 4K                           01387000
         EXEC  SQL                                                     *01388000
               CLOSE SALSQ003                                           01389000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01390000
         BR    14                      RETURN TO CALLER                 01391000
         LTORG                                                          01392000
*                                                                       01393000
SQL#0428 DS    0H                                                       01394000
         USING SQL#0428,12             ESTABLISH BASE REGISTER          01395000
         B     *+6                     BRANCH AROUND ADCON              01396000
BASE0428 DC    AL2(4096)                                                01397000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01398000
         AH    3,BASE0428              ADD 4K                           01399000
         EXEC  SQL                                                     *01400000
               CLOSE SALSQ004                                           01401000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01402000
         BR    14                      RETURN TO CALLER                 01403000
         LTORG                                                          01404000
*                                                                       01405000
*                                                                       01406000
**********************************************************************  01407000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                01408000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01409000
*     AND GET-NEXT-LOCK VERBS.                                          01410000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01411000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01412000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01413000
**********************************************************************  01414000
*                                                                       01415000
SQL#0029 DS    0H                                                       01416000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          01417000
         LA    15,255                  SET RETURN CODE                  01418000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01419000
         BR    14                      RETURN TO CALLER                 01420000
         LTORG                                                          01421000
*                                                                       01422000
*                                                                       01423000
**********************************************************************  01424000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                01425000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01426000
*     AND GET-NEXT-LOCK VERBS.                                          01427000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01428000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01429000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01430000
**********************************************************************  01431000
*                                                                       01432000
SQL#0030 DS    0H                                                       01433000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          01434000
         LA    15,255                  SET RETURN CODE                  01435000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01436000
         BR    14                      RETURN TO CALLER                 01437000
         LTORG                                                          01438000
*                                                                       01439000
*                                                                       01440000
**********************************************************************  01441000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                01442000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          01443000
*     AND GET-NEXT-LOCK VERBS.                                          01444000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      01445000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   01446000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01447000
**********************************************************************  01448000
*                                                                       01449000
SQL#0031 DS    0H                                                       01450000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          01451000
         LA    15,255                  SET RETURN CODE                  01452000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01453000
         BR    14                      RETURN TO CALLER                 01454000
         LTORG                                                          01455000
*                                                                       01456000
*                                                                       01457000
**********************************************************************  01458000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  01459000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01460000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01461000
**********************************************************************  01462000
*                                                                       01463000
SQL#0032 DS    0H                                                       01464000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          01465000
         B     *+6                     BRANCH AROUND ADCON              01466000
BASE0032 DC    AL2(4096)                                                01467000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01468000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01469000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01470000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01471000
         AH    3,BASE0032              ADD 4K                           01472000
         EXEC  SQL                                                     *01473000
               SELECT INST_NBR,                                        *01474000
                   PROD_CODE,                                          *01475000
                   ACCT_NBR,                                           *01476000
                   MODEL                                               *01477000
                 INTO :INST,                                           *01478000
                   :PRDCDE,                                            *01479000
                   :ACCTNBR,                                           *01480000
                   :MODEL                                              *01481000
                 FROM SAL                                              *01482000
                 WHERE INST_NBR = :INST AND                            *01483000
                   PROD_CODE = :PRDCDE AND                             *01484000
                   ACCT_NBR = :ACCTNBR AND                             *01485000
                   MODEL = :MODEL                                      *01486000
                 FETCH FIRST 1 ROW ONLY                                 01487000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01488000
         BR    14                      RETURN TO CALLER                 01489000
         LTORG                                                          01490000
*                                                                       01491000
*                                                                       01492000
**********************************************************************  01493000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              01494000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01495000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01496000
**********************************************************************  01497000
*                                                                       01498000
SQL#0033 DS    0H                                                       01499000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01500000
         LA    15,255                  SET RETURN CODE                  01501000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01502000
         BR    14                      RETURN TO CALLER                 01503000
         LTORG                                                          01504000
*                                                                       01505000
*                                                                       01506000
**********************************************************************  01507000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01508000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01509000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01510000
**********************************************************************  01511000
*                                                                       01512000
SQL#0034 DS    0H                                                       01513000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01514000
         LA    15,255                  SET RETURN CODE                  01515000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01516000
         BR    14                      RETURN TO CALLER                 01517000
         LTORG                                                          01518000
*                                                                       01519000
*                                                                       01520000
**********************************************************************  01521000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01522000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01523000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01524000
**********************************************************************  01525000
*                                                                       01526000
SQL#0035 DS    0H                                                       01527000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01528000
         LA    15,255                  SET RETURN CODE                  01529000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01530000
         BR    14                      RETURN TO CALLER                 01531000
         LTORG                                                          01532000
*                                                                       01533000
*                                                                       01534000
**********************************************************************  01535000
* INSERT STATEMENT:                                                     01536000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01537000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01538000
**********************************************************************  01539000
*                                                                       01540000
SQL#0036 DS    0H                                                       01541000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01542000
         B     *+6                     BRANCH AROUND ADCON              01543000
BASE0036 DC    AL2(4096)                                                01544000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01545000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01546000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01547000
         AH    3,BASE0036              ADD 4K                           01548000
         EXEC  SQL                                                     *01549000
               INSERT INTO SAL                                         *01550000
                   (INST_NBR,                                          *01551000
                    PROD_CODE,                                         *01552000
                    ACCT_NBR,                                          *01553000
                    MODEL,                                             *01554000
                    AUDIT_DATE,                                        *01555000
                    AUDIT_TIME,                                        *01556000
                    AUDIT_USER,                                        *01557000
                    AUDIT_ORG,                                         *01558000
                    GRACE_EXP_DATE,                                    *01559000
                    TRAN_DATE_01,                                      *01560000
                    TRAN_COUNT_01,                                     *01561000
                    TRAN_AMOUNT_01,                                    *01562000
                    TRAN_DATE_02,                                      *01563000
                    TRAN_COUNT_02,                                     *01564000
                    TRAN_AMOUNT_02,                                    *01565000
                    TRAN_DATE_03,                                      *01566000
                    TRAN_COUNT_03,                                     *01567000
                    TRAN_AMOUNT_03,                                    *01568000
                    TRAN_DATE_04,                                      *01569000
                    TRAN_COUNT_04,                                     *01570000
                    TRAN_AMOUNT_04,                                    *01571000
                    TRAN_DATE_05,                                      *01572000
                    TRAN_COUNT_05,                                     *01573000
                    TRAN_AMOUNT_05,                                    *01574000
                    TRAN_DATE_06,                                      *01575000
                    TRAN_COUNT_06,                                     *01576000
                    TRAN_AMOUNT_06,                                    *01577000
                    TRAN_DATE_07,                                      *01578000
                    TRAN_COUNT_07,                                     *01579000
                    TRAN_AMOUNT_07,                                    *01580000
                    TRAN_DATE_08,                                      *01581000
                    TRAN_COUNT_08,                                     *01582000
                    TRAN_AMOUNT_08,                                    *01583000
                    TRAN_DATE_09,                                      *01584000
                    TRAN_COUNT_09,                                     *01585000
                    TRAN_AMOUNT_09,                                    *01586000
                    TRAN_DATE_10,                                      *01587000
                    TRAN_COUNT_10,                                     *01588000
                    TRAN_AMOUNT_10,                                    *01589000
                    TRAN_DATE_11,                                      *01590000
                    TRAN_COUNT_11,                                     *01591000
                    TRAN_AMOUNT_11,                                    *01592000
                    TRAN_DATE_12,                                      *01593000
                    TRAN_COUNT_12,                                     *01594000
                    TRAN_AMOUNT_12,                                    *01595000
                    RSV_AREA)                                          *01596000
                  VALUES (:INST,                                       *01597000
                   :PRDCDE,                                            *01598000
                   :ACCTNBR,                                           *01599000
                   :MODEL,                                             *01600000
                   :AUDDATE,                                           *01601000
                   :AUDTIME,                                           *01602000
                   :AUDUSER,                                           *01603000
                   :AUDORG,                                            *01604000
                   :GRACEDTE,                                          *01605000
                   :TRNDTE01,                                          *01606000
                   :TRNCNT01,                                          *01607000
                   :TRNAMT01,                                          *01608000
                   :TRNDTE02,                                          *01609000
                   :TRNCNT02,                                          *01610000
                   :TRNAMT02,                                          *01611000
                   :TRNDTE03,                                          *01612000
                   :TRNCNT03,                                          *01613000
                   :TRNAMT03,                                          *01614000
                   :TRNDTE04,                                          *01615000
                   :TRNCNT04,                                          *01616000
                   :TRNAMT04,                                          *01617000
                   :TRNDTE05,                                          *01618000
                   :TRNCNT05,                                          *01619000
                   :TRNAMT05,                                          *01620000
                   :TRNDTE06,                                          *01621000
                   :TRNCNT06,                                          *01622000
                   :TRNAMT06,                                          *01623000
                   :TRNDTE07,                                          *01624000
                   :TRNCNT07,                                          *01625000
                   :TRNAMT07,                                          *01626000
                   :TRNDTE08,                                          *01627000
                   :TRNCNT08,                                          *01628000
                   :TRNAMT08,                                          *01629000
                   :TRNDTE09,                                          *01630000
                   :TRNCNT09,                                          *01631000
                   :TRNAMT09,                                          *01632000
                   :TRNDTE10,                                          *01633000
                   :TRNCNT10,                                          *01634000
                   :TRNAMT10,                                          *01635000
                   :TRNDTE11,                                          *01636000
                   :TRNCNT11,                                          *01637000
                   :TRNAMT11,                                          *01638000
                   :TRNDTE12,                                          *01639000
                   :TRNCNT12,                                          *01640000
                   :TRNAMT12,                                          *01641000
                   :RAREA)                                              01642000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01643000
         BR    14                      RETURN TO CALLER                 01644000
         LTORG                                                          01645000
*                                                                       01646000
*                                                                       01647000
**********************************************************************  01648000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01649000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01650000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01651000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01652000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01653000
*     STATEMENT.                                                        01654000
**********************************************************************  01655000
*                                                                       01656000
SQL#0037 DS    0H                                                       01657000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01658000
         B     *+6                     BRANCH AROUND ADCON              01659000
BASE0037 DC    AL2(4096)                                                01660000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01661000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01662000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01663000
         AH    3,BASE0037              ADD 4K                           01664000
         EXEC  SQL                                                     *01665000
               UPDATE SAL                                              *01666000
                   SET AUDIT_DATE = :AUDDATE,                          *01667000
                     AUDIT_TIME = :AUDTIME,                            *01668000
                     AUDIT_USER = :AUDUSER,                            *01669000
                     AUDIT_ORG = :AUDORG,                              *01670000
                     GRACE_EXP_DATE = :GRACEDTE,                       *01671000
                     TRAN_DATE_01 = :TRNDTE01,                         *01672000
                     TRAN_COUNT_01 = :TRNCNT01,                        *01673000
                     TRAN_AMOUNT_01 = :TRNAMT01,                       *01674000
                     TRAN_DATE_02 = :TRNDTE02,                         *01675000
                     TRAN_COUNT_02 = :TRNCNT02,                        *01676000
                     TRAN_AMOUNT_02 = :TRNAMT02,                       *01677000
                     TRAN_DATE_03 = :TRNDTE03,                         *01678000
                     TRAN_COUNT_03 = :TRNCNT03,                        *01679000
                     TRAN_AMOUNT_03 = :TRNAMT03,                       *01680000
                     TRAN_DATE_04 = :TRNDTE04,                         *01681000
                     TRAN_COUNT_04 = :TRNCNT04,                        *01682000
                     TRAN_AMOUNT_04 = :TRNAMT04,                       *01683000
                     TRAN_DATE_05 = :TRNDTE05,                         *01684000
                     TRAN_COUNT_05 = :TRNCNT05,                        *01685000
                     TRAN_AMOUNT_05 = :TRNAMT05,                       *01686000
                     TRAN_DATE_06 = :TRNDTE06,                         *01687000
                     TRAN_COUNT_06 = :TRNCNT06,                        *01688000
                     TRAN_AMOUNT_06 = :TRNAMT06,                       *01689000
                     TRAN_DATE_07 = :TRNDTE07,                         *01690000
                     TRAN_COUNT_07 = :TRNCNT07,                        *01691000
                     TRAN_AMOUNT_07 = :TRNAMT07,                       *01692000
                     TRAN_DATE_08 = :TRNDTE08,                         *01693000
                     TRAN_COUNT_08 = :TRNCNT08,                        *01694000
                     TRAN_AMOUNT_08 = :TRNAMT08,                       *01695000
                     TRAN_DATE_09 = :TRNDTE09,                         *01696000
                     TRAN_COUNT_09 = :TRNCNT09,                        *01697000
                     TRAN_AMOUNT_09 = :TRNAMT09,                       *01698000
                     TRAN_DATE_10 = :TRNDTE10,                         *01699000
                     TRAN_COUNT_10 = :TRNCNT10,                        *01700000
                     TRAN_AMOUNT_10 = :TRNAMT10,                       *01701000
                     TRAN_DATE_11 = :TRNDTE11,                         *01702000
                     TRAN_COUNT_11 = :TRNCNT11,                        *01703000
                     TRAN_AMOUNT_11 = :TRNAMT11,                       *01704000
                     TRAN_DATE_12 = :TRNDTE12,                         *01705000
                     TRAN_COUNT_12 = :TRNCNT12,                        *01706000
                     TRAN_AMOUNT_12 = :TRNAMT12,                       *01707000
                     RSV_AREA = :RAREA                                 *01708000
                 WHERE CURRENT OF SALUPD0                               01709000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01710000
         BR    14                      RETURN TO CALLER                 01711000
         LTORG                                                          01712000
*                                                                       01713000
*                                                                       01714000
**********************************************************************  01715000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01716000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01717000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01718000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01719000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01720000
*     STATEMENT.                                                        01721000
**********************************************************************  01722000
*                                                                       01723000
SQL#0038 DS    0H                                                       01724000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01725000
         LA    15,255                  SET RETURN CODE                  01726000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01727000
         BR    14                      RETURN TO CALLER                 01728000
         LTORG                                                          01729000
*                                                                       01730000
*                                                                       01731000
**********************************************************************  01732000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01733000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01734000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01735000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01736000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01737000
*     STATEMENT.                                                        01738000
**********************************************************************  01739000
*                                                                       01740000
SQL#0039 DS    0H                                                       01741000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01742000
         LA    15,255                  SET RETURN CODE                  01743000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01744000
         BR    14                      RETURN TO CALLER                 01745000
         LTORG                                                          01746000
*                                                                       01747000
*                                                                       01748000
**********************************************************************  01749000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01750000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01751000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01752000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01753000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01754000
*     STATEMENT.                                                        01755000
**********************************************************************  01756000
*                                                                       01757000
SQL#0040 DS    0H                                                       01758000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01759000
         LA    15,255                  SET RETURN CODE                  01760000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01761000
         BR    14                      RETURN TO CALLER                 01762000
         LTORG                                                          01763000
*                                                                       01764000
*                                                                       01765000
**********************************************************************  01766000
* DELETE STATEMENT BY PRIMARY KEY:                                      01767000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01768000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01769000
**********************************************************************  01770000
*                                                                       01771000
SQL#0041 DS    0H                                                       01772000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01773000
         B     *+6                     BRANCH AROUND ADCON              01774000
BASE0041 DC    AL2(4096)                                                01775000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01776000
         AH    3,BASE0041              ADD 4K                           01777000
         EXEC  SQL                                                     *01778000
               DELETE FROM SAL                                         *01779000
                 WHERE CURRENT OF SALUPD0                               01780000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01781000
         BR    14                      RETURN TO CALLER                 01782000
         LTORG                                                          01783000
*                                                                       01784000
*                                                                       01785000
**********************************************************************  01786000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01787000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01788000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01789000
**********************************************************************  01790000
*                                                                       01791000
SQL#0042 DS    0H                                                       01792000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01793000
         LA    15,255                  SET RETURN CODE                  01794000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01795000
         BR    14                      RETURN TO CALLER                 01796000
         LTORG                                                          01797000
*                                                                       01798000
*                                                                       01799000
**********************************************************************  01800000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01801000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01802000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01803000
**********************************************************************  01804000
*                                                                       01805000
SQL#0043 DS    0H                                                       01806000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01807000
         LA    15,255                  SET RETURN CODE                  01808000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01809000
         BR    14                      RETURN TO CALLER                 01810000
         LTORG                                                          01811000
*                                                                       01812000
*                                                                       01813000
**********************************************************************  01814000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01815000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01816000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01817000
**********************************************************************  01818000
*                                                                       01819000
SQL#0044 DS    0H                                                       01820000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01821000
         LA    15,255                  SET RETURN CODE                  01822000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01823000
         BR    14                      RETURN TO CALLER                 01824000
         LTORG                                                          01825000
*                                                                       01826000
*                                                                       01827000
**********************************************************************  01828000
* DELETE ALL STATEMENT:                                                 01829000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01830000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01831000
**********************************************************************  01832000
*                                                                       01833000
SQL#0045 DS    0H                                                       01834000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01835000
         B     *+6                     BRANCH AROUND ADCON              01836000
BASE0045 DC    AL2(4096)                                                01837000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01838000
         AH    3,BASE0045              ADD 4K                           01839000
         EXEC  SQL                                                     *01840000
               DELETE FROM SAL                                          01841000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01842000
         BR    14                      RETURN TO CALLER                 01843000
         LTORG                                                          01844000
*                                                                       01845000
*                                                                       01846000
**********************************************************************  01847000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01848000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01849000
**********************************************************************  01850000
*                                                                       01851000
SQL#0046 DS    0H                                                       01852000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01853000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01854000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01855000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01856000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01857000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01858000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01859000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01860000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01861000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01862000
VECT0046 DC    A(0)                                                     01863000
         DC    A(SQL#0246)                                              01864000
         DC    A(SQL#0346)                                              01865000
         DC    A(SQL#0446)                                              01866000
         LTORG                                                          01867000
*                                                                       01868000
SQL#0246 DS    0H                                                       01869000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01870000
         B     *+6                     BRANCH AROUND ADCON              01871000
BASE0246 DC    AL2(4096)                                                01872000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01873000
         AH    3,BASE0246              ADD 4K                           01874000
         EXEC  SQL                                                     *01875000
               CLOSE SALSQ001                                           01876000
         EXEC  SQL                                                     *01877000
               DECLARE SALSQ002 CURSOR FOR                             *01878000
               SELECT INST_NBR,                                        *01879000
                   PROD_CODE,                                          *01880000
                   ACCT_NBR,                                           *01881000
                   MODEL,                                              *01882000
                   AUDIT_DATE,                                         *01883000
                   AUDIT_TIME,                                         *01884000
                   AUDIT_USER,                                         *01885000
                   AUDIT_ORG,                                          *01886000
                   GRACE_EXP_DATE,                                     *01887000
                   TRAN_DATE_01,                                       *01888000
                   TRAN_COUNT_01,                                      *01889000
                   TRAN_AMOUNT_01,                                     *01890000
                   TRAN_DATE_02,                                       *01891000
                   TRAN_COUNT_02,                                      *01892000
                   TRAN_AMOUNT_02,                                     *01893000
                   TRAN_DATE_03,                                       *01894000
                   TRAN_COUNT_03,                                      *01895000
                   TRAN_AMOUNT_03,                                     *01896000
                   TRAN_DATE_04,                                       *01897000
                   TRAN_COUNT_04,                                      *01898000
                   TRAN_AMOUNT_04,                                     *01899000
                   TRAN_DATE_05,                                       *01900000
                   TRAN_COUNT_05,                                      *01901000
                   TRAN_AMOUNT_05,                                     *01902000
                   TRAN_DATE_06,                                       *01903000
                   TRAN_COUNT_06,                                      *01904000
                   TRAN_AMOUNT_06,                                     *01905000
                   TRAN_DATE_07,                                       *01906000
                   TRAN_COUNT_07,                                      *01907000
                   TRAN_AMOUNT_07,                                     *01908000
                   TRAN_DATE_08,                                       *01909000
                   TRAN_COUNT_08,                                      *01910000
                   TRAN_AMOUNT_08,                                     *01911000
                   TRAN_DATE_09,                                       *01912000
                   TRAN_COUNT_09,                                      *01913000
                   TRAN_AMOUNT_09,                                     *01914000
                   TRAN_DATE_10,                                       *01915000
                   TRAN_COUNT_10,                                      *01916000
                   TRAN_AMOUNT_10,                                     *01917000
                   TRAN_DATE_11,                                       *01918000
                   TRAN_COUNT_11,                                      *01919000
                   TRAN_AMOUNT_11,                                     *01920000
                   TRAN_DATE_12,                                       *01921000
                   TRAN_COUNT_12,                                      *01922000
                   TRAN_AMOUNT_12,                                     *01923000
                   RSV_AREA                                            *01924000
                 FROM SAL                                              *01925000
                 WHERE                                                 *01926000
                    INST_NBR = :INST AND                               *01927000
                    PROD_CODE = :PRDCDE AND                            *01928000
                    ACCT_NBR > :ACCTNBR                                *01929000
                 ORDER BY ACCT_NBR,                                    *01930000
                   MODEL                                               *01931000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01932000
         EXEC  SQL                                                     *01933000
               OPEN SALSQ002                                            01934000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01935000
         BNZ   *+8                     NO - RETURN ERROR                01936000
         LR    12,9                    LOAD RETURN ADDRESS              01937000
         BR    12                      RETURN TO FETCH ROUTINE          01938000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01939000
         BR    14                      RETURN TO CALLER                 01940000
         LTORG                                                          01941000
*                                                                       01942000
SQL#0346 DS    0H                                                       01943000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01944000
         B     *+6                     BRANCH AROUND ADCON              01945000
BASE0346 DC    AL2(4096)                                                01946000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    01947000
         AH    3,BASE0346              ADD 4K                           01948000
         EXEC  SQL                                                     *01949000
               CLOSE SALSQ002                                           01950000
         EXEC  SQL                                                     *01951000
               DECLARE SALSQ003 CURSOR FOR                             *01952000
               SELECT INST_NBR,                                        *01953000
                   PROD_CODE,                                          *01954000
                   ACCT_NBR,                                           *01955000
                   MODEL,                                              *01956000
                   AUDIT_DATE,                                         *01957000
                   AUDIT_TIME,                                         *01958000
                   AUDIT_USER,                                         *01959000
                   AUDIT_ORG,                                          *01960000
                   GRACE_EXP_DATE,                                     *01961000
                   TRAN_DATE_01,                                       *01962000
                   TRAN_COUNT_01,                                      *01963000
                   TRAN_AMOUNT_01,                                     *01964000
                   TRAN_DATE_02,                                       *01965000
                   TRAN_COUNT_02,                                      *01966000
                   TRAN_AMOUNT_02,                                     *01967000
                   TRAN_DATE_03,                                       *01968000
                   TRAN_COUNT_03,                                      *01969000
                   TRAN_AMOUNT_03,                                     *01970000
                   TRAN_DATE_04,                                       *01971000
                   TRAN_COUNT_04,                                      *01972000
                   TRAN_AMOUNT_04,                                     *01973000
                   TRAN_DATE_05,                                       *01974000
                   TRAN_COUNT_05,                                      *01975000
                   TRAN_AMOUNT_05,                                     *01976000
                   TRAN_DATE_06,                                       *01977000
                   TRAN_COUNT_06,                                      *01978000
                   TRAN_AMOUNT_06,                                     *01979000
                   TRAN_DATE_07,                                       *01980000
                   TRAN_COUNT_07,                                      *01981000
                   TRAN_AMOUNT_07,                                     *01982000
                   TRAN_DATE_08,                                       *01983000
                   TRAN_COUNT_08,                                      *01984000
                   TRAN_AMOUNT_08,                                     *01985000
                   TRAN_DATE_09,                                       *01986000
                   TRAN_COUNT_09,                                      *01987000
                   TRAN_AMOUNT_09,                                     *01988000
                   TRAN_DATE_10,                                       *01989000
                   TRAN_COUNT_10,                                      *01990000
                   TRAN_AMOUNT_10,                                     *01991000
                   TRAN_DATE_11,                                       *01992000
                   TRAN_COUNT_11,                                      *01993000
                   TRAN_AMOUNT_11,                                     *01994000
                   TRAN_DATE_12,                                       *01995000
                   TRAN_COUNT_12,                                      *01996000
                   TRAN_AMOUNT_12,                                     *01997000
                   RSV_AREA                                            *01998000
                 FROM SAL                                              *01999000
                 WHERE                                                 *02000000
                    INST_NBR = :INST AND                               *02001000
                    PROD_CODE > :PRDCDE                                *02002000
                 ORDER BY PROD_CODE,                                   *02003000
                   ACCT_NBR,                                           *02004000
                   MODEL                                               *02005000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02006000
         EXEC  SQL                                                     *02007000
               OPEN SALSQ003                                            02008000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02009000
         BNZ   *+8                     NO - RETURN ERROR                02010000
         LR    12,9                    LOAD RETURN ADDRESS              02011000
         BR    12                      RETURN TO FETCH ROUTINE          02012000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02013000
         BR    14                      RETURN TO CALLER                 02014000
         LTORG                                                          02015000
*                                                                       02016000
SQL#0446 DS    0H                                                       02017000
         USING SQL#0446,12             ESTABLISH BASE REGISTER          02018000
         B     *+6                     BRANCH AROUND ADCON              02019000
BASE0446 DC    AL2(4096)                                                02020000
         LR    3,10                    LOAD SECOND BASE FOR SQLDSECT    02021000
         AH    3,BASE0446              ADD 4K                           02022000
         EXEC  SQL                                                     *02023000
               CLOSE SALSQ003                                           02024000
         EXEC  SQL                                                     *02025000
               DECLARE SALSQ004 CURSOR FOR                             *02026000
               SELECT INST_NBR,                                        *02027000
                   PROD_CODE,                                          *02028000
                   ACCT_NBR,                                           *02029000
                   MODEL,                                              *02030000
                   AUDIT_DATE,                                         *02031000
                   AUDIT_TIME,                                         *02032000
                   AUDIT_USER,                                         *02033000
                   AUDIT_ORG,                                          *02034000
                   GRACE_EXP_DATE,                                     *02035000
                   TRAN_DATE_01,                                       *02036000
                   TRAN_COUNT_01,                                      *02037000
                   TRAN_AMOUNT_01,                                     *02038000
                   TRAN_DATE_02,                                       *02039000
                   TRAN_COUNT_02,                                      *02040000
                   TRAN_AMOUNT_02,                                     *02041000
                   TRAN_DATE_03,                                       *02042000
                   TRAN_COUNT_03,                                      *02043000
                   TRAN_AMOUNT_03,                                     *02044000
                   TRAN_DATE_04,                                       *02045000
                   TRAN_COUNT_04,                                      *02046000
                   TRAN_AMOUNT_04,                                     *02047000
                   TRAN_DATE_05,                                       *02048000
                   TRAN_COUNT_05,                                      *02049000
                   TRAN_AMOUNT_05,                                     *02050000
                   TRAN_DATE_06,                                       *02051000
                   TRAN_COUNT_06,                                      *02052000
                   TRAN_AMOUNT_06,                                     *02053000
                   TRAN_DATE_07,                                       *02054000
                   TRAN_COUNT_07,                                      *02055000
                   TRAN_AMOUNT_07,                                     *02056000
                   TRAN_DATE_08,                                       *02057000
                   TRAN_COUNT_08,                                      *02058000
                   TRAN_AMOUNT_08,                                     *02059000
                   TRAN_DATE_09,                                       *02060000
                   TRAN_COUNT_09,                                      *02061000
                   TRAN_AMOUNT_09,                                     *02062000
                   TRAN_DATE_10,                                       *02063000
                   TRAN_COUNT_10,                                      *02064000
                   TRAN_AMOUNT_10,                                     *02065000
                   TRAN_DATE_11,                                       *02066000
                   TRAN_COUNT_11,                                      *02067000
                   TRAN_AMOUNT_11,                                     *02068000
                   TRAN_DATE_12,                                       *02069000
                   TRAN_COUNT_12,                                      *02070000
                   TRAN_AMOUNT_12,                                     *02071000
                   RSV_AREA                                            *02072000
                 FROM SAL                                              *02073000
                 WHERE                                                 *02074000
                    INST_NBR > :INST                                   *02075000
                 ORDER BY INST_NBR,                                    *02076000
                   PROD_CODE,                                          *02077000
                   ACCT_NBR,                                           *02078000
                   MODEL                                               *02079000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       02080000
         EXEC  SQL                                                     *02081000
               OPEN SALSQ004                                            02082000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            02083000
         BNZ   *+8                     NO - RETURN ERROR                02084000
         LR    12,9                    LOAD RETURN ADDRESS              02085000
         BR    12                      RETURN TO FETCH ROUTINE          02086000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02087000
         BR    14                      RETURN TO CALLER                 02088000
         LTORG                                                          02089000
*                                                                       02090000
*                                                                       02091000
**********************************************************************  02092000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      02093000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            02094000
**********************************************************************  02095000
*                                                                       02096000
SQL#0047 DS    0H                                                       02097000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          02098000
         LA    15,255                  SET RETURN CODE                  02099000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02100000
         BR    14                      RETURN TO CALLER                 02101000
         LTORG                                                          02102000
*                                                                       02103000
*                                                                       02104000
**********************************************************************  02105000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      02106000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            02107000
**********************************************************************  02108000
*                                                                       02109000
SQL#0048 DS    0H                                                       02110000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          02111000
         LA    15,255                  SET RETURN CODE                  02112000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02113000
         BR    14                      RETURN TO CALLER                 02114000
         LTORG                                                          02115000
*                                                                       02116000
*                                                                       02117000
**********************************************************************  02118000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      02119000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            02120000
**********************************************************************  02121000
*                                                                       02122000
SQL#0049 DS    0H                                                       02123000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          02124000
         LA    15,255                  SET RETURN CODE                  02125000
         L     14,SQW@RET              LOAD RETURN ADDRESS              02126000
         BR    14                      RETURN TO CALLER                 02127000
         LTORG                                                          02128000
*                                                                       02129000
         DS    0H                      END OF SQL STATEMENTS            02130000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   02131000
*                                                                       02132000
*                                                                       02133000
**********************************************************************  02134000
* DUMMY ENTRY POINT DSNHLI                                              02135000
*   MUST NOT BE MODIFIED.                                               02136000
**********************************************************************  02137000
*                                                                       02138000
         ENTRY DSNHLI                                                   02139000
DSNHLI   DS    0H                                                       02140000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       02141000
         BR    15                      BRANCH TO ATTACH FACILITY        02142000
*                                                                       02143000
*                                                                       02144000
**********************************************************************  02145000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          02146000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              02147000
*   MUST NOT BE MODIFIED.                                               02148000
**********************************************************************  02149000
*                                                                       02150000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      02151000
CONV#RTN AMODE ANY                                                      02152000
CONV#RTN RMODE ANY                                                      02153000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         02154000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          02155000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02156000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    02157000
         BER   4                         YES - RETURN TO SQL            02158000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02159000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02160000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02161000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02162000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02163000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02164000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02165000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02166000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          02167000
*                                                                       02168000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    02169000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          02170000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02171000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    02172000
         BER   4                         YES - RETURN TO SQL            02173000
         SLR   0,0                     CLEAR FOR INSERT                 02174000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           02175000
         NR    0,3                     FOR THE CURRENT KEY?             02176000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         02177000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02178000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02179000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02180000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02181000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02182000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02183000
         MVCL  14,0                    MOVE TO HOST VARIABLES           02184000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            02185000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         02186000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           02187000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 02188000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02189000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 02190000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        02191000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            02192000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02193000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          02194000
*                                                                       02195000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  02196000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          02197000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02198000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    02199000
         BER   4                         YES - RETURN TO SQL            02200000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02201000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02202000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02203000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02204000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02205000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02206000
         MVCL  0,14                    MOVE TO RECORD AREA              02207000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02208000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          02209000
*                                                                       02210000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            02211000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          02212000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    02213000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    02214000
         BER   4                         YES - RETURN TO SQL            02215000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             02216000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         02217000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         02218000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    02219000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  02220000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 02221000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              02222000
         LR    15,1                    SET BOTH LENGTHS EQUAL           02223000
         MVCL  0,14                    MOVE TO RECORD AREA              02224000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          02225000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          02226000
*                                                                       02227000
*                                                                       02228000
**********************************************************************  02229000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  02230000
*   MUST NOT BE MODIFIED.                                               02231000
**********************************************************************  02232000
*                                                                       02233000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         02234000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        02235000
         DC    H'0038'                 LENGTH TO MOVE                   02236000
         DC    X'80'                   80 = KEY 0 FIELD                 02237000
*                                      40 = KEY 1 FIELD                 02238000
*                                      20 = KEY 2 FIELD                 02239000
*                                      10 = KEY 3 FIELD                 02240000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        02241000
*                                                                       02242000
*                                      REST OF FIELD ENTRIES            02243000
         DC    H'0038',H'0038',H'0259',X'00',X'00'                      02244000
         DC    8X'FF'                  END OF FIELD ENTRIES             02245000
         LTORG                                                          02246000
         END                                                            02247000
