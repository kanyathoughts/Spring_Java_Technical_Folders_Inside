* REL=SACIODB.10                                                        00001000
**********************************************************************  00002000
*                                                                       00003000
*  SACIODB .... STATIC SQL I/O MODULE                                   00004000
*                                                                       00005000
*  CREATION DATE: 04/25/16                                              00006000
*                                                                       00007000
*  FUNCTIONAL DESCRIPTION: THIS PROGRAM CONTAINS THE STATIC SQL         00008000
*  VECTORS REQUIRED TO SUPPORT I/O TO THE SAC FILE.  IT IS LOADED       00009000
*  BY THE DB2 I/O MANAGER (BIPDB2X).  THIS PROGRAM WILL BE USED         00010000
*  IN BOTH A CICS AND BATCH ENVIRONMENT AND MUST BE RE-ENTRANT          00011000
*  AND VOID OF SVC CALLS.                                               00012000
*     ***************************************************************   00013000
*     *                                                             *   00013001
*     *                           NOTICE                            *   00013002
*     *                                                             *   00013003
*     *   THIS SOFTWARE IS THE PROPERTY OF AND CONTAINS             *   00013004
*     *   CONFIDENTIAL INFORMATION OF INFOR AND/OR ITS AFFILIATES   *   00013005
*     *   OR SUBSIDIARIES AND SHALL NOT BE DISCLOSED WITHOUT PRIOR  *   00013006
*     *   WRITTEN PERMISSION. LICENSED CUSTOMERS MAY COPY AND       *   00013007
*     *   ADAPT THIS SOFTWARE FOR THEIR OWN USE IN ACCORDANCE WITH  *   00013008
*     *   THE TERMS OF THEIR SOFTWARE LICENSE AGREEMENT.            *   00013009
*     *   ALL OTHER RIGHTS RESERVED.                                *   00013010
*     *                                                             *   00013011
*     *   (C) COPYRIGHT 2017 INFOR.  ALL RIGHTS RESERVED.           *   00013012
*     *   THE WORD AND DESIGN MARKS SET FORTH HEREIN ARE            *   00013013
*     *   TRADEMARKS AND/OR REGISTERED TRADEMARKS OF INFOR          *   00013014
*     *   AND/OR ITS AFFILIATES AND SUBSIDIARIES. ALL RIGHTS        *   00013015
*     *   RESERVED.  ALL OTHER TRADEMARKS LISTED HEREIN ARE         *   00013016
*     *   THE PROPERTY OF THEIR RESPECTIVE OWNERS.                  *   00013017
*     *                                                             *   00013018
*     ***************************************************************   00013019
*     *     Infopoint Relationship Pricing                          *   00013020
*     *     RP 5.0.01                                               *   00013021
*     ***************************************************************   00013022
**********************************************************************  00014000
* SQI COMMUNICATION AREA DSECT ADDRESSED BY REGISTER 11                 00015000
*   MUST NOT BE MODIFIED.                                               00016000
**********************************************************************  00017000
*                                                                       00018000
COM#AREA DSECT                         SQI COMMUNICATION AREA           00019000
SQW@CAF  DS    F                       ADDRESS OF ATTACH FACILITY       00020000
SQW@RET  DS    F                       RETURN ADDRESS TO SQI            00021000
SQWSQLCA DS    XL136                   GLOBAL SQLCA                     00022000
         ORG   SQWSQLCA                                                 00023000
         EXEC  SQL INCLUDE SQLCA                                        00024000
*                                                                       00025000
*                                                                       00026000
**********************************************************************  00027000
* HOST VARIABLE AREA DSECT ADDRESSED BY REGISTER 2                      00028000
*   MUST NOT BE MODIFIED.                                               00029000
**********************************************************************  00030000
*                                                                       00031000
HOST#VAR DSECT                         PROGRAM HOST VARIABLES           00032000
CSRPTR   DS    H                       CURSOR ROUTINE POINTER           00033000
         DS    CL6                     RESERVED                         00034000
ORG      DS    CL6                     RECORD ORG CODE                  00035000
COBREC   DS    CL110                   COBOL RECORD (UNALIGNED)         00036000
ASMREC   DS    0F                      ASSEMBLER RECORD (ALIGNED)       00037000
INST     DS    CL4                                                      00038000
PRDCDE   DS    CL6                                                      00039000
IDNBR    DS    CL18                                                     00040000
AUDDATE  DS    PL5'0.'                                                  00041000
AUDTIME  DS    PL5'0.'                                                  00042000
AUDUSER  DS    CL8                                                      00043000
AUDORG   DS    CL6                                                      00044000
INST2    DS    CL4                                                      00045000
PRODCDE  DS    CL6                                                      00046000
ACCT2    DS    CL18                                                     00047000
MODEL2   DS    CL10                                                     00048000
RCIFSTAT DS    CL1                                                      00049000
RAREA    DS    CL19                                                     00050000
*                                                                       00051000
*                                                                       00052000
**********************************************************************  00053000
* PROGRAM TABLE HEADER SECTION:                                         00054000
*   THIS SECTION CONTAINS STATIC DESCRIPTIVE FIELDS.                    00055000
*   THE CONTENTS OF THIS SECTION SHOULD NOT BE MODIFIED.                00056000
**********************************************************************  00057000
*                                                                       00058000
SACIODB  CSECT                         PROGRAM TABLE SECTION            00059000
SACIODB  AMODE ANY                                                      00060000
SACIODB  RMODE ANY                                                      00061000
         DC    CL9'SACIODB'            PROGRAM ID                       00062000
         DC    CL8'&SYSDATE',CL1' ',CL5'&SYSTIME',CL1' '                00063000
         DC    A(SQLDLEN)              SQLDSECT SIZE                    00064000
         DC    A(0)                    RESERVED                         00065000
         DC    A(0)                    RESERVED                         00066000
         DC    24CL1' '                RESERVED                         00067000
         DC    A(STM#TAB)              STATEMENT TABLE ADDRESS          00068000
*                                                                       00069000
         DC    CL43'COPYRIGHT 2017 INFOR. ALL RIGHTS RESERVED. '        00070000
         DC    CL29'WWW.INFOR.COM                '                      00070001
*                                                                       00071000
*                                                                       00072000
**********************************************************************  00073000
* STATEMENT TABLE SECTION:                                              00074000
*   THIS SECTION DEFINES AN ENTRY VECTOR FOR EACH SQL STATEMENT.        00075000
*   THE CONTENTS AND ORDER OF THE STATEMENTS IN THIS SECTION            00076000
*   SHOULD NOT BE MODIFIED.                                             00077000
**********************************************************************  00078000
*                                                                       00079000
STM#TAB  CSECT                         STATEMENT TABLE SECTION          00080000
STM#TAB  AMODE ANY                                                      00081000
STM#TAB  RMODE ANY                                                      00082000
         DC    A(SQL#0000)             SELECT INTO (KEY 0)              00083000
         DC    A(SQL#0001)             SELECT INTO (KEY 1)              00084000
         DC    A(SQL#0002)             SELECT INTO (KEY 2)              00085000
         DC    A(SQL#0003)             SELECT INTO (KEY 3)              00086000
         DC    A(SQL#0004)             SELECT UPDATE CURSOR (KEY 0)     00087000
         DC    A(SQL#0005)             SELECT UPDATE CURSOR (KEY 1)     00088000
         DC    A(SQL#0006)             SELECT UPDATE CURSOR (KEY 2)     00089000
         DC    A(SQL#0007)             SELECT UPDATE CURSOR (KEY 3)     00090000
         DC    A(SQL#0008)             FETCH UPDATE CURSOR (KEY 0)      00091000
         DC    A(SQL#0009)             FETCH UPDATE CURSOR (KEY 1)      00092000
         DC    A(SQL#0010)             FETCH UPDATE CURSOR (KEY 2)      00093000
         DC    A(SQL#0011)             FETCH UPDATE CURSOR (KEY 3)      00094000
         DC    A(SQL#0012)             CLOSE UPDATE CURSOR (KEY 0)      00095000
         DC    A(SQL#0013)             CLOSE UPDATE CURSOR (KEY 1)      00096000
         DC    A(SQL#0014)             CLOSE UPDATE CURSOR (KEY 2)      00097000
         DC    A(SQL#0015)             CLOSE UPDATE CURSOR (KEY 3)      00098000
         DC    A(SQL#0016)             SELECT SEQ CURSOR (KEY 0)        00099000
         DC    A(SQL#0017)             SELECT SEQ CURSOR (KEY 1)        00100000
         DC    A(SQL#0018)             SELECT SEQ CURSOR (KEY 2)        00101000
         DC    A(SQL#0019)             SELECT SEQ CURSOR (KEY 3)        00102000
         DC    A(SQL#0020)             FETCH SEQ CURSOR (KEY 0)         00103000
         DC    A(SQL#0021)             FETCH SEQ CURSOR (KEY 1)         00104000
         DC    A(SQL#0022)             FETCH SEQ CURSOR (KEY 2)         00105000
         DC    A(SQL#0023)             FETCH SEQ CURSOR (KEY 3)         00106000
         DC    A(SQL#0024)             FETCH SEQ CURSOR UPDATE (KEY 0)  00107000
         DC    A(SQL#0025)             FETCH SEQ CURSOR UPDATE (KEY 1)  00108000
         DC    A(SQL#0026)             FETCH SEQ CURSOR UPDATE (KEY 2)  00109000
         DC    A(SQL#0027)             FETCH SEQ CURSOR UPDATE (KEY 3)  00110000
         DC    A(SQL#0028)             CLOSE SEQ CURSOR (KEY 0)         00111000
         DC    A(SQL#0029)             CLOSE SEQ CURSOR (KEY 1)         00112000
         DC    A(SQL#0030)             CLOSE SEQ CURSOR (KEY 2)         00113000
         DC    A(SQL#0031)             CLOSE SEQ CURSOR (KEY 3)         00114000
         DC    A(SQL#0032)             SELECT KEY (KEY 0)               00115000
         DC    A(SQL#0033)             SELECT KEY (KEY 1)               00116000
         DC    A(SQL#0034)             SELECT KEY (KEY 2)               00117000
         DC    A(SQL#0035)             SELECT KEY (KEY 3)               00118000
         DC    A(SQL#0036)             INSERT STATEMENT                 00119000
         DC    A(SQL#0037)             UPDATE STATEMENT (KEY 0)         00120000
         DC    A(SQL#0038)             UPDATE STATEMENT (KEY 1)         00121000
         DC    A(SQL#0039)             UPDATE STATEMENT (KEY 2)         00122000
         DC    A(SQL#0040)             UPDATE STATEMENT (KEY 3)         00123000
         DC    A(SQL#0041)             DELETE STATEMENT (KEY 0)         00124000
         DC    A(SQL#0042)             DELETE STATEMENT (KEY 1)         00125000
         DC    A(SQL#0043)             DELETE STATEMENT (KEY 2)         00126000
         DC    A(SQL#0044)             DELETE STATEMENT (KEY 3)         00127000
         DC    A(SQL#0045)             DELETE ALL STATEMENT             00128000
         DC    4X'FF'                                                   00129000
*                                                                       00130000
*                                                                       00131000
**********************************************************************  00132000
* SQL STATEMENT SECTION:                                                00133000
*   THIS SECTION CONTAINS ALL THE STATIC SQL STATEMENTS REQUIRED        00134000
*     TO SUPPORT THIS TABLE.                                            00135000
*   THE INDICATED STATEMENTS MAY BE MODIFIED, AS LONG AS THE RESULTS    00136000
*     ARE EQUIVALENT.                                                   00137000
**********************************************************************  00138000
*                                                                       00139000
SQL#STMT CSECT                         SQL STATEMENT SECTION            00140000
SQL#STMT AMODE ANY                                                      00141000
SQL#STMT RMODE ANY                                                      00142000
         USING HOST#VAR,2              ADDRESS HOST VARIABLES           00143000
         USING SQLDSECT,10             ADDRESS SQLDSECT                 00144000
         USING COM#AREA,11             ADDRESS COMMAREA                 00145000
*                                                                       00146000
*                                                                       00147000
**********************************************************************  00148000
* SELECT INTO STATEMENT BY PRIMARY KEY:                                 00149000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00150000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00151000
**********************************************************************  00152000
*                                                                       00153000
SQL#0000 DS    0H                                                       00154000
         USING SQL#0000,12             ESTABLISH BASE REGISTER          00155000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00156000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00157000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00158000
         EXEC  SQL                                                     *00159000
               SELECT AUDIT_DATE,                                      *00160000
                   AUDIT_TIME,                                         *00161000
                   AUDIT_USER,                                         *00162000
                   AUDIT_ORG,                                          *00163000
                   INST_NBR_2,                                         *00164000
                   PROD_CODE_2,                                        *00165000
                   ACCT_NBR_2,                                         *00166000
                   MODEL_2,                                            *00167000
                   RCIF_STATUS,                                        *00168000
                   RSV_AREA                                            *00169000
                 INTO :AUDDATE,                                        *00170000
                   :AUDTIME,                                           *00171000
                   :AUDUSER,                                           *00172000
                   :AUDORG,                                            *00173000
                   :INST2,                                             *00174000
                   :PRODCDE,                                           *00175000
                   :ACCT2,                                             *00176000
                   :MODEL2,                                            *00177000
                   :RCIFSTAT,                                          *00178000
                   :RAREA                                              *00179000
                 FROM SAC                                              *00180000
                 WHERE INST_NBR = :INST AND                            *00181000
                   PROD_CODE = :PRDCDE AND                             *00182000
                   IDENT_NBR = :IDNBR                                  *00183000
                 FETCH FIRST 1 ROW ONLY                                 00184000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00185000
         BALR  4,5                     MOVE INTO RECORD AREA            00186000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00187000
         BR    14                      RETURN TO CALLER                 00188000
         LTORG                                                          00189000
*                                                                       00190000
*                                                                       00191000
**********************************************************************  00192000
* SELECT INTO STATEMENT BY ALTERNATE KEY 1:                             00193000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00194000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00195000
**********************************************************************  00196000
*                                                                       00197000
SQL#0001 DS    0H                                                       00198000
         USING SQL#0001,12             ESTABLISH BASE REGISTER          00199000
         LA    15,255                  SET RETURN CODE                  00200000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00201000
         BR    14                      RETURN TO CALLER                 00202000
         LTORG                                                          00203000
*                                                                       00204000
*                                                                       00205000
**********************************************************************  00206000
* SELECT INTO STATEMENT BY ALTERNATE KEY 2:                             00207000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00208000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00209000
**********************************************************************  00210000
*                                                                       00211000
SQL#0002 DS    0H                                                       00212000
         USING SQL#0002,12             ESTABLISH BASE REGISTER          00213000
         LA    15,255                  SET RETURN CODE                  00214000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00215000
         BR    14                      RETURN TO CALLER                 00216000
         LTORG                                                          00217000
*                                                                       00218000
*                                                                       00219000
**********************************************************************  00220000
* SELECT INTO STATEMENT BY ALTERNATE KEY 3:                             00221000
*   THIS STATEMENT SUPPORTS THE GET (WITHOUT LOCK) VERB.                00222000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00223000
**********************************************************************  00224000
*                                                                       00225000
SQL#0003 DS    0H                                                       00226000
         USING SQL#0003,12             ESTABLISH BASE REGISTER          00227000
         LA    15,255                  SET RETURN CODE                  00228000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00229000
         BR    14                      RETURN TO CALLER                 00230000
         LTORG                                                          00231000
*                                                                       00232000
*                                                                       00233000
**********************************************************************  00234000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY PRIMARY KEY:       00235000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00236000
*   THEY ARE ALSO USED AFTER A SUCCESSFUL SELECT SEQUENTIAL STATEMENT   00237000
*     FOR THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS.                      00238000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00239000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00240000
*     UPDATE STATEMENT TO MATCH.                                        00241000
**********************************************************************  00242000
*                                                                       00243000
SQL#0004 DS    0H                                                       00244000
         USING SQL#0004,12             ESTABLISH BASE REGISTER          00245000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00246000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00247000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00248000
         EXEC  SQL                                                     *00249000
               DECLARE SACUPD0 CURSOR FOR                              *00250000
               SELECT AUDIT_DATE,                                      *00251000
                   AUDIT_TIME,                                         *00252000
                   AUDIT_USER,                                         *00253000
                   AUDIT_ORG,                                          *00254000
                   INST_NBR_2,                                         *00255000
                   PROD_CODE_2,                                        *00256000
                   ACCT_NBR_2,                                         *00257000
                   MODEL_2,                                            *00258000
                   RCIF_STATUS,                                        *00259000
                   RSV_AREA                                            *00260000
                 FROM SAC                                              *00261000
                 WHERE INST_NBR = :INST AND                            *00262000
                   PROD_CODE = :PRDCDE AND                             *00263000
                   IDENT_NBR = :IDNBR                                  *00264000
                 FOR UPDATE OF AUDIT_DATE,                             *00265000
                   AUDIT_TIME,                                         *00266000
                   AUDIT_USER,                                         *00267000
                   AUDIT_ORG,                                          *00268000
                   INST_NBR_2,                                         *00269000
                   PROD_CODE_2,                                        *00270000
                   ACCT_NBR_2,                                         *00271000
                   MODEL_2,                                            *00272000
                   RCIF_STATUS,                                        *00273000
                   RSV_AREA                                            *00274000
                 FETCH FIRST 1 ROW ONLY                                 00275000
         EXEC  SQL                                                     *00276000
               OPEN SACUPD0                                             00277000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00278000
         BR    14                      RETURN TO CALLER                 00279000
         LTORG                                                          00280000
*                                                                       00281000
*                                                                       00282000
**********************************************************************  00283000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 1:   00284000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00285000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00286000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00287000
*     UPDATE STATEMENT TO MATCH.                                        00288000
**********************************************************************  00289000
*                                                                       00290000
SQL#0005 DS    0H                                                       00291000
         USING SQL#0005,12             ESTABLISH BASE REGISTER          00292000
         LA    15,255                  SET RETURN CODE                  00293000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00294000
         BR    14                      RETURN TO CALLER                 00295000
         LTORG                                                          00296000
*                                                                       00297000
*                                                                       00298000
**********************************************************************  00299000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 2:   00300000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00301000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00302000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00303000
*     UPDATE STATEMENT TO MATCH.                                        00304000
**********************************************************************  00305000
*                                                                       00306000
SQL#0006 DS    0H                                                       00307000
         USING SQL#0006,12             ESTABLISH BASE REGISTER          00308000
         LA    15,255                  SET RETURN CODE                  00309000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00310000
         BR    14                      RETURN TO CALLER                 00311000
         LTORG                                                          00312000
*                                                                       00313000
*                                                                       00314000
**********************************************************************  00315000
* SELECT UPDATE AND OPEN UPDATE CURSOR STATEMENTS BY ALTERNATE KEY 3:   00316000
*   THESE STATEMENTS SUPPORT THE GET-LOCK VERB.                         00317000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00318000
*     COLUMNS REFERENCED AS UPDATEABLE, AND THEN MODIFYING THE          00319000
*     UPDATE STATEMENT TO MATCH.                                        00320000
**********************************************************************  00321000
*                                                                       00322000
SQL#0007 DS    0H                                                       00323000
         USING SQL#0007,12             ESTABLISH BASE REGISTER          00324000
         LA    15,255                  SET RETURN CODE                  00325000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00326000
         BR    14                      RETURN TO CALLER                 00327000
         LTORG                                                          00328000
*                                                                       00329000
*                                                                       00330000
**********************************************************************  00331000
* FETCH FROM UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                   00332000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00333000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00334000
*     THE ACTUAL ROW.                                                   00335000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00336000
**********************************************************************  00337000
*                                                                       00338000
SQL#0008 DS    0H                                                       00339000
         USING SQL#0008,12             ESTABLISH BASE REGISTER          00340000
         EXEC  SQL                                                     *00341000
               FETCH SACUPD0                                           *00342000
                 INTO :AUDDATE,                                        *00343000
                   :AUDTIME,                                           *00344000
                   :AUDUSER,                                           *00345000
                   :AUDORG,                                            *00346000
                   :INST2,                                             *00347000
                   :PRODCDE,                                           *00348000
                   :ACCT2,                                             *00349000
                   :MODEL2,                                            *00350000
                   :RCIFSTAT,                                          *00351000
                   :RAREA                                               00352000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00353000
         BALR  4,5                     MOVE INTO RECORD AREA            00354000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00355000
         BR    14                      RETURN TO CALLER                 00356000
         LTORG                                                          00357000
*                                                                       00358000
*                                                                       00359000
**********************************************************************  00360000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:               00361000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00362000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00363000
*     THE ACTUAL ROW.                                                   00364000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00365000
**********************************************************************  00366000
*                                                                       00367000
SQL#0009 DS    0H                                                       00368000
         USING SQL#0009,12             ESTABLISH BASE REGISTER          00369000
         LA    15,255                  SET RETURN CODE                  00370000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00371000
         BR    14                      RETURN TO CALLER                 00372000
         LTORG                                                          00373000
*                                                                       00374000
*                                                                       00375000
**********************************************************************  00376000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:               00377000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00378000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00379000
*     THE ACTUAL ROW.                                                   00380000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00381000
**********************************************************************  00382000
*                                                                       00383000
SQL#0010 DS    0H                                                       00384000
         USING SQL#0010,12             ESTABLISH BASE REGISTER          00385000
         LA    15,255                  SET RETURN CODE                  00386000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00387000
         BR    14                      RETURN TO CALLER                 00388000
         LTORG                                                          00389000
*                                                                       00390000
*                                                                       00391000
**********************************************************************  00392000
* FETCH FROM UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:               00393000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00394000
*   IT WILL FOLLOW A SUCCESSFUL SELECT UPDATE STATEMENT TO RETRIEVE     00395000
*     THE ACTUAL ROW.                                                   00396000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00397000
**********************************************************************  00398000
*                                                                       00399000
SQL#0011 DS    0H                                                       00400000
         USING SQL#0011,12             ESTABLISH BASE REGISTER          00401000
         LA    15,255                  SET RETURN CODE                  00402000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00403000
         BR    14                      RETURN TO CALLER                 00404000
         LTORG                                                          00405000
*                                                                       00406000
*                                                                       00407000
**********************************************************************  00408000
* CLOSE UPDATE CURSOR STATEMENT FOR PRIMARY KEY:                        00409000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00410000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00411000
*     TO CLOSE THE UPDATE CURSOR.                                       00412000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00413000
**********************************************************************  00414000
*                                                                       00415000
SQL#0012 DS    0H                                                       00416000
         USING SQL#0012,12             ESTABLISH BASE REGISTER          00417000
         EXEC  SQL                                                     *00418000
               CLOSE SACUPD0                                            00419000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00420000
         BR    14                      RETURN TO CALLER                 00421000
         LTORG                                                          00422000
*                                                                       00423000
*                                                                       00424000
**********************************************************************  00425000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 1:                    00426000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00427000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00428000
*     TO CLOSE THE UPDATE CURSOR.                                       00429000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00430000
**********************************************************************  00431000
*                                                                       00432000
SQL#0013 DS    0H                                                       00433000
         USING SQL#0013,12             ESTABLISH BASE REGISTER          00434000
         LA    15,255                  SET RETURN CODE                  00435000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00436000
         BR    14                      RETURN TO CALLER                 00437000
         LTORG                                                          00438000
*                                                                       00439000
*                                                                       00440000
**********************************************************************  00441000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 2:                    00442000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00443000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00444000
*     TO CLOSE THE UPDATE CURSOR.                                       00445000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00446000
**********************************************************************  00447000
*                                                                       00448000
SQL#0014 DS    0H                                                       00449000
         USING SQL#0014,12             ESTABLISH BASE REGISTER          00450000
         LA    15,255                  SET RETURN CODE                  00451000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00452000
         BR    14                      RETURN TO CALLER                 00453000
         LTORG                                                          00454000
*                                                                       00455000
*                                                                       00456000
**********************************************************************  00457000
* CLOSE UPDATE CURSOR STATEMENT FOR ALTERNATE KEY 3:                    00458000
*   THIS STATEMENT SUPPORTS THE GET-LOCK VERB.                          00459000
*   IT WILL FOLLOW THE LAST FETCH FROM UPDATE CURSOR STATEMENT          00460000
*     TO CLOSE THE UPDATE CURSOR.                                       00461000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00462000
**********************************************************************  00463000
*                                                                       00464000
SQL#0015 DS    0H                                                       00465000
         USING SQL#0015,12             ESTABLISH BASE REGISTER          00466000
         LA    15,255                  SET RETURN CODE                  00467000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00468000
         BR    14                      RETURN TO CALLER                 00469000
         LTORG                                                          00470000
*                                                                       00471000
*                                                                       00472000
**********************************************************************  00473000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY    00474000
* KEY:                                                                  00475000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00476000
*     AND GET-NEXT-LOCK VERBS.                                          00477000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00478000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00479000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00480000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00481000
*     ORDER BY CLAUSE.                                                  00482000
**********************************************************************  00483000
*                                                                       00484000
SQL#0016 DS    0H                                                       00485000
         USING SQL#0016,12             ESTABLISH BASE REGISTER          00486000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00487000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00488000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00489000
         EXEC  SQL                                                     *00490000
               DECLARE SACSQ001 CURSOR FOR                             *00491000
               SELECT INST_NBR,                                        *00492000
                   PROD_CODE,                                          *00493000
                   IDENT_NBR,                                          *00494000
                   AUDIT_DATE,                                         *00495000
                   AUDIT_TIME,                                         *00496000
                   AUDIT_USER,                                         *00497000
                   AUDIT_ORG,                                          *00498000
                   INST_NBR_2,                                         *00499000
                   PROD_CODE_2,                                        *00500000
                   ACCT_NBR_2,                                         *00501000
                   MODEL_2,                                            *00502000
                   RCIF_STATUS,                                        *00503000
                   RSV_AREA                                            *00504000
                 FROM SAC                                              *00505000
                 WHERE                                                 *00506000
                    INST_NBR = :INST AND                               *00507000
                    PROD_CODE = :PRDCDE AND                            *00508000
                    IDENT_NBR >= :IDNBR                                *00509000
                 ORDER BY IDENT_NBR                                    *00510000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       00511000
         EXEC  SQL                                                     *00512000
               OPEN SACSQ001                                            00513000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00514000
         BR    14                      RETURN TO CALLER                 00515000
         LTORG                                                          00516000
*                                                                       00517000
*                                                                       00518000
**********************************************************************  00519000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00520000
* KEY 1:                                                                00521000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00522000
*     AND GET-NEXT-LOCK VERBS.                                          00523000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00524000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00525000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00526000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00527000
*     ORDER BY CLAUSE.                                                  00528000
**********************************************************************  00529000
*                                                                       00530000
SQL#0017 DS    0H                                                       00531000
         USING SQL#0017,12             ESTABLISH BASE REGISTER          00532000
         LA    15,255                  SET RETURN CODE                  00533000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00534000
         BR    14                      RETURN TO CALLER                 00535000
         LTORG                                                          00536000
*                                                                       00537000
*                                                                       00538000
**********************************************************************  00539000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00540000
* KEY 2:                                                                00541000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00542000
*     AND GET-NEXT-LOCK VERBS.                                          00543000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00544000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00545000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00546000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00547000
*     ORDER BY CLAUSE.                                                  00548000
**********************************************************************  00549000
*                                                                       00550000
SQL#0018 DS    0H                                                       00551000
         USING SQL#0018,12             ESTABLISH BASE REGISTER          00552000
         LA    15,255                  SET RETURN CODE                  00553000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00554000
         BR    14                      RETURN TO CALLER                 00555000
         LTORG                                                          00556000
*                                                                       00557000
*                                                                       00558000
**********************************************************************  00559000
* SELECT SEQUENTIAL AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE  00560000
* KEY 3:                                                                00561000
*   THESE STATEMENTS SUPPORT THE GET-GE, GET-GE-LOCK, GET-NEXT,         00562000
*     AND GET-NEXT-LOCK VERBS.                                          00563000
*   A SELECT UPDATE STATEMENT WILL FOLLOW IN THE CASE OF A              00564000
*     GET-GE-LOCK OR GET-NEXT-LOCK VERB.                                00565000
*   THEY MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF      00566000
*     GREATER THAN COMPARES IN THE WHERE CLAUSE AND BY DROPPING THE     00567000
*     ORDER BY CLAUSE.                                                  00568000
**********************************************************************  00569000
*                                                                       00570000
SQL#0019 DS    0H                                                       00571000
         USING SQL#0019,12             ESTABLISH BASE REGISTER          00572000
         LA    15,255                  SET RETURN CODE                  00573000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00574000
         BR    14                      RETURN TO CALLER                 00575000
         LTORG                                                          00576000
*                                                                       00577000
*                                                                       00578000
**********************************************************************  00579000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:               00580000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00581000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00582000
*     RETRIEVE THE ACTUAL ROW.                                          00583000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00584000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00585000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00586000
**********************************************************************  00587000
*                                                                       00588000
SQL#0020 DS    0H                                                       00589000
         USING SQL#0020,12             ESTABLISH BASE REGISTER          00590000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00591000
         LA    12,VECT0020(1)          LOAD POINTER TO FETCH ROUTINE    00592000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00593000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00594000
VECT0020 DC    A(SQL#0120)                                              00595000
         DC    A(SQL#0220)                                              00596000
         DC    A(SQL#0320)                                              00597000
         LTORG                                                          00598000
*                                                                       00599000
SQL#0120 DS    0H                                                       00600000
         USING SQL#0120,12             ESTABLISH BASE REGISTER          00601000
         EXEC  SQL                                                     *00602000
               FETCH SACSQ001                                          *00603000
                 INTO :INST,                                           *00604000
                      :PRDCDE,                                         *00605000
                      :IDNBR,                                          *00606000
                      :AUDDATE,                                        *00607000
                      :AUDTIME,                                        *00608000
                      :AUDUSER,                                        *00609000
                      :AUDORG,                                         *00610000
                      :INST2,                                          *00611000
                      :PRODCDE,                                        *00612000
                      :ACCT2,                                          *00613000
                      :MODEL2,                                         *00614000
                      :RCIFSTAT,                                       *00615000
                      :RAREA                                            00616000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00617000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00618000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00619000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00620000
         BR    12                      OPEN NEXT CURSOR                 00621000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00622000
         BALR  4,5                     MOVE INTO RECORD AREA            00623000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00624000
         BR    14                      RETURN TO CALLER                 00625000
         LTORG                                                          00626000
*                                                                       00627000
SQL#0220 DS    0H                                                       00628000
         USING SQL#0220,12             ESTABLISH BASE REGISTER          00629000
         EXEC  SQL                                                     *00630000
               FETCH SACSQ002                                          *00631000
                 INTO :INST,                                           *00632000
                      :PRDCDE,                                         *00633000
                      :IDNBR,                                          *00634000
                      :AUDDATE,                                        *00635000
                      :AUDTIME,                                        *00636000
                      :AUDUSER,                                        *00637000
                      :AUDORG,                                         *00638000
                      :INST2,                                          *00639000
                      :PRODCDE,                                        *00640000
                      :ACCT2,                                          *00641000
                      :MODEL2,                                         *00642000
                      :RCIFSTAT,                                       *00643000
                      :RAREA                                            00644000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00645000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00646000
         L     9,=A(SQL#0020)          LOAD RETURN ROUTINE ADDRESS      00647000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00648000
         BR    12                      OPEN NEXT CURSOR                 00649000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00650000
         BALR  4,5                     MOVE INTO RECORD AREA            00651000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00652000
         BR    14                      RETURN TO CALLER                 00653000
         LTORG                                                          00654000
*                                                                       00655000
SQL#0320 DS    0H                                                       00656000
         USING SQL#0320,12             ESTABLISH BASE REGISTER          00657000
         EXEC  SQL                                                     *00658000
               FETCH SACSQ003                                          *00659000
                 INTO :INST,                                           *00660000
                      :PRDCDE,                                         *00661000
                      :IDNBR,                                          *00662000
                      :AUDDATE,                                        *00663000
                      :AUDTIME,                                        *00664000
                      :AUDUSER,                                        *00665000
                      :AUDORG,                                         *00666000
                      :INST2,                                          *00667000
                      :PRODCDE,                                        *00668000
                      :ACCT2,                                          *00669000
                      :MODEL2,                                         *00670000
                      :RCIFSTAT,                                       *00671000
                      :RAREA                                            00672000
         L     5,=A(OUT#REC)           LOAD OUTPUT CONVERSION ROUTINE   00673000
         BALR  4,5                     MOVE INTO RECORD AREA            00674000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00675000
         BR    14                      RETURN TO CALLER                 00676000
         LTORG                                                          00677000
*                                                                       00678000
*                                                                       00679000
**********************************************************************  00680000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:           00681000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00682000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00683000
*     RETRIEVE THE ACTUAL ROW.                                          00684000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00685000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00686000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00687000
**********************************************************************  00688000
*                                                                       00689000
SQL#0021 DS    0H                                                       00690000
         USING SQL#0021,12             ESTABLISH BASE REGISTER          00691000
         LA    15,255                  SET RETURN CODE                  00692000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00693000
         BR    14                      RETURN TO CALLER                 00694000
         LTORG                                                          00695000
*                                                                       00696000
*                                                                       00697000
**********************************************************************  00698000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:           00699000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00700000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00701000
*     RETRIEVE THE ACTUAL ROW.                                          00702000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00703000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00704000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00705000
**********************************************************************  00706000
*                                                                       00707000
SQL#0022 DS    0H                                                       00708000
         USING SQL#0022,12             ESTABLISH BASE REGISTER          00709000
         LA    15,255                  SET RETURN CODE                  00710000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00711000
         BR    14                      RETURN TO CALLER                 00712000
         LTORG                                                          00713000
*                                                                       00714000
*                                                                       00715000
**********************************************************************  00716000
* FETCH FROM SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:           00717000
*   THIS STATEMENT SUPPORTS THE GET-GE AND GET-NEXT VERBS.              00718000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00719000
*     RETRIEVE THE ACTUAL ROW.                                          00720000
*   THE GET-GE-LOCK AND GET-NEXT-LOCK VERBS USE A DIFFERENT             00721000
*     FETCH STATEMENT AS ONLY THE KEY FIELDS ARE NEEDED.                00722000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00723000
**********************************************************************  00724000
*                                                                       00725000
SQL#0023 DS    0H                                                       00726000
         USING SQL#0023,12             ESTABLISH BASE REGISTER          00727000
         LA    15,255                  SET RETURN CODE                  00728000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00729000
         BR    14                      RETURN TO CALLER                 00730000
         LTORG                                                          00731000
*                                                                       00732000
*                                                                       00733000
**********************************************************************  00734000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00735000
* THE PRIMARY KEY:                                                      00736000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00737000
*     VERBS.                                                            00738000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00739000
*     RETRIEVE THE ACTUAL ROW.                                          00740000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00741000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00742000
*     WILL BE THRU THE UPDATE CURSOR.                                   00743000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00744000
**********************************************************************  00745000
*                                                                       00746000
SQL#0024 DS    0H                                                       00747000
         USING SQL#0024,12             ESTABLISH BASE REGISTER          00748000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00749000
         LA    12,VECT0024(1)          LOAD POINTER TO FETCH ROUTINE    00750000
         L     12,0(12)                LOAD FETCH ROUTINE ADDRESS       00751000
         BR    12                      GO TO CURRENT FETCH ROUTINE      00752000
VECT0024 DC    A(SQL#0124)                                              00753000
         DC    A(SQL#0224)                                              00754000
         DC    A(SQL#0324)                                              00755000
         LTORG                                                          00756000
*                                                                       00757000
SQL#0124 DS    0H                                                       00758000
         USING SQL#0124,12             ESTABLISH BASE REGISTER          00759000
         EXEC  SQL                                                     *00760000
               FETCH SACSQ001                                          *00761000
                 INTO :INST,                                           *00762000
                      :PRDCDE,                                         *00763000
                      :IDNBR                                            00764000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00765000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00766000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00767000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00768000
         BR    12                      OPEN NEXT CURSOR                 00769000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00770000
         BALR  4,5                     MOVE INTO RECORD AREA            00771000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00772000
         BR    14                      RETURN TO CALLER                 00773000
         LTORG                                                          00774000
*                                                                       00775000
SQL#0224 DS    0H                                                       00776000
         USING SQL#0224,12             ESTABLISH BASE REGISTER          00777000
         EXEC  SQL                                                     *00778000
               FETCH SACSQ002                                          *00779000
                 INTO :INST,                                           *00780000
                      :PRDCDE,                                         *00781000
                      :IDNBR                                            00782000
         CLC   SQLCODE,=F'+100'        CHECK FOR ROW NOT FOUND          00783000
         BNE   *+14                    RETURN IF NOT SQLCODE +100       00784000
         L     9,=A(SQL#0024)          LOAD RETURN ROUTINE ADDRESS      00785000
         L     12,=A(SQL#0046)         LOAD CURSOR ROUTINE BASE REG     00786000
         BR    12                      OPEN NEXT CURSOR                 00787000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00788000
         BALR  4,5                     MOVE INTO RECORD AREA            00789000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00790000
         BR    14                      RETURN TO CALLER                 00791000
         LTORG                                                          00792000
*                                                                       00793000
SQL#0324 DS    0H                                                       00794000
         USING SQL#0324,12             ESTABLISH BASE REGISTER          00795000
         EXEC  SQL                                                     *00796000
               FETCH SACSQ003                                          *00797000
                 INTO :INST,                                           *00798000
                      :PRDCDE,                                         *00799000
                      :IDNBR                                            00800000
         L     5,=A(OUT#KEY)           LOAD OUTPUT CONVERSION ROUTINE   00801000
         BALR  4,5                     MOVE INTO RECORD AREA            00802000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00803000
         BR    14                      RETURN TO CALLER                 00804000
         LTORG                                                          00805000
*                                                                       00806000
*                                                                       00807000
**********************************************************************  00808000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00809000
* ALTERNATE KEY 1:                                                      00810000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00811000
*     VERBS.                                                            00812000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00813000
*     RETRIEVE THE ACTUAL ROW.                                          00814000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00815000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00816000
*     WILL BE THRU THE UPDATE CURSOR.                                   00817000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00818000
**********************************************************************  00819000
*                                                                       00820000
SQL#0025 DS    0H                                                       00821000
         USING SQL#0025,12             ESTABLISH BASE REGISTER          00822000
         LA    15,255                  SET RETURN CODE                  00823000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00824000
         BR    14                      RETURN TO CALLER                 00825000
         LTORG                                                          00826000
*                                                                       00827000
*                                                                       00828000
**********************************************************************  00829000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00830000
* ALTERNATE KEY 2:                                                      00831000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00832000
*     VERBS.                                                            00833000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00834000
*     RETRIEVE THE ACTUAL ROW.                                          00835000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00836000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00837000
*     WILL BE THRU THE UPDATE CURSOR.                                   00838000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00839000
**********************************************************************  00840000
*                                                                       00841000
SQL#0026 DS    0H                                                       00842000
         USING SQL#0026,12             ESTABLISH BASE REGISTER          00843000
         LA    15,255                  SET RETURN CODE                  00844000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00845000
         BR    14                      RETURN TO CALLER                 00846000
         LTORG                                                          00847000
*                                                                       00848000
*                                                                       00849000
**********************************************************************  00850000
* FETCH FROM SEQUENTIAL CURSOR FOR EVENTUAL UPDATE STATEMENT FOR        00851000
* ALTERNATE KEY 3:                                                      00852000
*   THIS STATEMENT SUPPORTS THE GET-GE-LOCK AND GET-NEXT-LOCK           00853000
*     VERBS.                                                            00854000
*   IT WILL FOLLOW A SUCCESSFUL SELECT SEQUENTIAL STATEMENT TO          00855000
*     RETRIEVE THE ACTUAL ROW.                                          00856000
*   ONLY THE PRIMARY KEY FIELDS ARE RETRIEVED AS A SELECT FOR UPDATE    00857000
*     STATEMENT WILL FOLLOW AND RETREIVAL OF THE ACTUAL ROW             00858000
*     WILL BE THRU THE UPDATE CURSOR.                                   00859000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00860000
**********************************************************************  00861000
*                                                                       00862000
SQL#0027 DS    0H                                                       00863000
         USING SQL#0027,12             ESTABLISH BASE REGISTER          00864000
         LA    15,255                  SET RETURN CODE                  00865000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00866000
         BR    14                      RETURN TO CALLER                 00867000
         LTORG                                                          00868000
*                                                                       00869000
*                                                                       00870000
**********************************************************************  00871000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR PRIMARY KEY:                    00872000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00873000
*     AND GET-NEXT-LOCK VERBS.                                          00874000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00875000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00876000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00877000
**********************************************************************  00878000
*                                                                       00879000
SQL#0028 DS    0H                                                       00880000
         USING SQL#0028,12             ESTABLISH BASE REGISTER          00881000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      00882000
         XC    CSRPTR,CSRPTR           CLEAR CURSOR ROUTINE POINTER     00883000
         LA    12,VECT0028(1)          LOAD POINTER TO CLOSE ROUTINE    00884000
         L     12,0(12)                LOAD CLOSE ROUTINE ADDRESS       00885000
         BR    12                      GO TO CURRENT CLOSE ROUTINE      00886000
VECT0028 DC    A(SQL#0128)                                              00887000
         DC    A(SQL#0228)                                              00888000
         DC    A(SQL#0328)                                              00889000
         LTORG                                                          00890000
*                                                                       00891000
SQL#0128 DS    0H                                                       00892000
         USING SQL#0128,12             ESTABLISH BASE REGISTER          00893000
         EXEC  SQL                                                     *00894000
               CLOSE SACSQ001                                           00895000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00896000
         BR    14                      RETURN TO CALLER                 00897000
         LTORG                                                          00898000
*                                                                       00899000
SQL#0228 DS    0H                                                       00900000
         USING SQL#0228,12             ESTABLISH BASE REGISTER          00901000
         EXEC  SQL                                                     *00902000
               CLOSE SACSQ002                                           00903000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00904000
         BR    14                      RETURN TO CALLER                 00905000
         LTORG                                                          00906000
*                                                                       00907000
SQL#0328 DS    0H                                                       00908000
         USING SQL#0328,12             ESTABLISH BASE REGISTER          00909000
         EXEC  SQL                                                     *00910000
               CLOSE SACSQ003                                           00911000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00912000
         BR    14                      RETURN TO CALLER                 00913000
         LTORG                                                          00914000
*                                                                       00915000
*                                                                       00916000
**********************************************************************  00917000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 1:                00918000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00919000
*     AND GET-NEXT-LOCK VERBS.                                          00920000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00921000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00922000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00923000
**********************************************************************  00924000
*                                                                       00925000
SQL#0029 DS    0H                                                       00926000
         USING SQL#0029,12             ESTABLISH BASE REGISTER          00927000
         LA    15,255                  SET RETURN CODE                  00928000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00929000
         BR    14                      RETURN TO CALLER                 00930000
         LTORG                                                          00931000
*                                                                       00932000
*                                                                       00933000
**********************************************************************  00934000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 2:                00935000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00936000
*     AND GET-NEXT-LOCK VERBS.                                          00937000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00938000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00939000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00940000
**********************************************************************  00941000
*                                                                       00942000
SQL#0030 DS    0H                                                       00943000
         USING SQL#0030,12             ESTABLISH BASE REGISTER          00944000
         LA    15,255                  SET RETURN CODE                  00945000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00946000
         BR    14                      RETURN TO CALLER                 00947000
         LTORG                                                          00948000
*                                                                       00949000
*                                                                       00950000
**********************************************************************  00951000
* CLOSE SEQUENTIAL CURSOR STATEMENT FOR ALTERNATE KEY 3:                00952000
*   THIS STATEMENT SUPPORTS THE GET-GE, GET-GE-LOCK, GET-NEXT,          00953000
*     AND GET-NEXT-LOCK VERBS.                                          00954000
*   IT WILL FOLLOW THE LAST FETCH FROM SEQUENTIAL CURSOR STATEMENT      00955000
*     TO CLOSE THE SEQUENTIAL CURSOR.                                   00956000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00957000
**********************************************************************  00958000
*                                                                       00959000
SQL#0031 DS    0H                                                       00960000
         USING SQL#0031,12             ESTABLISH BASE REGISTER          00961000
         LA    15,255                  SET RETURN CODE                  00962000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00963000
         BR    14                      RETURN TO CALLER                 00964000
         LTORG                                                          00965000
*                                                                       00966000
*                                                                       00967000
**********************************************************************  00968000
* SELECT KEY STATEMENT BY PRIMARY KEY:                                  00969000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00970000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00971000
**********************************************************************  00972000
*                                                                       00973000
SQL#0032 DS    0H                                                       00974000
         USING SQL#0032,12             ESTABLISH BASE REGISTER          00975000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              00976000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      00977000
         BALR  4,5                     MOVE INTO HOST VARIABLES         00978000
         EXEC  SQL                                                     *00979000
               SELECT INST_NBR,                                        *00980000
                   PROD_CODE,                                          *00981000
                   IDENT_NBR                                           *00982000
                 INTO :INST,                                           *00983000
                   :PRDCDE,                                            *00984000
                   :IDNBR                                              *00985000
                 FROM SAC                                              *00986000
                 WHERE INST_NBR = :INST AND                            *00987000
                   PROD_CODE = :PRDCDE AND                             *00988000
                   IDENT_NBR = :IDNBR                                  *00989000
                 FETCH FIRST 1 ROW ONLY                                 00990000
         L     14,SQW@RET              LOAD RETURN ADDRESS              00991000
         BR    14                      RETURN TO CALLER                 00992000
         LTORG                                                          00993000
*                                                                       00994000
*                                                                       00995000
**********************************************************************  00996000
* SELECT KEY STATEMENT BY ALTERNATE KEY 1:                              00997000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            00998000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  00999000
**********************************************************************  01000000
*                                                                       01001000
SQL#0033 DS    0H                                                       01002000
         USING SQL#0033,12             ESTABLISH BASE REGISTER          01003000
         LA    15,255                  SET RETURN CODE                  01004000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01005000
         BR    14                      RETURN TO CALLER                 01006000
         LTORG                                                          01007000
*                                                                       01008000
*                                                                       01009000
**********************************************************************  01010000
* SELECT KEY STATEMENT BY ALTERNATE KEY 2:                              01011000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01012000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01013000
**********************************************************************  01014000
*                                                                       01015000
SQL#0034 DS    0H                                                       01016000
         USING SQL#0034,12             ESTABLISH BASE REGISTER          01017000
         LA    15,255                  SET RETURN CODE                  01018000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01019000
         BR    14                      RETURN TO CALLER                 01020000
         LTORG                                                          01021000
*                                                                       01022000
*                                                                       01023000
**********************************************************************  01024000
* SELECT KEY STATEMENT BY ALTERNATE KEY 3:                              01025000
*   THIS STATEMENT SUPPORTS THE LOCATE VERB.                            01026000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01027000
**********************************************************************  01028000
*                                                                       01029000
SQL#0035 DS    0H                                                       01030000
         USING SQL#0035,12             ESTABLISH BASE REGISTER          01031000
         LA    15,255                  SET RETURN CODE                  01032000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01033000
         BR    14                      RETURN TO CALLER                 01034000
         LTORG                                                          01035000
*                                                                       01036000
*                                                                       01037000
**********************************************************************  01038000
* INSERT STATEMENT:                                                     01039000
*   THIS STATEMENT SUPPORTS THE PUT VERB.                               01040000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01041000
**********************************************************************  01042000
*                                                                       01043000
SQL#0036 DS    0H                                                       01044000
         USING SQL#0036,12             ESTABLISH BASE REGISTER          01045000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01046000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01047000
         EXEC  SQL                                                     *01048000
               INSERT INTO SAC                                         *01049000
                   (INST_NBR,                                          *01050000
                    PROD_CODE,                                         *01051000
                    IDENT_NBR,                                         *01052000
                    AUDIT_DATE,                                        *01053000
                    AUDIT_TIME,                                        *01054000
                    AUDIT_USER,                                        *01055000
                    AUDIT_ORG,                                         *01056000
                    INST_NBR_2,                                        *01057000
                    PROD_CODE_2,                                       *01058000
                    ACCT_NBR_2,                                        *01059000
                    MODEL_2,                                           *01060000
                    RCIF_STATUS,                                       *01061000
                    RSV_AREA)                                          *01062000
                  VALUES (:INST,                                       *01063000
                   :PRDCDE,                                            *01064000
                   :IDNBR,                                             *01065000
                   :AUDDATE,                                           *01066000
                   :AUDTIME,                                           *01067000
                   :AUDUSER,                                           *01068000
                   :AUDORG,                                            *01069000
                   :INST2,                                             *01070000
                   :PRODCDE,                                           *01071000
                   :ACCT2,                                             *01072000
                   :MODEL2,                                            *01073000
                   :RCIFSTAT,                                          *01074000
                   :RAREA)                                              01075000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01076000
         BR    14                      RETURN TO CALLER                 01077000
         LTORG                                                          01078000
*                                                                       01079000
*                                                                       01080000
**********************************************************************  01081000
* UPDATE STATEMENT BY PRIMARY KEY:                                      01082000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01083000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01084000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01085000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01086000
*     STATEMENT.                                                        01087000
**********************************************************************  01088000
*                                                                       01089000
SQL#0037 DS    0H                                                       01090000
         USING SQL#0037,12             ESTABLISH BASE REGISTER          01091000
         L     5,=A(IN#HOST)           LOAD INPUT CONVERSION ROUTINE    01092000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01093000
         EXEC  SQL                                                     *01094000
               UPDATE SAC                                              *01095000
                   SET AUDIT_DATE = :AUDDATE,                          *01096000
                     AUDIT_TIME = :AUDTIME,                            *01097000
                     AUDIT_USER = :AUDUSER,                            *01098000
                     AUDIT_ORG = :AUDORG,                              *01099000
                     INST_NBR_2 = :INST2,                              *01100000
                     PROD_CODE_2 = :PRODCDE,                           *01101000
                     ACCT_NBR_2 = :ACCT2,                              *01102000
                     MODEL_2 = :MODEL2,                                *01103000
                     RCIF_STATUS = :RCIFSTAT,                          *01104000
                     RSV_AREA = :RAREA                                 *01105000
                 WHERE CURRENT OF SACUPD0                               01106000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01107000
         BR    14                      RETURN TO CALLER                 01108000
         LTORG                                                          01109000
*                                                                       01110000
*                                                                       01111000
**********************************************************************  01112000
* UPDATE STATEMENT BY ALTERNATE KEY 1:                                  01113000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01114000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01115000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01116000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01117000
*     STATEMENT.                                                        01118000
**********************************************************************  01119000
*                                                                       01120000
SQL#0038 DS    0H                                                       01121000
         USING SQL#0038,12             ESTABLISH BASE REGISTER          01122000
         LA    15,255                  SET RETURN CODE                  01123000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01124000
         BR    14                      RETURN TO CALLER                 01125000
         LTORG                                                          01126000
*                                                                       01127000
*                                                                       01128000
**********************************************************************  01129000
* UPDATE STATEMENT BY ALTERNATE KEY 2:                                  01130000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01131000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01132000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01133000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01134000
*     STATEMENT.                                                        01135000
**********************************************************************  01136000
*                                                                       01137000
SQL#0039 DS    0H                                                       01138000
         USING SQL#0039,12             ESTABLISH BASE REGISTER          01139000
         LA    15,255                  SET RETURN CODE                  01140000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01141000
         BR    14                      RETURN TO CALLER                 01142000
         LTORG                                                          01143000
*                                                                       01144000
*                                                                       01145000
**********************************************************************  01146000
* UPDATE STATEMENT BY ALTERNATE KEY 3:                                  01147000
*   THIS STATEMENT SUPPORTS THE REPUT VERB.                             01148000
*   IT MAY BE MODIFIED FOR PERFORMANCE BY REDUCING THE NUMBER OF        01149000
*     COLUMNS REFERENCED AS UPDATEABLE IN THE SELECT FOR UPDATE         01150000
*     STATEMENT, THEN MATCHING THAT REDUCTION IN THE UPDATE             01151000
*     STATEMENT.                                                        01152000
**********************************************************************  01153000
*                                                                       01154000
SQL#0040 DS    0H                                                       01155000
         USING SQL#0040,12             ESTABLISH BASE REGISTER          01156000
         LA    15,255                  SET RETURN CODE                  01157000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01158000
         BR    14                      RETURN TO CALLER                 01159000
         LTORG                                                          01160000
*                                                                       01161000
*                                                                       01162000
**********************************************************************  01163000
* DELETE STATEMENT BY PRIMARY KEY:                                      01164000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01165000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01166000
**********************************************************************  01167000
*                                                                       01168000
SQL#0041 DS    0H                                                       01169000
         USING SQL#0041,12             ESTABLISH BASE REGISTER          01170000
         EXEC  SQL                                                     *01171000
               DELETE FROM SAC                                         *01172000
                 WHERE CURRENT OF SACUPD0                               01173000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01174000
         BR    14                      RETURN TO CALLER                 01175000
         LTORG                                                          01176000
*                                                                       01177000
*                                                                       01178000
**********************************************************************  01179000
* DELETE STATEMENT BY ALTERNATE KEY 1:                                  01180000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01181000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01182000
**********************************************************************  01183000
*                                                                       01184000
SQL#0042 DS    0H                                                       01185000
         USING SQL#0042,12             ESTABLISH BASE REGISTER          01186000
         LA    15,255                  SET RETURN CODE                  01187000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01188000
         BR    14                      RETURN TO CALLER                 01189000
         LTORG                                                          01190000
*                                                                       01191000
*                                                                       01192000
**********************************************************************  01193000
* DELETE STATEMENT BY ALTERNATE KEY 2:                                  01194000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01195000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01196000
**********************************************************************  01197000
*                                                                       01198000
SQL#0043 DS    0H                                                       01199000
         USING SQL#0043,12             ESTABLISH BASE REGISTER          01200000
         LA    15,255                  SET RETURN CODE                  01201000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01202000
         BR    14                      RETURN TO CALLER                 01203000
         LTORG                                                          01204000
*                                                                       01205000
*                                                                       01206000
**********************************************************************  01207000
* DELETE STATEMENT BY ALTERNATE KEY 3:                                  01208000
*   THIS STATEMENT SUPPORTS THE DELETE VERB.                            01209000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01210000
**********************************************************************  01211000
*                                                                       01212000
SQL#0044 DS    0H                                                       01213000
         USING SQL#0044,12             ESTABLISH BASE REGISTER          01214000
         LA    15,255                  SET RETURN CODE                  01215000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01216000
         BR    14                      RETURN TO CALLER                 01217000
         LTORG                                                          01218000
*                                                                       01219000
*                                                                       01220000
**********************************************************************  01221000
* DELETE ALL STATEMENT:                                                 01222000
*   THIS STATEMENT SUPPORTS THE DELETE-FILE VERB.                       01223000
*   IT SHOULD NOT NEED TO BE MODIFIED FOR PERFORMANCE.                  01224000
**********************************************************************  01225000
*                                                                       01226000
SQL#0045 DS    0H                                                       01227000
         USING SQL#0045,12             ESTABLISH BASE REGISTER          01228000
         EXEC  SQL                                                     *01229000
               DELETE FROM SAC                                          01230000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01231000
         BR    14                      RETURN TO CALLER                 01232000
         LTORG                                                          01233000
*                                                                       01234000
*                                                                       01235000
**********************************************************************  01236000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY PRIMARY KEY:          01237000
*   THIS ROUTINE HANDLES PRIMARY KEY SEQUENTIAL CURSORS.                01238000
**********************************************************************  01239000
*                                                                       01240000
SQL#0046 DS    0H                                                       01241000
         USING SQL#0046,12             ESTABLISH BASE REGISTER          01242000
         LA    3,X'80'                 LOAD MASK FOR KEY 0              01243000
         L     5,=A(IN#KEY)            LOAD KEY CONVERSION ROUTINE      01244000
         BALR  4,5                     MOVE INTO HOST VARIABLES         01245000
         LH    1,CSRPTR                LOAD CURRENT CURSOR POINTER      01246000
         LA    1,4(1)                  INCREMENT TO NEXT CURSOR         01247000
         STH   1,CSRPTR                SAVE FOR NEXT CALL               01248000
         LA    12,VECT0046(1)          LOAD POINTER TO NEXT CURSOR      01249000
         L     12,0(12)                LOAD CURSOR ROUTINE ADDRESS      01250000
         BR    12                      GO TO CURRENT CURSOR ROUTINE     01251000
VECT0046 DC    A(0)                                                     01252000
         DC    A(SQL#0246)                                              01253000
         DC    A(SQL#0346)                                              01254000
         LTORG                                                          01255000
*                                                                       01256000
SQL#0246 DS    0H                                                       01257000
         USING SQL#0246,12             ESTABLISH BASE REGISTER          01258000
         EXEC  SQL                                                     *01259000
               CLOSE SACSQ001                                           01260000
         EXEC  SQL                                                     *01261000
               DECLARE SACSQ002 CURSOR FOR                             *01262000
               SELECT INST_NBR,                                        *01263000
                   PROD_CODE,                                          *01264000
                   IDENT_NBR,                                          *01265000
                   AUDIT_DATE,                                         *01266000
                   AUDIT_TIME,                                         *01267000
                   AUDIT_USER,                                         *01268000
                   AUDIT_ORG,                                          *01269000
                   INST_NBR_2,                                         *01270000
                   PROD_CODE_2,                                        *01271000
                   ACCT_NBR_2,                                         *01272000
                   MODEL_2,                                            *01273000
                   RCIF_STATUS,                                        *01274000
                   RSV_AREA                                            *01275000
                 FROM SAC                                              *01276000
                 WHERE                                                 *01277000
                    INST_NBR = :INST AND                               *01278000
                    PROD_CODE > :PRDCDE                                *01279000
                 ORDER BY PROD_CODE,                                   *01280000
                   IDENT_NBR                                           *01281000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01282000
         EXEC  SQL                                                     *01283000
               OPEN SACSQ002                                            01284000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01285000
         BNZ   *+8                     NO - RETURN ERROR                01286000
         LR    12,9                    LOAD RETURN ADDRESS              01287000
         BR    12                      RETURN TO FETCH ROUTINE          01288000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01289000
         BR    14                      RETURN TO CALLER                 01290000
         LTORG                                                          01291000
*                                                                       01292000
SQL#0346 DS    0H                                                       01293000
         USING SQL#0346,12             ESTABLISH BASE REGISTER          01294000
         EXEC  SQL                                                     *01295000
               CLOSE SACSQ002                                           01296000
         EXEC  SQL                                                     *01297000
               DECLARE SACSQ003 CURSOR FOR                             *01298000
               SELECT INST_NBR,                                        *01299000
                   PROD_CODE,                                          *01300000
                   IDENT_NBR,                                          *01301000
                   AUDIT_DATE,                                         *01302000
                   AUDIT_TIME,                                         *01303000
                   AUDIT_USER,                                         *01304000
                   AUDIT_ORG,                                          *01305000
                   INST_NBR_2,                                         *01306000
                   PROD_CODE_2,                                        *01307000
                   ACCT_NBR_2,                                         *01308000
                   MODEL_2,                                            *01309000
                   RCIF_STATUS,                                        *01310000
                   RSV_AREA                                            *01311000
                 FROM SAC                                              *01312000
                 WHERE                                                 *01313000
                    INST_NBR > :INST                                   *01314000
                 ORDER BY INST_NBR,                                    *01315000
                   PROD_CODE,                                          *01316000
                   IDENT_NBR                                           *01317000
                 OPTIMIZE FOR 1 ROW FOR READ ONLY                       01318000
         EXEC  SQL                                                     *01319000
               OPEN SACSQ003                                            01320000
         ICM   15,B'1111',SQLCODE      IS RETURN CODE ZERO ?            01321000
         BNZ   *+8                     NO - RETURN ERROR                01322000
         LR    12,9                    LOAD RETURN ADDRESS              01323000
         BR    12                      RETURN TO FETCH ROUTINE          01324000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01325000
         BR    14                      RETURN TO CALLER                 01326000
         LTORG                                                          01327000
*                                                                       01328000
*                                                                       01329000
**********************************************************************  01330000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 1:      01331000
*   THIS ROUTINE HANDLES ALTERNATE KEY 1 SEQUENTIAL CURSORS.            01332000
**********************************************************************  01333000
*                                                                       01334000
SQL#0047 DS    0H                                                       01335000
         USING SQL#0047,12             ESTABLISH BASE REGISTER          01336000
         LA    15,255                  SET RETURN CODE                  01337000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01338000
         BR    14                      RETURN TO CALLER                 01339000
         LTORG                                                          01340000
*                                                                       01341000
*                                                                       01342000
**********************************************************************  01343000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 2:      01344000
*   THIS ROUTINE HANDLES ALTERNATE KEY 2 SEQUENTIAL CURSORS.            01345000
**********************************************************************  01346000
*                                                                       01347000
SQL#0048 DS    0H                                                       01348000
         USING SQL#0048,12             ESTABLISH BASE REGISTER          01349000
         LA    15,255                  SET RETURN CODE                  01350000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01351000
         BR    14                      RETURN TO CALLER                 01352000
         LTORG                                                          01353000
*                                                                       01354000
*                                                                       01355000
**********************************************************************  01356000
* SELECT AND OPEN SEQUENTIAL CURSOR STATEMENTS BY ALTERNATE KEY 3:      01357000
*   THIS ROUTINE HANDLES ALTERNATE KEY 3 SEQUENTIAL CURSORS.            01358000
**********************************************************************  01359000
*                                                                       01360000
SQL#0049 DS    0H                                                       01361000
         USING SQL#0049,12             ESTABLISH BASE REGISTER          01362000
         LA    15,255                  SET RETURN CODE                  01363000
         L     14,SQW@RET              LOAD RETURN ADDRESS              01364000
         BR    14                      RETURN TO CALLER                 01365000
         LTORG                                                          01366000
*                                                                       01367000
         DS    0H                      END OF SQL STATEMENTS            01368000
         DC    XL16'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                   01369000
*                                                                       01370000
*                                                                       01371000
**********************************************************************  01372000
* DUMMY ENTRY POINT DSNHLI                                              01373000
*   MUST NOT BE MODIFIED.                                               01374000
**********************************************************************  01375000
*                                                                       01376000
         ENTRY DSNHLI                                                   01377000
DSNHLI   DS    0H                                                       01378000
         L     15,SQW@CAF              LOAD ENTRY POINT TO ATTACH       01379000
         BR    15                      BRANCH TO ATTACH FACILITY        01380000
*                                                                       01381000
*                                                                       01382000
**********************************************************************  01383000
* CONVERSION ROUTINES INTO AND OUT OF ASSEMBLER HOST VARIABLES          01384000
*   REQUIRED IF THE COBOL RECORD STRUCTURE IS NOT ALIGNED.              01385000
*   MUST NOT BE MODIFIED.                                               01386000
**********************************************************************  01387000
*                                                                       01388000
CONV#RTN CSECT                         CONVERSION ROUTINES SECTION      01389000
CONV#RTN AMODE ANY                                                      01390000
CONV#RTN RMODE ANY                                                      01391000
IN#HOST  DS    0H                      MOVE INTO HOST VARIABLES         01392000
         USING IN#HOST,5               ESTABLISH BASE REGISTER          01393000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01394000
IN#HOST1 CLI   0(6),X'FF'              END OF TABLE?                    01395000
         BER   4                         YES - RETURN TO SQL            01396000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01397000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01398000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01399000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01400000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01401000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01402000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01403000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01404000
         B     IN#HOST1                LOOP UNTIL END OF TABLE          01405000
*                                                                       01406000
IN#KEY   DS    0H                      MOVE KEYS INTO HOST VARIABLES    01407000
         USING IN#KEY,5                ESTABLISH BASE REGISTER          01408000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01409000
IN#KEY1  CLI   0(6),X'FF'              END OF TABLE?                    01410000
         BER   4                         YES - RETURN TO SQL            01411000
         SLR   0,0                     CLEAR FOR INSERT                 01412000
         IC    0,6(6)                  INSERT KEY FIELD ENTRY           01413000
         NR    0,3                     FOR THE CURRENT KEY?             01414000
         BZ    IN#KEY2                   NO - GO FOR NEXT ENTRY         01415000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01416000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01417000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01418000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01419000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01420000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01421000
         MVCL  14,0                    MOVE TO HOST VARIABLES           01422000
         TM    7(6),X'80'              SIGNED DECIMAL FIELD?            01423000
         BNO   IN#KEY2                   NO - GO FOR NEXT ENTRY         01424000
         BCTR  14,0                    DECREMENT TO SIGN BYTE           01425000
         TM    0(14),X'0A'             VALID SIGN BYTE?                 01426000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01427000
         TM    0(14),X'0C'             VALID SIGN BYTE?                 01428000
         BO    IN#KEY2                   YES - GO FOR NEXT ENTRY        01429000
         OI    0(14),X'0F'               NO  - MAKE IT VALID            01430000
IN#KEY2  LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01431000
         B     IN#KEY1                 LOOP UNTIL END OF TABLE          01432000
*                                                                       01433000
OUT#REC  DS    0H                      MOVE HOST VARIABLES INTO RECORD  01434000
         USING OUT#REC,5               ESTABLISH BASE REGISTER          01435000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01436000
OUT#REC1 CLI   0(6),X'FF'              END OF TABLE?                    01437000
         BER   4                         YES - RETURN TO SQL            01438000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01439000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01440000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01441000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01442000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01443000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01444000
         MVCL  0,14                    MOVE TO RECORD AREA              01445000
         LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01446000
         B     OUT#REC1                LOOP UNTIL END OF TABLE          01447000
*                                                                       01448000
OUT#KEY  DS    0H                      MOVE KEYS INTO RECORD            01449000
         USING OUT#KEY,5               ESTABLISH BASE REGISTER          01450000
         LA    6,CONV#TAB              LOAD CONVERSION TABLE ADDRESS    01451000
OUT#KEY1 CLI   0(6),X'FF'              END OF TABLE?                    01452000
         BER   4                         YES - RETURN TO SQL            01453000
         TM    6(6),X'80'              FOR THE PRIMARY KEY?             01454000
         BZ    OUT#KEY2                  NO - GO FOR NEXT ENTRY         01455000
         LA    0,COBREC                LOAD RECORD AREA ADDRESS         01456000
         AH    0,0(6)                  ADD OFFSET WITHIN RECORD AREA    01457000
         LA    14,ASMREC               LOAD HOST VARIABLE AREA ADDRESS  01458000
         AH    14,2(6)                 ADD OFFSET WITHIN HOST VARIABLES 01459000
         LH    1,4(6)                  LOAD LENGTH TO MOVE              01460000
         LR    15,1                    SET BOTH LENGTHS EQUAL           01461000
         MVCL  0,14                    MOVE TO RECORD AREA              01462000
OUT#KEY2 LA    6,8(6)                  INCREMENT TO NEXT ENTRY          01463000
         B     OUT#KEY1                LOOP UNTIL END OF TABLE          01464000
*                                                                       01465000
*                                                                       01466000
**********************************************************************  01467000
* CONVERSION TABLE VALUES FOR ALL FIELDS IN THIS TABLE                  01468000
*   MUST NOT BE MODIFIED.                                               01469000
**********************************************************************  01470000
*                                                                       01471000
CONV#TAB DC    H'0000'                 COBOL RECORD AREA OFFSET         01472000
         DC    H'0000'                 HOST VARIABLE AREA OFFSET        01473000
         DC    H'0028'                 LENGTH TO MOVE                   01474000
         DC    X'80'                   80 = KEY 0 FIELD                 01475000
*                                      40 = KEY 1 FIELD                 01476000
*                                      20 = KEY 2 FIELD                 01477000
*                                      10 = KEY 3 FIELD                 01478000
         DC    X'00'                   80 = SIGNED DECIMAL FIELD        01479000
*                                                                       01480000
*                                      REST OF FIELD ENTRIES            01481000
         DC    H'0028',H'0028',H'0082',X'00',X'00'                      01482000
         DC    8X'FF'                  END OF FIELD ENTRIES             01483000
         LTORG                                                          01484000
         END                                                            01485000
