SELECT TRG.GOAL_ID , GRP.GR_NO , TRG.IND_CLS_CD , TRG.TRGT_ALOCN_PC , ADV.MIXD_MAIL_NM , ( CASE WHEN DAYOFWEEK ( TRG.TXN_STRT_TS ) = 1 THEN 'Sun' WHEN DAYOFWEEK ( TRG.TXN_STRT_TS ) = 2 THEN 'Mon' WHEN DAYOFWEEK ( TRG.TXN_STRT_TS ) = 3 THEN 'Tue' WHEN DAYOFWEEK ( TRG.TXN_STRT_TS ) = 4 THEN 'Wed' WHEN DAYOFWEEK ( TRG.TXN_STRT_TS ) = 5 THEN 'Thu' WHEN DAYOFWEEK ( TRG.TXN_STRT_TS ) = 6 THEN 'Fri' WHEN DAYOFWEEK ( TRG.TXN_STRT_TS ) = 7 THEN 'Sat' END || ' ' || CASE WHEN MONTH ( TRG.TXN_STRT_TS ) = 1 THEN 'Jan' WHEN MONTH ( TRG.TXN_STRT_TS ) = 2 THEN 'Feb' WHEN MONTH ( TRG.TXN_STRT_TS ) = 3 THEN 'Mar' WHEN MONTH ( TRG.TXN_STRT_TS ) = 4 THEN 'Apr' WHEN MONTH ( TRG.TXN_STRT_TS ) = 5 THEN 'May' WHEN MONTH ( TRG.TXN_STRT_TS ) = 6 THEN 'Jun' WHEN MONTH ( TRG.TXN_STRT_TS ) = 7 THEN 'Jul' WHEN MONTH ( TRG.TXN_STRT_TS ) = 8 THEN 'Aug' WHEN MONTH ( TRG.TXN_STRT_TS ) = 9 THEN 'Sep' WHEN MONTH ( TRG.TXN_STRT_TS ) = 10 THEN 'Oct' WHEN MONTH ( TRG.TXN_STRT_TS ) = 11 THEN 'Nov' WHEN MONTH ( TRG.TXN_STRT_TS ) = 12 THEN 'Dec' END || ' ' || RTRIM ( CHAR ( DAY ( TRG.TXN_STRT_TS ) ) ) || ' ' || CHAR ( TIME ( TRG.TXN_STRT_TS ) , JIS ) || ' ' || 'EST' || ' ' || YEAR ( TRG.TXN_STRT_TS ) ) AS DATETIME , TRG.CREW_PO_ID , TRG.IND_CLS_ID , TRG.PRNT_IND_CLS_ID , TRG.ACTV_FL FROM VSAG_BUS_RLSHP SAGB INNER JOIN VSAG_ADVC ADVC ON ADVC.SAG_ID = SAGB.SAG_ID INNER JOIN VADVC_PROFL PROFL ON PROFL.SAG_ID = ADVC.SAG_ID AND PROFL.EFFTV_END_DT > CURRENT DATE INNER JOIN VADVC_PROF_GOAL_RL PGOR ON PGOR.ADVC_PROFL_ID = PROFL.ADVC_PROFL_ID AND PGOR.EFFTV_END_DT > CURRENT DATE INNER JOIN VADVC_GOAL GOAL ON GOAL.GOAL_ID = PGOR.GOAL_ID AND GOAL.GOAL_TYP_CD <> ' ' AND GOAL.EFFTV_END_DT > CURRENT_DATE INNER JOIN VT_ADV_GL_TRGT_ALC TRG ON TRG.GOAL_ID = GOAL.GOAL_ID INNER JOIN VADV_GOL_SUBAST_GR GRP ON TRG.IND_CLS_ID = GRP.IND_CLS_ID AND TRG.PRNT_IND_CLS_ID = GRP.PRNT_IND_CLS_ID AND TRG.IND_CLS_CD = GRP.IND_CLS_CD AND GRP.EFFTV_END_DT > CURRENT DATE INNER JOIN VCIN0910 ADV ON TRG.CREW_PO_ID = ADV.PO_ID WHERE SAGB.PO_ROLE_CD = 'OW' AND SAGB.PO_ID = v_POID AND SAGB.EFFTV_BGN_DT <= CURRENT DATE AND SAGB.EFFTV_END_DT > CURRENT DATE ORDER BY TRG.GOAL_ID , GRP.GR_NO , TRG.IND_CLS_CD FOR READ ONLY WITH UR
