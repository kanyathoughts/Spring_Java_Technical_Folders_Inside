SELECT ALT.GOAL_ID , GRP.GR_NO , ALT.IND_CLS_CD , ALT.PORT_ID , ADV.MIXD_MAIL_NM , ( CASE WHEN DAYOFWEEK ( ALT.TXN_STRT_TS ) = 1 THEN 'Sun' WHEN DAYOFWEEK ( ALT.TXN_STRT_TS ) = 2 THEN 'Mon' WHEN DAYOFWEEK ( ALT.TXN_STRT_TS ) = 3 THEN 'Tue' WHEN DAYOFWEEK ( ALT.TXN_STRT_TS ) = 4 THEN 'Wed' WHEN DAYOFWEEK ( ALT.TXN_STRT_TS ) = 5 THEN 'Thu' WHEN DAYOFWEEK ( ALT.TXN_STRT_TS ) = 6 THEN 'Fri' WHEN DAYOFWEEK ( ALT.TXN_STRT_TS ) = 7 THEN 'Sat' END || ' ' || CASE WHEN MONTH ( ALT.TXN_STRT_TS ) = 1 THEN 'Jan' WHEN MONTH ( ALT.TXN_STRT_TS ) = 2 THEN 'Feb' WHEN MONTH ( ALT.TXN_STRT_TS ) = 3 THEN 'Mar' WHEN MONTH ( ALT.TXN_STRT_TS ) = 4 THEN 'Apr' WHEN MONTH ( ALT.TXN_STRT_TS ) = 5 THEN 'May' WHEN MONTH ( ALT.TXN_STRT_TS ) = 6 THEN 'Jun' WHEN MONTH ( ALT.TXN_STRT_TS ) = 7 THEN 'Jul' WHEN MONTH ( ALT.TXN_STRT_TS ) = 8 THEN 'Aug' WHEN MONTH ( ALT.TXN_STRT_TS ) = 9 THEN 'Sep' WHEN MONTH ( ALT.TXN_STRT_TS ) = 10 THEN 'Oct' WHEN MONTH ( ALT.TXN_STRT_TS ) = 11 THEN 'Nov' WHEN MONTH ( ALT.TXN_STRT_TS ) = 12 THEN 'Dec' END || ' ' || RTRIM ( CHAR ( DAY ( ALT.TXN_STRT_TS ) ) ) || ' ' || CHAR ( TIME ( ALT.TXN_STRT_TS ) , JIS ) || ' ' || 'EST' || ' ' || YEAR ( ALT.TXN_STRT_TS ) ) AS DATETIME , ALT.CREW_PO_ID , ALT.IND_CLS_ID , ALT.PRNT_IND_CLS_ID , ALT.ACTV_FL , ( CASE WHEN FND.LNG_NM IS NULL AND ALT.PORT_ID > ' ' THEN 'Undefined' ELSE FND.LNG_NM END ) AS LNG_NM FROM VSAG_BUS_RLSHP SAGB INNER JOIN VSAG_ADVC ADVC ON ADVC.SAG_ID = SAGB.SAG_ID INNER JOIN VADVC_PROFL PROFL ON PROFL.SAG_ID = ADVC.SAG_ID AND PROFL.EFFTV_END_DT > CURRENT DATE INNER JOIN VADVC_PROF_GOAL_RL PGOR ON PGOR.ADVC_PROFL_ID = PROFL.ADVC_PROFL_ID AND PGOR.EFFTV_END_DT > CURRENT DATE INNER JOIN VADVC_GOAL GOAL ON GOAL.GOAL_ID = PGOR.GOAL_ID AND GOAL.GOAL_TYP_CD <> ' ' AND GOAL.EFFTV_END_DT > CURRENT_DATE INNER JOIN VT_ADV_GL_ALTF_AL ALT ON ALT.GOAL_ID = GOAL.GOAL_ID LEFT JOIN VC_VGI_INT_INS FND ON ALT.PORT_ID = FND.PORT_ID INNER JOIN VADV_ALT_SUBAST_GR GRP ON ALT.IND_CLS_ID = GRP.IND_CLS_ID AND ALT.PRNT_IND_CLS_ID = GRP.PRNT_IND_CLS_ID AND ALT.IND_CLS_CD = GRP.IND_CLS_CD AND GRP.EFFTV_END_DT > CURRENT DATE INNER JOIN VCIN0910 ADV ON ALT.CREW_PO_ID = ADV.PO_ID WHERE SAGB.PO_ROLE_CD = 'OW' AND SAGB.PO_ID = v_POID AND SAGB.EFFTV_BGN_DT <= CURRENT DATE AND SAGB.EFFTV_END_DT > CURRENT DATE ORDER BY ALT.GOAL_ID , GRP.GR_NO , ALT.IND_CLS_CD FOR READ ONLY WITH UR